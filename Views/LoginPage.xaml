<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Magidesk.Presentation.Views.LoginPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Magidesk.Presentation.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    IsTabStop="True"
    KeyDown="Page_KeyDown">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- Branding / Info Side -->
        <StackPanel Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="20">
            <TextBlock Text="MagiDesk POS" Style="{StaticResource DisplayTextBlockStyle}" FontWeight="Bold" Foreground="{ThemeResource SystemControlForegroundAccentBrush}"/>
            <TextBlock Text="Next Gen Point of Sale" Style="{StaticResource SubtitleTextBlockStyle}" Opacity="0.6" HorizontalAlignment="Center"/>
            
            <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center" Margin="0,50,0,0">
               <Button Content="Clock In/Out" Command="{Binding ClockInOutCommand}" Background="#00695C" Foreground="White" Width="150" Height="40" FontSize="16"/>
               <Button Content="Shutdown System" Command="{Binding ShutdownCommand}" Background="DarkRed" Foreground="White" Width="150" Height="40" FontSize="16"/>
            </StackPanel>
        </StackPanel>

        <!-- Login Logic Side -->
        <Grid Grid.Column="1" Width="400" Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}" Padding="40">
            <StackPanel VerticalAlignment="Center" Spacing="20">
                <TextBlock Text="User Login" Style="{StaticResource TitleTextBlockStyle}" HorizontalAlignment="Center"/>
                
                <!-- PIN Display -->
                 <Border Background="{ThemeResource SystemControlBackgroundAltHighBrush}" Padding="10" CornerRadius="4">
                    <TextBlock Text="{Binding MaskedPin}" Style="{StaticResource TitleTextBlockStyle}" HorizontalAlignment="Center" MinHeight="40"/>
                </Border>

                <!-- Error Message -->
                <TextBlock Text="{Binding ErrorMessage}" Foreground="Red" HorizontalAlignment="Center" TextWrapping="Wrap" MinHeight="20"/>

                <!-- Keypad -->
                <Grid RowSpacing="10" ColumnSpacing="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="60"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Row="0" Grid.Column="0" Content="1" Command="{Binding AppendDigitCommand}" CommandParameter="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
                    <Button Grid.Row="0" Grid.Column="1" Content="2" Command="{Binding AppendDigitCommand}" CommandParameter="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
                    <Button Grid.Row="0" Grid.Column="2" Content="3" Command="{Binding AppendDigitCommand}" CommandParameter="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>

                    <Button Grid.Row="1" Grid.Column="0" Content="4" Command="{Binding AppendDigitCommand}" CommandParameter="4" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
                    <Button Grid.Row="1" Grid.Column="1" Content="5" Command="{Binding AppendDigitCommand}" CommandParameter="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
                    <Button Grid.Row="1" Grid.Column="2" Content="6" Command="{Binding AppendDigitCommand}" CommandParameter="6" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>

                    <Button Grid.Row="2" Grid.Column="0" Content="7" Command="{Binding AppendDigitCommand}" CommandParameter="7" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
                    <Button Grid.Row="2" Grid.Column="1" Content="8" Command="{Binding AppendDigitCommand}" CommandParameter="8" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
                    <Button Grid.Row="2" Grid.Column="2" Content="9" Command="{Binding AppendDigitCommand}" CommandParameter="9" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>

                    <Button Grid.Row="3" Grid.Column="0" Content="Clear" Command="{Binding ClearCommand}" Background="DarkOrange" Foreground="White" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="18"/>
                    <Button Grid.Row="3" Grid.Column="1" Content="0" Command="{Binding AppendDigitCommand}" CommandParameter="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
                    <Button Grid.Row="3" Grid.Column="2" Content="Enter" Command="{Binding LoginCommand}" Background="{ThemeResource SystemControlBackgroundAccentBrush}" Foreground="White" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="18"/>
                </Grid>

                 <ProgressRing IsActive="{Binding IsBusy}" HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
