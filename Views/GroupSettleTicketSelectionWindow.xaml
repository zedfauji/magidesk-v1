<?xml version="1.0" encoding="utf-8"?>
<ContentDialog
    x:Class="Magidesk.Presentation.Views.GroupSettleTicketSelectionWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:Magidesk.Presentation.ViewModels"
    mc:Ignorable="d"
    Title="Select Tickets for Group Settlement"
    PrimaryButtonText="Continue"
    CloseButtonText="Cancel"
    DefaultButton="Primary">

    <Grid RowSpacing="16" Padding="20" Width="600" Height="400">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="Select multiple tickets to settle together:" Style="{StaticResource SubtitleTextBlockStyle}" HorizontalAlignment="Center"/>

        <!-- Ticket List -->
        <ListView Grid.Row="1" 
                  ItemsSource="{x:Bind ViewModel.AvailableTickets, Mode=OneWay}"
                  SelectionMode="Multiple"
                  MaxHeight="300">
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="viewmodels:GroupSettleTicketDto">
                    <Grid Padding="12" Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}" CornerRadius="4" Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Checkbox -->
                        <CheckBox IsChecked="{x:Bind IsSelected, Mode=TwoWay}" 
                                  VerticalAlignment="Center"/>
                        
                        <!-- Ticket Details -->
                        <StackPanel Grid.Column="1" Margin="12,0,0,0">
                            <TextBlock Text="{x:Bind TicketNumber}" Style="{StaticResource SubtitleTextBlockStyle}"/>
                            <TextBlock Text="{x:Bind GuestCount}" Style="{StaticResource BodyTextBlockStyle}" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                            <TextBlock Text="{x:Bind TableNumber}" Style="{StaticResource BodyTextBlockStyle}" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                        </StackPanel>
                        
                        <!-- Amount -->
                        <StackPanel Grid.Column="2" HorizontalAlignment="Right">
                            <TextBlock Text="{x:Bind TotalAmount, Mode=OneWay}" 
                                       Style="{StaticResource SubtitleTextBlockStyle}" 
                                       HorizontalAlignment="Right"/>
                            <TextBlock Text="Due" Style="{StaticResource BodyTextBlockStyle}" 
                                       HorizontalAlignment="Right"
                                       Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Combined Total -->
        <Border Grid.Row="2" 
                Background="{ThemeResource SystemControlBackgroundAccentBrush}" 
                CornerRadius="8" 
                Padding="16">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="12">
                <TextBlock Text="Combined Total:" Style="{StaticResource SubtitleTextBlockStyle}" Foreground="White"/>
                <TextBlock Text="{x:Bind ViewModel.CombinedTotal, Mode=OneWay}" 
                           Style="{StaticResource SubtitleTextBlockStyle}" 
                           Foreground="White" 
                           FontWeight="Bold"/>
            </StackPanel>
        </Border>
    </Grid>
</ContentDialog>
