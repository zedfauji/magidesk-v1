<ContentDialog
    x:Class="Magidesk.Views.Dialogs.CookingInstructionDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="{x:Bind ViewModel.Title, Mode=OneWay}"
    PrimaryButtonText="OK"
    CloseButtonText="Cancel"
    DefaultButton="Primary">

    <Grid x:Name="RootGrid" RowSpacing="12" Width="400">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Current Instructions (Editable) -->
        <TextBox Text="{x:Bind ViewModel.SelectedInstructions, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                 Header="Notes / Instructions" 
                 AcceptsReturn="True" TextWrapping="Wrap" Height="80"/>

        <!-- Predefined Grid -->
        <GridView Grid.Row="1" ItemsSource="{x:Bind ViewModel.PredefinedInstructions}" SelectionMode="None">
            <GridView.ItemTemplate>
                <DataTemplate>
                    <Button Content="{Binding}" 
                            Command="{Binding DataContext.AddInstructionCommand, ElementName=RootGrid}" 
                            CommandParameter="{Binding}"
                            Margin="4" Width="110" Height="50"
                            HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                </DataTemplate>
            </GridView.ItemTemplate>
        </GridView>
        
        <!-- ElementName Fix: We need to reference ViewModel from ItemTemplate. 
             Simplified: Use x:Bind to parent if possible or simple text wrapping. -->
    </Grid>
</ContentDialog>
