<?xml version="1.0" encoding="utf-8"?>
<ContentDialog
    x:Class="Magidesk.Presentation.Views.Dialogs.ManagerPinDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Magidesk.Presentation.Views.Dialogs"
    xmlns:vm="using:Magidesk.Presentation.ViewModels.Dialogs"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Manager Authorization"
    PrimaryButtonText="Authorize"
    CloseButtonText="Cancel"
    DefaultButton="Primary"
    IsPrimaryButtonEnabled="{x:Bind ViewModel.CanSubmit, Mode=OneWay}"
    PrimaryButtonClick="ContentDialog_PrimaryButtonClick">

    <StackPanel Spacing="16" MinWidth="350">
        <!-- Operation Type Display -->
        <TextBlock 
            Text="{x:Bind ViewModel.OperationType, Mode=OneWay}" 
            Style="{StaticResource SubtitleTextBlockStyle}"
            TextWrapping="Wrap"
            HorizontalAlignment="Center"/>

        <TextBlock 
            Text="Manager authorization required"
            Opacity="0.7"
            HorizontalAlignment="Center"/>

        <!-- PIN Display -->
        <Border 
            Background="{ThemeResource SystemControlBackgroundAltHighBrush}" 
            Padding="12" 
            CornerRadius="4"
            BorderBrush="{ThemeResource SystemControlForegroundBaseMediumBrush}"
            BorderThickness="1">
            <TextBlock 
                Text="{x:Bind ViewModel.MaskedPin, Mode=OneWay}" 
                Style="{StaticResource TitleTextBlockStyle}" 
                HorizontalAlignment="Center" 
                MinHeight="40"
                VerticalAlignment="Center"/>
        </Border>

        <!-- Error Message -->
        <InfoBar 
            IsOpen="{x:Bind ViewModel.ErrorMessage, Converter={StaticResource StringToBoolConverter}, Mode=OneWay}"
            Severity="Error"
            Message="{x:Bind ViewModel.ErrorMessage, Mode=OneWay}"/>

        <!-- Numeric Keypad -->
        <Grid RowSpacing="8" ColumnSpacing="8">
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="60"/>
                <RowDefinition Height="60"/>
                <RowDefinition Height="60"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Row 1 -->
            <Button Grid.Row="0" Grid.Column="0" Content="1" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
            <Button Grid.Row="0" Grid.Column="1" Content="2" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
            <Button Grid.Row="0" Grid.Column="2" Content="3" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>

            <!-- Row 2 -->
            <Button Grid.Row="1" Grid.Column="0" Content="4" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="4" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
            <Button Grid.Row="1" Grid.Column="1" Content="5" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
            <Button Grid.Row="1" Grid.Column="2" Content="6" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="6" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>

            <!-- Row 3 -->
            <Button Grid.Row="2" Grid.Column="0" Content="7" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="7" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
            <Button Grid.Row="2" Grid.Column="1" Content="8" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="8" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
            <Button Grid.Row="2" Grid.Column="2" Content="9" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="9" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>

            <!-- Row 4 -->
            <Button Grid.Row="3" Grid.Column="0" Content="Clear" Command="{x:Bind ViewModel.ClearCommand}" Background="DarkOrange" Foreground="White" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="18"/>
            <Button Grid.Row="3" Grid.Column="1" Content="0" Command="{x:Bind ViewModel.AppendDigitCommand}" CommandParameter="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
            <Button Grid.Row="3" Grid.Column="2" Content="âŒ«" Command="{x:Bind ViewModel.RemoveLastDigitCommand}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" FontSize="24"/>
        </Grid>

        <!-- Loading Indicator -->
        <ProgressRing IsActive="{x:Bind ViewModel.IsBusy, Mode=OneWay}" HorizontalAlignment="Center"/>
    </StackPanel>
</ContentDialog>
