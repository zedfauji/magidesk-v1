<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Magidesk.Presentation.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <NavigationView
            x:Name="RootNavigationView"
            Grid.Row="0"
            IsBackButtonVisible="Visible"
            IsBackEnabled="True"
            PaneDisplayMode="Left"
            ItemInvoked="OnItemInvoked"
            BackRequested="OnBackRequested">

            <NavigationView.MenuItems>
                <NavigationViewItem Content="Home" Tag="home" Icon="Home" />
                <NavigationViewItem Content="Table Map" Tag="tableMap" Icon="Map" />
                <NavigationViewItem Content="Kitchen Display" Tag="kitchenDisplay" Icon="ViewAll" />
            </NavigationView.MenuItems>

            <Frame x:Name="ContentFrame" />
        </NavigationView>

        <!-- F-ENTRY-003 FIX (TICKET-003): Persistent Error Banner -->
        <InfoBar x:Name="ErrorBanner"
                 Grid.Row="0"
                 Severity="Error"
                 IsOpen="False"
                 IsClosable="True"
                 VerticalAlignment="Top"
                 Canvas.ZIndex="999"
                 Margin="10,10,10,0">
            <InfoBar.ActionButton>
                <Button Content="Details" Click="ErrorBanner_DetailsClick"/>
            </InfoBar.ActionButton>
        </InfoBar>

        <!-- Status Bar -->
        <Grid Grid.Row="1" Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}" Padding="10,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" Grid.Column="0" Spacing="5" Margin="0,0,20,0">
                <TextBlock Text="TERMINAL:" FontWeight="Bold" Style="{StaticResource CaptionTextBlockStyle}"/>
                <TextBlock x:Name="StatusTerminalId" Text="----" Style="{StaticResource CaptionTextBlockStyle}"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Grid.Column="1" Spacing="5" Margin="0,0,20,0">
                <TextBlock Text="USER:" FontWeight="Bold" Style="{StaticResource CaptionTextBlockStyle}"/>
                <TextBlock x:Name="StatusUser" Text="Not Logged In" Style="{StaticResource CaptionTextBlockStyle}"/>
            </StackPanel>

            <!-- Spacer -->

            <StackPanel Orientation="Horizontal" Grid.Column="3" Spacing="5" Margin="0,0,20,0">
                 <TextBlock Text="TAX INCLUDED:" FontWeight="Bold" Style="{StaticResource CaptionTextBlockStyle}"/>
                 <TextBlock x:Name="StatusTaxIncluded" Text="YES" Style="{StaticResource CaptionTextBlockStyle}"/>
            </StackPanel>

            <TextBlock x:Name="StatusClock" Grid.Column="4" Text="00:00:00" FontWeight="SemiBold" Style="{StaticResource BodyStrongTextBlockStyle}" VerticalAlignment="Center"/>
        </Grid>

        <!-- Loading Overlay -->
        <Grid x:Name="LoadingOverlay" Grid.RowSpan="2" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" Visibility="Collapsed" Canvas.ZIndex="1000">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="20">
                <ProgressRing IsActive="True" Width="60" Height="60"/>
                <TextBlock x:Name="LoadingStatus" Text="Initializing System..." Style="{StaticResource TitleTextBlockStyle}" HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
