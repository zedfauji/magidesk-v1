†ã
]C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Api\Program.cs
var 
startupLogger 
= 
new 
List 
< 
string #
># $
($ %
)% &
;& '
try 
{		 
startupLogger

 
.

 
Add

 
(

 
$"

 
$str

 
{

 
DateTime

 "
.

" #
Now

# &
:

& '
$str

' :
}

: ;
$str

; P
"

P Q
)

Q R
;

R S
var 
builder 
= 
WebApplication  
.  !
CreateBuilder! .
(. /
args/ 3
)3 4
;4 5
startupLogger 
. 
Add 
( 
$str -
)- .
;. /
builder 
. 
Services 
. 
AddControllers #
(# $
)$ %
;% &
startupLogger 
. 
Add 
( 
$str 6
)6 7
;7 8
builder 
. 
Services 
. 
AddApplication #
(# $
)$ %
;% &
startupLogger 
. 
Add 
( 
$str 9
)9 :
;: ;
builder 
. 
Services 
. 
AddInfrastructure &
(& '
)' (
;( )
startupLogger 
. 
Add 
( 
$str /
)/ 0
;0 1
builder 
. 
Services 
. 
AddHealthChecks $
($ %
)% &
;& '
builder 
. 
Services 
. #
AddEndpointsApiExplorer ,
(, -
)- .
;. /
builder 
. 
Services 
. 
AddSwaggerGen "
(" #
)# $
;$ %
startupLogger   
.   
Add   
(   
$str   /
)  / 0
;  0 1
var!! 
app!! 
=!! 
builder!! 
.!! 
Build!! 
(!! 
)!! 
;!! 
app$$ 
.$$ 
UseExceptionHandler$$ 
($$ 
errorApp$$ $
=>$$% '
{%% 
errorApp&& 
.&& 
Run&& 
(&& 
async&& 
context&& "
=>&&# %
{'' 	
context(( 
.(( 
Response(( 
.(( 

StatusCode(( '
=((( )
$num((* -
;((- .
context)) 
.)) 
Response)) 
.)) 
ContentType)) (
=))) *
$str))+ =
;))= >
var++ '
exceptionHandlerPathFeature++ +
=++, -
context++. 5
.++5 6
Features++6 >
.++> ?
Get++? B
<++B C(
IExceptionHandlerPathFeature++C _
>++_ `
(++` a
)++a b
;++b c
var,, 
	exception,, 
=,, '
exceptionHandlerPathFeature,, 7
?,,7 8
.,,8 9
Error,,9 >
;,,> ?
var.. 
errorResponse.. 
=.. 
new..  #
{// 
error00 
=00 
$str00 6
,006 7
message11 
=11 
	exception11 #
?11# $
.11$ %
Message11% ,
??11- /
$str110 ?
,11? @
	timestamp22 
=22 
DateTime22 $
.22$ %
UtcNow22% +
,22+ ,
path33 
=33 
context33 
.33 
Request33 &
.33& '
Path33' +
.33+ ,
Value33, 1
}44 
;44 
var77 
logger77 
=77 
context77  
.77  !
RequestServices77! 0
.770 1
GetRequiredService771 C
<77C D
ILogger77D K
<77K L
Program77L S
>77S T
>77T U
(77U V
)77V W
;77W X
logger88 
.88 
LogError88 
(88 
	exception88 %
,88% &
$str88' J
,88J K
context88L S
.88S T
Request88T [
.88[ \
Path88\ `
)88` a
;88a b
await:: 
context:: 
.:: 
Response:: "
.::" #

WriteAsync::# -
(::- .
JsonSerializer::. <
.::< =
	Serialize::= F
(::F G
errorResponse::G T
)::T U
)::U V
;::V W
};; 	
);;	 

;;;
 
}<< 
)<< 
;<< 
if?? 
(?? 
app?? 
.?? 
Environment?? 
.?? 
IsDevelopment?? %
(??% &
)??& '
)??' (
{@@ 
appAA 
.AA 

UseSwaggerAA 
(AA 
)AA 
;AA 
appBB 
.BB 
UseSwaggerUIBB 
(BB 
)BB 
;BB 
}CC 
appEE 
.EE 
UseHttpsRedirectionEE 
(EE 
)EE 
;EE 
appFF 
.FF 
UseAuthorizationFF 
(FF 
)FF 
;FF 
appGG 
.GG 
MapControllersGG 
(GG 
)GG 
;GG 
appJJ 
.JJ 
MapHealthChecksJJ 
(JJ 
$strJJ !
)JJ! "
;JJ" #
startupLoggerMM 
.MM 
AddMM 
(MM 
$strMM 7
)MM7 8
;MM8 9
usingNN 	
(NN
 
varNN 
scopeNN 
=NN 
appNN 
.NN 
ServicesNN #
.NN# $
CreateScopeNN$ /
(NN/ 0
)NN0 1
)NN1 2
{OO 
varPP 
servicesPP 
=PP 
scopePP 
.PP 
ServiceProviderPP ,
;PP, -
trySS 
{TT 	
varUU 
mediatorUU 
=UU 
servicesUU #
.UU# $
GetRequiredServiceUU$ 6
<UU6 7
MediatRUU7 >
.UU> ?
	IMediatorUU? H
>UUH I
(UUI J
)UUJ K
;UUK L
startupLoggerVV 
.VV 
AddVV 
(VV 
$strVV 6
)VV6 7
;VV7 8
}WW 	
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX 
{YY 	
startupLoggerZZ 
.ZZ 
AddZZ 
(ZZ 
$"ZZ  
$strZZ  A
{ZZA B
exZZB D
.ZZD E
MessageZZE L
}ZZL M
"ZZM N
)ZZN O
;ZZO P
throw[[ 
new[[ %
InvalidOperationException[[ /
([[/ 0
$str[[0 [
,[[[ \
ex[[] _
)[[_ `
;[[` a
}\\ 	
startupLogger__ 
.__ 
Add__ 
(__ 
$str__ =
)__= >
;__> ?
try`` 
{aa 	
varbb 
	dbContextbb 
=bb 
servicesbb $
.bb$ %
GetRequiredServicebb% 7
<bb7 8
Magideskbb8 @
.bb@ A
InfrastructurebbA O
.bbO P
DatabbP T
.bbT U 
ApplicationDbContextbbU i
>bbi j
(bbj k
)bbk l
;bbl m
intee 

retryCountee 
=ee 
$numee 
;ee 
intff 

maxRetriesff 
=ff 
$numff 
;ff 
boolgg 
	connectedgg 
=gg 
falsegg "
;gg" #
whileii 
(ii 

retryCountii 
<ii 

maxRetriesii  *
&&ii+ -
!ii. /
	connectedii/ 8
)ii8 9
{jj 
trykk 
{ll 
varnn 

canConnectnn "
=nn# $
	dbContextnn% .
.nn. /
Databasenn/ 7
.nn7 8

CanConnectnn8 B
(nnB C
)nnC D
;nnD E
ifoo 
(oo 

canConnectoo "
)oo" #
{pp 
	connectedqq !
=qq" #
trueqq$ (
;qq( )
startupLoggerrr %
.rr% &
Addrr& )
(rr) *
$strrr* L
)rrL M
;rrM N
}ss 
elsett 
{uu 
throwvv 
newvv !%
InvalidOperationExceptionvv" ;
(vv; <
$strvv< b
)vvb c
;vvc d
}ww 
}xx 
catchyy 
(yy 
	Exceptionyy  
dbExyy! %
)yy% &
{zz 

retryCount{{ 
++{{  
;{{  !
if|| 
(|| 

retryCount|| "
<||# $

maxRetries||% /
)||/ 0
{}} 
startupLogger~~ %
.~~% &
Add~~& )
(~~) *
$"~~* ,
$str~~, J
{~~J K

retryCount~~K U
}~~U V
$str~~V _
{~~_ `
dbEx~~` d
.~~d e
Message~~e l
}~~l m
$str	~~m á
"
~~á à
)
~~à â
;
~~â ä
System 
. 
	Threading (
.( )
Thread) /
./ 0
Sleep0 5
(5 6
$num6 :
): ;
;; <
}
ÄÄ 
else
ÅÅ 
{
ÇÇ 
startupLogger
ÉÉ %
.
ÉÉ% &
Add
ÉÉ& )
(
ÉÉ) *
$"
ÉÉ* ,
$str
ÉÉ, O
{
ÉÉO P

maxRetries
ÉÉP Z
}
ÉÉZ [
$str
ÉÉ[ f
{
ÉÉf g
dbEx
ÉÉg k
.
ÉÉk l
Message
ÉÉl s
}
ÉÉs t
"
ÉÉt u
)
ÉÉu v
;
ÉÉv w
throw
ÑÑ 
new
ÑÑ !'
InvalidOperationException
ÑÑ" ;
(
ÑÑ; <
$"
ÑÑ< >
$str
ÑÑ> _
{
ÑÑ_ `

maxRetries
ÑÑ` j
}
ÑÑj k
$str
ÑÑk t
"
ÑÑt u
,
ÑÑu v
dbEx
ÑÑw {
)
ÑÑ{ |
;
ÑÑ| }
}
ÖÖ 
}
ÜÜ 
}
áá 
}
àà 	
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ 
{
ää 	
startupLogger
ãã 
.
ãã 
Add
ãã 
(
ãã 
$"
ãã  
$str
ãã  >
{
ãã> ?
ex
ãã? A
.
ããA B
Message
ããB I
}
ããI J
"
ããJ K
)
ããK L
;
ããL M
throw
åå 
new
åå '
InvalidOperationException
åå /
(
åå/ 0
$str
åå0 L
,
ååL M
ex
ååN P
)
ååP Q
;
ååQ R
}
çç 	
startupLogger
êê 
.
êê 
Add
êê 
(
êê 
$str
êê 7
)
êê7 8
;
êê8 9
try
ëë 
{
íí 	
var
ìì 
config
ìì 
=
ìì 
services
ìì !
.
ìì! " 
GetRequiredService
ìì" 4
<
ìì4 5
	Microsoft
ìì5 >
.
ìì> ?

Extensions
ìì? I
.
ììI J
Configuration
ììJ W
.
ììW X
IConfiguration
ììX f
>
ììf g
(
ììg h
)
ììh i
;
ììi j
var
ññ 
connectionString
ññ  
=
ññ! "
config
ññ# )
.
ññ) *!
GetConnectionString
ññ* =
(
ññ= >
$str
ññ> Q
)
ññQ R
;
ññR S
if
óó 
(
óó 
string
óó 
.
óó  
IsNullOrWhiteSpace
óó )
(
óó) *
connectionString
óó* :
)
óó: ;
)
óó; <
{
òò 
throw
ôô 
new
ôô '
InvalidOperationException
ôô 3
(
ôô3 4
$str
ôô4 x
)
ôôx y
;
ôôy z
}
öö 
startupLogger
õõ 
.
õõ 
Add
õõ 
(
õõ 
$str
õõ 9
)
õõ9 :
;
õõ: ;
}
úú 	
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù 
{
ûû 	
startupLogger
üü 
.
üü 
Add
üü 
(
üü 
$"
üü  
$str
üü  C
{
üüC D
ex
üüD F
.
üüF G
Message
üüG N
}
üüN O
"
üüO P
)
üüP Q
;
üüQ R
throw
†† 
new
†† '
InvalidOperationException
†† /
(
††/ 0
$str
††0 Q
,
††Q R
ex
††S U
)
††U V
;
††V W
}
°° 	
}
¢¢ 
startupLogger
§§ 
.
§§ 
Add
§§ 
(
§§ 
$"
§§ 
$str
§§ 
{
§§ 
DateTime
§§ "
.
§§" #
Now
§§# &
:
§§& '
$str
§§' :
}
§§: ;
$str
§§; R
"
§§R S
)
§§S T
;
§§T U
startupLogger
•• 
.
•• 
Add
•• 
(
•• 
$str
•• 7
)
••7 8
;
••8 9
var
®® 
logger
®® 
=
®® 
app
®® 
.
®® 
Services
®® 
.
®®  
GetRequiredService
®® 0
<
®®0 1
ILogger
®®1 8
<
®®8 9
Program
®®9 @
>
®®@ A
>
®®A B
(
®®B C
)
®®C D
;
®®D E
foreach
©© 
(
©© 
var
©© 
msg
©© 
in
©© 
startupLogger
©© %
)
©©% &
{
™™ 
logger
´´ 
.
´´ 
LogInformation
´´ 
(
´´ 
msg
´´ !
)
´´! "
;
´´" #
}
¨¨ 
app
ÆÆ 
.
ÆÆ 
Run
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}ØØ 
catch∞∞ 
(
∞∞ 
	Exception
∞∞ 
ex
∞∞ 
)
∞∞ 
{±± 
startupLogger
≥≥ 
.
≥≥ 
Add
≥≥ 
(
≥≥ 
$"
≥≥ 
$str
≥≥ 
{
≥≥ 
DateTime
≥≥ "
.
≥≥" #
Now
≥≥# &
:
≥≥& '
$str
≥≥' :
}
≥≥: ;
$str
≥≥; R
{
≥≥R S
ex
≥≥S U
.
≥≥U V
Message
≥≥V ]
}
≥≥] ^
"
≥≥^ _
)
≥≥_ `
;
≥≥` a
startupLogger
¥¥ 
.
¥¥ 
Add
¥¥ 
(
¥¥ 
$"
¥¥ 
$str
¥¥ 
{
¥¥  
ex
¥¥  "
.
¥¥" #

StackTrace
¥¥# -
}
¥¥- .
"
¥¥. /
)
¥¥/ 0
;
¥¥0 1
Console
∑∑ 
.
∑∑ 
Error
∑∑ 
.
∑∑ 
	WriteLine
∑∑ 
(
∑∑ 
$str
∑∑ U
)
∑∑U V
;
∑∑V W
Console
∏∏ 
.
∏∏ 
Error
∏∏ 
.
∏∏ 
	WriteLine
∏∏ 
(
∏∏ 
$str
∏∏ >
)
∏∏> ?
;
∏∏? @
Console
ππ 
.
ππ 
Error
ππ 
.
ππ 
	WriteLine
ππ 
(
ππ 
$str
ππ U
)
ππU V
;
ππV W
foreach
∫∫ 
(
∫∫ 
var
∫∫ 
msg
∫∫ 
in
∫∫ 
startupLogger
∫∫ %
)
∫∫% &
{
ªª 
Console
ºº 
.
ºº 
Error
ºº 
.
ºº 
	WriteLine
ºº 
(
ºº  
msg
ºº  #
)
ºº# $
;
ºº$ %
}
ΩΩ 
Console
ææ 
.
ææ 
Error
ææ 
.
ææ 
	WriteLine
ææ 
(
ææ 
$str
ææ U
)
ææU V
;
ææV W
try
¡¡ 
{
¬¬ 
var
√√ 
logDir
√√ 
=
√√ 
Path
√√ 
.
√√ 
Combine
√√ !
(
√√! "
Environment
√√" -
.
√√- .
GetFolderPath
√√. ;
(
√√; <
Environment
√√< G
.
√√G H
SpecialFolder
√√H U
.
√√U V"
LocalApplicationData
√√V j
)
√√j k
,
√√k l
$str
√√m w
,
√√w x
$str
√√y 
)√√ Ä
;√√Ä Å
	Directory
ƒƒ 
.
ƒƒ 
CreateDirectory
ƒƒ !
(
ƒƒ! "
logDir
ƒƒ" (
)
ƒƒ( )
;
ƒƒ) *
var
≈≈ 
logPath
≈≈ 
=
≈≈ 
Path
≈≈ 
.
≈≈ 
Combine
≈≈ "
(
≈≈" #
logDir
≈≈# )
,
≈≈) *
$str
≈≈+ D
)
≈≈D E
;
≈≈E F
File
∆∆ 
.
∆∆ 
WriteAllLines
∆∆ 
(
∆∆ 
logPath
∆∆ "
,
∆∆" #
startupLogger
∆∆$ 1
)
∆∆1 2
;
∆∆2 3
Console
«« 
.
«« 
Error
«« 
.
«« 
	WriteLine
«« 
(
««  
$"
««  "
$str
««" :
{
««: ;
logPath
««; B
}
««B C
"
««C D
)
««D E
;
««E F
}
»» 
catch
…… 	
{
   
Console
ÀÀ 
.
ÀÀ 
Error
ÀÀ 
.
ÀÀ 
	WriteLine
ÀÀ 
(
ÀÀ  
$str
ÀÀ  E
)
ÀÀE F
;
ÀÀF G
}
ÃÃ 
Environment
œœ 
.
œœ 
Exit
œœ 
(
œœ 
$num
œœ 
)
œœ 
;
œœ 
}–– €&
rC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Api\Controllers\SystemController.cs
	namespace 	
Magidesk
 
. 
Api 
. 
Controllers "
;" #
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public		 
class		 
SystemController		 
:		 
ControllerBase		  .
{

 
private 
readonly 
IBackupService #
_backupService$ 2
;2 3
private 
readonly 
ILogger 
< 
SystemController -
>- .
_logger/ 6
;6 7
public 

SystemController 
( 
IBackupService *
backupService+ 8
,8 9
ILogger: A
<A B
SystemControllerB R
>R S
loggerT Z
)Z [
{ 
_backupService 
= 
backupService &
;& '
_logger 
= 
logger 
; 
} 
[ 
HttpPost 
( 
$str 
) 
] 
public 

async 
Task 
< 
IActionResult #
># $
CreateBackup% 1
(1 2
)2 3
{ 
try 
{ 	
var 
fileName 
= 
await  
_backupService! /
./ 0
CreateBackupAsync0 A
(A B
)B C
;C D
return 
Ok 
( 
new 
{ 
Message #
=$ %
$str& C
,C D
FileNameE M
=N O
fileNameP X
}Y Z
)Z [
;[ \
} 	
catch 
( 
	Exception 
ex 
) 
{ 	
_logger 
. 
LogError 
( 
ex 
,  
$str! 0
)0 1
;1 2
return 

StatusCode 
( 
$num !
,! "
new# &
{' (
Message) 0
=1 2
$str3 B
,B C
ErrorD I
=J K
exL N
.N O
MessageO V
}W X
)X Y
;Y Z
}   	
}!! 
[## 
HttpGet## 
(## 
$str## 
)## 
]## 
public$$ 

async$$ 
Task$$ 
<$$ 
ActionResult$$ "
<$$" #
List$$# '
<$$' (
BackupInfoDto$$( 5
>$$5 6
>$$6 7
>$$7 8
ListBackups$$9 D
($$D E
)$$E F
{%% 
var&& 
backups&& 
=&& 
await&& 
_backupService&& *
.&&* +
ListBackupsAsync&&+ ;
(&&; <
)&&< =
;&&= >
return'' 
Ok'' 
('' 
backups'' 
)'' 
;'' 
}(( 
[** 
HttpPost** 
(** 
$str** "
)**" #
]**# $
public++ 

async++ 
Task++ 
<++ 
IActionResult++ #
>++# $
RestoreBackup++% 2
(++2 3
string++3 9
fileName++: B
)++B C
{,, 
try.. 
{// 	
await00 
_backupService00  
.00  !
RestoreBackupAsync00! 3
(003 4
fileName004 <
)00< =
;00= >
return11 
Ok11 
(11 
new11 
{11 
Message11 #
=11$ %
$str11& F
}11G H
)11H I
;11I J
}22 	
catch33 
(33 !
FileNotFoundException33 $
)33$ %
{44 	
return55 
NotFound55 
(55 
new55 
{55  !
Message55" )
=55* +
$str55, C
}55D E
)55E F
;55F G
}66 	
catch77 
(77 
	Exception77 
ex77 
)77 
{88 	
_logger99 
.99 
LogError99 
(99 
ex99 
,99  
$str99! 1
)991 2
;992 3
return:: 

StatusCode:: 
(:: 
$num:: !
,::! "
new::# &
{::' (
Message::) 0
=::1 2
$str::3 C
,::C D
Error::E J
=::K L
ex::M O
.::O P
Message::P W
}::X Y
)::Y Z
;::Z [
};; 	
}<< 
}== ¥[
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Api\Controllers\ReportsController.cs
	namespace 	
Magidesk
 
. 
Api 
. 
Controllers "
;" #
[		 
ApiController		 
]		 
[

 
Route

 
(

 
$str

 
)

 
]

 
public 
class 
ReportsController 
:  
ControllerBase! /
{ 
private 
readonly 
Application  
.  !

Interfaces! +
.+ ,
IQueryHandler, 9
<9 : 
GetSalesBalanceQuery: N
,N O!
SalesBalanceReportDtoP e
>e f 
_salesBalanceHandlerg {
;{ |
public 

ReportsController 
( 
Application (
.( )

Interfaces) 3
.3 4
IQueryHandler4 A
<A B 
GetSalesBalanceQueryB V
,V W!
SalesBalanceReportDtoX m
>m n 
salesBalanceHandler	o Ç
)
Ç É
{  
_salesBalanceHandler 
= 
salesBalanceHandler 2
;2 3
} 
[ 
HttpGet 
( 
$str 
) 
] 
public 

async 
Task 
< 
ActionResult "
<" #!
SalesBalanceReportDto# 8
>8 9
>9 :
GetSalesBalance; J
(J K
[K L
	FromQueryL U
]U V
DateTimeW _
	startDate` i
,i j
[k l
	FromQueryl u
]u v
DateTimew 
endDate
Ä á
)
á à
{ 
var 
query 
= 
new  
GetSalesBalanceQuery ,
(, -
	startDate- 6
,6 7
endDate8 ?
)? @
;@ A
var 
result 
= 
await  
_salesBalanceHandler /
./ 0
HandleAsync0 ;
(; <
query< A
)A B
;B C
return 
Ok 
( 
result 
) 
; 
} 
[ 
HttpGet 
( 
$str 
) 
] 
public 

async 
Task 
< 
ActionResult "
<" #!
SalesSummaryReportDto# 8
>8 9
>9 :
GetSalesSummary; J
(J K
[K L
	FromQueryL U
]U V
DateTimeW _
	startDate` i
,i j
[k l
	FromQueryl u
]u v
DateTimew 
endDate
Ä á
,
á à
[
â ä
	FromQuery
ä ì
]
ì î
bool
ï ô
includeGroups
ö ß
=
® ©
true
™ Æ
,
Æ Ø
[
∞ ±
FromServices
± Ω
]
Ω æ
Application
ø  
.
  À

Interfaces
À ’
.
’ ÷
IQueryHandler
÷ „
<
„ ‰"
GetSalesSummaryQuery
‰ ¯
,
¯ ˘#
SalesSummaryReportDto
˙ è
>
è ê
handler
ë ò
=
ô ö
null
õ ü
!
ü †
)
† °
{ 
var   
query   
=   
new    
GetSalesSummaryQuery   ,
(  , -
	startDate  - 6
,  6 7
endDate  8 ?
,  ? @
includeGroups  A N
)  N O
;  O P
var!! 
result!! 
=!! 
await!! 
handler!! "
.!!" #
HandleAsync!!# .
(!!. /
query!!/ 4
)!!4 5
;!!5 6
return"" 
Ok"" 
("" 
result"" 
)"" 
;"" 
}## 
[%% 
HttpGet%% 
(%% 
$str%% 
)%% 
]%% 
public&& 

async&& 
Task&& 
<&& 
ActionResult&& "
<&&" #
ExceptionsReportDto&&# 6
>&&6 7
>&&7 8
GetExceptionsReport&&9 L
(&&L M
[&&M N
	FromQuery&&N W
]&&W X
DateTime&&Y a
	startDate&&b k
,&&k l
[&&m n
	FromQuery&&n w
]&&w x
DateTime	&&y Å
endDate
&&Ç â
,
&&â ä
[
&&ã å
FromServices
&&å ò
]
&&ò ô
Application
&&ö •
.
&&• ¶

Interfaces
&&¶ ∞
.
&&∞ ±
IQueryHandler
&&± æ
<
&&æ ø&
GetExceptionsReportQuery
&&ø ◊
,
&&◊ ÿ!
ExceptionsReportDto
&&Ÿ Ï
>
&&Ï Ì
handler
&&Ó ı
=
&&ˆ ˜
null
&&¯ ¸
!
&&¸ ˝
)
&&˝ ˛
{'' 
var(( 
query(( 
=(( 
new(( $
GetExceptionsReportQuery(( 0
(((0 1
	startDate((1 :
,((: ;
endDate((< C
)((C D
;((D E
var)) 
result)) 
=)) 
await)) 
handler)) "
.))" #
HandleAsync))# .
()). /
query))/ 4
)))4 5
;))5 6
return** 
Ok** 
(** 
result** 
)** 
;** 
}++ 
[-- 
HttpGet-- 
(-- 
$str-- 
)-- 
]-- 
public.. 

async.. 
Task.. 
<.. 
ActionResult.. "
<.." #
JournalReportDto..# 3
>..3 4
>..4 5
GetJournalReport..6 F
(..F G
[// 	
	FromQuery//	 
]// 
DateTime// 
	startDate// &
,//& '
[00 	
	FromQuery00	 
]00 
DateTime00 
endDate00 $
,00$ %
[11 	
	FromQuery11	 
]11 
string11 
?11 

entityType11 &
,11& '
[22 	
	FromQuery22	 
]22 
Guid22 
?22 
userId22  
,22  !
[33 	
FromServices33	 
]33 
Application33 "
.33" #

Interfaces33# -
.33- .
IQueryHandler33. ;
<33; <!
GetJournalReportQuery33< Q
,33Q R
JournalReportDto33S c
>33c d
handler33e l
=33m n
null33o s
!33s t
)33t u
{44 
var55 
query55 
=55 
new55 !
GetJournalReportQuery55 -
(55- .
	startDate55. 7
,557 8
endDate559 @
,55@ A

entityType55B L
,55L M
userId55N T
)55T U
;55U V
var66 
result66 
=66 
await66 
handler66 "
.66" #
HandleAsync66# .
(66. /
query66/ 4
)664 5
;665 6
return77 
Ok77 
(77 
result77 
)77 
;77 
}88 
[:: 
HttpGet:: 
(:: 
$str:: 
):: 
]:: 
public;; 

async;; 
Task;; 
<;; 
ActionResult;; "
<;;" #!
ProductivityReportDto;;# 8
>;;8 9
>;;9 :!
GetProductivityReport;;; P
(;;P Q
[<< 	
	FromQuery<<	 
]<< 
DateTime<< 
	startDate<< &
,<<& '
[== 	
	FromQuery==	 
]== 
DateTime== 
endDate== $
,==$ %
[>> 	
	FromQuery>>	 
]>> 
Guid>> 
?>> 
userId>>  
,>>  !
[?? 	
FromServices??	 
]?? 
Application?? "
.??" #

Interfaces??# -
.??- .
IQueryHandler??. ;
<??; <&
GetProductivityReportQuery??< V
,??V W!
ProductivityReportDto??X m
>??m n
handler??o v
=??w x
null??y }
!??} ~
)??~ 
{@@ 
varAA 
queryAA 
=AA 
newAA &
GetProductivityReportQueryAA 2
(AA2 3
	startDateAA3 <
,AA< =
endDateAA> E
,AAE F
userIdAAG M
)AAM N
;AAN O
varBB 
resultBB 
=BB 
awaitBB 
handlerBB "
.BB" #
HandleAsyncBB# .
(BB. /
queryBB/ 4
)BB4 5
;BB5 6
returnCC 
OkCC 
(CC 
resultCC 
)CC 
;CC 
}DD 
[EE 
HttpGetEE 
(EE 
$strEE 
)EE 
]EE 
publicFF 

asyncFF 
TaskFF 
<FF 
ActionResultFF "
<FF" #
LaborReportDtoFF# 1
>FF1 2
>FF2 3
GetLaborReportFF4 B
(FFB C
[GG 	
	FromQueryGG	 
]GG 
DateTimeGG 
	startDateGG &
,GG& '
[HH 	
	FromQueryHH	 
]HH 
DateTimeHH 
endDateHH $
,HH$ %
[II 	
FromServicesII	 
]II 
ApplicationII "
.II" #

InterfacesII# -
.II- .
IQueryHandlerII. ;
<II; <
GetLaborReportQueryII< O
,IIO P
LaborReportDtoIIQ _
>II_ `
handlerIIa h
)IIh i
{JJ 
varKK 
queryKK 
=KK 
newKK 
GetLaborReportQueryKK +
(KK+ ,
	startDateKK, 5
,KK5 6
endDateKK7 >
)KK> ?
;KK? @
varLL 
resultLL 
=LL 
awaitLL 
handlerLL "
.LL" #
HandleAsyncLL# .
(LL. /
queryLL/ 4
)LL4 5
;LL5 6
returnMM 
OkMM 
(MM 
resultMM 
)MM 
;MM 
}NN 
[PP 
HttpGetPP 
(PP 
$strPP 
)PP 
]PP 
publicQQ 

asyncQQ 
TaskQQ 
<QQ 
ActionResultQQ "
<QQ" #
DeliveryReportDtoQQ# 4
>QQ4 5
>QQ5 6
GetDeliveryReportQQ7 H
(QQH I
[RR 	
	FromQueryRR	 
]RR 
DateTimeRR 
	startDateRR &
,RR& '
[SS 	
	FromQuerySS	 
]SS 
DateTimeSS 
endDateSS $
,SS$ %
[TT 	
FromServicesTT	 
]TT 
ApplicationTT "
.TT" #

InterfacesTT# -
.TT- .
IQueryHandlerTT. ;
<TT; <"
GetDeliveryReportQueryTT< R
,TTR S
DeliveryReportDtoTTT e
>TTe f
handlerTTg n
)TTn o
{UU 
varVV 
queryVV 
=VV 
newVV "
GetDeliveryReportQueryVV .
(VV. /
	startDateVV/ 8
,VV8 9
endDateVV: A
)VVA B
;VVB C
varWW 
resultWW 
=WW 
awaitWW 
handlerWW "
.WW" #
HandleAsyncWW# .
(WW. /
queryWW/ 4
)WW4 5
;WW5 6
returnXX 
OkXX 
(XX 
resultXX 
)XX 
;XX 
}YY 
}ZZ Ë7
vC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Api\Controllers\MenuGroupsController.cs
	namespace 	
Magidesk
 
. 
Api 
. 
Controllers "
;" #
[ 
ApiController 
] 
[		 
Route		 
(		 
$str		 
)		 
]		 
public

 
class

  
MenuGroupsController

 !
:

" #
ControllerBase

$ 2
{ 
private 
readonly  
IMenuGroupRepository )
_groupRepository* :
;: ;
private 
readonly 
ILogger 
<  
MenuGroupsController 1
>1 2
_logger3 :
;: ;
public 
 
MenuGroupsController 
(   
IMenuGroupRepository 
groupRepository ,
,, -
ILogger 
<  
MenuGroupsController $
>$ %
logger& ,
), -
{ 
_groupRepository 
= 
groupRepository *
;* +
_logger 
= 
logger 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
ActionResult "
<" #
IEnumerable# .
<. /
MenuGroupDto/ ;
>; <
>< =
>= >
	GetGroups? H
(H I
[ 	
	FromQuery	 
] 
Guid 
? 

categoryId $
=% &
null' +
,+ ,
[ 	
	FromQuery	 
] 
bool 
includeHidden &
=' (
false) .
). /
{   
try!! 
{"" 	
IEnumerable## 
<## 
Domain## 
.## 
Entities## '
.##' (
	MenuGroup##( 1
>##1 2
groups##3 9
;##9 :
if%% 
(%% 

categoryId%% 
.%% 
HasValue%% #
)%%# $
{&& 
groups'' 
='' 
await'' 
_groupRepository'' /
.''/ 0 
GetByCategoryIdAsync''0 D
(''D E

categoryId''E O
.''O P
Value''P U
)''U V
;''V W
}(( 
else)) 
{** 
groups++ 
=++ 
includeHidden++ &
?,, 
await,, 
_groupRepository,, ,
.,,, -
GetAllAsync,,- 8
(,,8 9
),,9 :
:-- 
await-- 
_groupRepository-- ,
.--, -
GetVisibleAsync--- <
(--< =
)--= >
;--> ?
}.. 
var00 
dtos00 
=00 
groups00 
.00 
Select00 $
(00$ %
g00% &
=>00' )
new00* -
MenuGroupDto00. :
{11 
Id22 
=22 
g22 
.22 
Id22 
,22 
Name33 
=33 
g33 
.33 
Name33 
,33 

CategoryId44 
=44 
g44 
.44 

CategoryId44 )
,44) *
CategoryName55 
=55 
g55  
.55  !
Category55! )
?55) *
.55* +
Name55+ /
??550 2
string553 9
.559 :
Empty55: ?
,55? @
	SortOrder66 
=66 
g66 
.66 
	SortOrder66 '
,66' (
	IsVisible77 
=77 
g77 
.77 
	IsVisible77 '
,77' (
ButtonColor88 
=88 
g88 
.88  
ButtonColor88  +
}99 
)99 
;99 
return;; 
Ok;; 
(;; 
dtos;; 
);; 
;;; 
}<< 	
catch== 
(== 
	Exception== 
ex== 
)== 
{>> 	
_logger?? 
.?? 
LogError?? 
(?? 
ex?? 
,??  
$str??! ?
)??? @
;??@ A
return@@ 

StatusCode@@ 
(@@ 
$num@@ !
,@@! "
new@@# &
{@@' (
Message@@) 0
=@@1 2
$str@@3 Q
}@@R S
)@@S T
;@@T U
}AA 	
}BB 
[GG 
HttpGetGG 
(GG 
$strGG 
)GG 
]GG 
publicHH 

asyncHH 
TaskHH 
<HH 
ActionResultHH "
<HH" #
MenuGroupDtoHH# /
>HH/ 0
>HH0 1
GetGroupHH2 :
(HH: ;
GuidHH; ?
idHH@ B
)HHB C
{II 
tryJJ 
{KK 	
varLL 
groupLL 
=LL 
awaitLL 
_groupRepositoryLL .
.LL. /
GetByIdAsyncLL/ ;
(LL; <
idLL< >
)LL> ?
;LL? @
ifNN 
(NN 
groupNN 
==NN 
nullNN 
)NN 
returnOO 
NotFoundOO 
(OO  
newOO  #
{OO$ %
MessageOO& -
=OO. /
$strOO0 A
}OOB C
)OOC D
;OOD E
varQQ 
dtoQQ 
=QQ 
newQQ 
MenuGroupDtoQQ &
{RR 
IdSS 
=SS 
groupSS 
.SS 
IdSS 
,SS 
NameTT 
=TT 
groupTT 
.TT 
NameTT !
,TT! "

CategoryIdUU 
=UU 
groupUU "
.UU" #

CategoryIdUU# -
,UU- .
CategoryNameVV 
=VV 
groupVV $
.VV$ %
CategoryVV% -
?VV- .
.VV. /
NameVV/ 3
??VV4 6
stringVV7 =
.VV= >
EmptyVV> C
,VVC D
	SortOrderWW 
=WW 
groupWW !
.WW! "
	SortOrderWW" +
,WW+ ,
	IsVisibleXX 
=XX 
groupXX !
.XX! "
	IsVisibleXX" +
,XX+ ,
ButtonColorYY 
=YY 
groupYY #
.YY# $
ButtonColorYY$ /
}ZZ 
;ZZ 
return\\ 
Ok\\ 
(\\ 
dto\\ 
)\\ 
;\\ 
}]] 	
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^ 
{__ 	
_logger`` 
.`` 
LogError`` 
(`` 
ex`` 
,``  
$str``! H
,``H I
id``J L
)``L M
;``M N
returnaa 

StatusCodeaa 
(aa 
$numaa !
,aa! "
newaa# &
{aa' (
Messageaa) 0
=aa1 2
$straa3 P
}aaQ R
)aaR S
;aaS T
}bb 	
}cc 
}dd ó/
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Api\Controllers\MenuCategoriesController.cs
	namespace 	
Magidesk
 
. 
Api 
. 
Controllers "
;" #
[ 
ApiController 
] 
[		 
Route		 
(		 
$str		 
)		 
]		 
public

 
class

 $
MenuCategoriesController

 %
:

& '
ControllerBase

( 6
{ 
private 
readonly #
IMenuCategoryRepository ,
_categoryRepository- @
;@ A
private 
readonly 
ILogger 
< $
MenuCategoriesController 5
>5 6
_logger7 >
;> ?
public 
$
MenuCategoriesController #
(# $#
IMenuCategoryRepository 
categoryRepository  2
,2 3
ILogger 
< $
MenuCategoriesController (
>( )
logger* 0
)0 1
{ 
_categoryRepository 
= 
categoryRepository 0
;0 1
_logger 
= 
logger 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
ActionResult "
<" #
IEnumerable# .
<. /
MenuCategoryDto/ >
>> ?
>? @
>@ A
GetCategoriesB O
(O P
[ 	
	FromQuery	 
] 
bool 
includeHidden &
=' (
false) .
). /
{ 
try 
{   	
var!! 

categories!! 
=!! 
includeHidden!! *
?"" 
await"" 
_categoryRepository"" +
.""+ ,
GetAllAsync"", 7
(""7 8
)""8 9
:## 
await## 
_categoryRepository## +
.##+ ,
GetVisibleAsync##, ;
(##; <
)##< =
;##= >
var%% 
dtos%% 
=%% 

categories%% !
.%%! "
Select%%" (
(%%( )
c%%) *
=>%%+ -
new%%. 1
MenuCategoryDto%%2 A
{&& 
Id'' 
='' 
c'' 
.'' 
Id'' 
,'' 
Name(( 
=(( 
c(( 
.(( 
Name(( 
,(( 
	SortOrder)) 
=)) 
c)) 
.)) 
	SortOrder)) '
,))' (
	IsVisible** 
=** 
c** 
.** 
	IsVisible** '
,**' (

IsBeverage++ 
=++ 
c++ 
.++ 

IsBeverage++ )
,++) *
ButtonColor,, 
=,, 
c,, 
.,,  
ButtonColor,,  +
}-- 
)-- 
;-- 
return// 
Ok// 
(// 
dtos// 
)// 
;// 
}00 	
catch11 
(11 
	Exception11 
ex11 
)11 
{22 	
_logger33 
.33 
LogError33 
(33 
ex33 
,33  
$str33! C
)33C D
;33D E
return44 

StatusCode44 
(44 
$num44 !
,44! "
new44# &
{44' (
Message44) 0
=441 2
$str443 U
}44V W
)44W X
;44X Y
}55 	
}66 
[;; 
HttpGet;; 
(;; 
$str;; 
);; 
];; 
public<< 

async<< 
Task<< 
<<< 
ActionResult<< "
<<<" #
MenuCategoryDto<<# 2
><<2 3
><<3 4
GetCategory<<5 @
(<<@ A
Guid<<A E
id<<F H
)<<H I
{== 
try>> 
{?? 	
var@@ 
category@@ 
=@@ 
await@@  
_categoryRepository@@! 4
.@@4 5
GetByIdAsync@@5 A
(@@A B
id@@B D
)@@D E
;@@E F
ifBB 
(BB 
categoryBB 
==BB 
nullBB  
)BB  !
returnCC 
NotFoundCC 
(CC  
newCC  #
{CC$ %
MessageCC& -
=CC. /
$strCC0 D
}CCE F
)CCF G
;CCG H
varEE 
dtoEE 
=EE 
newEE 
MenuCategoryDtoEE )
{FF 
IdGG 
=GG 
categoryGG 
.GG 
IdGG  
,GG  !
NameHH 
=HH 
categoryHH 
.HH  
NameHH  $
,HH$ %
	SortOrderII 
=II 
categoryII $
.II$ %
	SortOrderII% .
,II. /
	IsVisibleJJ 
=JJ 
categoryJJ $
.JJ$ %
	IsVisibleJJ% .
,JJ. /

IsBeverageKK 
=KK 
categoryKK %
.KK% &

IsBeverageKK& 0
,KK0 1
ButtonColorLL 
=LL 
categoryLL &
.LL& '
ButtonColorLL' 2
}MM 
;MM 
returnOO 
OkOO 
(OO 
dtoOO 
)OO 
;OO 
}PP 	
catchQQ 
(QQ 
	ExceptionQQ 
exQQ 
)QQ 
{RR 	
_loggerSS 
.SS 
LogErrorSS 
(SS 
exSS 
,SS  
$strSS! N
,SSN O
idSSP R
)SSR S
;SSS T
returnTT 

StatusCodeTT 
(TT 
$numTT !
,TT! "
newTT# &
{TT' (
MessageTT) 0
=TT1 2
$strTT3 S
}TTT U
)TTU V
;TTV W
}UU 	
}VV 
}WW • 
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Api\Controllers\KitchenController.cs
	namespace 	
Magidesk
 
. 
Api 
. 
Controllers "
;" #
[ 
ApiController 
] 
[		 
Route		 
(		 
$str		 
)		 
]		 
public

 
class

 
KitchenController

 
:

  
ControllerBase

! /
{ 
private 
readonly "
IKitchenRoutingService +
_routingService, ;
;; <
private 
readonly !
IKitchenStatusService *
_statusService+ 9
;9 :
private 
readonly #
IKitchenOrderRepository ,
_orderRepository- =
;= >
public 

KitchenController 
( "
IKitchenRoutingService 
routingService -
,- .!
IKitchenStatusService 
statusService +
,+ ,#
IKitchenOrderRepository 
orderRepository  /
)/ 0
{ 
_routingService 
= 
routingService (
;( )
_statusService 
= 
statusService &
;& '
_orderRepository 
= 
orderRepository *
;* +
} 
[ 
HttpGet 
( 
$str 
) 
] 
public 

async 
Task 
< 
IActionResult #
># $
	GetOrders% .
(. /
)/ 0
{ 
try 
{ 	
var 
orders 
= 
await 
_orderRepository /
./ 0 
GetActiveOrdersAsync0 D
(D E
)E F
;F G
return   
Ok   
(   
orders   
)   
;   
}!! 	
catch"" 
("" 
	Exception"" 
ex"" 
)"" 
{## 	
return$$ 

BadRequest$$ 
($$ 
ex$$  
.$$  !
Message$$! (
)$$( )
;$$) *
}%% 	
}&& 
[(( 
HttpPost(( 
((( 
$str((  
)((  !
]((! "
public)) 

async)) 
Task)) 
<)) 
IActionResult)) #
>))# $
	BumpOrder))% .
()). /
Guid))/ 3
id))4 6
)))6 7
{** 
try++ 
{,, 	
await-- 
_statusService--  
.--  !
BumpOrderAsync--! /
(--/ 0
id--0 2
)--2 3
;--3 4
return.. 
Ok.. 
(.. 
).. 
;.. 
}// 	
catch00 
(00 
	Exception00 
ex00 
)00 
{11 	
return22 

BadRequest22 
(22 
ex22  
.22  !
Message22! (
)22( )
;22) *
}33 	
}44 
[66 
HttpPost66 
(66 
$str66  
)66  !
]66! "
public77 

async77 
Task77 
<77 
IActionResult77 #
>77# $
	VoidOrder77% .
(77. /
Guid77/ 3
id774 6
)776 7
{88 
try99 
{:: 	
await;; 
_statusService;;  
.;;  !
VoidOrderAsync;;! /
(;;/ 0
id;;0 2
);;2 3
;;;3 4
return<< 
Ok<< 
(<< 
)<< 
;<< 
}== 	
catch>> 
(>> 
	Exception>> 
ex>> 
)>> 
{?? 	
return@@ 

BadRequest@@ 
(@@ 
ex@@  
.@@  !
Message@@! (
)@@( )
;@@) *
}AA 	
}BB 
}CC “-
pC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Api\Controllers\CashController.cs
	namespace 	
Magidesk
 
. 
Api 
. 
Controllers "
;" #
[

 
ApiController

 
]

 
[ 
Route 
( 
$str 
) 
] 
public 
class 
CashController 
: 
ControllerBase ,
{ 
private 
readonly 
ICashSessionService (
_cashSessionService) <
;< =
public 

CashController 
( 
ICashSessionService -
cashSessionService. @
)@ A
{ 
_cashSessionService 
= 
cashSessionService 0
;0 1
} 
[ 
HttpPost 
( 
$str 
) 
] 
public 

async 
Task 
< 
IActionResult #
># $
StartSession% 1
(1 2
[2 3
FromBody3 ;
]; <
StartSessionRequest= P
requestQ X
)X Y
{ 
try 
{ 	
var 
session 
= 
await 
_cashSessionService  3
.3 4
StartSessionAsync4 E
(E F
new 
UserId 
( 
request "
." #
UserId# )
)) *
,* +
request 
. 

TerminalId "
," #
request 
. 
ShiftId 
,  
new   
Money   
(   
request   !
.  ! "
OpeningAmount  " /
,  / 0
$str  1 6
)  6 7
)  7 8
;  8 9
return!! 
Ok!! 
(!! 
session!! 
)!! 
;!! 
}"" 	
catch## 
(## 
	Exception## 
ex## 
)## 
{$$ 	
return%% 

BadRequest%% 
(%% 
ex%%  
.%%  !
Message%%! (
)%%( )
;%%) *
}&& 	
}'' 
[)) 
HttpPost)) 
()) 
$str)) #
)))# $
]))$ %
public** 

async** 
Task** 
<** 
IActionResult** #
>**# $
CloseSession**% 1
(**1 2
Guid**2 6
id**7 9
,**9 :
[**; <
FromBody**< D
]**D E
CloseSessionRequest**F Y
request**Z a
)**a b
{++ 
try,, 
{-- 	
var.. 
session.. 
=.. 
await..  
_cashSessionService..! 4
...4 5
CloseSessionAsync..5 F
(..F G
id// 
,// 
new00 
UserId00 
(00 
request00 #
.00# $
ClosedByUserId00$ 2
)002 3
,003 4
new11 
Money11 
(11 
request11 "
.11" #
ClosingAmount11# 0
,110 1
$str112 7
)117 8
)118 9
;119 :
return22 
Ok22 
(22 
session22 
)22 
;22  
}33 	
catch44 
(44 
	Exception44 
ex44 
)44 
{55 	
return66 

BadRequest66 
(66 
ex66  
.66  !
Message66! (
)66( )
;66) *
}77 	
}88 
[:: 
HttpGet:: 
(:: 
$str:: ,
)::, -
]::- .
public;; 

async;; 
Task;; 
<;; 
IActionResult;; #
>;;# $"
GetActiveSessionByUser;;% ;
(;;; <
Guid;;< @
userId;;A G
);;G H
{<< 
var== 
session== 
=== 
await== 
_cashSessionService== /
.==/ 0'
GetActiveSessionByUserAsync==0 K
(==K L
new==L O
UserId==P V
(==V W
userId==W ]
)==] ^
)==^ _
;==_ `
if>> 

(>> 
session>> 
==>> 
null>> 
)>> 
return>> #
NotFound>>$ ,
(>>, -
)>>- .
;>>. /
return?? 
Ok?? 
(?? 
session?? 
)?? 
;?? 
}@@ 
}AA 
publicCC 
classCC 
StartSessionRequestCC  
{DD 
publicEE 

GuidEE 
UserIdEE 
{EE 
getEE 
;EE 
setEE !
;EE! "
}EE# $
publicFF 

GuidFF 

TerminalIdFF 
{FF 
getFF  
;FF  !
setFF" %
;FF% &
}FF' (
publicGG 

GuidGG 
ShiftIdGG 
{GG 
getGG 
;GG 
setGG "
;GG" #
}GG$ %
publicHH 

decimalHH 
OpeningAmountHH  
{HH! "
getHH# &
;HH& '
setHH( +
;HH+ ,
}HH- .
}II 
publicKK 
classKK 
CloseSessionRequestKK  
{LL 
publicMM 

GuidMM 
ClosedByUserIdMM 
{MM  
getMM! $
;MM$ %
setMM& )
;MM) *
}MM+ ,
publicNN 

decimalNN 
ClosingAmountNN  
{NN! "
getNN# &
;NN& '
setNN( +
;NN+ ,
}NN- .
}OO 