ê1
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\VoidTicketCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class $
VoidTicketCommandHandler %
:& '
ICommandHandler( 7
<7 8
VoidTicketCommand8 I
>I J
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
Domain 
. 
DomainServices *
.* +
TicketDomainService+ > 
_ticketDomainService? S
;S T
private 
readonly 
ISecurityService %
_securityService& 6
;6 7
public 
$
VoidTicketCommandHandler #
(# $
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
,2 3
Domain 
. 
DomainServices 
. 
TicketDomainService 1
ticketDomainService2 E
,E F
ISecurityService 
securityService (
)( )
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5 
_ticketDomainService 
= 
ticketDomainService 2
;2 3
_securityService 
= 
securityService *
;* +
} 
public 

async 
Task 
HandleAsync !
(! "
VoidTicketCommand" 3
command4 ;
,; <
CancellationToken= N
cancellationTokenO `
=a b
defaultc j
)j k
{ 
var!! 
ticket!! 
=!! 
await!! 
_ticketRepository!! ,
.!!, -
GetByIdAsync!!- 9
(!!9 :
command!!: A
.!!A B
TicketId!!B J
,!!J K
cancellationToken!!L ]
)!!] ^
;!!^ _
if"" 

("" 
ticket"" 
=="" 
null"" 
)"" 
{## 	
throw$$ 
new$$ 
Domain$$ 
.$$ 

Exceptions$$ '
.$$' (*
BusinessRuleViolationException$$( F
($$F G
$"$$G I
$str$$I P
{$$P Q
command$$Q X
.$$X Y
TicketId$$Y a
}$$a b
$str$$b m
"$$m n
)$$n o
;$$o p
}%% 	
if(( 

((( 
!(( 
await(( 
_securityService(( #
.((# $
HasPermissionAsync(($ 6
(((6 7
command((7 >
.((> ?
VoidedBy((? G
,((G H
Domain((I O
.((O P
Enumerations((P \
.((\ ]
UserPermission((] k
.((k l

VoidTicket((l v
,((v w
cancellationToken	((x â
)
((â ä
)
((ä ã
{)) 	
throw** 
new** 
Domain** 
.** 

Exceptions** (
.**( )*
BusinessRuleViolationException**) G
(**G H
$str**H x
)**x y
;**y z
}++ 	
if.. 

(.. 
!..  
_ticketDomainService.. !
...! "
CanVoidTicket.." /
(../ 0
ticket..0 6
)..6 7
)..7 8
{// 	
throw00 
new00 
Domain00 
.00 

Exceptions00 '
.00' (%
InvalidOperationException00( A
(00A B
$"00B D
$str00D K
{00K L
ticket00L R
.00R S
TicketNumber00S _
}00_ `
$str00` r
"00r s
)00s t
;00t u
}11 	
ticket44 
.44 
Void44 
(44 
command44 
.44 
VoidedBy44 $
,44$ %
command44& -
.44- .
Reason44. 4
,444 5
command446 =
.44= >
IsWasted44> F
)44F G
;44G H
await77 
_ticketRepository77 
.77  
UpdateAsync77  +
(77+ ,
ticket77, 2
,772 3
cancellationToken774 E
)77E F
;77F G
var:: 
correlationId:: 
=:: 
Guid::  
.::  !
NewGuid::! (
(::( )
)::) *
;::* +
var;; 

auditEvent;; 
=;; 

AuditEvent;; #
.;;# $
Create;;$ *
(;;* +
AuditEventType<< 
.<< 
Voided<< !
,<<! "
nameof== 
(== 
Domain== 
.== 
Entities== "
.==" #
Ticket==# )
)==) *
,==* +
ticket>> 
.>> 
Id>> 
,>> 
command?? 
.?? 
VoidedBy?? 
.?? 
Value?? "
,??" #
System@@ 
.@@ 
Text@@ 
.@@ 
Json@@ 
.@@ 
JsonSerializer@@ +
.@@+ ,
	Serialize@@, 5
(@@5 6
new@@6 9
{@@: ;
Status@@< B
=@@C D
ticket@@E K
.@@K L
Status@@L R
}@@S T
)@@T U
,@@U V
$"AA 
$strAA 
{AA 
ticketAA 
.AA 
TicketNumberAA )
}AA) *
$strAA* 1
"AA1 2
,AA2 3
correlationIdBB 
:BB 
correlationIdBB (
)BB( )
;BB) *
awaitDD !
_auditEventRepositoryDD #
.DD# $
AddAsyncDD$ ,
(DD, -

auditEventDD- 7
,DD7 8
cancellationTokenDD9 J
)DDJ K
;DDK L
}EE 
}FF õF
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\VoidCardPaymentCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class )
VoidCardPaymentCommandHandler *
:+ ,
ICommandHandler- <
<< ="
VoidCardPaymentCommand= S
,S T!
VoidCardPaymentResultU j
>j k
{ 
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly 
IPaymentGateway $
_paymentGateway% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
)
VoidCardPaymentCommandHandler (
(( )
IPaymentRepository 
paymentRepository ,
,, -
IPaymentGateway 
paymentGateway &
,& '!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_paymentRepository 
= 
paymentRepository .
;. /
_paymentGateway 
= 
paymentGateway (
;( )!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< !
VoidCardPaymentResult +
>+ ,
HandleAsync- 8
(8 9"
VoidCardPaymentCommand 
command &
,& '
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
{   
var"" 
payment"" 
="" 
await"" 
_paymentRepository"" .
."". /
GetByIdAsync""/ ;
(""; <
command""< C
.""C D
	PaymentId""D M
,""M N
cancellationToken""O `
)""` a
;""a b
if## 

(## 
payment## 
==## 
null## 
)## 
{$$ 	
return%% 
new%% !
VoidCardPaymentResult%% ,
{&& 
Success'' 
='' 
false'' 
,''  
ErrorMessage(( 
=(( 
$"(( !
$str((! )
{(() *
command((* 1
.((1 2
	PaymentId((2 ;
}((; <
$str((< G
"((G H
})) 
;)) 
}** 	
if-- 

(-- 
payment-- 
is-- 
not-- 
CreditCardPayment-- ,
creditCardPayment--- >
)--> ?
{.. 	
return// 
new// !
VoidCardPaymentResult// ,
{00 
Success11 
=11 
false11 
,11  
ErrorMessage22 
=22 
$"22 !
$str22! )
{22) *
command22* 1
.221 2
	PaymentId222 ;
}22; <
$str22< Z
"22Z [
}33 
;33 
}44 	
if77 

(77 
creditCardPayment77 
.77 
IsVoided77 &
)77& '
{88 	
return99 
new99 !
VoidCardPaymentResult99 ,
{:: 
Success;; 
=;; 
false;; 
,;;  
ErrorMessage<< 
=<< 
$str<< ;
}== 
;== 
}>> 	
if@@ 

(@@ 
creditCardPayment@@ 
.@@ 

IsCaptured@@ (
)@@( )
{AA 	
returnBB 
newBB !
VoidCardPaymentResultBB ,
{CC 
SuccessDD 
=DD 
falseDD 
,DD  
ErrorMessageEE 
=EE 
$strEE T
}FF 
;FF 
}GG 	
ifII 

(II 
stringII 
.II 
IsNullOrEmptyII  
(II  !
creditCardPaymentII! 2
.II2 3
AuthorizationCodeII3 D
)IID E
)IIE F
{JJ 	
returnKK 
newKK !
VoidCardPaymentResultKK ,
{LL 
SuccessMM 
=MM 
falseMM 
,MM  
ErrorMessageNN 
=NN 
$strNN H
}OO 
;OO 
}PP 	
varSS 
gatewayResultSS 
=SS 
awaitSS !
_paymentGatewaySS" 1
.SS1 2
	VoidAsyncSS2 ;
(SS; <
creditCardPaymentTT 
,TT 
cancellationTokenUU 
)UU 
;UU 
ifWW 

(WW 
!WW 
gatewayResultWW 
.WW 
SuccessWW "
)WW" #
{XX 	
varZZ 

auditEventZZ 
=ZZ 

AuditEventZZ '
.ZZ' (
CreateZZ( .
(ZZ. /
AuditEventType[[ 
.[[ 
PaymentProcessed[[ /
,[[/ 0
nameof\\ 
(\\ 
Payment\\ 
)\\ 
,\\  
payment]] 
.]] 
Id]] 
,]] 
command^^ 
.^^ 
ProcessedBy^^ #
.^^# $
Value^^$ )
,^^) *
System__ 
.__ 
Text__ 
.__ 
Json__  
.__  !
JsonSerializer__! /
.__/ 0
	Serialize__0 9
(__9 :
new__: =
{__> ?
Action`` 
=`` 
$str`` #
,``# $
Successaa 
=aa 
falseaa #
,aa# $
Errorbb 
=bb 
gatewayResultbb )
.bb) *
ErrorMessagebb* 6
}cc 
)cc 
,cc 
$"dd 
$strdd ,
{dd, -
gatewayResultdd- :
.dd: ;
ErrorMessagedd; G
}ddG H
"ddH I
,ddI J
correlationIdee 
:ee 
Guidee #
.ee# $
NewGuidee$ +
(ee+ ,
)ee, -
)ee- .
;ee. /
awaitgg !
_auditEventRepositorygg '
.gg' (
AddAsyncgg( 0
(gg0 1

auditEventgg1 ;
,gg; <
cancellationTokengg= N
)ggN O
;ggO P
returnii 
newii !
VoidCardPaymentResultii ,
{jj 
Successkk 
=kk 
falsekk 
,kk  
ErrorMessagell 
=ll 
gatewayResultll ,
.ll, -
ErrorMessagell- 9
}mm 
;mm 
}nn 	
creditCardPaymentqq 
.qq 
Voidqq 
(qq 
)qq  
;qq  !
awaittt 
_paymentRepositorytt  
.tt  !
UpdateAsynctt! ,
(tt, -
creditCardPaymenttt- >
,tt> ?
cancellationTokentt@ Q
)ttQ R
;ttR S
varww 
successAuditEventww 
=ww 

AuditEventww  *
.ww* +
Createww+ 1
(ww1 2
AuditEventTypexx 
.xx 
Voidedxx !
,xx! "
nameofyy 
(yy 
Paymentyy 
)yy 
,yy 
paymentzz 
.zz 
Idzz 
,zz 
command{{ 
.{{ 
ProcessedBy{{ 
.{{  
Value{{  %
,{{% &
System|| 
.|| 
Text|| 
.|| 
Json|| 
.|| 
JsonSerializer|| +
.||+ ,
	Serialize||, 5
(||5 6
new||6 9
{||: ;
Action}} 
=}} 
$str}} 
,}}  
Success~~ 
=~~ 
true~~ 
,~~ 
VoidCode 
= 
gatewayResult (
.( )
VoidCode) 1
}
ÄÄ 
)
ÄÄ 
,
ÄÄ 
$"
ÅÅ 
$str
ÅÅ #
{
ÅÅ# $
gatewayResult
ÅÅ$ 1
.
ÅÅ1 2
VoidCode
ÅÅ2 :
}
ÅÅ: ;
"
ÅÅ; <
,
ÅÅ< =
correlationId
ÇÇ 
:
ÇÇ 
Guid
ÇÇ 
.
ÇÇ  
NewGuid
ÇÇ  '
(
ÇÇ' (
)
ÇÇ( )
)
ÇÇ) *
;
ÇÇ* +
await
ÑÑ #
_auditEventRepository
ÑÑ #
.
ÑÑ# $
AddAsync
ÑÑ$ ,
(
ÑÑ, -
successAuditEvent
ÑÑ- >
,
ÑÑ> ?
cancellationToken
ÑÑ@ Q
)
ÑÑQ R
;
ÑÑR S
return
ÜÜ 
new
ÜÜ #
VoidCardPaymentResult
ÜÜ (
{
áá 	
Success
àà 
=
àà 
true
àà 
,
àà 
VoidCode
ââ 
=
ââ 
gatewayResult
ââ $
.
ââ$ %
VoidCode
ââ% -
}
ää 	
;
ää	 

}
ãã 
}åå òf
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\User\UserCommandHandlers.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class $
CreateUserCommandHandler %
:& '
ICommandHandler( 7
<7 8
CreateUserCommand8 I
,I J
CreateUserResultK [
>[ \
{ 
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
private 
readonly !
IAesEncryptionService *
_encryptionService+ =
;= >
private 
readonly 
IRoleRepository $
_roleRepository% 4
;4 5
public 
$
CreateUserCommandHandler #
(# $
IUserRepository$ 3
userRepository4 B
,B C!
IAesEncryptionServiceD Y
encryptionServiceZ k
,k l
IRoleRepositorym |
roleRepository	} ã
)
ã å
{ 
_userRepository 
= 
userRepository (
;( )
_encryptionService 
= 
encryptionService .
;. /
_roleRepository 
= 
roleRepository (
;( )
} 
public 

async 
Task 
< 
CreateUserResult &
>& '
HandleAsync( 3
(3 4
CreateUserCommand4 E
commandF M
,M N
CancellationTokenO `
cancellationTokena r
=s t
defaultu |
)| }
{ 
try 
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
command* 1
.1 2
	FirstName2 ;
); <
)< =
return 
new 
CreateUserResult +
{, -
	IsSuccess. 7
=8 9
false: ?
,? @
MessageA H
=I J
$strK c
}d e
;e f
var!! 
role!! 
=!! 
await!! 
_roleRepository!! ,
.!!, -
GetByIdAsync!!- 9
(!!9 :
command!!: A
.!!A B
RoleId!!B H
,!!H I
cancellationToken!!J [
)!![ \
;!!\ ]
if"" 
("" 
role"" 
=="" 
null"" 
)"" 
return## 
new## 
CreateUserResult## +
{##, -
	IsSuccess##. 7
=##8 9
false##: ?
,##? @
Message##A H
=##I J
$str##K c
}##d e
;##e f
var%% 
encryptedPin%% 
=%% 
_encryptionService%% 1
.%%1 2
Encrypt%%2 9
(%%9 :
command%%: A
.%%A B
Pin%%B E
)%%E F
;%%F G
var&& 
existing&& 
=&& 
await&&  
_userRepository&&! 0
.&&0 1
GetByPinAsync&&1 >
(&&> ?
encryptedPin&&? K
,&&K L
cancellationToken&&M ^
)&&^ _
;&&_ `
if'' 
('' 
existing'' 
!='' 
null''  
)''  !
return(( 
new(( 
CreateUserResult(( +
{((, -
	IsSuccess((. 7
=((8 9
false((: ?
,((? @
Message((A H
=((I J
$str((K c
}((d e
;((e f
var** 
user** 
=** 
User** 
.** 
Create** "
(**" #
username++ 
:++ 
string++  
.++  !
IsNullOrWhiteSpace++! 3
(++3 4
command++4 ;
.++; <
Username++< D
)++D E
?++F G
command++H O
.++O P
	FirstName++P Y
.++Y Z
ToLower++Z a
(++a b
)++b c
:++d e
command++f m
.++m n
Username++n v
,++v w
	firstName,, 
:,, 
command,, "
.,," #
	FirstName,,# ,
,,,, -
lastName-- 
:-- 
command-- !
.--! "
LastName--" *
,--* +
roleId.. 
:.. 
command.. 
...  
RoleId..  &
,..& '
encryptedPin// 
:// 
encryptedPin// *
)00 
;00 
await22 
_userRepository22 !
.22! "
AddAsync22" *
(22* +
user22+ /
,22/ 0
cancellationToken221 B
)22B C
;22C D
return44 
new44 
CreateUserResult44 '
{44( )
UserId44* 0
=441 2
user443 7
.447 8
Id448 :
,44: ;
	IsSuccess44< E
=44F G
true44H L
}44M N
;44N O
}55 	
catch66 
(66 
	Exception66 
ex66 
)66 
{77 	
return88 
new88 
CreateUserResult88 '
{88( )
	IsSuccess88* 3
=884 5
false886 ;
,88; <
Message88= D
=88E F
ex88G I
.88I J
Message88J Q
}88R S
;88S T
}99 	
}:: 
};; 
public== 
class== $
UpdateUserCommandHandler== %
:==& '
ICommandHandler==( 7
<==7 8
UpdateUserCommand==8 I
,==I J
UpdateUserResult==K [
>==[ \
{>> 
private?? 
readonly?? 
IUserRepository?? $
_userRepository??% 4
;??4 5
private@@ 
readonly@@ !
IAesEncryptionService@@ *
_encryptionService@@+ =
;@@= >
privateAA 
readonlyAA 
IRoleRepositoryAA $
_roleRepositoryAA% 4
;AA4 5
publicCC 
$
UpdateUserCommandHandlerCC #
(CC# $
IUserRepositoryCC$ 3
userRepositoryCC4 B
,CCB C!
IAesEncryptionServiceCCD Y
encryptionServiceCCZ k
,CCk l
IRoleRepositoryCCm |
roleRepository	CC} ã
)
CCã å
{DD 
_userRepositoryEE 
=EE 
userRepositoryEE (
;EE( )
_encryptionServiceFF 
=FF 
encryptionServiceFF .
;FF. /
_roleRepositoryGG 
=GG 
roleRepositoryGG (
;GG( )
}HH 
publicJJ 

asyncJJ 
TaskJJ 
<JJ 
UpdateUserResultJJ &
>JJ& '
HandleAsyncJJ( 3
(JJ3 4
UpdateUserCommandJJ4 E
commandJJF M
,JJM N
CancellationTokenJJO `
cancellationTokenJJa r
=JJs t
defaultJJu |
)JJ| }
{KK 
tryLL 
{MM 	
varNN 
userNN 
=NN 
awaitNN 
_userRepositoryNN ,
.NN, -
GetByIdAsyncNN- 9
(NN9 :
commandNN: A
.NNA B
UserIdNNB H
,NNH I
cancellationTokenNNJ [
)NN[ \
;NN\ ]
ifOO 
(OO 
userOO 
==OO 
nullOO 
)OO 
returnPP 
newPP 
UpdateUserResultPP +
{PP, -
	IsSuccessPP. 7
=PP8 9
falsePP: ?
,PP? @
MessagePPA H
=PPI J
$strPPK [
}PP\ ]
;PP] ^
varSS 
roleSS 
=SS 
awaitSS 
_roleRepositorySS ,
.SS, -
GetByIdAsyncSS- 9
(SS9 :
commandSS: A
.SSA B
RoleIdSSB H
,SSH I
cancellationTokenSSJ [
)SS[ \
;SS\ ]
ifTT 
(TT 
roleTT 
==TT 
nullTT 
)TT 
returnUU 
newUU 
UpdateUserResultUU ,
{UU- .
	IsSuccessUU/ 8
=UU9 :
falseUU; @
,UU@ A
MessageUUB I
=UUJ K
$strUUL d
}UUe f
;UUf g
userll 
.ll 
UpdateDetailsll 
(ll 
commandll &
.ll& '
	FirstNamell' 0
,ll0 1
commandll2 9
.ll9 :
LastNamell: B
)llB C
;llC D
usermm 
.mm 
SetRolemm 
(mm 
commandmm  
.mm  !
RoleIdmm! '
)mm' (
;mm( )
ifoo 
(oo 
commandoo 
.oo 
IsActiveoo  
)oo  !
useroo" &
.oo& '
Activateoo' /
(oo/ 0
)oo0 1
;oo1 2
elseoo3 7
useroo8 <
.oo< =

Deactivateoo= G
(ooG H
)ooH I
;ooI J
ifrr 
(rr 
!rr 
stringrr 
.rr 
IsNullOrWhiteSpacerr *
(rr* +
commandrr+ 2
.rr2 3
Pinrr3 6
)rr6 7
)rr7 8
{ss 
usertt 
.tt 
SetPintt 
(tt 
_encryptionServicett /
.tt/ 0
Encrypttt0 7
(tt7 8
commandtt8 ?
.tt? @
Pintt@ C
)ttC D
)ttD E
;ttE F
}uu 
awaitww 
_userRepositoryww !
.ww! "
UpdateAsyncww" -
(ww- .
userww. 2
,ww2 3
cancellationTokenww4 E
)wwE F
;wwF G
returnyy 
newyy 
UpdateUserResultyy '
{yy( )
	IsSuccessyy* 3
=yy4 5
trueyy6 :
}yy; <
;yy< =
}zz 	
catch{{ 
({{ 
	Exception{{ 
ex{{ 
){{ 
{|| 	
return}} 
new}} 
UpdateUserResult}} '
{}}( )
	IsSuccess}}* 3
=}}4 5
false}}6 ;
,}}; <
Message}}= D
=}}E F
ex}}G I
.}}I J
Message}}J Q
}}}R S
;}}S T
}~~ 	
} 
}ÄÄ 
publicÇÇ 
class
ÇÇ &
DeleteUserCommandHandler
ÇÇ %
:
ÇÇ& '
ICommandHandler
ÇÇ( 7
<
ÇÇ7 8
DeleteUserCommand
ÇÇ8 I
,
ÇÇI J
DeleteUserResult
ÇÇK [
>
ÇÇ[ \
{ÉÉ 
private
ÑÑ 
readonly
ÑÑ 
IUserRepository
ÑÑ $
_userRepository
ÑÑ% 4
;
ÑÑ4 5
public
ÜÜ 
&
DeleteUserCommandHandler
ÜÜ #
(
ÜÜ# $
IUserRepository
ÜÜ$ 3
userRepository
ÜÜ4 B
)
ÜÜB C
{
áá 
_userRepository
àà 
=
àà 
userRepository
àà (
;
àà( )
}
ââ 
public
ãã 

async
ãã 
Task
ãã 
<
ãã 
DeleteUserResult
ãã &
>
ãã& '
HandleAsync
ãã( 3
(
ãã3 4
DeleteUserCommand
ãã4 E
command
ããF M
,
ããM N
CancellationToken
ããO `
cancellationToken
ããa r
=
ããs t
default
ããu |
)
ãã| }
{
åå 
try
çç	 
{
éé 	
var
èè 
user
èè 
=
èè 
await
èè 
_userRepository
èè ,
.
èè, -
GetByIdAsync
èè- 9
(
èè9 :
command
èè: A
.
èèA B
UserId
èèB H
,
èèH I
cancellationToken
èèJ [
)
èè[ \
;
èè\ ]
if
êê 
(
êê 
user
êê 
==
êê 
null
êê 
)
êê 
return
êê $
new
êê% (
DeleteUserResult
êê) 9
{
êê: ;
	IsSuccess
êê< E
=
êêF G
false
êêH M
,
êêM N
Message
êêO V
=
êêW X
$str
êêY i
}
êêj k
;
êêk l
await
óó 
_userRepository
óó !
.
óó! "
DeleteAsync
óó" -
(
óó- .
user
óó. 2
,
óó2 3
cancellationToken
óó4 E
)
óóE F
;
óóF G
return
òò 
new
òò 
DeleteUserResult
òò '
{
òò( )
	IsSuccess
òò* 3
=
òò4 5
true
òò6 :
}
òò; <
;
òò< =
}
ôô 	
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö 
{
õõ 	
return
úú 
new
úú 
DeleteUserResult
úú '
{
úú( )
	IsSuccess
úú* 3
=
úú4 5
false
úú6 ;
,
úú; <
Message
úú= D
=
úúE F
ex
úúG I
.
úúI J
Message
úúJ Q
}
úúR S
;
úúS T
}
ùù 	
}ûû 
}üü Í
ÖC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\UpdateTicketNoteCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class *
UpdateTicketNoteCommandHandler +
:, -
ICommandHandler. =
<= >#
UpdateTicketNoteCommand> U
>U V
{ 
private		 
readonly		 
ITicketRepository		 &
_ticketRepository		' 8
;		8 9
public 
*
UpdateTicketNoteCommandHandler )
() *
ITicketRepository* ;
ticketRepository< L
)L M
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
} 
public 

async 
Task 
HandleAsync !
(! "#
UpdateTicketNoteCommand" 9
command: A
,A B
CancellationTokenC T
cancellationTokenU f
=g h
defaulti p
)p q
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
)J K
;K L
if 

( 
ticket 
== 
null 
) 
{ 	
throw 
new  
KeyNotFoundException *
(* +
$"+ -
$str- <
{< =
command= D
.D E
TicketIdE M
}M N
$strN Y
"Y Z
)Z [
;[ \
} 	
ticket 
. 
SetNote 
( 
command 
. 
Note #
)# $
;$ %
await 
_ticketRepository 
.  
UpdateAsync  +
(+ ,
ticket, 2
)2 3
;3 4
} 
} ¡@
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\UpdateTableCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
UpdateTableCommandHandler &
:' (
ICommandHandler) 8
<8 9
UpdateTableCommand9 K
,K L
UpdateTableResultM ^
>^ _
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
%
UpdateTableCommandHandler $
($ %
ITableRepository 
tableRepository (
,( )!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_tableRepository 
= 
tableRepository *
;* +!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
UpdateTableResult '
>' (
HandleAsync) 4
(4 5
UpdateTableCommand5 G
commandH O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
table 
= 
await 
_tableRepository *
.* +
GetByIdAsync+ 7
(7 8
command8 ?
.? @
TableId@ G
,G H
cancellationTokenI Z
)Z [
;[ \
if 

( 
table 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI O
{O P
commandP W
.W X
TableIdX _
}_ `
$str` k
"k l
)l m
;m n
} 	
if"" 

("" 
command"" 
."" 
TableNumber"" 
.""  
HasValue""  (
)""( )
{## 	
var%% 
existingTable%% 
=%% 
await%%  %
_tableRepository%%& 6
.%%6 7!
GetByTableNumberAsync%%7 L
(%%L M
command%%M T
.%%T U
TableNumber%%U `
.%%` a
Value%%a f
,%%f g
cancellationToken%%h y
)%%y z
;%%z {
if&& 
(&& 
existingTable&& 
!=&&  
null&&! %
&&&&& (
existingTable&&) 6
.&&6 7
Id&&7 9
!=&&: <
table&&= B
.&&B C
Id&&C E
)&&E F
{'' 
throw(( 
new(( 
Domain((  
.((  !

Exceptions((! +
.((+ ,*
BusinessRuleViolationException((, J
(((J K
$"((K M
$str((M Z
{((Z [
command(([ b
.((b c
TableNumber((c n
.((n o
Value((o t
}((t u
$str	((u Ö
"
((Ö Ü
)
((Ü á
;
((á à
})) 
table++ 
.++ 
UpdateTableNumber++ #
(++# $
command++$ +
.+++ ,
TableNumber++, 7
.++7 8
Value++8 =
)++= >
;++> ?
},, 	
if.. 

(.. 
command.. 
... 
Capacity.. 
... 
HasValue.. %
)..% &
{// 	
table00 
.00 
UpdateCapacity00  
(00  !
command00! (
.00( )
Capacity00) 1
.001 2
Value002 7
)007 8
;008 9
}11 	
if33 

(33 
command33 
.33 
X33 
.33 
HasValue33 
&&33 !
command33" )
.33) *
Y33* +
.33+ ,
HasValue33, 4
)334 5
{44 	
table55 
.55 
UpdatePosition55  
(55  !
command55! (
.55( )
X55) *
.55* +
Value55+ 0
,550 1
command552 9
.559 :
Y55: ;
.55; <
Value55< A
)55A B
;55B C
}66 	
if88 

(88 
command88 
.88 
FloorId88 
.88 
HasValue88 $
||88% '
command88( /
.88/ 0
FloorId880 7
==888 :
null88; ?
)88? @
{99 	
table:: 
.:: 
UpdateFloor:: 
(:: 
command:: %
.::% &
FloorId::& -
)::- .
;::. /
};; 	
if== 

(== 
command== 
.== 
IsActive== 
.== 
HasValue== %
)==% &
{>> 	
if?? 
(?? 
command?? 
.?? 
IsActive??  
.??  !
Value??! &
)??& '
{@@ 
tableAA 
.AA 
ActivateAA 
(AA 
)AA  
;AA  !
}BB 
elseCC 
{DD 
tableEE 
.EE 

DeactivateEE  
(EE  !
)EE! "
;EE" #
}FF 
}GG 	
awaitJJ 
_tableRepositoryJJ 
.JJ 
UpdateAsyncJJ *
(JJ* +
tableJJ+ 0
,JJ0 1
cancellationTokenJJ2 C
)JJC D
;JJD E
varMM 
correlationIdMM 
=MM 
GuidMM  
.MM  !
NewGuidMM! (
(MM( )
)MM) *
;MM* +
varNN 

auditEventNN 
=NN 

AuditEventNN #
.NN# $
CreateNN$ *
(NN* +
AuditEventTypeOO 
.OO 
ModifiedOO #
,OO# $
nameofPP 
(PP 
TablePP 
)PP 
,PP 
tableQQ 
.QQ 
IdQQ 
,QQ 
GuidRR 
.RR 
EmptyRR 
,RR 
SystemSS 
.SS 
TextSS 
.SS 
JsonSS 
.SS 
JsonSerializerSS +
.SS+ ,
	SerializeSS, 5
(SS5 6
newSS6 9
{TT 
TableNumberUU 
=UU 
tableUU #
.UU# $
TableNumberUU$ /
,UU/ 0
CapacityVV 
=VV 
tableVV  
.VV  !
CapacityVV! )
,VV) *
XWW 
=WW 
tableWW 
.WW 
XWW 
,WW 
YXX 
=XX 
tableXX 
.XX 
YXX 
,XX 
FloorIdYY 
=YY 
tableYY 
.YY  
FloorIdYY  '
,YY' (
StatusZZ 
=ZZ 
tableZZ 
.ZZ 
StatusZZ %
,ZZ% &
IsActive[[ 
=[[ 
table[[  
.[[  !
IsActive[[! )
}\\ 
)\\ 
,\\ 
$"]] 
$str]] 
{]] 
table]] 
.]] 
TableNumber]] &
}]]& '
$str]]' /
"]]/ 0
,]]0 1
correlationId^^ 
:^^ 
correlationId^^ (
)^^( )
;^^) *
await`` !
_auditEventRepository`` #
.``# $
AddAsync``$ ,
(``, -

auditEvent``- 7
,``7 8
cancellationToken``9 J
)``J K
;``K L
returnbb 
newbb 
UpdateTableResultbb $
{cc 	
TableIddd 
=dd 
tabledd 
.dd 
Iddd 
,dd 
TableNumberee 
=ee 
tableee 
.ee  
TableNumberee  +
}ff 	
;ff	 

}gg 
}hh »4
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\UpdateShiftCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
UpdateShiftCommandHandler &
:' (
ICommandHandler) 8
<8 9
UpdateShiftCommand9 K
,K L
UpdateShiftResultM ^
>^ _
{ 
private 
readonly 
IShiftRepository %
_shiftRepository& 6
;6 7
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
%
UpdateShiftCommandHandler $
($ %
IShiftRepository 
shiftRepository (
,( )!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_shiftRepository 
= 
shiftRepository *
;* +!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
UpdateShiftResult '
>' (
HandleAsync) 4
(4 5
UpdateShiftCommand5 G
commandH O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
shift 
= 
await 
_shiftRepository *
.* +
GetByIdAsync+ 7
(7 8
command8 ?
.? @
ShiftId@ G
,G H
cancellationTokenI Z
)Z [
;[ \
if 

( 
shift 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI O
{O P
commandP W
.W X
ShiftIdX _
}_ `
$str` k
"k l
)l m
;m n
} 	
if"" 

("" 
command"" 
."" 
Name"" 
!="" 
null""  
)""  !
{## 	
shift$$ 
.$$ 

UpdateName$$ 
($$ 
command$$ $
.$$$ %
Name$$% )
)$$) *
;$$* +
}%% 	
if'' 

('' 
command'' 
.'' 
	StartTime'' 
.'' 
HasValue'' &
&&''' )
command''* 1
.''1 2
EndTime''2 9
.''9 :
HasValue'': B
)''B C
{(( 	
shift)) 
.)) 
UpdateTimes)) 
()) 
command)) %
.))% &
	StartTime))& /
.))/ 0
Value))0 5
,))5 6
command))7 >
.))> ?
EndTime))? F
.))F G
Value))G L
)))L M
;))M N
}** 	
else++ 
if++ 
(++ 
command++ 
.++ 
	StartTime++ "
.++" #
HasValue++# +
||++, .
command++/ 6
.++6 7
EndTime++7 >
.++> ?
HasValue++? G
)++G H
{,, 	
throw-- 
new-- 
Domain-- 
.-- 

Exceptions-- '
.--' (*
BusinessRuleViolationException--( F
(--F G
$str	--G Ä
)
--Ä Å
;
--Å Ç
}.. 	
if00 

(00 
command00 
.00 
IsActive00 
.00 
HasValue00 %
)00% &
{11 	
if22 
(22 
command22 
.22 
IsActive22  
.22  !
Value22! &
)22& '
{33 
shift44 
.44 
Activate44 
(44 
)44  
;44  !
}55 
else66 
{77 
shift88 
.88 

Deactivate88  
(88  !
)88! "
;88" #
}99 
}:: 	
await== 
_shiftRepository== 
.== 
UpdateAsync== *
(==* +
shift==+ 0
,==0 1
cancellationToken==2 C
)==C D
;==D E
var@@ 
correlationId@@ 
=@@ 
Guid@@  
.@@  !
NewGuid@@! (
(@@( )
)@@) *
;@@* +
varAA 

auditEventAA 
=AA 

AuditEventAA #
.AA# $
CreateAA$ *
(AA* +
AuditEventTypeBB 
.BB 
ModifiedBB #
,BB# $
nameofCC 
(CC 
ShiftCC 
)CC 
,CC 
shiftDD 
.DD 
IdDD 
,DD 
GuidEE 
.EE 
EmptyEE 
,EE 
SystemFF 
.FF 
TextFF 
.FF 
JsonFF 
.FF 
JsonSerializerFF +
.FF+ ,
	SerializeFF, 5
(FF5 6
newFF6 9
{GG 
NameHH 
=HH 
shiftHH 
.HH 
NameHH !
,HH! "
	StartTimeII 
=II 
shiftII !
.II! "
	StartTimeII" +
.II+ ,
ToStringII, 4
(II4 5
)II5 6
,II6 7
EndTimeJJ 
=JJ 
shiftJJ 
.JJ  
EndTimeJJ  '
.JJ' (
ToStringJJ( 0
(JJ0 1
)JJ1 2
,JJ2 3
IsActiveKK 
=KK 
shiftKK  
.KK  !
IsActiveKK! )
}LL 
)LL 
,LL 
$"MM 
$strMM 
{MM 
shiftMM 
.MM 
NameMM  
}MM  !
$strMM! *
"MM* +
,MM+ ,
correlationIdNN 
:NN 
correlationIdNN (
)NN( )
;NN) *
awaitPP !
_auditEventRepositoryPP #
.PP# $
AddAsyncPP$ ,
(PP, -

auditEventPP- 7
,PP7 8
cancellationTokenPP9 J
)PPJ K
;PPK L
returnRR 
newRR 
UpdateShiftResultRR $
{SS 	
ShiftIdTT 
=TT 
shiftTT 
.TT 
IdTT 
,TT 
NameUU 
=UU 
shiftUU 
.UU 
NameUU 
}VV 	
;VV	 

}WW 
}XX £:
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\UpdateOrderTypeCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class )
UpdateOrderTypeCommandHandler *
:+ ,
ICommandHandler- <
<< ="
UpdateOrderTypeCommand= S
,S T!
UpdateOrderTypeResultU j
>j k
{ 
private 
readonly  
IOrderTypeRepository ) 
_orderTypeRepository* >
;> ?
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
)
UpdateOrderTypeCommandHandler (
(( ) 
IOrderTypeRepository 
orderTypeRepository 0
,0 1!
IAuditEventRepository  
auditEventRepository 2
)2 3
{  
_orderTypeRepository 
= 
orderTypeRepository 2
;2 3!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< !
UpdateOrderTypeResult +
>+ ,
HandleAsync- 8
(8 9"
UpdateOrderTypeCommand9 O
commandP W
,W X
CancellationTokenY j
cancellationTokenk |
=} ~
default	 Ü
)
Ü á
{ 
var 
	orderType 
= 
await  
_orderTypeRepository 2
.2 3
GetByIdAsync3 ?
(? @
command@ G
.G H
OrderTypeIdH S
,S T
cancellationTokenU f
)f g
;g h
if 

( 
	orderType 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI T
{T U
commandU \
.\ ]
OrderTypeId] h
}h i
$stri t
"t u
)u v
;v w
} 	
if"" 

("" 
command"" 
."" 
Name"" 
!="" 
null""  
)""  !
{## 	
	orderType$$ 
.$$ 

UpdateName$$  
($$  !
command$$! (
.$$( )
Name$$) -
)$$- .
;$$. /
}%% 	
if'' 

('' 
command'' 
.'' 
CloseOnPaid'' 
.''  
HasValue''  (
)''( )
{(( 	
	orderType)) 
.)) 
SetCloseOnPaid)) $
())$ %
command))% ,
.)), -
CloseOnPaid))- 8
.))8 9
Value))9 >
)))> ?
;))? @
}** 	
if,, 

(,, 
command,, 
.,, 
AllowSeatBasedOrder,, '
.,,' (
HasValue,,( 0
),,0 1
{-- 	
	orderType.. 
... "
SetAllowSeatBasedOrder.. ,
(.., -
command..- 4
...4 5
AllowSeatBasedOrder..5 H
...H I
Value..I N
)..N O
;..O P
}// 	
if11 

(11 
command11 
.11 
AllowToAddTipsLater11 '
.11' (
HasValue11( 0
)110 1
{22 	
	orderType33 
.33 "
SetAllowToAddTipsLater33 ,
(33, -
command33- 4
.334 5
AllowToAddTipsLater335 H
.33H I
Value33I N
)33N O
;33O P
}44 	
if66 

(66 
command66 
.66 
IsBarTab66 
.66 
HasValue66 %
)66% &
{77 	
	orderType88 
.88 
SetIsBarTab88 !
(88! "
command88" )
.88) *
IsBarTab88* 2
.882 3
Value883 8
)888 9
;889 :
}99 	
if;; 

(;; 
command;; 
.;; 
IsActive;; 
.;; 
HasValue;; %
);;% &
{<< 	
if== 
(== 
command== 
.== 
IsActive==  
.==  !
Value==! &
)==& '
{>> 
	orderType?? 
.?? 
Activate?? "
(??" #
)??# $
;??$ %
}@@ 
elseAA 
{BB 
	orderTypeCC 
.CC 

DeactivateCC $
(CC$ %
)CC% &
;CC& '
}DD 
}EE 	
awaitHH  
_orderTypeRepositoryHH "
.HH" #
UpdateAsyncHH# .
(HH. /
	orderTypeHH/ 8
,HH8 9
cancellationTokenHH: K
)HHK L
;HHL M
varKK 
correlationIdKK 
=KK 
GuidKK  
.KK  !
NewGuidKK! (
(KK( )
)KK) *
;KK* +
varLL 

auditEventLL 
=LL 

AuditEventLL #
.LL# $
CreateLL$ *
(LL* +
AuditEventTypeMM 
.MM 
ModifiedMM #
,MM# $
nameofNN 
(NN 
	OrderTypeNN 
)NN 
,NN 
	orderTypeOO 
.OO 
IdOO 
,OO 
GuidPP 
.PP 
EmptyPP 
,PP 
SystemQQ 
.QQ 
TextQQ 
.QQ 
JsonQQ 
.QQ 
JsonSerializerQQ +
.QQ+ ,
	SerializeQQ, 5
(QQ5 6
newQQ6 9
{RR 
NameSS 
=SS 
	orderTypeSS  
.SS  !
NameSS! %
,SS% &
CloseOnPaidTT 
=TT 
	orderTypeTT '
.TT' (
CloseOnPaidTT( 3
,TT3 4
AllowSeatBasedOrderUU #
=UU$ %
	orderTypeUU& /
.UU/ 0
AllowSeatBasedOrderUU0 C
,UUC D
AllowToAddTipsLaterVV #
=VV$ %
	orderTypeVV& /
.VV/ 0
AllowToAddTipsLaterVV0 C
,VVC D
IsBarTabWW 
=WW 
	orderTypeWW $
.WW$ %
IsBarTabWW% -
,WW- .
IsActiveXX 
=XX 
	orderTypeXX $
.XX$ %
IsActiveXX% -
}YY 
)YY 
,YY 
$"ZZ 
$strZZ 
{ZZ 
	orderTypeZZ $
.ZZ$ %
NameZZ% )
}ZZ) *
$strZZ* 3
"ZZ3 4
,ZZ4 5
correlationId[[ 
:[[ 
correlationId[[ (
)[[( )
;[[) *
await]] !
_auditEventRepository]] #
.]]# $
AddAsync]]$ ,
(]], -

auditEvent]]- 7
,]]7 8
cancellationToken]]9 J
)]]J K
;]]K L
return__ 
new__ !
UpdateOrderTypeResult__ (
{`` 	
OrderTypeIdaa 
=aa 
	orderTypeaa #
.aa# $
Idaa$ &
,aa& '
Namebb 
=bb 
	orderTypebb 
.bb 
Namebb !
}cc 	
;cc	 

}dd 
}ee ï
èC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\UpdateOrderLineInstructionCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class 4
(UpdateOrderLineInstructionCommandHandler 5
:6 7
ICommandHandler8 G
<G H-
!UpdateOrderLineInstructionCommandH i
>i j
{ 
private		 
readonly		 
ITicketRepository		 &
_ticketRepository		' 8
;		8 9
public 
4
(UpdateOrderLineInstructionCommandHandler 3
(3 4
ITicketRepository4 E
ticketRepositoryF V
)V W
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
} 
public 

async 
Task 
HandleAsync !
(! "-
!UpdateOrderLineInstructionCommand" C
commandD K
,K L
CancellationTokenM ^
cancellationToken_ p
=q r
defaults z
)z {
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
)J K
;K L
if 

( 
ticket 
== 
null 
) 
{ 	
throw 
new  
KeyNotFoundException *
(* +
$"+ -
$str- <
{< =
command= D
.D E
TicketIdE M
}M N
$strN Y
"Y Z
)Z [
;[ \
} 	
var 
	orderLine 
= 
ticket 
. 

OrderLines )
.) *
FirstOrDefault* 8
(8 9
ol9 ;
=>< >
ol? A
.A B
IdB D
==E G
commandH O
.O P
OrderLineIdP [
)[ \
;\ ]
if 

( 
	orderLine 
== 
null 
) 
{ 	
throw 
new  
KeyNotFoundException +
(+ ,
$", .
$str. @
{@ A
commandA H
.H I
OrderLineIdI T
}T U
$strU j
{j k
commandk r
.r s
TicketIds {
}{ |
$str| }
"} ~
)~ 
;	 Ä
} 	
	orderLine!! 
.!! 
SetInstructions!! !
(!!! "
command!!" )
.!!) *
Instruction!!* 5
)!!5 6
;!!6 7
await## 
_ticketRepository## 
.##  
UpdateAsync##  +
(##+ ,
ticket##, 2
)##2 3
;##3 4
}$$ 
}%% óA
äC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\TransferTicketToTableCommandHandler.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
;

' (
public 
class /
#TransferTicketToTableCommandHandler 0
:1 2
ICommandHandler3 B
<B C(
TransferTicketToTableCommandC _
,_ `'
TransferTicketToTableResulta |
>| }
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
/
#TransferTicketToTableCommandHandler .
(. /
ITableRepository 
tableRepository (
,( )
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_tableRepository 
= 
tableRepository *
;* +
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< '
TransferTicketToTableResult 1
>1 2
HandleAsync3 >
(> ?(
TransferTicketToTableCommand? [
command\ c
,c d
CancellationTokene v
cancellationToken	w à
=
â ä
default
ã í
)
í ì
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if   

(   
ticket   
==   
null   
)   
throw!! 
new!! *
BusinessRuleViolationException!! 4
(!!4 5
$"!!5 7
$str!!7 >
{!!> ?
command!!? F
.!!F G
TicketId!!G O
}!!O P
$str!!P [
"!![ \
)!!\ ]
;!!] ^
var## 
sourceTable## 
=## 
await## 
_tableRepository##  0
.##0 1
GetByIdAsync##1 =
(##= >
command##> E
.##E F
SourceTableId##F S
,##S T
cancellationToken##U f
)##f g
;##g h
if$$ 

($$ 
sourceTable$$ 
==$$ 
null$$ 
)$$  
throw%% 
new%% *
BusinessRuleViolationException%% 4
(%%4 5
$"%%5 7
$str%%7 D
{%%D E
command%%E L
.%%L M
SourceTableId%%M Z
}%%Z [
$str%%[ f
"%%f g
)%%g h
;%%h i
var'' 
targetTable'' 
='' 
await'' 
_tableRepository''  0
.''0 1
GetByIdAsync''1 =
(''= >
command''> E
.''E F
TargetTableId''F S
,''S T
cancellationToken''U f
)''f g
;''g h
if(( 

((( 
targetTable(( 
==(( 
null(( 
)((  
throw)) 
new)) *
BusinessRuleViolationException)) 4
())4 5
$"))5 7
$str))7 D
{))D E
command))E L
.))L M
TargetTableId))M Z
}))Z [
$str))[ f
"))f g
)))g h
;))h i
if,, 

(,, 
sourceTable,, 
.,, 
CurrentTicketId,, '
!=,,( *
ticket,,+ 1
.,,1 2
Id,,2 4
),,4 5
throw-- 
new-- *
BusinessRuleViolationException-- 4
(--4 5
$"--5 7
$str--7 D
{--D E
sourceTable--E P
.--P Q
TableNumber--Q \
}--\ ]
$str--] s
{--s t
ticket--t z
.--z {
TicketNumber	--{ á
}
--á à
$str
--à â
"
--â ä
)
--ä ã
;
--ã å
if// 

(// 
targetTable// 
.// 
Status// 
!=// !
TableStatus//" -
.//- .
	Available//. 7
)//7 8
throw00 
new00 *
BusinessRuleViolationException00 4
(004 5
$"005 7
$str007 D
{00D E
targetTable00E P
.00P Q
TableNumber00Q \
}00\ ]
$str00] j
"00j k
)00k l
;00l m
sourceTable44 
.44 
ReleaseTicket44 !
(44! "
)44" #
;44# $
targetTable77 
.77 
AssignTicket77  
(77  !
ticket77! '
.77' (
Id77( *
)77* +
;77+ ,
ticket:: 
.:: 
RemoveTableNumber::  
(::  !
sourceTable::! ,
.::, -
TableNumber::- 8
)::8 9
;::9 :
ticket;; 
.;; 
AddTableNumber;; 
(;; 
targetTable;; )
.;;) *
TableNumber;;* 5
);;5 6
;;;6 7
await>> 
_tableRepository>> 
.>> 
UpdateAsync>> *
(>>* +
sourceTable>>+ 6
,>>6 7
cancellationToken>>8 I
)>>I J
;>>J K
await?? 
_tableRepository?? 
.?? 
UpdateAsync?? *
(??* +
targetTable??+ 6
,??6 7
cancellationToken??8 I
)??I J
;??J K
await@@ 
_ticketRepository@@ 
.@@  
UpdateAsync@@  +
(@@+ ,
ticket@@, 2
,@@2 3
cancellationToken@@4 E
)@@E F
;@@F G
awaitCC !
_auditEventRepositoryCC #
.CC# $
AddAsyncCC$ ,
(CC, -

AuditEventCC- 7
.CC7 8
CreateCC8 >
(CC> ?
AuditEventTypeDD 
.DD 
ModifiedDD #
,DD# $
nameofEE 
(EE 
TicketEE 
)EE 
,EE 
ticketFF 
.FF 
IdFF 
,FF 
commandGG 
.GG 
UserIdGG 
,GG 
SystemHH 
.HH 
TextHH 
.HH 
JsonHH 
.HH 
JsonSerializerHH +
.HH+ ,
	SerializeHH, 5
(HH5 6
newHH6 9
{HH: ;
FromHH< @
=HHA B
sourceTableHHC N
.HHN O
TableNumberHHO Z
,HHZ [
ToHH\ ^
=HH_ `
targetTableHHa l
.HHl m
TableNumberHHm x
}HHy z
)HHz {
,HH{ |
$"II 
$strII !
{II! "
ticketII" (
.II( )
TicketNumberII) 5
}II5 6
$strII6 B
{IIB C
sourceTableIIC N
.IIN O
TableNumberIIO Z
}IIZ [
$strII[ _
{II_ `
targetTableII` k
.IIk l
TableNumberIIl w
}IIw x
"IIx y
,IIy z
nullJJ 
,JJ 
GuidKK 
.KK 
NewGuidKK 
(KK 
)KK 
)LL 	
,LL	 

cancellationTokenLL 
)LL 
;LL 
returnNN 
newNN '
TransferTicketToTableResultNN .
{OO 	
SuccessPP 
=PP 
truePP 
,PP 
TicketIdQQ 
=QQ 
ticketQQ 
.QQ 
IdQQ  
,QQ  !
SourceTableIdRR 
=RR 
sourceTableRR '
.RR' (
IdRR( *
,RR* +
TargetTableIdSS 
=SS 
targetTableSS '
.SS' (
IdSS( *
}TT 	
;TT	 

}UU 
}VV ‡
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\TransferTicketCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class (
TransferTicketCommandHandler )
:* +
ICommandHandler, ;
<; <!
TransferTicketCommand< Q
>Q R
{		 
private

 
readonly

 
ITicketRepository

 &
_ticketRepository

' 8
;

8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
(
TransferTicketCommandHandler '
(' (
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! "!
TransferTicketCommand" 7
command8 ?
,? @
CancellationTokenA R
cancellationTokenS d
=e f
defaultg n
)n o
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
throw 
new  
KeyNotFoundException *
(* +
$"+ -
$str- 4
{4 5
command5 <
.< =
TicketId= E
}E F
$strF Q
"Q R
)R S
;S T
} 	
var 
oldOwner 
= 
ticket 
. 
	CreatedBy '
;' (
ticket   
.   
Transfer   
(   
command   
.    

NewOwnerId    *
)  * +
;  + ,
await"" 
_ticketRepository"" 
.""  
UpdateAsync""  +
(""+ ,
ticket"", 2
,""2 3
cancellationToken""4 E
)""E F
;""F G
var%% 
audit%% 
=%% 

AuditEvent%% 
.%% 
Create%% %
(%%% &
AuditEventType&& 
.&& 
TicketTransferred&& ,
,&&, -
nameof'' 
('' 
Ticket'' 
)'' 
,'' 
ticket(( 
.(( 
Id(( 
,(( 
command)) 
.)) 
TransferredBy)) !
.))! "
Value))" '
,))' (
$str** 
,** 
$"++ 
$str++ 
{++ 
ticket++ 
.++ 
TicketNumber++ )
}++) *
$str++* <
{++< =
oldOwner++= E
.++E F
Value++F K
}++K L
$str++L P
{++P Q
command++Q X
.++X Y

NewOwnerId++Y c
.++c d
Value++d i
}++i j
"++j k
),, 	
;,,	 

await-- !
_auditEventRepository-- #
.--# $
AddAsync--$ ,
(--, -
audit--- 2
,--2 3
cancellationToken--4 E
)--E F
;--F G
}.. 
}// ©7
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\TicketCreationService.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class !
TicketCreationService "
:# $"
ITicketCreationService% ;
{ 
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly  
IOrderTypeRepository ) 
_orderTypeRepository* >
;> ?
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly 
ICommandHandler $
<$ %
CreateTicketCommand% 8
,8 9
CreateTicketResult: L
>L M 
_createTicketHandlerN b
;b c
public 
!
TicketCreationService  
(  !
ITerminalContext 
terminalContext (
,( )"
ICashSessionRepository !
cashSessionRepository 4
,4 5 
IOrderTypeRepository 
orderTypeRepository 0
,0 1
ITableRepository 
tableRepository (
,( )
ICommandHandler 
< 
CreateTicketCommand +
,+ ,
CreateTicketResult- ?
>? @
createTicketHandlerA T
)T U
{ 
_terminalContext 
= 
terminalContext *
;* +"
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7 
_orderTypeRepository 
= 
orderTypeRepository 2
;2 3
_tableRepository 
= 
tableRepository *
;* + 
_createTicketHandler 
= 
createTicketHandler 2
;2 3
} 
public!! 

async!! 
Task!! 
<!! 
Guid!! 
>!! %
CreateTicketForTableAsync!! 5
(!!5 6
Guid!!6 :
tableId!!; B
,!!B C
Guid!!D H
userId!!I O
)!!O P
{"" 
var$$ 
table$$ 
=$$ 
await$$ 
_tableRepository$$ *
.$$* +
GetByIdAsync$$+ 7
($$7 8
tableId$$8 ?
)$$? @
;$$@ A
if%% 

(%% 
table%% 
==%% 
null%% 
)%% 
throw&& 
new&& 
NotFoundException&& '
(&&' (
$"&&( *
$str&&* 8
{&&8 9
tableId&&9 @
}&&@ A
$str&&A L
"&&L M
)&&M N
;&&N O
if(( 

((( 
table(( 
.(( 
Status(( 
!=(( 
Domain(( "
.((" #
Enumerations((# /
.((/ 0
TableStatus((0 ;
.((; <
	Available((< E
)((E F
throw)) 
new)) *
BusinessRuleViolationException)) 4
())4 5
$"))5 7
$str))7 =
{))= >
table))> C
.))C D
TableNumber))D O
}))O P
$str))P k
{))k l
table))l q
.))q r
Status))r x
}))x y
$str))y {
")){ |
)))| }
;))} ~
if,, 

(,, 
_terminalContext,, 
.,, 

TerminalId,, '
==,,( *
null,,+ /
),,/ 0
throw-- 
new-- *
BusinessRuleViolationException-- 4
(--4 5
$str--5 R
)--R S
;--S T
var// 

terminalId// 
=// 
_terminalContext// )
.//) *

TerminalId//* 4
.//4 5
Value//5 :
;//: ;
var22 
session22 
=22 
await22 "
_cashSessionRepository22 2
.222 3+
GetOpenSessionByTerminalIdAsync223 R
(22R S

terminalId22S ]
)22] ^
;22^ _
if33 

(33 
session33 
==33 
null33 
)33 
throw44 
new44 *
BusinessRuleViolationException44 4
(444 5
$str445 h
)44h i
;44i j
var66 
shiftId66 
=66 
session66 
.66 
Id66  
;66  !
var99 

orderTypes99 
=99 
await99  
_orderTypeRepository99 3
.993 4
GetActiveAsync994 B
(99B C
)99C D
;99D E
var:: 
dineIn:: 
=:: 

orderTypes:: 
.::  
FirstOrDefault::  .
(::. /
ot::/ 1
=>::2 4
ot::5 7
.::7 8
Name::8 <
.::< =
ToUpper::= D
(::D E
)::E F
.::F G
Contains::G O
(::O P
$str::P Y
)::Y Z
)::Z [
??;; 

orderTypes;; "
.;;" #
FirstOrDefault;;# 1
(;;1 2
);;2 3
;;;3 4
if== 

(== 
dineIn== 
==== 
null== 
)== 
throw>> 
new>> *
BusinessRuleViolationException>> 4
(>>4 5
$str>>5 R
)>>R S
;>>S T
varAA 
commandAA 
=AA 
newAA 
CreateTicketCommandAA -
{BB 	
	CreatedByCC 
=CC 
newCC 
DomainCC "
.CC" #
ValueObjectsCC# /
.CC/ 0
UserIdCC0 6
(CC6 7
userIdCC7 =
)CC= >
,CC> ?

TerminalIdDD 
=DD 

terminalIdDD #
,DD# $
ShiftIdEE 
=EE 
shiftIdEE 
,EE 
OrderTypeIdFF 
=FF 
dineInFF  
.FF  !
IdFF! #
,FF# $
TableNumbersGG 
=GG 
newGG 
ListGG #
<GG# $
intGG$ '
>GG' (
{GG) *
tableGG+ 0
.GG0 1
TableNumberGG1 <
}GG= >
,GG> ?
NumberOfGuestsHH 
=HH 
tableHH "
.HH" #
CapacityHH# +
>HH, -
$numHH. /
?HH0 1
tableHH2 7
.HH7 8
CapacityHH8 @
:HHA B
$numHHC D
}II 	
;II	 

varKK 
resultKK 
=KK 
awaitKK  
_createTicketHandlerKK /
.KK/ 0
HandleAsyncKK0 ;
(KK; <
commandKK< C
)KKC D
;KKD E
returnLL 
resultLL 
.LL 
TicketIdLL 
;LL 
}MM 
}NN ˙K
âC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\TicketConfigurationCommandHandlers.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
;

' (
public 
class /
#ChangeTicketOrderTypeCommandHandler 0
:1 2
ICommandHandler3 B
<B C(
ChangeTicketOrderTypeCommandC _
>_ `
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly  
IOrderTypeRepository ) 
_orderTypeRepository* >
;> ?
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
/
#ChangeTicketOrderTypeCommandHandler .
(. /
ITicketRepository 
ticketRepository *
,* + 
IOrderTypeRepository 
orderTypeRepository 0
,0 1!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
??- /
throw0 5
new6 9!
ArgumentNullException: O
(O P
nameofP V
(V W
ticketRepositoryW g
)g h
)h i
;i j 
_orderTypeRepository 
= 
orderTypeRepository 2
??3 5
throw6 ;
new< ?!
ArgumentNullException@ U
(U V
nameofV \
(\ ]
orderTypeRepository] p
)p q
)q r
;r s!
_auditEventRepository 
=  
auditEventRepository  4
??5 7
throw8 =
new> A!
ArgumentNullExceptionB W
(W X
nameofX ^
(^ _ 
auditEventRepository_ s
)s t
)t u
;u v
} 
public 

async 
Task 
HandleAsync !
(! "(
ChangeTicketOrderTypeCommand" >
command? F
,F G
CancellationTokenH Y
cancellationTokenZ k
=l m
defaultn u
)u v
{ 
if 

( 
command 
== 
null 
) 
throw "
new# &!
ArgumentNullException' <
(< =
nameof= C
(C D
commandD K
)K L
)L M
;M N
var   
ticket   
=   
await   
_ticketRepository   ,
.  , -
GetByIdAsync  - 9
(  9 :
command  : A
.  A B
TicketId  B J
,  J K
cancellationToken  L ]
)  ] ^
;  ^ _
if!! 

(!! 
ticket!! 
==!! 
null!! 
)!! 
throw!! !
new!!" %
NotFoundException!!& 7
(!!7 8
$"!!8 :
$str!!: A
{!!A B
command!!B I
.!!I J
TicketId!!J R
}!!R S
$str!!S ^
"!!^ _
)!!_ `
;!!` a
var## 
	orderType## 
=## 
await##  
_orderTypeRepository## 2
.##2 3
GetByIdAsync##3 ?
(##? @
command##@ G
.##G H
OrderTypeId##H S
,##S T
cancellationToken##U f
)##f g
;##g h
if$$ 

($$ 
	orderType$$ 
==$$ 
null$$ 
)$$ 
throw$$ $
new$$% (
NotFoundException$$) :
($$: ;
$"$$; =
$str$$= H
{$$H I
command$$I P
.$$P Q
OrderTypeId$$Q \
}$$\ ]
$str$$] h
"$$h i
)$$i j
;$$j k
ticket&& 
.&& 
ChangeOrderType&& 
(&& 
	orderType&& (
)&&( )
;&&) *
await(( 
_ticketRepository(( 
.((  
UpdateAsync((  +
(((+ ,
ticket((, 2
,((2 3
cancellationToken((4 E
)((E F
;((F G
var** 

auditEvent** 
=** 

AuditEvent** #
.**# $
Create**$ *
(*** +
AuditEventType++ 
.++ 
Modified++ #
,++# $
nameof,, 
(,, 
Ticket,, 
),, 
,,, 
ticket-- 
.-- 
Id-- 
,-- 
command.. 
... 
	ChangedBy.. 
?.. 
... 
Value.. $
??..% '
Guid..( ,
..., -
Empty..- 2
,..2 3
$str//  
,//  !
$"00 
$str00 ,
{00, -
	orderType00- 6
.006 7
Name007 ;
}00; <
$str00< =
"00= >
,00> ?
correlationId11 
:11 
Guid11 
.11  
NewGuid11  '
(11' (
)11( )
)11) *
;11* +
await33 !
_auditEventRepository33 #
.33# $
AddAsync33$ ,
(33, -

auditEvent33- 7
,337 8
cancellationToken339 J
)33J K
;33K L
}44 
}55 
public77 
class77 +
SetTicketCustomerCommandHandler77 ,
:77- .
ICommandHandler77/ >
<77> ?$
SetTicketCustomerCommand77? W
>77W X
{88 
private99 
readonly99 
ITicketRepository99 &
_ticketRepository99' 8
;998 9
private:: 
readonly:: !
IAuditEventRepository:: *!
_auditEventRepository::+ @
;::@ A
public<< 
+
SetTicketCustomerCommandHandler<< *
(<<* +
ITicketRepository== 
ticketRepository== *
,==* +!
IAuditEventRepository>>  
auditEventRepository>> 2
)>>2 3
{?? 
_ticketRepository@@ 
=@@ 
ticketRepository@@ ,
??@@- /
throw@@0 5
new@@6 9!
ArgumentNullException@@: O
(@@O P
nameof@@P V
(@@V W
ticketRepository@@W g
)@@g h
)@@h i
;@@i j!
_auditEventRepositoryAA 
=AA  
auditEventRepositoryAA  4
??AA5 7
throwAA8 =
newAA> A!
ArgumentNullExceptionAAB W
(AAW X
nameofAAX ^
(AA^ _ 
auditEventRepositoryAA_ s
)AAs t
)AAt u
;AAu v
}BB 
publicDD 

asyncDD 
TaskDD 
HandleAsyncDD !
(DD! "$
SetTicketCustomerCommandDD" :
commandDD; B
,DDB C
CancellationTokenDDD U
cancellationTokenDDV g
=DDh i
defaultDDj q
)DDq r
{EE 
ifFF 

(FF 
commandFF 
==FF 
nullFF 
)FF 
throwFF "
newFF# &!
ArgumentNullExceptionFF' <
(FF< =
nameofFF= C
(FFC D
commandFFD K
)FFK L
)FFL M
;FFM N
varHH 
ticketHH 
=HH 
awaitHH 
_ticketRepositoryHH ,
.HH, -
GetByIdAsyncHH- 9
(HH9 :
commandHH: A
.HHA B
TicketIdHHB J
,HHJ K
cancellationTokenHHL ]
)HH] ^
;HH^ _
ifII 

(II 
ticketII 
==II 
nullII 
)II 
throwII !
newII" %
NotFoundExceptionII& 7
(II7 8
$"II8 :
$strII: A
{IIA B
commandIIB I
.III J
TicketIdIIJ R
}IIR S
$strIIS ^
"II^ _
)II_ `
;II` a
ticketKK 
.KK 
SetCustomerKK 
(KK 
commandKK "
.KK" #

CustomerIdKK# -
,KK- .
commandKK/ 6
.KK6 7
DeliveryAddressKK7 F
,KKF G
commandKKH O
.KKO P
ExtraDeliveryInfoKKP a
)KKa b
;KKb c
awaitMM 
_ticketRepositoryMM 
.MM  
UpdateAsyncMM  +
(MM+ ,
ticketMM, 2
,MM2 3
cancellationTokenMM4 E
)MME F
;MMF G
varOO 

auditEventOO 
=OO 

AuditEventOO #
.OO# $
CreateOO$ *
(OO* +
AuditEventTypePP 
.PP 
ModifiedPP #
,PP# $
nameofQQ 
(QQ 
TicketQQ 
)QQ 
,QQ 
ticketRR 
.RR 
IdRR 
,RR 
commandSS 
.SS 
	ChangedBySS 
?SS 
.SS 
ValueSS $
??SS% '
GuidSS( ,
.SS, -
EmptySS- 2
,SS2 3
$strTT #
,TT# $
$"UU 
$strUU /
{UU/ 0
ticketUU0 6
.UU6 7
TicketNumberUU7 C
}UUC D
"UUD E
,UUE F
correlationIdVV 
:VV 
GuidVV 
.VV  
NewGuidVV  '
(VV' (
)VV( )
)VV) *
;VV* +
awaitXX !
_auditEventRepositoryXX #
.XX# $
AddAsyncXX$ ,
(XX, -

auditEventXX- 7
,XX7 8
cancellationTokenXX9 J
)XXJ K
;XXK L
}YY 
}ZZ Ö∑
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\TableLayoutExporter.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class 
TableLayoutExporter  
{ 
private		 
readonly		 !
JsonSerializerOptions		 *
_jsonOptions		+ 7
;		7 8
public 

TableLayoutExporter 
( 
)  
{ 
_jsonOptions 
= 
new !
JsonSerializerOptions 0
{ 	
WriteIndented 
= 
true  
,  ! 
PropertyNamingPolicy  
=! "
JsonNamingPolicy# 3
.3 4
	CamelCase4 =
,= >"
DefaultIgnoreCondition "
=# $
JsonIgnoreCondition% 8
.8 9
WhenWritingNull9 H
} 	
;	 

} 
public 

string 
ExportToJson 
( 
TableLayoutDto -
layout. 4
)4 5
{ 
if 

( 
layout 
== 
null 
) 
{ 	
throw 
new !
ArgumentNullException +
(+ ,
nameof, 2
(2 3
layout3 9
)9 :
): ;
;; <
} 	
var 

exportData 
= 
new !
TableLayoutExportData 2
{   	
Metadata!! 
=!! 
new!! 
LayoutMetadata!! )
{"" 
Name## 
=## 
layout## 
.## 
Name## "
,##" #
Description$$ 
=$$ 
$"$$  
$str$$  ,
{$$, -
DateTime$$- 5
.$$5 6
UtcNow$$6 <
:$$< =
$str$$= P
}$$P Q
"$$Q R
,$$R S
Version%% 
=%% 
layout%%  
.%%  !
Version%%! (
,%%( )

ExportDate&& 
=&& 
DateTime&& %
.&&% &
UtcNow&&& ,
,&&, -

TableCount'' 
='' 
layout'' #
.''# $
Tables''$ *
.''* +
Count''+ 0
,''0 1
FloorId(( 
=(( 
layout((  
.((  !
FloorId((! (
,((( )
Software)) 
=)) 
$str)) )
,))) *
SoftwareVersion** 
=**  !
$str**" )
}++ 
,++ 
Layout,, 
=,, 
layout,, 
}-- 	
;--	 

return// 
JsonSerializer// 
.// 
	Serialize// '
(//' (

exportData//( 2
,//2 3
_jsonOptions//4 @
)//@ A
;//A B
}00 
public55 

TableLayoutDto55 
ImportFromJson55 (
(55( )
string55) /
json550 4
)554 5
{66 
if77 

(77 
string77 
.77 
IsNullOrWhiteSpace77 %
(77% &
json77& *
)77* +
)77+ ,
{88 	
throw99 
new99 
ArgumentException99 '
(99' (
$str99( L
,99L M
nameof99N T
(99T U
json99U Y
)99Y Z
)99Z [
;99[ \
}:: 	
try<< 
{== 	
var>> 

exportData>> 
=>> 
JsonSerializer>> +
.>>+ ,
Deserialize>>, 7
<>>7 8!
TableLayoutExportData>>8 M
>>>M N
(>>N O
json>>O S
,>>S T
_jsonOptions>>U a
)>>a b
;>>b c
if@@ 
(@@ 

exportData@@ 
?@@ 
.@@ 
Layout@@ "
==@@# %
null@@& *
)@@* +
{AA 
throwBB 
newBB %
InvalidOperationExceptionBB 3
(BB3 4
$strBB4 W
)BBW X
;BBX Y
}CC "
ValidateImportedLayoutFF "
(FF" #

exportDataFF# -
.FF- .
LayoutFF. 4
)FF4 5
;FF5 6
returnHH 

exportDataHH 
.HH 
LayoutHH $
;HH$ %
}II 	
catchJJ 
(JJ 
JsonExceptionJJ 
exJJ 
)JJ  
{KK 	
throwLL 
newLL %
InvalidOperationExceptionLL /
(LL/ 0
$strLL0 F
,LLF G
exLLH J
)LLJ K
;LLK L
}MM 	
}NN 
publicSS 

stringSS  
ExportMultipleToJsonSS &
(SS& '
IEnumerableSS' 2
<SS2 3
TableLayoutDtoSS3 A
>SSA B
layoutsSSC J
)SSJ K
{TT 
ifUU 

(UU 
layoutsUU 
==UU 
nullUU 
)UU 
{VV 	
throwWW 
newWW !
ArgumentNullExceptionWW +
(WW+ ,
nameofWW, 2
(WW2 3
layoutsWW3 :
)WW: ;
)WW; <
;WW< =
}XX 	
varZZ 

layoutListZZ 
=ZZ 
layoutsZZ  
.ZZ  !
ToListZZ! '
(ZZ' (
)ZZ( )
;ZZ) *
var[[ 

exportData[[ 
=[[ 
new[[ %
MultipleLayoutsExportData[[ 6
{\\ 	
Metadata]] 
=]] 
new]] 
LayoutMetadata]] )
{^^ 
Name__ 
=__ 
$str__ 0
,__0 1
Description`` 
=`` 
$"``  
$str``  )
{``) *

layoutList``* 4
.``4 5
Count``5 :
}``: ;
$str``; G
{``G H
DateTime``H P
.``P Q
UtcNow``Q W
:``W X
$str``X k
}``k l
"``l m
,``m n
Versionaa 
=aa 
$numaa 
,aa 

ExportDatebb 
=bb 
DateTimebb %
.bb% &
UtcNowbb& ,
,bb, -

TableCountcc 
=cc 

layoutListcc '
.cc' (
Sumcc( +
(cc+ ,
lcc, -
=>cc. 0
lcc1 2
.cc2 3
Tablescc3 9
.cc9 :
Countcc: ?
)cc? @
,cc@ A
Softwaredd 
=dd 
$strdd )
,dd) *
SoftwareVersionee 
=ee  !
$stree" )
}ff 
,ff 
Layoutsgg 
=gg 

layoutListgg  
}hh 	
;hh	 

returnjj 
JsonSerializerjj 
.jj 
	Serializejj '
(jj' (

exportDatajj( 2
,jj2 3
_jsonOptionsjj4 @
)jj@ A
;jjA B
}kk 
publicpp 

Listpp 
<pp 
TableLayoutDtopp 
>pp "
ImportMultipleFromJsonpp  6
(pp6 7
stringpp7 =
jsonpp> B
)ppB C
{qq 
ifrr 

(rr 
stringrr 
.rr 
IsNullOrWhiteSpacerr %
(rr% &
jsonrr& *
)rr* +
)rr+ ,
{ss 	
throwtt 
newtt 
ArgumentExceptiontt '
(tt' (
$strtt( L
,ttL M
nameofttN T
(ttT U
jsonttU Y
)ttY Z
)ttZ [
;tt[ \
}uu 	
tryww 
{xx 	
varyy 

exportDatayy 
=yy 
JsonSerializeryy +
.yy+ ,
Deserializeyy, 7
<yy7 8%
MultipleLayoutsExportDatayy8 Q
>yyQ R
(yyR S
jsonyyS W
,yyW X
_jsonOptionsyyY e
)yye f
;yyf g
if{{ 
({{ 

exportData{{ 
?{{ 
.{{ 
Layouts{{ #
=={{$ &
null{{' +
){{+ ,
{|| 
throw}} 
new}} %
InvalidOperationException}} 3
(}}3 4
$str}}4 W
)}}W X
;}}X Y
}~~ 
var
ÄÄ 
result
ÄÄ 
=
ÄÄ 
new
ÄÄ 
List
ÄÄ !
<
ÄÄ! "
TableLayoutDto
ÄÄ" 0
>
ÄÄ0 1
(
ÄÄ1 2
)
ÄÄ2 3
;
ÄÄ3 4
foreach
ÅÅ 
(
ÅÅ 
var
ÅÅ 
layout
ÅÅ 
in
ÅÅ  "

exportData
ÅÅ# -
.
ÅÅ- .
Layouts
ÅÅ. 5
)
ÅÅ5 6
{
ÇÇ $
ValidateImportedLayout
ÉÉ &
(
ÉÉ& '
layout
ÉÉ' -
)
ÉÉ- .
;
ÉÉ. /
result
ÑÑ 
.
ÑÑ 
Add
ÑÑ 
(
ÑÑ 
layout
ÑÑ !
)
ÑÑ! "
;
ÑÑ" #
}
ÖÖ 
return
áá 
result
áá 
;
áá 
}
àà 	
catch
ââ 
(
ââ 
JsonException
ââ 
ex
ââ 
)
ââ  
{
ää 	
throw
ãã 
new
ãã '
InvalidOperationException
ãã /
(
ãã/ 0
$str
ãã0 F
,
ããF G
ex
ããH J
)
ããJ K
;
ããK L
}
åå 	
}
çç 
public
íí 

string
íí 
CreateBackup
íí 
(
íí 
IEnumerable
íí *
<
íí* +
TableLayoutDto
íí+ 9
>
íí9 :
layouts
íí; B
)
ííB C
{
ìì 
var
îî 

backupData
îî 
=
îî 
new
îî 
LayoutBackupData
îî -
{
ïï 	
Metadata
ññ 
=
ññ 
new
ññ 
BackupMetadata
ññ )
{
óó 

BackupType
òò 
=
òò 
$str
òò #
,
òò# $
Description
ôô 
=
ôô 
$str
ôô D
,
ôôD E

BackupDate
öö 
=
öö 
DateTime
öö %
.
öö% &
UtcNow
öö& ,
,
öö, -
LayoutCount
õõ 
=
õõ 
layouts
õõ %
.
õõ% &
Count
õõ& +
(
õõ+ ,
)
õõ, -
,
õõ- .

TableCount
úú 
=
úú 
layouts
úú $
.
úú$ %
Sum
úú% (
(
úú( )
l
úú) *
=>
úú+ -
l
úú. /
.
úú/ 0
Tables
úú0 6
.
úú6 7
Count
úú7 <
)
úú< =
,
úú= >
Software
ùù 
=
ùù 
$str
ùù )
,
ùù) *
SoftwareVersion
ûû 
=
ûû  !
$str
ûû" )
}
üü 
,
üü 
Layouts
†† 
=
†† 
layouts
†† 
.
†† 
ToList
†† $
(
††$ %
)
††% &
}
°° 	
;
°°	 

return
££ 
JsonSerializer
££ 
.
££ 
	Serialize
££ '
(
££' (

backupData
££( 2
,
££2 3
_jsonOptions
££4 @
)
££@ A
;
££A B
}
§§ 
public
©© 

List
©© 
<
©© 
TableLayoutDto
©© 
>
©© 
RestoreFromBackup
©©  1
(
©©1 2
string
©©2 8
json
©©9 =
)
©©= >
{
™™ 
if
´´ 

(
´´ 
string
´´ 
.
´´  
IsNullOrWhiteSpace
´´ %
(
´´% &
json
´´& *
)
´´* +
)
´´+ ,
{
¨¨ 	
throw
≠≠ 
new
≠≠ 
ArgumentException
≠≠ '
(
≠≠' (
$str
≠≠( N
,
≠≠N O
nameof
≠≠P V
(
≠≠V W
json
≠≠W [
)
≠≠[ \
)
≠≠\ ]
;
≠≠] ^
}
ÆÆ 	
try
∞∞ 
{
±± 	
var
≤≤ 

backupData
≤≤ 
=
≤≤ 
JsonSerializer
≤≤ +
.
≤≤+ ,
Deserialize
≤≤, 7
<
≤≤7 8
LayoutBackupData
≤≤8 H
>
≤≤H I
(
≤≤I J
json
≤≤J N
,
≤≤N O
_jsonOptions
≤≤P \
)
≤≤\ ]
;
≤≤] ^
if
¥¥ 
(
¥¥ 

backupData
¥¥ 
?
¥¥ 
.
¥¥ 
Layouts
¥¥ #
==
¥¥$ &
null
¥¥' +
)
¥¥+ ,
{
µµ 
throw
∂∂ 
new
∂∂ '
InvalidOperationException
∂∂ 3
(
∂∂3 4
$str
∂∂4 J
)
∂∂J K
;
∂∂K L
}
∑∑ 
var
ππ 
result
ππ 
=
ππ 
new
ππ 
List
ππ !
<
ππ! "
TableLayoutDto
ππ" 0
>
ππ0 1
(
ππ1 2
)
ππ2 3
;
ππ3 4
foreach
∫∫ 
(
∫∫ 
var
∫∫ 
layout
∫∫ 
in
∫∫  "

backupData
∫∫# -
.
∫∫- .
Layouts
∫∫. 5
)
∫∫5 6
{
ªª $
ValidateImportedLayout
ºº &
(
ºº& '
layout
ºº' -
)
ºº- .
;
ºº. /
result
ΩΩ 
.
ΩΩ 
Add
ΩΩ 
(
ΩΩ 
layout
ΩΩ !
)
ΩΩ! "
;
ΩΩ" #
}
ææ 
return
¿¿ 
result
¿¿ 
;
¿¿ 
}
¡¡ 	
catch
¬¬ 
(
¬¬ 
JsonException
¬¬ 
ex
¬¬ 
)
¬¬  
{
√√ 	
throw
ƒƒ 
new
ƒƒ '
InvalidOperationException
ƒƒ /
(
ƒƒ/ 0
$str
ƒƒ0 H
,
ƒƒH I
ex
ƒƒJ L
)
ƒƒL M
;
ƒƒM N
}
≈≈ 	
}
∆∆ 
private
»» 
void
»» $
ValidateImportedLayout
»» '
(
»»' (
TableLayoutDto
»»( 6
layout
»»7 =
)
»»= >
{
…… 
if
   

(
   
string
   
.
    
IsNullOrWhiteSpace
   %
(
  % &
layout
  & ,
.
  , -
Name
  - 1
)
  1 2
)
  2 3
{
ÀÀ 	
throw
ÃÃ 
new
ÃÃ '
InvalidOperationException
ÃÃ /
(
ÃÃ/ 0
$str
ÃÃ0 J
)
ÃÃJ K
;
ÃÃK L
}
ÕÕ 	
if
œœ 

(
œœ 
layout
œœ 
.
œœ 
Tables
œœ 
==
œœ 
null
œœ !
||
œœ" $
!
œœ% &
layout
œœ& ,
.
œœ, -
Tables
œœ- 3
.
œœ3 4
Any
œœ4 7
(
œœ7 8
)
œœ8 9
)
œœ9 :
{
–– 	
throw
—— 
new
—— '
InvalidOperationException
—— /
(
——/ 0
$str
——0 Y
)
——Y Z
;
——Z [
}
““ 	
foreach
’’ 
(
’’ 
var
’’ 
table
’’ 
in
’’ 
layout
’’ $
.
’’$ %
Tables
’’% +
)
’’+ ,
{
÷÷ 	
if
◊◊ 
(
◊◊ 
table
◊◊ 
.
◊◊ 
TableNumber
◊◊ !
<=
◊◊" $
$num
◊◊% &
)
◊◊& '
{
ÿÿ 
throw
ŸŸ 
new
ŸŸ '
InvalidOperationException
ŸŸ 3
(
ŸŸ3 4
$"
ŸŸ4 6
$str
ŸŸ6 <
{
ŸŸ< =
table
ŸŸ= B
.
ŸŸB C
TableNumber
ŸŸC N
}
ŸŸN O
$str
ŸŸO i
"
ŸŸi j
)
ŸŸj k
;
ŸŸk l
}
⁄⁄ 
if
‹‹ 
(
‹‹ 
table
‹‹ 
.
‹‹ 
Capacity
‹‹ 
<=
‹‹ !
$num
‹‹" #
)
‹‹# $
{
›› 
throw
ﬁﬁ 
new
ﬁﬁ '
InvalidOperationException
ﬁﬁ 3
(
ﬁﬁ3 4
$"
ﬁﬁ4 6
$str
ﬁﬁ6 <
{
ﬁﬁ< =
table
ﬁﬁ= B
.
ﬁﬁB C
TableNumber
ﬁﬁC N
}
ﬁﬁN O
$str
ﬁﬁO e
"
ﬁﬁe f
)
ﬁﬁf g
;
ﬁﬁg h
}
ﬂﬂ 
if
·· 
(
·· 
table
·· 
.
·· 
X
·· 
<
·· 
$num
·· 
||
·· 
table
·· $
.
··$ %
Y
··% &
<
··' (
$num
··) *
)
··* +
{
‚‚ 
throw
„„ 
new
„„ '
InvalidOperationException
„„ 3
(
„„3 4
$"
„„4 6
$str
„„6 <
{
„„< =
table
„„= B
.
„„B C
TableNumber
„„C N
}
„„N O
$str
„„O e
"
„„e f
)
„„f g
;
„„g h
}
‰‰ 
}
ÂÂ 	
var
ËË 
duplicateNumbers
ËË 
=
ËË 
layout
ËË %
.
ËË% &
Tables
ËË& ,
.
ÈÈ 
GroupBy
ÈÈ 
(
ÈÈ 
t
ÈÈ 
=>
ÈÈ 
t
ÈÈ 
.
ÈÈ 
TableNumber
ÈÈ '
)
ÈÈ' (
.
ÍÍ 
Where
ÍÍ 
(
ÍÍ 
g
ÍÍ 
=>
ÍÍ 
g
ÍÍ 
.
ÍÍ 
Count
ÍÍ 
(
ÍÍ  
)
ÍÍ  !
>
ÍÍ" #
$num
ÍÍ$ %
)
ÍÍ% &
.
ÎÎ 
Select
ÎÎ 
(
ÎÎ 
g
ÎÎ 
=>
ÎÎ 
g
ÎÎ 
.
ÎÎ 
Key
ÎÎ 
)
ÎÎ 
;
ÎÎ  
if
ÌÌ 

(
ÌÌ 
duplicateNumbers
ÌÌ 
.
ÌÌ 
Any
ÌÌ  
(
ÌÌ  !
)
ÌÌ! "
)
ÌÌ" #
{
ÓÓ 	
throw
ÔÔ 
new
ÔÔ '
InvalidOperationException
ÔÔ /
(
ÔÔ/ 0
$"
ÔÔ0 2
$str
ÔÔ2 Q
{
ÔÔQ R
string
ÔÔR X
.
ÔÔX Y
Join
ÔÔY ]
(
ÔÔ] ^
$str
ÔÔ^ b
,
ÔÔb c
duplicateNumbers
ÔÔd t
)
ÔÔt u
}
ÔÔu v
"
ÔÔv w
)
ÔÔw x
;
ÔÔx y
}
 	
}
ÒÒ 
}ÚÚ 
publicıı 
class
ıı #
TableLayoutExportData
ıı "
{ˆˆ 
public
˜˜ 

LayoutMetadata
˜˜ 
Metadata
˜˜ "
{
˜˜# $
get
˜˜% (
;
˜˜( )
set
˜˜* -
;
˜˜- .
}
˜˜/ 0
=
˜˜1 2
new
˜˜3 6
(
˜˜6 7
)
˜˜7 8
;
˜˜8 9
public
¯¯ 

TableLayoutDto
¯¯ 
Layout
¯¯  
{
¯¯! "
get
¯¯# &
;
¯¯& '
set
¯¯( +
;
¯¯+ ,
}
¯¯- .
=
¯¯/ 0
new
¯¯1 4
(
¯¯4 5
)
¯¯5 6
;
¯¯6 7
}˘˘ 
public˚˚ 
class
˚˚ '
MultipleLayoutsExportData
˚˚ &
{¸¸ 
public
˝˝ 

LayoutMetadata
˝˝ 
Metadata
˝˝ "
{
˝˝# $
get
˝˝% (
;
˝˝( )
set
˝˝* -
;
˝˝- .
}
˝˝/ 0
=
˝˝1 2
new
˝˝3 6
(
˝˝6 7
)
˝˝7 8
;
˝˝8 9
public
˛˛ 

List
˛˛ 
<
˛˛ 
TableLayoutDto
˛˛ 
>
˛˛ 
Layouts
˛˛  '
{
˛˛( )
get
˛˛* -
;
˛˛- .
set
˛˛/ 2
;
˛˛2 3
}
˛˛4 5
=
˛˛6 7
new
˛˛8 ;
(
˛˛; <
)
˛˛< =
;
˛˛= >
}ˇˇ 
publicÅÅ 
class
ÅÅ 
LayoutBackupData
ÅÅ 
{ÇÇ 
public
ÉÉ 

BackupMetadata
ÉÉ 
Metadata
ÉÉ "
{
ÉÉ# $
get
ÉÉ% (
;
ÉÉ( )
set
ÉÉ* -
;
ÉÉ- .
}
ÉÉ/ 0
=
ÉÉ1 2
new
ÉÉ3 6
(
ÉÉ6 7
)
ÉÉ7 8
;
ÉÉ8 9
public
ÑÑ 

List
ÑÑ 
<
ÑÑ 
TableLayoutDto
ÑÑ 
>
ÑÑ 
Layouts
ÑÑ  '
{
ÑÑ( )
get
ÑÑ* -
;
ÑÑ- .
set
ÑÑ/ 2
;
ÑÑ2 3
}
ÑÑ4 5
=
ÑÑ6 7
new
ÑÑ8 ;
(
ÑÑ; <
)
ÑÑ< =
;
ÑÑ= >
}ÖÖ 
publicáá 
class
áá 
LayoutMetadata
áá 
{àà 
public
ââ 

string
ââ 
Name
ââ 
{
ââ 
get
ââ 
;
ââ 
set
ââ !
;
ââ! "
}
ââ# $
=
ââ% &
string
ââ' -
.
ââ- .
Empty
ââ. 3
;
ââ3 4
public
ää 

string
ää 
Description
ää 
{
ää 
get
ää  #
;
ää# $
set
ää% (
;
ää( )
}
ää* +
=
ää, -
string
ää. 4
.
ää4 5
Empty
ää5 :
;
ää: ;
public
ãã 

int
ãã 
Version
ãã 
{
ãã 
get
ãã 
;
ãã 
set
ãã !
;
ãã! "
}
ãã# $
public
åå 

DateTime
åå 

ExportDate
åå 
{
åå  
get
åå! $
;
åå$ %
set
åå& )
;
åå) *
}
åå+ ,
public
çç 

int
çç 

TableCount
çç 
{
çç 
get
çç 
;
çç  
set
çç! $
;
çç$ %
}
çç& '
public
éé 

Guid
éé 
?
éé 
FloorId
éé 
{
éé 
get
éé 
;
éé 
set
éé  #
;
éé# $
}
éé% &
public
èè 

string
èè 
Software
èè 
{
èè 
get
èè  
;
èè  !
set
èè" %
;
èè% &
}
èè' (
=
èè) *
string
èè+ 1
.
èè1 2
Empty
èè2 7
;
èè7 8
public
êê 

string
êê 
SoftwareVersion
êê !
{
êê" #
get
êê$ '
;
êê' (
set
êê) ,
;
êê, -
}
êê. /
=
êê0 1
string
êê2 8
.
êê8 9
Empty
êê9 >
;
êê> ?
}ëë 
publicìì 
class
ìì 
BackupMetadata
ìì 
{îî 
public
ïï 

string
ïï 

BackupType
ïï 
{
ïï 
get
ïï "
;
ïï" #
set
ïï$ '
;
ïï' (
}
ïï) *
=
ïï+ ,
string
ïï- 3
.
ïï3 4
Empty
ïï4 9
;
ïï9 :
public
ññ 

string
ññ 
Description
ññ 
{
ññ 
get
ññ  #
;
ññ# $
set
ññ% (
;
ññ( )
}
ññ* +
=
ññ, -
string
ññ. 4
.
ññ4 5
Empty
ññ5 :
;
ññ: ;
public
óó 

DateTime
óó 

BackupDate
óó 
{
óó  
get
óó! $
;
óó$ %
set
óó& )
;
óó) *
}
óó+ ,
public
òò 

int
òò 
LayoutCount
òò 
{
òò 
get
òò  
;
òò  !
set
òò" %
;
òò% &
}
òò' (
public
ôô 

int
ôô 

TableCount
ôô 
{
ôô 
get
ôô 
;
ôô  
set
ôô! $
;
ôô$ %
}
ôô& '
public
öö 

string
öö 
Software
öö 
{
öö 
get
öö  
;
öö  !
set
öö" %
;
öö% &
}
öö' (
=
öö) *
string
öö+ 1
.
öö1 2
Empty
öö2 7
;
öö7 8
public
õõ 

string
õõ 
SoftwareVersion
õõ !
{
õõ" #
get
õõ$ '
;
õõ' (
set
õõ) ,
;
õõ, -
}
õõ. /
=
õõ0 1
string
õõ2 8
.
õõ8 9
Empty
õõ9 >
;
õõ> ?
}úú È"
êC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\System\UpdateTerminalConfigCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public

 
class

 .
"UpdateTerminalConfigCommandHandler

 /
:

0 1
ICommandHandler

2 A
<

A B'
UpdateTerminalConfigCommand

B ]
,

] ^&
UpdateTerminalConfigResult

_ y
>

y z
{ 
private 
readonly 
ITerminalRepository (
_repository) 4
;4 5
public 
.
"UpdateTerminalConfigCommandHandler -
(- .
ITerminalRepository. A

repositoryB L
)L M
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< &
UpdateTerminalConfigResult 0
>0 1
HandleAsync2 =
(= >'
UpdateTerminalConfigCommand> Y
commandZ a
,a b
CancellationTokenc t
cancellationToken	u Ü
=
á à
default
â ê
)
ê ë
{ 
var 
dto 
= 
command 
. 
Terminal "
;" #
var 
terminal 
= 
await 
_repository (
.( )!
GetByTerminalKeyAsync) >
(> ?
dto? B
.B C
TerminalKeyC N
,N O
cancellationTokenP a
)a b
;b c
if 

( 
terminal 
== 
null 
) 
{ 	
return 
new &
UpdateTerminalConfigResult 1
(1 2
false2 7
,7 8
$str9 N
)N O
;O P
} 	
terminal 
. 
Name 
= 
dto 
. 
Name  
;  !
terminal   
.   
Location   
=   
dto   
.    
Location    (
;  ( )
terminal!! 
.!! 
FloorId!! 
=!! 
dto!! 
.!! 
FloorId!! &
;!!& '
terminal"" 
."" 
HasCashDrawer"" 
=""  
dto""! $
.""$ %
HasCashDrawer""% 2
;""2 3
terminal## 
.## 
OpeningBalance## 
=##  !
dto##" %
.##% &
OpeningBalance##& 4
;##4 5
terminal$$ 
.$$ 
CurrentBalance$$ 
=$$  !
dto$$" %
.$$% &
CurrentBalance$$& 4
;$$4 5
terminal%% 
.%% 

AutoLogOut%% 
=%% 
dto%% !
.%%! "

AutoLogOut%%" ,
;%%, -
terminal&& 
.&& 
AutoLogOutTime&& 
=&&  !
dto&&" %
.&&% &
AutoLogOutTime&&& 4
;&&4 5
terminal'' 
.'' 
ShowGuestSelection'' #
=''$ %
dto''& )
.'') *
ShowGuestSelection''* <
;''< =
terminal(( 
.(( 
ShowTableSelection(( #
=(($ %
dto((& )
.(() *
ShowTableSelection((* <
;((< =
terminal)) 
.)) 
KitchenMode)) 
=)) 
dto)) "
.))" #
KitchenMode))# .
;)). /
terminal** 
.** 
DefaultFontSize**  
=**! "
dto**# &
.**& '
DefaultFontSize**' 6
;**6 7
terminal++ 
.++ 
DefaultFontFamily++ "
=++# $
dto++% (
.++( )
DefaultFontFamily++) :
;++: ;
await-- 
_repository-- 
.-- 
UpdateTerminalAsync-- -
(--- .
terminal--. 6
,--6 7
cancellationToken--8 I
)--I J
;--J K
return// 
new// &
UpdateTerminalConfigResult// -
(//- .
true//. 2
,//2 3
$str//4 b
)//b c
;//c d
}00 
}11 ¡
íC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\System\UpdateRestaurantConfigCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public 
class 0
$UpdateRestaurantConfigCommandHandler 1
:2 3
ICommandHandler4 C
<C D)
UpdateRestaurantConfigCommandD a
,a b(
UpdateRestaurantConfigResultc 
>	 Ä
{ 
private		 
readonly		 .
"IRestaurantConfigurationRepository		 7
_repository		8 C
;		C D
public 
0
$UpdateRestaurantConfigCommandHandler /
(/ 0.
"IRestaurantConfigurationRepository0 R

repositoryS ]
)] ^
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< (
UpdateRestaurantConfigResult 2
>2 3
HandleAsync4 ?
(? @)
UpdateRestaurantConfigCommand@ ]
command^ e
,e f
CancellationTokeng x
cancellationToken	y ä
=
ã å
default
ç î
)
î ï
{ 
var 
dto 
= 
command 
. 
Configuration '
;' (
var 
entity 
= 
new #
RestaurantConfiguration 0
{ 	
Name 
= 
dto 
. 
Name 
, 
Address 
= 
dto 
. 
Address !
,! "
Phone 
= 
dto 
. 
Phone 
, 
Email 
= 
dto 
. 
Email 
, 
Website 
= 
dto 
. 
Website !
,! " 
ReceiptFooterMessage  
=! "
dto# &
.& ' 
ReceiptFooterMessage' ;
,; <
TaxId 
= 
dto 
. 
TaxId 
, 
ZipCode 
= 
dto 
. 
ZipCode !
,! "
Capacity 
= 
dto 
. 
Capacity #
,# $
CurrencySymbol   
=   
dto    
.    !
CurrencySymbol  ! /
,  / 0#
ServiceChargePercentage!! #
=!!$ %
dto!!& )
.!!) *#
ServiceChargePercentage!!* A
,!!A B%
DefaultGratuityPercentage"" %
=""& '
dto""( +
.""+ ,%
DefaultGratuityPercentage"", E
,""E F
IsKioskMode## 
=## 
dto## 
.## 
IsKioskMode## )
}$$ 	
;$$	 

await&& 
_repository&& 
.&& $
UpdateConfigurationAsync&& 2
(&&2 3
entity&&3 9
,&&9 :
cancellationToken&&; L
)&&L M
;&&M N
return(( 
new(( (
UpdateRestaurantConfigResult(( /
(((/ 0
true((0 4
,((4 5
$str((6 [
)(([ \
;((\ ]
})) 
}** €
èC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\System\RestoreSystemBackupCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public 
class -
!RestoreSystemBackupCommandHandler .
:/ 0
ICommandHandler1 @
<@ A&
RestoreSystemBackupCommandA [
,[ \%
RestoreSystemBackupResult] v
>v w
{ 
private		 
readonly		 
IBackupService		 #
_backupService		$ 2
;		2 3
public 
-
!RestoreSystemBackupCommandHandler ,
(, -
IBackupService- ;
backupService< I
)I J
{ 
_backupService 
= 
backupService &
;& '
} 
public 

async 
Task 
< %
RestoreSystemBackupResult /
>/ 0
HandleAsync1 <
(< =&
RestoreSystemBackupCommand= W
commandX _
,_ `
CancellationTokena r
cancellationToken	s Ñ
=
Ö Ü
default
á é
)
é è
{ 
await 
_backupService 
. 
RestoreBackupAsync /
(/ 0
command0 7
.7 8
FileName8 @
,@ A
cancellationTokenB S
)S T
;T U
return 
new %
RestoreSystemBackupResult ,
(, -
true- 1
)1 2
;2 3
} 
} ﬂ
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\System\GetTerminalConfigQueryHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
.		' (
SystemConfig		( 4
;		4 5
public 
class )
GetTerminalConfigQueryHandler *
:+ ,
IQueryHandler- :
<: ;"
GetTerminalConfigQuery; Q
,Q R#
GetTerminalConfigResultS j
>j k
{ 
private 
readonly 
ITerminalRepository (
_repository) 4
;4 5
public 
)
GetTerminalConfigQueryHandler (
(( )
ITerminalRepository) <

repository= G
)G H
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< #
GetTerminalConfigResult -
>- .
HandleAsync/ :
(: ;"
GetTerminalConfigQuery; Q
queryR W
,W X
CancellationTokenY j
cancellationTokenk |
=} ~
default	 Ü
)
Ü á
{ 
var 
terminal 
= 
await 
_repository (
.( )!
GetByTerminalKeyAsync) >
(> ?
query? D
.D E
TerminalKeyE P
,P Q
cancellationTokenR c
)c d
;d e
if 

( 
terminal 
== 
null 
) 
{ 	
throw 
new 
	Exception 
(  
$"  "
$str" 5
{5 6
query6 ;
.; <
TerminalKey< G
}G H
$strH T
"T U
)U V
;V W
} 	
var 
dto 
= 
new 
TerminalDto !
{ 	
Id 
= 
terminal 
. 
Id 
, 
Name   
=   
terminal   
.   
Name    
,    !
TerminalKey!! 
=!! 
terminal!! "
.!!" #
TerminalKey!!# .
,!!. /
Location"" 
="" 
terminal"" 
.""  
Location""  (
,""( )
FloorId## 
=## 
terminal## 
.## 
FloorId## &
,##& '
HasCashDrawer$$ 
=$$ 
terminal$$ $
.$$$ %
HasCashDrawer$$% 2
,$$2 3
OpeningBalance%% 
=%% 
terminal%% %
.%%% &
OpeningBalance%%& 4
,%%4 5
CurrentBalance&& 
=&& 
terminal&& %
.&&% &
CurrentBalance&&& 4
,&&4 5

AutoLogOut'' 
='' 
terminal'' !
.''! "

AutoLogOut''" ,
,'', -
AutoLogOutTime(( 
=(( 
terminal(( %
.((% &
AutoLogOutTime((& 4
,((4 5
ShowGuestSelection)) 
=))  
terminal))! )
.))) *
ShowGuestSelection))* <
,))< =
ShowTableSelection** 
=**  
terminal**! )
.**) *
ShowTableSelection*** <
,**< =
KitchenMode++ 
=++ 
terminal++ "
.++" #
KitchenMode++# .
,++. /
DefaultFontSize,, 
=,, 
terminal,, &
.,,& '
DefaultFontSize,,' 6
,,,6 7
DefaultFontFamily-- 
=-- 
terminal--  (
.--( )
DefaultFontFamily--) :
}.. 	
;..	 

return00 
new00 #
GetTerminalConfigResult00 *
(00* +
dto00+ .
)00. /
;00/ 0
}11 
}22 û
äC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\System\GetSystemBackupsQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public 
class (
GetSystemBackupsQueryHandler )
:* +
IQueryHandler, 9
<9 :!
GetSystemBackupsQuery: O
,O P"
GetSystemBackupsResultQ g
>g h
{		 
private

 
readonly

 
IBackupService

 #
_backupService

$ 2
;

2 3
public 
(
GetSystemBackupsQueryHandler '
(' (
IBackupService( 6
backupService7 D
)D E
{ 
_backupService 
= 
backupService &
;& '
} 
public 

async 
Task 
< "
GetSystemBackupsResult ,
>, -
HandleAsync. 9
(9 :!
GetSystemBackupsQuery: O
queryP U
,U V
CancellationTokenW h
cancellationTokeni z
={ |
default	} Ñ
)
Ñ Ö
{ 
var 
backups 
= 
await 
_backupService *
.* +
ListBackupsAsync+ ;
(; <
cancellationToken< M
)M N
;N O
return 
new "
GetSystemBackupsResult )
() *
backups* 1
)1 2
;2 3
} 
} Æ
çC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\System\GetRestaurantConfigQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public 
class +
GetRestaurantConfigQueryHandler ,
:- .
IQueryHandler/ <
<< =$
GetRestaurantConfigQuery= U
,U V%
GetRestaurantConfigResultW p
>p q
{ 
private		 
readonly		 .
"IRestaurantConfigurationRepository		 7
_repository		8 C
;		C D
public 
+
GetRestaurantConfigQueryHandler *
(* +.
"IRestaurantConfigurationRepository+ M

repositoryN X
)X Y
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< %
GetRestaurantConfigResult /
>/ 0
HandleAsync1 <
(< =$
GetRestaurantConfigQuery= U
queryV [
,[ \
CancellationToken] n
cancellationToken	o Ä
=
Å Ç
default
É ä
)
ä ã
{ 
var 
entity 
= 
await 
_repository &
.& '!
GetConfigurationAsync' <
(< =
cancellationToken= N
)N O
;O P
var 
dto 
= 
new &
RestaurantConfigurationDto 0
{ 	
Name 
= 
entity 
. 
Name 
, 
Address 
= 
entity 
. 
Address $
,$ %
Phone 
= 
entity 
. 
Phone  
,  !
Email 
= 
entity 
. 
Email  
,  !
Website 
= 
entity 
. 
Website $
,$ % 
ReceiptFooterMessage  
=! "
entity# )
.) * 
ReceiptFooterMessage* >
,> ?
TaxId 
= 
entity 
. 
TaxId  
,  !
ZipCode 
= 
entity 
. 
ZipCode $
,$ %
Capacity 
= 
entity 
. 
Capacity &
,& '
CurrencySymbol 
= 
entity #
.# $
CurrencySymbol$ 2
,2 3#
ServiceChargePercentage   #
=  $ %
entity  & ,
.  , -#
ServiceChargePercentage  - D
,  D E%
DefaultGratuityPercentage!! %
=!!& '
entity!!( .
.!!. /%
DefaultGratuityPercentage!!/ H
,!!H I
IsKioskMode"" 
="" 
entity""  
.""  !
IsKioskMode""! ,
}## 	
;##	 

return%% 
new%% %
GetRestaurantConfigResult%% ,
(%%, -
dto%%- 0
)%%0 1
;%%1 2
}&& 
}'' √
éC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\System\CreateSystemBackupCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public 
class ,
 CreateSystemBackupCommandHandler -
:. /
ICommandHandler0 ?
<? @%
CreateSystemBackupCommand@ Y
,Y Z$
CreateSystemBackupResult[ s
>s t
{ 
private		 
readonly		 
IBackupService		 #
_backupService		$ 2
;		2 3
public 
,
 CreateSystemBackupCommandHandler +
(+ ,
IBackupService, :
backupService; H
)H I
{ 
_backupService 
= 
backupService &
;& '
} 
public 

async 
Task 
< $
CreateSystemBackupResult .
>. /
HandleAsync0 ;
(; <%
CreateSystemBackupCommand< U
commandV ]
,] ^
CancellationToken_ p
cancellationToken	q Ç
=
É Ñ
default
Ö å
)
å ç
{ 
var 
fileName 
= 
await 
_backupService +
.+ ,
CreateBackupAsync, =
(= >
cancellationToken> O
)O P
;P Q
return 
new $
CreateSystemBackupResult +
(+ ,
fileName, 4
)4 5
;5 6
} 
} Ñ
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SystemService.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class 
SystemService 
: 
ISystemService +
{ 
private 
readonly 
ISecurityService %
_securityService& 6
;6 7
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 

SystemService 
( 
ISecurityService 
securityService (
,( )!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_securityService 
= 
securityService *
;* +!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
ShutdownAsync #
(# $
UserId$ *
initiatedBy+ 6
,6 7
CancellationToken8 I
cancellationTokenJ [
=\ ]
default^ e
)e f
{ 
if 

( 
! 
await 
_securityService #
.# $
HasPermissionAsync$ 6
(6 7
initiatedBy7 B
,B C
UserPermissionD R
.R S
SystemConfigurationS f
,f g
cancellationTokenh y
)y z
)z {
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$strG 
)	 Ä
;
Ä Å
} 	
var$$ 

auditEvent$$ 
=$$ 

AuditEvent$$ #
.$$# $
Create$$$ *
($$* +
AuditEventType%% 
.%% 
SystemShutdown%% )
,%%) *
$str&& 
,&& 
Guid'' 
.'' 
Empty'' 
,'' 
initiatedBy(( 
.(( 
Value(( 
,(( 
$str)) '
,))' (
$"** 
$str** (
"**( )
,**) *
correlationId++ 
:++ 
Guid++ 
.++  
NewGuid++  '
(++' (
)++( )
)++) *
;++* +
await-- !
_auditEventRepository-- #
.--# $
AddAsync--$ ,
(--, -

auditEvent--- 7
,--7 8
cancellationToken--9 J
)--J K
;--K L
}44 
}55 Ò3
óC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SystemConfig\UpdatePrinterMappingsCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
.		' (
SystemConfig		( 4
;		4 5
public 
class /
#UpdatePrinterMappingsCommandHandler 0
:1 2
ICommandHandler3 B
<B C(
UpdatePrinterMappingsCommandC _
,_ `'
UpdatePrinterMappingsResulta |
>| }
{ 
private 
readonly %
IPrinterMappingRepository .
_repository/ :
;: ;
public 
/
#UpdatePrinterMappingsCommandHandler .
(. /%
IPrinterMappingRepository/ H

repositoryI S
)S T
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< '
UpdatePrinterMappingsResult 1
>1 2
HandleAsync3 >
(> ?(
UpdatePrinterMappingsCommand? [
command\ c
,c d
CancellationTokene v
cancellationToken	w à
=
â ä
default
ã í
)
í ì
{ 
try 
{ 	
var 
existingMappings  
=! "
await# (
_repository) 4
.4 5 
GetByTerminalIdAsync5 I
(I J
commandJ Q
.Q R

TerminalIdR \
,\ ]
cancellationToken^ o
)o p
;p q
var  
existingMappingsList $
=% &
existingMappings' 7
.7 8
ToList8 >
(> ?
)? @
;@ A
var 
commandGroupIds 
=  !
command" )
.) *
Mappings* 2
.2 3
Select3 9
(9 :
m: ;
=>< >
m? @
.@ A
PrinterGroupIdA O
)O P
.P Q
ToListQ W
(W X
)X Y
;Y Z
foreach 
( 
var 
existing !
in" $ 
existingMappingsList% 9
)9 :
{ 
if 
( 
! 
commandGroupIds $
.$ %
Contains% -
(- .
existing. 6
.6 7
PrinterGroupId7 E
)E F
)F G
{   
await!! 
_repository!! %
.!!% &
DeleteAsync!!& 1
(!!1 2
existing!!2 :
,!!: ;
cancellationToken!!< M
)!!M N
;!!N O
}"" 
}## 
foreach&& 
(&& 
var&& 
dto&& 
in&& 
command&&  '
.&&' (
Mappings&&( 0
)&&0 1
{'' 
var(( 
existing(( 
=((  
existingMappingsList(( 3
.((3 4
FirstOrDefault((4 B
(((B C
m((C D
=>((E G
m((H I
.((I J
PrinterGroupId((J X
==((Y [
dto((\ _
.((_ `
PrinterGroupId((` n
)((n o
;((o p
if)) 
()) 
existing)) 
!=)) 
null))  $
)))$ %
{** 
existing++ 
.++ 
UpdateConfiguration++ 0
(++0 1
dto,, 
.,, 
PhysicalPrinterName,, /
,,,/ 0
dto-- 
.-- 
Format-- "
,--" #
dto.. 
... 

CutEnabled.. &
,..& '
dto// 
.// 
PaperWidthMm// (
,//( )
dto00 
.00 
PrintableWidthChars00 /
,00/ 0
dto11 
.11 
Dpi11 
,11  
dto22 
.22 
SupportsCashDrawer22 .
,22. /
dto33 
.33 
SupportsImages33 *
,33* +
dto44 
.44 

SupportsQr44 &
)44& '
;44' (
await55 
_repository55 %
.55% &
UpdateAsync55& 1
(551 2
existing552 :
,55: ;
cancellationToken55< M
)55M N
;55N O
}66 
else77 
{88 
var99 

newMapping99 "
=99# $
PrinterMapping99% 3
.993 4
Create994 :
(99: ;
command99; B
.99B C

TerminalId99C M
,99M N
dto99O R
.99R S
PrinterGroupId99S a
,99a b
dto99c f
.99f g
PhysicalPrinterName99g z
,99z {
dto99| 
.	99 Ä
Format
99Ä Ü
,
99Ü á
dto
99à ã
.
99ã å

CutEnabled
99å ñ
)
99ñ ó
;
99ó ò

newMapping;; 
.;;  
UpdateConfiguration;;  3
(;;3 4
dto<< 
.<< 
PhysicalPrinterName<< /
,<</ 0
dto== 
.== 
Format== "
,==" #
dto>> 
.>> 

CutEnabled>> &
,>>& '
dto?? 
.?? 
PaperWidthMm?? (
,??( )
dto@@ 
.@@ 
PrintableWidthChars@@ /
,@@/ 0
dtoAA 
.AA 
DpiAA 
,AA  
dtoBB 
.BB 
SupportsCashDrawerBB .
,BB. /
dtoCC 
.CC 
SupportsImagesCC *
,CC* +
dtoDD 
.DD 

SupportsQrDD &
)DD& '
;DD' (
awaitFF 
_repositoryFF %
.FF% &
AddAsyncFF& .
(FF. /

newMappingFF/ 9
,FF9 :
cancellationTokenFF; L
)FFL M
;FFM N
}GG 
}HH 
returnJJ 
newJJ '
UpdatePrinterMappingsResultJJ 2
(JJ2 3
trueJJ3 7
,JJ7 8
$strJJ9 a
)JJa b
;JJb c
}KK 	
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL 
{MM 	
returnNN 
newNN '
UpdatePrinterMappingsResultNN 2
(NN2 3
falseNN3 8
,NN8 9
$"NN: <
$strNN< ]
{NN] ^
exNN^ `
.NN` a
MessageNNa h
}NNh i
"NNi j
)NNj k
;NNk l
}OO 	
}PP 
}QQ ◊2
ïC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SystemConfig\UpdatePrinterGroupsCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
.		' (
SystemConfig		( 4
;		4 5
public 
class -
!UpdatePrinterGroupsCommandHandler .
:/ 0
ICommandHandler1 @
<@ A&
UpdatePrinterGroupsCommandA [
,[ \%
UpdatePrinterGroupsResult] v
>v w
{ 
private 
readonly #
IPrinterGroupRepository ,
_repository- 8
;8 9
public 
-
!UpdatePrinterGroupsCommandHandler ,
(, -#
IPrinterGroupRepository- D

repositoryE O
)O P
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< %
UpdatePrinterGroupsResult /
>/ 0
HandleAsync1 <
(< =&
UpdatePrinterGroupsCommand= W
commandX _
,_ `
CancellationTokena r
cancellationToken	s Ñ
=
Ö Ü
default
á é
)
é è
{ 
try 
{ 	
var 
existingGroups 
=  
await! &
_repository' 2
.2 3
GetAllAsync3 >
(> ?
cancellationToken? P
)P Q
;Q R
var 
existingGroupsList "
=# $
existingGroups% 3
.3 4
ToList4 :
(: ;
); <
;< =
var 

commandIds 
= 
command $
.$ %
Groups% +
.+ ,
Select, 2
(2 3
g3 4
=>5 7
g8 9
.9 :
Id: <
)< =
.= >
ToList> D
(D E
)E F
;F G
foreach 
( 
var 
existing !
in" $
existingGroupsList% 7
)7 8
{ 
if 
( 
! 

commandIds 
.  
Contains  (
(( )
existing) 1
.1 2
Id2 4
)4 5
)5 6
{   
await!! 
_repository!! %
.!!% &
DeleteAsync!!& 1
(!!1 2
existing!!2 :
,!!: ;
cancellationToken!!< M
)!!M N
;!!N O
}"" 
}## 
foreach&& 
(&& 
var&& 
dto&& 
in&& 
command&&  '
.&&' (
Groups&&( .
)&&. /
{'' 
var(( 
existing(( 
=(( 
existingGroupsList(( 1
.((1 2
FirstOrDefault((2 @
(((@ A
g((A B
=>((C E
g((F G
.((G H
Id((H J
==((K M
dto((N Q
.((Q R
Id((R T
)((T U
;((U V
if)) 
()) 
existing)) 
!=)) 
null))  $
)))$ %
{** 
existing++ 
.++ 
Update++ #
(++# $
dto++$ '
.++' (
Name++( ,
,++, -
dto++. 1
.++1 2
PrinterType++2 =
)++= >
;++> ?
existing,, 
.,, 
UpdateBehavior,, +
(,,+ ,
dto-- 
.-- 
CutBehavior-- '
,--' (
dto.. 
... 

ShowPrices.. &
,..& '
dto// 
.// 

RetryCount// &
,//& '
dto00 
.00 
RetryDelayMs00 (
,00( )
dto11 
.11 
AllowReprint11 (
,11( )
dto22 
.22 "
FallbackPrinterGroupId22 2
)222 3
;223 4
existing33 
.33 
SetTemplates33 )
(33) *
dto33* -
.33- .
ReceiptTemplateId33. ?
,33? @
dto33A D
.33D E
KitchenTemplateId33E V
)33V W
;33W X
await44 
_repository44 %
.44% &
UpdateAsync44& 1
(441 2
existing442 :
,44: ;
cancellationToken44< M
)44M N
;44N O
}55 
else66 
{77 
var88 
newGroup88  
=88! "
PrinterGroup88# /
.88/ 0
Create880 6
(886 7
dto887 :
.88: ;
Name88; ?
,88? @
dto88A D
.88D E
PrinterType88E P
)88P Q
;88Q R
newGroup99 
.99 
UpdateBehavior99 +
(99+ ,
dto:: 
.:: 
CutBehavior:: '
,::' (
dto;; 
.;; 

ShowPrices;; &
,;;& '
dto<< 
.<< 

RetryCount<< &
,<<& '
dto== 
.== 
RetryDelayMs== (
,==( )
dto>> 
.>> 
AllowReprint>> (
,>>( )
dto?? 
.?? "
FallbackPrinterGroupId?? 2
)??2 3
;??3 4
newGroup@@ 
.@@ 
SetTemplates@@ )
(@@) *
dto@@* -
.@@- .
ReceiptTemplateId@@. ?
,@@? @
dto@@A D
.@@D E
KitchenTemplateId@@E V
)@@V W
;@@W X
awaitAA 
_repositoryAA %
.AA% &
AddAsyncAA& .
(AA. /
newGroupAA/ 7
,AA7 8
cancellationTokenAA9 J
)AAJ K
;AAK L
}BB 
}CC 
returnEE 
newEE %
UpdatePrinterGroupsResultEE 0
(EE0 1
trueEE1 5
,EE5 6
$strEE7 ]
)EE] ^
;EE^ _
}FF 	
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG 
{HH 	
returnII 
newII %
UpdatePrinterGroupsResultII 0
(II0 1
falseII1 6
,II6 7
$"II8 :
$strII: Y
{IIY Z
exIIZ \
.II\ ]
MessageII] d
}IId e
"IIe f
)IIf g
;IIg h
}JJ 	
}KK 
}LL …&
íC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SystemConfig\UpdateCardConfigCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public		 
class		 *
UpdateCardConfigCommandHandler		 +
:		, -
ICommandHandler		. =
<		= >#
UpdateCardConfigCommand		> U
,		U V"
UpdateCardConfigResult		W m
>		m n
{

 
private 
readonly 3
'IMerchantGatewayConfigurationRepository <
_repository= H
;H I
private 
readonly !
IAesEncryptionService *
_encryptionService+ =
;= >
public 
*
UpdateCardConfigCommandHandler )
() *3
'IMerchantGatewayConfigurationRepository /

repository0 :
,: ;!
IAesEncryptionService 
encryptionService /
)/ 0
{ 
_repository 
= 

repository  
;  !
_encryptionService 
= 
encryptionService .
;. /
} 
public 

async 
Task 
< "
UpdateCardConfigResult ,
>, -
HandleAsync. 9
(9 :#
UpdateCardConfigCommand: Q
commandR Y
,Y Z
CancellationToken[ l
cancellationTokenm ~
=	 Ä
default
Å à
)
à â
{ 
var 
dto 
= 
command 
. 
Config  
;  !
var 
config 
= 
await 
_repository &
.& ' 
GetByTerminalIdAsync' ;
(; <
dto< ?
.? @

TerminalId@ J
,J K
cancellationTokenL ]
)] ^
;^ _
var 
encryptedApiKey 
= 
_encryptionService 0
.0 1
Encrypt1 8
(8 9
dto9 <
.< =
ApiKey= C
)C D
;D E
if 

( 
config 
== 
null 
) 
{ 	
config 
= (
MerchantGatewayConfiguration 1
.1 2
Create2 8
(8 9
dto   
.   

TerminalId   
,   
dto!! 
.!! 
ProviderName!!  
,!!  !
dto"" 
."" 

MerchantId"" 
,"" 
encryptedApiKey## 
,##  
dto$$ 
.$$ 

GatewayUrl$$ 
)$$ 
;$$  
config&& 
.&& 
UpdateSettings&& !
(&&! "
dto'' 
.'' 
CardTypesAccepted'' %
,''% &
dto(( 
.(( 
SignatureThreshold(( &
,((& '
dto)) 
.)) 
AllowTipAdjustment)) &
,))& '
dto** 
.** 
IsExternalTerminal** &
,**& '
dto++ 
.++ 
AllowManualEntry++ $
,++$ %
dto,, 
.,, 
EnablePreAuth,, !
),,! "
;,," #
await.. 
_repository.. 
... 
AddAsync.. &
(..& '
config..' -
,..- .
cancellationToken../ @
)..@ A
;..A B
}// 	
else00 
{11 	
config22 
.22 
UpdateCredentials22 $
(22$ %
dto22% (
.22( )

MerchantId22) 3
,223 4
encryptedApiKey225 D
,22D E
dto22F I
.22I J

GatewayUrl22J T
)22T U
;22U V
config33 
.33 
UpdateSettings33 !
(33! "
dto44 
.44 
CardTypesAccepted44 %
,44% &
dto55 
.55 
SignatureThreshold55 &
,55& '
dto66 
.66 
AllowTipAdjustment66 &
,66& '
dto77 
.77 
IsExternalTerminal77 &
,77& '
dto88 
.88 
AllowManualEntry88 $
,88$ %
dto99 
.99 
EnablePreAuth99 !
)99! "
;99" #
await;; 
_repository;; 
.;; 
UpdateAsync;; )
(;;) *
config;;* 0
,;;0 1
cancellationToken;;2 C
);;C D
;;;D E
}<< 	
return>> 
new>> "
UpdateCardConfigResult>> )
(>>) *
true>>* .
,>>. /
$str>>0 Z
)>>Z [
;>>[ \
}?? 
}@@ Ê"
íC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SystemConfig\GetPrinterMappingsQueryHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
.		' (
SystemConfig		( 4
;		4 5
public 
class *
GetPrinterMappingsQueryHandler +
:, -
IQueryHandler. ;
<; <#
GetPrinterMappingsQuery< S
,S T$
GetPrinterMappingsResultU m
>m n
{ 
private 
readonly %
IPrinterMappingRepository .
_repository/ :
;: ;
private 
readonly #
IPrinterGroupRepository ,
_groupRepository- =
;= >
public 
*
GetPrinterMappingsQueryHandler )
() *%
IPrinterMappingRepository* C

repositoryD N
,N O#
IPrinterGroupRepositoryP g
groupRepositoryh w
)w x
{ 
_repository 
= 

repository  
;  !
_groupRepository 
= 
groupRepository *
;* +
} 
public 

async 
Task 
< $
GetPrinterMappingsResult .
>. /
HandleAsync0 ;
(; <#
GetPrinterMappingsQuery< S
queryT Y
,Y Z
CancellationToken[ l
cancellationTokenm ~
=	 Ä
default
Å à
)
à â
{ 
var 
mappings 
= 
await 
_repository (
.( ) 
GetByTerminalIdAsync) =
(= >
query> C
.C D

TerminalIdD N
,N O
cancellationTokenP a
)a b
;b c
var 
groups 
= 
await 
_groupRepository +
.+ ,
GetAllAsync, 7
(7 8
cancellationToken8 I
)I J
;J K
var 

groupsDict 
= 
groups 
.  
ToDictionary  ,
(, -
g- .
=>/ 1
g2 3
.3 4
Id4 6
,6 7
g8 9
=>: <
g= >
.> ?
Name? C
)C D
;D E
return 
new $
GetPrinterMappingsResult +
(+ ,
mappings, 4
.4 5
Select5 ;
(; <
m< =
=>> @
newA D
PrinterMappingDtoE V
{ 	
Id 
= 
m 
. 
Id 
, 

TerminalId 
= 
m 
. 

TerminalId %
,% &
PrinterGroupId   
=   
m   
.   
PrinterGroupId   -
,  - .
PhysicalPrinterName!! 
=!!  !
m!!" #
.!!# $
PhysicalPrinterName!!$ 7
,!!7 8
Format"" 
="" 
m"" 
."" 
Format"" 
,"" 

CutEnabled## 
=## 
m## 
.## 

CutEnabled## %
,##% &
PrinterGroupName$$ 
=$$ 

groupsDict$$ )
.$$) *
GetValueOrDefault$$* ;
($$; <
m$$< =
.$$= >
PrinterGroupId$$> L
,$$L M
$str$$N ]
)$$] ^
,$$^ _
PaperWidthMm%% 
=%% 
m%% 
.%% 
PaperWidthMm%% )
,%%) *
PrintableWidthChars&& 
=&&  !
m&&" #
.&&# $
PrintableWidthChars&&$ 7
,&&7 8
Dpi'' 
='' 
m'' 
.'' 
Dpi'' 
,'' 
SupportsCashDrawer(( 
=((  
m((! "
.((" #
SupportsCashDrawer((# 5
,((5 6
SupportsImages)) 
=)) 
m)) 
.)) 
SupportsImages)) -
,))- .

SupportsQr** 
=** 
m** 
.** 

SupportsQr** %
}++ 	
)++	 

.++
 
ToList++ 
(++ 
)++ 
)++ 
;++ 
},, 
}-- ø
êC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SystemConfig\GetPrinterGroupsQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public

 
class

 (
GetPrinterGroupsQueryHandler

 )
:

* +
IQueryHandler

, 9
<

9 :!
GetPrinterGroupsQuery

: O
,

O P"
GetPrinterGroupsResult

Q g
>

g h
{ 
private 
readonly #
IPrinterGroupRepository ,
_repository- 8
;8 9
public 
(
GetPrinterGroupsQueryHandler '
(' (#
IPrinterGroupRepository( ?

repository@ J
)J K
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< "
GetPrinterGroupsResult ,
>, -
HandleAsync. 9
(9 :!
GetPrinterGroupsQuery: O
queryP U
,U V
CancellationTokenW h
cancellationTokeni z
={ |
default	} Ñ
)
Ñ Ö
{ 
var 
groups 
= 
await 
_repository &
.& '
GetAllAsync' 2
(2 3
cancellationToken3 D
)D E
;E F
return 
new "
GetPrinterGroupsResult )
() *
groups* 0
.0 1
Select1 7
(7 8
g8 9
=>: <
new= @
PrinterGroupDtoA P
{ 	
Id 
= 
g 
. 
Id 
, 
Name 
= 
g 
. 
Name 
, 
PrinterType 
= 
g 
. 
Type  
,  !
CutBehavior 
= 
g 
. 
CutBehavior '
,' (

ShowPrices 
= 
g 
. 

ShowPrices %
,% &

RetryCount 
= 
g 
. 

RetryCount %
,% &
RetryDelayMs 
= 
g 
. 
RetryDelayMs )
,) *
AllowReprint 
= 
g 
. 
AllowReprint )
,) *"
FallbackPrinterGroupId   "
=  # $
g  % &
.  & '"
FallbackPrinterGroupId  ' =
,  = >
KitchenTemplateId!! 
=!! 
g!!  !
.!!! "
KitchenTemplateId!!" 3
,!!3 4
ReceiptTemplateId"" 
="" 
g""  !
.""! "
ReceiptTemplateId""" 3
}## 	
)##	 

.##
 
ToList## 
(## 
)## 
)## 
;## 
}$$ 
}%% ⁄!
çC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SystemConfig\GetCardConfigQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
SystemConfig( 4
;4 5
public

 
class

 %
GetCardConfigQueryHandler

 &
:

' (
IQueryHandler

) 6
<

6 7
GetCardConfigQuery

7 I
,

I J
GetCardConfigResult

K ^
>

^ _
{ 
private 
readonly 3
'IMerchantGatewayConfigurationRepository <
_repository= H
;H I
private 
readonly !
IAesEncryptionService *
_encryptionService+ =
;= >
public 
%
GetCardConfigQueryHandler $
($ %3
'IMerchantGatewayConfigurationRepository /

repository0 :
,: ;!
IAesEncryptionService 
encryptionService /
)/ 0
{ 
_repository 
= 

repository  
;  !
_encryptionService 
= 
encryptionService .
;. /
} 
public 

async 
Task 
< 
GetCardConfigResult )
>) *
HandleAsync+ 6
(6 7
GetCardConfigQuery7 I
queryJ O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
config 
= 
await 
_repository &
.& ' 
GetByTerminalIdAsync' ;
(; <
query< A
.A B

TerminalIdB L
,L M
cancellationTokenN _
)_ `
;` a
if 

( 
config 
== 
null 
) 
{ 	
return 
new 
GetCardConfigResult *
(* +
new+ .
CardConfigDto/ <
{ 

TerminalId   
=   
query   "
.  " #

TerminalId  # -
,  - .
ProviderName!! 
=!! 
$str!! .
,!!. /
IsActive"" 
="" 
false""  
}## 
)## 
;## 
}$$ 	
return&& 
new&& 
GetCardConfigResult&& &
(&&& '
new&&' *
CardConfigDto&&+ 8
{'' 	
Id(( 
=(( 
config(( 
.(( 
Id(( 
,(( 

TerminalId)) 
=)) 
config)) 
.))  

TerminalId))  *
,))* +
ProviderName** 
=** 
config** !
.**! "
ProviderName**" .
,**. /

MerchantId++ 
=++ 
config++ 
.++  

MerchantId++  *
,++* +
ApiKey,, 
=,, 
_encryptionService,, '
.,,' (
Decrypt,,( /
(,,/ 0
config,,0 6
.,,6 7
EncryptedApiKey,,7 F
),,F G
,,,G H

GatewayUrl-- 
=-- 
config-- 
.--  

GatewayUrl--  *
,--* +
IsActive.. 
=.. 
config.. 
... 
IsActive.. &
,..& '
CardTypesAccepted// 
=// 
config//  &
.//& '
CardTypesAccepted//' 8
,//8 9
SignatureThreshold00 
=00  
config00! '
.00' (
SignatureThreshold00( :
,00: ;
AllowTipAdjustment11 
=11  
config11! '
.11' (
AllowTipAdjustment11( :
,11: ;
IsExternalTerminal22 
=22  
config22! '
.22' (
IsExternalTerminal22( :
,22: ;
AllowManualEntry33 
=33 
config33 %
.33% &
AllowManualEntry33& 6
,336 7
EnablePreAuth44 
=44 
config44 "
.44" #
EnablePreAuth44# 0
}55 	
)55	 

;55
 
}66 
}77 ∆c
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SplitTicketCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class %
SplitTicketCommandHandler &
:' (
ICommandHandler) 8
<8 9
SplitTicketCommand9 K
,K L
SplitTicketResultM ^
>^ _
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
Domain 
. 
DomainServices *
.* +
TicketDomainService+ > 
_ticketDomainService? S
;S T
public 
%
SplitTicketCommandHandler $
($ %
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
,2 3
Domain 
. 
DomainServices 
. 
TicketDomainService 1
ticketDomainService2 E
)E F
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5 
_ticketDomainService 
= 
ticketDomainService 2
;2 3
} 
public 

async 
Task 
< 
SplitTicketResult '
>' (
HandleAsync) 4
(4 5
SplitTicketCommand 
command "
," #
CancellationToken   
cancellationToken   +
=  , -
default  . 5
)  5 6
{!! 
var## 
originalTicket## 
=## 
await## "
_ticketRepository### 4
.##4 5
GetByIdAsync##5 A
(##A B
command##B I
.##I J
OriginalTicketId##J Z
,##Z [
cancellationToken##\ m
)##m n
;##n o
if$$ 

($$ 
originalTicket$$ 
==$$ 
null$$ "
)$$" #
{%% 	
return&& 
new&& 
SplitTicketResult&& (
{'' 
Success(( 
=(( 
false(( 
,((  
ErrorMessage)) 
=)) 
$")) !
$str))! (
{))( )
command))) 0
.))0 1
OriginalTicketId))1 A
}))A B
$str))B M
"))M N
}** 
;** 
}++ 	
if.. 

(.. 
!..  
_ticketDomainService.. !
...! "
CanSplitTicket.." 0
(..0 1
originalTicket..1 ?
)..? @
)..@ A
{// 	
return00 
new00 
SplitTicketResult00 (
{11 
Success22 
=22 
false22 
,22  
ErrorMessage33 
=33 
$"33 !
$str33! (
{33( )
originalTicket33) 7
.337 8
TicketNumber338 D
}33D E
$str33E V
"33V W
}44 
;44 
}55 	
if88 

(88 
command88 
.88 
OrderLineIdsToSplit88 '
==88( *
null88+ /
||880 2
!883 4
command884 ;
.88; <
OrderLineIdsToSplit88< O
.88O P
Any88P S
(88S T
)88T U
)88U V
{99 	
return:: 
new:: 
SplitTicketResult:: (
{;; 
Success<< 
=<< 
false<< 
,<<  
ErrorMessage== 
=== 
$str== T
}>> 
;>> 
}?? 	
ifBB 

(BB 
commandBB 
.BB 
OrderLineIdsToSplitBB '
.BB' (
CountBB( -
>=BB. 0
originalTicketBB1 ?
.BB? @

OrderLinesBB@ J
.BBJ K
CountBBK P
)BBP Q
{CC 	
returnDD 
newDD 
SplitTicketResultDD (
{EE 
SuccessFF 
=FF 
falseFF 
,FF  
ErrorMessageGG 
=GG 
$strGG s
}HH 
;HH 
}II 	
varLL 
orderLinesToSplitLL 
=LL 
originalTicketLL  .
.LL. /

OrderLinesLL/ 9
.MM 
WhereMM 
(MM 
olMM 
=>MM 
commandMM  
.MM  !
OrderLineIdsToSplitMM! 4
.MM4 5
ContainsMM5 =
(MM= >
olMM> @
.MM@ A
IdMMA C
)MMC D
)MMD E
.NN 
ToListNN 
(NN 
)NN 
;NN 
ifPP 

(PP 
orderLinesToSplitPP 
.PP 
CountPP #
!=PP$ &
commandPP' .
.PP. /
OrderLineIdsToSplitPP/ B
.PPB C
CountPPC H
)PPH I
{QQ 	
returnRR 
newRR 
SplitTicketResultRR (
{SS 
SuccessTT 
=TT 
falseTT 
,TT  
ErrorMessageUU 
=UU 
$strUU T
}VV 
;VV 
}WW 	
varZZ 
newTicketNumberZZ 
=ZZ 
awaitZZ #
_ticketRepositoryZZ$ 5
.ZZ5 6$
GetNextTicketNumberAsyncZZ6 N
(ZZN O
cancellationTokenZZO `
)ZZ` a
;ZZa b
var]] 
	newTicket]] 
=]] 
Ticket]] 
.]] 
Create]] %
(]]% &
newTicketNumber^^ 
,^^ 
command__ 
.__ 
SplitBy__ 
,__ 
command`` 
.`` 

TerminalId`` 
,`` 
commandaa 
.aa 
ShiftIdaa 
,aa 
commandbb 
.bb 
OrderTypeIdbb 
,bb  
commandcc 
.cc 
GlobalIdcc 
)cc 
;cc 
intjj 
orderLinesMovedjj 
=jj 
$numjj 
;jj  
foreachkk 
(kk 
varkk 
	orderLinekk 
inkk !
orderLinesToSplitkk" 3
)kk3 4
{ll 	
varnn 
newOrderLinenn 
=nn 
	OrderLinenn (
.nn( )
Createnn) /
(nn/ 0
	newTicketoo 
.oo 
Idoo 
,oo 
	orderLinepp 
.pp 

MenuItemIdpp $
,pp$ %
	orderLineqq 
.qq 
MenuItemNameqq &
,qq& '
	orderLinerr 
.rr 
Quantityrr "
,rr" #
	orderLiness 
.ss 
	UnitPricess #
,ss# $
	orderLinett 
.tt 
TaxRatett !
,tt! "
	orderLineuu 
.uu 
CategoryNameuu &
,uu& '
	orderLinevv 
.vv 
	GroupNamevv #
)vv# $
;vv$ %
	newTicket|| 
.|| 
AddOrderLine|| "
(||" #
newOrderLine||# /
)||/ 0
;||0 1
originalTicket 
. 
RemoveOrderLine *
(* +
	orderLine+ 4
.4 5
Id5 7
)7 8
;8 9
orderLinesMoved
ÅÅ 
++
ÅÅ 
;
ÅÅ 
}
ÇÇ 	"
_ticketDomainService
ÖÖ 
.
ÖÖ 
CalculateTotals
ÖÖ ,
(
ÖÖ, -
originalTicket
ÖÖ- ;
)
ÖÖ; <
;
ÖÖ< ="
_ticketDomainService
ÜÜ 
.
ÜÜ 
CalculateTotals
ÜÜ ,
(
ÜÜ, -
	newTicket
ÜÜ- 6
)
ÜÜ6 7
;
ÜÜ7 8
await
ââ 
_ticketRepository
ââ 
.
ââ  
AddAsync
ââ  (
(
ââ( )
	newTicket
ââ) 2
,
ââ2 3
cancellationToken
ââ4 E
)
ââE F
;
ââF G
await
ää 
_ticketRepository
ää 
.
ää  
UpdateAsync
ää  +
(
ää+ ,
originalTicket
ää, :
,
ää: ;
cancellationToken
ää< M
)
ääM N
;
ääN O
var
çç 
correlationId
çç 
=
çç 
Guid
çç  
.
çç  !
NewGuid
çç! (
(
çç( )
)
çç) *
;
çç* +
var
èè  
originalAuditEvent
èè 
=
èè  

AuditEvent
èè! +
.
èè+ ,
Create
èè, 2
(
èè2 3
AuditEventType
êê 
.
êê 
Modified
êê #
,
êê# $
nameof
ëë 
(
ëë 
Ticket
ëë 
)
ëë 
,
ëë 
originalTicket
íí 
.
íí 
Id
íí 
,
íí 
command
ìì 
.
ìì 
SplitBy
ìì 
.
ìì 
Value
ìì !
,
ìì! "
System
îî 
.
îî 
Text
îî 
.
îî 
Json
îî 
.
îî 
JsonSerializer
îî +
.
îî+ ,
	Serialize
îî, 5
(
îî5 6
new
îî6 9
{
îî: ;
Action
ïï 
=
ïï 
$str
ïï  
,
ïï  !
OrderLinesRemoved
ññ !
=
ññ" #
orderLinesMoved
ññ$ 3
,
ññ3 4
NewTicketId
óó 
=
óó 
	newTicket
óó '
.
óó' (
Id
óó( *
}
òò 
)
òò 
,
òò 
$"
ôô 
$str
ôô 
{
ôô 
originalTicket
ôô $
.
ôô$ %
TicketNumber
ôô% 1
}
ôô1 2
$str
ôô2 :
{
ôô: ;
orderLinesMoved
ôô; J
}
ôôJ K
$str
ôôK h
{
ôôh i
newTicketNumber
ôôi x
}
ôôx y
"
ôôy z
,
ôôz {
correlationId
öö 
:
öö 
correlationId
öö (
)
öö( )
;
öö) *
var
úú 
newAuditEvent
úú 
=
úú 

AuditEvent
úú &
.
úú& '
Create
úú' -
(
úú- .
AuditEventType
ùù 
.
ùù 
Created
ùù "
,
ùù" #
nameof
ûû 
(
ûû 
Ticket
ûû 
)
ûû 
,
ûû 
	newTicket
üü 
.
üü 
Id
üü 
,
üü 
command
†† 
.
†† 
SplitBy
†† 
.
†† 
Value
†† !
,
††! "
System
°° 
.
°° 
Text
°° 
.
°° 
Json
°° 
.
°° 
JsonSerializer
°° +
.
°°+ ,
	Serialize
°°, 5
(
°°5 6
new
°°6 9
{
°°: ;
Action
¢¢ 
=
¢¢ 
$str
¢¢ $
,
¢¢$ %
OriginalTicketId
££  
=
££! "
originalTicket
££# 1
.
££1 2
Id
££2 4
,
££4 5
OrderLinesMoved
§§ 
=
§§  !
orderLinesMoved
§§" 1
}
•• 
)
•• 
,
•• 
$"
¶¶ 
$str
¶¶ 
{
¶¶ 
newTicketNumber
¶¶ %
}
¶¶% &
$str
¶¶& D
{
¶¶D E
originalTicket
¶¶E S
.
¶¶S T
TicketNumber
¶¶T `
}
¶¶` a
"
¶¶a b
,
¶¶b c
correlationId
ßß 
:
ßß 
correlationId
ßß (
)
ßß( )
;
ßß) *
await
©© #
_auditEventRepository
©© #
.
©©# $
AddAsync
©©$ ,
(
©©, - 
originalAuditEvent
©©- ?
,
©©? @
cancellationToken
©©A R
)
©©R S
;
©©S T
await
™™ #
_auditEventRepository
™™ #
.
™™# $
AddAsync
™™$ ,
(
™™, -
newAuditEvent
™™- :
,
™™: ;
cancellationToken
™™< M
)
™™M N
;
™™N O
return
¨¨ 
new
¨¨ 
SplitTicketResult
¨¨ $
{
≠≠ 	
Success
ÆÆ 
=
ÆÆ 
true
ÆÆ 
,
ÆÆ 
NewTicketId
ØØ 
=
ØØ 
	newTicket
ØØ #
.
ØØ# $
Id
ØØ$ &
,
ØØ& '
NewTicketNumber
∞∞ 
=
∞∞ 
newTicketNumber
∞∞ -
,
∞∞- .
OrderLinesMoved
±± 
=
±± 
orderLinesMoved
±± -
}
≤≤ 	
;
≤≤	 

}
≥≥ 
}¥¥ É 
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SettleTicketCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public		 
class		 &
SettleTicketCommandHandler		 '
:		( )
ICommandHandler		* 9
<		9 :
SettleTicketCommand		: M
>		M N
{

 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
&
SettleTicketCommandHandler %
(% &
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! "
SettleTicketCommand" 5
command6 =
,= >
CancellationToken? P
cancellationTokenQ b
=c d
defaulte l
)l m
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI P
{P Q
commandQ X
.X Y
TicketIdY a
}a b
$strb m
"m n
)n o
;o p
} 	
ticket 
. 
CalculateTotals 
( 
)  
;  !
if   

(   
ticket   
.   
	DueAmount   
>   
Money   $
.  $ %
Zero  % )
(  ) *
)  * +
)  + ,
{!! 	
throw## 
new## 
Domain## 
.## 

Exceptions## (
.##( )*
BusinessRuleViolationException##) G
(##G H
$str##H v
)##v w
;##w x
}$$ 	
ticket(( 
.(( 
Close(( 
((( 
new(( 
UserId(( 
(((  
command((  '
.((' (
UserId((( .
)((. /
)((/ 0
;((0 1
await** 
_ticketRepository** 
.**  
UpdateAsync**  +
(**+ ,
ticket**, 2
,**2 3
cancellationToken**4 E
)**E F
;**F G
var-- 
audit-- 
=-- 

AuditEvent-- 
.-- 
Create-- %
(--% &
AuditEventType.. 
... 
StatusChanged.. (
,..( )
nameof// 
(// 
Ticket// 
)// 
,// 
ticket00 
.00 
Id00 
,00 
command11 
.11 
UserId11 
,11 
$str22 
,22 
$"33 
$str33 
{33 
ticket33 
.33 
TicketNumber33 )
}33) *
$str33* =
"33= >
)44 	
;44	 

await55 !
_auditEventRepository55 #
.55# $
AddAsync55$ ,
(55, -
audit55- 2
,552 3
cancellationToken554 E
)55E F
;55F G
}66 
}77 Ò'
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SetTaxExemptCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public		 
class		 &
SetTaxExemptCommandHandler		 '
:		( )
ICommandHandler		* 9
<		9 :
SetTaxExemptCommand		: M
,		M N
SetTaxExemptResult		O a
>		a b
{

 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
&
SetTaxExemptCommandHandler %
(% &
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
SetTaxExemptResult (
>( )
HandleAsync* 5
(5 6
SetTaxExemptCommand6 I
commandJ Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
return 
new 
SetTaxExemptResult *
{+ ,
Success- 4
=5 6
false7 <
,< =
Error> C
=D E
$"F H
$strH O
{O P
commandP W
.W X
TicketIdX `
}` a
$stra l
"l m
}n o
;o p
} 	
try 
{ 	
var!! 
oldState!! 
=!! 
ticket!! !
.!!! "
IsTaxExempt!!" -
;!!- .
ticket$$ 
.$$ 
SetTaxExempt$$ 
($$  
command$$  '
.$$' (
IsTaxExempt$$( 3
)$$3 4
;$$4 5
await'' 
_ticketRepository'' #
.''# $
UpdateAsync''$ /
(''/ 0
ticket''0 6
,''6 7
cancellationToken''8 I
)''I J
;''J K
if** 
(** 
oldState** 
!=** 
command** #
.**# $
IsTaxExempt**$ /
)**/ 0
{++ 
var,, 

auditEvent,, 
=,,  

AuditEvent,,! +
.,,+ ,
Create,,, 2
(,,2 3
AuditEventType-- "
.--" #
Modified--# +
,--+ ,
nameof.. 
(.. 
Ticket.. !
)..! "
,.." #
ticket// 
.// 
Id// 
,// 
command00 
.00 

ModifiedBy00 &
.00& '
Value00' ,
,00, -
JsonSerializer11 "
.11" #
	Serialize11# ,
(11, -
new11- 0
{111 2
OldTaxExempt113 ?
=11@ A
oldState11B J
,11J K
NewTaxExempt11L X
=11Y Z
command11[ b
.11b c
IsTaxExempt11c n
}11o p
)11p q
,11q r
$"22 
$str22 
{22 
ticket22 $
.22$ %
TicketNumber22% 1
}221 2
$str222 E
{22E F
command22F M
.22M N
IsTaxExempt22N Y
}22Y Z
"22Z [
,22[ \
correlationId33 !
:33! "
Guid33# '
.33' (
NewGuid33( /
(33/ 0
)330 1
)331 2
;332 3
await55 !
_auditEventRepository55 +
.55+ ,
AddAsync55, 4
(554 5

auditEvent555 ?
,55? @
cancellationToken55A R
)55R S
;55S T
}66 
return88 
new88 
SetTaxExemptResult88 )
{88* +
Success88, 3
=884 5
true886 :
}88; <
;88< =
}99 	
catch:: 
(:: 
	Exception:: 
ex:: 
):: 
{;; 	
return<< 
new<< 
SetTaxExemptResult<< )
{<<* +
Success<<, 3
=<<4 5
false<<6 ;
,<<; <
Error<<= B
=<<C D
ex<<E G
.<<G H
Message<<H O
}<<P Q
;<<Q R
}== 	
}>> 
}?? é)
ÖC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SetServiceChargeCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class *
SetServiceChargeCommandHandler +
:, -
ICommandHandler. =
<= >#
SetServiceChargeCommand> U
,U V"
SetServiceChargeResultW m
>m n
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
*
SetServiceChargeCommandHandler )
() *
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< "
SetServiceChargeResult ,
>, -
HandleAsync. 9
(9 :#
SetServiceChargeCommand 
command  '
,' (
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
return 
new "
SetServiceChargeResult -
{   
Success!! 
=!! 
false!! 
,!!  
ErrorMessage"" 
="" 
$""" !
$str""! (
{""( )
command"") 0
.""0 1
TicketId""1 9
}""9 :
$str"": E
"""E F
}## 
;## 
}$$ 	
var&& 
	oldAmount&& 
=&& 
ticket&& 
.&& 
ServiceChargeAmount&& 2
;&&2 3
try(( 
{)) 	
ticket** 
.** 
SetServiceCharge** #
(**# $
command**$ +
.**+ ,
Amount**, 2
)**2 3
;**3 4
await,, 
_ticketRepository,, #
.,,# $
UpdateAsync,,$ /
(,,/ 0
ticket,,0 6
,,,6 7
cancellationToken,,8 I
),,I J
;,,J K
var// 

auditEvent// 
=// 

AuditEvent// '
.//' (
Create//( .
(//. /
AuditEventType00 
.00 
Modified00 '
,00' (
nameof11 
(11 
Ticket11 
)11 
,11 
ticket22 
.22 
Id22 
,22 
command33 
.33 
ProcessedBy33 #
.33# $
Value33$ )
,33) *
System44 
.44 
Text44 
.44 
Json44  
.44  !
JsonSerializer44! /
.44/ 0
	Serialize440 9
(449 :
new44: =
{55 
Action66 
=66 
$str66 /
,66/ 0
	OldAmount77 
=77 
	oldAmount77  )
,77) *
	NewAmount88 
=88 
command88  '
.88' (
Amount88( .
}99 
)99 
,99 
$":: 
$str:: (
{::( )
command::) 0
.::0 1
Amount::1 7
}::7 8
$str::8 C
{::C D
ticket::D J
.::J K
TicketNumber::K W
}::W X
"::X Y
,::Y Z
correlationId;; 
:;; 
Guid;; #
.;;# $
NewGuid;;$ +
(;;+ ,
);;, -
);;- .
;;;. /
await== !
_auditEventRepository== '
.==' (
AddAsync==( 0
(==0 1

auditEvent==1 ;
,==; <
cancellationToken=== N
)==N O
;==O P
return?? 
new?? "
SetServiceChargeResult?? -
{@@ 
SuccessAA 
=AA 
trueAA 
,AA 
NewTotalAmountBB 
=BB  
ticketBB! '
.BB' (
TotalAmountBB( 3
}CC 
;CC 
}DD 	
catchEE 
(EE 
	ExceptionEE 
exEE 
)EE 
{FF 	
returnGG 
newGG "
SetServiceChargeResultGG -
{HH 
SuccessII 
=II 
falseII 
,II  
ErrorMessageJJ 
=JJ 
exJJ !
.JJ! "
MessageJJ" )
}KK 
;KK 
}LL 	
}MM 
}NN ö)
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SetDeliveryChargeCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class +
SetDeliveryChargeCommandHandler ,
:- .
ICommandHandler/ >
<> ?$
SetDeliveryChargeCommand? W
,W X#
SetDeliveryChargeResultY p
>p q
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
+
SetDeliveryChargeCommandHandler *
(* +
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< #
SetDeliveryChargeResult -
>- .
HandleAsync/ :
(: ;$
SetDeliveryChargeCommand  
command! (
,( )
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
return 
new #
SetDeliveryChargeResult .
{   
Success!! 
=!! 
false!! 
,!!  
ErrorMessage"" 
="" 
$""" !
$str""! (
{""( )
command"") 0
.""0 1
TicketId""1 9
}""9 :
$str"": E
"""E F
}## 
;## 
}$$ 	
var&& 
	oldAmount&& 
=&& 
ticket&& 
.&&  
DeliveryChargeAmount&& 3
;&&3 4
try(( 
{)) 	
ticket** 
.** 
SetDeliveryCharge** $
(**$ %
command**% ,
.**, -
Amount**- 3
)**3 4
;**4 5
await,, 
_ticketRepository,, #
.,,# $
UpdateAsync,,$ /
(,,/ 0
ticket,,0 6
,,,6 7
cancellationToken,,8 I
),,I J
;,,J K
var// 

auditEvent// 
=// 

AuditEvent// '
.//' (
Create//( .
(//. /
AuditEventType00 
.00 
Modified00 '
,00' (
nameof11 
(11 
Ticket11 
)11 
,11 
ticket22 
.22 
Id22 
,22 
command33 
.33 
ProcessedBy33 #
.33# $
Value33$ )
,33) *
System44 
.44 
Text44 
.44 
Json44  
.44  !
JsonSerializer44! /
.44/ 0
	Serialize440 9
(449 :
new44: =
{55 
Action66 
=66 
$str66 0
,660 1
	OldAmount77 
=77 
	oldAmount77  )
,77) *
	NewAmount88 
=88 
command88  '
.88' (
Amount88( .
}99 
)99 
,99 
$":: 
$str:: )
{::) *
command::* 1
.::1 2
Amount::2 8
}::8 9
$str::9 D
{::D E
ticket::E K
.::K L
TicketNumber::L X
}::X Y
"::Y Z
,::Z [
correlationId;; 
:;; 
Guid;; #
.;;# $
NewGuid;;$ +
(;;+ ,
);;, -
);;- .
;;;. /
await== !
_auditEventRepository== '
.==' (
AddAsync==( 0
(==0 1

auditEvent==1 ;
,==; <
cancellationToken=== N
)==N O
;==O P
return?? 
new?? #
SetDeliveryChargeResult?? .
{@@ 
SuccessAA 
=AA 
trueAA 
,AA 
NewTotalAmountBB 
=BB  
ticketBB! '
.BB' (
TotalAmountBB( 3
}CC 
;CC 
}DD 	
catchEE 
(EE 
	ExceptionEE 
exEE 
)EE 
{FF 	
returnGG 
newGG #
SetDeliveryChargeResultGG .
{HH 
SuccessII 
=II 
falseII 
,II  
ErrorMessageJJ 
=JJ 
exJJ !
.JJ! "
MessageJJ" )
}KK 
;KK 
}LL 	
}MM 
}NN ç
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SetCustomerCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
SetCustomerCommandHandler &
:' (
ICommandHandler) 8
<8 9
SetCustomerCommand9 K
,K L
SetCustomerResultM ^
>^ _
{ 
private		 
readonly		 
ITicketRepository		 &
_ticketRepository		' 8
;		8 9
public 
%
SetCustomerCommandHandler $
($ %
ITicketRepository% 6
ticketRepository7 G
)G H
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
} 
public 

async 
Task 
< 
SetCustomerResult '
>' (
HandleAsync) 4
(4 5
SetCustomerCommand5 G
commandH O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
return 
new 
SetCustomerResult (
{) *
Success+ 2
=3 4
false5 :
,: ;
ErrorMessage< H
=I J
$strK ^
}_ `
;` a
var 
	extraInfo 
= 
new 
{ 	
	GuestName 
= 
command 
.  
	GuestName  )
,) *
Phone 
= 
command 
. 
PhoneNumber '
,' (
	Timestamp 
= 
DateTime  
.  !
UtcNow! '
} 	
;	 

string!! 
jsonInfo!! 
=!! 
JsonSerializer!! (
.!!( )
	Serialize!!) 2
(!!2 3
	extraInfo!!3 <
)!!< =
;!!= >
ticket(( 
.(( 
SetCustomer(( 
((( 

customerId)) 
:)) 
null)) 
,)) 
address** 
:** 
null** 
,** 
	extraInfo++ 
:++ 
jsonInfo++ 
),, 	
;,,	 

await11 
_ticketRepository11 
.11  
UpdateAsync11  +
(11+ ,
ticket11, 2
,112 3
cancellationToken114 E
)11E F
;11F G
return33 
new33 
SetCustomerResult33 $
{33% &
Success33' .
=33/ 0
true331 5
}336 7
;337 8
}44 
}55 ì)
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SetAdvancePaymentCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class +
SetAdvancePaymentCommandHandler ,
:- .
ICommandHandler/ >
<> ?$
SetAdvancePaymentCommand? W
,W X#
SetAdvancePaymentResultY p
>p q
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
+
SetAdvancePaymentCommandHandler *
(* +
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< #
SetAdvancePaymentResult -
>- .
HandleAsync/ :
(: ;$
SetAdvancePaymentCommand  
command! (
,( )
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
return 
new #
SetAdvancePaymentResult .
{   
Success!! 
=!! 
false!! 
,!!  
ErrorMessage"" 
="" 
$""" !
$str""! (
{""( )
command"") 0
.""0 1
TicketId""1 9
}""9 :
$str"": E
"""E F
}## 
;## 
}$$ 	
var&& 
	oldAmount&& 
=&& 
ticket&& 
.&& 
AdvanceAmount&& ,
;&&, -
try(( 
{)) 	
ticket** 
.** 
SetAdvancePayment** $
(**$ %
command**% ,
.**, -
Amount**- 3
)**3 4
;**4 5
await,, 
_ticketRepository,, #
.,,# $
UpdateAsync,,$ /
(,,/ 0
ticket,,0 6
,,,6 7
cancellationToken,,8 I
),,I J
;,,J K
var// 

auditEvent// 
=// 

AuditEvent// '
.//' (
Create//( .
(//. /
AuditEventType00 
.00 
Modified00 '
,00' (
nameof11 
(11 
Ticket11 
)11 
,11 
ticket22 
.22 
Id22 
,22 
command33 
.33 
ProcessedBy33 #
.33# $
Value33$ )
,33) *
System44 
.44 
Text44 
.44 
Json44  
.44  !
JsonSerializer44! /
.44/ 0
	Serialize440 9
(449 :
new44: =
{55 
Action66 
=66 
$str66 0
,660 1
	OldAmount77 
=77 
	oldAmount77  )
,77) *
	NewAmount88 
=88 
command88  '
.88' (
Amount88( .
}99 
)99 
,99 
$":: 
$str:: )
{::) *
command::* 1
.::1 2
Amount::2 8
}::8 9
$str::9 D
{::D E
ticket::E K
.::K L
TicketNumber::L X
}::X Y
"::Y Z
,::Z [
correlationId;; 
:;; 
Guid;; #
.;;# $
NewGuid;;$ +
(;;+ ,
);;, -
);;- .
;;;. /
await== !
_auditEventRepository== '
.==' (
AddAsync==( 0
(==0 1

auditEvent==1 ;
,==; <
cancellationToken=== N
)==N O
;==O P
return?? 
new?? #
SetAdvancePaymentResult?? .
{@@ 
SuccessAA 
=AA 
trueAA 
,AA 
NewTotalAmountBB 
=BB  
ticketBB! '
.BB' (
TotalAmountBB( 3
}CC 
;CC 
}DD 	
catchEE 
(EE 
	ExceptionEE 
exEE 
)EE 
{FF 	
returnGG 
newGG #
SetAdvancePaymentResultGG .
{HH 
SuccessII 
=II 
falseII 
,II  
ErrorMessageJJ 
=JJ 
exJJ !
.JJ! "
MessageJJ" )
}KK 
;KK 
}LL 	
}MM 
}NN ﬁ*
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\SetAdjustmentCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class '
SetAdjustmentCommandHandler (
:) *
ICommandHandler+ :
<: ; 
SetAdjustmentCommand; O
,O P
SetAdjustmentResultQ d
>d e
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
'
SetAdjustmentCommandHandler &
(& '
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
SetAdjustmentResult )
>) *
HandleAsync+ 6
(6 7 
SetAdjustmentCommand 
command $
,$ %
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
return 
new 
SetAdjustmentResult *
{   
Success!! 
=!! 
false!! 
,!!  
ErrorMessage"" 
="" 
$""" !
$str""! (
{""( )
command"") 0
.""0 1
TicketId""1 9
}""9 :
$str"": E
"""E F
}## 
;## 
}$$ 	
var&& 
	oldAmount&& 
=&& 
ticket&& 
.&& 
AdjustmentAmount&& /
;&&/ 0
try(( 
{)) 	
ticket** 
.** 
SetAdjustment**  
(**  !
command**! (
.**( )
Amount**) /
)**/ 0
;**0 1
await,, 
_ticketRepository,, #
.,,# $
UpdateAsync,,$ /
(,,/ 0
ticket,,0 6
,,,6 7
cancellationToken,,8 I
),,I J
;,,J K
var// 

auditEvent// 
=// 

AuditEvent// '
.//' (
Create//( .
(//. /
AuditEventType00 
.00 
Modified00 '
,00' (
nameof11 
(11 
Ticket11 
)11 
,11 
ticket22 
.22 
Id22 
,22 
command33 
.33 
ProcessedBy33 #
.33# $
Value33$ )
,33) *
System44 
.44 
Text44 
.44 
Json44  
.44  !
JsonSerializer44! /
.44/ 0
	Serialize440 9
(449 :
new44: =
{55 
Action66 
=66 
$str66 ,
,66, -
	OldAmount77 
=77 
	oldAmount77  )
,77) *
	NewAmount88 
=88 
command88  '
.88' (
Amount88( .
,88. /
Reason99 
=99 
command99 $
.99$ %
Reason99% +
}:: 
):: 
,:: 
$";; 
$str;; $
{;;$ %
command;;% ,
.;;, -
Amount;;- 3
};;3 4
$str;;4 ?
{;;? @
ticket;;@ F
.;;F G
TicketNumber;;G S
};;S T
$str;;T ^
{;;^ _
command;;_ f
.;;f g
Reason;;g m
??;;n p
$str;;q v
};;v w
";;w x
,;;x y
correlationId<< 
:<< 
Guid<< #
.<<# $
NewGuid<<$ +
(<<+ ,
)<<, -
)<<- .
;<<. /
await>> !
_auditEventRepository>> '
.>>' (
AddAsync>>( 0
(>>0 1

auditEvent>>1 ;
,>>; <
cancellationToken>>= N
)>>N O
;>>O P
return@@ 
new@@ 
SetAdjustmentResult@@ *
{AA 
SuccessBB 
=BB 
trueBB 
,BB 
NewTotalAmountCC 
=CC  
ticketCC! '
.CC' (
TotalAmountCC( 3
}DD 
;DD 
}EE 	
catchFF 
(FF 
	ExceptionFF 
exFF 
)FF 
{GG 	
returnHH 
newHH 
SetAdjustmentResultHH *
{II 
SuccessJJ 
=JJ 
falseJJ 
,JJ  
ErrorMessageKK 
=KK 
exKK !
.KK! "
MessageKK" )
}LL 
;LL 
}MM 	
}NN 
}OO ¬o
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ServerSectionCommandHandlers.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public		 
class		 -
!CreateServerSectionCommandHandler		 .
:		/ 0
IRequestHandler		1 @
<		@ A&
CreateServerSectionCommand		A [
,		[ \
ServerSectionDto		] m
>		m n
{

 
private 
readonly $
IServerSectionRepository -$
_serverSectionRepository. F
;F G
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
public 
-
!CreateServerSectionCommandHandler ,
(, -$
IServerSectionRepository  #
serverSectionRepository! 8
,8 9
IUserRepository 
userRepository &
)& '
{ $
_serverSectionRepository  
=! "#
serverSectionRepository# :
;: ;
_userRepository 
= 
userRepository (
;( )
} 
public 

async 
Task 
< 
ServerSectionDto &
>& '
Handle( .
(. /&
CreateServerSectionCommand/ I
requestJ Q
,Q R
CancellationTokenS d
cancellationTokene v
)v w
{ 
var 
server 
= 
await 
_userRepository *
.* +
GetByIdAsync+ 7
(7 8
request8 ?
.? @
ServerId@ H
,H I
cancellationTokenJ [
)[ \
;\ ]
if 

( 
server 
== 
null 
) 
{ 	
throw 
new  
KeyNotFoundException *
(* +
$"+ -
$str- <
{< =
request= D
.D E
ServerIdE M
}M N
$strN Y
"Y Z
)Z [
;[ \
} 	
var   
section   
=   
ServerSection   #
.  # $
Create  $ *
(  * +
request!! 
.!! 
Name!! 
,!! 
request"" 
."" 
ServerId"" 
,"" 
request## 
.## 
Description## 
,##  
request$$ 
.$$ 
Color$$ 
)%% 	
;%%	 

await'' $
_serverSectionRepository'' &
.''& '
AddAsync''' /
(''/ 0
section''0 7
,''7 8
cancellationToken''9 J
)''J K
;''K L
return)) 
new)) 
ServerSectionDto)) #
{** 	
Id++ 
=++ 
section++ 
.++ 
Id++ 
,++ 
Name,, 
=,, 
section,, 
.,, 
Name,, 
,,,  
Description-- 
=-- 
section-- !
.--! "
Description--" -
,--- .
ServerId.. 
=.. 
section.. 
... 
ServerId.. '
,..' (

ServerName// 
=// 
$"// 
{// 
server// "
.//" #
	FirstName//# ,
}//, -
$str//- .
{//. /
server/// 5
.//5 6
LastName//6 >
}//> ?
"//? @
,//@ A
TableIds00 
=00 
section00 
.00 
TableIds00 '
,00' (

TableCount11 
=11 
section11  
.11  !

TableCount11! +
,11+ ,
Color22 
=22 
section22 
.22 
Color22 !
,22! "
IsActive33 
=33 
section33 
.33 
IsActive33 '
,33' (
	CreatedAt44 
=44 
section44 
.44  
	CreatedAt44  )
,44) *
	UpdatedAt55 
=55 
section55 
.55  
	UpdatedAt55  )
,55) *
Version66 
=66 
section66 
.66 
Version66 %
}77 	
;77	 

}88 
}99 
public;; 
class;; 5
)AssignTablesToServerSectionCommandHandler;; 6
:;;7 8
IRequestHandler;;9 H
<;;H I.
"AssignTablesToServerSectionCommand;;I k
,;;k l
ServerSectionDto;;m }
>;;} ~
{<< 
private== 
readonly== $
IServerSectionRepository== -$
_serverSectionRepository==. F
;==F G
private>> 
readonly>> 
ITableRepository>> %
_tableRepository>>& 6
;>>6 7
public@@ 
5
)AssignTablesToServerSectionCommandHandler@@ 4
(@@4 5$
IServerSectionRepositoryAA  #
serverSectionRepositoryAA! 8
,AA8 9
ITableRepositoryBB 
tableRepositoryBB (
)BB( )
{CC $
_serverSectionRepositoryDD  
=DD! "#
serverSectionRepositoryDD# :
;DD: ;
_tableRepositoryEE 
=EE 
tableRepositoryEE *
;EE* +
}FF 
publicHH 

asyncHH 
TaskHH 
<HH 
ServerSectionDtoHH &
>HH& '
HandleHH( .
(HH. /.
"AssignTablesToServerSectionCommandHH/ Q
requestHHR Y
,HHY Z
CancellationTokenHH[ l
cancellationTokenHHm ~
)HH~ 
{II 
varJJ 
sectionJJ 
=JJ 
awaitJJ $
_serverSectionRepositoryJJ 4
.JJ4 5
GetByIdAsyncJJ5 A
(JJA B
requestJJB I
.JJI J
	SectionIdJJJ S
,JJS T
cancellationTokenJJU f
)JJf g
;JJg h
ifKK 

(KK 
sectionKK 
==KK 
nullKK 
)KK 
{LL 	
throwMM 
newMM  
KeyNotFoundExceptionMM *
(MM* +
$"MM+ -
$strMM- D
{MMD E
requestMME L
.MML M
	SectionIdMMM V
}MMV W
$strMMW b
"MMb c
)MMc d
;MMd e
}NN 	
foreachQQ 
(QQ 
varQQ 
tableIdQQ 
inQQ 
requestQQ  '
.QQ' (
TableIdsQQ( 0
)QQ0 1
{RR 	
varSS 
tableSS 
=SS 
awaitSS 
_tableRepositorySS .
.SS. /
GetByIdAsyncSS/ ;
(SS; <
tableIdSS< C
,SSC D
cancellationTokenSSE V
)SSV W
;SSW X
ifTT 
(TT 
tableTT 
==TT 
nullTT 
)TT 
{UU 
throwVV 
newVV  
KeyNotFoundExceptionVV .
(VV. /
$"VV/ 1
$strVV1 ?
{VV? @
tableIdVV@ G
}VVG H
$strVVH S
"VVS T
)VVT U
;VVU V
}WW 
}XX 	
section[[ 
.[[ 
	AddTables[[ 
([[ 
request[[ !
.[[! "
TableIds[[" *
)[[* +
;[[+ ,
await\\ $
_serverSectionRepository\\ &
.\\& '
UpdateAsync\\' 2
(\\2 3
section\\3 :
,\\: ;
cancellationToken\\< M
)\\M N
;\\N O
var__ 
server__ 
=__ 
await__ $
_serverSectionRepository__ 3
.__3 4
GetServerByIdAsync__4 F
(__F G
section__G N
.__N O
ServerId__O W
,__W X
cancellationToken__Y j
)__j k
;__k l
returnaa 
newaa 
ServerSectionDtoaa #
{bb 	
Idcc 
=cc 
sectioncc 
.cc 
Idcc 
,cc 
Namedd 
=dd 
sectiondd 
.dd 
Namedd 
,dd  
Descriptionee 
=ee 
sectionee !
.ee! "
Descriptionee" -
,ee- .
ServerIdff 
=ff 
sectionff 
.ff 
ServerIdff '
,ff' (

ServerNamegg 
=gg 
servergg 
!=gg  "
nullgg# '
?gg( )
$"gg* ,
{gg, -
servergg- 3
.gg3 4
	FirstNamegg4 =
}gg= >
$strgg> ?
{gg? @
servergg@ F
.ggF G
LastNameggG O
}ggO P
"ggP Q
:ggR S
$strggT ]
,gg] ^
TableIdshh 
=hh 
sectionhh 
.hh 
TableIdshh '
,hh' (

TableCountii 
=ii 
sectionii  
.ii  !

TableCountii! +
,ii+ ,
Colorjj 
=jj 
sectionjj 
.jj 
Colorjj !
,jj! "
IsActivekk 
=kk 
sectionkk 
.kk 
IsActivekk '
,kk' (
	CreatedAtll 
=ll 
sectionll 
.ll  
	CreatedAtll  )
,ll) *
	UpdatedAtmm 
=mm 
sectionmm 
.mm  
	UpdatedAtmm  )
,mm) *
Versionnn 
=nn 
sectionnn 
.nn 
Versionnn %
}oo 	
;oo	 

}pp 
}qq 
publicss 
classss )
GetServerSectionsQueryHandlerss *
:ss+ ,
IRequestHandlerss- <
<ss< ="
GetServerSectionsQueryss= S
,ssS T
ListssU Y
<ssY Z
ServerSectionDtossZ j
>ssj k
>ssk l
{tt 
privateuu 
readonlyuu $
IServerSectionRepositoryuu -$
_serverSectionRepositoryuu. F
;uuF G
privatevv 
readonlyvv 
IUserRepositoryvv $
_userRepositoryvv% 4
;vv4 5
publicxx 
)
GetServerSectionsQueryHandlerxx (
(xx( )$
IServerSectionRepositoryyy  #
serverSectionRepositoryyy! 8
,yy8 9
IUserRepositoryzz 
userRepositoryzz &
)zz& '
{{{ $
_serverSectionRepository||  
=||! "#
serverSectionRepository||# :
;||: ;
_userRepository}} 
=}} 
userRepository}} (
;}}( )
}~~ 
public
ÄÄ 

async
ÄÄ 
Task
ÄÄ 
<
ÄÄ 
List
ÄÄ 
<
ÄÄ 
ServerSectionDto
ÄÄ +
>
ÄÄ+ ,
>
ÄÄ, -
Handle
ÄÄ. 4
(
ÄÄ4 5$
GetServerSectionsQuery
ÄÄ5 K
request
ÄÄL S
,
ÄÄS T
CancellationToken
ÄÄU f
cancellationToken
ÄÄg x
)
ÄÄx y
{
ÅÅ 
var
ÇÇ 
sections
ÇÇ 
=
ÇÇ 
await
ÇÇ &
_serverSectionRepository
ÇÇ 5
.
ÇÇ5 6
GetSectionsAsync
ÇÇ6 F
(
ÇÇF G
request
ÇÇG N
.
ÇÇN O
ServerId
ÇÇO W
,
ÇÇW X
request
ÇÇY `
.
ÇÇ` a
IncludeInactive
ÇÇa p
,
ÇÇp q 
cancellationTokenÇÇr É
)ÇÇÉ Ñ
;ÇÇÑ Ö
var
ÑÑ 
result
ÑÑ 
=
ÑÑ 
new
ÑÑ 
List
ÑÑ 
<
ÑÑ 
ServerSectionDto
ÑÑ .
>
ÑÑ. /
(
ÑÑ/ 0
)
ÑÑ0 1
;
ÑÑ1 2
foreach
ÖÖ 
(
ÖÖ 
var
ÖÖ 
section
ÖÖ 
in
ÖÖ 
sections
ÖÖ  (
)
ÖÖ( )
{
ÜÜ 	
var
áá 
server
áá 
=
áá 
await
áá 
_userRepository
áá .
.
áá. /
GetByIdAsync
áá/ ;
(
áá; <
section
áá< C
.
ááC D
ServerId
ááD L
,
ááL M
cancellationToken
ááN _
)
áá_ `
;
áá` a
result
ââ 
.
ââ 
Add
ââ 
(
ââ 
new
ââ 
ServerSectionDto
ââ +
{
ää 
Id
ãã 
=
ãã 
section
ãã 
.
ãã 
Id
ãã 
,
ãã  
Name
åå 
=
åå 
section
åå 
.
åå 
Name
åå #
,
åå# $
Description
çç 
=
çç 
section
çç %
.
çç% &
Description
çç& 1
,
çç1 2
ServerId
éé 
=
éé 
section
éé "
.
éé" #
ServerId
éé# +
,
éé+ ,

ServerName
èè 
=
èè 
server
èè #
!=
èè$ &
null
èè' +
?
èè, -
$"
èè. 0
{
èè0 1
server
èè1 7
.
èè7 8
	FirstName
èè8 A
}
èèA B
$str
èèB C
{
èèC D
server
èèD J
.
èèJ K
LastName
èèK S
}
èèS T
"
èèT U
:
èèV W
$str
èèX a
,
èèa b
TableIds
êê 
=
êê 
section
êê "
.
êê" #
TableIds
êê# +
,
êê+ ,

TableCount
ëë 
=
ëë 
section
ëë $
.
ëë$ %

TableCount
ëë% /
,
ëë/ 0
Color
íí 
=
íí 
section
íí 
.
íí  
Color
íí  %
,
íí% &
IsActive
ìì 
=
ìì 
section
ìì "
.
ìì" #
IsActive
ìì# +
,
ìì+ ,
	CreatedAt
îî 
=
îî 
section
îî #
.
îî# $
	CreatedAt
îî$ -
,
îî- .
	UpdatedAt
ïï 
=
ïï 
section
ïï #
.
ïï# $
	UpdatedAt
ïï$ -
,
ïï- .
Version
ññ 
=
ññ 
section
ññ !
.
ññ! "
Version
ññ" )
}
óó 
)
óó 
;
óó 
}
òò 	
return
öö 
result
öö 
;
öö 
}
õõ 
}úú Ω
áC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetTipReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class $
GetTipReportQueryHandler %
:& '
IQueryHandler( 5
<5 6
GetTipReportQuery6 G
,G H
TipReportDtoI U
>U V
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_reportRepository		, =
;		= >
public 
$
GetTipReportQueryHandler #
(# $"
ISalesReportRepository$ :
reportRepository; K
)K L
{ 
_reportRepository 
= 
reportRepository ,
;, -
} 
public 

async 
Task 
< 
TipReportDto "
>" #
HandleAsync$ /
(/ 0
GetTipReportQuery0 A
queryB G
,G H
CancellationTokenI Z
cancellationToken[ l
=m n
defaulto v
)v w
{ 
return 
await 
_reportRepository &
.& '
GetTipReportAsync' 8
(8 9
query9 >
.> ?
	StartDate? H
,H I
queryJ O
.O P
EndDateP W
,W X
queryY ^
.^ _
UserIdFilter_ k
,k l
cancellationTokenm ~
)~ 
;	 Ä
} 
} ◊
ñC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetServerProductivityReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class 3
'GetServerProductivityReportQueryHandler 4
:5 6
IQueryHandler7 D
<D E,
 GetServerProductivityReportQueryE e
,e f(
ServerProductivityReportDto	g Ç
>
Ç É
{ 
private		 
readonly		 "
ISalesReportRepository		 +"
_salesReportRepository		, B
;		B C
public 
3
'GetServerProductivityReportQueryHandler 2
(2 3"
ISalesReportRepository3 I!
salesReportRepositoryJ _
)_ `
{ "
_salesReportRepository 
=  !
salesReportRepository! 6
;6 7
} 
public 

async 
Task 
< '
ServerProductivityReportDto 1
>1 2
HandleAsync3 >
(> ?,
 GetServerProductivityReportQuery? _
query` e
,e f
CancellationTokeng x
cancellationToken	y ä
=
ã å
default
ç î
)
î ï
{ 
return 
await "
_salesReportRepository +
.+ ,,
 GetServerProductivityReportAsync, L
(L M
query 
. 
	StartDate 
, 
query 
. 
EndDate 
, 
query 
. 
UserIdFilter 
, 
cancellationToken 
) 
; 
} 
} ∆
äC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetSalesSummaryQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class '
GetSalesSummaryQueryHandler (
:) *
IQueryHandler+ 8
<8 9 
GetSalesSummaryQuery9 M
,M N!
SalesSummaryReportDtoO d
>d e
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_repository		, 7
;		7 8
public 
'
GetSalesSummaryQueryHandler &
(& '"
ISalesReportRepository' =

repository> H
)H I
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< !
SalesSummaryReportDto +
>+ ,
HandleAsync- 8
(8 9 
GetSalesSummaryQuery9 M
queryN S
,S T
CancellationTokenU f
cancellationTokeng x
=y z
default	{ Ç
)
Ç É
{ 
return 
await 
_repository  
.  ! 
GetSalesSummaryAsync! 5
(5 6
query6 ;
.; <
	StartDate< E
,E F
queryG L
.L M
EndDateM T
,T U
queryV [
.[ \
IncludeGroups\ i
,i j
cancellationTokenk |
)| }
;} ~
} 
} â
âC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetSalesDetailQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class &
GetSalesDetailQueryHandler '
:( )
IQueryHandler* 7
<7 8
GetSalesDetailQuery8 K
,K L 
SalesDetailReportDtoM a
>a b
{ 
private 
readonly "
ISalesReportRepository +"
_salesReportRepository, B
;B C
public

 
&
GetSalesDetailQueryHandler

 %
(

% &"
ISalesReportRepository

& <!
salesReportRepository

= R
)

R S
{ "
_salesReportRepository 
=  !
salesReportRepository! 6
;6 7
} 
public 

async 
Task 
<  
SalesDetailReportDto *
>* +
HandleAsync, 7
(7 8
GetSalesDetailQuery8 K
queryL Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
return 
await "
_salesReportRepository +
.+ ,
GetSalesDetailAsync, ?
(? @
query 
. 
	StartDate 
, 
query 
. 
EndDate 
, 
query 
. 
CategoryFilter  
,  !
query 
. 
GroupFilter 
, 
query 
. 

ItemFilter 
, 
cancellationToken 
) 
; 
} 
} ˙
äC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetSalesBalanceQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class '
GetSalesBalanceQueryHandler (
:) *
IQueryHandler+ 8
<8 9 
GetSalesBalanceQuery9 M
,M N!
SalesBalanceReportDtoO d
>d e
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_repository		, 7
;		7 8
public 
'
GetSalesBalanceQueryHandler &
(& '"
ISalesReportRepository' =

repository> H
)H I
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< !
SalesBalanceReportDto +
>+ ,
HandleAsync- 8
(8 9 
GetSalesBalanceQuery9 M
queryN S
,S T
CancellationTokenU f
cancellationTokeng x
=y z
default	{ Ç
)
Ç É
{ 
return 
await 
_repository  
.  ! 
GetSalesBalanceAsync! 5
(5 6
query6 ;
.; <
	StartDate< E
,E F
queryG L
.L M
EndDateM T
,T U
cancellationTokenV g
)g h
;h i
} 
} Â
êC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetProductivityReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class -
!GetProductivityReportQueryHandler .
:/ 0
IQueryHandler1 >
<> ?&
GetProductivityReportQuery? Y
,Y Z!
ProductivityReportDto[ p
>p q
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_repository		, 7
;		7 8
public 
-
!GetProductivityReportQueryHandler ,
(, -"
ISalesReportRepository- C

repositoryD N
)N O
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< !
ProductivityReportDto +
>+ ,
HandleAsync- 8
(8 9&
GetProductivityReportQuery9 S
queryT Y
,Y Z
CancellationToken[ l
cancellationTokenm ~
=	 Ä
default
Å à
)
à â
{ 
return 
await 
_repository  
.  !&
GetServerProductivityAsync! ;
(; <
query< A
.A B
	StartDateB K
,K L
queryM R
.R S
EndDateS Z
,Z [
query\ a
.a b
UserIdb h
,h i
cancellationTokenj {
){ |
;| }
} 
} ˜
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetPaymentReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class (
GetPaymentReportQueryHandler )
:* +
IQueryHandler, 9
<9 :!
GetPaymentReportQuery: O
,O P
PaymentReportDtoQ a
>a b
{ 
private		 
readonly		 "
ISalesReportRepository		 +"
_salesReportRepository		, B
;		B C
public 
(
GetPaymentReportQueryHandler '
(' ("
ISalesReportRepository( >!
salesReportRepository? T
)T U
{ "
_salesReportRepository 
=  !
salesReportRepository! 6
;6 7
} 
public 

async 
Task 
< 
PaymentReportDto &
>& '
HandleAsync( 3
(3 4!
GetPaymentReportQuery4 I
queryJ O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
return 
await "
_salesReportRepository +
.+ ,!
GetPaymentReportAsync, A
(A B
query 
. 
	StartDate 
, 
query 
. 
EndDate 
, 
query 
. 
TerminalFilter  
,  !
cancellationToken 
) 
; 
} 
} ÿ
çC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetMenuUsageReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class *
GetMenuUsageReportQueryHandler +
:, -
IQueryHandler. ;
<; <#
GetMenuUsageReportQuery< S
,S T
MenuUsageReportDtoU g
>g h
{ 
private		 
readonly		 "
ISalesReportRepository		 +"
_salesReportRepository		, B
;		B C
public 
*
GetMenuUsageReportQueryHandler )
() *"
ISalesReportRepository* @!
salesReportRepositoryA V
)V W
{ "
_salesReportRepository 
=  !
salesReportRepository! 6
;6 7
} 
public 

async 
Task 
< 
MenuUsageReportDto (
>( )
HandleAsync* 5
(5 6#
GetMenuUsageReportQuery6 M
queryN S
,S T
CancellationTokenU f
cancellationTokeng x
=y z
default	{ Ç
)
Ç É
{ 
return 
await "
_salesReportRepository +
.+ ,#
GetMenuUsageReportAsync, C
(C D
query 
. 
	StartDate 
, 
query 
. 
EndDate 
, 
query 
. 
CategoryFilter  
,  !
query 
. 
OrderTypeFilter !
,! "
cancellationToken 
) 
; 
} 
} „
âC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetLaborReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class &
GetLaborReportQueryHandler '
:( )
IQueryHandler* 7
<7 8
GetLaborReportQuery8 K
,K L
LaborReportDtoM [
>[ \
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_repository		, 7
;		7 8
public 
&
GetLaborReportQueryHandler %
(% &"
ISalesReportRepository& <

repository= G
)G H
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< 
LaborReportDto $
>$ %
HandleAsync& 1
(1 2
GetLaborReportQuery2 E
queryF K
,K L
CancellationTokenM ^
cancellationToken_ p
=q r
defaults z
)z {
{ 
return 
await 
_repository  
.  !
GetLaborReportAsync! 4
(4 5
query5 :
.: ;
	StartDate; D
,D E
queryF K
.K L
EndDateL S
,S T
cancellationTokenU f
)f g
;g h
} 
} Ü
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetJournalReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class (
GetJournalReportQueryHandler )
:* +
IQueryHandler, 9
<9 :!
GetJournalReportQuery: O
,O P
JournalReportDtoQ a
>a b
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_repository		, 7
;		7 8
public 
(
GetJournalReportQueryHandler '
(' ("
ISalesReportRepository( >

repository? I
)I J
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< 
JournalReportDto &
>& '
HandleAsync( 3
(3 4!
GetJournalReportQuery4 I
queryJ O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
return 
await 
_repository  
.  !!
GetJournalReportAsync! 6
(6 7
query7 <
.< =
	StartDate= F
,F G
queryH M
.M N
EndDateN U
,U V
queryW \
.\ ]

EntityType] g
,g h
queryi n
.n o
UserIdo u
,u v
cancellationToken	w à
)
à â
;
â ä
} 
} ú
èC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetHourlyLaborReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class ,
 GetHourlyLaborReportQueryHandler -
:. /
IQueryHandler0 =
<= >%
GetHourlyLaborReportQuery> W
,W X 
HourlyLaborReportDtoY m
>m n
{ 
private		 
readonly		 "
ISalesReportRepository		 +"
_salesReportRepository		, B
;		B C
public 
,
 GetHourlyLaborReportQueryHandler +
(+ ,"
ISalesReportRepository, B!
salesReportRepositoryC X
)X Y
{ "
_salesReportRepository 
=  !
salesReportRepository! 6
;6 7
} 
public 

async 
Task 
<  
HourlyLaborReportDto *
>* +
HandleAsync, 7
(7 8%
GetHourlyLaborReportQuery8 Q
queryR W
,W X
CancellationTokenY j
cancellationTokenk |
=} ~
default	 Ü
)
Ü á
{ 
return 
await "
_salesReportRepository +
.+ ,%
GetHourlyLaborReportAsync, E
(E F
query 
. 
	StartDate 
, 
query 
. 
EndDate 
, 
query 
. 
EmployeeIdFilter "
," #
cancellationToken 
) 
; 
} 
} é
éC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetExceptionsReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class +
GetExceptionsReportQueryHandler ,
:- .
IQueryHandler/ <
<< =$
GetExceptionsReportQuery= U
,U V
ExceptionsReportDtoW j
>j k
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_repository		, 7
;		7 8
public 
+
GetExceptionsReportQueryHandler *
(* +"
ISalesReportRepository+ A

repositoryB L
)L M
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< 
ExceptionsReportDto )
>) *
HandleAsync+ 6
(6 7$
GetExceptionsReportQuery7 O
queryP U
,U V
CancellationTokenW h
cancellationTokeni z
={ |
default	} Ñ
)
Ñ Ö
{ 
return 
await 
_repository  
.  !$
GetExceptionsReportAsync! 9
(9 :
query: ?
.? @
	StartDate@ I
,I J
queryK P
.P Q
EndDateQ X
,X Y
cancellationTokenZ k
)k l
;l m
} 
} ˛
åC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetDeliveryReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class )
GetDeliveryReportQueryHandler *
:+ ,
IQueryHandler- :
<: ;"
GetDeliveryReportQuery; Q
,Q R
DeliveryReportDtoS d
>d e
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_repository		, 7
;		7 8
public 
)
GetDeliveryReportQueryHandler (
(( )"
ISalesReportRepository) ?

repository@ J
)J K
{ 
_repository 
= 

repository  
;  !
} 
public 

async 
Task 
< 
DeliveryReportDto '
>' (
HandleAsync) 4
(4 5"
GetDeliveryReportQuery5 K
queryL Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
return 
await 
_repository  
.  !"
GetDeliveryReportAsync! 7
(7 8
query8 =
.= >
	StartDate> G
,G H
queryI N
.N O
EndDateO V
,V W
cancellationTokenX i
)i j
;j k
} 
} Ê
éC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetCreditCardReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class +
GetCreditCardReportQueryHandler ,
:- .
IQueryHandler/ <
<< =$
GetCreditCardReportQuery= U
,U V
CreditCardReportDtoW j
>j k
{ 
private		 
readonly		 "
ISalesReportRepository		 +"
_salesReportRepository		, B
;		B C
public 
+
GetCreditCardReportQueryHandler *
(* +"
ISalesReportRepository+ A!
salesReportRepositoryB W
)W X
{ "
_salesReportRepository 
=  !
salesReportRepository! 6
;6 7
} 
public 

async 
Task 
< 
CreditCardReportDto )
>) *
HandleAsync+ 6
(6 7$
GetCreditCardReportQuery7 O
queryP U
,U V
CancellationTokenW h
cancellationTokeni z
={ |
default	} Ñ
)
Ñ Ö
{ 
return 
await "
_salesReportRepository +
.+ ,$
GetCreditCardReportAsync, D
(D E
query 
. 
	StartDate 
, 
query 
. 
EndDate 
, 
query 
. 
CardTypeFilter  
,  !
query 
. !
TransactionTypeFilter '
,' (
cancellationToken 
) 
; 
} 
} Ω
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetCashOutReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class (
GetCashOutReportQueryHandler )
:* +
IQueryHandler, 9
<9 :!
GetCashOutReportQuery: O
,O P
CashOutReportDtoQ a
>a b
{ 
private		 
readonly		 "
ISalesReportRepository		 +
_reportRepository		, =
;		= >
public 
(
GetCashOutReportQueryHandler '
(' ("
ISalesReportRepository( >
reportRepository? O
)O P
{ 
_reportRepository 
= 
reportRepository ,
;, -
} 
public 

async 
Task 
< 
CashOutReportDto &
>& '
HandleAsync( 3
(3 4!
GetCashOutReportQuery4 I
queryJ O
,O P
CancellationTokenQ b
cancellationTokenc t
)t u
{ 
return 
await 
_reportRepository &
.& '!
GetCashOutReportAsync' <
(< =
query= B
.B C
	StartDateC L
,L M
queryN S
.S T
EndDateT [
,[ \
query] b
.b c
UserIdFilterc o
,o p
cancellationToken	q Ç
)
Ç É
;
É Ñ
} 
} ’
éC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Reports\GetAttendanceReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
.' (
Reports( /
;/ 0
public 
class +
GetAttendanceReportQueryHandler ,
:- .
IQueryHandler/ <
<< =$
GetAttendanceReportQuery= U
,U V
AttendanceReportDtoW j
>j k
{		 
private

 
readonly

 "
ISalesReportRepository

 +
_reportRepository

, =
;

= >
public 
+
GetAttendanceReportQueryHandler *
(* +"
ISalesReportRepository+ A
reportRepositoryB R
)R S
{ 
_reportRepository 
= 
reportRepository ,
;, -
} 
public 

async 
Task 
< 
AttendanceReportDto )
>) *
HandleAsync+ 6
(6 7$
GetAttendanceReportQuery7 O
queryP U
,U V
CancellationTokenW h
cancellationTokeni z
)z {
{ 
return 
await 
_reportRepository &
.& '$
GetAttendanceReportAsync' ?
(? @
query@ E
.E F
	StartDateF O
,O P
queryQ V
.V W
EndDateW ^
,^ _
query` e
.e f
UserIdFilterf r
,r s
cancellationToken	t Ö
)
Ö Ü
;
Ü á
} 
} Â 
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\RemoveOrderLineCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class )
RemoveOrderLineCommandHandler *
:+ ,
ICommandHandler- <
<< ="
RemoveOrderLineCommand= S
>S T
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
)
RemoveOrderLineCommandHandler (
(( )
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! ""
RemoveOrderLineCommand" 8
command9 @
,@ A
CancellationTokenB S
cancellationTokenT e
=f g
defaulth o
)o p
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI P
{P Q
commandQ X
.X Y
TicketIdY a
}a b
$strb m
"m n
)n o
;o p
} 	
ticket"" 
."" 
RemoveOrderLine"" 
("" 
command"" &
.""& '
OrderLineId""' 2
)""2 3
;""3 4
await%% 
_ticketRepository%% 
.%%  
UpdateAsync%%  +
(%%+ ,
ticket%%, 2
,%%2 3
cancellationToken%%4 E
)%%E F
;%%F G
var(( 
correlationId(( 
=(( 
Guid((  
.((  !
NewGuid((! (
(((( )
)(() *
;((* +
var)) 

auditEvent)) 
=)) 

AuditEvent)) #
.))# $
Create))$ *
())* +
AuditEventType** 
.** 
Modified** #
,**# $
nameof++ 
(++ 
Domain++ 
.++ 
Entities++ "
.++" #
Ticket++# )
)++) *
,++* +
ticket,, 
.,, 
Id,, 
,,, 
Guid-- 
.-- 
Empty-- 
,-- 
System.. 
... 
Text.. 
... 
Json.. 
... 
JsonSerializer.. +
...+ ,
	Serialize.., 5
(..5 6
new..6 9
{..: ;
OrderLineId..< G
=..H I
command..J Q
...Q R
OrderLineId..R ]
,..] ^
Action.._ e
=..f g
$str..h q
}..r s
)..s t
,..t u
$"// 
$str// -
{//- .
ticket//. 4
.//4 5
TicketNumber//5 A
}//A B
"//B C
,//C D
correlationId00 
:00 
correlationId00 (
)00( )
;00) *
await22 !
_auditEventRepository22 #
.22# $
AddAsync22$ ,
(22, -

auditEvent22- 7
,227 8
cancellationToken229 J
)22J K
;22K L
}33 
}44 é#
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ReleaseTableCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class &
ReleaseTableCommandHandler '
:( )
ICommandHandler* 9
<9 :
ReleaseTableCommand: M
,M N
ReleaseTableResultO a
>a b
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
&
ReleaseTableCommandHandler %
(% &
ITableRepository 
tableRepository (
,( )!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_tableRepository 
= 
tableRepository *
;* +!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
ReleaseTableResult (
>( )
HandleAsync* 5
(5 6
ReleaseTableCommand6 I
commandJ Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
var 
table 
= 
await 
_tableRepository *
.* +
GetByIdAsync+ 7
(7 8
command8 ?
.? @
TableId@ G
,G H
cancellationTokenI Z
)Z [
;[ \
if 

( 
table 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI O
{O P
commandP W
.W X
TableIdX _
}_ `
$str` k
"k l
)l m
;m n
} 	
table"" 
."" 
ReleaseTicket"" 
("" 
)"" 
;"" 
await%% 
_tableRepository%% 
.%% 
UpdateAsync%% *
(%%* +
table%%+ 0
,%%0 1
cancellationToken%%2 C
)%%C D
;%%D E
var(( 
correlationId(( 
=(( 
Guid((  
.((  !
NewGuid((! (
(((( )
)(() *
;((* +
var)) 

auditEvent)) 
=)) 

AuditEvent)) #
.))# $
Create))$ *
())* +
AuditEventType** 
.** 
Modified** #
,**# $
nameof++ 
(++ 
Table++ 
)++ 
,++ 
table,, 
.,, 
Id,, 
,,, 
Guid-- 
.-- 
Empty-- 
,-- 
System.. 
... 
Text.. 
... 
Json.. 
... 
JsonSerializer.. +
...+ ,
	Serialize.., 5
(..5 6
new..6 9
{// 
TableId00 
=00 
table00 
.00  
Id00  "
,00" #
TableNumber11 
=11 
table11 #
.11# $
TableNumber11$ /
,11/ 0
Status22 
=22 
table22 
.22 
Status22 %
}33 
)33 
,33 
$"44 
$str44 
{44 
table44 
.44 
TableNumber44 &
}44& '
$str44' 0
"440 1
,441 2
correlationId55 
:55 
correlationId55 (
)55( )
;55) *
await77 !
_auditEventRepository77 #
.77# $
AddAsync77$ ,
(77, -

auditEvent77- 7
,777 8
cancellationToken779 J
)77J K
;77K L
return99 
new99 
ReleaseTableResult99 %
{:: 	
TableId;; 
=;; 
table;; 
.;; 
Id;; 
}<< 	
;<<	 

}== 
}>> ∫c
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\RefundTicketCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class &
RefundTicketCommandHandler '
:( )
ICommandHandler* 9
<9 :
RefundTicketCommand: M
,M N
RefundTicketResultO a
>a b
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly 
IPaymentGateway $
_paymentGateway% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
Domain 
. 
DomainServices *
.* + 
PaymentDomainService+ ?!
_paymentDomainService@ U
;U V
private 
readonly 
Domain 
. 
DomainServices *
.* +
TicketDomainService+ > 
_ticketDomainService? S
;S T
public 
&
RefundTicketCommandHandler %
(% &
ITicketRepository 
ticketRepository *
,* +
IPaymentRepository 
paymentRepository ,
,, -
IPaymentGateway 
paymentGateway &
,& '!
IAuditEventRepository  
auditEventRepository 2
,2 3
Domain 
. 
DomainServices 
.  
PaymentDomainService 2 
paymentDomainService3 G
,G H
Domain 
. 
DomainServices 
. 
TicketDomainService 1
ticketDomainService2 E
)E F
{ 
_ticketRepository   
=   
ticketRepository   ,
;  , -
_paymentRepository!! 
=!! 
paymentRepository!! .
;!!. /
_paymentGateway"" 
="" 
paymentGateway"" (
;""( )!
_auditEventRepository## 
=##  
auditEventRepository##  4
;##4 5!
_paymentDomainService$$ 
=$$  
paymentDomainService$$  4
;$$4 5 
_ticketDomainService%% 
=%% 
ticketDomainService%% 2
;%%2 3
}&& 
public(( 

async(( 
Task(( 
<(( 
RefundTicketResult(( (
>((( )
HandleAsync((* 5
(((5 6
RefundTicketCommand)) 
command)) #
,))# $
CancellationToken** 
cancellationToken** +
=**, -
default**. 5
)**5 6
{++ 
var-- 
ticket-- 
=-- 
await-- 
_ticketRepository-- ,
.--, -
GetByIdAsync--- 9
(--9 :
command--: A
.--A B
TicketId--B J
,--J K
cancellationToken--L ]
)--] ^
;--^ _
if.. 

(.. 
ticket.. 
==.. 
null.. 
).. 
{// 	
return00 
new00 
RefundTicketResult00 )
{11 
Success22 
=22 
false22 
,22  
ErrorMessage33 
=33 
$"33 !
$str33! (
{33( )
command33) 0
.330 1
TicketId331 9
}339 :
$str33: E
"33E F
}44 
;44 
}55 	
if88 

(88 
!88  
_ticketDomainService88 !
.88! "
CanRefundTicket88" 1
(881 2
ticket882 8
,888 9
ticket88: @
.88@ A

PaidAmount88A K
)88K L
)88L M
{99 	
return:: 
new:: 
RefundTicketResult:: )
{;; 
Success<< 
=<< 
false<< 
,<<  
ErrorMessage== 
=== 
$"== !
$str==! (
{==( )
ticket==) /
.==/ 0
TicketNumber==0 <
}==< =
$str=== Q
"==Q R
}>> 
;>> 
}?? 	
intAA !
refundPaymentsCreatedAA !
=AA" #
$numAA$ %
;AA% &
foreachDD 
(DD 
varDD 
paymentDD 
inDD 
ticketDD  &
.DD& '
PaymentsDD' /
.EE 
WhereEE 
(EE 
pEE 
=>EE  
!EE! "
pEE" #
.EE# $
IsVoidedEE$ ,
&&EE- /
pEE0 1
.EE1 2
TransactionTypeEE2 A
==EEB D
TransactionTypeEEE T
.EET U
CreditEEU [
)EE[ \
.FF 
ToListFF 
(FF 
)FF 
)FF 
{GG 	
ifII 
(II 
!II !
_paymentDomainServiceII &
.II& '
CanRefundPaymentII' 7
(II7 8
paymentII8 ?
,II? @
paymentIIA H
.IIH I
AmountIII O
)IIO P
)IIP Q
{JJ 
continueKK 
;KK 
}LL 
ifOO 
(OO 
paymentOO 
isOO 
CreditCardPaymentOO ,
creditCardPaymentOO- >
)OO> ?
{PP 
varQQ 
gatewayResultQQ !
=QQ" #
awaitQQ$ )
_paymentGatewayQQ* 9
.QQ9 :
RefundAsyncQQ: E
(QQE F
creditCardPaymentRR %
,RR% &
paymentSS 
.SS 
AmountSS "
,SS" #
cancellationTokenTT %
)TT% &
;TT& '
ifVV 
(VV 
!VV 
gatewayResultVV "
.VV" #
SuccessVV# *
)VV* +
{WW 
varYY 

auditEventYY "
=YY# $

AuditEventYY% /
.YY/ 0
CreateYY0 6
(YY6 7
AuditEventTypeZZ &
.ZZ& '
RefundProcessedZZ' 6
,ZZ6 7
nameof[[ 
([[ 
Payment[[ &
)[[& '
,[[' (
payment\\ 
.\\  
Id\\  "
,\\" #
command]] 
.]]  
ProcessedBy]]  +
.]]+ ,
Value]], 1
,]]1 2
System^^ 
.^^ 
Text^^ #
.^^# $
Json^^$ (
.^^( )
JsonSerializer^^) 7
.^^7 8
	Serialize^^8 A
(^^A B
new^^B E
{^^F G
Action__ "
=__# $
$str__% -
,__- .
Success`` #
=``$ %
false``& +
,``+ ,
Erroraa !
=aa" #
gatewayResultaa$ 1
.aa1 2
ErrorMessageaa2 >
}bb 
)bb 
,bb 
$"cc 
$strcc 6
{cc6 7
gatewayResultcc7 D
.ccD E
ErrorMessageccE Q
}ccQ R
"ccR S
,ccS T
correlationIddd %
:dd% &
Guiddd' +
.dd+ ,
NewGuiddd, 3
(dd3 4
)dd4 5
)dd5 6
;dd6 7
awaitff !
_auditEventRepositoryff /
.ff/ 0
AddAsyncff0 8
(ff8 9

auditEventff9 C
,ffC D
cancellationTokenffE V
)ffV W
;ffW X
continuegg 
;gg 
}hh 
}ii 
varll 
refundPaymentll 
=ll 
Paymentll  '
.ll' (
CreateRefundll( 4
(ll4 5
paymentmm 
,mm 
paymentnn 
.nn 
Amountnn 
,nn 
commandoo 
.oo 
ProcessedByoo #
,oo# $
commandpp 
.pp 

TerminalIdpp "
,pp" #
commandqq 
.qq 
Reasonqq 
)qq 
;qq  
awaittt 
_paymentRepositorytt $
.tt$ %
AddAsynctt% -
(tt- .
refundPaymenttt. ;
,tt; <
cancellationTokentt= N
)ttN O
;ttO P!
refundPaymentsCreateduu !
++uu! #
;uu# $
ticketxx 
.xx 
ProcessRefundxx  
(xx  !
refundPaymentxx! .
)xx. /
;xx/ 0
var{{ 
successAuditEvent{{ !
={{" #

AuditEvent{{$ .
.{{. /
Create{{/ 5
({{5 6
AuditEventType|| 
.|| 
RefundProcessed|| .
,||. /
nameof}} 
(}} 
Payment}} 
)}} 
,}}  
refundPayment~~ 
.~~ 
Id~~  
,~~  !
command 
. 
ProcessedBy #
.# $
Value$ )
,) *
System
ÄÄ 
.
ÄÄ 
Text
ÄÄ 
.
ÄÄ 
Json
ÄÄ  
.
ÄÄ  !
JsonSerializer
ÄÄ! /
.
ÄÄ/ 0
	Serialize
ÄÄ0 9
(
ÄÄ9 :
new
ÄÄ: =
{
ÄÄ> ?
Action
ÅÅ 
=
ÅÅ 
$str
ÅÅ %
,
ÅÅ% &
Success
ÇÇ 
=
ÇÇ 
true
ÇÇ "
,
ÇÇ" #
OriginalPaymentId
ÉÉ %
=
ÉÉ& '
payment
ÉÉ( /
.
ÉÉ/ 0
Id
ÉÉ0 2
,
ÉÉ2 3
RefundAmount
ÑÑ  
=
ÑÑ! "
payment
ÑÑ# *
.
ÑÑ* +
Amount
ÑÑ+ 1
}
ÖÖ 
)
ÖÖ 
,
ÖÖ 
$"
ÜÜ 
$str
ÜÜ $
{
ÜÜ$ %
payment
ÜÜ% ,
.
ÜÜ, -
Amount
ÜÜ- 3
}
ÜÜ3 4
"
ÜÜ4 5
,
ÜÜ5 6
correlationId
áá 
:
áá 
Guid
áá #
.
áá# $
NewGuid
áá$ +
(
áá+ ,
)
áá, -
)
áá- .
;
áá. /
await
ââ #
_auditEventRepository
ââ '
.
ââ' (
AddAsync
ââ( 0
(
ââ0 1
successAuditEvent
ââ1 B
,
ââB C
cancellationToken
ââD U
)
ââU V
;
ââV W
}
ää 	
await
çç 
_ticketRepository
çç 
.
çç  
UpdateAsync
çç  +
(
çç+ ,
ticket
çç, 2
,
çç2 3
cancellationToken
çç4 E
)
ççE F
;
ççF G
var
êê 
ticketAuditEvent
êê 
=
êê 

AuditEvent
êê )
.
êê) *
Create
êê* 0
(
êê0 1
AuditEventType
ëë 
.
ëë 
RefundProcessed
ëë *
,
ëë* +
nameof
íí 
(
íí 
Ticket
íí 
)
íí 
,
íí 
ticket
ìì 
.
ìì 
Id
ìì 
,
ìì 
command
îî 
.
îî 
ProcessedBy
îî 
.
îî  
Value
îî  %
,
îî% &
System
ïï 
.
ïï 
Text
ïï 
.
ïï 
Json
ïï 
.
ïï 
JsonSerializer
ïï +
.
ïï+ ,
	Serialize
ïï, 5
(
ïï5 6
new
ïï6 9
{
ïï: ;
Action
ññ 
=
ññ 
$str
ññ '
,
ññ' (#
RefundPaymentsCreated
óó %
=
óó& '#
refundPaymentsCreated
óó( =
,
óó= >
Reason
òò 
=
òò 
command
òò  
.
òò  !
Reason
òò! '
}
ôô 
)
ôô 
,
ôô 
$"
öö 
$str
öö 
{
öö 
ticket
öö 
.
öö 
TicketNumber
öö )
}
öö) *
$str
öö* 5
{
öö5 6#
refundPaymentsCreated
öö6 K
}
ööK L
$str
ööL e
"
ööe f
,
ööf g
correlationId
õõ 
:
õõ 
Guid
õõ 
.
õõ  
NewGuid
õõ  '
(
õõ' (
)
õõ( )
)
õõ) *
;
õõ* +
await
ùù #
_auditEventRepository
ùù #
.
ùù# $
AddAsync
ùù$ ,
(
ùù, -
ticketAuditEvent
ùù- =
,
ùù= >
cancellationToken
ùù? P
)
ùùP Q
;
ùùQ R
return
üü 
new
üü  
RefundTicketResult
üü %
{
†† 	
Success
°° 
=
°° 
true
°° 
,
°° #
RefundPaymentsCreated
¢¢ !
=
¢¢" ##
refundPaymentsCreated
¢¢$ 9
}
££ 	
;
££	 

}
§§ 
}•• “W
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\RefundPaymentCommandHandler.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
;

' (
public 
class '
RefundPaymentCommandHandler (
:) *
ICommandHandler+ :
<: ; 
RefundPaymentCommand; O
,O P
RefundPaymentResultQ d
>d e
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly 
IPaymentGateway $
_paymentGateway% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
Domain 
. 
DomainServices *
.* + 
PaymentDomainService+ ?!
_paymentDomainService@ U
;U V
public 
'
RefundPaymentCommandHandler &
(& '
ITicketRepository 
ticketRepository *
,* +
IPaymentRepository 
paymentRepository ,
,, -
IPaymentGateway 
paymentGateway &
,& '!
IAuditEventRepository  
auditEventRepository 2
,2 3
Domain 
. 
DomainServices 
.  
PaymentDomainService 2 
paymentDomainService3 G
)G H
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_paymentRepository 
= 
paymentRepository .
;. /
_paymentGateway   
=   
paymentGateway   (
;  ( )!
_auditEventRepository!! 
=!!  
auditEventRepository!!  4
;!!4 5!
_paymentDomainService"" 
=""  
paymentDomainService""  4
;""4 5
}## 
public%% 

async%% 
Task%% 
<%% 
RefundPaymentResult%% )
>%%) *
HandleAsync%%+ 6
(%%6 7 
RefundPaymentCommand&& 
command&& $
,&&$ %
CancellationToken'' 
cancellationToken'' +
='', -
default''. 5
)''5 6
{(( 
var** 
originalPayment** 
=** 
await** #
_paymentRepository**$ 6
.**6 7
GetByIdAsync**7 C
(**C D
command**D K
.**K L
OriginalPaymentId**L ]
,**] ^
cancellationToken**_ p
)**p q
;**q r
if++ 

(++ 
originalPayment++ 
==++ 
null++ #
)++# $
{,, 	
return-- 
new-- 
RefundPaymentResult-- *
{.. 
Success// 
=// 
false// 
,//  
ErrorMessage00 
=00 
$"00 !
$str00! )
{00) *
command00* 1
.001 2
OriginalPaymentId002 C
}00C D
$str00D O
"00O P
}11 
;11 
}22 	
var55 
ticket55 
=55 
await55 
_ticketRepository55 ,
.55, -
GetByIdAsync55- 9
(559 :
originalPayment55: I
.55I J
TicketId55J R
,55R S
cancellationToken55T e
)55e f
;55f g
if66 

(66 
ticket66 
==66 
null66 
)66 
{77 	
return88 
new88 
RefundPaymentResult88 *
{99 
Success:: 
=:: 
false:: 
,::  
ErrorMessage;; 
=;; 
$";; !
$str;;! (
{;;( )
originalPayment;;) 8
.;;8 9
TicketId;;9 A
};;A B
$str;;B M
";;M N
}<< 
;<< 
}== 	
if@@ 

(@@ 
!@@ !
_paymentDomainService@@ "
.@@" #
CanRefundPayment@@# 3
(@@3 4
originalPayment@@4 C
,@@C D
command@@E L
.@@L M
RefundAmount@@M Y
)@@Y Z
)@@Z [
{AA 	
returnBB 
newBB 
RefundPaymentResultBB *
{CC 
SuccessDD 
=DD 
falseDD 
,DD  
ErrorMessageEE 
=EE 
$strEE P
}FF 
;FF 
}GG 	
ifJJ 

(JJ 
originalPaymentJJ 
isJJ 
CreditCardPaymentJJ 0
creditCardPaymentJJ1 B
)JJB C
{KK 	
varLL 
gatewayResultLL 
=LL 
awaitLL  %
_paymentGatewayLL& 5
.LL5 6
RefundAsyncLL6 A
(LLA B
creditCardPaymentMM !
,MM! "
commandNN 
.NN 
RefundAmountNN $
,NN$ %
cancellationTokenOO !
)OO! "
;OO" #
ifQQ 
(QQ 
!QQ 
gatewayResultQQ 
.QQ 
SuccessQQ &
)QQ& '
{RR 
varTT 

auditEventTT 
=TT  

AuditEventTT! +
.TT+ ,
CreateTT, 2
(TT2 3
AuditEventTypeUU "
.UU" #
RefundProcessedUU# 2
,UU2 3
nameofVV 
(VV 
PaymentVV "
)VV" #
,VV# $
originalPaymentWW #
.WW# $
IdWW$ &
,WW& '
commandXX 
.XX 
ProcessedByXX '
.XX' (
ValueXX( -
,XX- .
SystemYY 
.YY 
TextYY 
.YY  
JsonYY  $
.YY$ %
JsonSerializerYY% 3
.YY3 4
	SerializeYY4 =
(YY= >
newYY> A
{YYB C
ActionZZ 
=ZZ  
$strZZ! )
,ZZ) *
Success[[ 
=[[  !
false[[" '
,[[' (
Error\\ 
=\\ 
gatewayResult\\  -
.\\- .
ErrorMessage\\. :
,\\: ;
Reason]] 
=]]  
command]]! (
.]]( )
Reason]]) /
}^^ 
)^^ 
,^^ 
$"__ 
$str__ 2
{__2 3
gatewayResult__3 @
.__@ A
ErrorMessage__A M
}__M N
"__N O
,__O P
correlationId`` !
:``! "
Guid``# '
.``' (
NewGuid``( /
(``/ 0
)``0 1
)``1 2
;``2 3
awaitbb !
_auditEventRepositorybb +
.bb+ ,
AddAsyncbb, 4
(bb4 5

auditEventbb5 ?
,bb? @
cancellationTokenbbA R
)bbR S
;bbS T
returndd 
newdd 
RefundPaymentResultdd .
{ee 
Successff 
=ff 
falseff #
,ff# $
ErrorMessagegg  
=gg! "
gatewayResultgg# 0
.gg0 1
ErrorMessagegg1 =
}hh 
;hh 
}ii 
}jj 	
varmm 
refundPaymentmm 
=mm 
Paymentmm #
.mm# $
CreateRefundmm$ 0
(mm0 1
originalPaymentnn 
,nn 
commandoo 
.oo 
RefundAmountoo  
,oo  !
commandpp 
.pp 
ProcessedBypp 
,pp  
commandqq 
.qq 

TerminalIdqq 
,qq 
commandrr 
.rr 
Reasonrr 
,rr 
commandss 
.ss 
GlobalIdss 
)ss 
;ss 
awaitvv 
_paymentRepositoryvv  
.vv  !
AddAsyncvv! )
(vv) *
refundPaymentvv* 7
,vv7 8
cancellationTokenvv9 J
)vvJ K
;vvK L
ticketyy 
.yy 
ProcessRefundyy 
(yy 
refundPaymentyy *
)yy* +
;yy+ ,
awaitzz 
_ticketRepositoryzz 
.zz  
UpdateAsynczz  +
(zz+ ,
ticketzz, 2
,zz2 3
cancellationTokenzz4 E
)zzE F
;zzF G
var}} 
successAuditEvent}} 
=}} 

AuditEvent}}  *
.}}* +
Create}}+ 1
(}}1 2
AuditEventType~~ 
.~~ 
RefundProcessed~~ *
,~~* +
nameof 
( 
Payment 
) 
, 
refundPayment
ÄÄ 
.
ÄÄ 
Id
ÄÄ 
,
ÄÄ 
command
ÅÅ 
.
ÅÅ 
ProcessedBy
ÅÅ 
.
ÅÅ  
Value
ÅÅ  %
,
ÅÅ% &
System
ÇÇ 
.
ÇÇ 
Text
ÇÇ 
.
ÇÇ 
Json
ÇÇ 
.
ÇÇ 
JsonSerializer
ÇÇ +
.
ÇÇ+ ,
	Serialize
ÇÇ, 5
(
ÇÇ5 6
new
ÇÇ6 9
{
ÇÇ: ;
Action
ÉÉ 
=
ÉÉ 
$str
ÉÉ !
,
ÉÉ! "
Success
ÑÑ 
=
ÑÑ 
true
ÑÑ 
,
ÑÑ 
OriginalPaymentId
ÖÖ !
=
ÖÖ" #
originalPayment
ÖÖ$ 3
.
ÖÖ3 4
Id
ÖÖ4 6
,
ÖÖ6 7
RefundAmount
ÜÜ 
=
ÜÜ 
command
ÜÜ &
.
ÜÜ& '
RefundAmount
ÜÜ' 3
,
ÜÜ3 4
Reason
áá 
=
áá 
command
áá  
.
áá  !
Reason
áá! '
}
àà 
)
àà 
,
àà 
$"
ââ 
$str
ââ  
{
ââ  !
command
ââ! (
.
ââ( )
RefundAmount
ââ) 5
}
ââ5 6
$str
ââ6 @
{
ââ@ A
command
ââA H
.
ââH I
Reason
ââI O
}
ââO P
"
ââP Q
,
ââQ R
correlationId
ää 
:
ää 
Guid
ää 
.
ää  
NewGuid
ää  '
(
ää' (
)
ää( )
)
ää) *
;
ää* +
await
åå #
_auditEventRepository
åå #
.
åå# $
AddAsync
åå$ ,
(
åå, -
successAuditEvent
åå- >
,
åå> ?
cancellationToken
åå@ Q
)
ååQ R
;
ååR S
return
éé 
new
éé !
RefundPaymentResult
éé &
{
èè 	
Success
êê 
=
êê 
true
êê 
,
êê 
RefundPaymentId
ëë 
=
ëë 
refundPayment
ëë +
.
ëë+ ,
Id
ëë, .
,
ëë. /
TicketId
íí 
=
íí 
ticket
íí 
.
íí 
Id
íí  
,
íí  !!
TicketFullyRefunded
ìì 
=
ìì  !
ticket
ìì" (
.
ìì( )
Status
ìì) /
==
ìì0 2
TicketStatus
ìì3 ?
.
ìì? @
Refunded
ìì@ H
}
îî 	
;
îî	 

}
ïï 
}ññ ù=
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\PrintReceiptCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 &
PrintReceiptCommandHandler

 '
:

( )
ICommandHandler

* 9
<

9 :
PrintReceiptCommand

: M
,

M N
PrintReceiptResult

O a
>

a b
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly  
IReceiptPrintService ) 
_receiptPrintService* >
;> ?
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
&
PrintReceiptCommandHandler %
(% &
ITicketRepository 
ticketRepository *
,* + 
IReceiptPrintService 
receiptPrintService 0
,0 1!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, - 
_receiptPrintService 
= 
receiptPrintService 2
;2 3!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
PrintReceiptResult (
>( )
HandleAsync* 5
(5 6
PrintReceiptCommand6 I
commandJ Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
throw   
new   
Domain   
.   

Exceptions   '
.  ' (*
BusinessRuleViolationException  ( F
(  F G
$"  G I
$str  I P
{  P Q
command  Q X
.  X Y
TicketId  Y a
}  a b
$str  b m
"  m n
)  n o
;  o p
}!! 	
bool## 
success## 
=## 
false## 
;## 
if%% 

(%% 
command%% 
.%% 
ReceiptType%% 
==%%  "
ReceiptType%%# .
.%%. /
Ticket%%/ 5
||%%6 8
!%%9 :
command%%: A
.%%A B
	PaymentId%%B K
.%%K L
HasValue%%L T
)%%T U
{&& 	
success(( 
=(( 
await((  
_receiptPrintService(( 0
.((0 1#
PrintTicketReceiptAsync((1 H
(((H I
ticket((I O
,((O P
userId((Q W
:((W X
null((Y ]
,((] ^
cancellationToken((_ p
:((p q
cancellationToken	((r É
)
((É Ñ
;
((Ñ Ö
})) 	
else** 
if** 
(** 
command** 
.** 
	PaymentId** "
.**" #
HasValue**# +
)**+ ,
{++ 	
var-- 
payment-- 
=-- 
ticket--  
.--  !
Payments--! )
.--) *
FirstOrDefault--* 8
(--8 9
p--9 :
=>--; =
p--> ?
.--? @
Id--@ B
==--C E
command--F M
.--M N
	PaymentId--N W
.--W X
Value--X ]
)--] ^
;--^ _
if.. 
(.. 
payment.. 
==.. 
null.. 
)..  
{// 
throw00 
new00 
Domain00  
.00  !

Exceptions00! +
.00+ ,*
BusinessRuleViolationException00, J
(00J K
$"00K M
$str00M U
{00U V
command00V ]
.00] ^
	PaymentId00^ g
.00g h
Value00h m
}00m n
$str00n y
"00y z
)00z {
;00{ |
}11 
if33 
(33 
command33 
.33 
ReceiptType33 #
==33$ &
ReceiptType33' 2
.332 3
Refund333 9
&&33: <
payment33= D
.33D E
TransactionType33E T
==33U W
Domain33X ^
.33^ _
Enumerations33_ k
.33k l
TransactionType33l {
.33{ |
Debit	33| Å
)
33Å Ç
{44 
success66 
=66 
await66  
_receiptPrintService66  4
.664 5#
PrintRefundReceiptAsync665 L
(66L M
payment66M T
,66T U
ticket66V \
,66\ ]
userId66^ d
:66d e
null66f j
,66j k
cancellationToken66l }
:66} ~
cancellationToken	66 ê
)
66ê ë
;
66ë í
}77 
else88 
{99 
success;; 
=;; 
await;;  
_receiptPrintService;;  4
.;;4 5$
PrintPaymentReceiptAsync;;5 M
(;;M N
payment;;N U
,;;U V
ticket;;W ]
,;;] ^
userId;;_ e
:;;e f
null;;g k
,;;k l
cancellationToken;;m ~
:;;~ 
cancellationToken
;;Ä ë
)
;;ë í
;
;;í ì
}<< 
}== 	
var@@ 
correlationId@@ 
=@@ 
Guid@@  
.@@  !
NewGuid@@! (
(@@( )
)@@) *
;@@* +
varAA 

auditEventAA 
=AA 

AuditEventAA #
.AA# $
CreateAA$ *
(AA* +
DomainBB 
.BB 
EnumerationsBB 
.BB  
AuditEventTypeBB  .
.BB. /
ModifiedBB/ 7
,BB7 8
nameofCC 
(CC 
TicketCC 
)CC 
,CC 
ticketDD 
.DD 
IdDD 
,DD 
GuidEE 
.EE 
EmptyEE 
,EE 
SystemFF 
.FF 
TextFF 
.FF 
JsonFF 
.FF 
JsonSerializerFF +
.FF+ ,
	SerializeFF, 5
(FF5 6
newFF6 9
{GG 
ReceiptTypeHH 
=HH 
commandHH %
.HH% &
ReceiptTypeHH& 1
,HH1 2
	PaymentIdII 
=II 
commandII #
.II# $
	PaymentIdII$ -
,II- .
SuccessJJ 
=JJ 
successJJ !
}KK 
)KK 
,KK 
$"LL 
$strLL 
{LL 
commandLL 
.LL 
ReceiptTypeLL *
}LL* +
$strLL+ @
{LL@ A
ticketLLA G
.LLG H
TicketNumberLLH T
}LLT U
"LLU V
,LLV W
correlationIdMM 
:MM 
correlationIdMM (
)MM( )
;MM) *
awaitOO !
_auditEventRepositoryOO #
.OO# $
AddAsyncOO$ ,
(OO, -

auditEventOO- 7
,OO7 8
cancellationTokenOO9 J
)OOJ K
;OOK L
returnQQ 
newQQ 
PrintReceiptResultQQ %
{RR 	
SuccessSS 
=SS 
successSS 
}TT 	
;TT	 

}UU 
}VV æô
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ProcessPaymentCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class (
ProcessPaymentCommandHandler )
:* +
ICommandHandler, ;
<; <!
ProcessPaymentCommand< Q
,Q R 
ProcessPaymentResultS g
>g h
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly  
PaymentDomainService )!
_paymentDomainService* ?
;? @
public 
(
ProcessPaymentCommandHandler '
(' (
ITicketRepository 
ticketRepository *
,* +
IPaymentRepository 
paymentRepository ,
,, -"
ICashSessionRepository !
cashSessionRepository 4
,4 5!
IAuditEventRepository  
auditEventRepository 2
,2 3 
PaymentDomainService  
paymentDomainService 1
)1 2
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_paymentRepository 
= 
paymentRepository .
;. /"
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7!
_auditEventRepository   
=    
auditEventRepository    4
;  4 5!
_paymentDomainService!! 
=!!  
paymentDomainService!!  4
;!!4 5
}"" 
public$$ 

async$$ 
Task$$ 
<$$  
ProcessPaymentResult$$ *
>$$* +
HandleAsync$$, 7
($$7 8!
ProcessPaymentCommand$$8 M
command$$N U
,$$U V
CancellationToken$$W h
cancellationToken$$i z
=$${ |
default	$$} Ñ
)
$$Ñ Ö
{%% 
var'' 
ticket'' 
='' 
await'' 
_ticketRepository'' ,
.'', -
GetByIdAsync''- 9
(''9 :
command'': A
.''A B
TicketId''B J
,''J K
cancellationToken''L ]
)''] ^
;''^ _
if(( 

((( 
ticket(( 
==(( 
null(( 
)(( 
{)) 	
throw** 
new** 
Domain** 
.** 

Exceptions** '
.**' (*
BusinessRuleViolationException**( F
(**F G
$"**G I
$str**I P
{**P Q
command**Q X
.**X Y
TicketId**Y a
}**a b
$str**b m
"**m n
)**n o
;**o p
}++ 	
Payment.. 
payment.. 
;.. 
Money// 
changeAmount// 
=// 
Money// "
.//" #
Zero//# '
(//' (
)//( )
;//) *
if11 

(11 
command11 
.11 
PaymentType11 
==11  "
PaymentType11# .
.11. /
Cash11/ 3
)113 4
{22 	
if44 
(44 
command44 
.44 
CashSessionId44 %
.44% &
HasValue44& .
)44. /
{55 
var66 
cashSession66 
=66  !
await66" '"
_cashSessionRepository66( >
.66> ?
GetByIdAsync66? K
(66K L
command66L S
.66S T
CashSessionId66T a
.66a b
Value66b g
,66g h
cancellationToken66i z
)66z {
;66{ |
if77 
(77 
cashSession77 
==77  "
null77# '
)77' (
{88 
throw99 
new99 
Domain99 $
.99$ %

Exceptions99% /
.99/ 0*
BusinessRuleViolationException990 N
(99N O
$"99O Q
$str99Q ^
{99^ _
command99_ f
.99f g
CashSessionId99g t
}99t u
$str	99u Ä
"
99Ä Å
)
99Å Ç
;
99Ç É
}:: 
};; 
if>> 
(>> 
command>> 
.>> 
TenderAmount>> $
==>>% '
null>>( ,
)>>, -
{?? 
throw@@ 
new@@ 
Domain@@  
.@@  !

Exceptions@@! +
.@@+ ,*
BusinessRuleViolationException@@, J
(@@J K
$str@@K y
)@@y z
;@@z {
}AA 
ifCC 
(CC 
commandCC 
.CC 
TenderAmountCC $
<CC% &
commandCC' .
.CC. /
AmountCC/ 5
)CC5 6
{DD 
throwEE 
newEE 
DomainEE  
.EE  !

ExceptionsEE! +
.EE+ ,*
BusinessRuleViolationExceptionEE, J
(EEJ K
$str	EEK ã
)
EEã å
;
EEå ç
}FF 
varII 
cashPaymentII 
=II 
CashPaymentII )
.II) *
CreateII* 0
(II0 1
commandJJ 
.JJ 
TicketIdJJ  
,JJ  !
commandKK 
.KK 
AmountKK 
,KK 
commandLL 
.LL 
ProcessedByLL #
,LL# $
commandMM 
.MM 

TerminalIdMM "
,MM" #
commandNN 
.NN 
GlobalIdNN  
)NN  !
;NN! "
ifQQ 
(QQ 
commandQQ 
.QQ 
TenderAmountQQ $
!=QQ% '
nullQQ( ,
)QQ, -
{RR 
varTT 
setTenderMethodTT #
=TT$ %
typeofTT& ,
(TT, -
PaymentTT- 4
)TT4 5
.TT5 6
	GetMethodTT6 ?
(TT? @
$strTT@ Q
,TTQ R
SystemUU 
.UU 

ReflectionUU %
.UU% &
BindingFlagsUU& 2
.UU2 3
	NonPublicUU3 <
|UU= >
SystemUU? E
.UUE F

ReflectionUUF P
.UUP Q
BindingFlagsUUQ ]
.UU] ^
InstanceUU^ f
)UUf g
;UUg h
setTenderMethodVV 
?VV  
.VV  !
InvokeVV! '
(VV' (
cashPaymentVV( 3
,VV3 4
newVV5 8
objectVV9 ?
[VV? @
]VV@ A
{VVB C
commandVVD K
.VVK L
TenderAmountVVL X
}VVY Z
)VVZ [
;VV[ \
changeAmountXX 
=XX 
commandXX &
.XX& '
TenderAmountXX' 3
-XX4 5
commandXX6 =
.XX= >
AmountXX> D
;XXD E
varYY 
setChangeMethodYY #
=YY$ %
typeofYY& ,
(YY, -
PaymentYY- 4
)YY4 5
.YY5 6
	GetMethodYY6 ?
(YY? @
$strYY@ Q
,YYQ R
SystemZZ 
.ZZ 

ReflectionZZ %
.ZZ% &
BindingFlagsZZ& 2
.ZZ2 3
	NonPublicZZ3 <
|ZZ= >
SystemZZ? E
.ZZE F

ReflectionZZF P
.ZZP Q
BindingFlagsZZQ ]
.ZZ] ^
InstanceZZ^ f
)ZZf g
;ZZg h
setChangeMethod[[ 
?[[  
.[[  !
Invoke[[! '
([[' (
cashPayment[[( 3
,[[3 4
new[[5 8
object[[9 ?
[[[? @
][[@ A
{[[B C
changeAmount[[D P
}[[Q R
)[[R S
;[[S T
}\\ 
if__ 
(__ 
command__ 
.__ 

TipsAmount__ "
!=__# %
null__& *
&&__+ -
command__. 5
.__5 6

TipsAmount__6 @
>__A B
Money__C H
.__H I
Zero__I M
(__M N
)__N O
)__O P
{`` 
varaa 
setTipsMethodaa !
=aa" #
typeofaa$ *
(aa* +
Paymentaa+ 2
)aa2 3
.aa3 4
	GetMethodaa4 =
(aa= >
$straa> M
,aaM N
Systembb 
.bb 

Reflectionbb %
.bb% &
BindingFlagsbb& 2
.bb2 3
	NonPublicbb3 <
|bb= >
Systembb? E
.bbE F

ReflectionbbF P
.bbP Q
BindingFlagsbbQ ]
.bb] ^
Instancebb^ f
)bbf g
;bbg h
setTipsMethodcc 
?cc 
.cc 
Invokecc %
(cc% &
cashPaymentcc& 1
,cc1 2
newcc3 6
objectcc7 =
[cc= >
]cc> ?
{cc@ A
commandccB I
.ccI J

TipsAmountccJ T
}ccU V
)ccV W
;ccW X
}dd 
ifgg 
(gg 
commandgg 
.gg 
CashSessionIdgg %
.gg% &
HasValuegg& .
)gg. /
{hh 
varii  
setCashSessionMethodii (
=ii) *
typeofii+ 1
(ii1 2
Paymentii2 9
)ii9 :
.ii: ;
	GetMethodii; D
(iiD E
$striiE W
,iiW X
Systemjj 
.jj 

Reflectionjj %
.jj% &
BindingFlagsjj& 2
.jj2 3
	NonPublicjj3 <
|jj= >
Systemjj? E
.jjE F

ReflectionjjF P
.jjP Q
BindingFlagsjjQ ]
.jj] ^
Instancejj^ f
)jjf g
;jjg h 
setCashSessionMethodkk $
?kk$ %
.kk% &
Invokekk& ,
(kk, -
cashPaymentkk- 8
,kk8 9
newkk: =
objectkk> D
[kkD E
]kkE F
{kkG H
commandkkI P
.kkP Q
CashSessionIdkkQ ^
.kk^ _
Valuekk_ d
}kke f
)kkf g
;kkg h
}ll 
paymentnn 
=nn 
cashPaymentnn !
;nn! "
changeAmountoo 
=oo !
_paymentDomainServiceoo 0
.oo0 1
CalculateChangeoo1 @
(oo@ A
paymentooA H
)ooH I
;ooI J
}pp 	
elseqq 
ifqq 
(qq 
commandqq 
.qq 
PaymentTypeqq $
==qq% '
PaymentTypeqq( 3
.qq3 4

CreditCardqq4 >
||qq? A
commandqqB I
.qqI J
PaymentTypeqqJ U
==qqV X
PaymentTypeqqY d
.qqd e
	DebitCardqqe n
)qqn o
{rr 	
vartt 
cardPaymenttt 
=tt 
CreditCardPaymenttt /
.tt/ 0
Creatett0 6
(tt6 7
commanduu 
.uu 
TicketIduu  
,uu  !
commandvv 
.vv 
Amountvv 
,vv 
commandww 
.ww 
ProcessedByww #
,ww# $
commandxx 
.xx 

TerminalIdxx "
,xx" #

cardNumberyy 
:yy 
commandyy #
.yy# $
Last4yy$ )
,yy) *
cardHolderNamezz 
:zz 
$strzz  0
,zz0 1
authorizationCode{{ !
:{{! "
command{{# *
.{{* +
AuthCode{{+ 3
??{{4 6
$str{{7 =
+{{> ?
DateTime{{@ H
.{{H I
Now{{I L
.{{L M
Ticks{{M R
.{{R S
ToString{{S [
({{[ \
){{\ ]
[{{] ^
^{{^ _
$num{{_ `
..{{` b
]{{b c
,{{c d
referenceNumber|| 
:||  
$str||! &
+||' (
DateTime||) 1
.||1 2
Now||2 5
.||5 6
Ticks||6 ;
.||; <
ToString||< D
(||D E
)||E F
[||F G
^||G H
$num||H I
..||I K
]||K L
,||L M
cardType}} 
:}} 
command}} !
.}}! "
CardType}}" *
??}}+ -
$str}}. 7
,}}7 8
globalId~~ 
:~~ 
command~~ !
.~~! "
GlobalId~~" *
)~~* +
;~~+ ,
payment
ÄÄ 
=
ÄÄ 
cardPayment
ÄÄ !
;
ÄÄ! "
}
ÅÅ 	
else
ÇÇ 
if
ÇÇ 
(
ÇÇ 
command
ÇÇ 
.
ÇÇ 
PaymentType
ÇÇ $
==
ÇÇ% '
PaymentType
ÇÇ( 3
.
ÇÇ3 4
GiftCertificate
ÇÇ4 C
)
ÇÇC D
{
ÉÉ 	
if
ÖÖ 
(
ÖÖ 
string
ÖÖ 
.
ÖÖ  
IsNullOrWhiteSpace
ÖÖ *
(
ÖÖ* +
command
ÖÖ+ 2
.
ÖÖ2 3
GiftCardNumber
ÖÖ3 A
)
ÖÖA B
)
ÖÖB C
{
ÜÜ 
throw
áá 
new
áá 
Domain
áá !
.
áá! "

Exceptions
áá" ,
.
áá, -,
BusinessRuleViolationException
áá- K
(
ááK L
$str
ááL r
)
áár s
;
áás t
}
àà 
var
åå 
simulatedBalance
åå !
=
åå" #
command
åå$ +
.
åå+ ,
Amount
åå, 2
+
åå3 4
new
åå5 8
Money
åå9 >
(
åå> ?
$num
åå? E
,
ååE F
command
ååG N
.
ååN O
Amount
ååO U
.
ååU V
Currency
ååV ^
)
åå^ _
;
åå_ `
var
éé 
	gcPayment
éé 
=
éé $
GiftCertificatePayment
éé 3
.
éé3 4
Create
éé4 :
(
éé: ;
command
èè 
.
èè 
TicketId
èè !
,
èè! "
command
êê 
.
êê 
Amount
êê 
,
êê  
command
ëë 
.
ëë 
ProcessedBy
ëë $
,
ëë$ %
command
íí 
.
íí 

TerminalId
íí #
,
íí# $
command
ìì 
.
ìì 
GiftCardNumber
ìì '
,
ìì' (
originalAmount
îî 
:
îî  
simulatedBalance
îî! 1
,
îî1 2
remainingBalance
ïï !
:
ïï! "
simulatedBalance
ïï# 3
-
ïï4 5
command
ïï6 =
.
ïï= >
Amount
ïï> D
,
ïïD E
globalId
ññ 
:
ññ 
command
ññ "
.
ññ" #
GlobalId
ññ# +
)
ññ+ ,
;
ññ, -
payment
òò 
=
òò 
	gcPayment
òò  
;
òò  !
}
ôô 	
else
öö 
{
õõ 	
throw
ùù 
new
ùù 
Domain
ùù 
.
ùù 

Exceptions
ùù '
.
ùù' (,
BusinessRuleViolationException
ùù( F
(
ùùF G
$"
ùùG I
$str
ùùI V
{
ùùV W
command
ùùW ^
.
ùù^ _
PaymentType
ùù_ j
}
ùùj k
$strùùk Å
"ùùÅ Ç
)ùùÇ É
;ùùÉ Ñ
}
ûû 	
ticket
°° 
.
°° 

AddPayment
°° 
(
°° 
payment
°° !
)
°°! "
;
°°" #
await
§§  
_paymentRepository
§§  
.
§§  !
AddAsync
§§! )
(
§§) *
payment
§§* 1
,
§§1 2
cancellationToken
§§3 D
)
§§D E
;
§§E F
await
ßß 
_ticketRepository
ßß 
.
ßß  
UpdateAsync
ßß  +
(
ßß+ ,
ticket
ßß, 2
,
ßß2 3
cancellationToken
ßß4 E
)
ßßE F
;
ßßF G
if
™™ 

(
™™ 
command
™™ 
.
™™ 
PaymentType
™™ 
==
™™  "
PaymentType
™™# .
.
™™. /
Cash
™™/ 3
&&
™™4 6
command
™™7 >
.
™™> ?
CashSessionId
™™? L
.
™™L M
HasValue
™™M U
)
™™U V
{
´´ 	
var
¨¨ 
cashSession
¨¨ 
=
¨¨ 
await
¨¨ #$
_cashSessionRepository
¨¨$ :
.
¨¨: ;
GetByIdAsync
¨¨; G
(
¨¨G H
command
¨¨H O
.
¨¨O P
CashSessionId
¨¨P ]
.
¨¨] ^
Value
¨¨^ c
,
¨¨c d
cancellationToken
¨¨e v
)
¨¨v w
;
¨¨w x
if
≠≠ 
(
≠≠ 
cashSession
≠≠ 
!=
≠≠ 
null
≠≠ #
)
≠≠# $
{
ÆÆ 
cashSession
ØØ 
.
ØØ 

AddPayment
ØØ &
(
ØØ& '
payment
ØØ' .
)
ØØ. /
;
ØØ/ 0
await
∞∞ $
_cashSessionRepository
∞∞ ,
.
∞∞, -
UpdateAsync
∞∞- 8
(
∞∞8 9
cashSession
∞∞9 D
,
∞∞D E
cancellationToken
∞∞F W
)
∞∞W X
;
∞∞X Y
}
±± 
}
≤≤ 	
var
µµ 
correlationId
µµ 
=
µµ 
Guid
µµ  
.
µµ  !
NewGuid
µµ! (
(
µµ( )
)
µµ) *
;
µµ* +
var
∂∂ 

auditEvent
∂∂ 
=
∂∂ 

AuditEvent
∂∂ #
.
∂∂# $
Create
∂∂$ *
(
∂∂* +
AuditEventType
∑∑ 
.
∑∑ 
PaymentProcessed
∑∑ +
,
∑∑+ ,
nameof
∏∏ 
(
∏∏ 
Payment
∏∏ 
)
∏∏ 
,
∏∏ 
payment
ππ 
.
ππ 
Id
ππ 
,
ππ 
command
∫∫ 
.
∫∫ 
ProcessedBy
∫∫ 
.
∫∫  
Value
∫∫  %
,
∫∫% &
System
ªª 
.
ªª 
Text
ªª 
.
ªª 
Json
ªª 
.
ªª 
JsonSerializer
ªª +
.
ªª+ ,
	Serialize
ªª, 5
(
ªª5 6
new
ªª6 9
{
ªª: ;
	PaymentId
ªª< E
=
ªªF G
payment
ªªH O
.
ªªO P
Id
ªªP R
,
ªªR S
Amount
ªªT Z
=
ªª[ \
payment
ªª] d
.
ªªd e
Amount
ªªe k
}
ªªl m
)
ªªm n
,
ªªn o
$"
ºº 
$str
ºº 
{
ºº 
payment
ºº !
.
ºº! "
Amount
ºº" (
}
ºº( )
$str
ºº) ?
{
ºº? @
ticket
ºº@ F
.
ººF G
TicketNumber
ººG S
}
ººS T
"
ººT U
,
ººU V
correlationId
ΩΩ 
:
ΩΩ 
correlationId
ΩΩ (
)
ΩΩ( )
;
ΩΩ) *
await
øø #
_auditEventRepository
øø #
.
øø# $
AddAsync
øø$ ,
(
øø, -

auditEvent
øø- 7
,
øø7 8
cancellationToken
øø9 J
)
øøJ K
;
øøK L
return
¡¡ 
new
¡¡ "
ProcessPaymentResult
¡¡ '
{
¬¬ 	
	PaymentId
√√ 
=
√√ 
payment
√√ 
.
√√  
Id
√√  "
,
√√" #
ChangeAmount
ƒƒ 
=
ƒƒ 
changeAmount
ƒƒ '
,
ƒƒ' (
TicketIsPaid
≈≈ 
=
≈≈ 
ticket
≈≈ !
.
≈≈! "
Status
≈≈" (
==
≈≈) +
TicketStatus
≈≈, 8
.
≈≈8 9
Paid
≈≈9 =
}
∆∆ 	
;
∆∆	 

}
«« 
}»» «c
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\PrintToKitchenCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 (
PrintToKitchenCommandHandler

 )
:

* +
ICommandHandler

, ;
<

; <!
PrintToKitchenCommand

< Q
,

Q R 
PrintToKitchenResult

S g
>

g h
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly  
IKitchenPrintService ) 
_kitchenPrintService* >
;> ?
private 
readonly "
IKitchenRoutingService +"
_kitchenRoutingService, B
;B C
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
(
PrintToKitchenCommandHandler '
(' (
ITicketRepository 
ticketRepository *
,* + 
IKitchenPrintService 
kitchenPrintService 0
,0 1"
IKitchenRoutingService !
kitchenRoutingService 4
,4 5!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, - 
_kitchenPrintService 
= 
kitchenPrintService 2
;2 3"
_kitchenRoutingService 
=  !
kitchenRoutingService! 6
;6 7!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
<  
PrintToKitchenResult *
>* +
HandleAsync, 7
(7 8!
PrintToKitchenCommand8 M
commandN U
,U V
CancellationTokenW h
cancellationTokeni z
={ |
default	} Ñ
)
Ñ Ö
{ 
var   
ticket   
=   
await   
_ticketRepository   ,
.  , -
GetByIdAsync  - 9
(  9 :
command  : A
.  A B
TicketId  B J
,  J K
cancellationToken  L ]
)  ] ^
;  ^ _
if!! 

(!! 
ticket!! 
==!! 
null!! 
)!! 
{"" 	
throw## 
new## 
Domain## 
.## 

Exceptions## '
.##' (*
BusinessRuleViolationException##( F
(##F G
$"##G I
$str##I P
{##P Q
command##Q X
.##X Y
TicketId##Y a
}##a b
$str##b m
"##m n
)##n o
;##o p
}$$ 	
int&& 
orderLinesPrinted&& 
=&& 
$num&&  !
;&&! "
bool'' 
printSuccess'' 
='' 
true''  
;''  !
List(( 
<(( 
string(( 
>(( 
errors(( 
=(( 
new(( !
(((! "
)((" #
;((# $
string)) 
message)) 
=)) 
$str)) /
;))/ 0
try-- 
{.. 	
var// 
	ticketDto// 
=// 
MapToDto// $
(//$ %
ticket//% +
)//+ ,
;//, -
await00 "
_kitchenRoutingService00 (
.00( )
RouteToKitchenAsync00) <
(00< =
	ticketDto00= F
,00F G
command00H O
.00O P
OrderLineId00P [
.00[ \
HasValue00\ d
?00e f
new00g j
List00k o
<00o p
Guid00p t
>00t u
{00v w
command00x 
.	00 Ä
OrderLineId
00Ä ã
.
00ã å
Value
00å ë
}
00í ì
:
00î ï
null
00ñ ö
)
00ö õ
;
00õ ú
}11 	
catch22 
(22 
	Exception22 
ex22 
)22 
{33 	
errors44 
.44 
Add44 
(44 
$"44 
$str44 -
{44- .
ex44. 0
.440 1
Message441 8
}448 9
"449 :
)44: ;
;44; <
}66 	
if99 

(99 
command99 
.99 
OrderLineId99 
.99  
HasValue99  (
)99( )
{:: 	
var;; 
	orderLine;; 
=;; 
ticket;; "
.;;" #

OrderLines;;# -
.;;- .
FirstOrDefault;;. <
(;;< =
ol;;= ?
=>;;@ B
ol;;C E
.;;E F
Id;;F H
==;;I K
command;;L S
.;;S T
OrderLineId;;T _
.;;_ `
Value;;` e
);;e f
;;;f g
if<< 
(<< 
	orderLine<< 
==<< 
null<< !
)<<! "
throw<<# (
new<<) ,
Domain<<- 3
.<<3 4

Exceptions<<4 >
.<<> ?*
BusinessRuleViolationException<<? ]
(<<] ^
$str<<^ u
)<<u v
;<<v w
var>> 
result>> 
=>> 
await>>  
_kitchenPrintService>> 3
.>>3 4
PrintOrderLineAsync>>4 G
(>>G H
	orderLine>>H Q
,>>Q R
ticket>>S Y
,>>Y Z
cancellationToken>>[ l
)>>l m
;>>m n
printSuccess?? 
=?? 
result?? !
.??! "
Success??" )
;??) *
orderLinesPrinted@@ 
=@@ 
result@@  &
.@@& '
PrintedCount@@' 3
;@@3 4
messageAA 
=AA 
resultAA 
.AA 
MessageAA $
;AA$ %
ifBB 
(BB 
resultBB 
.BB 
ErrorsBB 
!=BB  
nullBB! %
)BB% &
errorsBB' -
.BB- .
AddRangeBB. 6
(BB6 7
resultBB7 =
.BB= >
ErrorsBB> D
)BBD E
;BBE F
}CC 	
elseDD 
{EE 	
varFF 
resultFF 
=FF 
awaitFF  
_kitchenPrintServiceFF 3
.FF3 4
PrintTicketAsyncFF4 D
(FFD E
ticketFFE K
,FFK L
cancellationTokenFFM ^
)FF^ _
;FF_ `
printSuccessGG 
=GG 
resultGG !
.GG! "
SuccessGG" )
;GG) *
orderLinesPrintedHH 
=HH 
resultHH  &
.HH& '
PrintedCountHH' 3
;HH3 4
messageII 
=II 
resultII 
.II 
MessageII $
;II$ %
ifJJ 
(JJ 
resultJJ 
.JJ 
ErrorsJJ 
!=JJ  
nullJJ! %
)JJ% &
errorsJJ' -
.JJ- .
AddRangeJJ. 6
(JJ6 7
resultJJ7 =
.JJ= >
ErrorsJJ> D
)JJD E
;JJE F
}KK 	
ifNN 

(NN 
orderLinesPrintedNN 
>NN 
$numNN  !
)NN! "
{OO 	
varPP 

auditEventPP 
=PP 

AuditEventPP '
.PP' (
CreatePP( .
(PP. /
DomainQQ 
.QQ 
EnumerationsQQ #
.QQ# $
AuditEventTypeQQ$ 2
.QQ2 3
ModifiedQQ3 ;
,QQ; <
nameofRR 
(RR 
TicketRR 
)RR 
,RR 
ticketSS 
.SS 
IdSS 
,SS 
GuidTT 
.TT 
EmptyTT 
,TT 
SystemUU 
.UU 
TextUU 
.UU 
JsonUU  
.UU  !
JsonSerializerUU! /
.UU/ 0
	SerializeUU0 9
(UU9 :
newUU: =
{UU> ?
OrderLinesPrintedUU@ Q
=UUR S
orderLinesPrintedUUT e
}UUf g
)UUg h
,UUh i
$"VV 
$strVV 
{VV 
orderLinesPrintedVV ,
}VV, -
$strVV- J
"VVJ K
,VVK L
correlationIdWW 
:WW 
GuidWW #
.WW# $
NewGuidWW$ +
(WW+ ,
)WW, -
)WW- .
;WW. /
awaitXX !
_auditEventRepositoryXX '
.XX' (
AddAsyncXX( 0
(XX0 1

auditEventXX1 ;
,XX; <
cancellationTokenXX= N
)XXN O
;XXO P
}YY 	
return[[ 
new[[  
PrintToKitchenResult[[ '
{\\ 	
OrderLinesPrinted]] 
=]] 
orderLinesPrinted]]  1
,]]1 2
Success^^ 
=^^ 
printSuccess^^ "
,^^" #
Message__ 
=__ 
message__ 
,__ 
Errors`` 
=`` 
errors`` 
}aa 	
;aa	 

}bb 
privatedd 
Magideskdd 
.dd 
Applicationdd  
.dd  !
DTOsdd! %
.dd% &
	TicketDtodd& /
MapToDtodd0 8
(dd8 9
Ticketdd9 ?
ticketdd@ F
)ddF G
{ee 
returnff 
newff 
Magideskff 
.ff 
Applicationff '
.ff' (
DTOsff( ,
.ff, -
	TicketDtoff- 6
{gg 	
Idhh 
=hh 
tickethh 
.hh 
Idhh 
,hh 
TicketNumberii 
=ii 
ticketii !
.ii! "
TicketNumberii" .
,ii. /
GlobalIdjj 
=jj 
ticketjj 
.jj 
GlobalIdjj &
,jj& '
	TableNamekk 
=kk 
stringkk 
.kk 
Joinkk #
(kk# $
$strkk$ (
,kk( )
ticketkk* 0
.kk0 1
TableNumberskk1 =
)kk= >
,kk> ?
	OwnerNamell 
=ll 
$strll !
,ll! "
Statusmm 
=mm 
ticketmm 
.mm 
Statusmm "
,mm" #
	CreatedAtnn 
=nn 
ticketnn 
.nn 
	CreatedAtnn (
,nn( )

ActiveDateoo 
=oo 
ticketoo 
.oo  

ActiveDateoo  *
,oo* +

OrderLinespp 
=pp 
ticketpp 
.pp  

OrderLinespp  *
.pp* +
Selectpp+ 1
(pp1 2
olpp2 4
=>pp5 7
newpp8 ;
Magideskpp< D
.ppD E
ApplicationppE P
.ppP Q
DTOsppQ U
.ppU V
OrderLineDtoppV b
{qq 
Idrr 
=rr 
olrr 
.rr 
Idrr 
,rr 
TicketIdss 
=ss 
olss 
.ss 
TicketIdss &
,ss& '

MenuItemIdtt 
=tt 
oltt 
.tt  

MenuItemIdtt  *
,tt* +
MenuItemNameuu 
=uu 
oluu !
.uu! "
MenuItemNameuu" .
,uu. /
Quantityvv 
=vv 
olvv 
.vv 
Quantityvv &
,vv& ' 
ShouldPrintToKitchenww $
=ww% &
olww' )
.ww) * 
ShouldPrintToKitchenww* >
,ww> ?
PrinterGroupIdxx 
=xx  
olxx! #
.xx# $
PrinterGroupIdxx$ 2
,xx2 3
Instructionsyy 
=yy 
olyy !
.yy! "
Instructionsyy" .
,yy. /
	Modifierszz 
=zz 
olzz 
.zz 
	Modifierszz (
.zz( )
Selectzz) /
(zz/ 0
mzz0 1
=>zz2 4
newzz5 8
Magideskzz9 A
.zzA B
ApplicationzzB M
.zzM N
DTOszzN R
.zzR S 
OrderLineModifierDtozzS g
{{{ 
Id|| 
=|| 
m|| 
.|| 
Id|| 
,|| 
Name}} 
=}} 
m}} 
.}} 
Name}} !
,}}! " 
ShouldPrintToKitchen~~ (
=~~) *
m~~+ ,
.~~, - 
ShouldPrintToKitchen~~- A
} 
) 
. 
ToList 
( 
) 
}
ÄÄ 
)
ÄÄ 
.
ÄÄ 
ToList
ÄÄ 
(
ÄÄ 
)
ÄÄ 
}
ÅÅ 	
;
ÅÅ	 

}
ÇÇ 
}ÉÉ ús
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\Printing\PrintContextBuilder.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
.

' (
Printing

( 0
;

0 1
public 
class 
PrintContextBuilder  
:! " 
IPrintContextBuilder# 7
{ 
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
private 
readonly .
"IRestaurantConfigurationRepository 7'
_restaurantConfigRepository8 S
;S T
public 

PrintContextBuilder 
( 
IUserRepository 
userRepository &
,& '.
"IRestaurantConfigurationRepository *&
restaurantConfigRepository+ E
)E F
{ 
_userRepository 
= 
userRepository (
;( )'
_restaurantConfigRepository #
=$ %&
restaurantConfigRepository& @
;@ A
} 
public 

async 
Task 
< 
TicketPrintModel &
>& '#
BuildTicketContextAsync( ?
(? @
Ticket@ F
ticketG M
,M N
CancellationTokenO `
cancellationTokena r
)r s
{ 
var 
model 
= 
new 
TicketPrintModel (
(( )
)) *
;* +
model   
.   
TicketNumber   
=   
ticket   #
.  # $
TicketNumber  $ 0
.  0 1
ToString  1 9
(  9 :
)  : ;
;  ; <
model!! 
.!! 
Date!! 
=!! 
DateTime!! 
.!! 
Now!! !
.!!! "
ToString!!" *
(!!* +
$str!!+ 7
)!!7 8
;!!8 9
model"" 
."" 
Time"" 
="" 
DateTime"" 
."" 
Now"" !
.""! "
ToString""" *
(""* +
$str""+ 2
)""2 3
;""3 4
model## 
.## 
	TableName## 
=## 
ticket##  
.##  !
TableNumbers##! -
.##- .
Any##. 1
(##1 2
)##2 3
?##4 5
string##6 <
.##< =
Join##= A
(##A B
$str##B E
,##E F
ticket##G M
.##M N
TableNumbers##N Z
)##Z [
:##\ ]
$str##^ h
;##h i
if&& 

(&& 
ticket&& 
.&& 
	CreatedBy&& 
!=&& 
null&&  $
)&&$ %
{'' 	
var(( 
user(( 
=(( 
await(( 
_userRepository(( ,
.((, -
GetByIdAsync((- 9
(((9 :
ticket((: @
.((@ A
	CreatedBy((A J
.((J K
Value((K P
,((P Q
cancellationToken((R c
)((c d
;((d e
model)) 
.)) 

ServerName)) 
=)) 
user)) #
!=))$ &
null))' +
?)), -
$")). 0
{))0 1
user))1 5
.))5 6
	FirstName))6 ?
}))? @
$str))@ A
{))A B
user))B F
.))F G
LastName))G O
}))O P
"))P Q
.))Q R
Trim))R V
())V W
)))W X
:))Y Z
$str))[ d
;))d e
}** 	
else++ 
{,, 	
model-- 
.-- 

ServerName-- 
=-- 
$str-- '
;--' (
}.. 	
model11 
.11 
Subtotal11 
=11 
ticket11 
.11  
SubtotalAmount11  .
.11. /
Amount11/ 5
.115 6
ToString116 >
(11> ?
$str11? C
)11C D
;11D E
model22 
.22 
Tax22 
=22 
ticket22 
.22 
	TaxAmount22 $
.22$ %
Amount22% +
.22+ ,
ToString22, 4
(224 5
$str225 9
)229 :
;22: ;
model33 
.33 
Total33 
=33 
ticket33 
.33 
TotalAmount33 (
.33( )
Amount33) /
.33/ 0
ToString330 8
(338 9
$str339 =
)33= >
;33> ?
model44 
.44 

BalanceDue44 
=44 
ticket44 !
.44! "
	DueAmount44" +
.44+ ,
Amount44, 2
.442 3
ToString443 ;
(44; <
$str44< @
)44@ A
;44A B
var77 
config77 
=77 
await77 '
_restaurantConfigRepository77 6
.776 7!
GetConfigurationAsync777 L
(77L M
cancellationToken77M ^
)77^ _
;77_ `
if88 

(88 
config88 
!=88 
null88 
)88 
{99 	
model:: 
.:: 

Restaurant:: 
.:: 
Name:: !
=::" #
config::$ *
.::* +
Name::+ /
;::/ 0
model;; 
.;; 

Restaurant;; 
.;; 
Address;; $
=;;% &
config;;' -
.;;- .
Address;;. 5
;;;5 6
model<< 
.<< 

Restaurant<< 
.<< 
Phone<< "
=<<# $
config<<% +
.<<+ ,
Phone<<, 1
;<<1 2
}== 	
else>> 
{?? 	
modelAA 
.AA 

RestaurantAA 
.AA 
NameAA !
=AA" #
$strAA$ 2
;AA2 3
modelBB 
.BB 

RestaurantBB 
.BB 
AddressBB $
=BB% &
$strBB' C
;BBC D
modelCC 
.CC 

RestaurantCC 
.CC 
PhoneCC "
=CC# $
$strCC% 5
;CC5 6
}DD 	
foreachGG 
(GG 
varGG 
lineGG 
inGG 
ticketGG #
.GG# $

OrderLinesGG$ .
)GG. /
{HH 	
varII 
	lineModelII 
=II 
newII 
OrderLinePrintModelII  3
{JJ 
QuantityKK 
=KK 
lineKK 
.KK  
QuantityKK  (
,KK( )
NameLL 
=LL 
lineLL 
.LL 
MenuItemNameLL (
,LL( )
PriceMM 
=MM 
lineMM 
.MM 
	UnitPriceMM &
.MM& '
AmountMM' -
.MM- .
ToStringMM. 6
(MM6 7
$strMM7 ;
)MM; <
,MM< =
TotalNN 
=NN 
lineNN 
.NN 
TotalAmountNN (
.NN( )
AmountNN) /
.NN/ 0
ToStringNN0 8
(NN8 9
$strNN9 =
)NN= >
,NN> ?
InstructionsOO 
=OO 
lineOO #
.OO# $
InstructionsOO$ 0
??OO1 3
stringOO4 :
.OO: ;
EmptyOO; @
}PP 
;PP 
foreachRR 
(RR 
varRR 
modRR 
inRR 
lineRR  $
.RR$ %
	ModifiersRR% .
)RR. /
{SS 
	lineModelTT 
.TT 
	ModifiersTT #
.TT# $
AddTT$ '
(TT' (
$"TT( *
{TT* +
modTT+ .
.TT. /
NameTT/ 3
}TT3 4
$strTT4 7
{TT7 8
modTT8 ;
.TT; <
TotalAmountTT< G
.TTG H
AmountTTH N
:TTN O
$strTTO Q
}TTQ R
$strTTR S
"TTS T
)TTT U
;TTU V
}UU 
modelWW 
.WW 
LinesWW 
.WW 
AddWW 
(WW 
	lineModelWW %
)WW% &
;WW& '
}XX 	
foreach[[ 
([[ 
var[[ 
pay[[ 
in[[ 
ticket[[ "
.[[" #
Payments[[# +
)[[+ ,
{\\ 	
model]] 
.]] 
Payments]] 
.]] 
Add]] 
(]] 
new]] "
PaymentPrintModel]]# 4
{^^ 
Type__ 
=__ 
pay__ 
.__ 
PaymentType__ &
.__& '
ToString__' /
(__/ 0
)__0 1
,__1 2
Amount`` 
=`` 
pay`` 
.`` 
Amount`` #
.``# $
Amount``$ *
.``* +
ToString``+ 3
(``3 4
$str``4 8
)``8 9
}aa 
)aa 
;aa 
}bb 	
returndd 
modeldd 
;dd 
}ee 
publicgg 

asyncgg 
Taskgg 
<gg 
TicketPrintModelgg &
>gg& '$
BuildKitchenContextAsyncgg( @
(gg@ A
TicketggA G
ticketggH N
,ggN O
IEnumerableggP [
<gg[ \
	OrderLinegg\ e
>gge f
linesggg l
,ggl m
CancellationTokenggn 
cancellationToken
ggÄ ë
)
ggë í
{hh 
varii 
modelii 
=ii 
newii 
TicketPrintModelii (
(ii( )
)ii) *
;ii* +
modelll 
.ll 
TicketNumberll 
=ll 
ticketll #
.ll# $
TicketNumberll$ 0
.ll0 1
ToStringll1 9
(ll9 :
)ll: ;
;ll; <
modelmm 
.mm 
Datemm 
=mm 
DateTimemm 
.mm 
Nowmm !
.mm! "
ToStringmm" *
(mm* +
$strmm+ 7
)mm7 8
;mm8 9
modelnn 
.nn 
Timenn 
=nn 
DateTimenn 
.nn 
Nownn !
.nn! "
ToStringnn" *
(nn* +
$strnn+ 2
)nn2 3
;nn3 4
modeloo 
.oo 
	TableNameoo 
=oo 
ticketoo  
.oo  !
TableNumbersoo! -
.oo- .
Anyoo. 1
(oo1 2
)oo2 3
?oo4 5
stringoo6 <
.oo< =
Joinoo= A
(ooA B
$strooB E
,ooE F
ticketooG M
.ooM N
TableNumbersooN Z
)ooZ [
:oo\ ]
$stroo^ h
;ooh i
ifrr 

(rr 
ticketrr 
.rr 
	CreatedByrr 
!=rr 
nullrr  $
)rr$ %
{ss 	
vartt 
usertt 
=tt 
awaittt 
_userRepositorytt ,
.tt, -
GetByIdAsynctt- 9
(tt9 :
tickettt: @
.tt@ A
	CreatedByttA J
.ttJ K
ValuettK P
,ttP Q
cancellationTokenttR c
)ttc d
;ttd e
modeluu 
.uu 

ServerNameuu 
=uu 
useruu #
!=uu$ &
nulluu' +
?uu, -
$"uu. 0
{uu0 1
useruu1 5
.uu5 6
	FirstNameuu6 ?
}uu? @
$struu@ A
{uuA B
useruuB F
.uuF G
LastNameuuG O
}uuO P
"uuP Q
.uuQ R
TrimuuR V
(uuV W
)uuW X
:uuY Z
$struu[ d
;uud e
}vv 	
elseww 
{xx 	
modelyy 
.yy 

ServerNameyy 
=yy 
$stryy '
;yy' (
}zz 	
model}} 
.}} 
Subtotal}} 
=}} 
$str}} 
;}} 
model~~ 
.~~ 
Tax~~ 
=~~ 
$str~~ 
;~~ 
model 
. 
Total 
= 
$str 
; 
model
ÄÄ 
.
ÄÄ 

BalanceDue
ÄÄ 
=
ÄÄ 
$str
ÄÄ 
;
ÄÄ 
var
ÉÉ 
config
ÉÉ 
=
ÉÉ 
await
ÉÉ )
_restaurantConfigRepository
ÉÉ 6
.
ÉÉ6 7#
GetConfigurationAsync
ÉÉ7 L
(
ÉÉL M
cancellationToken
ÉÉM ^
)
ÉÉ^ _
;
ÉÉ_ `
if
ÑÑ 

(
ÑÑ 
config
ÑÑ 
!=
ÑÑ 
null
ÑÑ 
)
ÑÑ 
{
ÖÖ 	
model
ÜÜ 
.
ÜÜ 

Restaurant
ÜÜ 
.
ÜÜ 
Name
ÜÜ !
=
ÜÜ" #
config
ÜÜ$ *
.
ÜÜ* +
Name
ÜÜ+ /
;
ÜÜ/ 0
}
áá 	
else
àà 
{
ââ 	
model
ää 
.
ää 

Restaurant
ää 
.
ää 
Name
ää !
=
ää" #
$str
ää$ 2
;
ää2 3
}
ãã 	
foreach
éé 
(
éé 
var
éé 
line
éé 
in
éé 
lines
éé "
)
éé" #
{
èè 	
var
êê 
	lineModel
êê 
=
êê 
new
êê !
OrderLinePrintModel
êê  3
{
ëë 
Quantity
íí 
=
íí 
line
íí 
.
íí  
Quantity
íí  (
,
íí( )
Name
ìì 
=
ìì 
line
ìì 
.
ìì 
MenuItemName
ìì (
,
ìì( )
Price
îî 
=
îî 
$str
îî 
,
îî 
Total
ïï 
=
ïï 
$str
ïï 
,
ïï 
Instructions
ññ 
=
ññ 
line
ññ #
.
ññ# $
Instructions
ññ$ 0
??
ññ1 3
string
ññ4 :
.
ññ: ;
Empty
ññ; @
}
óó 
;
óó 
foreach
ôô 
(
ôô 
var
ôô 
mod
ôô 
in
ôô 
line
ôô  $
.
ôô$ %
	Modifiers
ôô% .
)
ôô. /
{
öö 
	lineModel
õõ 
.
õõ 
	Modifiers
õõ #
.
õõ# $
Add
õõ$ '
(
õõ' (
$"
õõ( *
{
õõ* +
mod
õõ+ .
.
õõ. /
Name
õõ/ 3
}
õõ3 4
"
õõ4 5
)
õõ5 6
;
õõ6 7
}
úú 
model
ûû 
.
ûû 
Lines
ûû 
.
ûû 
Add
ûû 
(
ûû 
	lineModel
ûû %
)
ûû% &
;
ûû& '
}
üü 	
return
££ 
model
££ 
;
££ 
}
§§ 
}•• ”4
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\PayNowCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class  
PayNowCommandHandler !
:" #
ICommandHandler$ 3
<3 4
PayNowCommand4 A
,A B
PayNowResultC O
>O P
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
 
PayNowCommandHandler 
(  
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
PayNowResult "
>" #
HandleAsync$ /
(/ 0
PayNowCommand0 =
command> E
,E F
CancellationTokenG X
cancellationTokenY j
=k l
defaultm t
)t u
{ 
try 
{ 	
var 
ticket 
= 
await 
_ticketRepository 0
.0 1
GetByIdAsync1 =
(= >
command> E
.E F
TicketIdF N
,N O
cancellationTokenP a
)a b
;b c
if 
( 
ticket 
== 
null 
) 
{ 
return   
PayNowResult   #
.  # $
Failure  $ +
(  + ,
$"  , .
$str  . 5
{  5 6
command  6 =
.  = >
TicketId  > F
}  F G
$str  G R
"  R S
)  S T
;  T U
}!! 
ticket$$ 
.$$ 
CalculateTotals$$ "
($$" #
)$$# $
;$$$ %
var'' 
amountToPay'' 
='' 
command'' %
.''% &
Amount''& ,
>''- .
$num''/ 0
?(( 
new(( 
Money(( 
((( 
command(( #
.((# $
Amount(($ *
)((* +
:)) 
ticket)) 
.)) 
	DueAmount)) "
;))" #
if++ 
(++ 
amountToPay++ 
<=++ 
Money++ $
.++$ %
Zero++% )
(++) *
)++* +
)+++ ,
{,, 
if.. 
(.. 
ticket.. 
... 
Status.. "
==..# %
TicketStatus..& 2
...2 3
Closed..3 9
||..: <
ticket..= C
...C D
	DueAmount..D M
<=..N P
Money..Q V
...V W
Zero..W [
(..[ \
)..\ ]
)..] ^
{// 
return00 
PayNowResult00 (
.00( )
Failure00) 0
(000 1
$str001 ^
)00^ _
;00_ `
}11 
}22 
var55 
userId55 
=55 
command55  
.55  !
ProcessedBy55! ,
;55, -
var66 

terminalId66 
=66 
command66 $
.66$ %

TerminalId66% /
;66/ 0
var88 
payment88 
=88 
Payment88 !
.88! "
Create88" (
(88( )
ticket99 
.99 
Id99 
,99 
PaymentType:: 
.:: 
Cash::  
,::  !
amountToPay;; 
,;; 
userId<< 
,<< 

terminalId== 
)>> 
;>> 
ticket@@ 
.@@ 

AddPayment@@ 
(@@ 
payment@@ %
)@@% &
;@@& '
ticketDD 
.DD 
CalculateTotalsDD "
(DD" #
)DD# $
;DD$ %
ifFF 
(FF 
ticketFF 
.FF 
	DueAmountFF  
<=FF! #
MoneyFF$ )
.FF) *
ZeroFF* .
(FF. /
)FF/ 0
)FF0 1
{GG 
ticketHH 
.HH 
CloseHH 
(HH 
userIdHH #
)HH# $
;HH$ %
}II 
awaitKK 
_ticketRepositoryKK #
.KK# $
UpdateAsyncKK$ /
(KK/ 0
ticketKK0 6
,KK6 7
cancellationTokenKK8 I
)KKI J
;KKJ K
varNN 
auditNN 
=NN 

AuditEventNN "
.NN" #
CreateNN# )
(NN) *
AuditEventTypeOO 
.OO 
PaymentProcessedOO /
,OO/ 0
nameofPP 
(PP 
TicketPP 
)PP 
,PP 
ticketQQ 
.QQ 
IdQQ 
,QQ 
userIdRR 
.RR 
ValueRR 
,RR 
SystemSS 
.SS 
TextSS 
.SS 
JsonSS  
.SS  !
JsonSerializerSS! /
.SS/ 0
	SerializeSS0 9
(SS9 :
newSS: =
{SS> ?
AmountSS@ F
=SSG H
amountToPaySSI T
.SST U
AmountSSU [
,SS[ \
ActionSS] c
=SSd e
$strSSf n
}SSo p
)SSp q
,SSq r
$"TT 
$strTT .
{TT. /
ticketTT/ 5
.TT5 6
TicketNumberTT6 B
}TTB C
"TTC D
)UU 
;UU 
awaitVV !
_auditEventRepositoryVV '
.VV' (
AddAsyncVV( 0
(VV0 1
auditVV1 6
,VV6 7
cancellationTokenVV8 I
)VVI J
;VVJ K
returnXX 
PayNowResultXX 
.XX  

SuccessfulXX  *
(XX* +
amountToPayXX+ 6
.XX6 7
AmountXX7 =
)XX= >
;XX> ?
}YY 	
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ 
{[[ 	
return]] 
PayNowResult]] 
.]]  
Failure]]  '
(]]' (
$"]]( *
$str]]* D
{]]D E
ex]]E G
.]]G H
Message]]H O
}]]O P
"]]P Q
)]]Q R
;]]R S
}^^ 	
}__ 
}`` ¡-
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\OpenCashSessionCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class )
OpenCashSessionCommandHandler *
:+ ,
ICommandHandler- <
<< ="
OpenCashSessionCommand= S
,S T!
OpenCashSessionResultU j
>j k
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
Domain 
. 
DomainServices *
.* +$
CashSessionDomainService+ C%
_cashSessionDomainServiceD ]
;] ^
public 
)
OpenCashSessionCommandHandler (
(( )"
ICashSessionRepository !
cashSessionRepository 4
,4 5!
IAuditEventRepository  
auditEventRepository 2
,2 3
Domain 
. 
DomainServices 
. $
CashSessionDomainService 6$
cashSessionDomainService7 O
)O P
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7!
_auditEventRepository 
=  
auditEventRepository  4
;4 5%
_cashSessionDomainService !
=" #$
cashSessionDomainService$ <
;< =
} 
public 

async 
Task 
< !
OpenCashSessionResult +
>+ ,
HandleAsync- 8
(8 9"
OpenCashSessionCommand9 O
commandP W
,W X
CancellationTokenY j
cancellationTokenk |
=} ~
default	 Ü
)
Ü á
{ 
var 
existingSession 
= 
await #"
_cashSessionRepository$ :
.: ;'
GetOpenSessionByUserIdAsync; V
(V W
command 
. 
UserId 
. 
Value  
,  !
cancellationToken   
)   
;   
if"" 

("" 
existingSession"" 
!="" 
null"" #
)""# $
{## 	
throw$$ 
new$$ 
Domain$$ 
.$$ 

Exceptions$$ '
.$$' (*
BusinessRuleViolationException$$( F
($$F G
$"%% 
$str%% 
{%% 
command%% 
.%%  
UserId%%  &
.%%& '
Value%%' ,
}%%, -
$str%%- P
{%%P Q
existingSession%%Q `
.%%` a
Id%%a c
}%%c d
$str%%d f
"%%f g
)%%g h
;%%h i
}&& 	
var)) 
cashSession)) 
=)) 
CashSession)) %
.))% &
Open))& *
())* +
command** 
.** 
UserId** 
,** 
command++ 
.++ 

TerminalId++ 
,++ 
command,, 
.,, 
ShiftId,, 
,,, 
command-- 
.-- 
OpeningBalance-- "
)--" #
;--# $
await00 "
_cashSessionRepository00 $
.00$ %
AddAsync00% -
(00- .
cashSession00. 9
,009 :
cancellationToken00; L
)00L M
;00M N
var33 
correlationId33 
=33 
Guid33  
.33  !
NewGuid33! (
(33( )
)33) *
;33* +
var44 

auditEvent44 
=44 

AuditEvent44 #
.44# $
Create44$ *
(44* +
AuditEventType55 
.55 
Created55 "
,55" #
nameof66 
(66 
CashSession66 
)66 
,66  
cashSession77 
.77 
Id77 
,77 
command88 
.88 
UserId88 
.88 
Value88  
,88  !
System99 
.99 
Text99 
.99 
Json99 
.99 
JsonSerializer99 +
.99+ ,
	Serialize99, 5
(995 6
new996 9
{:: 

TerminalId;; 
=;; 
command;; $
.;;$ %

TerminalId;;% /
,;;/ 0
ShiftId<< 
=<< 
command<< !
.<<! "
ShiftId<<" )
,<<) *
OpeningBalance== 
===  
command==! (
.==( )
OpeningBalance==) 7
.==7 8
Amount==8 >
}>> 
)>> 
,>> 
$"?? 
$str?? 7
{??7 8
command??8 ?
.??? @
OpeningBalance??@ N
}??N O
"??O P
,??P Q
correlationId@@ 
:@@ 
correlationId@@ (
)@@( )
;@@) *
awaitBB !
_auditEventRepositoryBB #
.BB# $
AddAsyncBB$ ,
(BB, -

auditEventBB- 7
,BB7 8
cancellationTokenBB9 J
)BBJ K
;BBK L
returnDD 
newDD !
OpenCashSessionResultDD (
{EE 	
CashSessionIdFF 
=FF 
cashSessionFF '
.FF' (
IdFF( *
,FF* +
OpenedAtGG 
=GG 
cashSessionGG "
.GG" #
OpenedAtGG# +
}HH 	
;HH	 

}II 
}JJ ê8
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ModifyOrderLineCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class )
ModifyOrderLineCommandHandler *
:+ ,
ICommandHandler- <
<< ="
ModifyOrderLineCommand= S
>S T
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
)
ModifyOrderLineCommandHandler (
(( )
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! ""
ModifyOrderLineCommand" 8
command9 @
,@ A
CancellationTokenB S
cancellationTokenT e
=f g
defaulth o
)o p
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI P
{P Q
commandQ X
.X Y
TicketIdY a
}a b
$strb m
"m n
)n o
;o p
}   	
var## 
	orderLine## 
=## 
ticket## 
.## 

OrderLines## )
.##) *
FirstOrDefault##* 8
(##8 9
ol##9 ;
=>##< >
ol##? A
.##A B
Id##B D
==##E G
command##H O
.##O P
OrderLineId##P [
)##[ \
;##\ ]
if$$ 

($$ 
	orderLine$$ 
==$$ 
null$$ 
)$$ 
{%% 	
throw&& 
new&& 
Domain&& 
.&& 

Exceptions&& '
.&&' (*
BusinessRuleViolationException&&( F
(&&F G
$"&&G I
$str&&I S
{&&S T
command&&T [
.&&[ \
OrderLineId&&\ g
}&&g h
$str&&h s
"&&s t
)&&t u
;&&u v
}'' 	
	orderLine** 
.** 
UpdateQuantity**  
(**  !
command**! (
.**( )
Quantity**) 1
)**1 2
;**2 3
if-- 

(-- 
command-- 
.-- 
Instructions--  
!=--! #
null--$ (
)--( )
{.. 	
	orderLine// 
.// 
SetInstructions// %
(//% &
command//& -
.//- .
Instructions//. :
)//: ;
;//; <
}00 	
if33 

(33 
command33 
.33 
	Modifiers33 
!=33  
null33! %
)33% &
{44 	
var55 
newModifiers55 
=55 
command55 &
.55& '
	Modifiers55' 0
.550 1
Select551 7
(557 8
m558 9
=>55: <
OrderLineModifier66 !
.66! "&
CreatePizzaSectionModifier66" <
(66< =
	orderLine77 
.77 
Id77  
,77  !
m88 
.88 

ModifierId88  
??88! #
Guid88$ (
.88( )
Empty88) .
,88. /
m99 
.99 
Name99 
,99 
m:: 
.:: 
ModifierType:: "
,::" #
m;; 
.;; 
	ItemCount;; 
,;;  
new<< 
Money<< 
(<< 
m<< 
.<<  
	UnitPrice<<  )
,<<) *
$str<<+ 0
)<<0 1
,<<1 2
new== 
Money== 
(== 
m== 
.==  
	UnitPrice==  )
,==) *
$str==+ 0
)==0 1
,==1 2
m>> 
.>> 
SectionName>> !
??>>" $
$str>>% ,
,>>, -
$str?? 
,?? 
m@@ 
.@@ 
TaxRate@@ 
)AA 
)AA 
.AA 
ToListAA 
(AA 
)AA 
;AA 
	orderLineCC 
.CC 
UpdateModifiersCC %
(CC% &
newModifiersCC& 2
)CC2 3
;CC3 4
}DD 	
ticketGG 
.GG 
CalculateTotalsGG 
(GG 
)GG  
;GG  !
awaitJJ 
_ticketRepositoryJJ 
.JJ  
UpdateAsyncJJ  +
(JJ+ ,
ticketJJ, 2
,JJ2 3
cancellationTokenJJ4 E
)JJE F
;JJF G
varMM 
correlationIdMM 
=MM 
GuidMM  
.MM  !
NewGuidMM! (
(MM( )
)MM) *
;MM* +
varNN 

auditEventNN 
=NN 

AuditEventNN #
.NN# $
CreateNN$ *
(NN* +
AuditEventTypeOO 
.OO 
ModifiedOO #
,OO# $
nameofPP 
(PP 
	OrderLinePP 
)PP 
,PP 
	orderLineQQ 
.QQ 
IdQQ 
,QQ 
GuidRR 
.RR 
EmptyRR 
,RR 
SystemSS 
.SS 
TextSS 
.SS 
JsonSS 
.SS 
JsonSerializerSS +
.SS+ ,
	SerializeSS, 5
(SS5 6
newSS6 9
{SS: ;
QuantitySS< D
=SSE F
	orderLineSSG P
.SSP Q
QuantitySSQ Y
,SSY Z
ActionSS[ a
=SSb c
$strSSd n
}SSo p
)SSp q
,SSq r
$"TT 
$strTT 
{TT 
commandTT !
.TT! "
OrderLineIdTT" -
}TT- .
$strTT. B
{TTB C
ticketTTC I
.TTI J
TicketNumberTTJ V
}TTV W
"TTW X
,TTX Y
correlationIdUU 
:UU 
correlationIdUU (
)UU( )
;UU) *
awaitWW !
_auditEventRepositoryWW #
.WW# $
AddAsyncWW$ ,
(WW, -

auditEventWW- 7
,WW7 8
cancellationTokenWW9 J
)WWJ K
;WWK L
}XX 
}YY Ï€
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ModifierCommandHandlers.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class .
"AddOrderLineModifierCommandHandler /
:0 1
ICommandHandler2 A
<A B'
AddOrderLineModifierCommandB ]
>] ^
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
PriceCalculator $
_priceCalculator% 5
;5 6
public 
.
"AddOrderLineModifierCommandHandler -
(- .
ITicketRepository 
ticketRepository *
,* +
IMenuRepository 
menuRepository &
,& '!
IAuditEventRepository  
auditEventRepository 2
,2 3
PriceCalculator 
priceCalculator '
)' (
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_menuRepository 
= 
menuRepository (
;( )!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
_priceCalculator   
=   
priceCalculator   *
;  * +
}!! 
public## 

async## 
Task## 
HandleAsync## !
(##! "'
AddOrderLineModifierCommand##" =
command##> E
,##E F
CancellationToken##G X
cancellationToken##Y j
=##k l
default##m t
)##t u
{$$ 
var&& 
ticket&& 
=&& 
await&& 
_ticketRepository&& ,
.&&, -
GetByIdAsync&&- 9
(&&9 :
command&&: A
.&&A B
TicketId&&B J
,&&J K
cancellationToken&&L ]
)&&] ^
;&&^ _
if'' 

('' 
ticket'' 
=='' 
null'' 
)'' 
throw(( 
new(( 
NotFoundException(( '
(((' (
$"((( *
$str((* 1
{((1 2
command((2 9
.((9 :
TicketId((: B
}((B C
$str((C N
"((N O
)((O P
;((P Q
if** 

(** 
ticket** 
.** 
Status** 
!=** 
TicketStatus** )
.**) *
Draft*** /
&&**0 2
ticket**3 9
.**9 :
Status**: @
!=**A C
TicketStatus**D P
.**P Q
Open**Q U
)**U V
throw++ 
new++ *
BusinessRuleViolationException++ 4
(++4 5
$str++5 g
)++g h
;++h i
var-- 
	orderLine-- 
=-- 
ticket-- 
.-- 

OrderLines-- )
.--) *
FirstOrDefault--* 8
(--8 9
ol--9 ;
=>--< >
ol--? A
.--A B
Id--B D
==--E G
command--H O
.--O P
OrderLineId--P [
)--[ \
;--\ ]
if.. 

(.. 
	orderLine.. 
==.. 
null.. 
).. 
throw// 
new// 
NotFoundException// '
(//' (
$"//( *
$str//* 4
{//4 5
command//5 <
.//< =
OrderLineId//= H
}//H I
$str//I ^
"//^ _
)//_ `
;//` a
var22 
modifier22 
=22 
await22 
_menuRepository22 ,
.22, - 
GetModifierByIdAsync22- A
(22A B
command22B I
.22I J

ModifierId22J T
,22T U
cancellationToken22V g
)22g h
;22h i
if33 

(33 
modifier33 
==33 
null33 
)33 
throw44 
new44 
NotFoundException44 '
(44' (
$"44( *
$str44* 3
{443 4
command444 ;
.44; <

ModifierId44< F
}44F G
$str44G R
"44R S
)44S T
;44T U
var77 
menuItem77 
=77 
await77 
_menuRepository77 ,
.77, -
GetByIdAsync77- 9
(779 :
	orderLine77: C
.77C D

MenuItemId77D N
,77N O
cancellationToken77P a
)77a b
;77b c
if88 

(88 
menuItem88 
==88 
null88 
)88 
throw99 
new99 
NotFoundException99 (
(99( )
$"99) +
$str99+ 4
{994 5
	orderLine995 >
.99> ?

MenuItemId99? I
}99I J
$str99J U
"99U V
)99V W
;99W X!
MenuItemModifierGroup<< 
?<< 
link<< #
=<<$ %
null<<& *
;<<* +
if== 

(== 
modifier== 
.== 
ModifierGroupId== $
.==$ %
HasValue==% -
)==- .
{>> 	
link?? 
=?? 
menuItem?? 
.?? 
ModifierGroups?? *
.??* +
FirstOrDefault??+ 9
(??9 :
g??: ;
=>??< >
g??? @
.??@ A
ModifierGroupId??A P
==??Q S
modifier??T \
.??\ ]
ModifierGroupId??] l
.??l m
Value??m r
)??r s
;??s t
if@@ 
(@@ 
link@@ 
==@@ 
null@@ 
)@@ 
throwAA 
newAA *
BusinessRuleViolationExceptionAA 8
(AA8 9
$"AA9 ;
$strAA; E
{AAE F
modifierAAF N
.AAN O
NameAAO S
}AAS T
$strAAT q
{AAq r
menuItemAAr z
.AAz {
NameAA{ 
}	AA Ä
$str
AAÄ Ç
"
AAÇ É
)
AAÉ Ñ
;
AAÑ Ö
varDD 
groupDD 
=DD 
linkDD 
.DD 
ModifierGroupDD *
;DD* +
varGG 
existingCountGG 
=GG 
	orderLineGG  )
.GG) *
	ModifiersGG* 3
.GG3 4
CountGG4 9
(GG9 :
mGG: ;
=>GG< >
mGG? @
.GG@ A
ModifierGroupIdGGA P
==GGQ S
groupGGT Y
.GGY Z
IdGGZ \
)GG\ ]
+HH 
	orderLineHH  )
.HH) *
AddOnsHH* 0
.HH0 1
CountHH1 6
(HH6 7
mHH7 8
=>HH9 ;
mHH< =
.HH= >
ModifierGroupIdHH> M
==HHN P
groupHHQ V
.HHV W
IdHHW Y
)HHY Z
;HHZ [
ifRR 
(RR 
existingCountRR 
+RR 
$numRR  !
>RR" #
groupRR$ )
.RR) *
MaxSelectionsRR* 7
)RR7 8
{SS 
throwTT 
newTT *
BusinessRuleViolationExceptionTT 8
(TT8 9
$"TT9 ;
$strTT; P
{TTP Q
groupTTQ V
.TTV W
MaxSelectionsTTW d
}TTd e
$strTTe x
{TTx y
groupTTy ~
.TT~ 
Name	TT É
}
TTÉ Ñ
$str
TTÑ Ü
"
TTÜ á
)
TTá à
;
TTà â
}UU 
}VV 	
elseWW 
{XX 	
}]] 	
varaa #
menuItemModifierGroupIdaa #
=aa$ %
linkaa& *
!=aa+ -
nullaa. 2
?aa3 4
(aa5 6
Guidaa6 :
?aa: ;
)aa; <
nullaa< @
:aaA B
nullaaC G
;aaG H
ifkk 

(kk 
commandkk 
.kk %
ParentOrderLineModifierIdkk -
.kk- .
HasValuekk. 6
)kk6 7
{ll 	
varmm 
parentModifiermm 
=mm  !
	orderLinemm" +
.mm+ ,
	Modifiersmm, 5
.mm5 6
FirstOrDefaultmm6 D
(mmD E
mmmE F
=>mmG I
mmmJ K
.mmK L
IdmmL N
==mmO Q
commandmmR Y
.mmY Z%
ParentOrderLineModifierIdmmZ s
.mms t
Valuemmt y
)mmy z
??nn  "
	orderLinenn# ,
.nn, -
AddOnsnn- 3
.nn3 4
FirstOrDefaultnn4 B
(nnB C
mnnC D
=>nnE G
mnnH I
.nnI J
IdnnJ L
==nnM O
commandnnP W
.nnW X%
ParentOrderLineModifierIdnnX q
.nnq r
Valuennr w
)nnw x
;nnx y
ifpp 
(pp 
parentModifierpp 
==pp  "
nullpp# '
)pp' (
throwqq 
newqq 
NotFoundExceptionqq ,
(qq, -
$"qq- /
$strqq/ ?
{qq? @
commandqq@ G
.qqG H%
ParentOrderLineModifierIdqqH a
}qqa b
$str	qqb Ä
"
qqÄ Å
)
qqÅ Ç
;
qqÇ É
}uu 	
varzz 
quantityzz 
=zz 
commandzz 
.zz 
Quantityzz '
>zz( )
$numzz* +
?zz, -
commandzz. 5
.zz5 6
Quantityzz6 >
:zz? @
$numzzA B
;zzB C
var{{ 
	itemCount{{ 
={{ 
({{ 
int{{ 
){{ 
Math{{ !
.{{! "
Ceiling{{" )
({{) *
quantity{{* 2
){{2 3
;{{3 4
Money}} 
finalUnitPrice}} 
;}} 
decimal~~ 
portionValue~~ 
=~~ 
$num~~ #
;~~# $
PriceStrategy 
? 
priceStrategy $
=% &
null' +
;+ ,
if
ÅÅ 

(
ÅÅ 
modifier
ÅÅ 
is
ÅÅ  
FractionalModifier
ÅÅ *

fractional
ÅÅ+ 5
)
ÅÅ5 6
{
ÇÇ 	
priceStrategy
ää 
=
ää 

fractional
ää '
.
ää' (
PriceStrategy
ää( 5
;
ää5 6
portionValue
éé 
=
éé 
quantity
éé $
;
éé$ %
}
èè 	
if
ëë 

(
ëë 
quantity
ëë 
<
ëë 
$num
ëë 
)
ëë 
{
íí 	
finalUnitPrice
îî 
=
îî 
modifier
îî &
.
îî& '
	BasePrice
îî' 0
*
îî1 2
quantity
îî3 ;
;
îî; <
}
ïï 	
else
ññ 
{
óó 	
finalUnitPrice
ôô 
=
ôô 
modifier
ôô &
.
ôô& '
	BasePrice
ôô' 0
;
ôô0 1
portionValue
öö 
=
öö 
$num
öö  
;
öö  !
}
õõ 	
var
ùù 
newModifier
ùù 
=
ùù 
OrderLineModifier
ùù +
.
ùù+ ,
Create
ùù, 2
(
ùù2 3
	orderLine
ûû 
.
ûû 
Id
ûû 
,
ûû 
modifier
üü 
.
üü 
Id
üü 
,
üü 
modifier
†† 
.
†† 
Name
†† 
,
†† 
modifier
°° 
.
°° 
ModifierType
°° !
,
°°! "
	itemCount
¢¢ 
,
¢¢ 
finalUnitPrice
££ 
,
££ 
modifier
§§ 
.
§§ 
	BasePrice
§§ 
,
§§ 
portionValue
•• 
,
•• 
modifier
¶¶ 
.
¶¶ 
TaxRate
¶¶ 
,
¶¶ 
null
ßß 
,
ßß 
modifier
®® 
.
®® 
ModifierGroupId
®® $
,
®®$ %
modifier
©© 
.
©© "
ShouldPrintToKitchen
©© )
,
©©) *
command
™™ 
.
™™ 
SectionName
™™ 
,
™™  
null
´´ 
,
´´ 
modifier
¨¨ 
.
¨¨  
IsSectionWisePrice
¨¨ '
,
¨¨' (
command
≠≠ 
.
≠≠ '
ParentOrderLineModifierId
≠≠ -
,
≠≠- .
priceStrategy
ÆÆ 
)
ØØ 	
;
ØØ	 

	orderLine
±± 
.
±± 
AddModifier
±± 
(
±± 
newModifier
±± )
)
±±) *
;
±±* +
if
¥¥ 

(
¥¥ 
priceStrategy
¥¥ 
.
¥¥ 
HasValue
¥¥ "
&&
¥¥# %
newModifier
¥¥& 1
.
¥¥1 2 
IsSectionWisePrice
¥¥2 D
)
¥¥D E
{
µµ 	
_priceCalculator
∑∑ 
.
∑∑ )
RecalculateFractionalPrices
∑∑ 9
(
∑∑9 :
	orderLine
∑∑: C
.
∑∑C D
	Modifiers
∑∑D M
.
∑∑M N
ToList
∑∑N T
(
∑∑T U
)
∑∑U V
,
∑∑V W
priceStrategy
∑∑X e
.
∑∑e f
Value
∑∑f k
)
∑∑k l
;
∑∑l m
}
∏∏ 	
await
ªª 
_ticketRepository
ªª 
.
ªª  
UpdateAsync
ªª  +
(
ªª+ ,
ticket
ªª, 2
,
ªª2 3
cancellationToken
ªª4 E
)
ªªE F
;
ªªF G
await
ææ #
_auditEventRepository
ææ #
.
ææ# $
AddAsync
ææ$ ,
(
ææ, -

AuditEvent
ææ- 7
.
ææ7 8
Create
ææ8 >
(
ææ> ?
AuditEventType
øø 
.
øø 
Modified
øø #
,
øø# $
nameof
¿¿ 
(
¿¿ 
Ticket
¿¿ 
)
¿¿ 
,
¿¿ 
ticket
¡¡ 
.
¡¡ 
Id
¡¡ 
,
¡¡ 
command
¬¬ 
.
¬¬ 
AddedBy
¬¬ 
?
¬¬ 
.
¬¬ 
Value
¬¬ "
??
¬¬# %
Guid
¬¬& *
.
¬¬* +
Empty
¬¬+ 0
,
¬¬0 1
System
√√ 
.
√√ 
Text
√√ 
.
√√ 
Json
√√ 
.
√√ 
JsonSerializer
√√ +
.
√√+ ,
	Serialize
√√, 5
(
√√5 6
new
√√6 9
{
√√: ;
OrderLineId
ƒƒ 
=
ƒƒ 
	orderLine
ƒƒ '
.
ƒƒ' (
Id
ƒƒ( *
,
ƒƒ* +

ModifierId
≈≈ 
=
≈≈ 
modifier
≈≈ %
.
≈≈% &
Id
≈≈& (
,
≈≈( )
Name
∆∆ 
=
∆∆ 
modifier
∆∆ 
.
∆∆  
Name
∆∆  $
}
«« 
)
«« 
,
«« 
$"
»» 
$str
»» 
{
»» 
modifier
»» '
.
»»' (
Name
»»( ,
}
»», -
$str
»»- 3
{
»»3 4
	orderLine
»»4 =
.
»»= >
MenuItemName
»»> J
}
»»J K
$str
»»K L
"
»»L M
,
»»M N
null
…… 
,
…… 
Guid
   
.
   
NewGuid
   
(
   
)
   
)
ÀÀ 	
,
ÀÀ	 

cancellationToken
ÀÀ 
)
ÀÀ 
;
ÀÀ 
}
ÃÃ 
}ÕÕ 
publicœœ 
class
œœ 3
%RemoveOrderLineModifierCommandHandler
œœ 2
:
œœ3 4
ICommandHandler
œœ5 D
<
œœD E,
RemoveOrderLineModifierCommand
œœE c
>
œœc d
{–– 
private
—— 
readonly
—— 
ITicketRepository
—— &
_ticketRepository
——' 8
;
——8 9
private
““ 
readonly
““ #
IAuditEventRepository
““ *#
_auditEventRepository
““+ @
;
““@ A
public
‘‘ 
3
%RemoveOrderLineModifierCommandHandler
‘‘ 0
(
‘‘0 1
ITicketRepository
’’ 
ticketRepository
’’ *
,
’’* +#
IAuditEventRepository
÷÷ "
auditEventRepository
÷÷ 2
)
÷÷2 3
{
◊◊ 
_ticketRepository
ÿÿ 
=
ÿÿ 
ticketRepository
ÿÿ ,
;
ÿÿ, -#
_auditEventRepository
ŸŸ 
=
ŸŸ "
auditEventRepository
ŸŸ  4
;
ŸŸ4 5
}
⁄⁄ 
public
‹‹ 

async
‹‹ 
Task
‹‹ 
HandleAsync
‹‹ !
(
‹‹! ",
RemoveOrderLineModifierCommand
‹‹" @
command
‹‹A H
,
‹‹H I
CancellationToken
‹‹J [
cancellationToken
‹‹\ m
=
‹‹n o
default
‹‹p w
)
‹‹w x
{
›› 
var
ﬁﬁ 
ticket
ﬁﬁ 
=
ﬁﬁ 
await
ﬁﬁ 
_ticketRepository
ﬁﬁ ,
.
ﬁﬁ, -
GetByIdAsync
ﬁﬁ- 9
(
ﬁﬁ9 :
command
ﬁﬁ: A
.
ﬁﬁA B
TicketId
ﬁﬁB J
,
ﬁﬁJ K
cancellationToken
ﬁﬁL ]
)
ﬁﬁ] ^
;
ﬁﬁ^ _
if
ﬂﬂ 

(
ﬂﬂ 
ticket
ﬂﬂ 
==
ﬂﬂ 
null
ﬂﬂ 
)
ﬂﬂ 
throw
‡‡ 
new
‡‡ 
NotFoundException
‡‡ '
(
‡‡' (
$"
‡‡( *
$str
‡‡* 1
{
‡‡1 2
command
‡‡2 9
.
‡‡9 :
TicketId
‡‡: B
}
‡‡B C
$str
‡‡C N
"
‡‡N O
)
‡‡O P
;
‡‡P Q
if
‚‚ 

(
‚‚ 
ticket
‚‚ 
.
‚‚ 
Status
‚‚ 
!=
‚‚ 
TicketStatus
‚‚ )
.
‚‚) *
Draft
‚‚* /
&&
‚‚0 2
ticket
‚‚3 9
.
‚‚9 :
Status
‚‚: @
!=
‚‚A C
TicketStatus
‚‚D P
.
‚‚P Q
Open
‚‚Q U
)
‚‚U V
throw
„„ 
new
„„ ,
BusinessRuleViolationException
„„ 4
(
„„4 5
$str
„„5 l
)
„„l m
;
„„m n
var
ÂÂ 
	orderLine
ÂÂ 
=
ÂÂ 
ticket
ÂÂ 
.
ÂÂ 

OrderLines
ÂÂ )
.
ÂÂ) *
FirstOrDefault
ÂÂ* 8
(
ÂÂ8 9
ol
ÂÂ9 ;
=>
ÂÂ< >
ol
ÂÂ? A
.
ÂÂA B
Id
ÂÂB D
==
ÂÂE G
command
ÂÂH O
.
ÂÂO P
OrderLineId
ÂÂP [
)
ÂÂ[ \
;
ÂÂ\ ]
if
ÊÊ 

(
ÊÊ 
	orderLine
ÊÊ 
==
ÊÊ 
null
ÊÊ 
)
ÊÊ 
throw
ÁÁ 
new
ÁÁ 
NotFoundException
ÁÁ '
(
ÁÁ' (
$"
ÁÁ( *
$str
ÁÁ* 4
{
ÁÁ4 5
command
ÁÁ5 <
.
ÁÁ< =
OrderLineId
ÁÁ= H
}
ÁÁH I
$str
ÁÁI ^
"
ÁÁ^ _
)
ÁÁ_ `
;
ÁÁ` a
var
ÈÈ 
modifier
ÈÈ 
=
ÈÈ 
	orderLine
ÈÈ  
.
ÈÈ  !
	Modifiers
ÈÈ! *
.
ÈÈ* +
FirstOrDefault
ÈÈ+ 9
(
ÈÈ9 :
m
ÈÈ: ;
=>
ÈÈ< >
m
ÈÈ? @
.
ÈÈ@ A
Id
ÈÈA C
==
ÈÈD F
command
ÈÈG N
.
ÈÈN O!
OrderLineModifierId
ÈÈO b
)
ÈÈb c
??
ÍÍ 
	orderLine
ÍÍ  
.
ÍÍ  !
AddOns
ÍÍ! '
.
ÍÍ' (
FirstOrDefault
ÍÍ( 6
(
ÍÍ6 7
m
ÍÍ7 8
=>
ÍÍ9 ;
m
ÍÍ< =
.
ÍÍ= >
Id
ÍÍ> @
==
ÍÍA C
command
ÍÍD K
.
ÍÍK L!
OrderLineModifierId
ÍÍL _
)
ÍÍ_ `
;
ÍÍ` a
if
ÏÏ 

(
ÏÏ 
modifier
ÏÏ 
==
ÏÏ 
null
ÏÏ 
)
ÏÏ 
throw
ÌÌ 
new
ÌÌ 
NotFoundException
ÌÌ '
(
ÌÌ' (
$"
ÌÌ( *
$str
ÌÌ* 3
{
ÌÌ3 4
command
ÌÌ4 ;
.
ÌÌ; <!
OrderLineModifierId
ÌÌ< O
}
ÌÌO P
$str
ÌÌP i
"
ÌÌi j
)
ÌÌj k
;
ÌÌk l
	orderLine
ÔÔ 
.
ÔÔ 
RemoveModifier
ÔÔ  
(
ÔÔ  !
modifier
ÔÔ! )
)
ÔÔ) *
;
ÔÔ* +
await
˚˚ 
_ticketRepository
˚˚ 
.
˚˚  
UpdateAsync
˚˚  +
(
˚˚+ ,
ticket
˚˚, 2
,
˚˚2 3
cancellationToken
˚˚4 E
)
˚˚E F
;
˚˚F G
await
˝˝ #
_auditEventRepository
˝˝ #
.
˝˝# $
AddAsync
˝˝$ ,
(
˝˝, -

AuditEvent
˝˝- 7
.
˝˝7 8
Create
˝˝8 >
(
˝˝> ?
AuditEventType
˛˛ 
.
˛˛ 
Modified
˛˛ #
,
˛˛# $
nameof
ˇˇ 
(
ˇˇ 
Ticket
ˇˇ 
)
ˇˇ 
,
ˇˇ 
ticket
ÄÄ 
.
ÄÄ 
Id
ÄÄ 
,
ÄÄ 
command
ÅÅ 
.
ÅÅ 
	RemovedBy
ÅÅ 
?
ÅÅ 
.
ÅÅ 
Value
ÅÅ $
??
ÅÅ% '
Guid
ÅÅ( ,
.
ÅÅ, -
Empty
ÅÅ- 2
,
ÅÅ2 3
System
ÇÇ 
.
ÇÇ 
Text
ÇÇ 
.
ÇÇ 
Json
ÇÇ 
.
ÇÇ 
JsonSerializer
ÇÇ +
.
ÇÇ+ ,
	Serialize
ÇÇ, 5
(
ÇÇ5 6
new
ÇÇ6 9
{
ÇÇ: ;
OrderLineId
ÉÉ 
=
ÉÉ 
	orderLine
ÉÉ '
.
ÉÉ' (
Id
ÉÉ( *
,
ÉÉ* +

ModifierId
ÑÑ 
=
ÑÑ 
modifier
ÑÑ %
.
ÑÑ% &

ModifierId
ÑÑ& 0
,
ÑÑ0 1
Name
ÖÖ 
=
ÖÖ 
modifier
ÖÖ 
.
ÖÖ  
Name
ÖÖ  $
}
ÜÜ 
)
ÜÜ 
,
ÜÜ 
$"
áá 
$str
áá  
{
áá  !
modifier
áá! )
.
áá) *
Name
áá* .
}
áá. /
$str
áá/ 7
{
áá7 8
	orderLine
áá8 A
.
ááA B
MenuItemName
ááB N
}
ááN O
$str
ááO P
"
ááP Q
,
ááQ R
null
àà 
,
àà 
Guid
ââ 
.
ââ 
NewGuid
ââ 
(
ââ 
)
ââ 
)
ää 	
,
ää	 

cancellationToken
ää 
)
ää 
;
ää 
}
ãã 
}åå 
publicéé 
class
éé 3
%AddOrderLineInstructionCommandHandler
éé 2
:
éé3 4
ICommandHandler
éé5 D
<
ééD E,
AddOrderLineInstructionCommand
ééE c
>
ééc d
{èè 
private
êê 
readonly
êê 
ITicketRepository
êê &
_ticketRepository
êê' 8
;
êê8 9
private
ëë 
readonly
ëë #
IAuditEventRepository
ëë *#
_auditEventRepository
ëë+ @
;
ëë@ A
public
ìì 
3
%AddOrderLineInstructionCommandHandler
ìì 0
(
ìì0 1
ITicketRepository
îî 
ticketRepository
îî *
,
îî* +#
IAuditEventRepository
ïï "
auditEventRepository
ïï 2
)
ïï2 3
{
ññ 
_ticketRepository
óó 
=
óó 
ticketRepository
óó ,
;
óó, -#
_auditEventRepository
òò 
=
òò "
auditEventRepository
òò  4
;
òò4 5
}
ôô 
public
õõ 

async
õõ 
Task
õõ 
HandleAsync
õõ !
(
õõ! ",
AddOrderLineInstructionCommand
õõ" @
command
õõA H
,
õõH I
CancellationToken
õõJ [
cancellationToken
õõ\ m
=
õõn o
default
õõp w
)
õõw x
{
úú 
var
ùù 
ticket
ùù 
=
ùù 
await
ùù 
_ticketRepository
ùù ,
.
ùù, -
GetByIdAsync
ùù- 9
(
ùù9 :
command
ùù: A
.
ùùA B
TicketId
ùùB J
,
ùùJ K
cancellationToken
ùùL ]
)
ùù] ^
;
ùù^ _
if
ûû 

(
ûû 
ticket
ûû 
==
ûû 
null
ûû 
)
ûû 
throw
üü 
new
üü 
NotFoundException
üü '
(
üü' (
$"
üü( *
$str
üü* 1
{
üü1 2
command
üü2 9
.
üü9 :
TicketId
üü: B
}
üüB C
$str
üüC N
"
üüN O
)
üüO P
;
üüP Q
if
°° 

(
°° 
ticket
°° 
.
°° 
Status
°° 
!=
°° 
TicketStatus
°° )
.
°°) *
Draft
°°* /
&&
°°0 2
ticket
°°3 9
.
°°9 :
Status
°°: @
!=
°°A C
TicketStatus
°°D P
.
°°P Q
Open
°°Q U
)
°°U V
throw
¢¢ 
new
¢¢ ,
BusinessRuleViolationException
¢¢ 4
(
¢¢4 5
$str
¢¢5 j
)
¢¢j k
;
¢¢k l
var
§§ 
	orderLine
§§ 
=
§§ 
ticket
§§ 
.
§§ 

OrderLines
§§ )
.
§§) *
FirstOrDefault
§§* 8
(
§§8 9
ol
§§9 ;
=>
§§< >
ol
§§? A
.
§§A B
Id
§§B D
==
§§E G
command
§§H O
.
§§O P
OrderLineId
§§P [
)
§§[ \
;
§§\ ]
if
•• 

(
•• 
	orderLine
•• 
==
•• 
null
•• 
)
•• 
throw
¶¶ 
new
¶¶ 
NotFoundException
¶¶ '
(
¶¶' (
$"
¶¶( *
$str
¶¶* 4
{
¶¶4 5
command
¶¶5 <
.
¶¶< =
OrderLineId
¶¶= H
}
¶¶H I
$str
¶¶I ^
"
¶¶^ _
)
¶¶_ `
;
¶¶` a
var
®® !
instructionModifier
®® 
=
®®  !
OrderLineModifier
®®" 3
.
®®3 4
CreateInstruction
®®4 E
(
®®E F
	orderLine
©© 
.
©© 
Id
©© 
,
©© 
command
™™ 
.
™™ 
Instruction
™™ 
)
´´ 	
;
´´	 

	orderLine
≠≠ 
.
≠≠ 
AddModifier
≠≠ 
(
≠≠ !
instructionModifier
≠≠ 1
)
≠≠1 2
;
≠≠2 3
await
ØØ 
_ticketRepository
ØØ 
.
ØØ  
UpdateAsync
ØØ  +
(
ØØ+ ,
ticket
ØØ, 2
,
ØØ2 3
cancellationToken
ØØ4 E
)
ØØE F
;
ØØF G
await
±± #
_auditEventRepository
±± #
.
±±# $
AddAsync
±±$ ,
(
±±, -

AuditEvent
±±- 7
.
±±7 8
Create
±±8 >
(
±±> ?
AuditEventType
≤≤ 
.
≤≤ 
Modified
≤≤ #
,
≤≤# $
nameof
≥≥ 
(
≥≥ 
Ticket
≥≥ 
)
≥≥ 
,
≥≥ 
ticket
¥¥ 
.
¥¥ 
Id
¥¥ 
,
¥¥ 
command
µµ 
.
µµ 
AddedBy
µµ 
?
µµ 
.
µµ 
Value
µµ "
??
µµ# %
Guid
µµ& *
.
µµ* +
Empty
µµ+ 0
,
µµ0 1
System
∂∂ 
.
∂∂ 
Text
∂∂ 
.
∂∂ 
Json
∂∂ 
.
∂∂ 
JsonSerializer
∂∂ +
.
∂∂+ ,
	Serialize
∂∂, 5
(
∂∂5 6
new
∂∂6 9
{
∂∂: ;
OrderLineId
∑∑ 
=
∑∑ 
	orderLine
∑∑ '
.
∑∑' (
Id
∑∑( *
,
∑∑* +
Instruction
∏∏ 
=
∏∏ 
command
∏∏ %
.
∏∏% &
Instruction
∏∏& 1
}
ππ 
)
ππ 
,
ππ 
$"
∫∫ 
$str
∫∫ !
{
∫∫! "
command
∫∫" )
.
∫∫) *
Instruction
∫∫* 5
}
∫∫5 6
$str
∫∫6 <
{
∫∫< =
	orderLine
∫∫= F
.
∫∫F G
MenuItemName
∫∫G S
}
∫∫S T
$str
∫∫T U
"
∫∫U V
,
∫∫V W
null
ªª 
,
ªª 
Guid
ºº 
.
ºº 
NewGuid
ºº 
(
ºº 
)
ºº 
)
ΩΩ 	
,
ΩΩ	 

cancellationToken
ΩΩ 
)
ΩΩ 
;
ΩΩ 
}
ææ 
}øø ‘N
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\MergeTicketsCommandHandler.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
;

' (
public 
class &
MergeTicketsCommandHandler '
:( )
ICommandHandler* 9
<9 :
MergeTicketsCommand: M
>M N
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
&
MergeTicketsCommandHandler %
(% &
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! "
MergeTicketsCommand" 5
command6 =
,= >
CancellationToken? P
cancellationTokenQ b
=c d
defaulte l
)l m
{ 
var 
sourceTicket 
= 
await  
_ticketRepository! 2
.2 3
GetByIdAsync3 ?
(? @
command@ G
.G H
SourceTicketIdH V
,V W
cancellationTokenX i
)i j
;j k
var 
targetTicket 
= 
await  
_ticketRepository! 2
.2 3
GetByIdAsync3 ?
(? @
command@ G
.G H
TargetTicketIdH V
,V W
cancellationTokenX i
)i j
;j k
if 

( 
sourceTicket 
== 
null  
)  !
throw" '
new( +
Domain, 2
.2 3

Exceptions3 =
.= >
NotFoundException> O
(O P
$"P R
$strR `
{` a
commanda h
.h i
SourceTicketIdi w
}w x
$str	x Ç
"
Ç É
)
É Ñ
;
Ñ Ö
if 

( 
targetTicket 
== 
null  
)  !
throw" '
new( +
Domain, 2
.2 3

Exceptions3 =
.= >
NotFoundException> O
(O P
$"P R
$strR `
{` a
commanda h
.h i
TargetTicketIdi w
}w x
$str	x Ç
"
Ç É
)
É Ñ
;
Ñ Ö
if!! 

(!! 
sourceTicket!! 
.!! 
Status!! 
==!!  "
TicketStatus!!# /
.!!/ 0
Closed!!0 6
||!!7 9
sourceTicket!!: F
.!!F G
Status!!G M
==!!N P
TicketStatus!!Q ]
.!!] ^
Voided!!^ d
)!!d e
{"" 	
throw## 
new## 
Domain## 
.## 

Exceptions## '
.##' (*
BusinessRuleViolationException##( F
(##F G
$str##G p
)##p q
;##q r
}$$ 	
if&& 

(&& 
targetTicket&& 
.&& 
Status&& 
==&&  "
TicketStatus&&# /
.&&/ 0
Closed&&0 6
||&&7 9
targetTicket&&: F
.&&F G
Status&&G M
==&&N P
TicketStatus&&Q ]
.&&] ^
Voided&&^ d
)&&d e
{'' 	
throw(( 
new(( 
Domain(( 
.(( 

Exceptions(( (
.((( )*
BusinessRuleViolationException(() G
(((G H
$str((H v
)((v w
;((w x
})) 	
foreach,, 
(,, 
var,, 
line,, 
in,, 
sourceTicket,, )
.,,) *

OrderLines,,* 4
),,4 5
{-- 	
var.. 
newLine.. 
=.. 
	OrderLine.. #
...# $
Create..$ *
(..* +
targetTicket// 
.// 
Id// 
,//  
line00 
.00 

MenuItemId00 
,00  
line11 
.11 
MenuItemName11 !
,11! "
line22 
.22 
Quantity22 
,22 
line33 
.33 
	UnitPrice33 
,33 
line44 
.44 
TaxRate44 
,44 
line55 
.55 
CategoryName55 !
,55! "
line66 
.66 
	GroupName66 
)77 
;77 
foreach:: 
(:: 
var:: 
mod:: 
in:: 
line::  $
.::$ %
	Modifiers::% .
)::. /
{;; 
var<< 
newMod<< 
=<< 
OrderLineModifier<< /
.<</ 0
Create<<0 6
(<<6 7
orderLineId==  
:==  !
newLine==" )
.==) *
Id==* ,
,==, -

modifierId>> 
:>>  
mod>>! $
.>>$ %

ModifierId>>% /
,>>/ 0
name?? 
:?? 
mod?? 
.?? 
Name?? #
,??# $
modifierType@@ !
:@@! "
mod@@# &
.@@& '
ModifierType@@' 3
,@@3 4
	itemCountAA 
:AA 
modAA  #
.AA# $
	ItemCountAA$ -
,AA- .
	unitPriceBB 
:BB 
modBB  #
.BB# $
	UnitPriceBB$ -
,BB- .
	basePriceCC 
:CC 
modCC  #
.CC# $
	BasePriceCC$ -
,CC- .
portionValueDD !
:DD! "
modDD# &
.DD& '
PortionValueDD' 3
,DD3 4
taxRateEE 
:EE 
modEE !
.EE! "
TaxRateEE" )
,EE) *#
menuItemModifierGroupIdFF ,
:FF, -
modFF. 1
.FF1 2#
MenuItemModifierGroupIdFF2 I
,FFI J
modifierGroupIdGG $
:GG$ %
modGG& )
.GG) *
ModifierGroupIdGG* 9
,GG9 : 
shouldPrintToKitchenHH )
:HH) *
modHH+ .
.HH. / 
ShouldPrintToKitchenHH/ C
,HHC D
sectionNameII  
:II  !
modII" %
.II% &
SectionNameII& 1
,II1 2
multiplierNameJJ #
:JJ# $
modJJ% (
.JJ( )
MultiplierNameJJ) 7
,JJ7 8
isSectionWisePriceKK '
:KK' (
modKK) ,
.KK, -
IsSectionWisePriceKK- ?
,KK? @%
parentOrderLineModifierIdLL .
:LL. /
nullLL0 4
,LL4 5
priceStrategyMM "
:MM" #
modMM$ '
.MM' (
PriceStrategyMM( 5
)NN 
;NN 
newLineOO 
.OO 
AddModifierOO $
(OO$ %
newModOO% +
)OO+ ,
;OO, -
}PP 
newLineSS 
.SS 
SetInstructionsSS #
(SS# $
lineSS$ (
.SS( )
InstructionsSS) 5
)SS5 6
;SS6 7
newLineVV 
.VV 
SetSeatNumberVV !
(VV! "
lineVV" &
.VV& '

SeatNumberVV' 1
)VV1 2
;VV2 3
targetTicketXX 
.XX 
AddOrderLineXX %
(XX% &
newLineXX& -
)XX- .
;XX. /
}YY 	
sourceTicket\\ 
.\\ 
Void\\ 
(\\ 
command\\ !
.\\! "
ProcessedBy\\" -
,\\- .
$"\\/ 1
$str\\1 E
{\\E F
targetTicket\\F R
.\\R S
TicketNumber\\S _
}\\_ `
"\\` a
,\\a b
false\\c h
)\\h i
;\\i j
await^^ 
_ticketRepository^^ 
.^^  
UpdateAsync^^  +
(^^+ ,
sourceTicket^^, 8
,^^8 9
cancellationToken^^: K
)^^K L
;^^L M
await__ 
_ticketRepository__ 
.__  
UpdateAsync__  +
(__+ ,
targetTicket__, 8
,__8 9
cancellationToken__: K
)__K L
;__L M
awaitaa !
_auditEventRepositoryaa #
.aa# $
AddAsyncaa$ ,
(aa, -

AuditEventaa- 7
.aa7 8
Createaa8 >
(aa> ?
	eventTypebb 
:bb 
AuditEventTypebb %
.bb% &
TicketMergedbb& 2
,bb2 3

entityTypecc 
:cc 
nameofcc 
(cc 
Ticketcc %
)cc% &
,cc& '
entityIddd 
:dd 
targetTicketdd "
.dd" #
Iddd# %
,dd% &
userIdee 
:ee 
commandee 
.ee 
ProcessedByee '
,ee' (

afterStateff 
:ff 
@$"ff 
$strff 3
{ff3 4
sourceTicketff4 @
.ff@ A
IdffA C
}ffC D
$strffD ^
{ff^ _
targetTicketff_ k
.ffk l
Idffl n
}ffn o
$strffo s
"ffs t
,fft u
descriptiongg 
:gg 
$"gg 
$strgg *
{gg* +
sourceTicketgg+ 7
.gg7 8
TicketNumbergg8 D
}ggD E
$strggE S
{ggS T
targetTicketggT `
.gg` a
TicketNumbergga m
}ggm n
"ggn o
)hh 	
,hh	 

cancellationTokenhh 
)hh 
;hh 
}ii 
}jj ü(
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\MerchantBatchService.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

  
MerchantBatchService

 !
:

" #!
IMerchantBatchService

$ 9
{ 
private 
readonly #
IPaymentBatchRepository ,#
_paymentBatchRepository- D
;D E
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly 
IPaymentGateway $
_paymentGateway% 4
;4 5
public 
 
MerchantBatchService 
(  #
IPaymentBatchRepository "
paymentBatchRepository  6
,6 7
IPaymentRepository 
paymentRepository ,
,, -
IPaymentGateway 
paymentGateway &
)& '
{ #
_paymentBatchRepository 
=  !"
paymentBatchRepository" 8
;8 9
_paymentRepository 
= 
paymentRepository .
;. /
_paymentGateway 
= 
paymentGateway (
;( )
} 
public 

async 
Task 
< 
PaymentBatch "
>" #
OpenBatchAsync$ 2
(2 3
Guid3 7

terminalId8 B
)B C
{ 
var 
activeBatch 
= 
await #
_paymentBatchRepository  7
.7 8)
GetOpenBatchByTerminalIdAsync8 U
(U V

terminalIdV `
)` a
;a b
if 

( 
activeBatch 
!= 
null 
)  
{ 	
return 
activeBatch 
; 
}   	
var"" 
newBatch"" 
="" 
new"" 
PaymentBatch"" '
(""' (

terminalId""( 2
)""2 3
;""3 4
await## #
_paymentBatchRepository## %
.##% &
AddAsync##& .
(##. /
newBatch##/ 7
)##7 8
;##8 9
return$$ 
newBatch$$ 
;$$ 
}%% 
public'' 

async'' 
Task'' 
<'' 
PaymentBatch'' "
>''" #
CloseBatchAsync''$ 3
(''3 4
Guid''4 8

terminalId''9 C
,''C D
UserId''E K
closedBy''L T
)''T U
{(( 
var** 
batch** 
=** 
await** #
_paymentBatchRepository** 1
.**1 2)
GetOpenBatchByTerminalIdAsync**2 O
(**O P

terminalId**P Z
)**Z [
;**[ \
if++ 

(++ 
batch++ 
==++ 
null++ 
)++ 
{,, 	
batch.. 
=.. 
new.. 
PaymentBatch.. $
(..$ %

terminalId..% /
)../ 0
;..0 1
await// #
_paymentBatchRepository// )
.//) *
AddAsync//* 2
(//2 3
batch//3 8
)//8 9
;//9 :
}00 	
var33 
paymentsDetails33 
=33 
await33 #
_paymentRepository33$ 6
.336 7-
!GetUnbatchedCapturedPaymentsAsync337 X
(33X Y

terminalId33Y c
)33c d
;33d e
var77 
gatewayResult77 
=77 
await77 !
_paymentGateway77" 1
.771 2
CloseBatchAsync772 A
(77A B

terminalId77B L
)77L M
;77M N
if99 

(99 
!99 
gatewayResult99 
.99 
Success99 "
)99" #
{:: 	
throw;; 
new;; 
	Exception;; 
(;;  
$";;  "
$str;;" >
{;;> ?
gatewayResult;;? L
.;;L M
ErrorMessage;;M Y
};;Y Z
";;Z [
);;[ \
;;;\ ]
}<< 	
batch?? 
.?? 
Close?? 
(?? 
gatewayResult?? !
.??! "
GatewayBatchId??" 0
)??0 1
;??1 2
await@@ #
_paymentBatchRepository@@ %
.@@% &
UpdateAsync@@& 1
(@@1 2
batch@@2 7
)@@7 8
;@@8 9
foreachCC 
(CC 
varCC 
paymentCC 
inCC 
paymentsDetailsCC  /
)CC/ 0
{DD 	
paymentEE 
.EE 

SetBatchIdEE 
(EE 
batchEE $
.EE$ %
IdEE% '
)EE' (
;EE( )
awaitHH 
_paymentRepositoryHH $
.HH$ %
UpdateAsyncHH% 0
(HH0 1
paymentHH1 8
)HH8 9
;HH9 :
}II 	
returnKK 
batchKK 
;KK 
}LL 
}MM µ
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\LogoutCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class  
LogoutCommandHandler !
:" #
ICommandHandler$ 3
<3 4
LogoutCommand4 A
>A B
{		 
private

 
readonly

 !
IAuditEventRepository

 *!
_auditEventRepository

+ @
;

@ A
public 
 
LogoutCommandHandler 
(  !
IAuditEventRepository  5 
auditEventRepository6 J
)J K
{ !
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! "
LogoutCommand" /
command0 7
,7 8
CancellationToken9 J
cancellationTokenK \
=] ^
default_ f
)f g
{ 
var 
audit 
= 

AuditEvent 
. 
Create %
(% &
AuditEventType 
. 
StatusChanged (
,( )
$str 
, 
command 
. 
UserId 
, 
command 
. 
UserId 
, 
$str 
, 
$" 
$str 
{ 
command 
. 
UserId "
}" #
$str# .
". /
) 	
;	 

await !
_auditEventRepository #
.# $
AddAsync$ ,
(, -
audit- 2
,2 3
cancellationToken4 E
)E F
;F G
} 
} ü
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\KitchenStatusService.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class  
KitchenStatusService !
:" #!
IKitchenStatusService$ 9
{		 
private

 
readonly

 #
IKitchenOrderRepository

 ,#
_kitchenOrderRepository

- D
;

D E
public 
 
KitchenStatusService 
(  #
IKitchenOrderRepository  7"
kitchenOrderRepository8 N
)N O
{ #
_kitchenOrderRepository 
=  !"
kitchenOrderRepository" 8
;8 9
} 
public 

async 
Task 
BumpOrderAsync $
($ %
Guid% )
kitchenOrderId* 8
)8 9
{ 
var 
order 
= 
await #
_kitchenOrderRepository 1
.1 2
GetByIdAsync2 >
(> ?
kitchenOrderId? M
)M N
;N O
if 

( 
order 
== 
null 
) 
{ 	
throw 
new 
	Exception 
(  
$"  "
$str" ;
{; <
kitchenOrderId< J
}J K
"K L
)L M
;M N
} 	
order 
. 
Bump 
( 
) 
; 
await"" #
_kitchenOrderRepository"" %
.""% &
UpdateAsync""& 1
(""1 2
order""2 7
)""7 8
;""8 9
}## 
public%% 

async%% 
Task%% 
VoidOrderAsync%% $
(%%$ %
Guid%%% )
kitchenOrderId%%* 8
)%%8 9
{&& 
var'' 
order'' 
='' 
await'' #
_kitchenOrderRepository'' 1
.''1 2
GetByIdAsync''2 >
(''> ?
kitchenOrderId''? M
)''M N
;''N O
if(( 

((( 
order(( 
==(( 
null(( 
)(( 
{)) 	
throw** 
new** 
	Exception**  
(**  !
$"**! #
$str**# <
{**< =
kitchenOrderId**= K
}**K L
"**L M
)**M N
;**N O
}++ 	
order-- 
.-- 
Void-- 
(-- 
)-- 
;-- 
await.. #
_kitchenOrderRepository.. %
...% &
UpdateAsync..& 1
(..1 2
order..2 7
)..7 8
;..8 9
}// 
}00 ÷'
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\KitchenRoutingService.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
;

' (
public 
class !
KitchenRoutingService "
:# $"
IKitchenRoutingService% ;
{ 
private 
readonly #
IKitchenOrderRepository ,#
_kitchenOrderRepository- D
;D E
public 
!
KitchenRoutingService  
(  !#
IKitchenOrderRepository! 8"
kitchenOrderRepository9 O
)O P
{ #
_kitchenOrderRepository 
=  !"
kitchenOrderRepository" 8
;8 9
} 
public 

async 
Task 
< 
List 
< 
Guid 
>  
>  !
RouteToKitchenAsync" 5
(5 6
	TicketDto6 ?
ticket@ F
,F G
ListH L
<L M
GuidM Q
>Q R
?R S
itemIdsT [
=\ ]
null^ b
)b c
{ 
if 

( 
ticket 
== 
null 
) 
throw !
new" %!
ArgumentNullException& ;
(; <
nameof< B
(B C
ticketC I
)I J
)J K
;K L
var 
itemsToRoute 
= 
ticket !
.! "

OrderLines" ,
. 
Where 
( 
ol 
=> 
itemIds  
==! #
null$ (
||) +
itemIds, 3
.3 4
Contains4 <
(< =
ol= ?
.? @
Id@ B
)B C
)C D
. 
Where 
( 
ol 
=> 
ol 
.  
ShouldPrintToKitchen 0
)0 1
. 
ToList 
( 
) 
; 
if 

( 
! 
itemsToRoute 
. 
Any 
( 
) 
)  
return! '
new( +
List, 0
<0 1
Guid1 5
>5 6
(6 7
)7 8
;8 9
var"" 

serverName"" 
="" 
!"" 
string""  
.""  !
IsNullOrEmpty""! .
("". /
ticket""/ 5
.""5 6
	OwnerName""6 ?
)""? @
?""A B
ticket""C I
.""I J
	OwnerName""J S
:""T U
$str""V f
;""f g
var## 
tableNumber## 
=## 
!## 
string## !
.##! "
IsNullOrEmpty##" /
(##/ 0
ticket##0 6
.##6 7
	TableName##7 @
)##@ A
?##B C
ticket##D J
.##J K
	TableName##K T
:##U V
$str##W a
;##a b
var%% 
createdOrderIds%% 
=%% 
new%% !
List%%" &
<%%& '
Guid%%' +
>%%+ ,
(%%, -
)%%- .
;%%. /
var** 
kitchenOrder** 
=** 
new** 
KitchenOrder** +
(**+ ,
ticket++ 
.++ 
Id++ 
,++ 

serverName,, 
,,, 
tableNumber-- 
).. 	
;..	 

foreach00 
(00 
var00 
item00 
in00 
itemsToRoute00 )
)00) *
{11 	
var22 
	modifiers22 
=22 
item22  
.22  !
	Modifiers22! *
.22* +
Select22+ 1
(221 2
m222 3
=>224 6
m227 8
.228 9
Name229 =
)22= >
.22> ?
ToList22? E
(22E F
)22F G
;22G H
kitchenOrder44 
.44 
AddItem44  
(44  !
item55 
.55 
Id55 
,55 
item66 
.66 
MenuItemName66 !
,66! "
(77 
int77 
)77 
item77 
.77 
Quantity77 "
,77" #
item88 
.88 
PrinterGroupId88 #
??88$ &
Guid88' +
.88+ ,
Empty88, 1
,881 2
	modifiers99 
):: 
;:: 
};; 	
await== #
_kitchenOrderRepository== %
.==% &
AddAsync==& .
(==. /
kitchenOrder==/ ;
)==; <
;==< =
createdOrderIds?? 
.?? 
Add?? 
(?? 
kitchenOrder?? (
.??( )
Id??) +
)??+ ,
;??, -
returnAA 
createdOrderIdsAA 
;AA 
}BB 
}CC †U
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GroupSettleService.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
;

' (
public 
class 
GroupSettleService 
:  !
IGroupSettleService" 5
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly &
IGroupSettlementRepository /&
_groupSettlementRepository0 J
;J K
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
public 

GroupSettleService 
( 
ITicketRepository 
ticketRepository *
,* +
IPaymentRepository 
paymentRepository ,
,, -&
IGroupSettlementRepository "%
groupSettlementRepository# <
,< ="
ICashSessionRepository !
cashSessionRepository 4
)4 5
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_paymentRepository 
= 
paymentRepository .
;. /&
_groupSettlementRepository "
=# $%
groupSettlementRepository% >
;> ?"
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7
} 
public 

async 
Task 
< 
GroupSettlement %
>% &
SettleGroupAsync' 7
(7 8
List   
<   
Guid   
>   
	ticketIds   
,   
PaymentType!! 
paymentType!! 
,!!  
Money"" 
totalAmount"" 
,"" 
UserId## 
processedBy## 
,## 
Guid$$ 

terminalId$$ 
,$$ 
string%% 
?%% 
globalId%% 
=%% 
null%% 
)%%  
{&& 
if(( 

((( 
	ticketIds(( 
==(( 
null(( 
||((  
!((! "
	ticketIds((" +
.((+ ,
Any((, /
(((/ 0
)((0 1
)((1 2
throw)) 
new)) 
ArgumentException)) '
())' (
$str))( S
)))S T
;))T U
var++ 
tickets++ 
=++ 
new++ 
List++ 
<++ 
Ticket++ %
>++% &
(++& '
)++' (
;++( )
foreach,, 
(,, 
var,, 
id,, 
in,, 
	ticketIds,, $
),,$ %
{-- 	
var.. 
ticket.. 
=.. 
await.. 
_ticketRepository.. 0
...0 1
GetByIdAsync..1 =
(..= >
id..> @
)..@ A
;..A B
if// 
(// 
ticket// 
==// 
null// 
)// 
throw//  %
new//& )
	Exception//* 3
(//3 4
$"//4 6
$str//6 =
{//= >
id//> @
}//@ A
$str//A L
"//L M
)//M N
;//N O
if00 
(00 
ticket00 
.00 
Status00 
==00  
TicketStatus00! -
.00- .
Paid00. 2
||003 5
ticket006 <
.00< =
Status00= C
==00D F
TicketStatus00G S
.00S T
Closed00T Z
)00Z [
throw11 
new11 
	Exception11 $
(11$ %
$"11% '
$str11' .
{11. /
ticket11/ 5
.115 6
TicketNumber116 B
}11B C
$str11C T
"11T U
)11U V
;11V W
tickets22 
.22 
Add22 
(22 
ticket22 
)22 
;22  
}33 	
int66 
count66 
=66 
tickets66 
.66 
Count66 !
;66! "
decimal77 
totalDecimal77 
=77 
totalAmount77 *
.77* +
Amount77+ 1
;771 2
decimal88 
	baseShare88 
=88 
Math88  
.88  !
Floor88! &
(88& '
(88' (
totalDecimal88( 4
/885 6
count887 <
)88< =
*88> ?
$num88@ C
)88C D
/88E F
$num88G J
;88J K
decimal99 
	remainder99 
=99 
totalDecimal99 (
-99) *
(99+ ,
	baseShare99, 5
*996 7
count998 =
)99= >
;99> ?
var<< 
payments<< 
=<< 
new<< 
List<< 
<<<  
Payment<<  '
><<' (
(<<( )
)<<) *
;<<* +
CashSession== 
?== 
activeSession== "
===# $
null==% )
;==) *
if@@ 

(@@ 
paymentType@@ 
==@@ 
PaymentType@@ &
.@@& '
Cash@@' +
)@@+ ,
{AA 	
activeSessionBB 
=BB 
awaitBB !"
_cashSessionRepositoryBB" 8
.BB8 9+
GetOpenSessionByTerminalIdAsyncBB9 X
(BBX Y

terminalIdBBY c
)BBc d
;BBd e
ifCC 
(CC 
activeSessionCC 
==CC  
nullCC! %
)CC% &
throwDD 
newDD 
	ExceptionDD #
(DD# $
$"DD$ &
$strDD& P
{DDP Q

terminalIdDDQ [
}DD[ \
$strDD\ ]
"DD] ^
)DD^ _
;DD_ `
}EE 	
forGG 
(GG 
intGG 
iGG 
=GG 
$numGG 
;GG 
iGG 
<GG 
countGG !
;GG! "
iGG# $
++GG$ &
)GG& '
{HH 	
varII 
ticketII 
=II 
ticketsII  
[II  !
iII! "
]II" #
;II# $
decimalJJ 
shareAmountJJ 
=JJ  !
	baseShareJJ" +
;JJ+ ,
ifMM 
(MM 
	remainderMM 
>MM 
$numMM 
)MM 
{NN 
shareAmountOO 
+=OO 
$numOO $
;OO$ %
	remainderPP 
-=PP 
$numPP "
;PP" #
}QQ 
varSS 

moneyShareSS 
=SS 
newSS  
MoneySS! &
(SS& '
shareAmountSS' 2
,SS2 3
totalAmountSS4 ?
.SS? @
CurrencySS@ H
)SSH I
;SSI J
PaymentVV 
paymentVV 
;VV 
ifWW 
(WW 
paymentTypeWW 
==WW 
PaymentTypeWW *
.WW* +
CashWW+ /
)WW/ 0
{XX 
paymentYY 
=YY 
CashPaymentYY &
.YY& '
CreateYY' -
(YY- .
ticketZZ 
.ZZ 
IdZZ 
,ZZ 

moneyShare[[ 
,[[ 
processedBy\\ 
,\\  

terminalId]] 
,]] 
globalId^^ 
:^^ 
globalId^^ &
??^^' )
Guid^^* .
.^^. /
NewGuid^^/ 6
(^^6 7
)^^7 8
.^^8 9
ToString^^9 A
(^^A B
)^^B C
)`` 
;`` 
varhh  
setCashSessionMethodhh )
=hh* +
typeofhh, 2
(hh2 3
Paymenthh3 :
)hh: ;
.hh; <
	GetMethodhh< E
(hhE F
$strhhF X
,hhX Y
Systemii 
.ii 

Reflectionii %
.ii% &
BindingFlagsii& 2
.ii2 3
	NonPublicii3 <
|ii= >
Systemii? E
.iiE F

ReflectioniiF P
.iiP Q
BindingFlagsiiQ ]
.ii] ^
Instanceii^ f
)iif g
;iig h 
setCashSessionMethodjj %
?jj% &
.jj& '
Invokejj' -
(jj- .
paymentjj. 5
,jj5 6
newjj7 :
objectjj; A
[jjA B
]jjB C
{jjD E
activeSessionjjF S
.jjS T
IdjjT V
}jjW X
)jjX Y
;jjY Z
activeSessionll 
.ll 

AddPaymentll )
(ll) *
paymentll* 1
)ll1 2
;ll2 3
}mm 
elsenn 
{oo 
paymentqq 
=qq 
Paymentqq "
.qq" #
Createqq# )
(qq) *
ticketrr 
.rr 
Idrr 
,rr 
paymentTypess 
,ss  

moneySharett 
,tt 
processedByuu 
,uu  

terminalIdvv 
,vv 
globalIdww 
)xx 
;xx 
}yy 
ticket{{ 
.{{ 

AddPayment{{ 
({{ 
payment{{ %
){{% &
;{{& '
payments|| 
.|| 
Add|| 
(|| 
payment||  
)||  !
;||! "
await 
_paymentRepository $
.$ %
AddAsync% -
(- .
payment. 5
)5 6
;6 7
await
ÄÄ 
_ticketRepository
ÄÄ #
.
ÄÄ# $
UpdateAsync
ÄÄ$ /
(
ÄÄ/ 0
ticket
ÄÄ0 6
)
ÄÄ6 7
;
ÄÄ7 8
}
ÅÅ 	
if
ÉÉ 

(
ÉÉ 
activeSession
ÉÉ 
!=
ÉÉ 
null
ÉÉ !
)
ÉÉ! "
{
ÑÑ 	
await
ÖÖ $
_cashSessionRepository
ÖÖ (
.
ÖÖ( )
UpdateAsync
ÖÖ) 4
(
ÖÖ4 5
activeSession
ÖÖ5 B
)
ÖÖB C
;
ÖÖC D
}
ÜÜ 	
var
ãã 
masterId
ãã 
=
ãã 
payments
ãã 
.
ãã  
First
ãã  %
(
ãã% &
)
ãã& '
.
ãã' (
Id
ãã( *
;
ãã* +
var
çç 
groupSettlement
çç 
=
çç 
new
çç !
GroupSettlement
çç" 1
(
çç1 2
masterId
çç2 :
,
çç: ;
	ticketIds
çç< E
)
ççE F
;
ççF G
await
èè (
_groupSettlementRepository
èè (
.
èè( )
AddAsync
èè) 1
(
èè1 2
groupSettlement
èè2 A
)
èèA B
;
èèB C
return
ëë 
groupSettlement
ëë 
;
ëë 
}
íí 
}ìì ˜
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetUsersQueryHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class  
GetUsersQueryHandler !
:" #
IQueryHandler$ 1
<1 2
GetUsersQuery2 ?
,? @
IEnumerableA L
<L M
UserDtoM T
>T U
>U V
{ 
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
public 
 
GetUsersQueryHandler 
(  
IUserRepository  /
userRepository0 >
)> ?
{ 
_userRepository 
= 
userRepository (
;( )
} 
public 

async 
Task 
< 
IEnumerable !
<! "
UserDto" )
>) *
>* +
HandleAsync, 7
(7 8
GetUsersQuery8 E
queryF K
,K L
CancellationTokenM ^
cancellationToken_ p
=q r
defaults z
)z {
{ 
var 
users 
= 
await 
_userRepository )
.) *
GetAllAsync* 5
(5 6
cancellationToken6 G
)G H
;H I
return 
users 
. 
Select 
( 
u 
=>  
new! $
UserDto% ,
{ 	
Id 
= 
u 
. 
Id 
, 
	FirstName 
= 
u 
. 
	FirstName #
,# $
LastName 
= 
u 
. 
LastName !
,! "
Username 
= 
u 
. 
Username !
,! "
} 	
)	 

;
 
}   
}!! ‡ë
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetTicketQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class !
GetTicketQueryHandler "
:# $
IQueryHandler% 2
<2 3
GetTicketQuery3 A
,A B
	TicketDtoC L
?L M
>M N
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
public 
!
GetTicketQueryHandler  
(  !
ITicketRepository! 2
ticketRepository3 C
)C D
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
} 
public 

async 
Task 
< 
	TicketDto 
?  
>  !
HandleAsync" -
(- .
GetTicketQuery. <
query= B
,B C
CancellationTokenD U
cancellationTokenV g
=h i
defaultj q
)q r
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
query: ?
.? @
TicketId@ H
,H I
cancellationTokenJ [
)[ \
;\ ]
if 

( 
ticket 
== 
null 
) 
{ 	
return 
null 
; 
} 	
return 
MapToDto 
( 
ticket 
) 
;  
} 
private 
static 
	TicketDto 
MapToDto %
(% &
Domain& ,
., -
Entities- 5
.5 6
Ticket6 <
ticket= C
)C D
{   
var!! 
dto!! 
=!! 
new!! 
	TicketDto!! 
{"" 	
Id## 
=## 
ticket## 
.## 
Id## 
,## 
TicketNumber$$ 
=$$ 
ticket$$ !
.$$! "
TicketNumber$$" .
,$$. /
GlobalId%% 
=%% 
ticket%% 
.%% 
GlobalId%% &
,%%& '
	CreatedAt&& 
=&& 
ticket&& 
.&& 
	CreatedAt&& (
,&&( )
OpenedAt'' 
='' 
ticket'' 
.'' 
OpenedAt'' &
,''& '
ClosedAt(( 
=(( 
ticket(( 
.(( 
ClosedAt(( &
,((& '

ActiveDate)) 
=)) 
ticket)) 
.))  

ActiveDate))  *
,))* +
DeliveryDate** 
=** 
ticket** !
.**! "
DeliveryDate**" .
,**. /
Status++ 
=++ 
ticket++ 
.++ 
Status++ "
,++" #
	CreatedBy,, 
=,, 
ticket,, 
.,, 
	CreatedBy,, (
.,,( )
Value,,) .
,,,. /
ClosedBy-- 
=-- 
ticket-- 
.-- 
ClosedBy-- &
?--& '
.--' (
Value--( -
,--- .
VoidedBy.. 
=.. 
ticket.. 
... 
VoidedBy.. &
?..& '
...' (
Value..( -
,..- .
Note// 
=// 
ticket// 
.// 
Note// 
,// 

TerminalId00 
=00 
ticket00 
.00  

TerminalId00  *
,00* +
ShiftId11 
=11 
ticket11 
.11 
ShiftId11 $
,11$ %
OrderTypeId22 
=22 
ticket22  
.22  !
OrderTypeId22! ,
,22, -

CustomerId33 
=33 
ticket33 
.33  

CustomerId33  *
,33* +
AssignedDriverId44 
=44 
ticket44 %
.44% &
AssignedDriverId44& 6
,446 7
TableNumbers55 
=55 
ticket55 !
.55! "
TableNumbers55" .
.55. /
ToList55/ 5
(555 6
)556 7
,557 8
NumberOfGuests66 
=66 
ticket66 #
.66# $
NumberOfGuests66$ 2
,662 3
SubtotalAmount77 
=77 
ticket77 #
.77# $
SubtotalAmount77$ 2
.772 3
Amount773 9
,779 :
DiscountAmount88 
=88 
ticket88 #
.88# $
DiscountAmount88$ 2
.882 3
Amount883 9
,889 :
	TaxAmount99 
=99 
ticket99 
.99 
	TaxAmount99 (
.99( )
Amount99) /
,99/ 0
ServiceChargeAmount:: 
=::  !
ticket::" (
.::( )
ServiceChargeAmount::) <
.::< =
Amount::= C
,::C D 
DeliveryChargeAmount;;  
=;;! "
ticket;;# )
.;;) * 
DeliveryChargeAmount;;* >
.;;> ?
Amount;;? E
,;;E F
AdjustmentAmount<< 
=<< 
ticket<< %
.<<% &
AdjustmentAmount<<& 6
.<<6 7
Amount<<7 =
,<<= >
TotalAmount== 
=== 
ticket==  
.==  !
TotalAmount==! ,
.==, -
Amount==- 3
,==3 4

PaidAmount>> 
=>> 
ticket>> 
.>>  

PaidAmount>>  *
.>>* +
Amount>>+ 1
,>>1 2
	DueAmount?? 
=?? 
ticket?? 
.?? 
	DueAmount?? (
.??( )
Amount??) /
,??/ 0
AdvanceAmount@@ 
=@@ 
ticket@@ "
.@@" #
AdvanceAmount@@# 0
.@@0 1
Amount@@1 7
,@@7 8
IsTaxExemptAA 
=AA 
ticketAA  
.AA  !
IsTaxExemptAA! ,
,AA, -
IsBarTabBB 
=BB 
ticketBB 
.BB 
IsBarTabBB &
,BB& '

IsReOpenedCC 
=CC 
ticketCC 
.CC  

IsReOpenedCC  *
,CC* +
DeliveryAddressDD 
=DD 
ticketDD $
.DD$ %
DeliveryAddressDD% 4
,DD4 5
ExtraDeliveryInfoEE 
=EE 
ticketEE  &
.EE& '
ExtraDeliveryInfoEE' 8
,EE8 9
CustomerWillPickupFF 
=FF  
ticketFF! '
.FF' (
CustomerWillPickupFF( :
,FF: ;

OrderLinesGG 
=GG 
ticketGG 
.GG  

OrderLinesGG  *
.GG* +
SelectGG+ 1
(GG1 2
MapOrderLineToDtoGG2 C
)GGC D
.GGD E
ToListGGE K
(GGK L
)GGL M
,GGM N
PaymentsHH 
=HH 
ticketHH 
.HH 
PaymentsHH &
.HH& '
SelectHH' -
(HH- .
MapPaymentToDtoHH. =
)HH= >
.HH> ?
ToListHH? E
(HHE F
)HHF G
,HHG H
GratuityII 
=II 
ticketII 
.II 
GratuityII &
!=II' )
nullII* .
?II/ 0
MapGratuityToDtoII1 A
(IIA B
ticketIIB H
.IIH I
GratuityIII Q
)IIQ R
:IIS T
nullIIU Y
,IIY Z
VersionJJ 
=JJ 
ticketJJ 
.JJ 
VersionJJ $
}KK 	
;KK	 

ifNN 

(NN 
dtoNN 
.NN 
TableNumbersNN 
.NN 
AnyNN  
(NN  !
)NN! "
)NN" #
{OO 	
dtoPP 
.PP 
	TableNamePP 
=PP 
$"PP 
$strPP $
{PP$ %
dtoPP% (
.PP( )
TableNumbersPP) 5
.PP5 6
FirstPP6 ;
(PP; <
)PP< =
}PP= >
"PP> ?
;PP? @
}QQ 	
elseRR 
{SS 	
dtoTT 
.TT 
	TableNameTT 
=TT 
$strTT &
;TT& '
}UU 	
returnWW 
dtoWW 
;WW 
}XX 
privateZZ 
staticZZ 
OrderLineDtoZZ 
MapOrderLineToDtoZZ  1
(ZZ1 2
DomainZZ2 8
.ZZ8 9
EntitiesZZ9 A
.ZZA B
	OrderLineZZB K
	orderLineZZL U
)ZZU V
{[[ 
return\\ 
new\\ 
OrderLineDto\\ 
{]] 	
Id^^ 
=^^ 
	orderLine^^ 
.^^ 
Id^^ 
,^^ 
TicketId__ 
=__ 
	orderLine__  
.__  !
TicketId__! )
,__) *

MenuItemId`` 
=`` 
	orderLine`` "
.``" #

MenuItemId``# -
,``- .
MenuItemNameaa 
=aa 
	orderLineaa $
.aa$ %
MenuItemNameaa% 1
,aa1 2
CategoryNamebb 
=bb 
	orderLinebb $
.bb$ %
CategoryNamebb% 1
,bb1 2
	GroupNamecc 
=cc 
	orderLinecc !
.cc! "
	GroupNamecc" +
,cc+ ,
Quantitydd 
=dd 
	orderLinedd  
.dd  !
Quantitydd! )
,dd) *
	ItemCountee 
=ee 
	orderLineee !
.ee! "
	ItemCountee" +
,ee+ ,
ItemUnitNameff 
=ff 
	orderLineff $
.ff$ %
ItemUnitNameff% 1
,ff1 2
IsFractionalUnitgg 
=gg 
	orderLinegg (
.gg( )
IsFractionalUnitgg) 9
,gg9 :
	UnitPricehh 
=hh 
	orderLinehh !
.hh! "
	UnitPricehh" +
.hh+ ,
Amounthh, 2
,hh2 3
SubtotalAmountii 
=ii 
	orderLineii &
.ii& '
SubtotalAmountii' 5
.ii5 6
Amountii6 <
,ii< =
DiscountAmountjj 
=jj 
	orderLinejj &
.jj& '
DiscountAmountjj' 5
.jj5 6
Amountjj6 <
,jj< =
TaxRatekk 
=kk 
	orderLinekk 
.kk  
TaxRatekk  '
,kk' (
	TaxAmountll 
=ll 
	orderLinell !
.ll! "
	TaxAmountll" +
.ll+ ,
Amountll, 2
,ll2 3
TotalAmountmm 
=mm 
	orderLinemm #
.mm# $
TotalAmountmm$ /
.mm/ 0
Amountmm0 6
,mm6 7

IsBeveragenn 
=nn 
	orderLinenn "
.nn" #

IsBeveragenn# -
,nn- . 
ShouldPrintToKitchenoo  
=oo! "
	orderLineoo# ,
.oo, - 
ShouldPrintToKitchenoo- A
,ooA B
PrintedToKitchenpp 
=pp 
	orderLinepp (
.pp( )
PrintedToKitchenpp) 9
,pp9 :
Instructionsqq 
=qq 
	orderLineqq $
.qq$ %
Instructionsqq% 1
,qq1 2

SeatNumberrr 
=rr 
	orderLinerr "
.rr" #

SeatNumberrr# -
,rr- .
TreatAsSeatss 
=ss 
	orderLiness #
.ss# $
TreatAsSeatss$ /
,ss/ 0
	Modifierstt 
=tt 
	orderLinett !
.tt! "
	Modifierstt" +
.tt+ ,
Selecttt, 2
(tt2 3
MapModifierToDtott3 C
)ttC D
.ttD E
ToListttE K
(ttK L
)ttL M
,ttM N
AddOnsuu 
=uu 
	orderLineuu 
.uu 
AddOnsuu %
.uu% &
Selectuu& ,
(uu, -
MapModifierToDtouu- =
)uu= >
.uu> ?
ToListuu? E
(uuE F
)uuF G
,uuG H
	CreatedAtvv 
=vv 
	orderLinevv !
.vv! "
	CreatedAtvv" +
}ww 	
;ww	 

}xx 
privatezz 
staticzz 

PaymentDtozz 
MapPaymentToDtozz -
(zz- .
Domainzz. 4
.zz4 5
Entitieszz5 =
.zz= >
Paymentzz> E
paymentzzF M
)zzM N
{{{ 
return|| 
new|| 

PaymentDto|| 
{}} 	
Id~~ 
=~~ 
payment~~ 
.~~ 
Id~~ 
,~~ 
GlobalId 
= 
payment 
. 
GlobalId '
,' (
TicketId
ÄÄ 
=
ÄÄ 
payment
ÄÄ 
.
ÄÄ 
TicketId
ÄÄ '
,
ÄÄ' (
TransactionType
ÅÅ 
=
ÅÅ 
payment
ÅÅ %
.
ÅÅ% &
TransactionType
ÅÅ& 5
,
ÅÅ5 6
PaymentType
ÇÇ 
=
ÇÇ 
payment
ÇÇ !
.
ÇÇ! "
PaymentType
ÇÇ" -
,
ÇÇ- .
Amount
ÉÉ 
=
ÉÉ 
payment
ÉÉ 
.
ÉÉ 
Amount
ÉÉ #
.
ÉÉ# $
Amount
ÉÉ$ *
,
ÉÉ* +

TipsAmount
ÑÑ 
=
ÑÑ 
payment
ÑÑ  
.
ÑÑ  !

TipsAmount
ÑÑ! +
.
ÑÑ+ ,
Amount
ÑÑ, 2
,
ÑÑ2 3
TenderAmount
ÖÖ 
=
ÖÖ 
payment
ÖÖ "
.
ÖÖ" #
TenderAmount
ÖÖ# /
.
ÖÖ/ 0
Amount
ÖÖ0 6
,
ÖÖ6 7
ChangeAmount
ÜÜ 
=
ÜÜ 
payment
ÜÜ "
.
ÜÜ" #
ChangeAmount
ÜÜ# /
.
ÜÜ/ 0
Amount
ÜÜ0 6
,
ÜÜ6 7
TransactionTime
áá 
=
áá 
payment
áá %
.
áá% &
TransactionTime
áá& 5
,
áá5 6
ProcessedBy
àà 
=
àà 
payment
àà !
.
àà! "
ProcessedBy
àà" -
.
àà- .
Value
àà. 3
,
àà3 4

TerminalId
ââ 
=
ââ 
payment
ââ  
.
ââ  !

TerminalId
ââ! +
,
ââ+ ,

IsCaptured
ää 
=
ää 
payment
ää  
.
ää  !

IsCaptured
ää! +
,
ää+ ,
IsVoided
ãã 
=
ãã 
payment
ãã 
.
ãã 
IsVoided
ãã '
,
ãã' (
IsAuthorizable
åå 
=
åå 
payment
åå $
.
åå$ %
IsAuthorizable
åå% 3
,
åå3 4
CashSessionId
çç 
=
çç 
payment
çç #
.
çç# $
CashSessionId
çç$ 1
,
çç1 2
Note
éé 
=
éé 
payment
éé 
.
éé 
Note
éé 
}
èè 	
;
èè	 

}
êê 
private
íí 
static
íí 
GratuityDto
íí 
MapGratuityToDto
íí /
(
íí/ 0
Domain
íí0 6
.
íí6 7
Entities
íí7 ?
.
íí? @
Gratuity
íí@ H
gratuity
ííI Q
)
ííQ R
{
ìì 
return
îî 
new
îî 
GratuityDto
îî 
{
ïï 	
Id
ññ 
=
ññ 
gratuity
ññ 
.
ññ 
Id
ññ 
,
ññ 
TicketId
óó 
=
óó 
gratuity
óó 
.
óó  
TicketId
óó  (
,
óó( )
Amount
òò 
=
òò 
gratuity
òò 
.
òò 
Amount
òò $
.
òò$ %
Amount
òò% +
,
òò+ ,
Paid
ôô 
=
ôô 
gratuity
ôô 
.
ôô 
Paid
ôô  
,
ôô  !
Refunded
öö 
=
öö 
gratuity
öö 
.
öö  
Refunded
öö  (
,
öö( )

TerminalId
õõ 
=
õõ 
gratuity
õõ !
.
õõ! "

TerminalId
õõ" ,
,
õõ, -
OwnerId
úú 
=
úú 
gratuity
úú 
.
úú 
OwnerId
úú &
.
úú& '
Value
úú' ,
,
úú, -
	CreatedAt
ùù 
=
ùù 
gratuity
ùù  
.
ùù  !
	CreatedAt
ùù! *
}
ûû 	
;
ûû	 

}
üü 
private
°° 
static
°° "
OrderLineModifierDto
°° '
MapModifierToDto
°°( 8
(
°°8 9
Domain
°°9 ?
.
°°? @
Entities
°°@ H
.
°°H I
OrderLineModifier
°°I Z
modifier
°°[ c
)
°°c d
{
¢¢ 
return
££ 
new
££ "
OrderLineModifierDto
££ '
{
§§ 	
Id
•• 
=
•• 
modifier
•• 
.
•• 
Id
•• 
,
•• 
OrderLineId
¶¶ 
=
¶¶ 
modifier
¶¶ "
.
¶¶" #
OrderLineId
¶¶# .
,
¶¶. /

ModifierId
ßß 
=
ßß 
modifier
ßß !
.
ßß! "

ModifierId
ßß" ,
,
ßß, -
Name
®® 
=
®® 
modifier
®® 
.
®® 
Name
®®  
,
®®  !
ModifierType
©© 
=
©© 
modifier
©© #
.
©©# $
ModifierType
©©$ 0
,
©©0 1
	ItemCount
™™ 
=
™™ 
modifier
™™  
.
™™  !
	ItemCount
™™! *
,
™™* +
	UnitPrice
´´ 
=
´´ 
modifier
´´  
.
´´  !
	UnitPrice
´´! *
.
´´* +
Amount
´´+ 1
,
´´1 2
TaxRate
¨¨ 
=
¨¨ 
modifier
¨¨ 
.
¨¨ 
TaxRate
¨¨ &
,
¨¨& '
	TaxAmount
≠≠ 
=
≠≠ 
modifier
≠≠  
.
≠≠  !
	TaxAmount
≠≠! *
.
≠≠* +
Amount
≠≠+ 1
,
≠≠1 2
TotalAmount
ÆÆ 
=
ÆÆ 
modifier
ÆÆ "
.
ÆÆ" #
TotalAmount
ÆÆ# .
.
ÆÆ. /
Amount
ÆÆ/ 5
,
ÆÆ5 6
SectionName
ØØ 
=
ØØ 
modifier
ØØ "
.
ØØ" #
SectionName
ØØ# .
,
ØØ. /"
ShouldPrintToKitchen
∞∞  
=
∞∞! "
modifier
∞∞# +
.
∞∞+ ,"
ShouldPrintToKitchen
∞∞, @
,
∞∞@ A
	CreatedAt
±± 
=
±± 
modifier
±±  
.
±±  !
	CreatedAt
±±! *
}
≤≤ 	
;
≤≤	 

}
≥≥ 
}¥¥ ò
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetTicketByNumberQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 )
GetTicketByNumberQueryHandler

 *
:

+ ,
IQueryHandler

- :
<

: ;"
GetTicketByNumberQuery

; Q
,

Q R
	TicketDto

S \
?

\ ]
>

] ^
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
GetTicketQueryHandler *"
_getTicketQueryHandler+ A
;A B
public 
)
GetTicketByNumberQueryHandler (
(( )
ITicketRepository 
ticketRepository *
,* +!
GetTicketQueryHandler !
getTicketQueryHandler 3
)3 4
{ 
_ticketRepository 
= 
ticketRepository ,
;, -"
_getTicketQueryHandler 
=  !
getTicketQueryHandler! 6
;6 7
} 
public 

async 
Task 
< 
	TicketDto 
?  
>  !
HandleAsync" -
(- ."
GetTicketByNumberQuery. D
queryE J
,J K
CancellationTokenL ]
cancellationToken^ o
=p q
defaultr y
)y z
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -"
GetByTicketNumberAsync- C
(C D
queryD I
.I J
TicketNumberJ V
,V W
cancellationTokenX i
)i j
;j k
if 

( 
ticket 
== 
null 
) 
{ 	
return 
null 
; 
} 	
var   
getTicketQuery   
=   
new    
GetTicketQuery  ! /
{  0 1
TicketId  2 :
=  ; <
ticket  = C
.  C D
Id  D F
}  G H
;  H I
return!! 
await!! "
_getTicketQueryHandler!! +
.!!+ ,
HandleAsync!!, 7
(!!7 8
getTicketQuery!!8 F
,!!F G
cancellationToken!!H Y
)!!Y Z
;!!Z [
}"" 
}## ª
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetTableQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

  
GetTableQueryHandler

 !
:

" #
IQueryHandler

$ 1
<

1 2
GetTableQuery

2 ?
,

? @
GetTableResult

A O
>

O P
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
public 
 
GetTableQueryHandler 
(  
ITableRepository  0
tableRepository1 @
)@ A
{ 
_tableRepository 
= 
tableRepository *
;* +
} 
public 

async 
Task 
< 
GetTableResult $
>$ %
HandleAsync& 1
(1 2
GetTableQuery2 ?
query@ E
,E F
CancellationTokenG X
cancellationTokenY j
=k l
defaultm t
)t u
{ 
var 
table 
= 
await 
_tableRepository *
.* +
GetByIdAsync+ 7
(7 8
query8 =
.= >
TableId> E
,E F
cancellationTokenG X
)X Y
;Y Z
return 
new 
GetTableResult !
{ 	
Table 
= 
table 
!= 
null !
?" #
MapToDto$ ,
(, -
table- 2
)2 3
:4 5
null6 :
} 	
;	 

} 
private 
static 
TableDto 
MapToDto $
($ %
Domain% +
.+ ,
Entities, 4
.4 5
Table5 :
table; @
)@ A
{ 
return 
new 
TableDto 
{   	
Id!! 
=!! 
table!! 
.!! 
Id!! 
,!! 
TableNumber"" 
="" 
table"" 
.""  
TableNumber""  +
,""+ ,
FloorId## 
=## 
table## 
.## 
FloorId## #
,### $
Capacity$$ 
=$$ 
table$$ 
.$$ 
Capacity$$ %
,$$% &
X%% 
=%% 
table%% 
.%% 
X%% 
,%% 
Y&& 
=&& 
table&& 
.&& 
Y&& 
,&& 
Status'' 
='' 
table'' 
.'' 
Status'' !
,''! "
CurrentTicketId(( 
=(( 
table(( #
.((# $
CurrentTicketId(($ 3
,((3 4
IsActive)) 
=)) 
table)) 
.)) 
IsActive)) %
}** 	
;**	 

}++ 
},, Ÿ
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetTableMapQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class #
GetTableMapQueryHandler $
:% &
IQueryHandler' 4
<4 5
GetTableMapQuery5 E
,E F
GetTableMapResultG X
>X Y
{ 
private		 
readonly		 
ITableRepository		 %
_tableRepository		& 6
;		6 7
public 
#
GetTableMapQueryHandler "
(" #
ITableRepository# 3
tableRepository4 C
)C D
{ 
_tableRepository 
= 
tableRepository *
;* +
} 
public 

async 
Task 
< 
GetTableMapResult '
>' (
HandleAsync) 4
(4 5
GetTableMapQuery5 E
queryF K
,K L
CancellationTokenM ^
cancellationToken_ p
=q r
defaults z
)z {
{ 
IEnumerable 
< 
Domain 
. 
Entities #
.# $
Table$ )
>) *
tables+ 1
;1 2
if 

( 
query 
. 
FloorId 
. 
HasValue "
)" #
{ 	
var 
	allTables 
= 
await !
_tableRepository" 2
.2 3
GetByFloorIdAsync3 D
(D E
queryE J
.J K
FloorIdK R
,R S
cancellationTokenT e
)e f
;f g
tables 
= 
	allTables 
. 
Where $
($ %
t% &
=>' )
t* +
.+ ,
IsActive, 4
)4 5
;5 6
} 	
else 
{ 	
tables 
= 
await 
_tableRepository +
.+ ,
GetActiveAsync, :
(: ;
cancellationToken; L
)L M
;M N
} 	
var 
	tableDtos 
= 
tables 
. 
Select %
(% &
t& '
=>( *
new+ .
TableDto/ 7
{ 	
Id   
=   
t   
.   
Id   
,   
TableNumber!! 
=!! 
t!! 
.!! 
TableNumber!! '
,!!' (
FloorId"" 
="" 
t"" 
."" 
FloorId"" 
,""  
Capacity## 
=## 
t## 
.## 
Capacity## !
,##! "
X$$ 
=$$ 
t$$ 
.$$ 
X$$ 
,$$ 
Y%% 
=%% 
t%% 
.%% 
Y%% 
,%% 
Width&& 
=&& 
t&& 
.&& 
Width&& 
,&& 
Height'' 
='' 
t'' 
.'' 
Height'' 
,'' 
Status(( 
=(( 
t(( 
.(( 
Status(( 
,(( 
CurrentTicketId)) 
=)) 
t)) 
.))  
CurrentTicketId))  /
,))/ 0
IsActive** 
=** 
t** 
.** 
IsActive** !
,**! "
Shape++ 
=++ 
t++ 
.++ 
Shape++ 
},, 	
),,	 

.,,
 
ToList,, 
(,, 
),, 
;,, 
return.. 
new.. 
GetTableMapResult.. $
{// 	
Tables00 
=00 
	tableDtos00 
}11 	
;11	 

}22 
}33 Úb
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetShiftReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class &
GetShiftReportQueryHandler '
:( )
IQueryHandler* 7
<7 8
GetShiftReportQuery8 K
,K L 
GetShiftReportResultM a
>a b
{ 
private 
readonly 
IShiftRepository %
_shiftRepository& 6
;6 7
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
public 
&
GetShiftReportQueryHandler %
(% &
IShiftRepository 
shiftRepository (
,( )
ITicketRepository 
ticketRepository *
,* +"
ICashSessionRepository !
cashSessionRepository 4
)4 5
{ 
_shiftRepository 
= 
shiftRepository *
;* +
_ticketRepository 
= 
ticketRepository ,
;, -"
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7
} 
public 

async 
Task 
<  
GetShiftReportResult *
>* +
HandleAsync, 7
(7 8
GetShiftReportQuery8 K
queryL Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
var 
shift 
= 
await 
_shiftRepository *
.* +
GetByIdAsync+ 7
(7 8
query8 =
.= >
ShiftId> E
,E F
cancellationTokenG X
)X Y
;Y Z
if 

( 
shift 
== 
null 
) 
{   	
throw!! 
new!! 
Domain!! 
.!! 

Exceptions!! '
.!!' (*
BusinessRuleViolationException!!( F
(!!F G
$"!!G I
$str!!I O
{!!O P
query!!P U
.!!U V
ShiftId!!V ]
}!!] ^
$str!!^ i
"!!i j
)!!j k
;!!k l
}"" 	
var%% 
tickets%% 
=%% 
await%% 
_ticketRepository%% -
.%%- .
GetByShiftIdAsync%%. ?
(%%? @
query%%@ E
.%%E F
ShiftId%%F M
,%%M N
cancellationToken%%O `
)%%` a
;%%a b
if(( 

((( 
query(( 
.(( 
	StartDate(( 
.(( 
HasValue(( $
)(($ %
{)) 	
tickets** 
=** 
tickets** 
.** 
Where** #
(**# $
t**$ %
=>**& (
t**) *
.*** +
	CreatedAt**+ 4
>=**5 7
query**8 =
.**= >
	StartDate**> G
.**G H
Value**H M
)**M N
;**N O
}++ 	
if,, 

(,, 
query,, 
.,, 
EndDate,, 
.,, 
HasValue,, "
),," #
{-- 	
tickets.. 
=.. 
tickets.. 
... 
Where.. #
(..# $
t..$ %
=>..& (
t..) *
...* +
	CreatedAt..+ 4
<=..5 7
query..8 =
...= >
EndDate..> E
...E F
Value..F K
)..K L
;..L M
}// 	
var11 

ticketList11 
=11 
tickets11  
.11  !
ToList11! '
(11' (
)11( )
;11) *
var22 
closedTickets22 
=22 

ticketList22 &
.22& '
Where22' ,
(22, -
t22- .
=>22/ 1
t222 3
.223 4
Status224 :
==22; =
TicketStatus22> J
.22J K
Closed22K Q
)22Q R
.22R S
ToList22S Y
(22Y Z
)22Z [
;22[ \
var55 
cashSessions55 
=55 
await55  "
_cashSessionRepository55! 7
.557 8
GetByShiftIdAsync558 I
(55I J
query55J O
.55O P
ShiftId55P W
,55W X
cancellationToken55Y j
)55j k
;55k l
var66 
cashSessionList66 
=66 
cashSessions66 *
.66* +
ToList66+ 1
(661 2
)662 3
;663 4
var99 

totalSales99 
=99 

ticketList99 #
.99# $
Sum99$ '
(99' (
t99( )
=>99* ,
t99- .
.99. /
TotalAmount99/ :
.99: ;
Amount99; A
)99A B
;99B C
var:: 
totalCashSales:: 
=:: 

ticketList:: '
.;; 

SelectMany;; 
(;; 
t;; 
=>;; 
t;; 
.;; 
Payments;; '
);;' (
.<< 
Where<< 
(<< 
p<< 
=><< 
p<< 
.<< 
PaymentType<< %
==<<& (
PaymentType<<) 4
.<<4 5
Cash<<5 9
&&<<: <
!<<= >
p<<> ?
.<<? @
IsVoided<<@ H
&&<<I K
p<<L M
.<<M N
TransactionType<<N ]
==<<^ `
TransactionType<<a p
.<<p q
Credit<<q w
)<<w x
.== 
Sum== 
(== 
p== 
=>== 
p== 
.== 
Amount== 
.== 
Amount== %
)==% &
;==& '
var>> 
totalCardSales>> 
=>> 

ticketList>> '
.?? 

SelectMany?? 
(?? 
t?? 
=>?? 
t?? 
.?? 
Payments?? '
)??' (
.@@ 
Where@@ 
(@@ 
p@@ 
=>@@ 
(@@ 
p@@ 
.@@ 
PaymentType@@ &
==@@' )
PaymentType@@* 5
.@@5 6

CreditCard@@6 @
||@@A C
p@@D E
.@@E F
PaymentType@@F Q
==@@R T
PaymentType@@U `
.@@` a
	DebitCard@@a j
)@@j k
&&@@l n
!@@o p
p@@p q
.@@q r
IsVoided@@r z
)@@z {
.AA 
SumAA 
(AA 
pAA 
=>AA 
pAA 
.AA 
AmountAA 
.AA 
AmountAA %
)AA% &
;AA& '
varCC 
totalCashReceiptsCC 
=CC 
cashSessionListCC  /
.DD 

SelectManyDD 
(DD 
csDD 
=>DD 
csDD  
.DD  !
PaymentsDD! )
)DD) *
.EE 
WhereEE 
(EE 
pEE 
=>EE 
pEE 
.EE 
PaymentTypeEE %
==EE& (
PaymentTypeEE) 4
.EE4 5
CashEE5 9
&&EE: <
!EE= >
pEE> ?
.EE? @
IsVoidedEE@ H
&&EEI K
pEEL M
.EEM N
TransactionTypeEEN ]
==EE^ `
TransactionTypeEEa p
.EEp q
CreditEEq w
)EEw x
.FF 
SumFF 
(FF 
pFF 
=>FF 
pFF 
.FF 
AmountFF 
.FF 
AmountFF %
)FF% &
;FF& '
varGG 
totalCashRefundsGG 
=GG 
cashSessionListGG .
.HH 

SelectManyHH 
(HH 
csHH 
=>HH 
csHH  
.HH  !
PaymentsHH! )
)HH) *
.II 
WhereII 
(II 
pII 
=>II 
pII 
.II 
PaymentTypeII %
==II& (
PaymentTypeII) 4
.II4 5
CashII5 9
&&II: <
!II= >
pII> ?
.II? @
IsVoidedII@ H
&&III K
pIIL M
.IIM N
TransactionTypeIIN ]
==II^ `
TransactionTypeIIa p
.IIp q
DebitIIq v
)IIv w
.JJ 
SumJJ 
(JJ 
pJJ 
=>JJ 
pJJ 
.JJ 
AmountJJ 
.JJ 
AmountJJ %
)JJ% &
;JJ& '
varMM 

ticketDtosMM 
=MM 

ticketListMM #
.MM# $
SelectMM$ *
(MM* +
tMM+ ,
=>MM- /
newMM0 3
	TicketDtoMM4 =
{NN 	
IdOO 
=OO 
tOO 
.OO 
IdOO 
,OO 
TicketNumberPP 
=PP 
tPP 
.PP 
TicketNumberPP )
,PP) *
StatusQQ 
=QQ 
tQQ 
.QQ 
StatusQQ 
,QQ 
TotalAmountRR 
=RR 
tRR 
.RR 
TotalAmountRR '
.RR' (
AmountRR( .
,RR. /
	CreatedAtSS 
=SS 
tSS 
.SS 
	CreatedAtSS #
,SS# $
ClosedAtTT 
=TT 
tTT 
.TT 
ClosedAtTT !
}UU 	
)UU	 

.UU
 
ToListUU 
(UU 
)UU 
;UU 
varXX 
cashSessionDtosXX 
=XX 
cashSessionListXX -
.XX- .
SelectXX. 4
(XX4 5
csXX5 7
=>XX8 :
newXX; >
CashSessionDtoXX? M
{YY 	
IdZZ 
=ZZ 
csZZ 
.ZZ 
IdZZ 
,ZZ 
UserId[[ 
=[[ 
cs[[ 
.[[ 
UserId[[ 
.[[ 
Value[[ $
,[[$ %
OpenedAt\\ 
=\\ 
cs\\ 
.\\ 
OpenedAt\\ "
,\\" #
ClosedAt]] 
=]] 
cs]] 
.]] 
ClosedAt]] "
,]]" #
ExpectedCash^^ 
=^^ 
cs^^ 
.^^ 
ExpectedCash^^ *
.^^* +
Amount^^+ 1
,^^1 2

ActualCash__ 
=__ 
cs__ 
.__ 

ActualCash__ &
?__& '
.__' (
Amount__( .
,__. /
Status`` 
=`` 
cs`` 
.`` 
Status`` 
}aa 	
)aa	 

.aa
 
ToListaa 
(aa 
)aa 
;aa 
varcc 
reportcc 
=cc 
newcc 
ShiftReportDtocc '
{dd 	
ShiftIdee 
=ee 
shiftee 
.ee 
Idee 
,ee 
	ShiftNameff 
=ff 
shiftff 
.ff 
Nameff "
,ff" #
	StartDategg 
=gg 
querygg 
.gg 
	StartDategg '
,gg' (
EndDatehh 
=hh 
queryhh 
.hh 
EndDatehh #
,hh# $
TicketCountii 
=ii 

ticketListii $
.ii$ %
Countii% *
,ii* +
ClosedTicketCountjj 
=jj 
closedTicketsjj  -
.jj- .
Countjj. 3
,jj3 4

TotalSaleskk 
=kk 

totalSaleskk #
,kk# $
TotalCashSalesll 
=ll 
totalCashSalesll +
,ll+ ,
TotalCardSalesmm 
=mm 
totalCardSalesmm +
,mm+ ,
CashSessionCountnn 
=nn 
cashSessionListnn .
.nn. /
Countnn/ 4
,nn4 5
TotalCashReceiptsoo 
=oo 
totalCashReceiptsoo  1
,oo1 2
TotalCashRefundspp 
=pp 
totalCashRefundspp /
,pp/ 0
Ticketsqq 
=qq 

ticketDtosqq  
,qq  !
CashSessionsrr 
=rr 
cashSessionDtosrr *
}ss 	
;ss	 

returnuu 
newuu  
GetShiftReportResultuu '
{vv 	
Reportww 
=ww 
reportww 
}xx 	
;xx	 

}yy 
}zz ë
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetShiftQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

  
GetShiftQueryHandler

 !
:

" #
IQueryHandler

$ 1
<

1 2
GetShiftQuery

2 ?
,

? @
GetShiftResult

A O
>

O P
{ 
private 
readonly 
IShiftRepository %
_shiftRepository& 6
;6 7
public 
 
GetShiftQueryHandler 
(  
IShiftRepository  0
shiftRepository1 @
)@ A
{ 
_shiftRepository 
= 
shiftRepository *
;* +
} 
public 

async 
Task 
< 
GetShiftResult $
>$ %
HandleAsync& 1
(1 2
GetShiftQuery2 ?
query@ E
,E F
CancellationTokenG X
cancellationTokenY j
=k l
defaultm t
)t u
{ 
var 
shift 
= 
await 
_shiftRepository *
.* +
GetByIdAsync+ 7
(7 8
query8 =
.= >
ShiftId> E
,E F
cancellationTokenG X
)X Y
;Y Z
return 
new 
GetShiftResult !
{ 	
Shift 
= 
shift 
!= 
null !
?" #
MapToDto$ ,
(, -
shift- 2
)2 3
:4 5
null6 :
} 	
;	 

} 
private 
static 
ShiftDto 
MapToDto $
($ %
Domain% +
.+ ,
Entities, 4
.4 5
Shift5 :
shift; @
)@ A
{ 
return 
new 
ShiftDto 
{   	
Id!! 
=!! 
shift!! 
.!! 
Id!! 
,!! 
Name"" 
="" 
shift"" 
."" 
Name"" 
,"" 
	StartTime## 
=## 
shift## 
.## 
	StartTime## '
,##' (
EndTime$$ 
=$$ 
shift$$ 
.$$ 
EndTime$$ #
,$$# $
IsActive%% 
=%% 
shift%% 
.%% 
IsActive%% %
}&& 	
;&&	 

}'' 
}(( á
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetOrderTypeQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 $
GetOrderTypeQueryHandler

 %
:

& '
IQueryHandler

( 5
<

5 6
GetOrderTypeQuery

6 G
,

G H
GetOrderTypeResult

I [
>

[ \
{ 
private 
readonly  
IOrderTypeRepository ) 
_orderTypeRepository* >
;> ?
public 
$
GetOrderTypeQueryHandler #
(# $ 
IOrderTypeRepository$ 8
orderTypeRepository9 L
)L M
{  
_orderTypeRepository 
= 
orderTypeRepository 2
;2 3
} 
public 

async 
Task 
< 
GetOrderTypeResult (
>( )
HandleAsync* 5
(5 6
GetOrderTypeQuery6 G
queryH M
,M N
CancellationTokenO `
cancellationTokena r
=s t
defaultu |
)| }
{ 
var 
	orderType 
= 
await  
_orderTypeRepository 2
.2 3
GetByIdAsync3 ?
(? @
query@ E
.E F
OrderTypeIdF Q
,Q R
cancellationTokenS d
)d e
;e f
return 
new 
GetOrderTypeResult %
{ 	
	OrderType 
= 
	orderType !
!=" $
null% )
?* +
MapToDto, 4
(4 5
	orderType5 >
)> ?
:@ A
nullB F
} 	
;	 

} 
private 
static 
OrderTypeDto 
MapToDto  (
(( )
Domain) /
./ 0
Entities0 8
.8 9
	OrderType9 B
	orderTypeC L
)L M
{ 
return 
new 
OrderTypeDto 
{   	
Id!! 
=!! 
	orderType!! 
.!! 
Id!! 
,!! 
Name"" 
="" 
	orderType"" 
."" 
Name"" !
,""! "
CloseOnPaid## 
=## 
	orderType## #
.### $
CloseOnPaid##$ /
,##/ 0
AllowSeatBasedOrder$$ 
=$$  !
	orderType$$" +
.$$+ ,
AllowSeatBasedOrder$$, ?
,$$? @
AllowToAddTipsLater%% 
=%%  !
	orderType%%" +
.%%+ ,
AllowToAddTipsLater%%, ?
,%%? @
IsBarTab&& 
=&& 
	orderType&&  
.&&  !
IsBarTab&&! )
,&&) *
IsActive'' 
='' 
	orderType''  
.''  !
IsActive''! )
,'') *

Properties(( 
=(( 
	orderType(( "
.((" #

Properties((# -
.((- .
ToDictionary((. :
(((: ;
kvp((; >
=>((? A
kvp((B E
.((E F
Key((F I
,((I J
kvp((K N
=>((O Q
kvp((R U
.((U V
Value((V [
)(([ \
})) 	
;))	 

}** 
}++ ﬂ
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetOpenTicketsQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 &
GetOpenTicketsQueryHandler

 '
:

( )
IQueryHandler

* 7
<

7 8
GetOpenTicketsQuery

8 K
,

K L
IEnumerable

M X
<

X Y
	TicketDto

Y b
>

b c
>

c d
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
private 
readonly !
GetTicketQueryHandler *"
_getTicketQueryHandler+ A
;A B
public 
&
GetOpenTicketsQueryHandler %
(% &
ITicketRepository 
ticketRepository *
,* +
IUserRepository 
userRepository &
,& '!
GetTicketQueryHandler !
getTicketQueryHandler 3
)3 4
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_userRepository 
= 
userRepository (
;( )"
_getTicketQueryHandler 
=  !
getTicketQueryHandler! 6
;6 7
} 
public 

async 
Task 
< 
IEnumerable !
<! "
	TicketDto" +
>+ ,
>, -
HandleAsync. 9
(9 :
GetOpenTicketsQuery: M
queryN S
,S T
CancellationTokenU f
cancellationTokeng x
=y z
default	{ Ç
)
Ç É
{ 
var 
tickets 
= 
await 
_ticketRepository -
.- .
GetOpenTicketsAsync. A
(A B
cancellationTokenB S
)S T
;T U
var 
result 
= 
new 
List 
< 
	TicketDto '
>' (
(( )
)) *
;* +
foreach 
( 
var 
ticket 
in 
tickets &
)& '
{   	
var!! 
getTicketQuery!! 
=!!  
new!!! $
GetTicketQuery!!% 3
{!!4 5
TicketId!!6 >
=!!? @
ticket!!A G
.!!G H
Id!!H J
}!!K L
;!!L M
var"" 
dto"" 
="" 
await"" "
_getTicketQueryHandler"" 2
.""2 3
HandleAsync""3 >
(""> ?
getTicketQuery""? M
,""M N
cancellationToken""O `
)""` a
;""a b
if$$ 
($$ 
dto$$ 
!=$$ 
null$$ 
)$$ 
{%% 
var'' 
owner'' 
='' 
await'' !
_userRepository''" 1
.''1 2
GetByIdAsync''2 >
(''> ?
ticket''? E
.''E F
	CreatedBy''F O
.''O P
Value''P U
,''U V
cancellationToken''W h
)''h i
;''i j
dto(( 
.(( 
	OwnerName(( 
=(( 
owner((  %
!=((& (
null(() -
?((. /
$"((0 2
{((2 3
owner((3 8
.((8 9
	FirstName((9 B
}((B C
$str((C D
{((D E
owner((E J
.((J K
LastName((K S
}((S T
"((T U
:((V W
$str((X a
;((a b
result** 
.** 
Add** 
(** 
dto** 
)** 
;**  
}++ 
},, 	
return.. 
result.. 
;.. 
}// 
}00 Î_
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetDrawerPullReportQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class +
GetDrawerPullReportQueryHandler ,
:- .
IQueryHandler/ <
<< =$
GetDrawerPullReportQuery= U
,U V%
GetDrawerPullReportResultW p
>p q
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly "
ISalesReportRepository +"
_salesReportRepository, B
;B C
public 
+
GetDrawerPullReportQueryHandler *
(* +"
ICashSessionRepository+ A!
cashSessionRepositoryB W
,W X"
ISalesReportRepositoryY o"
salesReportRepository	p Ö
)
Ö Ü
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7"
_salesReportRepository 
=  !
salesReportRepository! 6
;6 7
} 
public 

async 
Task 
< %
GetDrawerPullReportResult /
>/ 0
HandleAsync1 <
(< =$
GetDrawerPullReportQuery= U
queryV [
,[ \
CancellationToken] n
cancellationToken	o Ä
=
Å Ç
default
É ä
)
ä ã
{ 
var 
cashSession 
= 
await "
_cashSessionRepository  6
.6 7
GetByIdAsync7 C
(C D
queryD I
.I J
CashSessionIdJ W
,W X
cancellationTokenY j
)j k
;k l
if 

( 
cashSession 
== 
null 
)  
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI V
{V W
queryW \
.\ ]
CashSessionId] j
}j k
$strk v
"v w
)w x
;x y
} 	
var 
	startDate 
= 
cashSession #
.# $
OpenedAt$ ,
;, -
var   
endDate   
=   
cashSession   !
.  ! "
ClosedAt  " *
??  + -
DateTime  . 6
.  6 7
UtcNow  7 =
;  = >
var(( 
salesSummary(( 
=(( 
await((  "
_salesReportRepository((! 7
.((7 8 
GetSalesSummaryAsync((8 L
(((L M
	startDate((M V
,((V W
endDate((X _
,((_ `
false((a f
,((f g
cancellationToken((h y
)((y z
;((z {
var)) 
	tipReport)) 
=)) 
await)) "
_salesReportRepository)) 4
.))4 5
GetTipReportAsync))5 F
())F G
	startDate))G P
,))P Q
endDate))R Y
,))Y Z
cashSession))[ f
.))f g
UserId))g m
,))m n
cancellationToken	))o Ä
)
))Ä Å
;
))Å Ç
var++ 
cashPayments++ 
=++ 
cashSession++ &
.++& '
Payments++' /
.,, 
Where,, 
(,, 
p,, 
=>,, 
p,, 
.,, 
PaymentType,, %
==,,& (
PaymentType,,) 4
.,,4 5
Cash,,5 9
&&,,: <
!,,= >
p,,> ?
.,,? @
IsVoided,,@ H
),,H I
.-- 
ToList-- 
(-- 
)-- 
;-- 
var// 
cashReceipts// 
=// 
cashPayments// '
.00 
Where00 
(00 
p00 
=>00 
p00 
.00 
TransactionType00 )
==00* ,
TransactionType00- <
.00< =
Credit00= C
)00C D
.11 
Sum11 
(11 
p11 
=>11 
p11 
.11 
Amount11 
.11 
Amount11 %
)11% &
;11& '
var33 
cashRefunds33 
=33 
cashPayments33 &
.44 
Where44 
(44 
p44 
=>44 
p44 
.44 
TransactionType44 )
==44* ,
TransactionType44- <
.44< =
Debit44= B
)44B C
.55 
Sum55 
(55 
p55 
=>55 
p55 
.55 
Amount55 
.55 
Amount55 %
)55% &
;55& '
var77 
report77 
=77 
new77 
DrawerPullReportDto77 ,
{88 	
CashSessionId99 
=99 
cashSession99 '
.99' (
Id99( *
,99* +
UserId:: 
=:: 
cashSession::  
.::  !
UserId::! '
.::' (
Value::( -
,::- .
OpenedAt;; 
=;; 
cashSession;; "
.;;" #
OpenedAt;;# +
,;;+ ,
ClosedAt<< 
=<< 
cashSession<< "
.<<" #
ClosedAt<<# +
,<<+ ,
OpeningBalance== 
=== 
cashSession== (
.==( )
OpeningBalance==) 7
.==7 8
Amount==8 >
,==> ?
ExpectedCash>> 
=>> 
cashSession>> &
.>>& '
ExpectedCash>>' 3
.>>3 4
Amount>>4 :
,>>: ;

ActualCash?? 
=?? 
cashSession?? $
.??$ %

ActualCash??% /
???/ 0
.??0 1
Amount??1 7
,??7 8

Difference@@ 
=@@ 
cashSession@@ $
.@@$ %

Difference@@% /
?@@/ 0
.@@0 1
Amount@@1 7
,@@7 8
TotalCashReceiptsAA 
=AA 
cashReceiptsAA  ,
,AA, -
TotalCashRefundsBB 
=BB 
cashRefundsBB *
,BB* +
TotalPayoutsCC 
=CC 
cashSessionCC &
.CC& '
PayoutsCC' .
.CC. /
SumCC/ 2
(CC2 3
pCC3 4
=>CC5 7
pCC8 9
.CC9 :
AmountCC: @
.CC@ A
AmountCCA G
)CCG H
,CCH I
TotalCashDropsDD 
=DD 
cashSessionDD (
.DD( )
	CashDropsDD) 2
.DD2 3
SumDD3 6
(DD6 7
dDD7 8
=>DD9 ;
dDD< =
.DD= >
AmountDD> D
.DDD E
AmountDDE K
)DDK L
,DDL M
TotalDrawerBleedsEE 
=EE 
cashSessionEE  +
.EE+ ,
DrawerBleedsEE, 8
.EE8 9
SumEE9 <
(EE< =
bEE= >
=>EE? A
bEEB C
.EEC D
AmountEED J
.EEJ K
AmountEEK Q
)EEQ R
,EER S
NetSalesHH 
=HH 
salesSummaryHH #
.HH# $
TotalsHH$ *
.HH* +
TotalNetSalesHH+ 8
,HH8 9
TaxII 
=II 
salesSummaryII 
.II 
TotalsII %
.II% &
TotalTaxII& .
,II. /
	TotalTipsJJ 
=JJ 
	tipReportJJ !
.JJ! "
	TotalTipsJJ" +
,JJ+ ,
PayoutsLL 
=LL 
cashSessionLL !
.LL! "
PayoutsLL" )
.LL) *
SelectLL* 0
(LL0 1
MapPayoutToDtoLL1 ?
)LL? @
.LL@ A
ToListLLA G
(LLG H
)LLH I
,LLI J
	CashDropsMM 
=MM 
cashSessionMM #
.MM# $
	CashDropsMM$ -
.MM- .
SelectMM. 4
(MM4 5
MapCashDropToDtoMM5 E
)MME F
.MMF G
ToListMMG M
(MMM N
)MMN O
,MMO P
DrawerBleedsNN 
=NN 
cashSessionNN &
.NN& '
DrawerBleedsNN' 3
.NN3 4
SelectNN4 :
(NN: ;
MapDrawerBleedToDtoNN; N
)NNN O
.NNO P
ToListNNP V
(NNV W
)NNW X
,NNX Y
CashPaymentCountOO 
=OO 
cashPaymentsOO +
.OO+ ,
CountOO, 1
}PP 	
;PP	 

returnRR 
newRR %
GetDrawerPullReportResultRR ,
{SS 	
ReportTT 
=TT 
reportTT 
}UU 	
;UU	 

}VV 
privateXX 
staticXX 
	PayoutDtoXX 
MapPayoutToDtoXX +
(XX+ ,
DomainXX, 2
.XX2 3
EntitiesXX3 ;
.XX; <
PayoutXX< B
payoutXXC I
)XXI J
{YY 
returnZZ 
newZZ 
	PayoutDtoZZ 
{[[ 	
Id\\ 
=\\ 
payout\\ 
.\\ 
Id\\ 
,\\ 
CashSessionId]] 
=]] 
payout]] "
.]]" #
CashSessionId]]# 0
,]]0 1
Amount^^ 
=^^ 
payout^^ 
.^^ 
Amount^^ "
.^^" #
Amount^^# )
,^^) *
Reason__ 
=__ 
payout__ 
.__ 
Reason__ "
,__" #
ProcessedBy`` 
=`` 
payout``  
.``  !
ProcessedBy``! ,
.``, -
Value``- 2
,``2 3
ProcessedAtaa 
=aa 
payoutaa  
.aa  !
ProcessedAtaa! ,
}bb 	
;bb	 

}cc 
privateee 
staticee 
CashDropDtoee 
MapCashDropToDtoee /
(ee/ 0
Domainee0 6
.ee6 7
Entitiesee7 ?
.ee? @
CashDropee@ H
cashDropeeI Q
)eeQ R
{ff 
returngg 
newgg 
CashDropDtogg 
{hh 	
Idii 
=ii 
cashDropii 
.ii 
Idii 
,ii 
CashSessionIdjj 
=jj 
cashDropjj $
.jj$ %
CashSessionIdjj% 2
,jj2 3
Amountkk 
=kk 
cashDropkk 
.kk 
Amountkk $
.kk$ %
Amountkk% +
,kk+ ,
Reasonll 
=ll 
cashDropll 
.ll 
Reasonll $
,ll$ %
ProcessedBymm 
=mm 
cashDropmm "
.mm" #
ProcessedBymm# .
.mm. /
Valuemm/ 4
,mm4 5
ProcessedAtnn 
=nn 
cashDropnn "
.nn" #
ProcessedAtnn# .
}oo 	
;oo	 

}pp 
privaterr 
staticrr 
DrawerBleedDtorr !
MapDrawerBleedToDtorr" 5
(rr5 6
Domainrr6 <
.rr< =
Entitiesrr= E
.rrE F
DrawerBleedrrF Q
drawerBleedrrR ]
)rr] ^
{ss 
returntt 
newtt 
DrawerBleedDtott !
{uu 	
Idvv 
=vv 
drawerBleedvv 
.vv 
Idvv 
,vv  
CashSessionIdww 
=ww 
drawerBleedww '
.ww' (
CashSessionIdww( 5
,ww5 6
Amountxx 
=xx 
drawerBleedxx  
.xx  !
Amountxx! '
.xx' (
Amountxx( .
,xx. /
Reasonyy 
=yy 
drawerBleedyy  
.yy  !
Reasonyy! '
,yy' (
ProcessedByzz 
=zz 
drawerBleedzz %
.zz% &
ProcessedByzz& 1
.zz1 2
Valuezz2 7
,zz7 8
ProcessedAt{{ 
={{ 
drawerBleed{{ %
.{{% &
ProcessedAt{{& 1
}|| 	
;||	 

}}} 
}~~ è
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetCurrentShiftQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 '
GetCurrentShiftQueryHandler

 (
:

) *
IQueryHandler

+ 8
<

8 9 
GetCurrentShiftQuery

9 M
,

M N!
GetCurrentShiftResult

O d
>

d e
{ 
private 
readonly 
IShiftRepository %
_shiftRepository& 6
;6 7
public 
'
GetCurrentShiftQueryHandler &
(& '
IShiftRepository' 7
shiftRepository8 G
)G H
{ 
_shiftRepository 
= 
shiftRepository *
;* +
} 
public 

async 
Task 
< !
GetCurrentShiftResult +
>+ ,
HandleAsync- 8
(8 9 
GetCurrentShiftQuery9 M
queryN S
,S T
CancellationTokenU f
cancellationTokeng x
=y z
default	{ Ç
)
Ç É
{ 
var 
shift 
= 
await 
_shiftRepository *
.* + 
GetCurrentShiftAsync+ ?
(? @
cancellationToken@ Q
)Q R
;R S
return 
new !
GetCurrentShiftResult (
{ 	
Shift 
= 
shift 
!= 
null !
?" #
MapToDto$ ,
(, -
shift- 2
)2 3
:4 5
null6 :
} 	
;	 

} 
private 
static 
ShiftDto 
MapToDto $
($ %
Domain% +
.+ ,
Entities, 4
.4 5
Shift5 :
shift; @
)@ A
{ 
return 
new 
ShiftDto 
{   	
Id!! 
=!! 
shift!! 
.!! 
Id!! 
,!! 
Name"" 
="" 
shift"" 
."" 
Name"" 
,"" 
	StartTime## 
=## 
shift## 
.## 
	StartTime## '
,##' (
EndTime$$ 
=$$ 
shift$$ 
.$$ 
EndTime$$ #
,$$# $
IsActive%% 
=%% 
shift%% 
.%% 
IsActive%% %
}&& 	
;&&	 

}'' 
}(( àN
àC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetCurrentCashSessionQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class -
!GetCurrentCashSessionQueryHandler .
:/ 0
IQueryHandler1 >
<> ?&
GetCurrentCashSessionQuery? Y
,Y Z'
GetCurrentCashSessionResult[ v
>v w
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
public 
-
!GetCurrentCashSessionQueryHandler ,
(, -"
ICashSessionRepository- C!
cashSessionRepositoryD Y
)Y Z
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7
} 
public 

async 
Task 
< '
GetCurrentCashSessionResult 1
>1 2
HandleAsync3 >
(> ?&
GetCurrentCashSessionQuery? Y
queryZ _
,_ `
CancellationTokena r
cancellationToken	s Ñ
=
Ö Ü
default
á é
)
é è
{ 
var 
cashSession 
= 
await "
_cashSessionRepository  6
.6 7'
GetOpenSessionByUserIdAsync7 R
(R S
queryS X
.X Y
UserIdY _
,_ `
cancellationTokena r
)r s
;s t
return 
new '
GetCurrentCashSessionResult .
{ 	
CashSession 
= 
cashSession %
!=& (
null) -
?. /
MapToDto0 8
(8 9
cashSession9 D
)D E
:F G
nullH L
} 	
;	 

} 
private 
static 
CashSessionDto !
MapToDto" *
(* +
Domain+ 1
.1 2
Entities2 :
.: ;
CashSession; F
cashSessionG R
)R S
{ 
var   
cashPayments   
=   
cashSession   &
.  & '
Payments  ' /
.!! 
Where!! 
(!! 
p!! 
=>!! 
p!! 
.!! 
PaymentType!! %
==!!& (
PaymentType!!) 4
.!!4 5
Cash!!5 9
&&!!: <
!!!= >
p!!> ?
.!!? @
IsVoided!!@ H
)!!H I
."" 
ToList"" 
("" 
)"" 
;"" 
var$$ 
cashReceipts$$ 
=$$ 
cashPayments$$ '
.%% 
Where%% 
(%% 
p%% 
=>%% 
p%% 
.%% 
TransactionType%% )
==%%* ,
TransactionType%%- <
.%%< =
Credit%%= C
)%%C D
.&& 
Sum&& 
(&& 
p&& 
=>&& 
p&& 
.&& 
Amount&& 
.&& 
Amount&& %
)&&% &
;&&& '
var(( 
cashRefunds(( 
=(( 
cashPayments(( &
.)) 
Where)) 
()) 
p)) 
=>)) 
p)) 
.)) 
TransactionType)) )
==))* ,
TransactionType))- <
.))< =
Debit))= B
)))B C
.** 
Sum** 
(** 
p** 
=>** 
p** 
.** 
Amount** 
.** 
Amount** %
)**% &
;**& '
return,, 
new,, 
CashSessionDto,, !
{-- 	
Id.. 
=.. 
cashSession.. 
... 
Id.. 
,..  
UserId// 
=// 
cashSession//  
.//  !
UserId//! '
.//' (
Value//( -
,//- .

TerminalId00 
=00 
cashSession00 $
.00$ %

TerminalId00% /
,00/ 0
ShiftId11 
=11 
cashSession11 !
.11! "
ShiftId11" )
,11) *
OpenedAt22 
=22 
cashSession22 "
.22" #
OpenedAt22# +
,22+ ,
ClosedAt33 
=33 
cashSession33 "
.33" #
ClosedAt33# +
,33+ ,
ClosedBy44 
=44 
cashSession44 "
.44" #
ClosedBy44# +
?44+ ,
.44, -
Value44- 2
,442 3
OpeningBalance55 
=55 
cashSession55 (
.55( )
OpeningBalance55) 7
.557 8
Amount558 >
,55> ?
ExpectedCash66 
=66 
cashSession66 &
.66& '
ExpectedCash66' 3
.663 4
Amount664 :
,66: ;

ActualCash77 
=77 
cashSession77 $
.77$ %

ActualCash77% /
?77/ 0
.770 1
Amount771 7
,777 8

Difference88 
=88 
cashSession88 $
.88$ %

Difference88% /
?88/ 0
.880 1
Amount881 7
,887 8
Status99 
=99 
cashSession99  
.99  !
Status99! '
,99' (
Payouts:: 
=:: 
cashSession:: !
.::! "
Payouts::" )
.::) *
Select::* 0
(::0 1
MapPayoutToDto::1 ?
)::? @
.::@ A
ToList::A G
(::G H
)::H I
,::I J
	CashDrops;; 
=;; 
cashSession;; #
.;;# $
	CashDrops;;$ -
.;;- .
Select;;. 4
(;;4 5
MapCashDropToDto;;5 E
);;E F
.;;F G
ToList;;G M
(;;M N
);;N O
,;;O P
DrawerBleeds<< 
=<< 
cashSession<< &
.<<& '
DrawerBleeds<<' 3
.<<3 4
Select<<4 :
(<<: ;
MapDrawerBleedToDto<<; N
)<<N O
.<<O P
ToList<<P V
(<<V W
)<<W X
,<<X Y
PaymentCount== 
=== 
cashPayments== '
.==' (
Count==( -
,==- .
TotalCashReceipts>> 
=>> 
cashReceipts>>  ,
,>>, -
TotalCashRefunds?? 
=?? 
cashRefunds?? *
}@@ 	
;@@	 

}AA 
privateCC 
staticCC 
	PayoutDtoCC 
MapPayoutToDtoCC +
(CC+ ,
DomainCC, 2
.CC2 3
EntitiesCC3 ;
.CC; <
PayoutCC< B
payoutCCC I
)CCI J
{DD 
returnEE 
newEE 
	PayoutDtoEE 
{FF 	
IdGG 
=GG 
payoutGG 
.GG 
IdGG 
,GG 
CashSessionIdHH 
=HH 
payoutHH "
.HH" #
CashSessionIdHH# 0
,HH0 1
AmountII 
=II 
payoutII 
.II 
AmountII "
.II" #
AmountII# )
,II) *
ReasonJJ 
=JJ 
payoutJJ 
.JJ 
ReasonJJ "
,JJ" #
ProcessedByKK 
=KK 
payoutKK  
.KK  !
ProcessedByKK! ,
.KK, -
ValueKK- 2
,KK2 3
ProcessedAtLL 
=LL 
payoutLL  
.LL  !
ProcessedAtLL! ,
}MM 	
;MM	 

}NN 
privatePP 
staticPP 
CashDropDtoPP 
MapCashDropToDtoPP /
(PP/ 0
DomainPP0 6
.PP6 7
EntitiesPP7 ?
.PP? @
CashDropPP@ H
cashDropPPI Q
)PPQ R
{QQ 
returnRR 
newRR 
CashDropDtoRR 
{SS 	
IdTT 
=TT 
cashDropTT 
.TT 
IdTT 
,TT 
CashSessionIdUU 
=UU 
cashDropUU $
.UU$ %
CashSessionIdUU% 2
,UU2 3
AmountVV 
=VV 
cashDropVV 
.VV 
AmountVV $
.VV$ %
AmountVV% +
,VV+ ,
ReasonWW 
=WW 
cashDropWW 
.WW 
ReasonWW $
,WW$ %
ProcessedByXX 
=XX 
cashDropXX "
.XX" #
ProcessedByXX# .
.XX. /
ValueXX/ 4
,XX4 5
ProcessedAtYY 
=YY 
cashDropYY "
.YY" #
ProcessedAtYY# .
}ZZ 	
;ZZ	 

}[[ 
private]] 
static]] 
DrawerBleedDto]] !
MapDrawerBleedToDto]]" 5
(]]5 6
Domain]]6 <
.]]< =
Entities]]= E
.]]E F
DrawerBleed]]F Q
drawerBleed]]R ]
)]]] ^
{^^ 
return__ 
new__ 
DrawerBleedDto__ !
{`` 	
Idaa 
=aa 
drawerBleedaa 
.aa 
Idaa 
,aa  
CashSessionIdbb 
=bb 
drawerBleedbb '
.bb' (
CashSessionIdbb( 5
,bb5 6
Amountcc 
=cc 
drawerBleedcc  
.cc  !
Amountcc! '
.cc' (
Amountcc( .
,cc. /
Reasondd 
=dd 
drawerBleeddd  
.dd  !
Reasondd! '
,dd' (
ProcessedByee 
=ee 
drawerBleedee %
.ee% &
ProcessedByee& 1
.ee1 2
Valueee2 7
,ee7 8
ProcessedAtff 
=ff 
drawerBleedff %
.ff% &
ProcessedAtff& 1
}gg 	
;gg	 

}hh 
}ii ƒM
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetCashSessionQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class &
GetCashSessionQueryHandler '
:( )
IQueryHandler* 7
<7 8
GetCashSessionQuery8 K
,K L 
GetCashSessionResultM a
>a b
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
public 
&
GetCashSessionQueryHandler %
(% &"
ICashSessionRepository& <!
cashSessionRepository= R
)R S
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7
} 
public 

async 
Task 
<  
GetCashSessionResult *
>* +
HandleAsync, 7
(7 8
GetCashSessionQuery8 K
queryL Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
var 
cashSession 
= 
await "
_cashSessionRepository  6
.6 7
GetByIdAsync7 C
(C D
queryD I
.I J
CashSessionIdJ W
,W X
cancellationTokenY j
)j k
;k l
return 
new  
GetCashSessionResult '
{ 	
CashSession 
= 
cashSession %
!=& (
null) -
?. /
MapToDto0 8
(8 9
cashSession9 D
)D E
:F G
nullH L
} 	
;	 

} 
private 
static 
CashSessionDto !
MapToDto" *
(* +
Domain+ 1
.1 2
Entities2 :
.: ;
CashSession; F
cashSessionG R
)R S
{ 
var   
cashPayments   
=   
cashSession   &
.  & '
Payments  ' /
.!! 
Where!! 
(!! 
p!! 
=>!! 
p!! 
.!! 
PaymentType!! %
==!!& (
PaymentType!!) 4
.!!4 5
Cash!!5 9
&&!!: <
!!!= >
p!!> ?
.!!? @
IsVoided!!@ H
)!!H I
."" 
ToList"" 
("" 
)"" 
;"" 
var$$ 
cashReceipts$$ 
=$$ 
cashPayments$$ '
.%% 
Where%% 
(%% 
p%% 
=>%% 
p%% 
.%% 
TransactionType%% )
==%%* ,
TransactionType%%- <
.%%< =
Credit%%= C
)%%C D
.&& 
Sum&& 
(&& 
p&& 
=>&& 
p&& 
.&& 
Amount&& 
.&& 
Amount&& %
)&&% &
;&&& '
var(( 
cashRefunds(( 
=(( 
cashPayments(( &
.)) 
Where)) 
()) 
p)) 
=>)) 
p)) 
.)) 
TransactionType)) )
==))* ,
TransactionType))- <
.))< =
Debit))= B
)))B C
.** 
Sum** 
(** 
p** 
=>** 
p** 
.** 
Amount** 
.** 
Amount** %
)**% &
;**& '
return,, 
new,, 
CashSessionDto,, !
{-- 	
Id.. 
=.. 
cashSession.. 
... 
Id.. 
,..  
UserId// 
=// 
cashSession//  
.//  !
UserId//! '
.//' (
Value//( -
,//- .

TerminalId00 
=00 
cashSession00 $
.00$ %

TerminalId00% /
,00/ 0
ShiftId11 
=11 
cashSession11 !
.11! "
ShiftId11" )
,11) *
OpenedAt22 
=22 
cashSession22 "
.22" #
OpenedAt22# +
,22+ ,
ClosedAt33 
=33 
cashSession33 "
.33" #
ClosedAt33# +
,33+ ,
ClosedBy44 
=44 
cashSession44 "
.44" #
ClosedBy44# +
?44+ ,
.44, -
Value44- 2
,442 3
OpeningBalance55 
=55 
cashSession55 (
.55( )
OpeningBalance55) 7
.557 8
Amount558 >
,55> ?
ExpectedCash66 
=66 
cashSession66 &
.66& '
ExpectedCash66' 3
.663 4
Amount664 :
,66: ;

ActualCash77 
=77 
cashSession77 $
.77$ %

ActualCash77% /
?77/ 0
.770 1
Amount771 7
,777 8

Difference88 
=88 
cashSession88 $
.88$ %

Difference88% /
?88/ 0
.880 1
Amount881 7
,887 8
Status99 
=99 
cashSession99  
.99  !
Status99! '
,99' (
Payouts:: 
=:: 
cashSession:: !
.::! "
Payouts::" )
.::) *
Select::* 0
(::0 1
MapPayoutToDto::1 ?
)::? @
.::@ A
ToList::A G
(::G H
)::H I
,::I J
	CashDrops;; 
=;; 
cashSession;; #
.;;# $
	CashDrops;;$ -
.;;- .
Select;;. 4
(;;4 5
MapCashDropToDto;;5 E
);;E F
.;;F G
ToList;;G M
(;;M N
);;N O
,;;O P
DrawerBleeds<< 
=<< 
cashSession<< &
.<<& '
DrawerBleeds<<' 3
.<<3 4
Select<<4 :
(<<: ;
MapDrawerBleedToDto<<; N
)<<N O
.<<O P
ToList<<P V
(<<V W
)<<W X
,<<X Y
PaymentCount== 
=== 
cashPayments== '
.==' (
Count==( -
,==- .
TotalCashReceipts>> 
=>> 
cashReceipts>>  ,
,>>, -
TotalCashRefunds?? 
=?? 
cashRefunds?? *
}@@ 	
;@@	 

}AA 
privateCC 
staticCC 
	PayoutDtoCC 
MapPayoutToDtoCC +
(CC+ ,
DomainCC, 2
.CC2 3
EntitiesCC3 ;
.CC; <
PayoutCC< B
payoutCCC I
)CCI J
{DD 
returnEE 
newEE 
	PayoutDtoEE 
{FF 	
IdGG 
=GG 
payoutGG 
.GG 
IdGG 
,GG 
CashSessionIdHH 
=HH 
payoutHH "
.HH" #
CashSessionIdHH# 0
,HH0 1
AmountII 
=II 
payoutII 
.II 
AmountII "
.II" #
AmountII# )
,II) *
ReasonJJ 
=JJ 
payoutJJ 
.JJ 
ReasonJJ "
,JJ" #
ProcessedByKK 
=KK 
payoutKK  
.KK  !
ProcessedByKK! ,
.KK, -
ValueKK- 2
,KK2 3
ProcessedAtLL 
=LL 
payoutLL  
.LL  !
ProcessedAtLL! ,
}MM 	
;MM	 

}NN 
privatePP 
staticPP 
CashDropDtoPP 
MapCashDropToDtoPP /
(PP/ 0
DomainPP0 6
.PP6 7
EntitiesPP7 ?
.PP? @
CashDropPP@ H
cashDropPPI Q
)PPQ R
{QQ 
returnRR 
newRR 
CashDropDtoRR 
{SS 	
IdTT 
=TT 
cashDropTT 
.TT 
IdTT 
,TT 
CashSessionIdUU 
=UU 
cashDropUU $
.UU$ %
CashSessionIdUU% 2
,UU2 3
AmountVV 
=VV 
cashDropVV 
.VV 
AmountVV $
.VV$ %
AmountVV% +
,VV+ ,
ReasonWW 
=WW 
cashDropWW 
.WW 
ReasonWW $
,WW$ %
ProcessedByXX 
=XX 
cashDropXX "
.XX" #
ProcessedByXX# .
.XX. /
ValueXX/ 4
,XX4 5
ProcessedAtYY 
=YY 
cashDropYY "
.YY" #
ProcessedAtYY# .
}ZZ 	
;ZZ	 

}[[ 
private]] 
static]] 
DrawerBleedDto]] !
MapDrawerBleedToDto]]" 5
(]]5 6
Domain]]6 <
.]]< =
Entities]]= E
.]]E F
DrawerBleed]]F Q
drawerBleed]]R ]
)]]] ^
{^^ 
return__ 
new__ 
DrawerBleedDto__ !
{`` 	
Idaa 
=aa 
drawerBleedaa 
.aa 
Idaa 
,aa  
CashSessionIdbb 
=bb 
drawerBleedbb '
.bb' (
CashSessionIdbb( 5
,bb5 6
Amountcc 
=cc 
drawerBleedcc  
.cc  !
Amountcc! '
.cc' (
Amountcc( .
,cc. /
Reasondd 
=dd 
drawerBleeddd  
.dd  !
Reasondd! '
,dd' (
ProcessedByee 
=ee 
drawerBleedee %
.ee% &
ProcessedByee& 1
.ee1 2
Valueee2 7
,ee7 8
ProcessedAtff 
=ff 
drawerBleedff %
.ff% &
ProcessedAtff& 1
}gg 	
;gg	 

}hh 
}ii ª 
ÖC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\GetAvailableTablesQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 *
GetAvailableTablesQueryHandler

 +
:

, -
IQueryHandler

. ;
<

; <#
GetAvailableTablesQuery

< S
,

S T$
GetAvailableTablesResult

U m
>

m n
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
public 
*
GetAvailableTablesQueryHandler )
() *
ITableRepository* :
tableRepository; J
)J K
{ 
_tableRepository 
= 
tableRepository *
;* +
} 
public 

async 
Task 
< $
GetAvailableTablesResult .
>. /
HandleAsync0 ;
(; <#
GetAvailableTablesQuery< S
queryT Y
,Y Z
CancellationToken[ l
cancellationTokenm ~
=	 Ä
default
Å à
)
à â
{ 
IEnumerable 
< 
Domain 
. 
Entities #
.# $
Table$ )
>) *
tables+ 1
;1 2
if 

( 
query 
. 
FloorId 
. 
HasValue "
)" #
{ 	
var 
	allTables 
= 
await !
_tableRepository" 2
.2 3
GetByFloorIdAsync3 D
(D E
queryE J
.J K
FloorIdK R
,R S
cancellationTokenT e
)e f
;f g
tables 
= 
	allTables 
. 
Where $
($ %
t% &
=>' )
t* +
.+ ,
IsAvailable, 7
(7 8
)8 9
)9 :
;: ;
} 	
else 
{ 	
tables 
= 
await 
_tableRepository +
.+ ,
GetAvailableAsync, =
(= >
cancellationToken> O
)O P
;P Q
} 	
var!! 
	tableDtos!! 
=!! 
tables!! 
.!! 
Select!! %
(!!% &
t!!& '
=>!!( *
new!!+ .
TableDto!!/ 7
{"" 	
Id## 
=## 
t## 
.## 
Id## 
,## 
TableNumber$$ 
=$$ 
t$$ 
.$$ 
TableNumber$$ '
,$$' (
FloorId%% 
=%% 
t%% 
.%% 
FloorId%% 
,%%  
Capacity&& 
=&& 
t&& 
.&& 
Capacity&& !
,&&! "
X'' 
='' 
t'' 
.'' 
X'' 
,'' 
Y(( 
=(( 
t(( 
.(( 
Y(( 
,(( 
Width)) 
=)) 
t)) 
.)) 
Width)) 
,)) 
Height** 
=** 
t** 
.** 
Height** 
,** 
Shape++ 
=++ 
t++ 
.++ 
Shape++ 
,++ 
Status,, 
=,, 
t,, 
.,, 
Status,, 
,,, 
CurrentTicketId-- 
=-- 
t-- 
.--  
CurrentTicketId--  /
,--/ 0
IsActive.. 
=.. 
t.. 
... 
IsActive.. !
}// 	
)//	 

.//
 
ToList// 
(// 
)// 
;// 
return11 
new11 $
GetAvailableTablesResult11 +
{22 	
Tables33 
=33 
	tableDtos33 
}44 	
;44	 

}55 
}66 üà
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ExportImportCommandHandlers.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public		 
class		 &
ExportLayoutCommandHandler		 '
:		( )
IRequestHandler		* 9
<		9 :
ExportLayoutCommand		: M
,		M N
string		O U
>		U V
{

 
private 
readonly "
ITableLayoutRepository +"
_tableLayoutRepository, B
;B C
private 
readonly 
TableLayoutExporter (
	_exporter) 2
;2 3
public 
&
ExportLayoutCommandHandler %
(% &"
ITableLayoutRepository !
tableLayoutRepository 4
,4 5
TableLayoutExporter 
exporter $
)$ %
{ "
_tableLayoutRepository 
=  !
tableLayoutRepository! 6
;6 7
	_exporter 
= 
exporter 
; 
} 
public 

async 
Task 
< 
string 
> 
Handle $
($ %
ExportLayoutCommand% 8
request9 @
,@ A
CancellationTokenB S
cancellationTokenT e
)e f
{ 
var 
layout 
= 
await "
_tableLayoutRepository 1
.1 2$
GetLayoutWithTablesAsync2 J
(J K
requestK R
.R S
LayoutIdS [
,[ \
cancellationToken] n
)n o
;o p
if 

( 
layout 
== 
null 
) 
{ 	
throw 
new  
KeyNotFoundException *
(* +
$"+ -
$str- <
{< =
request= D
.D E
LayoutIdE M
}M N
$strN Y
"Y Z
)Z [
;[ \
} 	
var 
json 
= 
	_exporter 
. 
ExportToJson )
() *
layout* 0
)0 1
;1 2
await!! 
File!! 
.!! 
WriteAllTextAsync!! $
(!!$ %
request!!% ,
.!!, -
FilePath!!- 5
,!!5 6
json!!7 ;
,!!; <
cancellationToken!!= N
)!!N O
;!!O P
return## 
request## 
.## 
FilePath## 
;##  
}$$ 
}%% 
public'' 
class'' &
ImportLayoutCommandHandler'' '
:''( )
IRequestHandler''* 9
<''9 :
ImportLayoutCommand'': M
,''M N
TableLayoutDto''O ]
>''] ^
{(( 
private)) 
readonly)) "
ITableLayoutRepository)) +"
_tableLayoutRepository)), B
;))B C
private** 
readonly** 
TableLayoutExporter** (
	_exporter**) 2
;**2 3
public,, 
&
ImportLayoutCommandHandler,, %
(,,% &"
ITableLayoutRepository-- !
tableLayoutRepository-- 4
,--4 5
TableLayoutExporter.. 
exporter.. $
)..$ %
{// "
_tableLayoutRepository00 
=00  !
tableLayoutRepository00! 6
;006 7
	_exporter11 
=11 
exporter11 
;11 
}22 
public44 

async44 
Task44 
<44 
TableLayoutDto44 $
>44$ %
Handle44& ,
(44, -
ImportLayoutCommand44- @
request44A H
,44H I
CancellationToken44J [
cancellationToken44\ m
)44m n
{55 
if66 

(66 
!66 
File66 
.66 
Exists66 
(66 
request66  
.66  !
FilePath66! )
)66) *
)66* +
{77 	
throw88 
new88 !
FileNotFoundException88 +
(88+ ,
$"88, .
$str88. >
{88> ?
request88? F
.88F G
FilePath88G O
}88O P
"88P Q
)88Q R
;88R S
}99 	
var;; 
json;; 
=;; 
await;; 
File;; 
.;; 
ReadAllTextAsync;; .
(;;. /
request;;/ 6
.;;6 7
FilePath;;7 ?
,;;? @
cancellationToken;;A R
);;R S
;;;S T
var<< 
layout<< 
=<< 
	_exporter<< 
.<< 
ImportFromJson<< -
(<<- .
json<<. 2
)<<2 3
;<<3 4
var?? 
existingLayout?? 
=?? 
await?? ""
_tableLayoutRepository??# 9
.??9 : 
GetLayoutByNameAsync??: N
(??N O
layout??O U
.??U V
Name??V Z
,??Z [
cancellationToken??\ m
)??m n
;??n o
if@@ 

(@@ 
existingLayout@@ 
!=@@ 
null@@ "
)@@" #
{AA 	
varCC 
baseNameCC 
=CC 
layoutCC !
.CC! "
NameCC" &
;CC& '
varDD 
counterDD 
=DD 
$numDD 
;DD 
stringEE 
newNameEE 
;EE 
doFF 
{GG 
newNameHH 
=HH 
$"HH 
{HH 
baseNameHH %
}HH% &
$strHH& 1
{HH1 2
counterHH2 9
++HH9 ;
}HH; <
$strHH< =
"HH= >
;HH> ?
existingLayoutII 
=II  
awaitII! &"
_tableLayoutRepositoryII' =
.II= > 
GetLayoutByNameAsyncII> R
(IIR S
newNameIIS Z
,IIZ [
cancellationTokenII\ m
)IIm n
;IIn o
}JJ 
whileJJ 
(JJ 
existingLayoutJJ #
!=JJ$ &
nullJJ' +
&&JJ, .
counterJJ/ 6
<JJ7 8
$numJJ9 <
)JJ< =
;JJ= >
layoutLL 
.LL 
NameLL 
=LL 
newNameLL !
;LL! "
}MM 	
varPP 
commandPP 
=PP 
newPP $
CreateTableLayoutCommandPP 2
(PP2 3
layoutPP3 9
.PP9 :
NamePP: >
,PP> ?
layoutPP@ F
.PPF G
FloorIdPPG N
,PPN O
layoutPPP V
.PPV W
TablesPPW ]
)PP] ^
;PP^ _
returnSS 
layoutSS 
;SS 
}TT 
}UU 
publicWW 
classWW *
ExportAllLayoutsCommandHandlerWW +
:WW, -
IRequestHandlerWW. =
<WW= >#
ExportAllLayoutsCommandWW> U
,WWU V
stringWWW ]
>WW] ^
{XX 
privateYY 
readonlyYY "
ITableLayoutRepositoryYY +"
_tableLayoutRepositoryYY, B
;YYB C
privateZZ 
readonlyZZ 
TableLayoutExporterZZ (
	_exporterZZ) 2
;ZZ2 3
public\\ 
*
ExportAllLayoutsCommandHandler\\ )
(\\) *"
ITableLayoutRepository]] !
tableLayoutRepository]] 4
,]]4 5
TableLayoutExporter^^ 
exporter^^ $
)^^$ %
{__ "
_tableLayoutRepository`` 
=``  !
tableLayoutRepository``! 6
;``6 7
	_exporteraa 
=aa 
exporteraa 
;aa 
}bb 
publicdd 

asyncdd 
Taskdd 
<dd 
stringdd 
>dd 
Handledd $
(dd$ %#
ExportAllLayoutsCommanddd% <
requestdd= D
,ddD E
CancellationTokenddF W
cancellationTokenddX i
)ddi j
{ee 
varff 
layoutsff 
=ff 
awaitff "
_tableLayoutRepositoryff 2
.ff2 3
GetAllAsyncff3 >
(ff> ?
cancellationTokenff? P
)ffP Q
;ffQ R
vargg 

layoutDtosgg 
=gg 
layoutsgg  
.gg  !
Selectgg! '
(gg' (
layoutgg( .
=>gg/ 1
newgg2 5
TableLayoutDtogg6 D
{hh 	
Idii 
=ii 
layoutii 
.ii 
Idii 
,ii 
Namejj 
=jj 
layoutjj 
.jj 
Namejj 
,jj 
FloorIdkk 
=kk 
layoutkk 
.kk 
FloorIdkk $
,kk$ %
Tablesll 
=ll 
layoutll 
.ll 
Tablesll "
.ll" #
Selectll# )
(ll) *
tll* +
=>ll, .
newll/ 2
TableDtoll3 ;
{mm 
Idnn 
=nn 
tnn 
.nn 
Idnn 
,nn 
TableNumberoo 
=oo 
too 
.oo  
TableNumberoo  +
,oo+ ,
Capacitypp 
=pp 
tpp 
.pp 
Capacitypp %
,pp% &
Xqq 
=qq 
tqq 
.qq 
Xqq 
,qq 
Yrr 
=rr 
trr 
.rr 
Yrr 
,rr 
Statusss 
=ss 
tss 
.ss 
Statusss !
,ss! "
IsActivett 
=tt 
ttt 
.tt 
IsActivett %
}uu 
)uu 
.uu 
ToListuu 
(uu 
)uu 
,uu 
	CreatedAtvv 
=vv 
layoutvv 
.vv 
	CreatedAtvv (
,vv( )
	UpdatedAtww 
=ww 
layoutww 
.ww 
	UpdatedAtww (
,ww( )
IsActivexx 
=xx 
layoutxx 
.xx 
IsActivexx &
,xx& '
Versionyy 
=yy 
layoutyy 
.yy 
Versionyy $
}zz 	
)zz	 

.zz
 
ToListzz 
(zz 
)zz 
;zz 
var|| 
json|| 
=|| 
	_exporter|| 
.||  
ExportMultipleToJson|| 1
(||1 2

layoutDtos||2 <
)||< =
;||= >
await 
File 
. 
WriteAllTextAsync $
($ %
request% ,
., -
FilePath- 5
,5 6
json7 ;
,; <
cancellationToken= N
)N O
;O P
return
ÅÅ 
request
ÅÅ 
.
ÅÅ 
FilePath
ÅÅ 
;
ÅÅ  
}
ÇÇ 
}ÉÉ 
publicÖÖ 
class
ÖÖ .
 ValidateLayoutFileCommandHandler
ÖÖ -
:
ÖÖ. /
IRequestHandler
ÖÖ0 ?
<
ÖÖ? @'
ValidateLayoutFileCommand
ÖÖ@ Y
,
ÖÖY Z$
LayoutValidationResult
ÖÖ[ q
>
ÖÖq r
{ÜÜ 
private
áá 
readonly
áá !
TableLayoutExporter
áá (
	_exporter
áá) 2
;
áá2 3
public
ââ 
.
 ValidateLayoutFileCommandHandler
ââ +
(
ââ+ ,!
TableLayoutExporter
ââ, ?
exporter
ââ@ H
)
ââH I
{
ää 
	_exporter
ãã 
=
ãã 
exporter
ãã 
;
ãã 
}
åå 
public
éé 

async
éé 
Task
éé 
<
éé $
LayoutValidationResult
éé ,
>
éé, -
Handle
éé. 4
(
éé4 5'
ValidateLayoutFileCommand
éé5 N
request
ééO V
,
ééV W
CancellationToken
ééX i
cancellationToken
ééj {
)
éé{ |
{
èè 
var
êê 
result
êê 
=
êê 
new
êê $
LayoutValidationResult
êê /
(
êê/ 0
)
êê0 1
;
êê1 2
try
íí 
{
ìì 	
if
îî 
(
îî 
!
îî 
File
îî 
.
îî 
Exists
îî 
(
îî 
request
îî $
.
îî$ %
FilePath
îî% -
)
îî- .
)
îî. /
{
ïï 
result
ññ 
.
ññ 
IsValid
ññ 
=
ññ  
false
ññ! &
;
ññ& '
result
óó 
.
óó 
ErrorMessage
óó #
=
óó$ %
$str
óó& 7
;
óó7 8
return
òò 
result
òò 
;
òò 
}
ôô 
var
õõ 
json
õõ 
=
õõ 
await
õõ 
File
õõ !
.
õõ! "
ReadAllTextAsync
õõ" 2
(
õõ2 3
request
õõ3 :
.
õõ: ;
FilePath
õõ; C
,
õõC D
cancellationToken
õõE V
)
õõV W
;
õõW X
try
ûû 
{
üü 
var
†† 
layout
†† 
=
†† 
	_exporter
†† &
.
††& '
ImportFromJson
††' 5
(
††5 6
json
††6 :
)
††: ;
;
††; <
result
°° 
.
°° 
IsValid
°° 
=
°°  
true
°°! %
;
°°% &
result
¢¢ 
.
¢¢ 
LayoutCount
¢¢ "
=
¢¢# $
$num
¢¢% &
;
¢¢& '
result
££ 
.
££ 

TableCount
££ !
=
££" #
layout
££$ *
.
££* +
Tables
££+ 1
.
££1 2
Count
££2 7
;
££7 8
result
§§ 
.
§§ 
Metadata
§§ 
=
§§  !
$"
§§" $
$str
§§$ ,
{
§§, -
layout
§§- 3
.
§§3 4
Name
§§4 8
}
§§8 9
"
§§9 :
;
§§: ;
return
•• 
result
•• 
;
•• 
}
¶¶ 
catch
ßß 
{
®® 
try
™™ 
{
´´ 
var
¨¨ 
layouts
¨¨ 
=
¨¨  !
	_exporter
¨¨" +
.
¨¨+ ,$
ImportMultipleFromJson
¨¨, B
(
¨¨B C
json
¨¨C G
)
¨¨G H
;
¨¨H I
result
≠≠ 
.
≠≠ 
IsValid
≠≠ "
=
≠≠# $
true
≠≠% )
;
≠≠) *
result
ÆÆ 
.
ÆÆ 
LayoutCount
ÆÆ &
=
ÆÆ' (
layouts
ÆÆ) 0
.
ÆÆ0 1
Count
ÆÆ1 6
;
ÆÆ6 7
result
ØØ 
.
ØØ 

TableCount
ØØ %
=
ØØ& '
layouts
ØØ( /
.
ØØ/ 0
Sum
ØØ0 3
(
ØØ3 4
l
ØØ4 5
=>
ØØ6 8
l
ØØ9 :
.
ØØ: ;
Tables
ØØ; A
.
ØØA B
Count
ØØB G
)
ØØG H
;
ØØH I
result
∞∞ 
.
∞∞ 
Metadata
∞∞ #
=
∞∞$ %
$"
∞∞& (
$str
∞∞( :
{
∞∞: ;
layouts
∞∞; B
.
∞∞B C
Count
∞∞C H
}
∞∞H I
"
∞∞I J
;
∞∞J K
return
±± 
result
±± !
;
±±! "
}
≤≤ 
catch
≥≥ 
{
¥¥ 
try
∂∂ 
{
∑∑ 
var
∏∏ 
backupLayouts
∏∏ )
=
∏∏* +
	_exporter
∏∏, 5
.
∏∏5 6
RestoreFromBackup
∏∏6 G
(
∏∏G H
json
∏∏H L
)
∏∏L M
;
∏∏M N
result
ππ 
.
ππ 
IsValid
ππ &
=
ππ' (
true
ππ) -
;
ππ- .
result
∫∫ 
.
∫∫ 
LayoutCount
∫∫ *
=
∫∫+ ,
backupLayouts
∫∫- :
.
∫∫: ;
Count
∫∫; @
;
∫∫@ A
result
ªª 
.
ªª 

TableCount
ªª )
=
ªª* +
backupLayouts
ªª, 9
.
ªª9 :
Sum
ªª: =
(
ªª= >
l
ªª> ?
=>
ªª@ B
l
ªªC D
.
ªªD E
Tables
ªªE K
.
ªªK L
Count
ªªL Q
)
ªªQ R
;
ªªR S
result
ºº 
.
ºº 
Metadata
ºº '
=
ºº( )
$str
ºº* 7
;
ºº7 8
return
ΩΩ 
result
ΩΩ %
;
ΩΩ% &
}
ææ 
catch
øø 
{
¿¿ 
result
¡¡ 
.
¡¡ 
IsValid
¡¡ &
=
¡¡' (
false
¡¡) .
;
¡¡. /
result
¬¬ 
.
¬¬ 
ErrorMessage
¬¬ +
=
¬¬, -
$str¬¬. Ö
;¬¬Ö Ü
return
√√ 
result
√√ %
;
√√% &
}
ƒƒ 
}
≈≈ 
}
∆∆ 
}
«« 	
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»» 
{
…… 	
result
   
.
   
IsValid
   
=
   
false
   "
;
  " #
result
ÀÀ 
.
ÀÀ 
ErrorMessage
ÀÀ 
=
ÀÀ  !
$"
ÀÀ" $
$str
ÀÀ$ 6
{
ÀÀ6 7
ex
ÀÀ7 9
.
ÀÀ9 :
Message
ÀÀ: A
}
ÀÀA B
"
ÀÀB C
;
ÀÀC D
return
ÃÃ 
result
ÃÃ 
;
ÃÃ 
}
ÕÕ 	
}
ŒŒ 
}œœ ¸
uC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\EventPublisher.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
{ 
public		 

class		 
EventPublisher		 
:		  !
IEventPublisher		" 1
{

 
public 
Task 
PublishAsync  
<  !
T! "
>" #
(# $
T$ %
@event& ,
), -
where. 3
T4 5
:6 7
class8 =
{ 	
System 
. 
Diagnostics 
. 
Debug $
.$ %
	WriteLine% .
(. /
$"/ 1
$str1 B
{B C
@eventC I
.I J
GetTypeJ Q
(Q R
)R S
.S T
NameT X
}X Y
"Y Z
)Z [
;[ \
return 
Task 
. 
CompletedTask %
;% &
} 	
} 
} ≠s
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\DeliveryCommandHandlers.cs
	namespace

 	
Magidesk


 
.

 
Application

 
.

 
Services

 '
;

' (
public 
class +
MarkTicketAsReadyCommandHandler ,
:- .
ICommandHandler/ >
<> ?$
MarkTicketAsReadyCommand? W
>W X
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
+
MarkTicketAsReadyCommandHandler *
(* +
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! "$
MarkTicketAsReadyCommand" :
command; B
,B C
CancellationTokenD U
cancellationTokenV g
=h i
defaultj q
)q r
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
throw 
new *
BusinessRuleViolationException 4
(4 5
$"5 7
$str7 >
{> ?
command? F
.F G
TicketIdG O
}O P
$strP [
"[ \
)\ ]
;] ^
ticket 
. 
MarkAsReady 
( 
) 
; 
await!! 
_ticketRepository!! 
.!!  
UpdateAsync!!  +
(!!+ ,
ticket!!, 2
,!!2 3
cancellationToken!!4 E
)!!E F
;!!F G
await## !
_auditEventRepository## #
.### $
AddAsync##$ ,
(##, -

AuditEvent##- 7
.##7 8
Create##8 >
(##> ?
AuditEventType$$ 
.$$ 
Modified$$ #
,$$# $
nameof%% 
(%% 
Ticket%% 
)%% 
,%% 
ticket&& 
.&& 
Id&& 
,&& 
command'' 
.'' 
UserId'' 
,'' 
System(( 
.(( 
Text(( 
.(( 
Json(( 
.(( 
JsonSerializer(( +
.((+ ,
	Serialize((, 5
(((5 6
new((6 9
{((: ;
	ReadyTime((< E
=((F G
ticket((H N
.((N O
	ReadyTime((O X
}((Y Z
)((Z [
,(([ \
$")) 
$str)) 
{)) 
ticket)) 
.)) 
TicketNumber)) )
}))) *
$str))* :
")): ;
,)); <
null** 
,** 
Guid++ 
.++ 
NewGuid++ 
(++ 
)++ 
),, 	
,,,	 

cancellationToken,, 
),, 
;,, 
}-- 
}.. 
public00 
class00 (
DispatchTicketCommandHandler00 )
:00* +
ICommandHandler00, ;
<00; <!
DispatchTicketCommand00< Q
>00Q R
{11 
private22 
readonly22 
ITicketRepository22 &
_ticketRepository22' 8
;228 9
private33 
readonly33 !
IAuditEventRepository33 *!
_auditEventRepository33+ @
;33@ A
public55 
(
DispatchTicketCommandHandler55 '
(55' (
ITicketRepository66 
ticketRepository66 *
,66* +!
IAuditEventRepository77  
auditEventRepository77 2
)772 3
{88 
_ticketRepository99 
=99 
ticketRepository99 ,
;99, -!
_auditEventRepository:: 
=::  
auditEventRepository::  4
;::4 5
};; 
public== 

async== 
Task== 
HandleAsync== !
(==! "!
DispatchTicketCommand==" 7
command==8 ?
,==? @
CancellationToken==A R
cancellationToken==S d
===e f
default==g n
)==n o
{>> 
var?? 
ticket?? 
=?? 
await?? 
_ticketRepository?? ,
.??, -
GetByIdAsync??- 9
(??9 :
command??: A
.??A B
TicketId??B J
,??J K
cancellationToken??L ]
)??] ^
;??^ _
if@@ 

(@@ 
ticket@@ 
==@@ 
null@@ 
)@@ 
throwAA 
newAA *
BusinessRuleViolationExceptionAA 4
(AA4 5
$"AA5 7
$strAA7 >
{AA> ?
commandAA? F
.AAF G
TicketIdAAG O
}AAO P
$strAAP [
"AA[ \
)AA\ ]
;AA] ^
ticketCC 
.CC 
MarkAsDispatchedCC 
(CC  
commandCC  '
.CC' (
DriverIdCC( 0
)CC0 1
;CC1 2
awaitEE 
_ticketRepositoryEE 
.EE  
UpdateAsyncEE  +
(EE+ ,
ticketEE, 2
,EE2 3
cancellationTokenEE4 E
)EEE F
;EEF G
awaitGG !
_auditEventRepositoryGG #
.GG# $
AddAsyncGG$ ,
(GG, -

AuditEventGG- 7
.GG7 8
CreateGG8 >
(GG> ?
AuditEventTypeHH 
.HH 
ModifiedHH #
,HH# $
nameofII 
(II 
TicketII 
)II 
,II 
ticketJJ 
.JJ 
IdJJ 
,JJ 
commandKK 
.KK 
UserIdKK 
,KK 
SystemLL 
.LL 
TextLL 
.LL 
JsonLL 
.LL 
JsonSerializerLL +
.LL+ ,
	SerializeLL, 5
(LL5 6
newLL6 9
{LL: ;
DispatchedTimeLL< J
=LLK L
ticketLLM S
.LLS T
DispatchedTimeLLT b
,LLb c
DriverIdLLd l
=LLm n
commandLLo v
.LLv w
DriverIdLLw 
}
LLÄ Å
)
LLÅ Ç
,
LLÇ É
$"MM 
$strMM 
{MM 
ticketMM 
.MM 
TicketNumberMM )
}MM) *
$strMM* 5
"MM5 6
,MM6 7
nullNN 
,NN 
GuidOO 
.OO 
NewGuidOO 
(OO 
)OO 
)PP 	
,PP	 

cancellationTokenPP 
)PP 
;PP 
}QQ 
}RR 
publicTT 
classTT (
ScheduleTicketCommandHandlerTT )
:TT* +
ICommandHandlerTT, ;
<TT; <!
ScheduleTicketCommandTT< Q
>TTQ R
{UU 
privateVV 
readonlyVV 
ITicketRepositoryVV &
_ticketRepositoryVV' 8
;VV8 9
privateWW 
readonlyWW !
IAuditEventRepositoryWW *!
_auditEventRepositoryWW+ @
;WW@ A
publicYY 
(
ScheduleTicketCommandHandlerYY '
(YY' (
ITicketRepositoryZZ 
ticketRepositoryZZ *
,ZZ* +!
IAuditEventRepository[[  
auditEventRepository[[ 2
)[[2 3
{\\ 
_ticketRepository]] 
=]] 
ticketRepository]] ,
;]], -!
_auditEventRepository^^ 
=^^  
auditEventRepository^^  4
;^^4 5
}__ 
publicaa 

asyncaa 
Taskaa 
HandleAsyncaa !
(aa! "!
ScheduleTicketCommandaa" 7
commandaa8 ?
,aa? @
CancellationTokenaaA R
cancellationTokenaaS d
=aae f
defaultaag n
)aan o
{bb 
varcc 
ticketcc 
=cc 
awaitcc 
_ticketRepositorycc ,
.cc, -
GetByIdAsynccc- 9
(cc9 :
commandcc: A
.ccA B
TicketIdccB J
,ccJ K
cancellationTokenccL ]
)cc] ^
;cc^ _
ifdd 

(dd 
ticketdd 
==dd 
nulldd 
)dd 
throwee 
newee *
BusinessRuleViolationExceptionee 4
(ee4 5
$"ee5 7
$stree7 >
{ee> ?
commandee? F
.eeF G
TicketIdeeG O
}eeO P
$streeP [
"ee[ \
)ee\ ]
;ee] ^
ticketgg 
.gg 
Schedulegg 
(gg 
commandgg 
.gg  
DeliveryDategg  ,
)gg, -
;gg- .
awaitii 
_ticketRepositoryii 
.ii  
UpdateAsyncii  +
(ii+ ,
ticketii, 2
,ii2 3
cancellationTokenii4 E
)iiE F
;iiF G
awaitkk !
_auditEventRepositorykk #
.kk# $
AddAsynckk$ ,
(kk, -

AuditEventkk- 7
.kk7 8
Createkk8 >
(kk> ?
AuditEventTypell 
.ll 
Modifiedll #
,ll# $
nameofmm 
(mm 
Ticketmm 
)mm 
,mm 
ticketnn 
.nn 
Idnn 
,nn 
commandoo 
.oo 
UserIdoo 
,oo 
Systempp 
.pp 
Textpp 
.pp 
Jsonpp 
.pp 
JsonSerializerpp +
.pp+ ,
	Serializepp, 5
(pp5 6
newpp6 9
{pp: ;
DeliveryDatepp< H
=ppI J
ticketppK Q
.ppQ R
DeliveryDateppR ^
,pp^ _
Statuspp` f
=ppg h
ticketppi o
.ppo p
Statusppp v
}ppw x
)ppx y
,ppy z
$"qq 
$strqq 
{qq 
ticketqq 
.qq 
TicketNumberqq )
}qq) *
$strqq* 9
{qq9 :
ticketqq: @
.qq@ A
DeliveryDateqqA M
}qqM N
"qqN O
,qqO P
nullrr 
,rr 
Guidss 
.ss 
NewGuidss 
(ss 
)ss 
)tt 	
,tt	 

cancellationTokentt 
)tt 
;tt 
}uu 
}vv 
publicxx 
classxx .
"FireScheduledTicketsCommandHandlerxx /
:xx0 1
ICommandHandlerxx2 A
<xxA B'
FireScheduledTicketsCommandxxB ]
>xx] ^
{yy 
privatezz 
readonlyzz 
ITicketRepositoryzz &
_ticketRepositoryzz' 8
;zz8 9
private{{ 
readonly{{ !
IAuditEventRepository{{ *!
_auditEventRepository{{+ @
;{{@ A
public}} 
.
"FireScheduledTicketsCommandHandler}} -
(}}- .
ITicketRepository~~ 
ticketRepository~~ *
,~~* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{
ÄÄ 
_ticketRepository
ÅÅ 
=
ÅÅ 
ticketRepository
ÅÅ ,
;
ÅÅ, -#
_auditEventRepository
ÇÇ 
=
ÇÇ "
auditEventRepository
ÇÇ  4
;
ÇÇ4 5
}
ÉÉ 
public
ÖÖ 

async
ÖÖ 
Task
ÖÖ 
HandleAsync
ÖÖ !
(
ÖÖ! ")
FireScheduledTicketsCommand
ÖÖ" =
command
ÖÖ> E
,
ÖÖE F
CancellationToken
ÖÖG X
cancellationToken
ÖÖY j
=
ÖÖk l
default
ÖÖm t
)
ÖÖt u
{
ÜÜ 
var
áá 
ticketsToFire
áá 
=
áá 
await
áá !
_ticketRepository
áá" 3
.
áá3 4)
GetScheduledTicketsDueAsync
áá4 O
(
ááO P
command
ááP W
.
ááW X
DueBy
ááX ]
,
áá] ^
cancellationToken
áá_ p
)
ááp q
;
ááq r
foreach
ââ 
(
ââ 
var
ââ 
ticket
ââ 
in
ââ 
ticketsToFire
ââ ,
)
ââ, -
{
ää 	
try
ãã 
{
åå 
ticket
çç 
.
çç 
Fire
çç 
(
çç 
)
çç 
;
çç 
await
éé 
_ticketRepository
éé '
.
éé' (
UpdateAsync
éé( 3
(
éé3 4
ticket
éé4 :
,
éé: ;
cancellationToken
éé< M
)
ééM N
;
ééN O
await
êê #
_auditEventRepository
êê +
.
êê+ ,
AddAsync
êê, 4
(
êê4 5

AuditEvent
êê5 ?
.
êê? @
Create
êê@ F
(
êêF G
AuditEventType
ëë "
.
ëë" #
Modified
ëë# +
,
ëë+ ,
nameof
íí 
(
íí 
Ticket
íí !
)
íí! "
,
íí" #
ticket
ìì 
.
ìì 
Id
ìì 
,
ìì 
Guid
îî 
.
îî 
Empty
îî 
,
îî 
System
ïï 
.
ïï 
Text
ïï 
.
ïï  
Json
ïï  $
.
ïï$ %
JsonSerializer
ïï% 3
.
ïï3 4
	Serialize
ïï4 =
(
ïï= >
new
ïï> A
{
ïïB C
Action
ïïD J
=
ïïK L
$str
ïïM W
,
ïïW X
Time
ïïY ]
=
ïï^ _
DateTime
ïï` h
.
ïïh i
UtcNow
ïïi o
}
ïïp q
)
ïïq r
,
ïïr s
$"
ññ 
$str
ññ 
{
ññ 
ticket
ññ $
.
ññ$ %
TicketNumber
ññ% 1
}
ññ1 2
$str
ññ2 T
"
ññT U
,
ññU V
null
óó 
,
óó 
Guid
òò 
.
òò 
NewGuid
òò  
(
òò  !
)
òò! "
)
ôô 
,
ôô 
cancellationToken
ôô $
)
ôô$ %
;
ôô% &
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
úú 
}
†† 
}
°° 	
}
¢¢ 
}££ ∑8
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CreateTicketCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class &
CreateTicketCommandHandler '
:( )
ICommandHandler* 9
<9 :
CreateTicketCommand: M
,M N
CreateTicketResultO a
>a b
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
&
CreateTicketCommandHandler %
(% &
ITicketRepository 
ticketRepository *
,* +
ITableRepository 
tableRepository (
,( )!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_tableRepository 
= 
tableRepository *
;* +!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
CreateTicketResult (
>( )
HandleAsync* 5
(5 6
CreateTicketCommand6 I
commandJ Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
var 
ticketNumber 
= 
await  
_ticketRepository! 2
.2 3$
GetNextTicketNumberAsync3 K
(K L
cancellationTokenL ]
)] ^
;^ _
var!! 
ticket!! 
=!! 
Ticket!! 
.!! 
Create!! "
(!!" #
ticketNumber"" 
,"" 
command## 
.## 
	CreatedBy## 
,## 
command$$ 
.$$ 

TerminalId$$ 
,$$ 
command%% 
.%% 
ShiftId%% 
,%% 
command&& 
.&& 
OrderTypeId&& 
,&&  
command'' 
.'' 
GlobalId'' 
)'' 
;'' 
if** 

(** 
command** 
.** 
NumberOfGuests** "
>**# $
$num**% &
)**& '
{++ 	
ticket,, 
.,, 
SetNumberOfGuests,, $
(,,$ %
command,,% ,
.,,, -
NumberOfGuests,,- ;
),,; <
;,,< =
}-- 	
if00 

(00 
command00 
.00 

CustomerId00 
.00 
HasValue00 '
)00' (
{11 	
}44 	
if66 

(66 
command66 
.66 
TableNumbers66  
!=66! #
null66$ (
)66( )
{77 	
foreach88 
(88 
var88 
tableNumber88 $
in88% '
command88( /
.88/ 0
TableNumbers880 <
)88< =
{99 
ticket:: 
.:: 
AddTableNumber:: %
(::% &
tableNumber::& 1
)::1 2
;::2 3
var== 
table== 
=== 
await== !
_tableRepository==" 2
.==2 3!
GetByTableNumberAsync==3 H
(==H I
tableNumber==I T
,==T U
cancellationToken==V g
)==g h
;==h i
if>> 
(>> 
table>> 
!=>> 
null>> !
)>>! "
{?? 
if@@ 
(@@ 
table@@ 
.@@ 
Status@@ $
!=@@% '
Domain@@( .
.@@. /
Enumerations@@/ ;
.@@; <
TableStatus@@< G
.@@G H
	Available@@H Q
)@@Q R
{AA 
throwCC 
newCC !
DomainCC" (
.CC( )

ExceptionsCC) 3
.CC3 4*
BusinessRuleViolationExceptionCC4 R
(CCR S
$"CCS U
$strCCU [
{CC[ \
tableNumberCC\ g
}CCg h
$str	CCh Ü
{
CCÜ á
table
CCá å
.
CCå ç
Status
CCç ì
}
CCì î
$str
CCî ñ
"
CCñ ó
)
CCó ò
;
CCò ô
}DD 
tableGG 
.GG 
AssignTicketGG &
(GG& '
ticketGG' -
.GG- .
IdGG. 0
)GG0 1
;GG1 2
awaitHH 
_tableRepositoryHH *
.HH* +
UpdateAsyncHH+ 6
(HH6 7
tableHH7 <
,HH< =
cancellationTokenHH> O
)HHO P
;HHP Q
}II 
}JJ 
}KK 	
awaitNN 
_ticketRepositoryNN 
.NN  
AddAsyncNN  (
(NN( )
ticketNN) /
,NN/ 0
cancellationTokenNN1 B
)NNB C
;NNC D
varQQ 
correlationIdQQ 
=QQ 
GuidQQ  
.QQ  !
NewGuidQQ! (
(QQ( )
)QQ) *
;QQ* +
varRR 

auditEventRR 
=RR 

AuditEventRR #
.RR# $
CreateRR$ *
(RR* +
DomainSS 
.SS 
EnumerationsSS 
.SS  
AuditEventTypeSS  .
.SS. /
CreatedSS/ 6
,SS6 7
nameofTT 
(TT 
TicketTT 
)TT 
,TT 
ticketUU 
.UU 
IdUU 
,UU 
commandVV 
.VV 
	CreatedByVV 
.VV 
ValueVV #
,VV# $
SystemWW 
.WW 
TextWW 
.WW 
JsonWW 
.WW 
JsonSerializerWW +
.WW+ ,
	SerializeWW, 5
(WW5 6
newWW6 9
{WW: ;
ticketWW< B
.WWB C
TicketNumberWWC O
,WWO P
ticketWWQ W
.WWW X
StatusWWX ^
}WW_ `
)WW` a
,WWa b
$"XX 
$strXX 
{XX 
ticketNumberXX "
}XX" #
$strXX# +
"XX+ ,
,XX, -
correlationIdYY 
:YY 
correlationIdYY (
)YY( )
;YY) *
await[[ !
_auditEventRepository[[ #
.[[# $
AddAsync[[$ ,
([[, -

auditEvent[[- 7
,[[7 8
cancellationToken[[9 J
)[[J K
;[[K L
return]] 
new]] 
CreateTicketResult]] %
{^^ 	
TicketId__ 
=__ 
ticket__ 
.__ 
Id__  
,__  !
TicketNumber`` 
=`` 
ticket`` !
.``! "
TicketNumber``" .
}aa 	
;aa	 

}bb 
}cc îf
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CreateTableLayoutCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class +
CreateTableLayoutCommandHandler ,
:- .
IRequestHandler/ >
<> ?$
CreateTableLayoutCommand? W
,W X
TableLayoutDtoY g
>g h
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly "
ITableLayoutRepository +"
_tableLayoutRepository, B
;B C
public 
+
CreateTableLayoutCommandHandler *
(* +
ITableRepository 
tableRepository (
,( )"
ITableLayoutRepository !
tableLayoutRepository 4
)4 5
{ 
_tableRepository 
= 
tableRepository *
;* +"
_tableLayoutRepository 
=  !
tableLayoutRepository! 6
;6 7
} 
public 

async 
Task 
< 
TableLayoutDto $
>$ %
Handle& ,
(, -$
CreateTableLayoutCommand- E
requestF M
,M N
CancellationTokenO `
cancellationTokena r
)r s
{ 
var 
layout 
= 
TableLayout  
.  !
Create! '
(' (
request 
. 
Name 
, 
request 
. 
FloorId 
, 
request 
. 
IsDraft 
) 	
;	 

foreach"" 
("" 
var"" 
tableDto"" 
in""  
request""! (
.""( )
Tables"") /
)""/ 0
{## 	
var$$ 
table$$ 
=$$ 
Table$$ 
.$$ 
Create$$ $
($$$ %
tableDto%% 
.%% 
TableNumber%% $
,%%$ %
tableDto&& 
.&& 
Capacity&& !
,&&! "
tableDto'' 
.'' 
X'' 
,'' 
tableDto(( 
.(( 
Y(( 
,(( 
request)) 
.)) 
FloorId)) 
)** 
;** 
layout,, 
.,, 
AddTable,, 
(,, 
table,, !
),,! "
;,," #
}-- 	
await00 "
_tableLayoutRepository00 $
.00$ %
AddAsync00% -
(00- .
layout00. 4
,004 5
cancellationToken006 G
)00G H
;00H I
return33 
TableMapper33 
.33 
ToLayoutDto33 &
(33& '
layout33' -
)33- .
;33. /
}44 
}55 
public77 
class77 -
!UpdateTablePositionCommandHandler77 .
:77/ 0
IRequestHandler771 @
<77@ A&
UpdateTablePositionCommand77A [
,77[ \
TableDto77] e
>77e f
{88 
private99 
readonly99 
ITableRepository99 %
_tableRepository99& 6
;996 7
public;; 
-
!UpdateTablePositionCommandHandler;; ,
(;;, -
ITableRepository;;- =
tableRepository;;> M
);;M N
{<< 
_tableRepository== 
=== 
tableRepository== *
;==* +
}>> 
public@@ 

async@@ 
Task@@ 
<@@ 
TableDto@@ 
>@@ 
Handle@@  &
(@@& '&
UpdateTablePositionCommand@@' A
request@@B I
,@@I J
CancellationToken@@K \
cancellationToken@@] n
)@@n o
{AA 
varBB 
tableBB 
=BB 
awaitBB 
_tableRepositoryBB *
.BB* +
GetByIdAsyncBB+ 7
(BB7 8
requestBB8 ?
.BB? @
TableIdBB@ G
,BBG H
cancellationTokenBBI Z
)BBZ [
;BB[ \
ifCC 

(CC 
tableCC 
==CC 
nullCC 
)CC 
{DD 	
throwEE 
newEE  
KeyNotFoundExceptionEE *
(EE* +
$"EE+ -
$strEE- ;
{EE; <
requestEE< C
.EEC D
TableIdEED K
}EEK L
$strEEL W
"EEW X
)EEX Y
;EEY Z
}FF 	
tableII 
.II 
UpdateGeometryII 
(II 
requestII $
.II$ %
XII% &
,II& '
requestII( /
.II/ 0
YII0 1
,II1 2
requestII3 :
.II: ;
ShapeII; @
,II@ A
requestIIB I
.III J
WidthIIJ O
,IIO P
requestIIQ X
.IIX Y
HeightIIY _
)II_ `
;II` a
awaitKK 
_tableRepositoryKK 
.KK 
UpdateAsyncKK *
(KK* +
tableKK+ 0
,KK0 1
cancellationTokenKK2 C
)KKC D
;KKD E
returnMM 
TableMapperMM 
.MM 
ToDtoMM  
(MM  !
tableMM! &
)MM& '
;MM' (
}NN 
}OO 
publicQQ 
classQQ *
AddTableToLayoutCommandHandlerQQ +
:QQ, -
IRequestHandlerQQ. =
<QQ= >#
AddTableToLayoutCommandQQ> U
,QQU V
TableDtoQQW _
>QQ_ `
{RR 
privateSS 
readonlySS 
ITableRepositorySS %
_tableRepositorySS& 6
;SS6 7
privateTT 
readonlyTT "
ITableLayoutRepositoryTT +"
_tableLayoutRepositoryTT, B
;TTB C
publicVV 
*
AddTableToLayoutCommandHandlerVV )
(VV) *
ITableRepositoryWW 
tableRepositoryWW (
,WW( )"
ITableLayoutRepositoryXX !
tableLayoutRepositoryXX 4
)XX4 5
{YY 
_tableRepositoryZZ 
=ZZ 
tableRepositoryZZ *
;ZZ* +"
_tableLayoutRepository[[ 
=[[  !
tableLayoutRepository[[! 6
;[[6 7
}\\ 
public^^ 

async^^ 
Task^^ 
<^^ 
TableDto^^ 
>^^ 
Handle^^  &
(^^& '#
AddTableToLayoutCommand^^' >
request^^? F
,^^F G
CancellationToken^^H Y
cancellationToken^^Z k
)^^k l
{__ 
varaa 
tableaa 
=aa 
Tableaa 
.aa 
Createaa  
(aa  !
requestbb 
.bb 
TableNumberbb 
,bb  
requestcc 
.cc 
Capacitycc 
,cc 
requestdd 
.dd 
Xdd 
,dd 
requestee 
.ee 
Yee 
,ee 
nullff 
,ff 
requestgg 
.gg 
LayoutIdgg 
,gg 
truehh 
,hh 
requestii 
.ii 
Shapeii 
,ii 
requestjj 
.jj 
Widthjj 
,jj 
requestkk 
.kk 
Heightkk 
)ll 	
;ll	 

awaitoo 
_tableRepositoryoo 
.oo 
AddAsyncoo '
(oo' (
tableoo( -
,oo- .
cancellationTokenoo/ @
)oo@ A
;ooA B
returnqq 
TableMapperqq 
.qq 
ToDtoqq  
(qq  !
tableqq! &
)qq& '
;qq' (
}rr 
}ss 
publicuu 
classuu )
SaveTableLayoutCommandHandleruu *
:uu+ ,
IRequestHandleruu- <
<uu< ="
SaveTableLayoutCommanduu= S
,uuS T
TableLayoutDtouuU c
>uuc d
{vv 
privateww 
readonlyww "
ITableLayoutRepositoryww +"
_tableLayoutRepositoryww, B
;wwB C
privatexx 
readonlyxx 
ITableRepositoryxx %
_tableRepositoryxx& 6
;xx6 7
publiczz 
)
SaveTableLayoutCommandHandlerzz (
(zz( )"
ITableLayoutRepository{{ !
tableLayoutRepository{{ 4
,{{4 5
ITableRepository|| 
tableRepository|| (
)||( )
{}} "
_tableLayoutRepository~~ 
=~~  !
tableLayoutRepository~~! 6
;~~6 7
_tableRepository 
= 
tableRepository *
;* +
}
ÄÄ 
public
ÇÇ 

async
ÇÇ 
Task
ÇÇ 
<
ÇÇ 
TableLayoutDto
ÇÇ $
>
ÇÇ$ %
Handle
ÇÇ& ,
(
ÇÇ, -$
SaveTableLayoutCommand
ÇÇ- C
request
ÇÇD K
,
ÇÇK L
CancellationToken
ÇÇM ^
cancellationToken
ÇÇ_ p
)
ÇÇp q
{
ÉÉ 
var
ÑÑ 
layout
ÑÑ 
=
ÑÑ 
await
ÑÑ $
_tableLayoutRepository
ÑÑ 1
.
ÑÑ1 2
GetByIdAsync
ÑÑ2 >
(
ÑÑ> ?
request
ÑÑ? F
.
ÑÑF G
LayoutId
ÑÑG O
,
ÑÑO P
cancellationToken
ÑÑQ b
)
ÑÑb c
;
ÑÑc d
if
ÖÖ 

(
ÖÖ 
layout
ÖÖ 
==
ÖÖ 
null
ÖÖ 
)
ÖÖ 
{
ÜÜ 	
throw
áá 
new
áá "
KeyNotFoundException
áá *
(
áá* +
$"
áá+ -
$str
áá- <
{
áá< =
request
áá= D
.
ááD E
LayoutId
ááE M
}
ááM N
$str
ááN Y
"
ááY Z
)
ááZ [
;
áá[ \
}
àà 	
layout
ää 
.
ää 

UpdateName
ää 
(
ää 
request
ää !
.
ää! "
Name
ää" &
)
ää& '
;
ää' (
if
åå 

(
åå 
request
åå 
.
åå 
IsDraft
åå 
.
åå 
HasValue
åå $
)
åå$ %
{
çç 	
layout
éé 
.
éé 
SetDraftStatus
éé !
(
éé! "
request
éé" )
.
éé) *
IsDraft
éé* 1
.
éé1 2
Value
éé2 7
)
éé7 8
;
éé8 9
}
èè 	
await
ïï $
_tableLayoutRepository
ïï $
.
ïï$ %
UpdateAsync
ïï% 0
(
ïï0 1
layout
ïï1 7
,
ïï7 8
cancellationToken
ïï9 J
)
ïïJ K
;
ïïK L
return
óó 
TableMapper
óó 
.
óó 
ToLayoutDto
óó &
(
óó& '
layout
óó' -
)
óó- .
;
óó. /
}
òò 
}ôô 
publicõõ 
class
õõ 1
#RemoveTableFromLayoutCommandHandler
õõ 0
:
õõ1 2
IRequestHandler
õõ3 B
<
õõB C*
RemoveTableFromLayoutCommand
õõC _
,
õõ_ `
bool
õõa e
>
õõe f
{úú 
private
ùù 
readonly
ùù $
ITableLayoutRepository
ùù +$
_tableLayoutRepository
ùù, B
;
ùùB C
public
üü 
1
#RemoveTableFromLayoutCommandHandler
üü .
(
üü. /$
ITableLayoutRepository
üü/ E#
tableLayoutRepository
üüF [
)
üü[ \
{
†† $
_tableLayoutRepository
°° 
=
°°  #
tableLayoutRepository
°°! 6
;
°°6 7
}
¢¢ 
public
§§ 

async
§§ 
Task
§§ 
<
§§ 
bool
§§ 
>
§§ 
Handle
§§ "
(
§§" #*
RemoveTableFromLayoutCommand
§§# ?
request
§§@ G
,
§§G H
CancellationToken
§§I Z
cancellationToken
§§[ l
)
§§l m
{
•• 
var
¶¶ 
layout
¶¶ 
=
¶¶ 
await
¶¶ $
_tableLayoutRepository
¶¶ 1
.
¶¶1 2
GetByIdAsync
¶¶2 >
(
¶¶> ?
request
¶¶? F
.
¶¶F G
LayoutId
¶¶G O
,
¶¶O P
cancellationToken
¶¶Q b
)
¶¶b c
;
¶¶c d
if
ßß 

(
ßß 
layout
ßß 
==
ßß 
null
ßß 
)
ßß 
return
ßß "
false
ßß# (
;
ßß( )
layout
©© 
.
©© 
RemoveTable
©© 
(
©© 
request
©© "
.
©©" #
TableId
©©# *
)
©©* +
;
©©+ ,
await
™™ $
_tableLayoutRepository
™™ $
.
™™$ %
UpdateAsync
™™% 0
(
™™0 1
layout
™™1 7
,
™™7 8
cancellationToken
™™9 J
)
™™J K
;
™™K L
return
¨¨ 
true
¨¨ 
;
¨¨ 
}
≠≠ 
}ÆÆ ì+
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CreateTableCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
CreateTableCommandHandler &
:' (
ICommandHandler) 8
<8 9
CreateTableCommand9 K
,K L
CreateTableResultM ^
>^ _
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
%
CreateTableCommandHandler $
($ %
ITableRepository 
tableRepository (
,( )!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_tableRepository 
= 
tableRepository *
;* +!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
CreateTableResult '
>' (
HandleAsync) 4
(4 5
CreateTableCommand5 G
commandH O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
existingTable 
= 
await !
_tableRepository" 2
.2 3!
GetByTableNumberAsync3 H
(H I
commandI P
.P Q
TableNumberQ \
,\ ]
cancellationToken^ o
)o p
;p q
if 

( 
existingTable 
!= 
null !
)! "
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI V
{V W
commandW ^
.^ _
TableNumber_ j
}j k
$strk {
"{ |
)| }
;} ~
} 	
var"" 
table"" 
="" 
Table"" 
."" 
Create""  
(""  !
command## 
.## 
TableNumber## 
,##  
command$$ 
.$$ 
Capacity$$ 
,$$ 
command%% 
.%% 
X%% 
,%% 
command&& 
.&& 
Y&& 
,&& 
command'' 
.'' 
FloorId'' 
,'' 
null(( 
,(( 
command)) 
.)) 
IsActive)) 
))) 
;)) 
await,, 
_tableRepository,, 
.,, 
AddAsync,, '
(,,' (
table,,( -
,,,- .
cancellationToken,,/ @
),,@ A
;,,A B
var// 
correlationId// 
=// 
Guid//  
.//  !
NewGuid//! (
(//( )
)//) *
;//* +
var00 

auditEvent00 
=00 

AuditEvent00 #
.00# $
Create00$ *
(00* +
AuditEventType11 
.11 
Created11 "
,11" #
nameof22 
(22 
Table22 
)22 
,22 
table33 
.33 
Id33 
,33 
Guid44 
.44 
Empty44 
,44 
System55 
.55 
Text55 
.55 
Json55 
.55 
JsonSerializer55 +
.55+ ,
	Serialize55, 5
(555 6
new556 9
{66 
TableNumber77 
=77 
table77 #
.77# $
TableNumber77$ /
,77/ 0
Capacity88 
=88 
table88  
.88  !
Capacity88! )
,88) *
X99 
=99 
table99 
.99 
X99 
,99 
Y:: 
=:: 
table:: 
.:: 
Y:: 
,:: 
FloorId;; 
=;; 
table;; 
.;;  
FloorId;;  '
,;;' (
Status<< 
=<< 
table<< 
.<< 
Status<< %
,<<% &
IsActive== 
=== 
table==  
.==  !
IsActive==! )
}>> 
)>> 
,>> 
$"?? 
$str?? 
{?? 
table?? 
.?? 
TableNumber?? &
}??& '
$str??' /
"??/ 0
,??0 1
correlationId@@ 
:@@ 
correlationId@@ (
)@@( )
;@@) *
awaitBB !
_auditEventRepositoryBB #
.BB# $
AddAsyncBB$ ,
(BB, -

auditEventBB- 7
,BB7 8
cancellationTokenBB9 J
)BBJ K
;BBK L
returnDD 
newDD 
CreateTableResultDD $
{EE 	
TableIdFF 
=FF 
tableFF 
.FF 
IdFF 
,FF 
TableNumberGG 
=GG 
tableGG 
.GG  
TableNumberGG  +
}HH 	
;HH	 

}II 
}JJ Ö"
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CreateShiftCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
CreateShiftCommandHandler &
:' (
ICommandHandler) 8
<8 9
CreateShiftCommand9 K
,K L
CreateShiftResultM ^
>^ _
{ 
private 
readonly 
IShiftRepository %
_shiftRepository& 6
;6 7
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
%
CreateShiftCommandHandler $
($ %
IShiftRepository 
shiftRepository (
,( )!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_shiftRepository 
= 
shiftRepository *
;* +!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
CreateShiftResult '
>' (
HandleAsync) 4
(4 5
CreateShiftCommand5 G
commandH O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
shift 
= 
Shift 
. 
Create  
(  !
command 
. 
Name 
, 
command 
. 
	StartTime 
, 
command 
. 
EndTime 
, 
command 
. 
IsActive 
) 
; 
await"" 
_shiftRepository"" 
."" 
AddAsync"" '
(""' (
shift""( -
,""- .
cancellationToken""/ @
)""@ A
;""A B
var%% 
correlationId%% 
=%% 
Guid%%  
.%%  !
NewGuid%%! (
(%%( )
)%%) *
;%%* +
var&& 

auditEvent&& 
=&& 

AuditEvent&& #
.&&# $
Create&&$ *
(&&* +
AuditEventType'' 
.'' 
Created'' "
,''" #
nameof(( 
((( 
Shift(( 
)(( 
,(( 
shift)) 
.)) 
Id)) 
,)) 
Guid** 
.** 
Empty** 
,** 
System++ 
.++ 
Text++ 
.++ 
Json++ 
.++ 
JsonSerializer++ +
.+++ ,
	Serialize++, 5
(++5 6
new++6 9
{,, 
Name-- 
=-- 
shift-- 
.-- 
Name-- !
,--! "
	StartTime.. 
=.. 
shift.. !
...! "
	StartTime.." +
...+ ,
ToString.., 4
(..4 5
)..5 6
,..6 7
EndTime// 
=// 
shift// 
.//  
EndTime//  '
.//' (
ToString//( 0
(//0 1
)//1 2
,//2 3
IsActive00 
=00 
shift00  
.00  !
IsActive00! )
}11 
)11 
,11 
$"22 
$str22 
{22 
shift22 
.22 
Name22  
}22  !
$str22! *
"22* +
,22+ ,
correlationId33 
:33 
correlationId33 (
)33( )
;33) *
await55 !
_auditEventRepository55 #
.55# $
AddAsync55$ ,
(55, -

auditEvent55- 7
,557 8
cancellationToken559 J
)55J K
;55K L
return77 
new77 
CreateShiftResult77 $
{88 	
ShiftId99 
=99 
shift99 
.99 
Id99 
,99 
Name:: 
=:: 
shift:: 
.:: 
Name:: 
};; 	
;;;	 

}<< 
}== Ø%
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CreateOrderTypeCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class )
CreateOrderTypeCommandHandler *
:+ ,
ICommandHandler- <
<< ="
CreateOrderTypeCommand= S
,S T!
CreateOrderTypeResultU j
>j k
{ 
private 
readonly  
IOrderTypeRepository ) 
_orderTypeRepository* >
;> ?
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
)
CreateOrderTypeCommandHandler (
(( ) 
IOrderTypeRepository 
orderTypeRepository 0
,0 1!
IAuditEventRepository  
auditEventRepository 2
)2 3
{  
_orderTypeRepository 
= 
orderTypeRepository 2
;2 3!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< !
CreateOrderTypeResult +
>+ ,
HandleAsync- 8
(8 9"
CreateOrderTypeCommand9 O
commandP W
,W X
CancellationTokenY j
cancellationTokenk |
=} ~
default	 Ü
)
Ü á
{ 
var 
	orderType 
= 
	OrderType !
.! "
Create" (
(( )
command 
. 
Name 
, 
command 
. 
CloseOnPaid 
,  
command 
. 
AllowSeatBasedOrder '
,' (
command 
. 
AllowToAddTipsLater '
,' (
command   
.   
IsBarTab   
,   
command!! 
.!! 
IsActive!! 
)!! 
;!! 
await$$  
_orderTypeRepository$$ "
.$$" #
AddAsync$$# +
($$+ ,
	orderType$$, 5
,$$5 6
cancellationToken$$7 H
)$$H I
;$$I J
var'' 
correlationId'' 
='' 
Guid''  
.''  !
NewGuid''! (
(''( )
)'') *
;''* +
var(( 

auditEvent(( 
=(( 

AuditEvent(( #
.((# $
Create(($ *
(((* +
AuditEventType)) 
.)) 
Created)) "
,))" #
nameof** 
(** 
	OrderType** 
)** 
,** 
	orderType++ 
.++ 
Id++ 
,++ 
Guid,, 
.,, 
Empty,, 
,,, 
System-- 
.-- 
Text-- 
.-- 
Json-- 
.-- 
JsonSerializer-- +
.--+ ,
	Serialize--, 5
(--5 6
new--6 9
{.. 
Name// 
=// 
	orderType//  
.//  !
Name//! %
,//% &
CloseOnPaid00 
=00 
	orderType00 '
.00' (
CloseOnPaid00( 3
,003 4
AllowSeatBasedOrder11 #
=11$ %
	orderType11& /
.11/ 0
AllowSeatBasedOrder110 C
,11C D
AllowToAddTipsLater22 #
=22$ %
	orderType22& /
.22/ 0
AllowToAddTipsLater220 C
,22C D
IsBarTab33 
=33 
	orderType33 $
.33$ %
IsBarTab33% -
,33- .
IsActive44 
=44 
	orderType44 $
.44$ %
IsActive44% -
}55 
)55 
,55 
$"66 
$str66 
{66 
	orderType66 $
.66$ %
Name66% )
}66) *
$str66* 3
"663 4
,664 5
correlationId77 
:77 
correlationId77 (
)77( )
;77) *
await99 !
_auditEventRepository99 #
.99# $
AddAsync99$ ,
(99, -

auditEvent99- 7
,997 8
cancellationToken999 J
)99J K
;99K L
return;; 
new;; !
CreateOrderTypeResult;; (
{<< 	
OrderTypeId== 
=== 
	orderType== #
.==# $
Id==$ &
,==& '
Name>> 
=>> 
	orderType>> 
.>> 
Name>> !
}?? 	
;??	 

}@@ 
}AA π(
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CloseTicketCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
CloseTicketCommandHandler &
:' (
ICommandHandler) 8
<8 9
CloseTicketCommand9 K
>K L
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
Domain 
. 
DomainServices *
.* +
TicketDomainService+ > 
_ticketDomainService? S
;S T
public 
%
CloseTicketCommandHandler $
($ %
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
,2 3
Domain 
. 
DomainServices 
. 
TicketDomainService 1
ticketDomainService2 E
)E F
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5 
_ticketDomainService 
= 
ticketDomainService 2
;2 3
} 
public 

async 
Task 
HandleAsync !
(! "
CloseTicketCommand" 4
command5 <
,< =
CancellationToken> O
cancellationTokenP a
=b c
defaultd k
)k l
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{   	
throw!! 
new!! 
Domain!! 
.!! 

Exceptions!! '
.!!' (*
BusinessRuleViolationException!!( F
(!!F G
$"!!G I
$str!!I P
{!!P Q
command!!Q X
.!!X Y
TicketId!!Y a
}!!a b
$str!!b m
"!!m n
)!!n o
;!!o p
}"" 	
if%% 

(%% 
!%%  
_ticketDomainService%% !
.%%! "
CanCloseTicket%%" 0
(%%0 1
ticket%%1 7
)%%7 8
)%%8 9
{&& 	
throw'' 
new'' 
Domain'' 
.'' 

Exceptions'' '
.''' (%
InvalidOperationException''( A
(''A B
$"''B D
$str''D K
{''K L
ticket''L R
.''R S
TicketNumber''S _
}''_ `
$str''` r
"''r s
)''s t
;''t u
}(( 	
ticket++ 
.++ 
Close++ 
(++ 
command++ 
.++ 
ClosedBy++ %
)++% &
;++& '
await.. 
_ticketRepository.. 
...  
UpdateAsync..  +
(..+ ,
ticket.., 2
,..2 3
cancellationToken..4 E
)..E F
;..F G
var11 
correlationId11 
=11 
Guid11  
.11  !
NewGuid11! (
(11( )
)11) *
;11* +
var22 

auditEvent22 
=22 

AuditEvent22 #
.22# $
Create22$ *
(22* +
AuditEventType33 
.33 
StatusChanged33 (
,33( )
nameof44 
(44 
Domain44 
.44 
Entities44 "
.44" #
Ticket44# )
)44) *
,44* +
ticket55 
.55 
Id55 
,55 
command66 
.66 
ClosedBy66 
.66 
Value66 "
,66" #
System77 
.77 
Text77 
.77 
Json77 
.77 
JsonSerializer77 +
.77+ ,
	Serialize77, 5
(775 6
new776 9
{77: ;
Status77< B
=77C D
ticket77E K
.77K L
Status77L R
}77S T
)77T U
,77U V
$"88 
$str88 
{88 
ticket88 
.88 
TicketNumber88 )
}88) *
$str88* 1
"881 2
,882 3
correlationId99 
:99 
correlationId99 (
)99( )
;99) *
await;; !
_auditEventRepository;; #
.;;# $
AddAsync;;$ ,
(;;, -

auditEvent;;- 7
,;;7 8
cancellationToken;;9 J
);;J K
;;;K L
}<< 
}== √>
ÖC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CloseCashSessionCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class *
CloseCashSessionCommandHandler +
:, -
ICommandHandler. =
<= >#
CloseCashSessionCommand> U
,U V"
CloseCashSessionResultW m
>m n
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
Domain 
. 
DomainServices *
.* +$
CashSessionDomainService+ C%
_cashSessionDomainServiceD ]
;] ^
public 
*
CloseCashSessionCommandHandler )
() *"
ICashSessionRepository !
cashSessionRepository 4
,4 5!
IAuditEventRepository  
auditEventRepository 2
,2 3
ITicketRepository 
ticketRepository *
,* +
Domain 
. 
DomainServices 
. $
CashSessionDomainService 6$
cashSessionDomainService7 O
)O P
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
_ticketRepository 
= 
ticketRepository ,
;, -%
_cashSessionDomainService !
=" #$
cashSessionDomainService$ <
;< =
} 
public 

async 
Task 
< "
CloseCashSessionResult ,
>, -
HandleAsync. 9
(9 :#
CloseCashSessionCommand: Q
commandR Y
,Y Z
CancellationToken[ l
cancellationTokenm ~
=	 Ä
default
Å à
)
à â
{ 
var!! 
cashSession!! 
=!! 
await!! "
_cashSessionRepository!!  6
.!!6 7
GetByIdAsync!!7 C
(!!C D
command!!D K
.!!K L
CashSessionId!!L Y
,!!Y Z
cancellationToken!![ l
)!!l m
;!!m n
if"" 

("" 
cashSession"" 
=="" 
null"" 
)""  
{## 	
throw$$ 
new$$ 
Domain$$ 
.$$ 

Exceptions$$ '
.$$' (*
BusinessRuleViolationException$$( F
($$F G
$"$$G I
$str$$I V
{$$V W
command$$W ^
.$$^ _
CashSessionId$$_ l
}$$l m
$str$$m x
"$$x y
)$$y z
;$$z {
}%% 	
if(( 

((( 
!(( %
_cashSessionDomainService(( &
.((& '
CanCloseSession((' 6
(((6 7
cashSession((7 B
)((B C
)((C D
{)) 	
throw** 
new** 
Domain** 
.** 

Exceptions** '
.**' (%
InvalidOperationException**( A
(**A B
$"**B D
$str**D Q
{**Q R
command**R Y
.**Y Z
CashSessionId**Z g
}**g h
$str**h z
"**z {
)**{ |
;**| }
}++ 	
var.. 
openTickets.. 
=.. 
await.. 
_ticketRepository..  1
...1 2
GetOpenTicketsAsync..2 E
(..E F
cancellationToken..F W
)..W X
;..X Y
if// 

(// 
openTickets// 
.// 
Any// 
(// 
)// 
)// 
{00 	
throw11 
new11 
Domain11 
.11 

Exceptions11 '
.11' (*
BusinessRuleViolationException11( F
(11F G
$"22 
$str22 &
{22& '
openTickets22' 2
.222 3
Count223 8
(228 9
)229 :
}22: ;
$str22; |
"22| }
)22} ~
;22~ 
}33 	
cashSession66 
.66 
Close66 
(66 
command66 !
.66! "
ClosedBy66" *
,66* +
command66, 3
.663 4

ActualCash664 >
)66> ?
;66? @
await99 "
_cashSessionRepository99 $
.99$ %
UpdateAsync99% 0
(990 1
cashSession991 <
,99< =
cancellationToken99> O
)99O P
;99P Q
var<< 
correlationId<< 
=<< 
Guid<<  
.<<  !
NewGuid<<! (
(<<( )
)<<) *
;<<* +
var== 

auditEvent== 
=== 

AuditEvent== #
.==# $
Create==$ *
(==* +
AuditEventType>> 
.>> 
StatusChanged>> (
,>>( )
nameof?? 
(?? 
CashSession?? 
)?? 
,??  
cashSession@@ 
.@@ 
Id@@ 
,@@ 
commandAA 
.AA 
ClosedByAA 
.AA 
ValueAA "
,AA" #
SystemBB 
.BB 
TextBB 
.BB 
JsonBB 
.BB 
JsonSerializerBB +
.BB+ ,
	SerializeBB, 5
(BB5 6
newBB6 9
{CC 
StatusDD 
=DD 
cashSessionDD $
.DD$ %
StatusDD% +
,DD+ ,
ExpectedCashEE 
=EE 
cashSessionEE *
.EE* +
ExpectedCashEE+ 7
.EE7 8
AmountEE8 >
,EE> ?

ActualCashFF 
=FF 
cashSessionFF (
.FF( )

ActualCashFF) 3
!FF3 4
.FF4 5
AmountFF5 ;
,FF; <

DifferenceGG 
=GG 
cashSessionGG (
.GG( )

DifferenceGG) 3
!GG3 4
.GG4 5
AmountGG5 ;
}HH 
)HH 
,HH 
$"II 
$strII -
{II- .
cashSessionII. 9
.II9 :
ExpectedCashII: F
}IIF G
$strIIG Q
{IIQ R
cashSessionIIR ]
.II] ^

ActualCashII^ h
}IIh i
$strIIi w
{IIw x
cashSession	IIx É
.
IIÉ Ñ

Difference
IIÑ é
}
IIé è
"
IIè ê
,
IIê ë
correlationIdJJ 
:JJ 
correlationIdJJ (
)JJ( )
;JJ) *
awaitLL !
_auditEventRepositoryLL #
.LL# $
AddAsyncLL$ ,
(LL, -

auditEventLL- 7
,LL7 8
cancellationTokenLL9 J
)LLJ K
;LLK L
returnNN 
newNN "
CloseCashSessionResultNN )
{OO 	
CashSessionIdPP 
=PP 
cashSessionPP '
.PP' (
IdPP( *
,PP* +
ExpectedCashQQ 
=QQ 
cashSessionQQ &
.QQ& '
ExpectedCashQQ' 3
,QQ3 4

ActualCashRR 
=RR 
cashSessionRR $
.RR$ %

ActualCashRR% /
!RR/ 0
,RR0 1

DifferenceSS 
=SS 
cashSessionSS $
.SS$ %

DifferenceSS% /
!SS/ 0
,SS0 1
ClosedAtTT 
=TT 
cashSessionTT "
.TT" #
ClosedAtTT# +
!TT+ ,
.TT, -
ValueTT- 2
}UU 	
;UU	 

}VV 
}WW ô.
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ClockCommandHandlers.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class !
ClockInCommandHandler "
:# $
ICommandHandler% 4
<4 5
ClockInCommand5 C
>C D
{		 
private

 
readonly

 !
IAttendanceRepository

 *!
_attendanceRepository

+ @
;

@ A
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
!
ClockInCommandHandler  
(  !!
IAttendanceRepository  
attendanceRepository 2
,2 3!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ !
_attendanceRepository 
=  
attendanceRepository  4
;4 5!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! "
ClockInCommand" 0
command1 8
,8 9
CancellationToken: K
cancellationTokenL ]
=^ _
default` g
)g h
{ 
var 

attendance 
= 
AttendanceHistory *
.* +
Create+ 1
(1 2
command2 9
.9 :
UserId: @
)@ A
;A B
await !
_attendanceRepository #
.# $
AddAsync$ ,
(, -

attendance- 7
,7 8
cancellationToken9 J
)J K
;K L
var 
audit 
= 

AuditEvent 
. 
Create %
(% &
AuditEventType 
. 
StatusChanged (
,( )
nameof 
( 
AttendanceHistory $
)$ %
,% &

attendance   
.   
Id   
,   
command!! 
.!! 
UserId!! 
.!! 
Value!!  
,!!  !
$str"" 
,"" 
$"## 
$str## 
{## 
command## 
.## 
UserId## "
}##" #
$str### /
"##/ 0
)$$ 	
;$$	 

await%% !
_auditEventRepository%% #
.%%# $
AddAsync%%$ ,
(%%, -
audit%%- 2
,%%2 3
cancellationToken%%4 E
)%%E F
;%%F G
}&& 
}'' 
public)) 
class)) "
ClockOutCommandHandler)) #
:))$ %
ICommandHandler))& 5
<))5 6
ClockOutCommand))6 E
>))E F
{** 
private++ 
readonly++ !
IAttendanceRepository++ *!
_attendanceRepository+++ @
;++@ A
private,, 
readonly,, !
IAuditEventRepository,, *!
_auditEventRepository,,+ @
;,,@ A
public.. 
"
ClockOutCommandHandler.. !
(..! "!
IAttendanceRepository//  
attendanceRepository// 2
,//2 3!
IAuditEventRepository00  
auditEventRepository00 2
)002 3
{11 !
_attendanceRepository22 
=22  
attendanceRepository22  4
;224 5!
_auditEventRepository33 
=33  
auditEventRepository33  4
;334 5
}44 
public66 

async66 
Task66 
HandleAsync66 !
(66! "
ClockOutCommand66" 1
command662 9
,669 :
CancellationToken66; L
cancellationToken66M ^
=66_ `
default66a h
)66h i
{77 
var99 

openRecord99 
=99 
await99 !
_attendanceRepository99 4
.994 5 
GetOpenByUserIdAsync995 I
(99I J
command99J Q
.99Q R
UserId99R X
,99X Y
cancellationToken99Z k
)99k l
;99l m
if;; 

(;; 

openRecord;; 
==;; 
null;; 
);; 
{<< 	
throw== 
new== 
Domain== 
.== 

Exceptions== (
.==( )*
BusinessRuleViolationException==) G
(==G H
$str==H j
)==j k
;==k l
}>> 	

openRecord@@ 
.@@ 
ClockOut@@ 
(@@ 
)@@ 
;@@ 
awaitAA !
_attendanceRepositoryAA #
.AA# $
UpdateAsyncAA$ /
(AA/ 0

openRecordAA0 :
,AA: ;
cancellationTokenAA< M
)AAM N
;AAN O
varCC 
auditCC 
=CC 

AuditEventCC 
.CC 
CreateCC %
(CC% &
AuditEventTypeDD 
.DD 
StatusChangedDD (
,DD( )
nameofEE 
(EE 
AttendanceHistoryEE $
)EE$ %
,EE% &

openRecordFF 
.FF 
IdFF 
,FF 
commandGG 
.GG 
UserIdGG 
.GG 
ValueGG  
,GG  !
$strHH 
,HH 
$"II 
$strII 
{II 
commandII 
.II 
UserIdII "
}II" #
$strII# 0
"II0 1
)JJ 	
;JJ	 

awaitKK !
_auditEventRepositoryKK #
.KK# $
AddAsyncKK$ ,
(KK, -
auditKK- 2
,KK2 3
cancellationTokenKK4 E
)KKE F
;KKF G
}LL 
}MM ˇ(
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ChangeTableCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
ChangeTableCommandHandler &
:' (
ICommandHandler) 8
<8 9
ChangeTableCommand9 K
,K L
ChangeTableResultM ^
>^ _
{		 
private

 
readonly

 
ITicketRepository

 &
_ticketRepository

' 8
;

8 9
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
public 
%
ChangeTableCommandHandler $
($ %
ITicketRepository 
ticketRepository *
,* +
ITableRepository 
tableRepository (
)( )
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_tableRepository 
= 
tableRepository *
;* +
} 
public 

async 
Task 
< 
ChangeTableResult '
>' (
HandleAsync) 4
(4 5
ChangeTableCommand5 G
commandH O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
return 
new 
ChangeTableResult (
{) *
Success+ 2
=3 4
false5 :
,: ;
ErrorMessage< H
=I J
$strK ^
}_ `
;` a
var 
newTable 
= 
await 
_tableRepository -
.- .
GetByIdAsync. :
(: ;
command; B
.B C

NewTableIdC M
,M N
cancellationTokenO `
)` a
;a b
if 

( 
newTable 
== 
null 
) 
return 
new 
ChangeTableResult (
{) *
Success+ 2
=3 4
false5 :
,: ;
ErrorMessage< H
=I J
$strK a
}b c
;c d
if 

( 
! 
newTable 
. 
IsAvailable !
(! "
)" #
)# $
return   
new   
ChangeTableResult   (
{  ) *
Success  + 2
=  3 4
false  5 :
,  : ;
ErrorMessage  < H
=  I J
$"  K M
$str  M S
{  S T
newTable  T \
.  \ ]
TableNumber  ] h
}  h i
$str  i {
"  { |
}  } ~
;  ~ 
var-- 
currentTable-- 
=-- 
await--  
_tableRepository--! 1
.--1 2
GetByTicketIdAsync--2 D
(--D E
ticket--E K
.--K L
Id--L N
)--N O
;--O P
if.. 

(.. 
currentTable.. 
!=.. 
null..  
)..  !
{// 	
if00 
(00 
currentTable00 
.00 
Id00 
==00  "
newTable00# +
.00+ ,
Id00, .
)00. /
return11 
new11 
ChangeTableResult11 ,
{11- .
Success11/ 6
=117 8
false119 >
,11> ?
ErrorMessage11@ L
=11M N
$str11O q
}11r s
;11s t
currentTable33 
.33 
ReleaseTicket33 &
(33& '
)33' (
;33( )
await44 
_tableRepository44 "
.44" #
UpdateAsync44# .
(44. /
currentTable44/ ;
)44; <
;44< =
}55 	
newTable77 
.77 
AssignTicket77 
(77 
ticket77 $
.77$ %
Id77% '
)77' (
;77( )
await88 
_tableRepository88 
.88 
UpdateAsync88 *
(88* +
newTable88+ 3
)883 4
;884 5
ticket;; 
.;; 
AssignTable;; 
(;; 
newTable;; #
.;;# $
TableNumber;;$ /
);;/ 0
;;;0 1
await<< 
_ticketRepository<< 
.<<  
UpdateAsync<<  +
(<<+ ,
ticket<<, 2
)<<2 3
;<<3 4
return>> 
new>> 
ChangeTableResult>> $
{>>% &
Success>>' .
=>>/ 0
true>>1 5
}>>6 7
;>>7 8
}?? 
}@@ …
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ChangeSeatCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 $
ChangeSeatCommandHandler

 %
:

& '
ICommandHandler

( 7
<

7 8
ChangeSeatCommand

8 I
>

I J
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
$
ChangeSeatCommandHandler #
(# $
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
HandleAsync !
(! "
ChangeSeatCommand" 3
command4 ;
,; <
CancellationToken= N
cancellationTokenO `
=a b
defaultc j
)j k
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (
NotFoundException( 9
(9 :
$": <
$str< C
{C D
commandD K
.K L
TicketIdL T
}T U
$strU _
"_ `
)` a
;a b
} 	
var 
line 
= 
ticket 
. 

OrderLines $
.$ %
FirstOrDefault% 3
(3 4
ol4 6
=>7 9
ol: <
.< =
Id= ?
==@ B
commandC J
.J K
OrderLineIdK V
)V W
;W X
if   

(   
line   
==   
null   
)   
{!! 	
throw"" 
new"" 
Domain"" 
."" 

Exceptions"" '
.""' (
NotFoundException""( 9
(""9 :
$""": <
$str""< G
{""G H
command""H O
.""O P
OrderLineId""P [
}""[ \
$str""\ q
{""q r
command""r y
.""y z
TicketId	""z Ç
}
""Ç É
"
""É Ñ
)
""Ñ Ö
;
""Ö Ü
}## 	
line%% 
.%% 
SetSeatNumber%% 
(%% 
command%% "
.%%" #

SeatNumber%%# -
)%%- .
;%%. /
await'' 
_ticketRepository'' 
.''  
UpdateAsync''  +
(''+ ,
ticket'', 2
,''2 3
cancellationToken''4 E
)''E F
;''F G
}(( 
})) Ä+
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CashSessionService.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public

 
class

 
CashSessionService

 
:

  !
ICashSessionService

" 5
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
public 

CashSessionService 
( "
ICashSessionRepository 4!
cashSessionRepository5 J
)J K
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7
} 
public 

async 
Task 
< 
CashSession !
>! "
StartSessionAsync# 4
(4 5
UserId5 ;
userId< B
,B C
GuidD H

terminalIdI S
,S T
GuidU Y
shiftIdZ a
,a b
Moneyc h
openingAmounti v
)v w
{ 
var 
userSession 
= 
await "
_cashSessionRepository  6
.6 7'
GetOpenSessionByUserIdAsync7 R
(R S
userIdS Y
.Y Z
ValueZ _
)_ `
;` a
if 

( 
userSession 
!= 
null 
)  
{ 	
throw 
new *
BusinessRuleViolationException 4
(4 5
$"5 7
$str7 i
{i j
userSessionj u
.u v

TerminalId	v Ä
}
Ä Å
$str
Å Ç
"
Ç É
)
É Ñ
;
Ñ Ö
} 	
var 
terminalSession 
= 
await #"
_cashSessionRepository$ :
.: ;+
GetOpenSessionByTerminalIdAsync; Z
(Z [

terminalId[ e
)e f
;f g
if   

(   
terminalSession   
!=   
null   #
)  # $
{!! 	
throw"" 
new"" *
BusinessRuleViolationException"" 5
(""5 6
$"""6 8
$str""8 A
{""A B

terminalId""B L
}""L M
$str""M y
{""y z
terminalSession	""z â
.
""â ä
UserId
""ä ê
.
""ê ë
Value
""ë ñ
}
""ñ ó
$str
""ó ò
"
""ò ô
)
""ô ö
;
""ö õ
}## 	
var&& 
session&& 
=&& 
CashSession&& !
.&&! "
Open&&" &
(&&& '
userId&&' -
,&&- .

terminalId&&/ 9
,&&9 :
shiftId&&; B
,&&B C
openingAmount&&D Q
)&&Q R
;&&R S
await)) "
_cashSessionRepository)) $
.))$ %
AddAsync))% -
())- .
session)). 5
)))5 6
;))6 7
return** 
session** 
;** 
}++ 
public-- 

async-- 
Task-- 
<-- 
CashSession-- !
>--! "
CloseSessionAsync--# 4
(--4 5
Guid--5 9
	sessionId--: C
,--C D
UserId--E K
closedBy--L T
,--T U
Money--V [
closingAmount--\ i
)--i j
{.. 
var// 
session// 
=// 
await// "
_cashSessionRepository// 2
.//2 3
GetByIdAsync//3 ?
(//? @
	sessionId//@ I
)//I J
;//J K
if00 

(00 
session00 
==00 
null00 
)00 
{11 	
throw22 
new22 
	Exception22 
(22  
$"22  "
$str22" :
{22: ;
	sessionId22; D
}22D E
"22E F
)22F G
;22G H
}33 	
session55 
.55 
Close55 
(55 
closedBy55 
,55 
closingAmount55  -
)55- .
;55. /
await77 "
_cashSessionRepository77 $
.77$ %
UpdateAsync77% 0
(770 1
session771 8
)778 9
;779 :
return88 
session88 
;88 
}99 
public;; 

async;; 
Task;; 
<;; 
CashSession;; !
?;;! "
>;;" #'
GetActiveSessionByUserAsync;;$ ?
(;;? @
UserId;;@ F
userId;;G M
);;M N
{<< 
return== 
await== "
_cashSessionRepository== +
.==+ ,'
GetOpenSessionByUserIdAsync==, G
(==G H
userId==H N
.==N O
Value==O T
)==T U
;==U V
}>> 
public@@ 

async@@ 
Task@@ 
<@@ 
CashSession@@ !
?@@! "
>@@" #+
GetActiveSessionByTerminalAsync@@$ C
(@@C D
Guid@@D H

terminalId@@I S
)@@S T
{AA 
returnBB 
awaitBB "
_cashSessionRepositoryBB +
.BB+ ,+
GetOpenSessionByTerminalIdAsyncBB, K
(BBK L

terminalIdBBL V
)BBV W
;BBW X
}CC 
}DD °S
áC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CaptureCardPaymentCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class ,
 CaptureCardPaymentCommandHandler -
:. /
ICommandHandler0 ?
<? @%
CaptureCardPaymentCommand@ Y
,Y Z$
CaptureCardPaymentResult[ s
>s t
{ 
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly 
IPaymentGateway $
_paymentGateway% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
,
 CaptureCardPaymentCommandHandler +
(+ ,
IPaymentRepository 
paymentRepository ,
,, -
IPaymentGateway 
paymentGateway &
,& '!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_paymentRepository 
= 
paymentRepository .
;. /
_paymentGateway 
= 
paymentGateway (
;( )!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< $
CaptureCardPaymentResult .
>. /
HandleAsync0 ;
(; <%
CaptureCardPaymentCommand !
command" )
,) *
CancellationToken   
cancellationToken   +
=  , -
default  . 5
)  5 6
{!! 
var## 
payment## 
=## 
await## 
_paymentRepository## .
.##. /
GetByIdAsync##/ ;
(##; <
command##< C
.##C D
	PaymentId##D M
,##M N
cancellationToken##O `
)##` a
;##a b
if$$ 

($$ 
payment$$ 
==$$ 
null$$ 
)$$ 
{%% 	
return&& 
new&& $
CaptureCardPaymentResult&& /
{'' 
Success(( 
=(( 
false(( 
,((  
ErrorMessage)) 
=)) 
$")) !
$str))! )
{))) *
command))* 1
.))1 2
	PaymentId))2 ;
})); <
$str))< G
"))G H
}** 
;** 
}++ 	
if.. 

(.. 
payment.. 
is.. 
not.. 
CreditCardPayment.. ,
creditCardPayment..- >
)..> ?
{// 	
return00 
new00 $
CaptureCardPaymentResult00 /
{11 
Success22 
=22 
false22 
,22  
ErrorMessage33 
=33 
$"33 !
$str33! )
{33) *
command33* 1
.331 2
	PaymentId332 ;
}33; <
$str33< Z
"33Z [
}44 
;44 
}55 	
if88 

(88 
creditCardPayment88 
.88 
IsVoided88 &
)88& '
{99 	
return:: 
new:: $
CaptureCardPaymentResult:: /
{;; 
Success<< 
=<< 
false<< 
,<<  
ErrorMessage== 
=== 
$str== A
}>> 
;>> 
}?? 	
ifAA 

(AA 
creditCardPaymentAA 
.AA 

IsCapturedAA (
)AA( )
{BB 	
returnCC 
newCC $
CaptureCardPaymentResultCC /
{DD 
SuccessEE 
=EE 
falseEE 
,EE  
ErrorMessageFF 
=FF 
$strFF =
}GG 
;GG 
}HH 	
ifJJ 

(JJ 
stringJJ 
.JJ 
IsNullOrEmptyJJ  
(JJ  !
creditCardPaymentJJ! 2
.JJ2 3
AuthorizationCodeJJ3 D
)JJD E
)JJE F
{KK 	
returnLL 
newLL $
CaptureCardPaymentResultLL /
{MM 
SuccessNN 
=NN 
falseNN 
,NN  
ErrorMessageOO 
=OO 
$strOO K
}PP 
;PP 
}QQ 	
varTT 
gatewayResultTT 
=TT 
awaitTT !
_paymentGatewayTT" 1
.TT1 2
CaptureAsyncTT2 >
(TT> ?
creditCardPaymentUU 
,UU 
commandVV 
.VV 
AmountVV 
,VV 
cancellationTokenWW 
)WW 
;WW 
ifYY 

(YY 
!YY 
gatewayResultYY 
.YY 
SuccessYY "
)YY" #
{ZZ 	
var\\ 

auditEvent\\ 
=\\ 

AuditEvent\\ '
.\\' (
Create\\( .
(\\. /
AuditEventType]] 
.]] 
PaymentProcessed]] /
,]]/ 0
nameof^^ 
(^^ 
Payment^^ 
)^^ 
,^^  
payment__ 
.__ 
Id__ 
,__ 
command`` 
.`` 
ProcessedBy`` #
.``# $
Value``$ )
,``) *
Systemaa 
.aa 
Textaa 
.aa 
Jsonaa  
.aa  !
JsonSerializeraa! /
.aa/ 0
	Serializeaa0 9
(aa9 :
newaa: =
{aa> ?
Actionbb 
=bb 
$strbb &
,bb& '
Successcc 
=cc 
falsecc #
,cc# $
Errordd 
=dd 
gatewayResultdd )
.dd) *
ErrorMessagedd* 6
}ee 
)ee 
,ee 
$"ff 
$strff /
{ff/ 0
gatewayResultff0 =
.ff= >
ErrorMessageff> J
}ffJ K
"ffK L
,ffL M
correlationIdgg 
:gg 
Guidgg #
.gg# $
NewGuidgg$ +
(gg+ ,
)gg, -
)gg- .
;gg. /
awaitii !
_auditEventRepositoryii '
.ii' (
AddAsyncii( 0
(ii0 1

auditEventii1 ;
,ii; <
cancellationTokenii= N
)iiN O
;iiO P
returnkk 
newkk $
CaptureCardPaymentResultkk /
{ll 
Successmm 
=mm 
falsemm 
,mm  
ErrorMessagenn 
=nn 
gatewayResultnn ,
.nn, -
ErrorMessagenn- 9
}oo 
;oo 
}pp 	
creditCardPaymentss 
.ss 
Capturess !
(ss! "
)ss" #
;ss# $
ifvv 

(vv 
!vv 
stringvv 
.vv 
IsNullOrEmptyvv !
(vv! "
gatewayResultvv" /
.vv/ 0
ReferenceNumbervv0 ?
)vv? @
)vv@ A
{ww 	
varxx 
updateRefMethodxx 
=xx  !
typeofxx" (
(xx( )
CreditCardPaymentxx) :
)xx: ;
.xx; <
	GetMethodxx< E
(xxE F
$strxxF ]
,xx] ^
Systemyy 
.yy 

Reflectionyy !
.yy! "
BindingFlagsyy" .
.yy. /
	NonPublicyy/ 8
|yy9 :
Systemyy; A
.yyA B

ReflectionyyB L
.yyL M
BindingFlagsyyM Y
.yyY Z
InstanceyyZ b
)yyb c
;yyc d
updateRefMethodzz 
?zz 
.zz 
Invokezz #
(zz# $
creditCardPaymentzz$ 5
,zz5 6
newzz7 :
objectzz; A
[zzA B
]zzB C
{zzD E
gatewayResultzzF S
.zzS T
ReferenceNumberzzT c
}zzd e
)zze f
;zzf g
}{{ 	
await~~ 
_paymentRepository~~  
.~~  !
UpdateAsync~~! ,
(~~, -
creditCardPayment~~- >
,~~> ?
cancellationToken~~@ Q
)~~Q R
;~~R S
var
ÅÅ 
successAuditEvent
ÅÅ 
=
ÅÅ 

AuditEvent
ÅÅ  *
.
ÅÅ* +
Create
ÅÅ+ 1
(
ÅÅ1 2
AuditEventType
ÇÇ 
.
ÇÇ 
PaymentProcessed
ÇÇ +
,
ÇÇ+ ,
nameof
ÉÉ 
(
ÉÉ 
Payment
ÉÉ 
)
ÉÉ 
,
ÉÉ 
payment
ÑÑ 
.
ÑÑ 
Id
ÑÑ 
,
ÑÑ 
command
ÖÖ 
.
ÖÖ 
ProcessedBy
ÖÖ 
.
ÖÖ  
Value
ÖÖ  %
,
ÖÖ% &
System
ÜÜ 
.
ÜÜ 
Text
ÜÜ 
.
ÜÜ 
Json
ÜÜ 
.
ÜÜ 
JsonSerializer
ÜÜ +
.
ÜÜ+ ,
	Serialize
ÜÜ, 5
(
ÜÜ5 6
new
ÜÜ6 9
{
ÜÜ: ;
Action
áá 
=
áá 
$str
áá "
,
áá" #
Success
àà 
=
àà 
true
àà 
,
àà 
CaptureCode
ââ 
=
ââ 
gatewayResult
ââ +
.
ââ+ ,
CaptureCode
ââ, 7
,
ââ7 8
ReferenceNumber
ää 
=
ää  !
gatewayResult
ää" /
.
ää/ 0
ReferenceNumber
ää0 ?
}
ãã 
)
ãã 
,
ãã 
$"
åå 
$str
åå %
{
åå% &
gatewayResult
åå& 3
.
åå3 4
CaptureCode
åå4 ?
}
åå? @
"
åå@ A
,
ååA B
correlationId
çç 
:
çç 
Guid
çç 
.
çç  
NewGuid
çç  '
(
çç' (
)
çç( )
)
çç) *
;
çç* +
await
èè #
_auditEventRepository
èè #
.
èè# $
AddAsync
èè$ ,
(
èè, -
successAuditEvent
èè- >
,
èè> ?
cancellationToken
èè@ Q
)
èèQ R
;
èèR S
return
ëë 
new
ëë &
CaptureCardPaymentResult
ëë +
{
íí 	
Success
ìì 
=
ìì 
true
ìì 
,
ìì 
CaptureCode
îî 
=
îî 
gatewayResult
îî '
.
îî' (
CaptureCode
îî( 3
,
îî3 4
ReferenceNumber
ïï 
=
ïï 
gatewayResult
ïï +
.
ïï+ ,
ReferenceNumber
ïï, ;
}
ññ 	
;
ññ	 

}
óó 
}òò ≤/
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\CalculateServiceChargeCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class 0
$CalculateServiceChargeCommandHandler 1
:2 3
ICommandHandler4 C
<C D)
CalculateServiceChargeCommandD a
,a b(
CalculateServiceChargeResultc 
>	 Ä
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly &
ServiceChargeDomainService /'
_serviceChargeDomainService0 K
;K L
public 
0
$CalculateServiceChargeCommandHandler /
(/ 0
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
,2 3&
ServiceChargeDomainService "&
serviceChargeDomainService# =
)= >
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5'
_serviceChargeDomainService #
=$ %&
serviceChargeDomainService& @
;@ A
} 
public 

async 
Task 
< (
CalculateServiceChargeResult 2
>2 3
HandleAsync4 ?
(? @)
CalculateServiceChargeCommand %
command& -
,- .
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
{   
var!! 
ticket!! 
=!! 
await!! 
_ticketRepository!! ,
.!!, -
GetByIdAsync!!- 9
(!!9 :
command!!: A
.!!A B
TicketId!!B J
,!!J K
cancellationToken!!L ]
)!!] ^
;!!^ _
if"" 

("" 
ticket"" 
=="" 
null"" 
)"" 
{## 	
return$$ 
new$$ (
CalculateServiceChargeResult$$ 3
{%% 
Success&& 
=&& 
false&& 
,&&  
ErrorMessage'' 
='' 
$"'' !
$str''! (
{''( )
command'') 0
.''0 1
TicketId''1 9
}''9 :
$str'': E
"''E F
}(( 
;(( 
})) 	
try++ 
{,, 	
var.. 
calculatedAmount..  
=..! "'
_serviceChargeDomainService..# >
...> ?+
CalculateServiceChargeForTicket..? ^
(..^ _
ticket// 
,// 
command00 
.00 
ServiceChargeRate00 )
)00) *
;00* +
ticket33 
.33 
SetServiceCharge33 #
(33# $
calculatedAmount33$ 4
)334 5
;335 6
await55 
_ticketRepository55 #
.55# $
UpdateAsync55$ /
(55/ 0
ticket550 6
,556 7
cancellationToken558 I
)55I J
;55J K
var88 

auditEvent88 
=88 

AuditEvent88 '
.88' (
Create88( .
(88. /
AuditEventType99 
.99 
Modified99 '
,99' (
nameof:: 
(:: 
Ticket:: 
):: 
,:: 
ticket;; 
.;; 
Id;; 
,;; 
command<< 
.<< 
ProcessedBy<< #
.<<# $
Value<<$ )
,<<) *
System== 
.== 
Text== 
.== 
Json==  
.==  !
JsonSerializer==! /
.==/ 0
	Serialize==0 9
(==9 :
new==: =
{>> 
Action?? 
=?? 
$str?? 5
,??5 6
ServiceChargeRate@@ %
=@@& '
command@@( /
.@@/ 0
ServiceChargeRate@@0 A
,@@A B
CalculatedAmountAA $
=AA% &
calculatedAmountAA' 7
}BB 
)BB 
,BB 
$"CC 
$strCC -
{CC- .
commandCC. 5
.CC5 6
ServiceChargeRateCC6 G
*CCH I
$numCCJ M
}CCM N
$strCCN R
{CCR S
calculatedAmountCCS c
}CCc d
$strCCd o
{CCo p
ticketCCp v
.CCv w
TicketNumber	CCw É
}
CCÉ Ñ
"
CCÑ Ö
,
CCÖ Ü
correlationIdDD 
:DD 
GuidDD #
.DD# $
NewGuidDD$ +
(DD+ ,
)DD, -
)DD- .
;DD. /
awaitFF !
_auditEventRepositoryFF '
.FF' (
AddAsyncFF( 0
(FF0 1

auditEventFF1 ;
,FF; <
cancellationTokenFF= N
)FFN O
;FFO P
returnHH 
newHH (
CalculateServiceChargeResultHH 3
{II 
SuccessJJ 
=JJ 
trueJJ 
,JJ 
CalculatedAmountKK  
=KK! "
calculatedAmountKK# 3
,KK3 4
NewTotalAmountLL 
=LL  
ticketLL! '
.LL' (
TotalAmountLL( 3
}MM 
;MM 
}NN 	
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO 
{PP 	
returnQQ 
newQQ (
CalculateServiceChargeResultQQ 3
{RR 
SuccessSS 
=SS 
falseSS 
,SS  
ErrorMessageTT 
=TT 
exTT !
.TT! "
MessageTT" )
}UU 
;UU 
}VV 	
}WW 
}XX £Z
âC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AuthorizeCardPaymentCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class .
"AuthorizeCardPaymentCommandHandler /
:0 1
ICommandHandler2 A
<A B'
AuthorizeCardPaymentCommandB ]
,] ^&
AuthorizeCardPaymentResult_ y
>y z
{ 
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly 
IPaymentGateway $
_paymentGateway% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
.
"AuthorizeCardPaymentCommandHandler -
(- .
IPaymentRepository 
paymentRepository ,
,, -
IPaymentGateway 
paymentGateway &
,& '!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_paymentRepository 
= 
paymentRepository .
;. /
_paymentGateway 
= 
paymentGateway (
;( )!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< &
AuthorizeCardPaymentResult 0
>0 1
HandleAsync2 =
(= >'
AuthorizeCardPaymentCommand #
command$ +
,+ ,
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
{   
var"" 
payment"" 
="" 
await"" 
_paymentRepository"" .
."". /
GetByIdAsync""/ ;
(""; <
command""< C
.""C D
	PaymentId""D M
,""M N
cancellationToken""O `
)""` a
;""a b
if## 

(## 
payment## 
==## 
null## 
)## 
{$$ 	
return%% 
new%% &
AuthorizeCardPaymentResult%% 1
{&& 
Success'' 
='' 
false'' 
,''  
ErrorMessage(( 
=(( 
$"(( !
$str((! )
{(() *
command((* 1
.((1 2
	PaymentId((2 ;
}((; <
$str((< G
"((G H
})) 
;)) 
}** 	
if-- 

(-- 
payment-- 
is-- 
not-- 
CreditCardPayment-- ,
creditCardPayment--- >
)--> ?
{.. 	
return// 
new// &
AuthorizeCardPaymentResult// 1
{00 
Success11 
=11 
false11 
,11  
ErrorMessage22 
=22 
$"22 !
$str22! )
{22) *
command22* 1
.221 2
	PaymentId222 ;
}22; <
$str22< Z
"22Z [
}33 
;33 
}44 	
if77 

(77 
creditCardPayment77 
.77 
IsVoided77 &
)77& '
{88 	
return99 
new99 &
AuthorizeCardPaymentResult99 1
{:: 
Success;; 
=;; 
false;; 
,;;  
ErrorMessage<< 
=<< 
$str<< C
}== 
;== 
}>> 	
if@@ 

(@@ 
creditCardPayment@@ 
.@@ 

IsCaptured@@ (
)@@( )
{AA 	
returnBB 
newBB &
AuthorizeCardPaymentResultBB 1
{CC 
SuccessDD 
=DD 
falseDD 
,DD  
ErrorMessageEE 
=EE 
$strEE =
}FF 
;FF 
}GG 	
AuthorizationResultJJ 
gatewayResultJJ )
;JJ) *
ifLL 

(LL 
!LL 
stringLL 
.LL 
IsNullOrWhiteSpaceLL &
(LL& '
commandLL' .
.LL. /
ManualAuthCodeLL/ =
)LL= >
)LL> ?
{MM 	
gatewayResultOO 
=OO 
newOO  
AuthorizationResultOO! 4
{PP 
SuccessQQ 
=QQ 
trueQQ 
,QQ  
AuthorizationCodeRR "
=RR# $
commandRR% ,
.RR, -
ManualAuthCodeRR- ;
,RR; <
ReferenceNumberSS  
=SS! "
$"SS# %
$strSS% ,
{SS, -
GuidSS- 1
.SS1 2
NewGuidSS2 9
(SS9 :
)SS: ;
.SS; <
ToStringSS< D
(SSD E
$strSSE H
)SSH I
[SSI J
..SSJ L
$numSSL M
]SSM N
}SSN O
"SSO P
,SSP Q
CardTypeTT 
=TT 
$strTT $
,TT$ %
ErrorMessageUU 
=UU 
nullUU  $
,UU$ %
LastFourDigitsVV 
=VV  !
commandVV" )
.VV) *

CardNumberVV* 4
.VV4 5
LengthVV5 ;
>=VV< >
$numVV? @
?VVA B
commandVVC J
.VVJ K

CardNumberVVK U
.VVU V
	SubstringVVV _
(VV_ `
commandVV` g
.VVg h

CardNumberVVh r
.VVr s
LengthVVs y
-VVz {
$numVV| }
)VV} ~
:	VV Ä
$str
VVÅ á
}WW 
;WW 
}XX 	
elseYY 
{ZZ 	
gatewayResult[[ 
=[[ 
await[[ !
_paymentGateway[[" 1
.[[1 2
AuthorizeAsync[[2 @
([[@ A
creditCardPayment\\ !
,\\! "
command]] 
.]] 

CardNumber]] "
,]]" #
command^^ 
.^^ 
CardHolderName^^ &
,^^& '
command__ 
.__ 
ExpirationDate__ &
,__& '
command`` 
.`` 
Cvv`` 
,`` 
cancellationTokenaa !
)aa! "
;aa" #
}bb 	
ifdd 

(dd 
!dd 
gatewayResultdd 
.dd 
Successdd "
)dd" #
{ee 	
vargg 

auditEventgg 
=gg 

AuditEventgg '
.gg' (
Creategg( .
(gg. /
AuditEventTypehh 
.hh 
PaymentProcessedhh /
,hh/ 0
nameofii 
(ii 
Paymentii 
)ii 
,ii  
paymentjj 
.jj 
Idjj 
,jj 
commandkk 
.kk 
ProcessedBykk #
.kk# $
Valuekk$ )
,kk) *
Systemll 
.ll 
Textll 
.ll 
Jsonll  
.ll  !
JsonSerializerll! /
.ll/ 0
	Serializell0 9
(ll9 :
newll: =
{ll> ?
Actionmm 
=mm 
$strmm (
,mm( )
Successnn 
=nn 
falsenn #
,nn# $
Erroroo 
=oo 
gatewayResultoo )
.oo) *
ErrorMessageoo* 6
}pp 
)pp 
,pp 
$"qq 
$strqq 5
{qq5 6
gatewayResultqq6 C
.qqC D
ErrorMessageqqD P
}qqP Q
"qqQ R
,qqR S
correlationIdrr 
:rr 
Guidrr #
.rr# $
NewGuidrr$ +
(rr+ ,
)rr, -
)rr- .
;rr. /
awaittt !
_auditEventRepositorytt '
.tt' (
AddAsynctt( 0
(tt0 1

auditEventtt1 ;
,tt; <
cancellationTokentt= N
)ttN O
;ttO P
returnvv 
newvv &
AuthorizeCardPaymentResultvv 1
{ww 
Successxx 
=xx 
falsexx 
,xx  
ErrorMessageyy 
=yy 
gatewayResultyy ,
.yy, -
ErrorMessageyy- 9
}zz 
;zz 
}{{ 	
creditCardPayment~~ 
.~~ 
	Authorize~~ #
(~~# $
gatewayResult 
. 
AuthorizationCode +
!+ ,
,, -
gatewayResult
ÄÄ 
.
ÄÄ 
ReferenceNumber
ÄÄ )
,
ÄÄ) *
gatewayResult
ÅÅ 
.
ÅÅ 
CardType
ÅÅ "
)
ÅÅ" #
;
ÅÅ# $
await
ÑÑ  
_paymentRepository
ÑÑ  
.
ÑÑ  !
UpdateAsync
ÑÑ! ,
(
ÑÑ, -
creditCardPayment
ÑÑ- >
,
ÑÑ> ?
cancellationToken
ÑÑ@ Q
)
ÑÑQ R
;
ÑÑR S
var
áá 
successAuditEvent
áá 
=
áá 

AuditEvent
áá  *
.
áá* +
Create
áá+ 1
(
áá1 2
AuditEventType
àà 
.
àà 
PaymentProcessed
àà +
,
àà+ ,
nameof
ââ 
(
ââ 
Payment
ââ 
)
ââ 
,
ââ 
payment
ää 
.
ää 
Id
ää 
,
ää 
command
ãã 
.
ãã 
ProcessedBy
ãã 
.
ãã  
Value
ãã  %
,
ãã% &
System
åå 
.
åå 
Text
åå 
.
åå 
Json
åå 
.
åå 
JsonSerializer
åå +
.
åå+ ,
	Serialize
åå, 5
(
åå5 6
new
åå6 9
{
åå: ;
Action
çç 
=
çç 
$str
çç $
,
çç$ %
Success
éé 
=
éé 
true
éé 
,
éé 
AuthorizationCode
èè !
=
èè" #
gatewayResult
èè$ 1
.
èè1 2
AuthorizationCode
èè2 C
,
èèC D
ReferenceNumber
êê 
=
êê  !
gatewayResult
êê" /
.
êê/ 0
ReferenceNumber
êê0 ?
}
ëë 
)
ëë 
,
ëë 
$"
íí 
$str
íí '
{
íí' (
gatewayResult
íí( 5
.
íí5 6
AuthorizationCode
íí6 G
}
ííG H
"
ííH I
,
ííI J
correlationId
ìì 
:
ìì 
Guid
ìì 
.
ìì  
NewGuid
ìì  '
(
ìì' (
)
ìì( )
)
ìì) *
;
ìì* +
await
ïï #
_auditEventRepository
ïï #
.
ïï# $
AddAsync
ïï$ ,
(
ïï, -
successAuditEvent
ïï- >
,
ïï> ?
cancellationToken
ïï@ Q
)
ïïQ R
;
ïïR S
return
óó 
new
óó (
AuthorizeCardPaymentResult
óó -
{
òò 	
Success
ôô 
=
ôô 
true
ôô 
,
ôô 
AuthorizationCode
öö 
=
öö 
gatewayResult
öö  -
.
öö- .
AuthorizationCode
öö. ?
,
öö? @
ReferenceNumber
õõ 
=
õõ 
gatewayResult
õõ +
.
õõ+ ,
ReferenceNumber
õõ, ;
,
õõ; <
CardType
úú 
=
úú 
gatewayResult
úú $
.
úú$ %
CardType
úú% -
,
úú- .
LastFourDigits
ùù 
=
ùù 
gatewayResult
ùù *
.
ùù* +
LastFourDigits
ùù+ 9
}
ûû 	
;
ûû	 

}
üü 
}†† Œ1
àC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AssignTableToTicketCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class -
!AssignTableToTicketCommandHandler .
:/ 0
ICommandHandler1 @
<@ A&
AssignTableToTicketCommandA [
,[ \%
AssignTableToTicketResult] v
>v w
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
-
!AssignTableToTicketCommandHandler ,
(, -
ITableRepository 
tableRepository (
,( )
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_tableRepository 
= 
tableRepository *
;* +
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< %
AssignTableToTicketResult /
>/ 0
HandleAsync1 <
(< =&
AssignTableToTicketCommand= W
commandX _
,_ `
CancellationTokena r
cancellationToken	s Ñ
=
Ö Ü
default
á é
)
é è
{ 
var 
table 
= 
await 
_tableRepository *
.* +
GetByIdAsync+ 7
(7 8
command8 ?
.? @
TableId@ G
,G H
cancellationTokenI Z
)Z [
;[ \
if 

( 
table 
== 
null 
) 
{   	
throw!! 
new!! 
Domain!! 
.!! 

Exceptions!! '
.!!' (*
BusinessRuleViolationException!!( F
(!!F G
$"!!G I
$str!!I O
{!!O P
command!!P W
.!!W X
TableId!!X _
}!!_ `
$str!!` k
"!!k l
)!!l m
;!!m n
}"" 	
var%% 
ticket%% 
=%% 
await%% 
_ticketRepository%% ,
.%%, -
GetByIdAsync%%- 9
(%%9 :
command%%: A
.%%A B
TicketId%%B J
,%%J K
cancellationToken%%L ]
)%%] ^
;%%^ _
if&& 

(&& 
ticket&& 
==&& 
null&& 
)&& 
{'' 	
throw(( 
new(( 
Domain(( 
.(( 

Exceptions(( '
.((' (*
BusinessRuleViolationException((( F
(((F G
$"((G I
$str((I P
{((P Q
command((Q X
.((X Y
TicketId((Y a
}((a b
$str((b m
"((m n
)((n o
;((o p
})) 	
table,, 
.,, 
AssignTicket,, 
(,, 
command,, "
.,," #
TicketId,,# +
),,+ ,
;,,, -
ticket-- 
.-- 
AddTableNumber-- 
(-- 
table-- #
.--# $
TableNumber--$ /
)--/ 0
;--0 1
await00 
_tableRepository00 
.00 
UpdateAsync00 *
(00* +
table00+ 0
,000 1
cancellationToken002 C
)00C D
;00D E
await11 
_ticketRepository11 
.11  
UpdateAsync11  +
(11+ ,
ticket11, 2
,112 3
cancellationToken114 E
)11E F
;11F G
var44 
correlationId44 
=44 
Guid44  
.44  !
NewGuid44! (
(44( )
)44) *
;44* +
var55 

auditEvent55 
=55 

AuditEvent55 #
.55# $
Create55$ *
(55* +
AuditEventType66 
.66 
Modified66 #
,66# $
nameof77 
(77 
Table77 
)77 
,77 
table88 
.88 
Id88 
,88 
Guid99 
.99 
Empty99 
,99 
System:: 
.:: 
Text:: 
.:: 
Json:: 
.:: 
JsonSerializer:: +
.::+ ,
	Serialize::, 5
(::5 6
new::6 9
{;; 
TableId<< 
=<< 
table<< 
.<<  
Id<<  "
,<<" #
TableNumber== 
=== 
table== #
.==# $
TableNumber==$ /
,==/ 0
TicketId>> 
=>> 
command>> "
.>>" #
TicketId>># +
,>>+ ,
Status?? 
=?? 
table?? 
.?? 
Status?? %
}@@ 
)@@ 
,@@ 
$"AA 
$strAA 
{AA 
tableAA 
.AA 
TableNumberAA &
}AA& '
$strAA' ;
{AA; <
commandAA< C
.AAC D
TicketIdAAD L
}AAL M
"AAM N
,AAN O
correlationIdBB 
:BB 
correlationIdBB (
)BB( )
;BB) *
awaitDD !
_auditEventRepositoryDD #
.DD# $
AddAsyncDD$ ,
(DD, -

auditEventDD- 7
,DD7 8
cancellationTokenDD9 J
)DDJ K
;DDK L
returnFF 
newFF %
AssignTableToTicketResultFF ,
{GG 	
TableIdHH 
=HH 
tableHH 
.HH 
IdHH 
,HH 
TicketIdII 
=II 
commandII 
.II 
TicketIdII '
}JJ 	
;JJ	 

}KK 
}LL à≤
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\BatchPaymentDomainService.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
{ 
public 

class %
BatchPaymentDomainService *
{ 
private 
readonly 
ITicketRepository *
_ticketRepository+ <
;< =
private 
readonly 
IPaymentRepository +
_paymentRepository, >
;> ?
private 
readonly "
ICashSessionRepository /"
_cashSessionRepository0 F
;F G
private 
readonly 
IEventPublisher (
_eventPublisher) 8
;8 9
public %
BatchPaymentDomainService (
(( )
ITicketRepository 
ticketRepository .
,. /
IPaymentRepository 
paymentRepository 0
,0 1"
ICashSessionRepository "!
cashSessionRepository# 8
,8 9
IEventPublisher 
eventPublisher *
)* +
{ 	
_ticketRepository 
= 
ticketRepository  0
;0 1
_paymentRepository 
=  
paymentRepository! 2
;2 3"
_cashSessionRepository "
=# $!
cashSessionRepository% :
;: ;
_eventPublisher 
= 
eventPublisher ,
;, -
}   	
public%% 
async%% 
Task%% 
<%% 
BatchPaymentResult%% ,
>%%, -$
ProcessBatchPaymentAsync%%. F
(%%F G
BatchPaymentRequest%%G Z
request%%[ b
)%%b c
{&& 	
var(( 
tickets(( 
=(( 
await(( !
ValidateAndGetTickets((  5
(((5 6
request((6 =
.((= >
	TicketIds((> G
)((G H
;((H I
var++ 
paymentDistribution++ #
=++$ %(
CalculatePaymentDistribution++& B
(++B C
tickets++C J
,++J K
request++L S
.++S T
TotalAmount++T _
)++_ `
;++` a
using.. 
var.. 
transaction.. !
=.." #
await..$ )
_ticketRepository..* ;
...; <!
BeginTransactionAsync..< Q
(..Q R
)..R S
;..S T
try00 
{11 
var22 
payments22 
=22 
new22 "
List22# '
<22' (
Payment22( /
>22/ 0
(220 1
)221 2
;222 3
var33 
updatedTickets33 "
=33# $
new33% (
List33) -
<33- .
Ticket33. 4
>334 5
(335 6
)336 7
;337 8
foreach66 
(66 
var66 
distribution66 )
in66* ,
paymentDistribution66- @
)66@ A
{77 
var88 
ticket88 
=88  
tickets88! (
.88( )
First88) .
(88. /
t88/ 0
=>881 3
t884 5
.885 6
Id886 8
==889 ;
distribution88< H
.88H I
TicketId88I Q
)88Q R
;88R S
var;; 
payment;; 
=;;  !
CreatePayment;;" /
(;;/ 0
request;;0 7
,;;7 8
ticket;;9 ?
,;;? @
distribution;;A M
.;;M N
Amount;;N T
);;T U
;;;U V
await<< 
_paymentRepository<< ,
.<<, -
AddAsync<<- 5
(<<5 6
payment<<6 =
)<<= >
;<<> ?
payments== 
.== 
Add==  
(==  !
payment==! (
)==( )
;==) *
ticket@@ 
.@@ 

AddPayment@@ %
(@@% &
payment@@& -
)@@- .
;@@. /
awaitAA 
_ticketRepositoryAA +
.AA+ ,
UpdateAsyncAA, 7
(AA7 8
ticketAA8 >
)AA> ?
;AA? @
updatedTicketsBB "
.BB" #
AddBB# &
(BB& '
ticketBB' -
)BB- .
;BB. /
}CC 
awaitFF %
PublishBatchPaymentEventsFF /
(FF/ 0
requestFF0 7
,FF7 8
ticketsFF9 @
,FF@ A
paymentsFFB J
)FFJ K
;FFK L
awaitII 
transactionII !
.II! "
CommitAsyncII" -
(II- .
)II. /
;II/ 0
returnKK 
newKK 
BatchPaymentResultKK -
{LL 
SuccessMM 
=MM 
trueMM "
,MM" #
	TicketIdsNN 
=NN 
requestNN  '
.NN' (
	TicketIdsNN( 1
,NN1 2

PaymentIdsOO 
=OO  
paymentsOO! )
.OO) *
SelectOO* 0
(OO0 1
pOO1 2
=>OO3 5
pOO6 7
.OO7 8
IdOO8 :
)OO: ;
.OO; <
ToListOO< B
(OOB C
)OOC D
,OOD E
TotalProcessedPP "
=PP# $
paymentsPP% -
.PP- .
SumPP. 1
(PP1 2
pPP2 3
=>PP4 6
pPP7 8
.PP8 9
AmountPP9 ?
.PP? @
AmountPP@ F
)PPF G
,PPG H
ChangeAmountQQ  
=QQ! "
CalculateChangeQQ# 2
(QQ2 3
requestQQ3 :
,QQ: ;
paymentDistributionQQ< O
.QQO P
SumQQP S
(QQS T
dQQT U
=>QQV X
dQQY Z
.QQZ [
AmountQQ[ a
.QQa b
AmountQQb h
)QQh i
)QQi j
}RR 
;RR 
}SS 
catchTT 
(TT 
	ExceptionTT 
exTT 
)TT  
{UU 
awaitWW 
transactionWW !
.WW! "
RollbackAsyncWW" /
(WW/ 0
)WW0 1
;WW1 2
returnXX 
newXX 
BatchPaymentResultXX -
{YY 
SuccessZZ 
=ZZ 
falseZZ #
,ZZ# $
ErrorMessage[[  
=[[! "
ex[[# %
.[[% &
Message[[& -
,[[- .
	TicketIds\\ 
=\\ 
request\\  '
.\\' (
	TicketIds\\( 1
}]] 
;]] 
}^^ 
}__ 	
privateaa 
asyncaa 
Taskaa 
<aa 
Listaa 
<aa  
Ticketaa  &
>aa& '
>aa' (!
ValidateAndGetTicketsaa) >
(aa> ?
Listaa? C
<aaC D
GuidaaD H
>aaH I
	ticketIdsaaJ S
)aaS T
{bb 	
varcc 
ticketscc 
=cc 
newcc 
Listcc "
<cc" #
Ticketcc# )
>cc) *
(cc* +
)cc+ ,
;cc, -
foreachee 
(ee 
varee 
ticketIdee !
inee" $
	ticketIdsee% .
)ee. /
{ff 
vargg 
ticketgg 
=gg 
awaitgg "
_ticketRepositorygg# 4
.gg4 5
GetByIdAsyncgg5 A
(ggA B
ticketIdggB J
)ggJ K
;ggK L
ifhh 
(hh 
tickethh 
==hh 
nullhh "
)hh" #
{ii 
throwjj 
newjj %
InvalidOperationExceptionjj 7
(jj7 8
$"jj8 :
$strjj: A
{jjA B
ticketIdjjB J
}jjJ K
$strjjK U
"jjU V
)jjV W
;jjW X
}kk 
ifll 
(ll 
ticketll 
.ll 
Statusll !
!=ll" $
TicketStatusll% 1
.ll1 2
Openll2 6
)ll6 7
{mm 
thrownn 
newnn %
InvalidOperationExceptionnn 7
(nn7 8
$"nn8 :
$strnn: A
{nnA B
ticketIdnnB J
}nnJ K
$strnnK `
"nn` a
)nna b
;nnb c
}oo 
ifpp 
(pp 
ticketpp 
.pp 
	DueAmountpp $
.pp$ %
Amountpp% +
<=pp, .
$numpp/ 0
)pp0 1
{qq 
throwrr 
newrr %
InvalidOperationExceptionrr 7
(rr7 8
$"rr8 :
$strrr: A
{rrA B
ticketIdrrB J
}rrJ K
$strrrK ]
"rr] ^
)rr^ _
;rr_ `
}ss 
ticketstt 
.tt 
Addtt 
(tt 
tickettt "
)tt" #
;tt# $
}uu 
returnww 
ticketsww 
;ww 
}xx 	
privatezz 
Listzz 
<zz 
PaymentDistributionzz (
>zz( )(
CalculatePaymentDistributionzz* F
(zzF G
ListzzG K
<zzK L
TicketzzL R
>zzR S
ticketszzT [
,zz[ \
Moneyzz] b
totalAmountzzc n
)zzn o
{{{ 	
var|| 
distributions|| 
=|| 
new||  #
List||$ (
<||( )
PaymentDistribution||) <
>||< =
(||= >
)||> ?
;||? @
var}} 
totalDue}} 
=}} 
tickets}} "
.}}" #
Sum}}# &
(}}& '
t}}' (
=>}}) +
t}}, -
.}}- .
	DueAmount}}. 7
.}}7 8
Amount}}8 >
)}}> ?
;}}? @
foreach
ÄÄ 
(
ÄÄ 
var
ÄÄ 
ticket
ÄÄ 
in
ÄÄ  "
tickets
ÄÄ# *
)
ÄÄ* +
{
ÅÅ 
var
ÇÇ 
	ticketDue
ÇÇ 
=
ÇÇ 
ticket
ÇÇ  &
.
ÇÇ& '
	DueAmount
ÇÇ' 0
.
ÇÇ0 1
Amount
ÇÇ1 7
;
ÇÇ7 8
var
ÉÉ 

proportion
ÉÉ 
=
ÉÉ  
	ticketDue
ÉÉ! *
/
ÉÉ+ ,
totalDue
ÉÉ- 5
;
ÉÉ5 6
var
ÑÑ 
paymentAmount
ÑÑ !
=
ÑÑ" #
Math
ÑÑ$ (
.
ÑÑ( )
Round
ÑÑ) .
(
ÑÑ. /
totalAmount
ÑÑ/ :
.
ÑÑ: ;
Amount
ÑÑ; A
*
ÑÑB C

proportion
ÑÑD N
,
ÑÑN O
$num
ÑÑP Q
)
ÑÑQ R
;
ÑÑR S
distributions
ÜÜ 
.
ÜÜ 
Add
ÜÜ !
(
ÜÜ! "
new
ÜÜ" %!
PaymentDistribution
ÜÜ& 9
{
áá 
TicketId
àà 
=
àà 
ticket
àà %
.
àà% &
Id
àà& (
,
àà( )
Amount
ââ 
=
ââ 
new
ââ  
Money
ââ! &
(
ââ& '
paymentAmount
ââ' 4
,
ââ4 5
totalAmount
ââ6 A
.
ââA B
Currency
ââB J
)
ââJ K
,
ââK L
	DueAmount
ää 
=
ää 
ticket
ää  &
.
ää& '
	DueAmount
ää' 0
}
ãã 
)
ãã 
;
ãã 
}
åå 
return
éé 
distributions
éé  
;
éé  !
}
èè 	
private
ëë 
Payment
ëë 
CreatePayment
ëë %
(
ëë% &!
BatchPaymentRequest
ëë& 9
request
ëë: A
,
ëëA B
Ticket
ëëC I
ticket
ëëJ P
,
ëëP Q
Money
ëëR W
amount
ëëX ^
)
ëë^ _
{
íí 	
Payment
ìì 
payment
ìì 
;
ìì 
if
ïï 
(
ïï 
request
ïï 
.
ïï 
PaymentType
ïï #
==
ïï$ &
PaymentType
ïï' 2
.
ïï2 3
Cash
ïï3 7
)
ïï7 8
{
ññ 
payment
óó 
=
óó 
CashPayment
óó %
.
óó% &
Create
óó& ,
(
óó, -
ticket
òò 
.
òò 
Id
òò 
,
òò 
amount
ôô 
,
ôô 
request
öö 
.
öö 
ProcessedBy
öö '
,
öö' (
request
õõ 
.
õõ 

TerminalId
õõ &
,
õõ& '
request
úú 
.
úú 
GlobalId
úú $
)
ùù 
;
ùù 
}
ûû 
else
üü 
if
üü 
(
üü 
request
üü 
.
üü 
PaymentType
üü (
==
üü) +
PaymentType
üü, 7
.
üü7 8

CreditCard
üü8 B
)
üüB C
{
†† 
payment
°° 
=
°° 
CreditCardPayment
°° +
.
°°+ ,
Create
°°, 2
(
°°2 3
ticket
¢¢ 
.
¢¢ 
Id
¢¢ 
,
¢¢ 
amount
££ 
,
££ 
request
§§ 
.
§§ 
ProcessedBy
§§ '
,
§§' (
request
•• 
.
•• 

TerminalId
•• &
,
••& '
null
¶¶ 
,
¶¶ 
$str
ßß #
,
ßß# $
request
®® 
.
®® 
AuthCode
®® $
,
®®$ %
null
©© 
,
©© 
request
™™ 
.
™™ 
CardType
™™ $
,
™™$ %
request
´´ 
.
´´ 
GlobalId
´´ $
)
¨¨ 
;
¨¨ 
if
ØØ 
(
ØØ 
!
ØØ 
string
ØØ 
.
ØØ 
IsNullOrEmpty
ØØ )
(
ØØ) *
request
ØØ* 1
.
ØØ1 2
AuthCode
ØØ2 :
)
ØØ: ;
)
ØØ; <
{
∞∞ 
(
±± 
(
±± 
CreditCardPayment
±± '
)
±±' (
payment
±±( /
)
±±/ 0
.
±±0 1
	Authorize
±±1 :
(
±±: ;
request
±±; B
.
±±B C
AuthCode
±±C K
,
±±K L
null
±±M Q
,
±±Q R
request
±±S Z
.
±±Z [
CardType
±±[ c
)
±±c d
;
±±d e
}
≤≤ 
}
≥≥ 
else
¥¥ 
{
µµ 
throw
∑∑ 
new
∑∑ #
NotSupportedException
∑∑ /
(
∑∑/ 0
$"
∑∑0 2
$str
∑∑2 ?
{
∑∑? @
request
∑∑@ G
.
∑∑G H
PaymentType
∑∑H S
}
∑∑S T
$str
∑∑T w
"
∑∑w x
)
∑∑x y
;
∑∑y z
}
∏∏ 
return
∫∫ 
payment
∫∫ 
;
∫∫ 
}
ªª 	
private
ΩΩ 
async
ΩΩ 
Task
ΩΩ '
PublishBatchPaymentEvents
ΩΩ 4
(
ΩΩ4 5!
BatchPaymentRequest
ΩΩ5 H
request
ΩΩI P
,
ΩΩP Q
List
ΩΩR V
<
ΩΩV W
Ticket
ΩΩW ]
>
ΩΩ] ^
tickets
ΩΩ_ f
,
ΩΩf g
List
ΩΩh l
<
ΩΩl m
Payment
ΩΩm t
>
ΩΩt u
payments
ΩΩv ~
)
ΩΩ~ 
{
ææ 	
var
¿¿ 
groupSettleEvent
¿¿  
=
¿¿! "
new
¿¿# &
GroupSettled
¿¿' 3
(
¿¿3 4
request
¡¡ 
.
¡¡ 
	TicketIds
¡¡ !
,
¡¡! "
request
¬¬ 
.
¬¬ 
TotalAmount
¬¬ #
,
¬¬# $
request
√√ 
.
√√ 
PaymentType
√√ #
,
√√# $
request
ƒƒ 
.
ƒƒ 
ProcessedBy
ƒƒ #
,
ƒƒ# $
payments
≈≈ 
.
≈≈ 
Select
≈≈ 
(
≈≈  
p
≈≈  !
=>
≈≈" $
p
≈≈% &
.
≈≈& '
Id
≈≈' )
)
≈≈) *
.
≈≈* +
ToList
≈≈+ 1
(
≈≈1 2
)
≈≈2 3
)
∆∆ 
;
∆∆ 
await
»» 
_eventPublisher
»» !
.
»»! "
PublishAsync
»»" .
(
»». /
groupSettleEvent
»»/ ?
)
»»? @
;
»»@ A
foreach
ÀÀ 
(
ÀÀ 
var
ÀÀ 
payment
ÀÀ  
in
ÀÀ! #
payments
ÀÀ$ ,
)
ÀÀ, -
{
ÃÃ 
var
ÕÕ 
paymentEvent
ÕÕ  
=
ÕÕ! "
new
ÕÕ# &
PaymentProcessed
ÕÕ' 7
(
ÕÕ7 8
payment
ŒŒ 
.
ŒŒ 
Id
ŒŒ 
,
ŒŒ 
payment
œœ 
.
œœ 
TicketId
œœ $
,
œœ$ %
payment
–– 
.
–– 
Amount
–– "
,
––" #
payment
—— 
.
—— 
PaymentType
—— '
,
——' (
payment
““ 
.
““ 
ProcessedBy
““ '
)
”” 
;
”” 
await
’’ 
_eventPublisher
’’ %
.
’’% &
PublishAsync
’’& 2
(
’’2 3
paymentEvent
’’3 ?
)
’’? @
;
’’@ A
}
÷÷ 
}
◊◊ 	
private
ŸŸ 
Money
ŸŸ 
CalculateChange
ŸŸ %
(
ŸŸ% &!
BatchPaymentRequest
ŸŸ& 9
request
ŸŸ: A
,
ŸŸA B
decimal
ŸŸC J
totalProcessed
ŸŸK Y
)
ŸŸY Z
{
⁄⁄ 	
var
€€ 
change
€€ 
=
€€ 
request
€€  
.
€€  !
TenderAmount
€€! -
.
€€- .
Amount
€€. 4
-
€€5 6
totalProcessed
€€7 E
;
€€E F
return
‹‹ 
new
‹‹ 
Money
‹‹ 
(
‹‹ 
Math
‹‹ !
.
‹‹! "
Max
‹‹" %
(
‹‹% &
$num
‹‹& '
,
‹‹' (
change
‹‹) /
)
‹‹/ 0
,
‹‹0 1
request
‹‹2 9
.
‹‹9 :
TenderAmount
‹‹: F
.
‹‹F G
Currency
‹‹G O
)
‹‹O P
;
‹‹P Q
}
›› 	
}
ﬁﬁ 
public
‡‡ 

class
‡‡ !
BatchPaymentRequest
‡‡ $
{
·· 
public
‚‚ 
List
‚‚ 
<
‚‚ 
Guid
‚‚ 
>
‚‚ 
	TicketIds
‚‚ #
{
‚‚$ %
get
‚‚& )
;
‚‚) *
set
‚‚+ .
;
‚‚. /
}
‚‚0 1
=
‚‚2 3
new
‚‚4 7
(
‚‚7 8
)
‚‚8 9
;
‚‚9 :
public
„„ 
Money
„„ 
TotalAmount
„„  
{
„„! "
get
„„# &
;
„„& '
set
„„( +
;
„„+ ,
}
„„- .
=
„„/ 0
new
„„1 4
(
„„4 5
$num
„„5 7
,
„„7 8
$str
„„9 >
)
„„> ?
;
„„? @
public
‰‰ 
Money
‰‰ 
TenderAmount
‰‰ !
{
‰‰" #
get
‰‰$ '
;
‰‰' (
set
‰‰) ,
;
‰‰, -
}
‰‰. /
=
‰‰0 1
new
‰‰2 5
(
‰‰5 6
$num
‰‰6 8
,
‰‰8 9
$str
‰‰: ?
)
‰‰? @
;
‰‰@ A
public
ÂÂ 
PaymentType
ÂÂ 
PaymentType
ÂÂ &
{
ÂÂ' (
get
ÂÂ) ,
;
ÂÂ, -
set
ÂÂ. 1
;
ÂÂ1 2
}
ÂÂ3 4
public
ÊÊ 
UserId
ÊÊ 
ProcessedBy
ÊÊ !
{
ÊÊ" #
get
ÊÊ$ '
;
ÊÊ' (
set
ÊÊ) ,
;
ÊÊ, -
}
ÊÊ. /
=
ÊÊ0 1
null
ÊÊ2 6
!
ÊÊ6 7
;
ÊÊ7 8
public
ÁÁ 
Guid
ÁÁ 

TerminalId
ÁÁ 
{
ÁÁ  
get
ÁÁ! $
;
ÁÁ$ %
set
ÁÁ& )
;
ÁÁ) *
}
ÁÁ+ ,
public
ËË 
string
ËË 
GlobalId
ËË 
{
ËË  
get
ËË! $
;
ËË$ %
set
ËË& )
;
ËË) *
}
ËË+ ,
=
ËË- .
string
ËË/ 5
.
ËË5 6
Empty
ËË6 ;
;
ËË; <
public
ÈÈ 
string
ÈÈ 
?
ÈÈ 
AuthCode
ÈÈ 
{
ÈÈ  !
get
ÈÈ" %
;
ÈÈ% &
set
ÈÈ' *
;
ÈÈ* +
}
ÈÈ, -
public
ÍÍ 
string
ÍÍ 
?
ÍÍ 
CardType
ÍÍ 
{
ÍÍ  !
get
ÍÍ" %
;
ÍÍ% &
set
ÍÍ' *
;
ÍÍ* +
}
ÍÍ, -
public
ÎÎ 
string
ÎÎ 
?
ÎÎ 

AuthMethod
ÎÎ !
{
ÎÎ" #
get
ÎÎ$ '
;
ÎÎ' (
set
ÎÎ) ,
;
ÎÎ, -
}
ÎÎ. /
}
ÏÏ 
public
ÓÓ 

class
ÓÓ  
BatchPaymentResult
ÓÓ #
{
ÔÔ 
public
 
bool
 
Success
 
{
 
get
 !
;
! "
set
# &
;
& '
}
( )
public
ÒÒ 
List
ÒÒ 
<
ÒÒ 
Guid
ÒÒ 
>
ÒÒ 
	TicketIds
ÒÒ #
{
ÒÒ$ %
get
ÒÒ& )
;
ÒÒ) *
set
ÒÒ+ .
;
ÒÒ. /
}
ÒÒ0 1
=
ÒÒ2 3
new
ÒÒ4 7
(
ÒÒ7 8
)
ÒÒ8 9
;
ÒÒ9 :
public
ÚÚ 
List
ÚÚ 
<
ÚÚ 
Guid
ÚÚ 
>
ÚÚ 

PaymentIds
ÚÚ $
{
ÚÚ% &
get
ÚÚ' *
;
ÚÚ* +
set
ÚÚ, /
;
ÚÚ/ 0
}
ÚÚ1 2
=
ÚÚ3 4
new
ÚÚ5 8
(
ÚÚ8 9
)
ÚÚ9 :
;
ÚÚ: ;
public
ÛÛ 
decimal
ÛÛ 
TotalProcessed
ÛÛ %
{
ÛÛ& '
get
ÛÛ( +
;
ÛÛ+ ,
set
ÛÛ- 0
;
ÛÛ0 1
}
ÛÛ2 3
public
ÙÙ 
Money
ÙÙ 
ChangeAmount
ÙÙ !
{
ÙÙ" #
get
ÙÙ$ '
;
ÙÙ' (
set
ÙÙ) ,
;
ÙÙ, -
}
ÙÙ. /
=
ÙÙ0 1
new
ÙÙ2 5
(
ÙÙ5 6
$num
ÙÙ6 8
,
ÙÙ8 9
$str
ÙÙ: ?
)
ÙÙ? @
;
ÙÙ@ A
public
ıı 
string
ıı 
?
ıı 
ErrorMessage
ıı #
{
ıı$ %
get
ıı& )
;
ıı) *
set
ıı+ .
;
ıı. /
}
ıı0 1
}
ˆˆ 
internal
¯¯ 
class
¯¯ !
PaymentDistribution
¯¯ &
{
˘˘ 
public
˙˙ 
Guid
˙˙ 
TicketId
˙˙ 
{
˙˙ 
get
˙˙ "
;
˙˙" #
set
˙˙$ '
;
˙˙' (
}
˙˙) *
public
˚˚ 
Money
˚˚ 
Amount
˚˚ 
{
˚˚ 
get
˚˚ !
;
˚˚! "
set
˚˚# &
;
˚˚& '
}
˚˚( )
=
˚˚* +
new
˚˚, /
(
˚˚/ 0
$num
˚˚0 2
,
˚˚2 3
$str
˚˚4 9
)
˚˚9 :
;
˚˚: ;
public
¸¸ 
Money
¸¸ 
	DueAmount
¸¸ 
{
¸¸  
get
¸¸! $
;
¸¸$ %
set
¸¸& )
;
¸¸) *
}
¸¸+ ,
=
¸¸- .
new
¸¸/ 2
(
¸¸2 3
$num
¸¸3 5
,
¸¸5 6
$str
¸¸7 <
)
¸¸< =
;
¸¸= >
}
˝˝ 
}˛˛ ¬=
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ApplyDiscountCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class '
ApplyDiscountCommandHandler (
:) *
ICommandHandler+ :
<: ; 
ApplyDiscountCommand; O
>O P
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
Domain 
. 
DomainServices *
.* +!
DiscountDomainService+ @"
_discountDomainServiceA W
;W X
private 
readonly 
IDiscountRepository (
_discountRepository) <
;< =
public 
'
ApplyDiscountCommandHandler &
(& '
ITicketRepository 
ticketRepository *
,* +!
IAuditEventRepository  
auditEventRepository 2
,2 3
Domain 
. 
DomainServices 
. !
DiscountDomainService 3!
discountDomainService4 I
,I J
IDiscountRepository 
discountRepository .
). /
{ 
_ticketRepository 
= 
ticketRepository ,
;, -!
_auditEventRepository 
=  
auditEventRepository  4
;4 5"
_discountDomainService 
=  !
discountDomainService! 6
;6 7
_discountRepository 
= 
discountRepository 0
;0 1
} 
public   

async   
Task   
HandleAsync   !
(  ! " 
ApplyDiscountCommand  " 6
command  7 >
,  > ?
CancellationToken  @ Q
cancellationToken  R c
=  d e
default  f m
)  m n
{!! 
var## 
ticket## 
=## 
await## 
_ticketRepository## ,
.##, -
GetByIdAsync##- 9
(##9 :
command##: A
.##A B
TicketId##B J
,##J K
cancellationToken##L ]
)##] ^
;##^ _
if$$ 

($$ 
ticket$$ 
==$$ 
null$$ 
)$$ 
{%% 	
throw&& 
new&& 
Domain&& 
.&& 

Exceptions&& '
.&&' (*
BusinessRuleViolationException&&( F
(&&F G
$"&&G I
$str&&I P
{&&P Q
command&&Q X
.&&X Y
TicketId&&Y a
}&&a b
$str&&b m
"&&m n
)&&n o
;&&o p
}'' 	
var** 
discount** 
=** 
await** 
_discountRepository** 0
.**0 1
GetByIdAsync**1 =
(**= >
command**> E
.**E F

DiscountId**F P
,**P Q
cancellationToken**R c
)**c d
;**d e
if++ 

(++ 
discount++ 
==++ 
null++ 
)++ 
{,, 	
throw-- 
new-- 
Domain-- 
.-- 

Exceptions-- '
.--' (*
BusinessRuleViolationException--( F
(--F G
$str--G Z
)--Z [
;--[ \
}.. 	
if00 

(00 
command00 
.00 
OrderLineId00 
.00  
HasValue00  (
)00( )
{11 	
var33 
line33 
=33 
ticket33 
.33 

OrderLines33 (
.33( )
FirstOrDefault33) 7
(337 8
x338 9
=>33: <
x33= >
.33> ?
Id33? A
==33B D
command33E L
.33L M
OrderLineId33M X
.33X Y
Value33Y ^
)33^ _
;33_ `
if44 
(44 
line44 
==44 
null44 
)44 
throw44 #
new44$ '
Domain44( .
.44. /

Exceptions44/ 9
.449 :*
BusinessRuleViolationException44: X
(44X Y
$str44Y p
)44p q
;44q r
if66 
(66 
!66 "
_discountDomainService66 '
.66' (

IsEligible66( 2
(662 3
discount663 ;
,66; <
line66= A
)66A B
)66B C
{77 
throw88 
new88 
Domain88  
.88  !

Exceptions88! +
.88+ ,*
BusinessRuleViolationException88, J
(88J K
$str88K t
)88t u
;88u v
}99 
var;; 
amount;; 
=;; "
_discountDomainService;; /
.;;/ 0#
CalculateDiscountAmount;;0 G
(;;G H
discount;;H P
,;;P Q
line;;R V
.;;V W
SubtotalAmount;;W e
);;e f
;;;f g
var== 
lineDiscount== 
=== 
OrderLineDiscount== 0
.==0 1
Create==1 7
(==7 8
line>> 
.>> 
Id>> 
,>> 
discount?? 
.?? 
Id?? 
,?? 
discount@@ 
.@@ 
Name@@ 
,@@ 
discountAA 
.AA 
TypeAA 
,AA 
discountBB 
.BB 
ValueBB 
,BB 
amountCC 
,CC 
discountDD 
.DD 
MinimumQuantityDD (
)EE 
;EE 
ticketGG 
.GG 
ApplyLineDiscountGG $
(GG$ %
lineGG% )
.GG) *
IdGG* ,
,GG, -
lineDiscountGG. :
)GG: ;
;GG; <
}HH 	
elseII 
{JJ 	
ifLL 
(LL 
!LL "
_discountDomainServiceLL '
.LL' (

IsEligibleLL( 2
(LL2 3
discountLL3 ;
,LL; <
ticketLL= C
)LLC D
)LLD E
{MM 
throwNN 
newNN 
DomainNN !
.NN! "

ExceptionsNN" ,
.NN, -*
BusinessRuleViolationExceptionNN- K
(NNK L
$strNNL w
)NNw x
;NNx y
}OO 
varQQ 
amountQQ 
=QQ "
_discountDomainServiceQQ /
.QQ/ 0#
CalculateDiscountAmountQQ0 G
(QQG H
discountQQH P
,QQP Q
ticketQQR X
.QQX Y
SubtotalAmountQQY g
)QQg h
;QQh i
varSS 
ticketDiscountSS 
=SS  
TicketDiscountSS! /
.SS/ 0
CreateSS0 6
(SS6 7
ticketTT 
.TT 
IdTT 
,TT 
discountUU 
.UU 
IdUU 
,UU 
discountVV 
.VV 
NameVV 
,VV 
discountWW 
.WW 
TypeWW 
,WW 
discountXX 
.XX 
ValueXX 
,XX 
amountYY 
,YY 
discountZZ 
.ZZ 

MinimumBuyZZ #
)[[ 
;[[ 
ticket]] 
.]] 
ApplyDiscount]]  
(]]  !
ticketDiscount]]! /
)]]/ 0
;]]0 1
}^^ 	
await`` 
_ticketRepository`` 
.``  
UpdateAsync``  +
(``+ ,
ticket``, 2
,``2 3
cancellationToken``4 E
)``E F
;``F G
}aa 
}bb í;
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\ApplyCouponCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
ApplyCouponCommandHandler &
:' (
ICommandHandler) 8
<8 9
ApplyCouponCommand9 K
>K L
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IDiscountRepository (
_discountRepository) <
;< =
private 
readonly 
TicketDomainService ( 
_ticketDomainService) =
;= >
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
%
ApplyCouponCommandHandler $
($ %
ITicketRepository 
ticketRepository *
,* +
IDiscountRepository 
discountRepository .
,. /
TicketDomainService 
ticketDomainService /
,/ 0!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
??- /
throw0 5
new6 9!
ArgumentNullException: O
(O P
nameofP V
(V W
ticketRepositoryW g
)g h
)h i
;i j
_discountRepository 
= 
discountRepository 0
??1 3
throw4 9
new: =!
ArgumentNullException> S
(S T
nameofT Z
(Z [
discountRepository[ m
)m n
)n o
;o p 
_ticketDomainService 
= 
ticketDomainService 2
??3 5
throw6 ;
new< ?!
ArgumentNullException@ U
(U V
nameofV \
(\ ]
ticketDomainService] p
)p q
)q r
;r s!
_auditEventRepository 
=  
auditEventRepository  4
??5 7
throw8 =
new> A!
ArgumentNullExceptionB W
(W X
nameofX ^
(^ _ 
auditEventRepository_ s
)s t
)t u
;u v
} 
public   

async   
Task   
HandleAsync   !
(  ! "
ApplyCouponCommand  " 4
command  5 <
,  < =
CancellationToken  > O
cancellationToken  P a
=  b c
default  d k
)  k l
{!! 
if"" 

("" 
command"" 
=="" 
null"" 
)"" 
throw"" "
new""# &!
ArgumentNullException""' <
(""< =
nameof""= C
(""C D
command""D K
)""K L
)""L M
;""M N
var%% 
ticket%% 
=%% 
await%% 
_ticketRepository%% ,
.%%, -
GetByIdAsync%%- 9
(%%9 :
command%%: A
.%%A B
TicketId%%B J
,%%J K
cancellationToken%%L ]
)%%] ^
;%%^ _
if&& 

(&& 
ticket&& 
==&& 
null&& 
)&& 
{'' 	
throw(( 
new(( 
NotFoundException(( '
(((' (
$"((( *
$str((* 1
{((1 2
command((2 9
.((9 :
TicketId((: B
}((B C
$str((C N
"((N O
)((O P
;((P Q
})) 	
if,, 

(,, 
string,, 
.,, 
IsNullOrWhiteSpace,, %
(,,% &
command,,& -
.,,- .

CouponCode,,. 8
),,8 9
),,9 :
{-- 	
throw.. 
new.. *
BusinessRuleViolationException.. 4
(..4 5
$str..5 S
)..S T
;..T U
}// 	
var11 
discount11 
=11 
await11 
_discountRepository11 0
.110 1 
GetByCouponCodeAsync111 E
(11E F
command11F M
.11M N

CouponCode11N X
,11X Y
cancellationToken11Z k
)11k l
;11l m
if22 

(22 
discount22 
==22 
null22 
)22 
{33 	
throw44 
new44 *
BusinessRuleViolationException44 4
(444 5
$"445 7
$str447 M
{44M N
command44N U
.44U V

CouponCode44V `
}44` a
$str44a c
"44c d
)44d e
;44e f
}55 	 
_ticketDomainService88 
.88 %
ValidateCouponApplication88 6
(886 7
ticket887 =
,88= >
discount88? G
)88G H
;88H I
var;; 
amount;; 
=;;  
_ticketDomainService;; )
.;;) *#
CalculateDiscountAmount;;* A
(;;A B
ticket;;B H
,;;H I
discount;;J R
);;R S
;;;S T
var>> 
ticketDiscount>> 
=>> 
TicketDiscount>> +
.>>+ ,
Create>>, 2
(>>2 3
ticket?? 
.?? 
Id?? 
,?? 
discount@@ 
.@@ 
Id@@ 
,@@ 
discountAA 
.AA 
NameAA 
,AA 
discountBB 
.BB 
TypeBB 
,BB 
discountCC 
.CC 
ValueCC 
,CC 
amountDD 
,DD 
discountEE 
.EE 

MinimumBuyEE 
)EE  
;EE  !
ticketHH 
.HH 
ApplyDiscountHH 
(HH 
ticketDiscountHH +
)HH+ ,
;HH, -
awaitKK 
_ticketRepositoryKK 
.KK  
UpdateAsyncKK  +
(KK+ ,
ticketKK, 2
,KK2 3
cancellationTokenKK4 E
)KKE F
;KKF G
varNN 

auditEventNN 
=NN 

AuditEventNN #
.NN# $
CreateNN$ *
(NN* +
AuditEventTypeOO 
.OO 
ModifiedOO #
,OO# $
$strPP 
,PP 
ticketQQ 
.QQ 
IdQQ 
,QQ 
commandRR 
.RR 
	AppliedByRR 
?RR 
.RR 
ValueRR $
??RR% '
GuidRR( ,
.RR, -
EmptyRR- 2
,RR2 3
$strSS 
,SS 
$"TT 
$strTT 
{TT 
discountTT '
.TT' (

CouponCodeTT( 2
}TT2 3
$strTT3 6
{TT6 7
discountTT7 ?
.TT? @
NameTT@ D
}TTD E
$strTTE K
{TTK L
amountTTL R
}TTR S
$strTTS T
"TTT U
,TTU V
correlationIdUU 
:UU 
GuidUU 
.UU  
NewGuidUU  '
(UU' (
)UU( )
)UU) *
;UU* +
awaitWW !
_auditEventRepositoryWW #
.WW# $
AddAsyncWW$ ,
(WW, -

auditEventWW- 7
,WW7 8
cancellationTokenWW9 J
)WWJ K
;WWK L
}XX 
}YY ƒM
âC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AddTipsToCardPaymentCommandHandler.cs
	namespace		 	
Magidesk		
 
.		 
Application		 
.		 
Services		 '
;		' (
public 
class .
"AddTipsToCardPaymentCommandHandler /
:0 1
ICommandHandler2 A
<A B'
AddTipsToCardPaymentCommandB ]
,] ^&
AddTipsToCardPaymentResult_ y
>y z
{ 
private 
readonly 
IPaymentRepository '
_paymentRepository( :
;: ;
private 
readonly 
IPaymentGateway $
_paymentGateway% 4
;4 5
private 
readonly  
PaymentDomainService )!
_paymentDomainService* ?
;? @
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
.
"AddTipsToCardPaymentCommandHandler -
(- .
IPaymentRepository 
paymentRepository ,
,, -
IPaymentGateway 
paymentGateway &
,& ' 
PaymentDomainService  
paymentDomainService 1
,1 2!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_paymentRepository 
= 
paymentRepository .
;. /
_paymentGateway 
= 
paymentGateway (
;( )!
_paymentDomainService 
=  
paymentDomainService  4
;4 5!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public!! 

async!! 
Task!! 
<!! &
AddTipsToCardPaymentResult!! 0
>!!0 1
HandleAsync!!2 =
(!!= >'
AddTipsToCardPaymentCommand"" #
command""$ +
,""+ ,
CancellationToken## 
cancellationToken## +
=##, -
default##. 5
)##5 6
{$$ 
var&& 
payment&& 
=&& 
await&& 
_paymentRepository&& .
.&&. /
GetByIdAsync&&/ ;
(&&; <
command&&< C
.&&C D
	PaymentId&&D M
,&&M N
cancellationToken&&O `
)&&` a
;&&a b
if'' 

('' 
payment'' 
=='' 
null'' 
)'' 
{(( 	
return)) 
new)) &
AddTipsToCardPaymentResult)) 1
{** 
Success++ 
=++ 
false++ 
,++  
ErrorMessage,, 
=,, 
$",, !
$str,,! )
{,,) *
command,,* 1
.,,1 2
	PaymentId,,2 ;
},,; <
$str,,< G
",,G H
}-- 
;-- 
}.. 	
if11 

(11 
payment11 
is11 
not11 
CreditCardPayment11 ,
creditCardPayment11- >
)11> ?
{22 	
return33 
new33 &
AddTipsToCardPaymentResult33 1
{44 
Success55 
=55 
false55 
,55  
ErrorMessage66 
=66 
$"66 !
$str66! )
{66) *
command66* 1
.661 2
	PaymentId662 ;
}66; <
$str66< Z
"66Z [
}77 
;77 
}88 	
if;; 

(;; 
!;; !
_paymentDomainService;; "
.;;" #

CanAddTips;;# -
(;;- .
payment;;. 5
,;;5 6
command;;7 >
.;;> ?

TipsAmount;;? I
);;I J
);;J K
{<< 	
return== 
new== &
AddTipsToCardPaymentResult== 1
{>> 
Success?? 
=?? 
false?? 
,??  
ErrorMessage@@ 
=@@ 
$str@@ F
}AA 
;AA 
}BB 	
ifEE 

(EE 
stringEE 
.EE 
IsNullOrEmptyEE  
(EE  !
creditCardPaymentEE! 2
.EE2 3
AuthorizationCodeEE3 D
)EED E
)EEE F
{FF 	
returnGG 
newGG &
AddTipsToCardPaymentResultGG 1
{HH 
SuccessII 
=II 
falseII 
,II  
ErrorMessageJJ 
=JJ 
$strJJ O
}KK 
;KK 
}LL 	
ifNN 

(NN 
creditCardPaymentNN 
.NN 

IsCapturedNN (
)NN( )
{OO 	
returnPP 
newPP &
AddTipsToCardPaymentResultPP 1
{QQ 
SuccessRR 
=RR 
falseRR 
,RR  
ErrorMessageSS 
=SS 
$strSS G
}TT 
;TT 
}UU 	
varXX 
gatewayResultXX 
=XX 
awaitXX !
_paymentGatewayXX" 1
.XX1 2
AddTipsAsyncXX2 >
(XX> ?
creditCardPaymentYY 
,YY 
commandZZ 
.ZZ 

TipsAmountZZ 
,ZZ 
cancellationToken[[ 
)[[ 
;[[ 
if]] 

(]] 
!]] 
gatewayResult]] 
.]] 
Success]] "
)]]" #
{^^ 	
var`` 

auditEvent`` 
=`` 

AuditEvent`` '
.``' (
Create``( .
(``. /
AuditEventTypeaa 
.aa 
PaymentProcessedaa /
,aa/ 0
nameofbb 
(bb 
Paymentbb 
)bb 
,bb  
paymentcc 
.cc 
Idcc 
,cc 
commanddd 
.dd 
ProcessedBydd #
.dd# $
Valuedd$ )
,dd) *
Systemee 
.ee 
Textee 
.ee 
Jsonee  
.ee  !
JsonSerializeree! /
.ee/ 0
	Serializeee0 9
(ee9 :
newee: =
{ee> ?
Actionff 
=ff 
$strff &
,ff& '
Successgg 
=gg 
falsegg #
,gg# $
Errorhh 
=hh 
gatewayResulthh )
.hh) *
ErrorMessagehh* 6
}ii 
)ii 
,ii 
$"jj 
$strjj 3
{jj3 4
gatewayResultjj4 A
.jjA B
ErrorMessagejjB N
}jjN O
"jjO P
,jjP Q
correlationIdkk 
:kk 
Guidkk #
.kk# $
NewGuidkk$ +
(kk+ ,
)kk, -
)kk- .
;kk. /
awaitmm !
_auditEventRepositorymm '
.mm' (
AddAsyncmm( 0
(mm0 1

auditEventmm1 ;
,mm; <
cancellationTokenmm= N
)mmN O
;mmO P
returnoo 
newoo &
AddTipsToCardPaymentResultoo 1
{pp 
Successqq 
=qq 
falseqq 
,qq  
ErrorMessagerr 
=rr 
gatewayResultrr ,
.rr, -
ErrorMessagerr- 9
}ss 
;ss 
}tt 	
creditCardPaymentww 
.ww 
AddTipsww !
(ww! "
commandww" )
.ww) *

TipsAmountww* 4
)ww4 5
;ww5 6
await}} 
_paymentRepository}}  
.}}  !
UpdateAsync}}! ,
(}}, -
creditCardPayment}}- >
,}}> ?
cancellationToken}}@ Q
)}}Q R
;}}R S
var
ÄÄ 
successAuditEvent
ÄÄ 
=
ÄÄ 

AuditEvent
ÄÄ  *
.
ÄÄ* +
Create
ÄÄ+ 1
(
ÄÄ1 2
AuditEventType
ÅÅ 
.
ÅÅ 
PaymentProcessed
ÅÅ +
,
ÅÅ+ ,
nameof
ÇÇ 
(
ÇÇ 
Payment
ÇÇ 
)
ÇÇ 
,
ÇÇ 
payment
ÉÉ 
.
ÉÉ 
Id
ÉÉ 
,
ÉÉ 
command
ÑÑ 
.
ÑÑ 
ProcessedBy
ÑÑ 
.
ÑÑ  
Value
ÑÑ  %
,
ÑÑ% &
System
ÖÖ 
.
ÖÖ 
Text
ÖÖ 
.
ÖÖ 
Json
ÖÖ 
.
ÖÖ 
JsonSerializer
ÖÖ +
.
ÖÖ+ ,
	Serialize
ÖÖ, 5
(
ÖÖ5 6
new
ÖÖ6 9
{
ÖÖ: ;
Action
ÜÜ 
=
ÜÜ 
$str
ÜÜ "
,
ÜÜ" #
Success
áá 
=
áá 
true
áá 
,
áá 

TipsAmount
àà 
=
àà 
command
àà $
.
àà$ %

TipsAmount
àà% /
,
àà/ 0
AuthorizationCode
ââ !
=
ââ" #
gatewayResult
ââ$ 1
.
ââ1 2
AuthorizationCode
ââ2 C
}
ää 
)
ää 
,
ää 
$"
ãã 
$str
ãã *
{
ãã* +
command
ãã+ 2
.
ãã2 3

TipsAmount
ãã3 =
}
ãã= >
"
ãã> ?
,
ãã? @
correlationId
åå 
:
åå 
Guid
åå 
.
åå  
NewGuid
åå  '
(
åå' (
)
åå( )
)
åå) *
;
åå* +
await
éé #
_auditEventRepository
éé #
.
éé# $
AddAsync
éé$ ,
(
éé, -
successAuditEvent
éé- >
,
éé> ?
cancellationToken
éé@ Q
)
ééQ R
;
ééR S
return
êê 
new
êê (
AddTipsToCardPaymentResult
êê -
{
ëë 	
Success
íí 
=
íí 
true
íí 
,
íí 
AuthorizationCode
ìì 
=
ìì 
gatewayResult
ìì  -
.
ìì- .
AuthorizationCode
ìì. ?
}
îî 	
;
îî	 

}
ïï 
}ññ Ô+
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AddPayoutCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class #
AddPayoutCommandHandler $
:% &
ICommandHandler' 6
<6 7
AddPayoutCommand7 G
,G H
AddPayoutResultI X
>X Y
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
#
AddPayoutCommandHandler "
(" #"
ICashSessionRepository !
cashSessionRepository 4
,4 5!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
AddPayoutResult %
>% &
HandleAsync' 2
(2 3
AddPayoutCommand3 C
commandD K
,K L
CancellationTokenM ^
cancellationToken_ p
=q r
defaults z
)z {
{ 
var 
cashSession 
= 
await "
_cashSessionRepository  6
.6 7
GetByIdAsync7 C
(C D
commandD K
.K L
CashSessionIdL Y
,Y Z
cancellationToken[ l
)l m
;m n
if 

( 
cashSession 
== 
null 
)  
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI V
{V W
commandW ^
.^ _
CashSessionId_ l
}l m
$strm x
"x y
)y z
;z {
} 	
var"" 
payout"" 
="" 
Payout"" 
."" 
Create"" "
(""" #
command## 
.## 
CashSessionId## !
,##! "
command$$ 
.$$ 
Amount$$ 
,$$ 
command%% 
.%% 
ProcessedBy%% 
,%%  
command&& 
.&& 
Reason&& 
)&& 
;&& 
cashSession)) 
.)) 
	AddPayout)) 
()) 
payout)) $
)))$ %
;))% &
await,, "
_cashSessionRepository,, $
.,,$ %
UpdateAsync,,% 0
(,,0 1
cashSession,,1 <
,,,< =
cancellationToken,,> O
),,O P
;,,P Q
var// 
correlationId// 
=// 
Guid//  
.//  !
NewGuid//! (
(//( )
)//) *
;//* +
var00 

auditEvent00 
=00 

AuditEvent00 #
.00# $
Create00$ *
(00* +
AuditEventType11 
.11 
Modified11 #
,11# $
nameof22 
(22 
CashSession22 
)22 
,22  
cashSession33 
.33 
Id33 
,33 
command44 
.44 
ProcessedBy44 
.44  
Value44  %
,44% &
System55 
.55 
Text55 
.55 
Json55 
.55 
JsonSerializer55 +
.55+ ,
	Serialize55, 5
(555 6
new556 9
{66 
Action77 
=77 
$str77 &
,77& '
PayoutId88 
=88 
payout88 !
.88! "
Id88" $
,88$ %
Amount99 
=99 
payout99 
.99  
Amount99  &
.99& '
Amount99' -
,99- .
Reason:: 
=:: 
payout:: 
.::  
Reason::  &
};; 
);; 
,;; 
$"<< 
$str<< 
{<< 
payout<< 
.<<  
Amount<<  &
}<<& '
$str<<' G
{<<G H
payout<<H N
.<<N O
Reason<<O U
??<<V X
$str<<Y ^
}<<^ _
"<<_ `
,<<` a
correlationId== 
:== 
correlationId== (
)==( )
;==) *
await?? !
_auditEventRepository?? #
.??# $
AddAsync??$ ,
(??, -

auditEvent??- 7
,??7 8
cancellationToken??9 J
)??J K
;??K L
returnAA 
newAA 
AddPayoutResultAA "
{BB 	
PayoutIdCC 
=CC 
payoutCC 
.CC 
IdCC  
,CC  !
CashSessionIdDD 
=DD 
cashSessionDD '
.DD' (
IdDD( *
,DD* +
AmountEE 
=EE 
payoutEE 
.EE 
AmountEE "
,EE" #
UpdatedExpectedCashFF 
=FF  !
cashSessionFF" -
.FF- .
ExpectedCashFF. :
}GG 	
;GG	 

}HH 
}II ßW
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AddOrderLineCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class &
AddOrderLineCommandHandler '
:( )
ICommandHandler* 9
<9 :
AddOrderLineCommand: M
,M N
AddOrderLineResultO a
>a b
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
&
AddOrderLineCommandHandler %
(% &
ITicketRepository 
ticketRepository *
,* +
IMenuRepository 
menuRepository &
,& '!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_menuRepository 
= 
menuRepository (
;( )!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
AddOrderLineResult (
>( )
HandleAsync* 5
(5 6
AddOrderLineCommand6 I
commandJ Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
{ 
var 
ticket 
= 
await 
_ticketRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
TicketIdB J
,J K
cancellationTokenL ]
)] ^
;^ _
if 

( 
ticket 
== 
null 
) 
{   	
throw!! 
new!! 
Domain!! 
.!! 

Exceptions!! '
.!!' (*
BusinessRuleViolationException!!( F
(!!F G
$"!!G I
$str!!I P
{!!P Q
command!!Q X
.!!X Y
TicketId!!Y a
}!!a b
$str!!b m
"!!m n
)!!n o
;!!o p
}"" 	
var%% 
	orderLine%% 
=%% 
	OrderLine%% !
.%%! "
Create%%" (
(%%( )
command&& 
.&& 
TicketId&& 
,&& 
command'' 
.'' 

MenuItemId'' 
,'' 
command(( 
.(( 
MenuItemName((  
,((  !
command)) 
.)) 
Quantity)) 
,)) 
new** 
Domain** 
.** 
ValueObjects** #
.**# $
Money**$ )
(**) *
command*** 1
.**1 2
	UnitPrice**2 ;
.**; <
Amount**< B
,**B C
command**D K
.**K L
	UnitPrice**L U
.**U V
Currency**V ^
)**^ _
,**_ `
command++ 
.++ 
TaxRate++ 
,++ 
command,, 
.,, 
CategoryName,,  
,,,  !
command-- 
.-- 
	GroupName-- 
)-- 
;-- 
var22 
menuItem22 
=22 
await22 
_menuRepository22 ,
.22, -
GetByIdAsync22- 9
(229 :
command22: A
.22A B

MenuItemId22B L
,22L M
cancellationToken22N _
)22_ `
;22` a
if33 

(33 
menuItem33 
!=33 
null33 
)33 
{44 	
if55 
(55 
menuItem55 
.55 
PrinterGroupId55 '
.55' (
HasValue55( 0
)550 1
{66 
	orderLine77 
.77 
SetPrinterGroup77 )
(77) *
menuItem77* 2
.772 3
PrinterGroupId773 A
)77A B
;77B C
}88 
else99 
if99 
(99 
menuItem99 
.99 
Group99 #
?99# $
.99$ %
PrinterGroupId99% 3
.993 4
HasValue994 <
==99= ?
true99@ D
)99D E
{:: 
	orderLine;; 
.;; 
SetPrinterGroup;; *
(;;* +
menuItem;;+ 3
.;;3 4
Group;;4 9
.;;9 :
PrinterGroupId;;: H
);;H I
;;;I J
}<< 
else== 
if== 
(== 
menuItem== 
.== 
Category== &
?==& '
.==' (
PrinterGroupId==( 6
.==6 7
HasValue==7 ?
====@ B
true==C G
)==G H
{>> 
	orderLine?? 
.?? 
SetPrinterGroup?? *
(??* +
menuItem??+ 3
.??3 4
Category??4 <
.??< =
PrinterGroupId??= K
)??K L
;??L M
}@@ 
}AA 	
foreachDD 
(DD 
varDD 
modDD 
inDD 
commandDD #
.DD# $
	ModifiersDD$ -
)DD- .
{EE 	
varFF 
orderLineModifierFF !
=FF" #
OrderLineModifierFF$ 5
.FF5 6
CreateFF6 <
(FF< =
orderLineIdGG 
:GG 
	orderLineGG &
.GG& '
IdGG' )
,GG) *

modifierIdHH 
:HH 
modHH 
.HH  
IdHH  "
,HH" #
nameII 
:II 
modII 
.II 
NameII 
,II 
modifierTypeJJ 
:JJ 
modJJ !
.JJ! "
ModifierTypeJJ" .
,JJ. /
	itemCountKK 
:KK 
$numKK 
,KK 
	unitPriceLL 
:LL 
newLL 
DomainLL %
.LL% &
ValueObjectsLL& 2
.LL2 3
MoneyLL3 8
(LL8 9
modLL9 <
.LL< =
	BasePriceLL= F
.LLF G
AmountLLG M
,LLM N
modLLO R
.LLR S
	BasePriceLLS \
.LL\ ]
CurrencyLL] e
)LLe f
,LLf g
	basePriceMM 
:MM 
newMM 
DomainMM %
.MM% &
ValueObjectsMM& 2
.MM2 3
MoneyMM3 8
(MM8 9
modMM9 <
.MM< =
	BasePriceMM= F
.MMF G
AmountMMG M
,MMM N
modMMO R
.MMR S
	BasePriceMMS \
.MM\ ]
CurrencyMM] e
)MMe f
,MMf g
taxRateNN 
:NN 
modNN 
.NN 
TaxRateNN $
,NN$ %
modifierGroupIdOO 
:OO  
modOO! $
.OO$ %
ModifierGroupIdOO% 4
,OO4 5 
shouldPrintToKitchenPP $
:PP$ %
modPP& )
.PP) * 
ShouldPrintToKitchenPP* >
)QQ 
;QQ 
	orderLineRR 
.RR 
AddModifierRR !
(RR! "
orderLineModifierRR" 3
)RR3 4
;RR4 5
}SS 	
ticketVV 
.VV 
AddOrderLineVV 
(VV 
	orderLineVV %
)VV% &
;VV& '
awaitYY 
_ticketRepositoryYY 
.YY  
UpdateAsyncYY  +
(YY+ ,
ticketYY, 2
,YY2 3
cancellationTokenYY4 E
)YYE F
;YYF G
var\\ 
userId\\ 
=\\ 
command\\ 
.\\ 
AddedBy\\ $
?\\$ %
.\\% &
Value\\& +
??\\, .
Guid\\/ 3
.\\3 4
Empty\\4 9
;\\9 :
var]] 
isMisc]] 
=]] 
(]] 
command]] 
.]] 
CategoryName]] *
?]]* +
.]]+ ,
Contains]], 4
(]]4 5
$str]]5 ;
,]]; <
StringComparison]]= M
.]]M N
OrdinalIgnoreCase]]N _
)]]_ `
==]]a c
true]]d h
)]]h i
||]]j l
(^^ 
command^^ 
.^^ 
MenuItemName^^ *
.^^* +
Contains^^+ 3
(^^3 4
$str^^4 :
,^^: ;
StringComparison^^< L
.^^L M
OrdinalIgnoreCase^^M ^
)^^^ _
)^^_ `
;^^` a
var`` 
action`` 
=`` 
isMisc`` 
?`` 
$str`` /
:``0 1
$str``2 >
;``> ?
varaa 
detailsaa 
=aa 
isMiscaa 
?aa 
$"aa !
$straa! 3
{aa3 4
commandaa4 ;
.aa; <
MenuItemNameaa< H
}aaH I
$straaI T
{aaT U
commandaaU \
.aa\ ]
	UnitPriceaa] f
}aaf g
$straag x
{aax y
ticketaay 
.	aa Ä
TicketNumber
aaÄ å
}
aaå ç
"
aaç é
:bb 
$"bb !
$strbb! <
{bb< =
ticketbb= C
.bbC D
TicketNumberbbD P
}bbP Q
"bbQ R
;bbR S
vardd 
correlationIddd 
=dd 
Guiddd  
.dd  !
NewGuiddd! (
(dd( )
)dd) *
;dd* +
varee 

auditEventee 
=ee 

AuditEventee #
.ee# $
Createee$ *
(ee* +
AuditEventTypeff 
.ff 
Modifiedff #
,ff# $
nameofgg 
(gg 
Ticketgg 
)gg 
,gg 
tickethh 
.hh 
Idhh 
,hh 
userIdii 
,ii 
Systemjj 
.jj 
Textjj 
.jj 
Jsonjj 
.jj 
JsonSerializerjj +
.jj+ ,
	Serializejj, 5
(jj5 6
newjj6 9
{jj: ;
OrderLineIdjj< G
=jjH I
	orderLinejjJ S
.jjS T
IdjjT V
,jjV W
ActionjjX ^
=jj_ `
actionjja g
,jjg h
IsMiscjji o
=jjp q
isMiscjjr x
}jjy z
)jjz {
,jj{ |
detailskk 
,kk 
correlationIdll 
:ll 
correlationIdll (
)ll( )
;ll) *
awaitnn !
_auditEventRepositorynn #
.nn# $
AddAsyncnn$ ,
(nn, -

auditEventnn- 7
,nn7 8
cancellationTokennn9 J
)nnJ K
;nnK L
returnpp 
newpp 
AddOrderLineResultpp %
{qq 	
OrderLineIdrr 
=rr 
	orderLinerr #
.rr# $
Idrr$ &
}ss 	
;ss	 

}tt 
}uu ·D
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AddOrderLineComboCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class +
AddOrderLineComboCommandHandler ,
:- .
ICommandHandler/ >
<> ?$
AddOrderLineComboCommand? W
>W X
{ 
private 
readonly 
ITicketRepository &
_ticketRepository' 8
;8 9
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
private 
readonly 
PriceCalculator $
_priceCalculator% 5
;5 6
public 
+
AddOrderLineComboCommandHandler *
(* +
ITicketRepository 
ticketRepository *
,* +
IMenuRepository 
menuRepository &
,& '!
IAuditEventRepository  
auditEventRepository 2
,2 3
PriceCalculator 
priceCalculator '
)' (
{ 
_ticketRepository 
= 
ticketRepository ,
;, -
_menuRepository 
= 
menuRepository (
;( )!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
_priceCalculator   
=   
priceCalculator   *
;  * +
}!! 
public## 

async## 
Task## 
HandleAsync## !
(##! "$
AddOrderLineComboCommand##" :
command##; B
,##B C
CancellationToken##D U
cancellationToken##V g
=##h i
default##j q
)##q r
{$$ 
var&& 
ticket&& 
=&& 
await&& 
_ticketRepository&& ,
.&&, -
GetByIdAsync&&- 9
(&&9 :
command&&: A
.&&A B
TicketId&&B J
,&&J K
cancellationToken&&L ]
)&&] ^
??'' 
throw'' 
new'' !
NotFoundException''" 3
(''3 4
$"''4 6
$str''6 =
{''= >
command''> E
.''E F
TicketId''F N
}''N O
$str''O Z
"''Z [
)''[ \
;''\ ]
var)) 
	orderLine)) 
=)) 
ticket)) 
.)) 

OrderLines)) )
.))) *
FirstOrDefault))* 8
())8 9
ol))9 ;
=>))< >
ol))? A
.))A B
Id))B D
==))E G
command))H O
.))O P
OrderLineId))P [
)))[ \
??** 
throw**  
new**! $
NotFoundException**% 6
(**6 7
$"**7 9
$str**9 C
{**C D
command**D K
.**K L
OrderLineId**L W
}**W X
$str**X c
"**c d
)**d e
;**e f
var-- 
menuItem-- 
=-- 
await-- 
_menuRepository-- ,
.--, -
GetByIdAsync--- 9
(--9 :
	orderLine--: C
.--C D

MenuItemId--D N
,--N O
cancellationToken--P a
)--a b
??.. 
throw.. 
new..  #
NotFoundException..$ 5
(..5 6
$"..6 8
$str..8 A
{..A B
	orderLine..B K
...K L

MenuItemId..L V
}..V W
$str..W b
"..b c
)..c d
;..d e
if00 

(00 
!00 
menuItem00 
.00 
ComboDefinitionId00 '
.00' (
HasValue00( 0
)000 1
{11 	
throw22 
new22 *
BusinessRuleViolationException22 4
(224 5
$"225 7
$str227 @
{22@ A
menuItem22A I
.22I J
Name22J N
}22N O
$str22O e
"22e f
)22f g
;22g h
}33 	
var66 
combo66 
=66 
await66 
_menuRepository66 )
.66) *'
GetComboDefinitionByIdAsync66* E
(66E F
menuItem66F N
.66N O
ComboDefinitionId66O `
.66` a
Value66a f
,66f g
cancellationToken66h y
)66y z
??77 
throw77 
new77  
NotFoundException77! 2
(772 3
$"773 5
$str775 E
{77E F
menuItem77F N
.77N O
ComboDefinitionId77O `
.77` a
Value77a f
}77f g
$str77g r
"77r s
)77s t
;77t u
foreach:: 
(:: 
var:: 
	selection:: 
in:: !
command::" )
.::) *

Selections::* 4
)::4 5
{;; 	
var== 
group== 
=== 
combo== 
.== 
Groups== $
.==$ %
FirstOrDefault==% 3
(==3 4
g==4 5
=>==6 8
g==9 :
.==: ;
Id==; =
====> @
	selection==A J
.==J K
ComboGroupId==K W
)==W X
;==X Y
if>> 
(>> 
group>> 
==>> 
null>> 
)>> 
{?? 
throw@@ 
new@@ *
BusinessRuleViolationException@@ 8
(@@8 9
$"@@9 ;
$str@@; G
{@@G H
	selection@@H Q
.@@Q R
ComboGroupId@@R ^
}@@^ _
$str@@_ y
{@@y z
combo@@z 
.	@@ Ä
Name
@@Ä Ñ
}
@@Ñ Ö
$str
@@Ö Ü
"
@@Ü á
)
@@á à
;
@@à â
}AA 
varDD 
	groupItemDD 
=DD 
groupDD !
.DD! "
ItemsDD" '
.DD' (
FirstOrDefaultDD( 6
(DD6 7
iDD7 8
=>DD9 ;
iDD< =
.DD= >
IdDD> @
==DDA C
	selectionDDD M
.DDM N
ComboGroupItemIdDDN ^
)DD^ _
;DD_ `
ifEE 
(EE 
	groupItemEE 
==EE 
nullEE !
)EE! "
{FF 
throwGG 
newGG *
BusinessRuleViolationExceptionGG 8
(GG8 9
$"GG9 ;
$strGG; @
{GG@ A
	selectionGGA J
.GGJ K
ComboGroupItemIdGGK [
}GG[ \
$strGG\ p
{GGp q
groupGGq v
.GGv w
NameGGw {
}GG{ |
$strGG| }
"GG} ~
)GG~ 
;	GG Ä
}HH 
varKK 
selectionItemKK 
=KK 
awaitKK  %
_menuRepositoryKK& 5
.KK5 6
GetByIdAsyncKK6 B
(KKB C
	groupItemKKC L
.KKL M

MenuItemIdKKM W
,KKW X
cancellationTokenKKY j
)KKj k
??LL  "
throwLL# (
newLL) ,
NotFoundExceptionLL- >
(LL> ?
$"LL? A
$strLLA J
{LLJ K
	groupItemLLK T
.LLT U

MenuItemIdLLU _
}LL_ `
$strLL` k
"LLk l
)LLl m
;LLm n
varSS 
	unitPriceSS 
=SS 
_priceCalculatorSS ,
.SS, -#
CalculateComboItemPriceSS- D
(SSD E
selectionItemSSE R
.SSR S
PriceSSS X
,SSX Y
	groupItemSSZ c
.SSc d
UpchargeSSd l
)SSl m
;SSm n
varVV 
modifierVV 
=VV 
OrderLineModifierVV ,
.VV, -
CreateVV- 3
(VV3 4
	orderLineWW 
.WW 
IdWW 
,WW 
nullXX 
,XX 
selectionItemYY 
.YY 
NameYY "
,YY" #
ModifierTypeZZ 
.ZZ 
InfoOnlyZZ %
,ZZ% &
	selection[[ 
.[[ 
Quantity[[ "
,[[" #
	unitPrice\\ 
,\\ 
	unitPrice]] 
)^^ 
;^^ 
	orderLine`` 
.`` 
AddModifier`` !
(``! "
modifier``" *
)``* +
;``+ ,
}aa 	
ticketdd 
.dd 
CalculateTotalsdd 
(dd 
)dd  
;dd  !
awaitee 
_ticketRepositoryee 
.ee  
UpdateAsyncee  +
(ee+ ,
ticketee, 2
,ee2 3
cancellationTokenee4 E
)eeE F
;eeF G
}ff 
}gg ‹,
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AddDrawerBleedCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class (
AddDrawerBleedCommandHandler )
:* +
ICommandHandler, ;
<; <!
AddDrawerBleedCommand< Q
,Q R 
AddDrawerBleedResultS g
>g h
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
(
AddDrawerBleedCommandHandler '
(' ("
ICashSessionRepository !
cashSessionRepository 4
,4 5!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
<  
AddDrawerBleedResult *
>* +
HandleAsync, 7
(7 8!
AddDrawerBleedCommand8 M
commandN U
,U V
CancellationTokenW h
cancellationTokeni z
={ |
default	} Ñ
)
Ñ Ö
{ 
var 
cashSession 
= 
await "
_cashSessionRepository  6
.6 7
GetByIdAsync7 C
(C D
commandD K
.K L
CashSessionIdL Y
,Y Z
cancellationToken[ l
)l m
;m n
if 

( 
cashSession 
== 
null 
)  
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI V
{V W
commandW ^
.^ _
CashSessionId_ l
}l m
$strm x
"x y
)y z
;z {
} 	
var"" 
drawerBleed"" 
="" 
DrawerBleed"" %
.""% &
Create""& ,
("", -
command## 
.## 
CashSessionId## !
,##! "
command$$ 
.$$ 
Amount$$ 
,$$ 
command%% 
.%% 
ProcessedBy%% 
,%%  
command&& 
.&& 
Reason&& 
)&& 
;&& 
cashSession)) 
.)) 
AddDrawerBleed)) "
())" #
drawerBleed))# .
))). /
;))/ 0
await,, "
_cashSessionRepository,, $
.,,$ %
UpdateAsync,,% 0
(,,0 1
cashSession,,1 <
,,,< =
cancellationToken,,> O
),,O P
;,,P Q
var// 
correlationId// 
=// 
Guid//  
.//  !
NewGuid//! (
(//( )
)//) *
;//* +
var00 

auditEvent00 
=00 

AuditEvent00 #
.00# $
Create00$ *
(00* +
AuditEventType11 
.11 
Modified11 #
,11# $
nameof22 
(22 
CashSession22 
)22 
,22  
cashSession33 
.33 
Id33 
,33 
command44 
.44 
ProcessedBy44 
.44  
Value44  %
,44% &
System55 
.55 
Text55 
.55 
Json55 
.55 
JsonSerializer55 +
.55+ ,
	Serialize55, 5
(555 6
new556 9
{66 
Action77 
=77 
$str77 +
,77+ ,
DrawerBleedId88 
=88 
drawerBleed88  +
.88+ ,
Id88, .
,88. /
Amount99 
=99 
drawerBleed99 $
.99$ %
Amount99% +
.99+ ,
Amount99, 2
,992 3
Reason:: 
=:: 
drawerBleed:: $
.::$ %
Reason::% +
};; 
);; 
,;; 
$"<< 
$str<< 
{<< 
drawerBleed<< *
.<<* +
Amount<<+ 1
}<<1 2
$str<<2 R
{<<R S
drawerBleed<<S ^
.<<^ _
Reason<<_ e
??<<f h
$str<<i n
}<<n o
"<<o p
,<<p q
correlationId== 
:== 
correlationId== (
)==( )
;==) *
await?? !
_auditEventRepository?? #
.??# $
AddAsync??$ ,
(??, -

auditEvent??- 7
,??7 8
cancellationToken??9 J
)??J K
;??K L
returnAA 
newAA  
AddDrawerBleedResultAA '
{BB 	
DrawerBleedIdCC 
=CC 
drawerBleedCC '
.CC' (
IdCC( *
,CC* +
CashSessionIdDD 
=DD 
cashSessionDD '
.DD' (
IdDD( *
,DD* +
AmountEE 
=EE 
drawerBleedEE  
.EE  !
AmountEE! '
,EE' (
UpdatedExpectedCashFF 
=FF  !
cashSessionFF" -
.FF- .
ExpectedCashFF. :
}GG 	
;GG	 

}HH 
}II ö,
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Services\AddCashDropCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Services '
;' (
public 
class %
AddCashDropCommandHandler &
:' (
ICommandHandler) 8
<8 9
AddCashDropCommand9 K
,K L
AddCashDropResultM ^
>^ _
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly !
IAuditEventRepository *!
_auditEventRepository+ @
;@ A
public 
%
AddCashDropCommandHandler $
($ %"
ICashSessionRepository !
cashSessionRepository 4
,4 5!
IAuditEventRepository  
auditEventRepository 2
)2 3
{ "
_cashSessionRepository 
=  !
cashSessionRepository! 6
;6 7!
_auditEventRepository 
=  
auditEventRepository  4
;4 5
} 
public 

async 
Task 
< 
AddCashDropResult '
>' (
HandleAsync) 4
(4 5
AddCashDropCommand5 G
commandH O
,O P
CancellationTokenQ b
cancellationTokenc t
=u v
defaultw ~
)~ 
{ 
var 
cashSession 
= 
await "
_cashSessionRepository  6
.6 7
GetByIdAsync7 C
(C D
commandD K
.K L
CashSessionIdL Y
,Y Z
cancellationToken[ l
)l m
;m n
if 

( 
cashSession 
== 
null 
)  
{ 	
throw 
new 
Domain 
. 

Exceptions '
.' (*
BusinessRuleViolationException( F
(F G
$"G I
$strI V
{V W
commandW ^
.^ _
CashSessionId_ l
}l m
$strm x
"x y
)y z
;z {
} 	
var"" 
cashDrop"" 
="" 
CashDrop"" 
.""  
Create""  &
(""& '
command## 
.## 
CashSessionId## !
,##! "
command$$ 
.$$ 
Amount$$ 
,$$ 
command%% 
.%% 
ProcessedBy%% 
,%%  
command&& 
.&& 
Reason&& 
)&& 
;&& 
cashSession)) 
.)) 
AddCashDrop)) 
())  
cashDrop))  (
)))( )
;))) *
await,, "
_cashSessionRepository,, $
.,,$ %
UpdateAsync,,% 0
(,,0 1
cashSession,,1 <
,,,< =
cancellationToken,,> O
),,O P
;,,P Q
var// 
correlationId// 
=// 
Guid//  
.//  !
NewGuid//! (
(//( )
)//) *
;//* +
var00 

auditEvent00 
=00 

AuditEvent00 #
.00# $
Create00$ *
(00* +
AuditEventType11 
.11 
Modified11 #
,11# $
nameof22 
(22 
CashSession22 
)22 
,22  
cashSession33 
.33 
Id33 
,33 
command44 
.44 
ProcessedBy44 
.44  
Value44  %
,44% &
System55 
.55 
Text55 
.55 
Json55 
.55 
JsonSerializer55 +
.55+ ,
	Serialize55, 5
(555 6
new556 9
{66 
Action77 
=77 
$str77 (
,77( )

CashDropId88 
=88 
cashDrop88 %
.88% &
Id88& (
,88( )
Amount99 
=99 
cashDrop99 !
.99! "
Amount99" (
.99( )
Amount99) /
,99/ 0
Reason:: 
=:: 
cashDrop:: !
.::! "
Reason::" (
};; 
);; 
,;; 
$"<< 
$str<< 
{<< 
cashDrop<< $
.<<$ %
Amount<<% +
}<<+ ,
$str<<, L
{<<L M
cashDrop<<M U
.<<U V
Reason<<V \
??<<] _
$str<<` e
}<<e f
"<<f g
,<<g h
correlationId== 
:== 
correlationId== (
)==( )
;==) *
await?? !
_auditEventRepository?? #
.??# $
AddAsync??$ ,
(??, -

auditEvent??- 7
,??7 8
cancellationToken??9 J
)??J K
;??K L
returnAA 
newAA 
AddCashDropResultAA $
{BB 	

CashDropIdCC 
=CC 
cashDropCC !
.CC! "
IdCC" $
,CC$ %
CashSessionIdDD 
=DD 
cashSessionDD '
.DD' (
IdDD( *
,DD* +
AmountEE 
=EE 
cashDropEE 
.EE 
AmountEE $
,EE$ %
UpdatedExpectedCashFF 
=FF  !
cashSessionFF" -
.FF- .
ExpectedCashFF. :
}GG 	
;GG	 

}HH 
}II «
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\System\GetSystemBackupsQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
SystemConfig' 3
;3 4
public 
class !
GetSystemBackupsQuery "
{ 
} 
public

 
class

 "
GetSystemBackupsResult

 #
{ 
public 

List 
< 
BackupInfoDto 
> 
Backups &
{' (
get) ,
;, -
}. /
public 
"
GetSystemBackupsResult !
(! "
List" &
<& '
BackupInfoDto' 4
>4 5
backups6 =
)= >
{ 
Backups 
= 
backups 
; 
} 
} ·	
âC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\SystemConfig\GetTerminalConfigQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
SystemConfig' 3
;3 4
public 
class "
GetTerminalConfigQuery #
{ 
public 

string 
TerminalKey 
{ 
get  #
;# $
}% &
public		 
"
GetTerminalConfigQuery		 !
(		! "
string		" (
terminalKey		) 4
)		4 5
{

 
TerminalKey 
= 
terminalKey !
;! "
} 
} 
public 
class #
GetTerminalConfigResult $
{ 
public 

TerminalDto 
Terminal 
{  !
get" %
;% &
}' (
public 
#
GetTerminalConfigResult "
(" #
TerminalDto# .
terminal/ 7
)7 8
{ 
Terminal 
= 
terminal 
; 
} 
} ‘
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\SystemConfig\GetRestaurantConfigQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
SystemConfig' 3
;3 4
public 
class $
GetRestaurantConfigQuery %
;% &
public 
record %
GetRestaurantConfigResult '
(' (&
RestaurantConfigurationDto( B
ConfigurationC P
)P Q
;Q RÁ
äC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\SystemConfig\GetPrinterMappingsQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
SystemConfig' 3
;3 4
public 
record $
GetPrinterMappingsResult &
(& '
List' +
<+ ,
PrinterMappingDto, =
>= >
Mappings? G
)G H
;H I
public		 
class		 #
GetPrinterMappingsQuery		 $
{

 
public 

Guid 

TerminalId 
{ 
get  
;  !
}" #
public 
#
GetPrinterMappingsQuery "
(" #
Guid# '

terminalId( 2
)2 3
{ 

TerminalId 
= 

terminalId 
;  
} 
} Á
àC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\SystemConfig\GetPrinterGroupsQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
SystemConfig' 3
;3 4
public 
record "
GetPrinterGroupsResult $
($ %
List% )
<) *
PrinterGroupDto* 9
>9 :
Groups; A
)A B
;B C
public		 
class		 !
GetPrinterGroupsQuery		 "
{

 
public 
!
GetPrinterGroupsQuery  
(  !
)! "
{ 
} 
} ù
ÖC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\SystemConfig\GetCardConfigQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
SystemConfig' 3
;3 4
public 
record 
GetCardConfigResult !
(! "
CardConfigDto" /
Config0 6
)6 7
;7 8
public 
class 
GetCardConfigQuery 
{		 
public

 

Guid

 

TerminalId

 
{

 
get

  
;

  !
}

" #
public 

GetCardConfigQuery 
( 
Guid "

terminalId# -
)- .
{ 

TerminalId 
= 

terminalId 
;  
} 
} Ô
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetTipReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record 
GetTipReportQuery 
(  
DateTime  (
	StartDate) 2
,2 3
DateTime4 <
EndDate= D
,D E
GuidF J
?J K
UserIdFilterL X
=Y Z
null[ _
)_ `
;` aé
éC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetServerProductivityReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record ,
 GetServerProductivityReportQuery .
(. /
DateTime/ 7
	StartDate8 A
,A B
DateTimeC K
EndDateL S
,S T
GuidU Y
?Y Z
UserIdFilter[ g
=h i
nullj n
)n o
;o pÖ

ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetSalesSummaryQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class  
GetSalesSummaryQuery !
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
}% &
public		 

DateTime		 
EndDate		 
{		 
get		 !
;		! "
}		# $
public

 

bool

 
IncludeGroups

 
{

 
get

  #
;

# $
}

% &
public 
 
GetSalesSummaryQuery 
(  
DateTime  (
	startDate) 2
,2 3
DateTime4 <
endDate= D
,D E
boolF J
includeGroupsK X
=Y Z
true[ _
)_ `
{ 
	StartDate 
= 
	startDate 
; 
EndDate 
= 
endDate 
; 
IncludeGroups 
= 
includeGroups %
;% &
} 
} ‡
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetSalesDetailQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record 
GetSalesDetailQuery !
(! "
DateTime" *
	StartDate+ 4
,4 5
DateTime6 >
EndDate? F
,F G
stringH N
?N O
CategoryFilterP ^
=_ `
nulla e
,e f
stringg m
?m n
GroupFiltero z
={ |
null	} Å
,
Å Ç
string
É â
?
â ä

ItemFilter
ã ï
=
ñ ó
null
ò ú
)
ú ù
;
ù û’
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetSalesBalanceQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class  
GetSalesBalanceQuery !
{ 
public		 

DateTime		 
	StartDate		 
{		 
get		  #
;		# $
}		% &
public

 

DateTime

 
EndDate

 
{

 
get

 !
;

! "
}

# $
public 
 
GetSalesBalanceQuery 
(  
DateTime  (
	startDate) 2
,2 3
DateTime4 <
endDate= D
)D E
{ 
	StartDate 
= 
	startDate 
; 
EndDate 
= 
endDate 
; 
} 
} Ω

àC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetProductivityReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
class &
GetProductivityReportQuery '
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
}% &
public 

DateTime 
EndDate 
{ 
get !
;! "
}# $
public		 

Guid		 
?		 
UserId		 
{		 
get		 
;		 
}		  
public 
&
GetProductivityReportQuery %
(% &
DateTime& .
	startDate/ 8
,8 9
DateTime: B
endDateC J
,J K
GuidL P
?P Q
userIdR X
=Y Z
null[ _
)_ `
{ 
	StartDate 
= 
	startDate 
; 
EndDate 
= 
endDate 
; 
UserId 
= 
userId 
; 
} 
} ¸
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetPaymentReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record !
GetPaymentReportQuery #
(# $
DateTime$ ,
	StartDate- 6
,6 7
DateTime8 @
EndDateA H
,H I
stringJ P
?P Q
TerminalFilterR `
=a b
nullc g
)g h
;h i˘
ÖC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetMenuUsageReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record #
GetMenuUsageReportQuery %
(% &
DateTime& .
	StartDate/ 8
,8 9
DateTime: B
EndDateC J
,J K
stringL R
?R S
CategoryFilterT b
=c d
nulle i
,i j
stringk q
?q r
OrderTypeFilter	s Ç
=
É Ñ
null
Ö â
)
â ä
;
ä ãˆ
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetLaborReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
class 
GetLaborReportQuery  
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
}% &
public 

DateTime 
EndDate 
{ 
get !
;! "
}# $
public

 

GetLaborReportQuery

 
(

 
DateTime

 '
	startDate

( 1
,

1 2
DateTime

3 ;
endDate

< C
)

C D
{ 
	StartDate 
= 
	startDate 
; 
EndDate 
= 
endDate 
; 
} 
} Ù
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetJournalReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
class !
GetJournalReportQuery "
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
}% &
public 

DateTime 
EndDate 
{ 
get !
;! "
}# $
public		 

string		 
?		 

EntityType		 
{		 
get		  #
;		# $
}		% &
public

 

Guid

 
?

 
UserId

 
{

 
get

 
;

 
}

  
public 
!
GetJournalReportQuery  
(  !
DateTime! )
	startDate* 3
,3 4
DateTime5 =
endDate> E
,E F
stringG M
?M N

entityTypeO Y
=Z [
null\ `
,` a
Guidb f
?f g
userIdh n
=o p
nullq u
)u v
{ 
	StartDate 
= 
	startDate 
; 
EndDate 
= 
endDate 
; 

EntityType 
= 

entityType 
;  
UserId 
= 
userId 
; 
} 
} Ñ
áC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetHourlyLaborReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record %
GetHourlyLaborReportQuery '
(' (
DateTime( 0
	StartDate1 :
,: ;
DateTime< D
EndDateE L
,L M
GuidN R
?R S
EmployeeIdFilterT d
=e f
nullg k
)k l
;l mÖ
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetExceptionsReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
class $
GetExceptionsReportQuery %
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
}% &
public		 

DateTime		 
EndDate		 
{		 
get		 !
;		! "
}		# $
public 
$
GetExceptionsReportQuery #
(# $
DateTime$ ,
	startDate- 6
,6 7
DateTime8 @
endDateA H
)H I
{ 
	StartDate 
= 
	startDate 
; 
EndDate 
= 
endDate 
; 
} 
} ˇ
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetDeliveryReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
class "
GetDeliveryReportQuery #
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
}% &
public 

DateTime 
EndDate 
{ 
get !
;! "
}# $
public

 
"
GetDeliveryReportQuery

 !
(

! "
DateTime

" *
	startDate

+ 4
,

4 5
DateTime

6 >
endDate

? F
)

F G
{ 
	StartDate 
= 
	startDate 
; 
EndDate 
= 
endDate 
; 
} 
} Å
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetCreditCardReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record $
GetCreditCardReportQuery &
(& '
DateTime' /
	StartDate0 9
,9 :
DateTime; C
EndDateD K
,K L
stringM S
?S T
CardTypeFilterU c
=d e
nullf j
,j k
stringl r
?r s"
TransactionTypeFilter	t â
=
ä ã
null
å ê
)
ê ë
;
ë í¯
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetCashOutReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record !
GetCashOutReportQuery #
(# $
DateTime$ ,
	StartDate- 6
,6 7
DateTime8 @
EndDateA H
,H I
GuidJ N
?N O
UserIdFilterP \
=] ^
null_ c
)c d
;d e˛
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\Reports\GetAttendanceReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
.& '
Reports' .
;. /
public 
record $
GetAttendanceReportQuery &
(& '
DateTime' /
	StartDate0 9
,9 :
DateTime; C
EndDateD K
,K L
GuidM Q
?Q R
UserIdFilterS _
=` a
nullb f
)f g
;g h’
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetUsersQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetUsersQuery 
{ 
} —
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetTicketQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetTicketQuery 
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
}		 
public 
class "
GetTicketByNumberQuery #
{ 
public 

int 
TicketNumber 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 
class 
GetOpenTicketsQuery  
{ 
} Û
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetTableQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetTableQuery 
{		 
public

 

Guid

 
TableId

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
} 
public 
class 
GetTableResult 
{ 
public 

TableDto 
? 
Table 
{ 
get  
;  !
set" %
;% &
}' (
} ©
vC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetTableMapQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetTableMapQuery 
: 
IRequest  (
<( )
GetTableMapResult) :
>: ;
{ 
public 

Guid 
? 
FloorId 
{ 
get 
; 
set  #
;# $
}% &
}		 
public 
class 
GetTableMapResult 
{ 
public 

IEnumerable 
< 
TableDto 
>  
Tables! '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
=6 7
new8 ;
List< @
<@ A
TableDtoA I
>I J
(J K
)K L
;L M
} ñ	
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetShiftReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetShiftReportQuery  
{		 
public

 

Guid

 
ShiftId

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

DateTime 
? 
	StartDate 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
EndDate 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 
class  
GetShiftReportResult !
{ 
public 

ShiftReportDto 
Report  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
} Û
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetShiftQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetShiftQuery 
{		 
public

 

Guid

 
ShiftId

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
} 
public 
class 
GetShiftResult 
{ 
public 

ShiftDto 
? 
Shift 
{ 
get  
;  !
set" %
;% &
}' (
} ã
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetOrderTypeQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetOrderTypeQuery 
{		 
public

 

Guid

 
OrderTypeId

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
} 
public 
class 
GetOrderTypeResult 
{ 
public 

OrderTypeDto 
? 
	OrderType "
{# $
get% (
;( )
set* -
;- .
}/ 0
} ≠
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetMenuItemsQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetMenuItemsQuery 
{ 
public 

Guid 
? 

CategoryId 
{ 
get !
;! "
set# &
;& '
}( )
public		 

bool		 
?		 
IsActive		 
{		 
get		 
;		  
set		! $
;		$ %
}		& '
=		( )
true		* .
;		. /
}

 
public 
class 
MenuItemDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
Price 
{ 
get 
; 
set  #
;# $
}% &
public 

decimal 
TaxRate 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
? 

CategoryId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
CategoryName 
{  !
get" %
;% &
set' *
;* +
}, -
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 

IsBeverage 
{ 
get  
;  !
set" %
;% &
}' (
} ÷
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetDrawerPullReportQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class $
GetDrawerPullReportQuery %
{		 
public

 

Guid

 
CashSessionId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
} 
public 
class %
GetDrawerPullReportResult &
{ 
public 

DrawerPullReportDto 
Report %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
null6 :
!: ;
;; <
} Ô
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetCurrentShiftQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class  
GetCurrentShiftQuery !
{		 
} 
public 
class !
GetCurrentShiftResult "
{ 
public 

ShiftDto 
? 
Shift 
{ 
get  
;  !
set" %
;% &
}' (
} ¶
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetCurrentCashSessionQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class &
GetCurrentCashSessionQuery '
{		 
public

 

Guid

 
UserId

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
} 
public 
class '
GetCurrentCashSessionResult (
{ 
public 

CashSessionDto 
? 
CashSession &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} ó
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetCashSessionQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class 
GetCashSessionQuery  
{		 
public

 

Guid

 
CashSessionId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
} 
public 
class  
GetCashSessionResult !
{ 
public 

CashSessionDto 
? 
CashSession &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} è
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Queries\GetAvailableTablesQuery.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Queries &
;& '
public 
class #
GetAvailableTablesQuery $
{		 
public

 

Guid

 
?

 
FloorId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
} 
public 
class $
GetAvailableTablesResult %
{ 
public 

List 
< 
TableDto 
> 
Tables  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
new1 4
(4 5
)5 6
;6 7
} ¡"
qC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Mapping\TableMapper.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Mapping &
;& '
public 
static 
class 
TableMapper 
{ 
public 

static 
TableDto 
ToDto  
(  !
Table! &
table' ,
), -
{ 
if 

( 
table 
== 
null 
) 
return !
null" &
;& '
return 
new 
TableDto 
{ 	
Id 
= 
table 
. 
Id 
, 
TableNumber 
= 
table 
.  
TableNumber  +
,+ ,
FloorId 
= 
table 
. 
FloorId #
,# $
LayoutId 
= 
table 
. 
LayoutId %
,% &
Capacity 
= 
table 
. 
Capacity %
,% &
X 
= 
table 
. 
X 
, 
Y 
= 
table 
. 
Y 
, 
Width 
= 
table 
. 
Width 
,  
Height 
= 
table 
. 
Height !
,! "
Shape 
= 
table 
. 
Shape 
,  
Status 
= 
table 
. 
Status !
,! "
CurrentTicketId 
= 
table #
.# $
CurrentTicketId$ 3
,3 4
IsActive 
= 
table 
. 
IsActive %
,% &
IsLocked   
=   
table   
.   
Status   #
!=  $ &
TableStatus  ' 2
.  2 3
	Available  3 <
}!! 	
;!!	 

}"" 
public$$ 

static$$ 
List$$ 
<$$ 
TableDto$$ 
>$$  
	ToDtoList$$! *
($$* +
IEnumerable$$+ 6
<$$6 7
Table$$7 <
>$$< =
tables$$> D
)$$D E
{%% 
return&& 
tables&& 
?&& 
.&& 
Select&& 
(&& 
ToDto&& #
)&&# $
.&&$ %
ToList&&% +
(&&+ ,
)&&, -
??&&. 0
new&&1 4
List&&5 9
<&&9 :
TableDto&&: B
>&&B C
(&&C D
)&&D E
;&&E F
}'' 
public)) 

static)) 
TableLayoutDto))  
ToLayoutDto))! ,
()), -
TableLayout))- 8
layout))9 ?
)))? @
{** 
if++ 

(++ 
layout++ 
==++ 
null++ 
)++ 
return++ "
null++# '
;++' (
return-- 
new-- 
TableLayoutDto-- !
{.. 	
Id// 
=// 
layout// 
.// 
Id// 
,// 
Name00 
=00 
layout00 
.00 
Name00 
,00 
FloorId11 
=11 
layout11 
.11 
FloorId11 $
,11$ %
IsDraft22 
=22 
layout22 
.22 
IsDraft22 $
,22$ %
IsActive33 
=33 
layout33 
.33 
IsActive33 &
,33& '
Version44 
=44 
layout44 
.44 
Version44 $
,44$ %
	CreatedAt55 
=55 
layout55 
.55 
	CreatedAt55 (
,55( )
	UpdatedAt66 
=66 
layout66 
.66 
	UpdatedAt66 (
,66( )
Tables77 
=77 
	ToDtoList77 
(77 
layout77 %
.77% &
Tables77& ,
)77, -
}88 	
;88	 

}99 
}:: û
uC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IUserService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IUserService 
{ 
UserDto 
? 
CurrentUser 
{ 
get 
; 
set  #
;# $
}% &
event		 	
EventHandler		
 
<		 
UserDto		 
?		 
>		  
?		  !
UserChanged		" -
;		- .
}

 ”

xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IUserRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IUserRepository  
:! "
IRepository# .
<. /
User/ 3
>3 4
{ 
Task 
< 	
User	 
? 
> 
GetByUsernameAsync "
(" #
string# )
username* 2
,2 3
CancellationToken4 E
cancellationTokenF W
=X Y
defaultZ a
)a b
;b c
Task		 
<		 	
User			 
?		 
>		 
GetByPinAsync		 
(		 
string		 $
encryptedPin		% 1
,		1 2
CancellationToken		3 D
cancellationToken		E V
=		W X
default		Y `
)		` a
;		a b
Task

 
<

 	
bool

	 
>

 
HasUsersInRoleAsync

 "
(

" #
Guid

# '
roleId

( .
,

. /
CancellationToken

0 A
cancellationToken

B S
=

T U
default

V ]
)

] ^
;

^ _
} ï
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ITicketRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ITicketRepository "
{		 
Task 
< 	
Ticket	 
? 
> 
GetByIdAsync 
( 
Guid #
id$ &
,& '
CancellationToken( 9
cancellationToken: K
=L M
defaultN U
)U V
;V W
Task 
< 	
Ticket	 
? 
> "
GetByTicketNumberAsync (
(( )
int) ,
ticketNumber- 9
,9 :
CancellationToken; L
cancellationTokenM ^
=_ `
defaulta h
)h i
;i j
Task 
< 	
IEnumerable	 
< 
Ticket 
> 
> 
GetByShiftIdAsync /
(/ 0
Guid0 4
shiftId5 <
,< =
CancellationToken> O
cancellationTokenP a
=b c
defaultd k
)k l
;l m
Task 
< 	
IEnumerable	 
< 
Ticket 
> 
> 
GetOpenTicketsAsync 1
(1 2
CancellationToken2 C
cancellationTokenD U
=V W
defaultX _
)_ `
;` a
Task!! 
<!! 	
IEnumerable!!	 
<!! 
Ticket!! 
>!! 
>!! '
GetScheduledTicketsDueAsync!! 9
(!!9 :
DateTime!!: B
dueBy!!C H
,!!H I
CancellationToken!!J [
cancellationToken!!\ m
=!!n o
default!!p w
)!!w x
;!!x y
Task&& 
AddAsync&&	 
(&& 
Ticket&& 
ticket&& 
,&&  
CancellationToken&&! 2
cancellationToken&&3 D
=&&E F
default&&G N
)&&N O
;&&O P
Task++ 
UpdateAsync++	 
(++ 
Ticket++ 
ticket++ "
,++" #
CancellationToken++$ 5
cancellationToken++6 G
=++H I
default++J Q
)++Q R
;++R S
Task00 
<00 	
int00	 
>00 $
GetNextTicketNumberAsync00 &
(00& '
CancellationToken00' 8
cancellationToken009 J
=00K L
default00M T
)00T U
;00U V
Task55 
<55 	
ITransaction55	 
>55 !
BeginTransactionAsync55 ,
(55, -
CancellationToken55- >
cancellationToken55? P
=55Q R
default55S Z
)55Z [
;55[ \
}66 
public;; 
	interface;; 
ITransaction;; 
:;; 
IDisposable;;  +
{<< 
Task@@ 
CommitAsync@@	 
(@@ 
CancellationToken@@ &
cancellationToken@@' 8
=@@9 :
default@@; B
)@@B C
;@@C D
TaskEE 
RollbackAsyncEE	 
(EE 
CancellationTokenEE (
cancellationTokenEE) :
=EE; <
defaultEE= D
)EED E
;EEE F
}FF „
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ITicketCreationService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface "
ITicketCreationService '
{ 
Task 
< 	
Guid	 
> %
CreateTicketForTableAsync (
(( )
Guid) -
tableId. 5
,5 6
Guid7 ;
userId< B
)B C
;C D
} •	
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ITerminalRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ITerminalRepository $
{ 
Task		 
<		 	
Terminal			 
?		 
>		 !
GetByTerminalKeyAsync		 )
(		) *
string		* 0
terminalKey		1 <
,		< =
CancellationToken		> O
cancellationToken		P a
=		b c
default		d k
)		k l
;		l m
Task

 
UpdateTerminalAsync

	 
(

 
Terminal

 %
terminal

& .
,

. /
CancellationToken

0 A
cancellationToken

B S
=

T U
default

V ]
)

] ^
;

^ _
Task 
AddTerminalAsync	 
( 
Terminal "
terminal# +
,+ ,
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
;[ \
} ¶
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ITerminalContext.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ITerminalContext !
{ 
string 

?
 
TerminalIdentity 
{ 
get "
;" #
}$ %
Guid 
? 	

TerminalId
 
{ 
get 
; 
} 
void		 
SetTerminalIdentity			 
(		 
string		 #
terminalIdentity		$ 4
,		4 5
Guid		6 :

terminalId		; E
)		E F
;		F G
}

 °
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ITemplateEngine.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ITemplateEngine  
{ 
Task 
< 	
string	 
> 
RenderAsync 
( 
string #
templateContent$ 3
,3 4
object5 ;
model< A
)A B
;B C
bool 
Validate	 
( 
string 
templateContent (
,( )
out* -
string. 4
error5 :
): ;
;; <
} †
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ITableRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 
ITableRepository		 !
{

 
Task 
< 	
Table	 
? 
> 
GetByIdAsync 
( 
Guid "
id# %
,% &
CancellationToken' 8
cancellationToken9 J
=K L
defaultM T
)T U
;U V
Task 
< 	
Table	 
? 
> 
GetByTicketIdAsync #
(# $
Guid$ (
ticketId) 1
,1 2
CancellationToken3 D
cancellationTokenE V
=W X
defaultY `
)` a
;a b
Task 
< 	
Table	 
? 
> !
GetByTableNumberAsync &
(& '
int' *
tableNumber+ 6
,6 7
CancellationToken8 I
cancellationTokenJ [
=\ ]
default^ e
)e f
;f g
Task 
< 	
IEnumerable	 
< 
Table 
> 
> 
GetByFloorIdAsync .
(. /
Guid/ 3
?3 4
floorId5 <
,< =
CancellationToken> O
cancellationTokenP a
=b c
defaultd k
)k l
;l m
Task"" 
<"" 	
IEnumerable""	 
<"" 
Table"" 
>"" 
>"" 
GetByStatusAsync"" -
(""- .
TableStatus"". 9
status"": @
,""@ A
CancellationToken""B S
cancellationToken""T e
=""f g
default""h o
)""o p
;""p q
Task'' 
<'' 	
IEnumerable''	 
<'' 
Table'' 
>'' 
>'' 
GetAvailableAsync'' .
(''. /
CancellationToken''/ @
cancellationToken''A R
=''S T
default''U \
)''\ ]
;''] ^
Task,, 
<,, 	
IEnumerable,,	 
<,, 
Table,, 
>,, 
>,, 
GetActiveAsync,, +
(,,+ ,
CancellationToken,,, =
cancellationToken,,> O
=,,P Q
default,,R Y
),,Y Z
;,,Z [
Task11 
<11 	
IEnumerable11	 
<11 
Table11 
>11 
>11 
GetAllAsync11 (
(11( )
CancellationToken11) :
cancellationToken11; L
=11M N
default11O V
)11V W
;11W X
Task66 
AddAsync66	 
(66 
Table66 
table66 
,66 
CancellationToken66 0
cancellationToken661 B
=66C D
default66E L
)66L M
;66M N
Task;; 
UpdateAsync;;	 
(;; 
Table;; 
table;;  
,;;  !
CancellationToken;;" 3
cancellationToken;;4 E
=;;F G
default;;H O
);;O P
;;;P Q
}<< –
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ITableLayoutRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface "
ITableLayoutRepository '
:( )
IRepository* 5
<5 6
TableLayout6 A
>A B
{ 
Task 
< 	
TableLayoutDto	 
? 
>  
GetLayoutByNameAsync .
(. /
string/ 5
name6 :
,: ;
CancellationToken< M
cancellationTokenN _
=` a
defaultb i
)i j
;j k
Task		 
<		 	
List			 
<		 
TableLayoutDto		 
>		 
>		 "
GetLayoutsByFloorAsync		 5
(		5 6
Guid		6 :
floorId		; B
,		B C
CancellationToken		D U
cancellationToken		V g
=		h i
default		j q
)		q r
;		r s
Task

 
<

 	
TableLayoutDto

	 
?

 
>

 $
GetLayoutWithTablesAsync

 2
(

2 3
Guid

3 7
layoutId

8 @
,

@ A
CancellationToken

B S
cancellationToken

T e
=

f g
default

h o
)

o p
;

p q
Task 
< 	
bool	 
> #
IsLayoutNameUniqueAsync &
(& '
string' -
name. 2
,2 3
Guid4 8
?8 9
	excludeId: C
=D E
nullF J
,J K
CancellationTokenL ]
cancellationToken^ o
=p q
defaultr y
)y z
;z {
} Ÿ
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ISystemService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ISystemService 
{ 
Task 
ShutdownAsync	 
( 
UserId 
initiatedBy )
,) *
CancellationToken+ <
cancellationToken= N
=O P
defaultQ X
)X Y
;Y Z
} ∫
ÖC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ISystemInitializationService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
{ 
public 

	interface (
ISystemInitializationService 1
{ 
Task 
<  
InitializationResult !
>! "!
InitializeSystemAsync# 8
(8 9
)9 :
;: ;
} 
public

 

class

  
InitializationResult

 %
{ 
public 
bool 
	IsSuccess 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Message 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 

TerminalId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
System 
. 
Guid 
? 
TerminalGuid (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
static  
InitializationResult *
Success+ 2
(2 3
string3 9

terminalId: D
,D E
SystemF L
.L M
GuidM Q
terminalGuidR ^
)^ _
=>` b
newc f
(f g
)g h
{i j
	IsSuccessk t
=u v
truew {
,{ |

TerminalId	} á
=
à â

terminalId
ä î
,
î ï
TerminalGuid
ñ ¢
=
£ §
terminalGuid
• ±
}
≤ ≥
;
≥ ¥
public 
static  
InitializationResult *
Failure+ 2
(2 3
string3 9
message: A
)A B
=>C E
newF I
(I J
)J K
{L M
	IsSuccessN W
=X Y
falseZ _
,_ `
Messagea h
=i j
messagek r
}s t
;t u
} 
} º
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IShiftRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IShiftRepository !
{		 
Task 
< 	
Shift	 
? 
> 
GetByIdAsync 
( 
Guid "
id# %
,% &
CancellationToken' 8
cancellationToken9 J
=K L
defaultM T
)T U
;U V
Task 
< 	
IEnumerable	 
< 
Shift 
> 
>  
GetActiveShiftsAsync 1
(1 2
CancellationToken2 C
cancellationTokenD U
=V W
defaultX _
)_ `
;` a
Task 
< 	
IEnumerable	 
< 
Shift 
> 
> 
GetAllAsync (
(( )
CancellationToken) :
cancellationToken; L
=M N
defaultO V
)V W
;W X
Task 
< 	
Shift	 
? 
>  
GetCurrentShiftAsync %
(% &
CancellationToken& 7
cancellationToken8 I
=J K
defaultL S
)S T
;T U
Task!! 
AddAsync!!	 
(!! 
Shift!! 
shift!! 
,!! 
CancellationToken!! 0
cancellationToken!!1 B
=!!C D
default!!E L
)!!L M
;!!M N
Task&& 
UpdateAsync&&	 
(&& 
Shift&& 
shift&&  
,&&  !
CancellationToken&&" 3
cancellationToken&&4 E
=&&F G
default&&H O
)&&O P
;&&P Q
}'' «
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IServerSectionRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface $
IServerSectionRepository )
:* +
IRepository, 7
<7 8
ServerSection8 E
>E F
{ 
Task		 
<		 	
List			 
<		 
ServerSection		 
>		 
>		 
GetSectionsAsync		 .
(		. /
Guid		/ 3
?		3 4
serverId		5 =
=		> ?
null		@ D
,		D E
bool		F J
includeInactive		K Z
=		[ \
false		] b
,		b c
CancellationToken		d u
cancellationToken			v á
=
		à â
default
		ä ë
)
		ë í
;
		í ì
Task

 
<

 	
ServerSection

	 
?

 
>

 %
GetSectionWithTablesAsync

 2
(

2 3
Guid

3 7
	sectionId

8 A
,

A B
CancellationToken

C T
cancellationToken

U f
=

g h
default

i p
)

p q
;

q r
Task 
< 	
List	 
< 
ServerSection 
> 
> #
GetSectionsByTableAsync 5
(5 6
Guid6 :
tableId; B
,B C
CancellationTokenD U
cancellationTokenV g
=h i
defaultj q
)q r
;r s
Task 
< 	
User	 
? 
> 
GetServerByIdAsync "
(" #
Guid# '
serverId( 0
,0 1
CancellationToken2 C
cancellationTokenD U
=V W
defaultX _
)_ `
;` a
Task 
< 	
bool	 
> $
IsSectionNameUniqueAsync '
(' (
string( .
name/ 3
,3 4
Guid5 9
?9 :
	excludeId; D
=E F
nullG K
,K L
CancellationTokenM ^
cancellationToken_ p
=q r
defaults z
)z {
;{ |
} å
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ISecurityService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public

 
	interface

 
ISecurityService

 !
{ 
Task 
< 	
bool	 
> 
HasPermissionAsync !
(! "
UserId" (
userId) /
,/ 0
UserPermission1 ?

permission@ J
,J K
CancellationTokenL ]
cancellationToken^ o
=p q
defaultr y
)y z
;z {
Task 
< 	
User	 
? 
> 
GetUserByPinAsync !
(! "
string" (
encryptedPin) 5
,5 6
CancellationToken7 H
cancellationTokenI Z
=[ \
default] d
)d e
;e f
} ÅA
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ISalesReportRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface "
ISalesReportRepository '
{ 
Task 
< 	!
SalesBalanceReportDto	 
>  
GetSalesBalanceAsync  4
(4 5
DateTime5 =
	startDate> G
,G H
DateTimeI Q
endDateR Y
,Y Z
CancellationToken[ l
cancellationTokenm ~
=	 Ä
default
Å à
)
à â
;
â ä
Task 
< 	!
SalesSummaryReportDto	 
>  
GetSalesSummaryAsync  4
(4 5
DateTime5 =
	startDate> G
,G H
DateTimeI Q
endDateR Y
,Y Z
bool[ _
includeGroups` m
,m n
CancellationToken	o Ä
cancellationToken
Å í
=
ì î
default
ï ú
)
ú ù
;
ù û
Task		 
<		 	 
SalesDetailReportDto			 
>		 
GetSalesDetailAsync		 2
(		2 3
DateTime		3 ;
	startDate		< E
,		E F
DateTime		G O
endDate		P W
,		W X
string		Y _
?		_ `
categoryFilter		a o
=		p q
null		r v
,		v w
string		x ~
?		~ 
groupFilter
		Ä ã
=
		å ç
null
		é í
,
		í ì
string
		î ö
?
		ö õ

itemFilter
		ú ¶
=
		ß ®
null
		© ≠
,
		≠ Æ
CancellationToken
		Ø ¿
cancellationToken
		¡ “
=
		” ‘
default
		’ ‹
)
		‹ ›
;
		› ﬁ
Task

 
<

 	
ExceptionsReportDto

	 
>

 $
GetExceptionsReportAsync

 6
(

6 7
DateTime

7 ?
	startDate

@ I
,

I J
DateTime

K S
endDate

T [
,

[ \
CancellationToken

] n
cancellationToken	

o Ä
=


Å Ç
default


É ä
)


ä ã
;


ã å
Task 
< 	
JournalReportDto	 
> !
GetJournalReportAsync 0
(0 1
DateTime1 9
	startDate: C
,C D
DateTimeE M
endDateN U
,U V
stringW ]
?] ^

entityType_ i
,i j
Guidk o
?o p
userIdq w
,w x
CancellationToken	y ä
cancellationToken
ã ú
=
ù û
default
ü ¶
)
¶ ß
;
ß ®
Task 
< 	!
ProductivityReportDto	 
> &
GetServerProductivityAsync  :
(: ;
DateTime; C
	startDateD M
,M N
DateTimeO W
endDateX _
,_ `
Guida e
?e f
userIdg m
,m n
CancellationToken	o Ä
cancellationToken
Å í
=
ì î
default
ï ú
)
ú ù
;
ù û
Task 
< 	
LaborReportDto	 
> 
GetLaborReportAsync ,
(, -
DateTime- 5
	startDate6 ?
,? @
DateTimeA I
endDateJ Q
,Q R
CancellationTokenS d
cancellationTokene v
=w x
default	y Ä
)
Ä Å
;
Å Ç
Task 
< 	
DeliveryReportDto	 
> "
GetDeliveryReportAsync 2
(2 3
DateTime3 ;
	startDate< E
,E F
DateTimeG O
endDateP W
,W X
CancellationTokenY j
cancellationTokenk |
=} ~
default	 Ü
)
Ü á
;
á à
Task 
< 	
CreditCardReportDto	 
> $
GetCreditCardReportAsync 6
(6 7
DateTime7 ?
	startDate@ I
,I J
DateTimeK S
endDateT [
,[ \
string] c
?c d
cardTypeFiltere s
=t u
nullv z
,z {
string	| Ç
?
Ç É#
transactionTypeFilter
Ñ ô
=
ö õ
null
ú †
,
† °
CancellationToken
¢ ≥
cancellationToken
¥ ≈
=
∆ «
default
» œ
)
œ –
;
– —
Task 
< 	
PaymentReportDto	 
> !
GetPaymentReportAsync 0
(0 1
DateTime1 9
	startDate: C
,C D
DateTimeE M
endDateN U
,U V
stringW ]
?] ^
terminalFilter_ m
=n o
nullp t
,t u
CancellationToken	v á
cancellationToken
à ô
=
ö õ
default
ú £
)
£ §
;
§ •
Task 
< 	
MenuUsageReportDto	 
> #
GetMenuUsageReportAsync 4
(4 5
DateTime5 =
	startDate> G
,G H
DateTimeI Q
endDateR Y
,Y Z
string[ a
?a b
categoryFilterc q
=r s
nullt x
,x y
string	z Ä
?
Ä Å
orderTypeFilter
Ç ë
=
í ì
null
î ò
,
ò ô
CancellationToken
ö ´
cancellationToken
¨ Ω
=
æ ø
default
¿ «
)
« »
;
» …
Task 
< 	'
ServerProductivityReportDto	 $
>$ %,
 GetServerProductivityReportAsync& F
(F G
DateTimeG O
	startDateP Y
,Y Z
DateTime[ c
endDated k
,k l
Guidm q
?q r
userIdFilters 
=
Ä Å
null
Ç Ü
,
Ü á
CancellationToken
à ô
cancellationToken
ö ´
=
¨ ≠
default
Æ µ
)
µ ∂
;
∂ ∑
Task 
< 	 
HourlyLaborReportDto	 
> %
GetHourlyLaborReportAsync 8
(8 9
DateTime9 A
	startDateB K
,K L
DateTimeM U
endDateV ]
,] ^
Guid_ c
?c d
employeeIdFiltere u
=v w
nullx |
,| }
CancellationToken	~ è
cancellationToken
ê °
=
¢ £
default
§ ´
)
´ ¨
;
¨ ≠
Task 
< 	
TipReportDto	 
> 
GetTipReportAsync (
(( )
DateTime) 1
	startDate2 ;
,; <
DateTime= E
endDateF M
,M N
GuidO S
?S T
userIdFilterU a
=b c
nulld h
,h i
CancellationTokenj {
cancellationToken	| ç
=
é è
default
ê ó
)
ó ò
;
ò ô
Task 
< 	
AttendanceReportDto	 
> $
GetAttendanceReportAsync 6
(6 7
DateTime7 ?
	startDate@ I
,I J
DateTimeK S
endDateT [
,[ \
Guid] a
?a b
userIdFilterc o
=p q
nullr v
,v w
CancellationToken	x â
cancellationToken
ä õ
=
ú ù
default
û •
)
• ¶
;
¶ ß
Task 
< 	
CashOutReportDto	 
> !
GetCashOutReportAsync 0
(0 1
DateTime1 9
	startDate: C
,C D
DateTimeE M
endDateN U
,U V
GuidW [
?[ \
userIdFilter] i
=j k
nulll p
,p q
CancellationToken	r É
cancellationToken
Ñ ï
=
ñ ó
default
ò ü
)
ü †
;
† °
} Ï
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IRoleRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IRoleRepository  
:! "
IRepository# .
<. /
Role/ 3
>3 4
{ 
Task 
< 	
Role	 
? 
> 
GetByNameAsync 
( 
string %
name& *
,* +
CancellationToken, =
cancellationToken> O
=P Q
defaultR Y
)Y Z
;Z [
} ß
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IRestaurantConfigurationRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface .
"IRestaurantConfigurationRepository 3
{ 
Task 
< 	#
RestaurantConfiguration	  
>  !!
GetConfigurationAsync" 7
(7 8
CancellationToken8 I
cancellationTokenJ [
=\ ]
default^ e
)e f
;f g
Task $
UpdateConfigurationAsync	 !
(! "#
RestaurantConfiguration" 9
configuration: G
,G H
CancellationTokenI Z
cancellationToken[ l
=m n
defaulto v
)v w
;w x
}		 ”
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IRepository 
< 
T 
> 
where  %
T& '
:( )
class* /
{ 
Task		 
<		 	
T			 

?		
 
>		 
GetByIdAsync		 
(		 
Guid		 
id		 !
,		! "
CancellationToken		# 4
cancellationToken		5 F
=		G H
default		I P
)		P Q
;		Q R
Task

 
<

 	
IEnumerable

	 
<

 
T

 
>

 
>

 
GetAllAsync

 $
(

$ %
CancellationToken

% 6
cancellationToken

7 H
=

I J
default

K R
)

R S
;

S T
Task 
AddAsync	 
( 
T 
entity 
, 
CancellationToken -
cancellationToken. ?
=@ A
defaultB I
)I J
;J K
Task 
UpdateAsync	 
( 
T 
entity 
, 
CancellationToken 0
cancellationToken1 B
=C D
defaultE L
)L M
;M N
Task 
DeleteAsync	 
( 
T 
entity 
, 
CancellationToken 0
cancellationToken1 B
=C D
defaultE L
)L M
;M N
} †
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IReceiptPrintService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		  
IReceiptPrintService		 %
{

 
Task 
< 	
bool	 
> #
PrintTicketReceiptAsync &
(& '
Ticket' -
ticket. 4
,4 5
Guid6 :
?: ;
userId< B
=C D
nullE I
,I J
CancellationTokenK \
cancellationToken] n
=o p
defaultq x
)x y
;y z
Task 
< 	
bool	 
> $
PrintPaymentReceiptAsync '
(' (
Payment( /
payment0 7
,7 8
Ticket9 ?
ticket@ F
,F G
GuidH L
?L M
userIdN T
=U V
nullW [
,[ \
CancellationToken] n
cancellationToken	o Ä
=
Å Ç
default
É ä
)
ä ã
;
ã å
Task%% 
<%% 	
bool%%	 
>%% #
PrintRefundReceiptAsync%% &
(%%& '
Payment%%' .
refundPayment%%/ <
,%%< =
Ticket%%> D
ticket%%E K
,%%K L
Guid%%M Q
?%%Q R
userId%%S Y
=%%Z [
null%%\ `
,%%` a
CancellationToken%%b s
cancellationToken	%%t Ö
=
%%Ü á
default
%%à è
)
%%è ê
;
%%ê ë
Task,, 
<,, 	
bool,,	 
>,, 
OpenCashDrawerAsync,, "
(,," #
CancellationToken,,# 4
cancellationToken,,5 F
=,,G H
default,,I P
),,P Q
;,,Q R
}-- ê	
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IRawPrintService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 
IRawPrintService		 !
{

 
Task 
< 	
IEnumerable	 
< 
string 
> 
> %
GetInstalledPrintersAsync 7
(7 8
)8 9
;9 :
Task 
PrintRawStringAsync	 
( 
string #
printerName$ /
,/ 0
string1 7
data8 <
)< =
;= >
Task 
PrintRawBytesAsync	 
( 
string "
printerName# .
,. /
byte0 4
[4 5
]5 6
data7 ;
); <
;< =
Task 
< 	
bool	 
> 
IsPrinterValidAsync "
(" #
string# )
printerName* 5
)5 6
;6 7
} Ë
vC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IQueryHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IQueryHandler 
< 
in !
TQuery" (
,( )
TResult* 1
>1 2
{		 
Task

 
<

 	
TResult

	 
>

 
HandleAsync

 
(

 
TQuery

 $
query

% *
,

* +
CancellationToken

, =
cancellationToken

> O
=

P Q
default

R Y
)

Y Z
;

Z [
} ¯
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPrintTemplateRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface $
IPrintTemplateRepository )
:* +
IRepository, 7
<7 8
PrintTemplate8 E
>E F
{		 
Task

 
<

 	
PrintTemplate

	 
?

 
>

 
GetByNameAsync

 '
(

' (
string

( .
name

/ 3
,

3 4
CancellationToken

5 F
cancellationToken

G X
)

X Y
;

Y Z
Task 
< 	
List	 
< 
PrintTemplate 
> 
> #
GetSystemTemplatesAsync 5
(5 6
CancellationToken6 G
cancellationTokenH Y
)Y Z
;Z [
} Ω
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPrintingService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IPrintingService !
{ 
Task 
< 	
IEnumerable	 
< 
string 
> 
> "
GetSystemPrintersAsync 4
(4 5
)5 6
;6 7
Task		 
PrintTicketAsync			 
(		 
	TicketDto		 #
ticket		$ *
,		* +
string		, 2
?		2 3
printerName		4 ?
=		@ A
null		B F
)		F G
;		G H
Task

 #
PrintKitchenTicketAsync

	  
(

  !
	TicketDto

! *
ticket

+ 1
)

1 2
;

2 3
Task 
PrintReceiptAsync	 
( 
	TicketDto $
ticket% +
)+ ,
;, -
} –
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPrinterMappingRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 %
IPrinterMappingRepository		 *
{

 
Task 
< 	
IEnumerable	 
< 
PrinterMapping #
># $
>$ % 
GetByTerminalIdAsync& :
(: ;
Guid; ?

terminalId@ J
,J K
CancellationTokenL ]
cancellationToken^ o
=p q
defaultr y
)y z
;z {
Task 
AddAsync	 
( 
PrinterMapping  
mapping! (
,( )
CancellationToken* ;
cancellationToken< M
=N O
defaultP W
)W X
;X Y
Task 
UpdateAsync	 
( 
PrinterMapping #
mapping$ +
,+ ,
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
;[ \
Task 
DeleteAsync	 
( 
PrinterMapping #
mapping$ +
,+ ,
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
;[ \
} Ø
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPrinterGroupRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 #
IPrinterGroupRepository		 (
{

 
Task 
< 	
IEnumerable	 
< 
PrinterGroup !
>! "
>" #
GetAllAsync$ /
(/ 0
CancellationToken0 A
cancellationTokenB S
=T U
defaultV ]
)] ^
;^ _
Task 
< 	
PrinterGroup	 
? 
> 
GetByIdAsync $
($ %
Guid% )
id* ,
,, -
CancellationToken. ?
cancellationToken@ Q
=R S
defaultT [
)[ \
;\ ]
Task 
AddAsync	 
( 
PrinterGroup 
group $
,$ %
CancellationToken& 7
cancellationToken8 I
=J K
defaultL S
)S T
;T U
Task 
UpdateAsync	 
( 
PrinterGroup !
group" '
,' (
CancellationToken) :
cancellationToken; L
=M N
defaultO V
)V W
;W X
Task 
DeleteAsync	 
( 
PrinterGroup !
group" '
,' (
CancellationToken) :
cancellationToken; L
=M N
defaultO V
)V W
;W X
} ç
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPrintContextBuilder.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		  
IPrintContextBuilder		 %
{

 
Task 
< 	
TicketPrintModel	 
> #
BuildTicketContextAsync 2
(2 3
Ticket3 9
ticket: @
,@ A
CancellationTokenB S
cancellationTokenT e
)e f
;f g
Task 
< 	
TicketPrintModel	 
> $
BuildKitchenContextAsync 3
(3 4
Ticket4 :
ticket; A
,A B
IEnumerableC N
<N O
	OrderLineO X
>X Y
linesZ _
,_ `
CancellationTokena r
cancellationToken	s Ñ
)
Ñ Ö
;
Ö Ü
} æ
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPaymentRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IPaymentRepository #
{		 
Task 
< 	
Payment	 
? 
> 
GetByIdAsync 
(  
Guid  $
id% '
,' (
CancellationToken) :
cancellationToken; L
=M N
defaultO V
)V W
;W X
Task 
< 	
IEnumerable	 
< 
Payment 
> 
> 
GetByTicketIdAsync 1
(1 2
Guid2 6
ticketId7 ?
,? @
CancellationTokenA R
cancellationTokenS d
=e f
defaultg n
)n o
;o p
Task 
< 	
IEnumerable	 
< 
Payment 
> 
> #
GetByCashSessionIdAsync 6
(6 7
Guid7 ;
cashSessionId< I
,I J
CancellationTokenK \
cancellationToken] n
=o p
defaultq x
)x y
;y z
Task 
AddAsync	 
( 
Payment 
payment !
,! "
CancellationToken# 4
cancellationToken5 F
=G H
defaultI P
)P Q
;Q R
Task!! 
UpdateAsync!!	 
(!! 
Payment!! 
payment!! $
,!!$ %
CancellationToken!!& 7
cancellationToken!!8 I
=!!J K
default!!L S
)!!S T
;!!T U
Task&& 
<&& 	
IEnumerable&&	 
<&& 
Payment&& 
>&& 
>&& -
!GetUnbatchedCapturedPaymentsAsync&& @
(&&@ A
Guid&&A E

terminalId&&F P
,&&P Q
CancellationToken&&R c
cancellationToken&&d u
=&&v w
default&&x 
)	&& Ä
;
&&Ä Å
}'' ì<
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPaymentGateway.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 
IPaymentGateway		  
{

 
Task 
< 	
AuthorizationResult	 
> 
AuthorizeAsync ,
(, -
CreditCardPayment 
payment !
,! "
string 

cardNumber 
, 
string 
? 
cardHolderName 
=  
null! %
,% &
string 
? 
expirationDate 
=  
null! %
,% &
string 
? 
cvv 
= 
null 
, 
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
;6 7
Task 
< 	
CaptureResult	 
> 
CaptureAsync $
($ %
CreditCardPayment 
payment !
,! "
Money 
? 
amount 
= 
null 
, 
CancellationToken 
cancellationToken +
=, -
default. 5
)5 6
;6 7
Task!! 
<!! 	

VoidResult!!	 
>!! 
	VoidAsync!! 
(!! 
CreditCardPayment"" 
payment"" !
,""! "
CancellationToken## 
cancellationToken## +
=##, -
default##. 5
)##5 6
;##6 7
Task(( 
<(( 	
RefundResult((	 
>(( 
RefundAsync(( "
(((" #
CreditCardPayment)) 
payment)) !
,))! "
Money** 
refundAmount** 
,** 
CancellationToken++ 
cancellationToken++ +
=++, -
default++. 5
)++5 6
;++6 7
Task00 
<00 	
AddTipsResult00	 
>00 
AddTipsAsync00 $
(00$ %
CreditCardPayment11 
payment11 !
,11! "
Money22 

tipsAmount22 
,22 
CancellationToken33 
cancellationToken33 +
=33, -
default33. 5
)335 6
;336 7
Task88 
<88 	
BatchCloseResult88	 
>88 
CloseBatchAsync88 *
(88* +
Guid88+ /

terminalId880 :
,88: ;
CancellationToken88< M
cancellationToken88N _
=88` a
default88b i
)88i j
;88j k
}99 
public>> 
class>> 
AuthorizationResult>>  
{?? 
public@@ 

bool@@ 
Success@@ 
{@@ 
get@@ 
;@@ 
set@@ "
;@@" #
}@@$ %
publicAA 

stringAA 
?AA 
AuthorizationCodeAA $
{AA% &
getAA' *
;AA* +
setAA, /
;AA/ 0
}AA1 2
publicBB 

stringBB 
?BB 
ReferenceNumberBB "
{BB# $
getBB% (
;BB( )
setBB* -
;BB- .
}BB/ 0
publicCC 

stringCC 
?CC 
ErrorMessageCC 
{CC  !
getCC" %
;CC% &
setCC' *
;CC* +
}CC, -
publicDD 

stringDD 
?DD 
CardTypeDD 
{DD 
getDD !
;DD! "
setDD# &
;DD& '
}DD( )
publicEE 

stringEE 
?EE 
LastFourDigitsEE !
{EE" #
getEE$ '
;EE' (
setEE) ,
;EE, -
}EE. /
}FF 
publicKK 
classKK 
CaptureResultKK 
{LL 
publicMM 

boolMM 
SuccessMM 
{MM 
getMM 
;MM 
setMM "
;MM" #
}MM$ %
publicNN 

stringNN 
?NN 
CaptureCodeNN 
{NN  
getNN! $
;NN$ %
setNN& )
;NN) *
}NN+ ,
publicOO 

stringOO 
?OO 
ReferenceNumberOO "
{OO# $
getOO% (
;OO( )
setOO* -
;OO- .
}OO/ 0
publicPP 

stringPP 
?PP 
ErrorMessagePP 
{PP  !
getPP" %
;PP% &
setPP' *
;PP* +
}PP, -
}QQ 
publicVV 
classVV 

VoidResultVV 
{WW 
publicXX 

boolXX 
SuccessXX 
{XX 
getXX 
;XX 
setXX "
;XX" #
}XX$ %
publicYY 

stringYY 
?YY 
VoidCodeYY 
{YY 
getYY !
;YY! "
setYY# &
;YY& '
}YY( )
publicZZ 

stringZZ 
?ZZ 
ErrorMessageZZ 
{ZZ  !
getZZ" %
;ZZ% &
setZZ' *
;ZZ* +
}ZZ, -
}[[ 
public`` 
class`` 
RefundResult`` 
{aa 
publicbb 

boolbb 
Successbb 
{bb 
getbb 
;bb 
setbb "
;bb" #
}bb$ %
publiccc 

stringcc 
?cc 

RefundCodecc 
{cc 
getcc  #
;cc# $
setcc% (
;cc( )
}cc* +
publicdd 

stringdd 
?dd 
ReferenceNumberdd "
{dd# $
getdd% (
;dd( )
setdd* -
;dd- .
}dd/ 0
publicee 

stringee 
?ee 
ErrorMessageee 
{ee  !
getee" %
;ee% &
setee' *
;ee* +
}ee, -
}ff 
publickk 
classkk 
AddTipsResultkk 
{ll 
publicmm 

boolmm 
Successmm 
{mm 
getmm 
;mm 
setmm "
;mm" #
}mm$ %
publicnn 

stringnn 
?nn 
AuthorizationCodenn $
{nn% &
getnn' *
;nn* +
setnn, /
;nn/ 0
}nn1 2
publicoo 

stringoo 
?oo 
ErrorMessageoo 
{oo  !
getoo" %
;oo% &
setoo' *
;oo* +
}oo, -
}pp 
publicuu 
classuu 
BatchCloseResultuu 
{vv 
publicww 

boolww 
Successww 
{ww 
getww 
;ww 
setww "
;ww" #
}ww$ %
publicxx 

stringxx 
?xx 
GatewayBatchIdxx !
{xx" #
getxx$ '
;xx' (
setxx) ,
;xx, -
}xx. /
publicyy 

stringyy 
?yy 
ErrorMessageyy 
{yy  !
getyy" %
;yy% &
setyy' *
;yy* +
}yy, -
publiczz 

Moneyzz 
TotalAmountzz 
{zz 
getzz "
;zz" #
setzz$ '
;zz' (
}zz) *
=zz+ ,
Moneyzz- 2
.zz2 3
Zerozz3 7
(zz7 8
)zz8 9
;zz9 :
public{{ 

int{{ 
TransactionCount{{ 
{{{  !
get{{" %
;{{% &
set{{' *
;{{* +
}{{, -
}|| ¶
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IPaymentBatchRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface #
IPaymentBatchRepository (
{ 
Task		 
AddAsync			 
(		 
PaymentBatch		 
paymentBatch		 +
)		+ ,
;		, -
Task

 
UpdateAsync

	 
(

 
PaymentBatch

 !
paymentBatch

" .
)

. /
;

/ 0
Task 
< 	
PaymentBatch	 
? 
> )
GetOpenBatchByTerminalIdAsync 5
(5 6
Guid6 :

terminalId; E
)E F
;F G
Task 
< 	
PaymentBatch	 
? 
> 
GetByIdAsync $
($ %
Guid% )
id* ,
), -
;- .
} ç
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IOrderTypeRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface  
IOrderTypeRepository %
{		 
Task 
< 	
	OrderType	 
? 
> 
GetByIdAsync !
(! "
Guid" &
id' )
,) *
CancellationToken+ <
cancellationToken= N
=O P
defaultQ X
)X Y
;Y Z
Task 
< 	
	OrderType	 
? 
> 
GetByNameAsync #
(# $
string$ *
name+ /
,/ 0
CancellationToken1 B
cancellationTokenC T
=U V
defaultW ^
)^ _
;_ `
Task 
< 	
IEnumerable	 
< 
	OrderType 
> 
>  
GetActiveAsync! /
(/ 0
CancellationToken0 A
cancellationTokenB S
=T U
defaultV ]
)] ^
;^ _
Task 
< 	
IEnumerable	 
< 
	OrderType 
> 
>  
GetAllAsync! ,
(, -
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
;[ \
Task!! 
AddAsync!!	 
(!! 
	OrderType!! 
	orderType!! %
,!!% &
CancellationToken!!' 8
cancellationToken!!9 J
=!!K L
default!!M T
)!!T U
;!!U V
Task&& 
UpdateAsync&&	 
(&& 
	OrderType&& 
	orderType&& (
,&&( )
CancellationToken&&* ;
cancellationToken&&< M
=&&N O
default&&P W
)&&W X
;&&X Y
}'' ¶
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IModifierGroupRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 $
IModifierGroupRepository		 )
{

 
Task 
< 	
ModifierGroup	 
? 
> 
GetByIdAsync %
(% &
Guid& *
id+ -
,- .
CancellationToken/ @
cancellationTokenA R
=S T
defaultU \
)\ ]
;] ^
Task 
< 	
IEnumerable	 
< 
ModifierGroup "
>" #
># $
GetAllAsync% 0
(0 1
CancellationToken1 B
cancellationTokenC T
=U V
defaultW ^
)^ _
;_ `
Task 
< 	
IEnumerable	 
< 
ModifierGroup "
>" #
># $ 
GetByCategoryIdAsync% 9
(9 :
Guid: >

categoryId? I
,I J
CancellationTokenK \
cancellationToken] n
=o p
defaultq x
)x y
;y z
Task 
AddAsync	 
( 
ModifierGroup 
modifierGroup  -
,- .
CancellationToken/ @
cancellationTokenA R
=S T
defaultU \
)\ ]
;] ^
Task 
UpdateAsync	 
( 
ModifierGroup "
modifierGroup# 0
,0 1
CancellationToken2 C
cancellationTokenD U
=V W
defaultX _
)_ `
;` a
Task 
DeleteAsync	 
( 
Guid 
id 
, 
CancellationToken /
cancellationToken0 A
=B C
defaultD K
)K L
;L M
} Ú	
êC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IMerchantGatewayConfigurationRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 3
'IMerchantGatewayConfigurationRepository 8
{		 
Task

 
<

 	(
MerchantGatewayConfiguration

	 %
?

% &
>

& ' 
GetByTerminalIdAsync

( <
(

< =
Guid

= A

terminalId

B L
,

L M
CancellationToken

N _
cancellationToken

` q
=

r s
default

t {
)

{ |
;

| }
Task 
AddAsync	 
( (
MerchantGatewayConfiguration .
config/ 5
,5 6
CancellationToken7 H
cancellationTokenI Z
=[ \
default] d
)d e
;e f
Task 
UpdateAsync	 
( (
MerchantGatewayConfiguration 1
config2 8
,8 9
CancellationToken: K
cancellationTokenL ]
=^ _
default` g
)g h
;h i
} £
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IMerchantBatchService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface !
IMerchantBatchService &
{		 
Task 
< 	
PaymentBatch	 
> 
OpenBatchAsync %
(% &
Guid& *

terminalId+ 5
)5 6
;6 7
Task 
< 	
PaymentBatch	 
> 
CloseBatchAsync &
(& '
Guid' +

terminalId, 6
,6 7
UserId8 >
closedBy? G
)G H
;H I
} Ú
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IMenuRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 
IMenuRepository		  
{

 
Task 
< 	
MenuItem	 
? 
> 
GetByIdAsync  
(  !
Guid! %
id& (
,( )
CancellationToken* ;
cancellationToken< M
=N O
defaultP W
)W X
;X Y
Task 
< 	
IEnumerable	 
< 
MenuItem 
> 
> 
GetAllAsync  +
(+ ,
CancellationToken, =
cancellationToken> O
=P Q
defaultR Y
)Y Z
;Z [
Task 
< 	
IEnumerable	 
< 
MenuItem 
> 
> 
GetByGroupAsync  /
(/ 0
Guid0 4
groupId5 <
,< =
CancellationToken> O
cancellationTokenP a
=b c
defaultd k
)k l
;l m
Task 
< 	
MenuModifier	 
? 
>  
GetModifierByIdAsync ,
(, -
Guid- 1
id2 4
,4 5
CancellationToken6 G
cancellationTokenH Y
=Z [
default\ c
)c d
;d e
Task 
< 	
ComboDefinition	 
? 
> '
GetComboDefinitionByIdAsync 6
(6 7
Guid7 ;
id< >
,> ?
CancellationToken@ Q
cancellationTokenR c
=d e
defaultf m
)m n
;n o
Task 
AddAsync	 
( 
MenuItem 
menuItem #
,# $
CancellationToken% 6
cancellationToken7 H
=I J
defaultK R
)R S
;S T
Task 
UpdateAsync	 
( 
MenuItem 
menuItem &
,& '
CancellationToken( 9
cancellationToken: K
=L M
defaultN U
)U V
;V W
Task 
DeleteAsync	 
( 
MenuItem 
menuItem &
,& '
CancellationToken( 9
cancellationToken: K
=L M
defaultN U
)U V
;V W
} Ê
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IMenuModifierRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface #
IMenuModifierRepository (
{		 
Task

 
<

 	
MenuModifier

	 
?

 
>

 
GetByIdAsync

 $
(

$ %
Guid

% )
id

* ,
,

, -
CancellationToken

. ?
cancellationToken

@ Q
=

R S
default

T [
)

[ \
;

\ ]
Task 
< 	
IEnumerable	 
< 
MenuModifier !
>! "
>" #
GetByGroupIdAsync$ 5
(5 6
Guid6 :
groupId; B
,B C
CancellationTokenD U
cancellationTokenV g
=h i
defaultj q
)q r
;r s
Task 
AddAsync	 
( 
MenuModifier 
modifier '
,' (
CancellationToken) :
cancellationToken; L
=M N
defaultO V
)V W
;W X
Task 
UpdateAsync	 
( 
MenuModifier !
modifier" *
,* +
CancellationToken, =
cancellationToken> O
=P Q
defaultR Y
)Y Z
;Z [
Task 
DeleteAsync	 
( 
Guid 
id 
, 
CancellationToken /
cancellationToken0 A
=B C
defaultD K
)K L
;L M
} ´
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IMenuGroupRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		  
IMenuGroupRepository		 %
{

 
Task 
< 	
	MenuGroup	 
? 
> 
GetByIdAsync !
(! "
Guid" &
id' )
,) *
CancellationToken+ <
cancellationToken= N
=O P
defaultQ X
)X Y
;Y Z
Task 
< 	
IEnumerable	 
< 
	MenuGroup 
> 
>  
GetAllAsync! ,
(, -
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
;[ \
Task 
< 	
IEnumerable	 
< 
	MenuGroup 
> 
>  
GetVisibleAsync! 0
(0 1
CancellationToken1 B
cancellationTokenC T
=U V
defaultW ^
)^ _
;_ `
Task 
< 	
IEnumerable	 
< 
	MenuGroup 
> 
>   
GetByCategoryIdAsync! 5
(5 6
Guid6 :

categoryId; E
,E F
CancellationTokenG X
cancellationTokenY j
=k l
defaultm t
)t u
;u v
Task 
AddAsync	 
( 
	MenuGroup 
group !
,! "
CancellationToken# 4
cancellationToken5 F
=G H
defaultI P
)P Q
;Q R
Task 
UpdateAsync	 
( 
	MenuGroup 
group $
,$ %
CancellationToken& 7
cancellationToken8 I
=J K
defaultL S
)S T
;T U
Task 
DeleteAsync	 
( 
	MenuGroup 
group $
,$ %
CancellationToken& 7
cancellationToken8 I
=J K
defaultL S
)S T
;T U
} Â
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IMenuCategoryRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 #
IMenuCategoryRepository		 (
{

 
Task 
< 	
MenuCategory	 
? 
> 
GetByIdAsync $
($ %
Guid% )
id* ,
,, -
CancellationToken. ?
cancellationToken@ Q
=R S
defaultT [
)[ \
;\ ]
Task 
< 	
IEnumerable	 
< 
MenuCategory !
>! "
>" #
GetAllAsync$ /
(/ 0
CancellationToken0 A
cancellationTokenB S
=T U
defaultV ]
)] ^
;^ _
Task 
< 	
IEnumerable	 
< 
MenuCategory !
>! "
>" #
GetVisibleAsync$ 3
(3 4
CancellationToken4 E
cancellationTokenF W
=X Y
defaultZ a
)a b
;b c
Task 
AddAsync	 
( 
MenuCategory 
category '
,' (
CancellationToken) :
cancellationToken; L
=M N
defaultO V
)V W
;W X
Task 
UpdateAsync	 
( 
MenuCategory !
category" *
,* +
CancellationToken, =
cancellationToken> O
=P Q
defaultR Y
)Y Z
;Z [
Task 
DeleteAsync	 
( 
MenuCategory !
category" *
,* +
CancellationToken, =
cancellationToken> O
=P Q
defaultR Y
)Y Z
;Z [
} Å
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IKitchenStatusService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface !
IKitchenStatusService &
{ 
Task 
BumpOrderAsync	 
( 
Guid 
kitchenOrderId +
)+ ,
;, -
Task 
VoidOrderAsync	 
( 
Guid 
kitchenOrderId +
)+ ,
;, -
} Ú
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IKitchenRoutingService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface "
IKitchenRoutingService '
{		 
Task 
< 	
List	 
< 
Guid 
> 
> 
RouteToKitchenAsync (
(( )
	TicketDto) 2
ticket3 9
,9 :
List; ?
<? @
Guid@ D
>D E
?E F
itemIdsG N
=O P
nullQ U
)U V
;V W
} ∫
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IKitchenPrintService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		  
IKitchenPrintService		 %
{

 
Task 
< 	
KitchenPrintResult	 
> 
PrintOrderLineAsync 0
(0 1
	OrderLine1 :
	orderLine; D
,D E
TicketF L
ticketM S
,S T
CancellationTokenU f
cancellationTokeng x
=y z
default	{ Ç
)
Ç É
;
É Ñ
Task 
< 	
KitchenPrintResult	 
> 
PrintTicketAsync -
(- .
Ticket. 4
ticket5 ;
,; <
CancellationToken= N
cancellationTokenO `
=a b
defaultc j
)j k
;k l
Task %
MarkOrderLinePrintedAsync	 "
(" #
	OrderLine# ,
	orderLine- 6
,6 7
CancellationToken8 I
cancellationTokenJ [
=\ ]
default^ e
)e f
;f g
} 
public 
record 
KitchenPrintResult  
(  !
bool! %
Success& -
,- .
string/ 5
Message6 =
,= >
int? B
PrintedCountC O
=P Q
$numR S
,S T
ListU Y
<Y Z
stringZ `
>` a
?a b
Errorsc i
=j k
nulll p
)p q
{ 
public 

static 
KitchenPrintResult $
Failure% ,
(, -
string- 3
message4 ;
,; <
List= A
<A B
stringB H
>H I
?I J
errorsK Q
=R S
nullT X
)X Y
=>Z \
new] `
(` a
falsea f
,f g
messageh o
,o p
$numq r
,r s
errorst z
)z {
;{ |
public 

static 
KitchenPrintResult $
SuccessResult% 2
(2 3
int3 6
count7 <
)< =
=>> @
newA D
(D E
trueE I
,I J
$strK a
,a b
countc h
)h i
;i j
} ≥

ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IKitchenOrderRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface #
IKitchenOrderRepository (
{		 
Task

 
AddAsync

	 
(

 
KitchenOrder

 
kitchenOrder

 +
)

+ ,
;

, -
Task 
< 	
KitchenOrder	 
? 
> 
GetByIdAsync $
($ %
Guid% )
id* ,
), -
;- .
Task 
UpdateAsync	 
( 
KitchenOrder !
kitchenOrder" .
). /
;/ 0
Task 
< 	
IEnumerable	 
< 
KitchenOrder !
>! "
>" # 
GetActiveOrdersAsync$ 8
(8 9
)9 :
;: ;
Task 
< 	
IEnumerable	 
< 
KitchenOrder !
>! "
>" ##
GetCompletedOrdersAsync$ ;
(; <
int< ?
limit@ E
=F G
$numH J
)J K
;K L
} Õ
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IInventoryRepositories.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IVendorRepository "
{		 
Task

 
<

 	
Vendor

	 
?

 
>

 
GetByIdAsync

 
(

 
Guid

 #
id

$ &
)

& '
;

' (
Task 
< 	
IEnumerable	 
< 
Vendor 
> 
> 
GetAllAsync )
() *
)* +
;+ ,
Task 
AddAsync	 
( 
Vendor 
vendor 
)  
;  !
Task 
UpdateAsync	 
( 
Vendor 
vendor "
)" #
;# $
Task 
DeleteAsync	 
( 
Guid 
id 
) 
; 
} 
public 
	interface $
IPurchaseOrderRepository )
{ 
Task 
< 	
PurchaseOrder	 
? 
> 
GetByIdAsync %
(% &
Guid& *
id+ -
)- .
;. /
Task 
< 	
IEnumerable	 
< 
PurchaseOrder "
>" #
># $
GetAllAsync% 0
(0 1
)1 2
;2 3
Task 
AddAsync	 
( 
PurchaseOrder 
po  "
)" #
;# $
Task 
UpdateAsync	 
( 
PurchaseOrder "
po# %
)% &
;& '
} 
public 
	interface *
IInventoryAdjustmentRepository /
{ 
Task 
< 	
IEnumerable	 
< 
InventoryAdjustment (
>( )
>) *
GetByItemIdAsync+ ;
(; <
Guid< @
itemIdA G
)G H
;H I
Task 
AddAsync	 
( 
InventoryAdjustment %

adjustment& 0
)0 1
;1 2
} ∫
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IInventoryItemRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 $
IInventoryItemRepository		 )
{

 
Task 
< 	
InventoryItem	 
? 
> 
GetByIdAsync %
(% &
Guid& *
id+ -
,- .
CancellationToken/ @
cancellationTokenA R
=S T
defaultU \
)\ ]
;] ^
Task 
< 	
IEnumerable	 
< 
InventoryItem "
>" #
># $
GetAllAsync% 0
(0 1
CancellationToken1 B
cancellationTokenC T
=U V
defaultW ^
)^ _
;_ `
Task 
AddAsync	 
( 
InventoryItem 
inventoryItem  -
,- .
CancellationToken/ @
cancellationTokenA R
=S T
defaultU \
)\ ]
;] ^
Task 
UpdateAsync	 
( 
InventoryItem "
inventoryItem# 0
,0 1
CancellationToken2 C
cancellationTokenD U
=V W
defaultX _
)_ `
;` a
Task 
DeleteAsync	 
( 
Guid 
id 
, 
CancellationToken /
cancellationToken0 A
=B C
defaultD K
)K L
;L M
} ∂
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IGroupSettleService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public

 
	interface

 
IGroupSettleService

 $
{ 
Task 
< 	
GroupSettlement	 
> 
SettleGroupAsync *
(* +
List 
< 
Guid 
> 
	ticketIds 
, 
PaymentType 
paymentType 
,  
Money 
totalAmount 
, 
UserId 
processedBy 
, 
Guid 

terminalId 
, 
string 
? 
globalId 
= 
null 
)  
;  !
} Œ
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IGroupSettlementRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface &
IGroupSettlementRepository +
{ 
Task		 
AddAsync			 
(		 
GroupSettlement		 !
groupSettlement		" 1
)		1 2
;		2 3
Task

 
<

 	
GroupSettlement

	 
?

 
>

 
GetByIdAsync

 '
(

' (
Guid

( ,
id

- /
)

/ 0
;

0 1
} 
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IFloorRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IFloorRepository !
:" #
IRepository$ /
</ 0
Floor0 5
>5 6
{ 
Task 
< 	
Floor	 
? 
> 
GetByNameAsync 
(  
string  &
name' +
,+ ,
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
;[ \
} ·
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IEventPublisher.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
{ 
public 

	interface 
IEventPublisher $
{		 
Task 
PublishAsync 
< 
T 
> 
( 
T 
@event %
)% &
where' ,
T- .
:/ 0
class1 6
;6 7
} 
} €
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IDiscountRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IDiscountRepository $
{		 
Task

 
<

 	
Discount

	 
?

 
>

 
GetByIdAsync

  
(

  !
Guid

! %
id

& (
,

( )
CancellationToken

* ;
cancellationToken

< M
=

N O
default

P W
)

W X
;

X Y
Task 
< 	
Discount	 
? 
>  
GetByCouponCodeAsync (
(( )
string) /

couponCode0 :
,: ;
CancellationToken< M
cancellationTokenN _
=` a
defaultb i
)i j
;j k
} ¶
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IDialogService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public		 
	interface		 
IDialogService		 
{

 
Task 
ShowErrorAsync	 
( 
string 
title $
,$ %
string& ,
message- 4
,4 5
string6 <
?< =
exceptionDetails> N
=O P
nullQ U
)U V
;V W
Task 
ShowWarningAsync	 
( 
string  
title! &
,& '
string( .
message/ 6
)6 7
;7 8
Task 
ShowMessageAsync	 
( 
string  
title! &
,& '
string( .
message/ 6
)6 7
;7 8
Task   
<   	
bool  	 
>   !
ShowConfirmationAsync   $
(  $ %
string  % +
title  , 1
,  1 2
string  3 9
message  : A
,  A B
string  C I
yesText  J Q
=  R S
$str  T Y
,  Y Z
string  [ a
noText  b h
=  i j
$str  k o
)  o p
;  p q
}!! ä	
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ICommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ICommandHandler  
<  !
in! #
TCommand$ ,
,, -
TResult. 5
>5 6
{		 
Task

 
<

 	
TResult

	 
>

 
HandleAsync

 
(

 
TCommand

 &
command

' .
,

. /
CancellationToken

0 A
cancellationToken

B S
=

T U
default

V ]
)

] ^
;

^ _
} 
public 
	interface 
ICommandHandler  
<  !
in! #
TCommand$ ,
>, -
{ 
Task 
HandleAsync	 
( 
TCommand 
command %
,% &
CancellationToken' 8
cancellationToken9 J
=K L
defaultM T
)T U
;U V
} ∫
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ICashSessionService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ICashSessionService $
{		 
Task 
< 	
CashSession	 
> 
StartSessionAsync '
(' (
UserId( .
userId/ 5
,5 6
Guid7 ;

terminalId< F
,F G
GuidH L
shiftIdM T
,T U
MoneyV [
openingAmount\ i
)i j
;j k
Task 
< 	
CashSession	 
> 
CloseSessionAsync '
(' (
Guid( ,
	sessionId- 6
,6 7
UserId8 >
closedBy? G
,G H
MoneyI N
closingAmountO \
)\ ]
;] ^
Task 
< 	
CashSession	 
? 
> '
GetActiveSessionByUserAsync 2
(2 3
UserId3 9
userId: @
)@ A
;A B
Task 
< 	
CashSession	 
? 
> +
GetActiveSessionByTerminalAsync 6
(6 7
Guid7 ;

terminalId< F
)F G
;G H
} å
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ICashSessionRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface "
ICashSessionRepository '
{		 
Task 
< 	
CashSession	 
? 
> 
GetByIdAsync #
(# $
Guid$ (
id) +
,+ ,
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
;[ \
Task 
< 	
CashSession	 
? 
> '
GetOpenSessionByUserIdAsync 2
(2 3
Guid3 7
userId8 >
,> ?
CancellationToken@ Q
cancellationTokenR c
=d e
defaultf m
)m n
;n o
Task 
< 	
CashSession	 
? 
> +
GetOpenSessionByTerminalIdAsync 6
(6 7
Guid7 ;

terminalId< F
,F G
CancellationTokenH Y
cancellationTokenZ k
=l m
defaultn u
)u v
;v w
Task 
< 	
IEnumerable	 
< 
CashSession  
>  !
>! "
GetByShiftIdAsync# 4
(4 5
Guid5 9
shiftId: A
,A B
CancellationTokenC T
cancellationTokenU f
=g h
defaulti p
)p q
;q r
Task!! 
AddAsync!!	 
(!! 
CashSession!! 
cashSession!! )
,!!) *
CancellationToken!!+ <
cancellationToken!!= N
=!!O P
default!!Q X
)!!X Y
;!!Y Z
Task&& 
UpdateAsync&&	 
(&& 
CashSession&&  
cashSession&&! ,
,&&, -
CancellationToken&&. ?
cancellationToken&&@ Q
=&&R S
default&&T [
)&&[ \
;&&\ ]
}'' Ú
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\ICashDrawerService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
ICashDrawerService #
{ 
Task		 
OpenDrawerAsync			 
(		 
string		 
printerName		  +
)		+ ,
;		, -
}

 ı
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IBackupService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface 
IBackupService 
{ 
Task 
< 	
string	 
> 
CreateBackupAsync "
(" #
CancellationToken# 4
cancellationToken5 F
=G H
defaultI P
)P Q
;Q R
Task 
< 	
List	 
< 
BackupInfoDto 
> 
> 
ListBackupsAsync .
(. /
CancellationToken/ @
cancellationTokenA R
=S T
defaultU \
)\ ]
;] ^
Task		 
RestoreBackupAsync			 
(		 
string		 "
fileName		# +
,		+ ,
CancellationToken		- >
cancellationToken		? P
=		Q R
default		S Z
)		Z [
;		[ \
}

 ˘

~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IAuditEventRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface !
IAuditEventRepository &
{		 
Task 
AddAsync	 
( 

AuditEvent 

auditEvent '
,' (
CancellationToken) :
cancellationToken; L
=M N
defaultO V
)V W
;W X
Task 
< 	
IEnumerable	 
< 

AuditEvent 
>  
>  !
GetByEntityIdAsync" 4
(4 5
string5 ;

entityType< F
,F G
GuidH L
entityIdM U
,U V
CancellationTokenW h
cancellationTokeni z
={ |
default	} Ñ
)
Ñ Ö
;
Ö Ü
Task 
< 	
IEnumerable	 
< 

AuditEvent 
>  
>  !#
GetByCorrelationIdAsync" 9
(9 :
Guid: >
correlationId? L
,L M
CancellationTokenN _
cancellationToken` q
=r s
defaultt {
){ |
;| }
} ö
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IAttendanceRepository.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface !
IAttendanceRepository &
:' (
IRepository) 4
<4 5
AttendanceHistory5 F
>F G
{ 
Task 
< 	
AttendanceHistory	 
? 
>  
GetOpenByUserIdAsync 1
(1 2
UserId2 8
userId9 ?
,? @
CancellationTokenA R
cancellationTokenS d
=e f
defaultg n
)n o
;o p
}		 Ú
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Interfaces\IAesEncryptionService.cs
	namespace 	
Magidesk
 
. 
Application 
. 

Interfaces )
;) *
public 
	interface !
IAesEncryptionService &
{ 
string 

Encrypt 
( 
string 
	plainText #
)# $
;$ %
string 

Decrypt 
( 
string 

cipherText $
)$ %
;% &
}		 Å
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\UserDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
UserDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

string 
	FirstName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public		 

string		 
LastName		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
=		) *
string		+ 1
.		1 2
Empty		2 7
;		7 8
public

 

string

 
Username

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
=

) *
string

+ 1
.

1 2
Empty

2 7
;

7 8
public 

Guid 
? 

TerminalId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
public 

string 
FullName 
=> 
$"  
{  !
	FirstName! *
}* +
$str+ ,
{, -
LastName- 5
}5 6
"6 7
;7 8
} ·;
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\TicketDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
	TicketDto 
{		 
public

 

Guid

 
Id

 
{

 
get

 
;

 
set

 
;

 
}

  
public 

int 
TicketNumber 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
GlobalId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
	TableName 
{ 
get "
;" #
set$ '
;' (
}) *
public 

string 
	OwnerName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

string 
? 
Note 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
OpenedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
ClosedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 

ActiveDate 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
DeliveryDate !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

TicketStatus 
Status 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

Guid 
	CreatedBy 
{ 
get 
;  
set! $
;$ %
}& '
public 

Guid 
? 
ClosedBy 
{ 
get 
;  
set! $
;$ %
}& '
public 

Guid 
? 
VoidedBy 
{ 
get 
;  
set! $
;$ %
}& '
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

Guid 
OrderTypeId 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 
? 

CustomerId 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 
? 
AssignedDriverId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

List 
< 
int 
> 
TableNumbers !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
new2 5
(5 6
)6 7
;7 8
public 

int 
NumberOfGuests 
{ 
get  #
;# $
set% (
;( )
}* +
public   

decimal   
SubtotalAmount   !
{  " #
get  $ '
;  ' (
set  ) ,
;  , -
}  . /
public!! 

decimal!! 
DiscountAmount!! !
{!!" #
get!!$ '
;!!' (
set!!) ,
;!!, -
}!!. /
public"" 

decimal"" 
	TaxAmount"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public## 

decimal## 
ServiceChargeAmount## &
{##' (
get##) ,
;##, -
set##. 1
;##1 2
}##3 4
public$$ 

decimal$$  
DeliveryChargeAmount$$ '
{$$( )
get$$* -
;$$- .
set$$/ 2
;$$2 3
}$$4 5
public%% 

decimal%% 
AdjustmentAmount%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public&& 

decimal&& 
TotalAmount&& 
{&&  
get&&! $
;&&$ %
set&&& )
;&&) *
}&&+ ,
public'' 

decimal'' 

PaidAmount'' 
{'' 
get''  #
;''# $
set''% (
;''( )
}''* +
public(( 

decimal(( 
	DueAmount(( 
{(( 
get(( "
;((" #
set(($ '
;((' (
}(() *
public)) 

decimal)) 
AdvanceAmount))  
{))! "
get))# &
;))& '
set))( +
;))+ ,
}))- .
public** 

bool** 
IsTaxExempt** 
{** 
get** !
;**! "
set**# &
;**& '
}**( )
public++ 

bool++ 
IsBarTab++ 
{++ 
get++ 
;++ 
set++  #
;++# $
}++% &
public,, 

bool,, 

IsReOpened,, 
{,, 
get,,  
;,,  !
set,," %
;,,% &
},,' (
public-- 

string-- 
?-- 
DeliveryAddress-- "
{--# $
get--% (
;--( )
set--* -
;--- .
}--/ 0
public.. 

string.. 
?.. 
ExtraDeliveryInfo.. $
{..% &
get..' *
;..* +
set.., /
;../ 0
}..1 2
public// 

bool// 
CustomerWillPickup// "
{//# $
get//% (
;//( )
set//* -
;//- .
}/// 0
public00 

List00 
<00 
OrderLineDto00 
>00 

OrderLines00 (
{00) *
get00+ .
;00. /
set000 3
;003 4
}005 6
=007 8
new009 <
(00< =
)00= >
;00> ?
public11 

List11 
<11 

PaymentDto11 
>11 
Payments11 $
{11% &
get11' *
;11* +
set11, /
;11/ 0
}111 2
=113 4
new115 8
(118 9
)119 :
;11: ;
public22 

GratuityDto22 
?22 
Gratuity22  
{22! "
get22# &
;22& '
set22( +
;22+ ,
}22- .
public33 

int33 
Version33 
{33 
get33 
;33 
set33 !
;33! "
}33# $
}44 Ö"
qC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\TableLayoutDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
TableLayoutDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public		 

string		 
Name		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
=		% &
string		' -
.		- .
Empty		. 3
;		3 4
public

 

Guid

 
?

 
FloorId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

string 
	FloorName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

List 
< 
TableDto 
> 
Tables  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
new1 4
(4 5
)5 6
;6 7
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
	UpdatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
public 

bool 
IsDraft 
{ 
get 
; 
set "
;" #
}$ %
public 

int 
Version 
{ 
get 
; 
set !
;! "
}# $
} 
public 
class 
FloorDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
string. 4
.4 5
Empty5 :
;: ;
public 

int 
Width 
{ 
get 
; 
set 
;  
}! "
=# $
$num% )
;) *
public 

int 
Height 
{ 
get 
; 
set  
;  !
}" #
=$ %
$num& *
;* +
public 

string 
BackgroundColor !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$str2 ;
;; <
public 

List 
< 
TableDto 
> 
Tables  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
new1 4
(4 5
)5 6
;6 7
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
	UpdatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
}   ¸
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\TableDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
TableDto 
{		 
public

 

Guid

 
Id

 
{

 
get

 
;

 
set

 
;

 
}

  
public 

int 
TableNumber 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
? 
FloorId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
? 
LayoutId 
{ 
get 
;  
set! $
;$ %
}& '
public 

int 
Capacity 
{ 
get 
; 
set "
;" #
}$ %
public 

double 
X 
{ 
get 
; 
set 
; 
}  !
public 

double 
Y 
{ 
get 
; 
set 
; 
}  !
public 

double 
Width 
{ 
get 
; 
set "
;" #
}$ %
public 

double 
Height 
{ 
get 
; 
set  #
;# $
}% &
public 

TableShapeType 
Shape 
{  !
get" %
;% &
set' *
;* +
}, -
public 

TableStatus 
Status 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Guid 
? 
CurrentTicketId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 

IsSelected 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool 
IsLocked 
{ 
get 
; 
set  #
;# $
}% &
} ï	
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\System\BackupInfoDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
SystemConfig$ 0
;0 1
public 
class 
BackupInfoDto 
{ 
public 

string 
FileName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

long 
	SizeBytes 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Path 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
}		 π
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\SystemConfig\TerminalDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
SystemConfig$ 0
;0 1
public 
class 
TerminalDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public		 

string		 
TerminalKey		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
=		, -
string		. 4
.		4 5
Empty		5 :
;		: ;
public

 

string

 
Location

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
=

) *
string

+ 1
.

1 2
Empty

2 7
;

7 8
public 

Guid 
? 
FloorId 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
HasCashDrawer 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
OpeningBalance !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
CurrentBalance !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

bool 

AutoLogOut 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
AutoLogOutTime 
{ 
get  #
;# $
set% (
;( )
}* +
public 

bool 
ShowGuestSelection "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

bool 
ShowTableSelection "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

bool 
KitchenMode 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
DefaultFontSize !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$str2 6
;6 7
public 

string 
DefaultFontFamily #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
$str4 >
;> ?
} ˛
äC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\SystemConfig\RestaurantConfigurationDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
SystemConfig$ 0
;0 1
public 
class &
RestaurantConfigurationDto '
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

string 
Address 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
public 

string 
Phone 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public		 

string		 
Website		 
{		 
get		 
;		  
set		! $
;		$ %
}		& '
=		( )
string		* 0
.		0 1
Empty		1 6
;		6 7
public

 

string

  
ReceiptFooterMessage

 &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
=

5 6
string

7 =
.

= >
Empty

> C
;

C D
public 

string 
TaxId 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public 

string 
ZipCode 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
public 

int 
Capacity 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
CurrencySymbol  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
$str1 4
;4 5
public 

decimal #
ServiceChargePercentage *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 

decimal %
DefaultGratuityPercentage ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 

bool 
IsKioskMode 
{ 
get !
;! "
set# &
;& '
}( )
} ∫2
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\SystemConfig\PrinterDtos.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
SystemConfig$ 0
;0 1
public 
class 
PrinterGroupDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public		 

string		 
Name		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
=		% &
string		' -
.		- .
Empty		. 3
;		3 4
public

 

PrinterType

 
PrinterType

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
public 

string 
PrinterTypeString #
{ 
get 
=> 
PrinterType 
. 
ToString #
(# $
)$ %
;% &
set 
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
value& +
)+ ,
&&- /
Enum0 4
.4 5
TryParse5 =
<= >
PrinterType> I
>I J
(J K
valueK P
,P Q
outR U
varV Y
resultZ `
)` a
)a b
{ 
PrinterType 
= 
result $
;$ %
} 
} 	
} 
public 

Domain 
. 
Enumerations 
. 
CutBehavior *
CutBehavior+ 6
{7 8
get9 <
;< =
set> A
;A B
}C D
=E F
DomainG M
.M N
EnumerationsN Z
.Z [
CutBehavior[ f
.f g
Autog k
;k l
public 

bool 

ShowPrices 
{ 
get  
;  !
set" %
;% &
}' (
=) *
true+ /
;/ 0
public 

int 

RetryCount 
{ 
get 
;  
set! $
;$ %
}& '
public 

int 
RetryDelayMs 
{ 
get !
;! "
set# &
;& '
}( )
public 

bool 
AllowReprint 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
true- 1
;1 2
public 

Guid 
? "
FallbackPrinterGroupId '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public!! 

Guid!! 
?!! 
KitchenTemplateId!! "
{!!# $
get!!% (
;!!( )
set!!* -
;!!- .
}!!/ 0
public"" 

Guid"" 
?"" 
ReceiptTemplateId"" "
{""# $
get""% (
;""( )
set""* -
;""- .
}""/ 0
}## 
public%% 
class%% 
PrinterMappingDto%% 
{&& 
public'' 

Guid'' 
Id'' 
{'' 
get'' 
;'' 
set'' 
;'' 
}''  
public(( 

Guid(( 

TerminalId(( 
{(( 
get((  
;((  !
set((" %
;((% &
}((' (
public)) 

Guid)) 
PrinterGroupId)) 
{))  
get))! $
;))$ %
set))& )
;))) *
}))+ ,
public** 

string** 
PhysicalPrinterName** %
{**& '
get**( +
;**+ ,
set**- 0
;**0 1
}**2 3
=**4 5
string**6 <
.**< =
Empty**= B
;**B C
public++ 

PrinterFormat++ 
Format++ 
{++  !
get++" %
;++% &
set++' *
;++* +
}++, -
=++. /
PrinterFormat++0 =
.++= >
Thermal80mm++> I
;++I J
public,, 

bool,, 

CutEnabled,, 
{,, 
get,,  
;,,  !
set,," %
;,,% &
},,' (
=,,) *
true,,+ /
;,,/ 0
public// 

int// 
PaperWidthMm// 
{// 
get// !
;//! "
set//# &
;//& '
}//( )
=//* +
$num//, .
;//. /
public00 

int00 
PrintableWidthChars00 "
{00# $
get00% (
;00( )
set00* -
;00- .
}00/ 0
=001 2
$num003 5
;005 6
public11 

int11 
Dpi11 
{11 
get11 
;11 
set11 
;11 
}11  
=11! "
$num11# &
;11& '
public22 

bool22 
SupportsCashDrawer22 "
{22# $
get22% (
;22( )
set22* -
;22- .
}22/ 0
=221 2
true223 7
;227 8
public33 

bool33 
SupportsImages33 
{33  
get33! $
;33$ %
set33& )
;33) *
}33+ ,
=33- .
true33/ 3
;333 4
public44 

bool44 

SupportsQr44 
{44 
get44  
;44  !
set44" %
;44% &
}44' (
=44) *
true44+ /
;44/ 0
public77 

string77 
PrinterGroupName77 "
{77# $
get77% (
;77( )
set77* -
;77- .
}77/ 0
=771 2
string773 9
.779 :
Empty77: ?
;77? @
public88 

string88 
PrinterName88 
{99 
get:: 
=>:: 
PhysicalPrinterName:: "
;::" #
set;; 
=>;; 
PhysicalPrinterName;; "
=;;# $
value;;% *
;;;* +
}<< 
}== å
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\SystemConfig\CardConfigDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
SystemConfig$ 0
;0 1
public 
class 
CardConfigDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public		 

string		 
ProviderName		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
=		- .
string		/ 5
.		5 6
Empty		6 ;
;		; <
public

 

string

 

MerchantId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
=

+ ,
string

- 3
.

3 4
Empty

4 9
;

9 :
public 

string 
ApiKey 
{ 
get 
; 
set  #
;# $
}% &
=' (
string) /
./ 0
Empty0 5
;5 6
public 

string 

GatewayUrl 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
CardTypesAccepted #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
$str4 G
;G H
public 

decimal 
SignatureThreshold %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
$num6 <
;< =
public 

bool 
AllowTipAdjustment "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
true3 7
;7 8
public 

bool 
IsExternalTerminal "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
false3 8
;8 9
public 

bool 
AllowManualEntry  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
true1 5
;5 6
public 

bool 
EnablePreAuth 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
false. 3
;3 4
} ˇ
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\ShiftDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
ShiftDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public		 

string		 
Name		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
=		% &
null		' +
!		+ ,
;		, -
public

 

TimeSpan

 
	StartTime

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 

TimeSpan 
EndTime 
{ 
get !
;! "
set# &
;& '
}( )
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
} 
public 
class 
ShiftReportDto 
{ 
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
	ShiftName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
public 

DateTime 
? 
	StartDate 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
EndDate 
{ 
get "
;" #
set$ '
;' (
}) *
public 

int 
TicketCount 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
ClosedTicketCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

decimal 

TotalSales 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
TotalCashSales !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
TotalCardSales !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

int 
CashSessionCount 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
TotalCashReceipts $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

decimal 
TotalCashRefunds #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public   

List   
<   
	TicketDto   
>   
Tickets   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
=  1 2
new  3 6
(  6 7
)  7 8
;  8 9
public!! 

List!! 
<!! 
CashSessionDto!! 
>!! 
CashSessions!!  ,
{!!- .
get!!/ 2
;!!2 3
set!!4 7
;!!7 8
}!!9 :
=!!; <
new!!= @
(!!@ A
)!!A B
;!!B C
}"" ‰
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\ServerSectionDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
ServerSectionDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public		 

string		 
Name		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
=		% &
string		' -
.		- .
Empty		. 3
;		3 4
public

 

string

 
Description

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
=

, -
string

. 4
.

4 5
Empty

5 :
;

: ;
public 

Guid 
ServerId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 

ServerName 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

List 
< 
Guid 
> 
TableIds 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
new/ 2
(2 3
)3 4
;4 5
public 

int 

TableCount 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Color 
{ 
get 
; 
set "
;" #
}$ %
=& '
$str( 1
;1 2
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
	UpdatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

int 
Version 
{ 
get 
; 
set !
;! "
}# $
} 
public 
class 
ServerAssignmentDto  
{ 
public 

Guid 
ServerId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 

ServerName 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

List 
< 
ServerSectionDto  
>  !
Sections" *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
=9 :
new; >
(> ?
)? @
;@ A
public 

int 
TotalTables 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
} ´2
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\TipReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
TipReportDto 
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public 

List 
< %
TipReportServerSummaryDto )
>) *
ServerSummaries+ :
{; <
get= @
;@ A
setB E
;E F
}G H
=I J
newK N
(N O
)O P
;P Q
public 

List 
< 
TipReportDataDto  
>  !
Details" )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
new: =
(= >
)> ?
;? @
public

 

int

 
CashTipsCount

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 

decimal 
CashTipsAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

int 
ChargedTipsCount 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
ChargedTipsAmount $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

decimal 
	TotalTips 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
TotalAutoGratuity $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

decimal 
AverageTips 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
PaidTips 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
TipsDue 
{ 
get  
;  !
set" %
;% &
}' (
} 
public 
class 
TipReportDataDto 
{ 
public 

string 
TicketId 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
SaleType 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

decimal 
TicketTotal 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
CashTips 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
ChargedTips 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
AutoGratuity 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
Tips 
{ 
get 
; 
set "
;" #
}$ %
public 

decimal 
TipPercentage  
=>! #
TicketTotal$ /
>0 1
$num2 3
?4 5
(6 7
Tips7 ;
/< =
TicketTotal> I
)I J
*K L
$numM P
:Q R
$numS T
;T U
public 

bool 
IsPaid 
{ 
get 
; 
set !
;! "
}# $
public   

string   

ServerName   
{   
get   "
;  " #
set  $ '
;  ' (
}  ) *
=  + ,
string  - 3
.  3 4
Empty  4 9
;  9 :
}!! 
public## 
class## %
TipReportServerSummaryDto## &
{$$ 
public%% 

string%% 

ServerName%% 
{%% 
get%% "
;%%" #
set%%$ '
;%%' (
}%%) *
=%%+ ,
string%%- 3
.%%3 4
Empty%%4 9
;%%9 :
public&& 

int&& 
TicketCount&& 
{&& 
get&&  
;&&  !
set&&" %
;&&% &
}&&' (
public'' 

decimal'' 

TotalSales'' 
{'' 
get''  #
;''# $
set''% (
;''( )
}''* +
public(( 

decimal(( 
CashTips(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
public)) 

decimal)) 
ChargedTips)) 
{))  
get))! $
;))$ %
set))& )
;))) *
}))+ ,
public** 

decimal** 
AutoGratuity** 
{**  !
get**" %
;**% &
set**' *
;*** +
}**, -
public++ 

decimal++ 
	TotalTips++ 
{++ 
get++ "
;++" #
set++$ '
;++' (
}++) *
public,, 

decimal,, 
TipPercentage,,  
=>,,! #

TotalSales,,$ .
>,,/ 0
$num,,1 2
?,,3 4
(,,5 6
	TotalTips,,6 ?
/,,@ A

TotalSales,,B L
),,L M
*,,N O
$num,,P S
:,,T U
$num,,V W
;,,W X
}-- ·"
ÜC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\ServerProductivityReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class '
ServerProductivityReportDto (
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public		 

List		 
<		 !
ServerProductivityDto		 %
>		% &
Servers		' .
{		/ 0
get		1 4
;		4 5
set		6 9
;		9 :
}		; <
=		= >
new		? B
(		B C
)		C D
;		D E
public

 
'
ServerProductivityTotalsDto

 &
Totals

' -
{

. /
get

0 3
;

3 4
set

5 8
;

8 9
}

: ;
=

< =
new

> A
(

A B
)

B C
;

C D
} 
public 
class !
ServerProductivityDto "
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
public 

string 
UserName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

int 
TicketCount 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 

TotalSales 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
NetSales 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
TipsCollected  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

decimal 
AverageTicketSize $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

decimal  
AverageTipPercentage '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 

decimal 
SalesPerHour 
{  !
get" %
;% &
set' *
;* +
}, -
public 

double 

TotalHours 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 
class '
ServerProductivityTotalsDto (
{ 
public 

int 
TotalServers 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
TotalTickets 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 

TotalSales 
{ 
get  #
;# $
set% (
;( )
}* +
public   

decimal   
TotalNetSales    
{  ! "
get  # &
;  & '
set  ( +
;  + ,
}  - .
public!! 

decimal!! 
	TotalTips!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
public"" 

decimal"" 
AverageTicketSize"" $
{""% &
get""' *
;""* +
set"", /
;""/ 0
}""1 2
public## 

decimal##  
AverageTipPercentage## '
{##( )
get##* -
;##- .
set##/ 2
;##2 3
}##4 5
public$$ 

decimal$$ 
AverageSalesPerHour$$ &
{$$' (
get$$) ,
;$$, -
set$$. 1
;$$1 2
}$$3 4
}%% ó
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\SalesSummaryReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class !
SalesSummaryReportDto "
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public		 

List		 
<		 
SalesCategoryDto		  
>		  !

Categories		" ,
{		- .
get		/ 2
;		2 3
set		4 7
;		7 8
}		9 :
=		; <
new		= @
(		@ A
)		A B
;		B C
public

 

SalesTotalsDto

 
Totals

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
=

/ 0
new

1 4
(

4 5
)

5 6
;

6 7
} 
public 
class 
SalesCategoryDto 
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

int 
MainItemCount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 

GrossSales 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
NetSales 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
	TaxAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

List 
< 
SalesGroupDto 
> 
Groups %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
new6 9
(9 :
): ;
;; <
} 
public 
class 
SalesGroupDto 
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

int 
	ItemCount 
{ 
get 
; 
set  #
;# $
}% &
public 

decimal 

GrossSales 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 
class 
SalesTotalsDto 
{   
public!! 

int!! 
TotalItemCount!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
public"" 

decimal"" 
TotalGrossSales"" "
{""# $
get""% (
;""( )
set""* -
;""- .
}""/ 0
public## 

decimal## 
TotalNetSales##  
{##! "
get### &
;##& '
set##( +
;##+ ,
}##- .
public$$ 

decimal$$ 
TotalTax$$ 
{$$ 
get$$ !
;$$! "
set$$# &
;$$& '
}$$( )
}%% Ã#
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\SalesDetailReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class  
SalesDetailReportDto !
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public		 

List		 
<		 
SalesDetailItemDto		 "
>		" #
Items		$ )
{		* +
get		, /
;		/ 0
set		1 4
;		4 5
}		6 7
=		8 9
new		: =
(		= >
)		> ?
;		? @
public

 
 
SalesDetailTotalsDto

 
Totals

  &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
=

5 6
new

7 :
(

: ;
)

; <
;

< =
} 
public 
class 
SalesDetailItemDto 
{ 
public 

DateTime 

TicketTime 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
TicketNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

string 
ItemName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
CategoryName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

string 
	GroupName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

int 
Quantity 
{ 
get 
; 
set "
;" #
}$ %
public 

decimal 
	UnitPrice 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
GrossAmount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
DiscountAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
	NetAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
	TaxAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

string 
UserName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
} 
public 
class  
SalesDetailTotalsDto !
{ 
public 

int 

TotalItems 
{ 
get 
;  
set! $
;$ %
}& '
public   

decimal   
TotalGrossSales   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
public!! 

decimal!! 
TotalDiscounts!! !
{!!" #
get!!$ '
;!!' (
set!!) ,
;!!, -
}!!. /
public"" 

decimal"" 
TotalNetSales""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
public## 

decimal## 
TotalTax## 
{## 
get## !
;##! "
set### &
;##& '
}##( )
}$$ ˚!
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\SalesBalanceReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class !
SalesBalanceReportDto "
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public		 

DateTime		 
EndDate		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public 

SalesSummaryDto 
Sales  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
new1 4
(4 5
)5 6
;6 7
public 

PaymentSummaryDto 
Payments %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
new6 9
(9 :
): ;
;; <
public 

decimal 
Variance 
=> 
Payments '
.' (
NetCollected( 4
-5 6
Sales7 <
.< =
TotalGrossSales= L
;L M
} 
public 
class 
SalesSummaryDto 
{ 
public 

int 
TicketCount 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
TotalGrossSales "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

decimal 
NetSales 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
	TaxAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
DiscountAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
GratuityAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
ServiceChargeAmount &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 

decimal  
DeliveryChargeAmount '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
} 
public 
class 
PaymentSummaryDto 
{ 
public 

decimal 
TotalCollected !
{" #
get$ '
;' (
set) ,
;, -
}. /
public   

decimal   
TotalRefunded    
{  ! "
get  # &
;  & '
set  ( +
;  + ,
}  - .
public!! 

decimal!! 
NetCollected!! 
=>!!  "
TotalCollected!!# 1
-!!2 3
TotalRefunded!!4 A
;!!A B
public## 

List## 
<## !
PaymentTypeSummaryDto## %
>##% &
ByType##' -
{##. /
get##0 3
;##3 4
set##5 8
;##8 9
}##: ;
=##< =
new##> A
(##A B
)##B C
;##C D
}$$ 
public&& 
class&& !
PaymentTypeSummaryDto&& "
{'' 
public(( 

string(( 
PaymentType(( 
{(( 
get((  #
;((# $
set((% (
;((( )
}((* +
=((, -
string((. 4
.((4 5
Empty((5 :
;((: ;
public)) 

decimal)) 
Amount)) 
{)) 
get)) 
;))  
set))! $
;))$ %
}))& '
public** 

int** 
Count** 
{** 
get** 
;** 
set** 
;**  
}**! "
}++ Û
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\ProductivityReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class !
ProductivityReportDto "
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public 

List 
< !
ServerProductivityDto %
>% &
ServerStats' 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
=A B
newC F
(F G
)G H
;H I
} æ"
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\PaymentReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
PaymentReportDto 
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public		 

List		 
<		 
PaymentTypeTotalDto		 #
>		# $
PaymentTypes		% 1
{		2 3
get		4 7
;		7 8
set		9 <
;		< =
}		> ?
=		@ A
new		B E
(		E F
)		F G
;		G H
public

 
"
PaymentReportTotalsDto

 !
Totals

" (
{

) *
get

+ .
;

. /
set

0 3
;

3 4
}

5 6
=

7 8
new

9 <
(

< =
)

= >
;

> ?
} 
public 
class 
PaymentTypeTotalDto  
{ 
public 

string 
PaymentType 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
string. 4
.4 5
Empty5 :
;: ;
public 

string 
SubType 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
public 

int 
TransactionCount 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
TotalAmount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
	TipAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
	NetAmount 
=> 
TotalAmount  +
+, -
	TipAmount. 7
;7 8
} 
public 
class "
PaymentReportTotalsDto #
{ 
public 

int 
TotalTransactions  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

decimal 
	TotalCash 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
TotalCreditCards #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

decimal 
TotalDebitCards "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

decimal !
TotalGiftCertificates (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 

decimal 
TotalHouseAccounts %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

decimal 
TotalChecks 
{  
get! $
;$ %
set& )
;) *
}+ ,
public   

decimal   

TotalOther   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
public!! 

decimal!! 

GrandTotal!! 
=>!!  
	TotalCash!!! *
+!!+ ,
TotalCreditCards!!- =
+!!> ?
TotalDebitCards!!@ O
+!!P Q!
TotalGiftCertificates!!R g
+!!h i
TotalHouseAccounts!!j |
+!!} ~
TotalChecks	!! ä
+
!!ã å

TotalOther
!!ç ó
;
!!ó ò
public"" 

decimal"" 
	TotalTips"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
}## ı
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\LaborReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
LaborReportDto 
{ 
public 

DateTime 
PeriodStart 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
	PeriodEnd 
{ 
get  #
;# $
set% (
;( )
}* +
public		 

List		 
<		 
LaborCostItemDto		  
>		  !

StaffLabor		" ,
{		- .
get		/ 2
;		2 3
set		4 7
;		7 8
}		9 :
=		; <
new		= @
(		@ A
)		A B
;		B C
public

 

decimal

 
TotalLaborCost

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 

decimal 
TotalNetSales  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

decimal 
LaborCostPercentage &
=>' )
TotalNetSales* 7
>8 9
$num: ;
?< =
(> ?
TotalLaborCost? M
/N O
TotalNetSalesP ]
)] ^
*_ `
$numa d
:e f
$numg h
;h i
public 

double 

TotalHours 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
SalesPerLaborHour $
=>% '

TotalHours( 2
>3 4
$num5 6
?7 8
TotalNetSales9 F
/G H
(I J
decimalJ Q
)Q R

TotalHoursR \
:] ^
$num_ `
;` a
} 
public 
class 
LaborCostItemDto 
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
public 

string 
UserName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
RoleName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

double 

TotalHours 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 

HourlyRate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
	TotalCost 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 

TotalSales 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
SalesPerLaborHour $
=>% '

TotalHours( 2
>3 4
$num5 6
?7 8

TotalSales9 C
/D E
(F G
decimalG N
)N O

TotalHoursO Y
:Z [
$num\ ]
;] ^
} ç!
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\MenuUsageReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
MenuUsageReportDto 
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public		 

List		 
<		 
MenuUsageItemDto		  
>		  !
Items		" '
{		( )
get		* -
;		- .
set		/ 2
;		2 3
}		4 5
=		6 7
new		8 ;
(		; <
)		< =
;		= >
public

 

MenuUsageTotalsDto

 
Totals

 $
{

% &
get

' *
;

* +
set

, /
;

/ 0
}

1 2
=

3 4
new

5 8
(

8 9
)

9 :
;

: ;
} 
public 
class 
MenuUsageItemDto 
{ 
public 

string 
ItemName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
CategoryName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

string 
	GroupName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

int 
QuantitySold 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
Revenue 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
PercentageOfTotal $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

decimal 
AveragePrice 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
TicketCount 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool 
IsTopPerformer 
=> !
QuantitySold" .
>/ 0
$num1 2
&&3 5
PercentageOfTotal6 G
>=H J
$numK O
;O P
public 

bool 
IsBottomPerformer !
=>" $
QuantitySold% 1
>2 3
$num4 5
&&6 8
PercentageOfTotal9 J
<=K M
$numN R
;R S
} 
public 
class 
MenuUsageTotalsDto 
{ 
public 

int 

TotalItems 
{ 
get 
;  
set! $
;$ %
}& '
public 

int 
TotalQuantitySold  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

decimal 
TotalRevenue 
{  !
get" %
;% &
set' *
;* +
}, -
public   

int   "
AverageQuantityPerItem   %
{  & '
get  ( +
;  + ,
set  - 0
;  0 1
}  2 3
public!! 

decimal!! !
AverageRevenuePerItem!! (
{!!) *
get!!+ .
;!!. /
set!!0 3
;!!3 4
}!!5 6
}"" é
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\JournalReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
JournalReportDto 
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public 

List 
< 
JournalEntryDto 
>  
Entries! (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
=7 8
new9 <
(< =
)= >
;> ?
} 
public

 
class

 
JournalEntryDto

 
{ 
public 

DateTime 
	Timestamp 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
	EventType 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
string. 4
.4 5
Empty5 :
;: ;
public 

string 
User 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

string 
BeforeState 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
string. 4
.4 5
Empty5 :
;: ;
public 

string 

AfterState 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
} —
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\DeliveryReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
DeliveryReportDto 
{ 
public 

DateTime 
PeriodStart 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
	PeriodEnd 
{ 
get  #
;# $
set% (
;( )
}* +
public		 

int		 
TotalDeliveries		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 

decimal

 
TotalDeliverySales

 %
{

& '
get

( +
;

+ ,
set

- 0
;

0 1
}

2 3
public 

double &
AverageDeliveryTimeMinutes ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 

List 
<  
DriverPerformanceDto $
>$ %
DriverStats& 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
=@ A
newB E
(E F
)F G
;G H
} 
public 
class  
DriverPerformanceDto !
{ 
public 

Guid 
DriverId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 

DriverName 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

int 
DeliveryCount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 

TotalSales 
{ 
get  #
;# $
set% (
;( )
}* +
public 

double 
AverageTimeMinutes $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

decimal 

TipsAmount 
{ 
get  #
;# $
set% (
;( )
}* +
} œ"
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\ExceptionsReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
ExceptionsReportDto  
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public

 

List

 
<

 
VoidItemDto

 
>

 
Voids

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
=

1 2
new

3 6
(

6 7
)

7 8
;

8 9
public 

List 
< 
RefundItemDto 
> 
Refunds &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
(: ;
); <
;< =
public 

List 
< 
DiscountItemDto 
>  
	Discounts! *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
=9 :
new; >
(> ?
)? @
;@ A
} 
public 
class 
VoidItemDto 
{ 
public 

DateTime 
Date 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
TicketNumber 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
Amount 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
VoidedBy 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
Reason 
{ 
get 
; 
set  #
;# $
}% &
=' (
string) /
./ 0
Empty0 5
;5 6
} 
public 
class 
RefundItemDto 
{ 
public 

DateTime 
Date 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
TicketNumber 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
Amount 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
PaymentType 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
string. 4
.4 5
Empty5 :
;: ;
public 

string 
Reason 
{ 
get 
; 
set  #
;# $
}% &
=' (
string) /
./ 0
Empty0 5
;5 6
} 
public!! 
class!! 
DiscountItemDto!! 
{"" 
public## 

DateTime## 
Date## 
{## 
get## 
;## 
set##  #
;### $
}##% &
public$$ 

int$$ 
TicketNumber$$ 
{$$ 
get$$ !
;$$! "
set$$# &
;$$& '
}$$( )
public%% 

string%% 
Name%% 
{%% 
get%% 
;%% 
set%% !
;%%! "
}%%# $
=%%% &
string%%' -
.%%- .
Empty%%. 3
;%%3 4
public&& 

decimal&& 
Amount&& 
{&& 
get&& 
;&&  
set&&! $
;&&$ %
}&&& '
}'' Ÿ!
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\HourlyLaborReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class  
HourlyLaborReportDto !
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public		 

List		 
<		 
HourlyLaborDto		 
>		 
Hours		  %
{		& '
get		( +
;		+ ,
set		- 0
;		0 1
}		2 3
=		4 5
new		6 9
(		9 :
)		: ;
;		; <
public

 
 
HourlyLaborTotalsDto

 
Totals

  &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
=

5 6
new

7 :
(

: ;
)

; <
;

< =
} 
public 
class 
HourlyLaborDto 
{ 
public 

int 
Hour 
{ 
get 
; 
set 
; 
}  !
public 

List 
< 
EmployeeLaborDto  
>  !
	Employees" +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
=: ;
new< ?
(? @
)@ A
;A B
public 

decimal 
TotalLaborHours "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

decimal 
TotalLaborCost !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 

TotalSales 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
LaborPercentage "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

bool !
IsHighLaborPercentage %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 
class 
EmployeeLaborDto 
{ 
public 

Guid 

EmployeeId 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
EmployeeName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

decimal 
HoursWorked 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
	LaborCost 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public   
class    
HourlyLaborTotalsDto   !
{!! 
public"" 

decimal"" 
TotalLaborHours"" "
{""# $
get""% (
;""( )
set""* -
;""- .
}""/ 0
public## 

decimal## 
TotalLaborCost## !
{##" #
get##$ '
;##' (
set##) ,
;##, -
}##. /
public$$ 

decimal$$ 

TotalSales$$ 
{$$ 
get$$  #
;$$# $
set$$% (
;$$( )
}$$* +
public%% 

decimal%% "
AverageLaborPercentage%% )
{%%* +
get%%, /
;%%/ 0
set%%1 4
;%%4 5
}%%6 7
public&& 

int&& 
TotalEmployees&& 
{&& 
get&&  #
;&&# $
set&&% (
;&&( )
}&&* +
}'' ˝/
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\CreditCardReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
CreditCardReportDto  
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public		 

List		 
<		 $
CreditCardTransactionDto		 (
>		( )
Transactions		* 6
{		7 8
get		9 <
;		< =
set		> A
;		A B
}		C D
=		E F
new		G J
(		J K
)		K L
;		L M
public

 

CreditCardTotalsDto

 
Totals

 %
{

& '
get

( +
;

+ ,
set

- 0
;

0 1
}

2 3
=

4 5
new

6 9
(

9 :
)

: ;
;

; <
} 
public 
class $
CreditCardTransactionDto %
{ 
public 

DateTime 
TransactionTime #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

string 
TicketNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

string 
CardType 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
	CardLast4 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

string 
AuthorizationCode #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
string4 :
.: ;
Empty; @
;@ A
public 

decimal 
Amount 
{ 
get 
;  
set! $
;$ %
}& '
public 

decimal 
	TipAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
TotalAmount 
=> !
Amount" (
+) *
	TipAmount+ 4
;4 5
public 

string 
TransactionType !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
string2 8
.8 9
Empty9 >
;> ?
public 

string 
TransactionStatus #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
string4 :
.: ;
Empty; @
;@ A
public 

string 

TerminalId 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

string 

MerchantId 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
} 
public 
class 
CreditCardTotalsDto  
{ 
public 

int 
TotalTransactions  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   

decimal   

TotalSales   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
public!! 

decimal!! 
	TotalTips!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
public"" 

decimal"" 

TotalVoids"" 
{"" 
get""  #
;""# $
set""% (
;""( )
}""* +
public## 

decimal## 
TotalRefunds## 
{##  !
get##" %
;##% &
set##' *
;##* +
}##, -
public$$ 

decimal$$ 
	NetAmount$$ 
=>$$ 

TotalSales$$  *
-$$+ ,

TotalVoids$$- 7
-$$8 9
TotalRefunds$$: F
;$$F G
public&& 

List&& 
<&& 
CardTypeTotalDto&&  
>&&  !

ByCardType&&" ,
{&&- .
get&&/ 2
;&&2 3
set&&4 7
;&&7 8
}&&9 :
=&&; <
new&&= @
(&&@ A
)&&A B
;&&B C
}'' 
public)) 
class)) 
CardTypeTotalDto)) 
{** 
public++ 

string++ 
CardType++ 
{++ 
get++  
;++  !
set++" %
;++% &
}++' (
=++) *
string+++ 1
.++1 2
Empty++2 7
;++7 8
public,, 

int,, 
TransactionCount,, 
{,,  !
get,," %
;,,% &
set,,' *
;,,* +
},,, -
public-- 

decimal-- 
TotalAmount-- 
{--  
get--! $
;--$ %
set--& )
;--) *
}--+ ,
public.. 

decimal.. 
	TipAmount.. 
{.. 
get.. "
;.." #
set..$ '
;..' (
}..) *
}// ß
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\CashOutReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
CashOutReportDto 
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
EndDate 
{ 
get !
;! "
set# &
;& '
}( )
public 

List 
<  
CashOutReportItemDto $
>$ %
Items& +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
=: ;
new< ?
(? @
)@ A
;A B
public

 

decimal

 
TotalCashSales

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 

decimal 
TotalChargedTips #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

decimal 
TotalNetDue 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public 
class  
CashOutReportItemDto !
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
public 

string 
UserName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

int 
TicketCount 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
	CashSales 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
ChargedTips 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
NetDue 
=> 
	CashSales &
-' (
ChargedTips) 4
;4 5
} ﬁ
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Reports\AttendanceReportDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Reports$ +
;+ ,
public 
class 
AttendanceReportDto  
{ 
public 

DateTime 
	StartDate 
{ 
get  #
;# $
set% (
;( )
}* +
public		 

DateTime		 
EndDate		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 

List

 
<

 #
AttendanceReportItemDto

 '
>

' (
Items

) .
{

/ 0
get

1 4
;

4 5
set

6 9
;

9 :
}

; <
=

= >
new

? B
(

B C
)

C D
;

D E
public 

double 

TotalHours 
{ 
get "
;" #
set$ '
;' (
}) *
public 

int 
TotalShifts 
{ 
get  
;  !
set" %
;% &
}' (
} 
public 
class #
AttendanceReportItemDto $
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
public 

string 
UserName 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
Role 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

DateTime 
ClockInTime 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
? 
ClockOutTime !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

double 
HoursWorked 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
	ShiftName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
} ì3
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\Printing\TicketPrintModel.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
.# $
Printing$ ,
;, -
public 
class 
TicketPrintModel 
{ 
public 

string 
TicketNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public		 

string		 
Date		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
=		% &
string		' -
.		- .
Empty		. 3
;		3 4
public

 

string

 
Time

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
=

% &
string

' -
.

- .
Empty

. 3
;

3 4
public 

string 

ServerName 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

string 
	TableName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

string 
Subtotal 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
Tax 
{ 
get 
; 
set  
;  !
}" #
=$ %
string& ,
., -
Empty- 2
;2 3
public 

string 
Total 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public 

string 

BalanceDue 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

List 
< 
OrderLinePrintModel #
># $
Lines% *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
=9 :
new; >
(> ?
)? @
;@ A
public 

List 
< 
PaymentPrintModel !
>! "
Payments# +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
=: ;
new< ?
(? @
)@ A
;A B
public 
 
RestaurantPrintModel 

Restaurant  *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
=9 :
new; >
(> ?
)? @
;@ A
public 

bool 
IsRefund 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
	IsReprint 
{ 
get 
;  
set! $
;$ %
}& '
}   
public"" 
class"" 
OrderLinePrintModel""  
{## 
public$$ 

decimal$$ 
Quantity$$ 
{$$ 
get$$ !
;$$! "
set$$# &
;$$& '
}$$( )
public%% 

string%% 
Name%% 
{%% 
get%% 
;%% 
set%% !
;%%! "
}%%# $
=%%% &
string%%' -
.%%- .
Empty%%. 3
;%%3 4
public&& 

string&& 
Price&& 
{&& 
get&& 
;&& 
set&& "
;&&" #
}&&$ %
=&&& '
string&&( .
.&&. /
Empty&&/ 4
;&&4 5
public'' 

string'' 
Total'' 
{'' 
get'' 
;'' 
set'' "
;''" #
}''$ %
=''& '
string''( .
.''. /
Empty''/ 4
;''4 5
public(( 

List(( 
<(( 
string(( 
>(( 
	Modifiers(( !
{((" #
get(($ '
;((' (
set(() ,
;((, -
}((. /
=((0 1
new((2 5
(((5 6
)((6 7
;((7 8
public)) 

string)) 
Instructions)) 
{))  
get))! $
;))$ %
set))& )
;))) *
}))+ ,
=))- .
string))/ 5
.))5 6
Empty))6 ;
;)); <
}** 
public,, 
class,, 
PaymentPrintModel,, 
{-- 
public.. 

string.. 
Type.. 
{.. 
get.. 
;.. 
set.. !
;..! "
}..# $
=..% &
string..' -
...- .
Empty... 3
;..3 4
public// 

string// 
Amount// 
{// 
get// 
;// 
set//  #
;//# $
}//% &
=//' (
string//) /
./// 0
Empty//0 5
;//5 6
}00 
public22 
class22  
RestaurantPrintModel22 !
{33 
public44 

string44 
Name44 
{44 
get44 
;44 
set44 !
;44! "
}44# $
=44% &
string44' -
.44- .
Empty44. 3
;443 4
public55 

string55 
Address55 
{55 
get55 
;55  
set55! $
;55$ %
}55& '
=55( )
string55* 0
.550 1
Empty551 6
;556 7
public66 

string66 
Phone66 
{66 
get66 
;66 
set66 "
;66" #
}66$ %
=66& '
string66( .
.66. /
Empty66/ 4
;664 5
}77 ˜
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\PaymentDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 

PaymentDto 
{		 
public

 

Guid

 
Id

 
{

 
get

 
;

 
set

 
;

 
}

  
public 

string 
? 
GlobalId 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

TransactionType 
TransactionType *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 

PaymentType 
PaymentType "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

decimal 
Amount 
{ 
get 
;  
set! $
;$ %
}& '
public 

decimal 

TipsAmount 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
TenderAmount 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
ChangeAmount 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
TransactionTime #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

Guid 
ProcessedBy 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool 

IsCaptured 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool 
IsVoided 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
IsAuthorizable 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

Guid 
? 
CashSessionId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
Note 
{ 
get 
; 
set "
;" #
}$ %
} ú
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\OrderTypeDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
OrderTypeDto 
{		 
public

 

Guid

 
Id

 
{

 
get

 
;

 
set

 
;

 
}

  
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public 

bool 
CloseOnPaid 
{ 
get !
;! "
set# &
;& '
}( )
public 

bool 
AllowSeatBasedOrder #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

bool 
AllowToAddTipsLater #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

bool 
IsBarTab 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 


Dictionary 
< 
string 
, 
string $
>$ %

Properties& 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
=? @
newA D
(D E
)E F
;F G
public 

string 
? 
GetProperty 
( 
string %
key& )
)) *
{ 
return 

Properties 
. 
TryGetValue %
(% &
key& )
,) *
out+ .
var/ 2
value3 8
)8 9
?: ;
value< A
:B C
nullD H
;H I
} 
public 

bool 
RequiresTable 
=>  
GetProperty! ,
(, -
$str- <
)< =
?= >
.> ?
ToLower? F
(F G
)G H
==I K
$strL R
;R S
public 

bool 
RequiresCustomer  
=>! #
GetProperty$ /
(/ 0
$str0 B
)B C
?C D
.D E
ToLowerE L
(L M
)M N
==O Q
$strR X
;X Y
} –
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\OrderLineModifierDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class  
OrderLineModifierDto !
{		 
public

 

Guid

 
Id

 
{

 
get

 
;

 
set

 
;

 
}

  
public 

Guid 
OrderLineId 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 
? 

ModifierId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

ModifierType 
ModifierType $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

int 
	ItemCount 
{ 
get 
; 
set  #
;# $
}% &
public 

decimal 
	UnitPrice 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
TaxRate 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
	TaxAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
TotalAmount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
SectionName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

bool  
ShouldPrintToKitchen $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
} °&
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\OrderLineDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
OrderLineDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public		 

Guid		 
TicketId		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 

Guid

 

MenuItemId

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 

string 
MenuItemName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

string 
? 
CategoryName 
{  !
get" %
;% &
set' *
;* +
}, -
public 

string 
? 
	GroupName 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
	ItemCount 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
ItemUnitName 
{  !
get" %
;% &
set' *
;* +
}, -
public 

bool 
IsFractionalUnit  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

decimal 
	UnitPrice 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
SubtotalAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
DiscountAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
TaxRate 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
	TaxAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
TotalAmount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

bool 

IsBeverage 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool  
ShouldPrintToKitchen $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

bool 
PrintedToKitchen  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

Guid 
? 
PrinterGroupId 
{  !
get" %
;% &
set' *
;* +
}, -
public 

string 
? 
Instructions 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
? 

SeatNumber 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool 
TreatAsSeat 
{ 
get !
;! "
set# &
;& '
}( )
public 

List 
<  
OrderLineModifierDto $
>$ %
	Modifiers& /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
=> ?
new@ C
(C D
)D E
;E F
public   

List   
<    
OrderLineModifierDto   $
>  $ %
AddOns  & ,
{  - .
get  / 2
;  2 3
set  4 7
;  7 8
}  9 :
=  ; <
new  = @
(  @ A
)  A B
;  B C
public!! 

DateTime!! 
	CreatedAt!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
}"" ¿
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\MenuGroupDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
MenuGroupDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

Guid 

CategoryId 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
CategoryName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public		 

int		 
	SortOrder		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 

bool

 
	IsVisible

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

string 
? 
ButtonColor 
{  
get! $
;$ %
set& )
;) *
}+ ,
} “

rC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\MenuCategoryDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
MenuCategoryDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

int 
	SortOrder 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
	IsVisible 
{ 
get 
;  
set! $
;$ %
}& '
public		 

bool		 

IsBeverage		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 

string

 
?

 
ButtonColor

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
} ò
nC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\GratuityDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
GratuityDto 
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public		 

Guid		 
TicketId		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 

decimal

 
Amount

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

bool 
Paid 
{ 
get 
; 
set 
;  
}! "
public 

bool 
Refunded 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
OwnerId 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
} •
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\CashTransactionUiDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class  
CashTransactionUiDto !
{ 
public 

Guid 
Id 
{ 
get 
; 
set 
; 
}  
public 

DateTime 
ProcessedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public		 

string		 
ProcessedBy		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
=		, -
string		. 4
.		4 5
Empty		5 :
;		: ;
public

 

decimal

 
Amount

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Type 
{ 
get 
; 
set !
;! "
}# $
=% &
$str' -
;- .
public 

string 
TimeDisplay 
=>  
ProcessedAt! ,
., -
ToLocalTime- 8
(8 9
)9 :
.: ;
ToString; C
(C D
$strD K
)K L
;L M
} ‰Q
qC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DTOs\CashSessionDto.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DTOs #
;# $
public 
class 
CashSessionDto 
{		 
public

 

Guid

 
Id

 
{

 
get

 
;

 
set

 
;

 
}

  
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
OpenedAt 
{ 
get "
;" #
set$ '
;' (
}) *
public 

DateTime 
? 
ClosedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Guid 
? 
ClosedBy 
{ 
get 
;  
set! $
;$ %
}& '
public 

decimal 
OpeningBalance !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal 
ExpectedCash 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
? 

ActualCash 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
? 

Difference 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

CashSessionStatus 
Status #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

List 
< 
	PayoutDto 
> 
Payouts "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
new3 6
(6 7
)7 8
;8 9
public 

List 
< 
CashDropDto 
> 
	CashDrops &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
(: ;
); <
;< =
public 

List 
< 
DrawerBleedDto 
> 
DrawerBleeds  ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
=; <
new= @
(@ A
)A B
;B C
public 

int 
PaymentCount 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
TotalCashReceipts $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

decimal 
TotalCashRefunds #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
public!! 
class!! 
	PayoutDto!! 
{"" 
public## 

Guid## 
Id## 
{## 
get## 
;## 
set## 
;## 
}##  
public$$ 

Guid$$ 
CashSessionId$$ 
{$$ 
get$$  #
;$$# $
set$$% (
;$$( )
}$$* +
public%% 

decimal%% 
Amount%% 
{%% 
get%% 
;%%  
set%%! $
;%%$ %
}%%& '
public&& 

string&& 
?&& 
Reason&& 
{&& 
get&& 
;&&  
set&&! $
;&&$ %
}&&& '
public'' 

Guid'' 
ProcessedBy'' 
{'' 
get'' !
;''! "
set''# &
;''& '
}''( )
public(( 

DateTime(( 
ProcessedAt(( 
{((  !
get((" %
;((% &
set((' *
;((* +
}((, -
})) 
public.. 
class.. 
CashDropDto.. 
{// 
public00 

Guid00 
Id00 
{00 
get00 
;00 
set00 
;00 
}00  
public11 

Guid11 
CashSessionId11 
{11 
get11  #
;11# $
set11% (
;11( )
}11* +
public22 

decimal22 
Amount22 
{22 
get22 
;22  
set22! $
;22$ %
}22& '
public33 

string33 
?33 
Reason33 
{33 
get33 
;33  
set33! $
;33$ %
}33& '
public44 

Guid44 
ProcessedBy44 
{44 
get44 !
;44! "
set44# &
;44& '
}44( )
public55 

DateTime55 
ProcessedAt55 
{55  !
get55" %
;55% &
set55' *
;55* +
}55, -
}66 
public;; 
class;; 
DrawerBleedDto;; 
{<< 
public== 

Guid== 
Id== 
{== 
get== 
;== 
set== 
;== 
}==  
public>> 

Guid>> 
CashSessionId>> 
{>> 
get>>  #
;>># $
set>>% (
;>>( )
}>>* +
public?? 

decimal?? 
Amount?? 
{?? 
get?? 
;??  
set??! $
;??$ %
}??& '
public@@ 

string@@ 
?@@ 
Reason@@ 
{@@ 
get@@ 
;@@  
set@@! $
;@@$ %
}@@& '
publicAA 

GuidAA 
ProcessedByAA 
{AA 
getAA !
;AA! "
setAA# &
;AA& '
}AA( )
publicBB 

DateTimeBB 
ProcessedAtBB 
{BB  !
getBB" %
;BB% &
setBB' *
;BB* +
}BB, -
}CC 
publicHH 
classHH 
DrawerPullReportDtoHH  
{II 
publicJJ 

GuidJJ 
CashSessionIdJJ 
{JJ 
getJJ  #
;JJ# $
setJJ% (
;JJ( )
}JJ* +
publicKK 

GuidKK 
UserIdKK 
{KK 
getKK 
;KK 
setKK !
;KK! "
}KK# $
publicLL 

DateTimeLL 
OpenedAtLL 
{LL 
getLL "
;LL" #
setLL$ '
;LL' (
}LL) *
publicMM 

DateTimeMM 
?MM 
ClosedAtMM 
{MM 
getMM  #
;MM# $
setMM% (
;MM( )
}MM* +
publicNN 

decimalNN 
OpeningBalanceNN !
{NN" #
getNN$ '
;NN' (
setNN) ,
;NN, -
}NN. /
publicOO 

decimalOO 
ExpectedCashOO 
{OO  !
getOO" %
;OO% &
setOO' *
;OO* +
}OO, -
publicPP 

decimalPP 
?PP 

ActualCashPP 
{PP  
getPP! $
;PP$ %
setPP& )
;PP) *
}PP+ ,
publicQQ 

decimalQQ 
?QQ 

DifferenceQQ 
{QQ  
getQQ! $
;QQ$ %
setQQ& )
;QQ) *
}QQ+ ,
publicRR 

decimalRR 
TotalCashReceiptsRR $
{RR% &
getRR' *
;RR* +
setRR, /
;RR/ 0
}RR1 2
publicSS 

decimalSS 
TotalCashRefundsSS #
{SS$ %
getSS& )
;SS) *
setSS+ .
;SS. /
}SS0 1
publicTT 

decimalTT 
TotalPayoutsTT 
{TT  !
getTT" %
;TT% &
setTT' *
;TT* +
}TT, -
publicUU 

decimalUU 
TotalCashDropsUU !
{UU" #
getUU$ '
;UU' (
setUU) ,
;UU, -
}UU. /
publicVV 

decimalVV 
TotalDrawerBleedsVV $
{VV% &
getVV' *
;VV* +
setVV, /
;VV/ 0
}VV1 2
publicWW 

decimalWW 
NetSalesWW 
{WW 
getWW !
;WW! "
setWW# &
;WW& '
}WW( )
publicXX 

decimalXX 
TaxXX 
{XX 
getXX 
;XX 
setXX !
;XX! "
}XX# $
publicYY 

decimalYY 
	TotalTipsYY 
{YY 
getYY "
;YY" #
setYY$ '
;YY' (
}YY) *
publicZZ 

ListZZ 
<ZZ 
	PayoutDtoZZ 
>ZZ 
PayoutsZZ "
{ZZ# $
getZZ% (
;ZZ( )
setZZ* -
;ZZ- .
}ZZ/ 0
=ZZ1 2
newZZ3 6
(ZZ6 7
)ZZ7 8
;ZZ8 9
public[[ 

List[[ 
<[[ 
CashDropDto[[ 
>[[ 
	CashDrops[[ &
{[[' (
get[[) ,
;[[, -
set[[. 1
;[[1 2
}[[3 4
=[[5 6
new[[7 :
([[: ;
)[[; <
;[[< =
public\\ 

List\\ 
<\\ 
DrawerBleedDto\\ 
>\\ 
DrawerBleeds\\  ,
{\\- .
get\\/ 2
;\\2 3
set\\4 7
;\\7 8
}\\9 :
=\\; <
new\\= @
(\\@ A
)\\A B
;\\B C
public]] 

int]] 
CashPaymentCount]] 
{]]  !
get]]" %
;]]% &
set]]' *
;]]* +
}]], -
}^^ ©Ò
çC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\DependencyInjection\ServiceCollectionExtensions.cs
	namespace 	
Magidesk
 
. 
Application 
. 
DependencyInjection 2
;2 3
public 
static 
class '
ServiceCollectionExtensions /
{ 
public 

static 
IServiceCollection $
AddApplication% 3
(3 4
this4 8
IServiceCollection9 K
servicesL T
)T U
{ 
services 
. 

AddMediatR 
( 
cfg 
=>  "
{ 	
cfg 
. (
RegisterServicesFromAssembly ,
(, -
typeof- 3
(3 4'
ServiceCollectionExtensions4 O
)O P
.P Q
AssemblyQ Y
)Y Z
;Z [
} 	
)	 

;
 
services!! 
.!! 
	AddScoped!! 
<!! 
ICommandHandler!! *
<!!* +
Commands!!+ 3
.!!3 4
CreateTicketCommand!!4 G
,!!G H
Commands!!I Q
.!!Q R
CreateTicketResult!!R d
>!!d e
,!!e f'
CreateTicketCommandHandler	!!g Å
>
!!Å Ç
(
!!Ç É
)
!!É Ñ
;
!!Ñ Ö
services"" 
."" 
	AddScoped"" 
<"" 
ICommandHandler"" *
<""* +
Commands""+ 3
.""3 4
AddOrderLineCommand""4 G
,""G H
Commands""I Q
.""Q R
AddOrderLineResult""R d
>""d e
,""e f'
AddOrderLineCommandHandler	""g Å
>
""Å Ç
(
""Ç É
)
""É Ñ
;
""Ñ Ö
services## 
.## 
	AddScoped## 
<## 
ICommandHandler## *
<##* +
Commands##+ 3
.##3 4!
ProcessPaymentCommand##4 I
,##I J
Commands##K S
.##S T 
ProcessPaymentResult##T h
>##h i
,##i j)
ProcessPaymentCommandHandler	##k á
>
##á à
(
##à â
)
##â ä
;
##ä ã
services&& 
.&& 
	AddScoped&& 
<&& 
ICommandHandler&& *
<&&* +
Commands&&+ 3
.&&3 4'
AuthorizeCardPaymentCommand&&4 O
,&&O P
Commands&&Q Y
.&&Y Z&
AuthorizeCardPaymentResult&&Z t
>&&t u
,&&u v/
"AuthorizeCardPaymentCommandHandler	&&w ô
>
&&ô ö
(
&&ö õ
)
&&õ ú
;
&&ú ù
services'' 
.'' 
	AddScoped'' 
<'' 
ICommandHandler'' *
<''* +
Commands''+ 3
.''3 4%
CaptureCardPaymentCommand''4 M
,''M N
Commands''O W
.''W X$
CaptureCardPaymentResult''X p
>''p q
,''q r-
 CaptureCardPaymentCommandHandler	''s ì
>
''ì î
(
''î ï
)
''ï ñ
;
''ñ ó
services(( 
.(( 
	AddScoped(( 
<(( 
ICommandHandler(( *
<((* +
Commands((+ 3
.((3 4"
VoidCardPaymentCommand((4 J
,((J K
Commands((L T
.((T U!
VoidCardPaymentResult((U j
>((j k
,((k l*
VoidCardPaymentCommandHandler	((m ä
>
((ä ã
(
((ã å
)
((å ç
;
((ç é
services)) 
.)) 
	AddScoped)) 
<)) 
ICommandHandler)) *
<))* +
Commands))+ 3
.))3 4'
AddTipsToCardPaymentCommand))4 O
,))O P
Commands))Q Y
.))Y Z&
AddTipsToCardPaymentResult))Z t
>))t u
,))u v/
"AddTipsToCardPaymentCommandHandler	))w ô
>
))ô ö
(
))ö õ
)
))õ ú
;
))ú ù
services,, 
.,, 
	AddScoped,, 
<,, 
ICommandHandler,, *
<,,* +
Commands,,+ 3
.,,3 4 
RefundPaymentCommand,,4 H
,,,H I
Commands,,J R
.,,R S
RefundPaymentResult,,S f
>,,f g
,,,g h(
RefundPaymentCommandHandler	,,i Ñ
>
,,Ñ Ö
(
,,Ö Ü
)
,,Ü á
;
,,á à
services-- 
.-- 
	AddScoped-- 
<-- 
ICommandHandler-- *
<--* +
Commands--+ 3
.--3 4
RefundTicketCommand--4 G
,--G H
Commands--I Q
.--Q R
RefundTicketResult--R d
>--d e
,--e f'
RefundTicketCommandHandler	--g Å
>
--Å Ç
(
--Ç É
)
--É Ñ
;
--Ñ Ö
services.. 
... 
	AddScoped.. 
<.. 
ICommandHandler.. *
<..* +
Commands..+ 3
...3 4
SplitTicketCommand..4 F
,..F G
Commands..H P
...P Q
SplitTicketResult..Q b
>..b c
,..c d%
SplitTicketCommandHandler..e ~
>..~ 
(	.. Ä
)
..Ä Å
;
..Å Ç
services11 
.11 
	AddScoped11 
<11 
ICommandHandler11 *
<11* +
Commands11+ 3
.113 4#
SetServiceChargeCommand114 K
,11K L
Commands11M U
.11U V"
SetServiceChargeResult11V l
>11l m
,11m n+
SetServiceChargeCommandHandler	11o ç
>
11ç é
(
11é è
)
11è ê
;
11ê ë
services22 
.22 
	AddScoped22 
<22 
ICommandHandler22 *
<22* +
Commands22+ 3
.223 4)
CalculateServiceChargeCommand224 Q
,22Q R
Commands22S [
.22[ \(
CalculateServiceChargeResult22\ x
>22x y
,22y z1
$CalculateServiceChargeCommandHandler	22{ ü
>
22ü †
(
22† °
)
22° ¢
;
22¢ £
services33 
.33 
	AddScoped33 
<33 
ICommandHandler33 *
<33* +
Commands33+ 3
.333 4$
SetDeliveryChargeCommand334 L
,33L M
Commands33N V
.33V W#
SetDeliveryChargeResult33W n
>33n o
,33o p,
SetDeliveryChargeCommandHandler	33q ê
>
33ê ë
(
33ë í
)
33í ì
;
33ì î
services44 
.44 
	AddScoped44 
<44 
ICommandHandler44 *
<44* +
Commands44+ 3
.443 4 
SetAdjustmentCommand444 H
,44H I
Commands44J R
.44R S
SetAdjustmentResult44S f
>44f g
,44g h(
SetAdjustmentCommandHandler	44i Ñ
>
44Ñ Ö
(
44Ö Ü
)
44Ü á
;
44á à
services55 
.55 
	AddScoped55 
<55 
ICommandHandler55 *
<55* +
Commands55+ 3
.553 4$
SetAdvancePaymentCommand554 L
,55L M
Commands55N V
.55V W#
SetAdvancePaymentResult55W n
>55n o
,55o p,
SetAdvancePaymentCommandHandler	55q ê
>
55ê ë
(
55ë í
)
55í ì
;
55ì î
services88 
.88 
	AddScoped88 
<88 
ICommandHandler88 *
<88* +
Commands88+ 3
.883 4"
OpenCashSessionCommand884 J
,88J K
Commands88L T
.88T U!
OpenCashSessionResult88U j
>88j k
,88k l*
OpenCashSessionCommandHandler	88m ä
>
88ä ã
(
88ã å
)
88å ç
;
88ç é
services99 
.99 
	AddScoped99 
<99 
ICommandHandler99 *
<99* +
Commands99+ 3
.993 4#
CloseCashSessionCommand994 K
,99K L
Commands99M U
.99U V"
CloseCashSessionResult99V l
>99l m
,99m n+
CloseCashSessionCommandHandler	99o ç
>
99ç é
(
99é è
)
99è ê
;
99ê ë
services:: 
.:: 
	AddScoped:: 
<:: 
ICommandHandler:: *
<::* +
Commands::+ 3
.::3 4
AddPayoutCommand::4 D
,::D E
Commands::F N
.::N O
AddPayoutResult::O ^
>::^ _
,::_ `#
AddPayoutCommandHandler::a x
>::x y
(::y z
)::z {
;::{ |
services;; 
.;; 
	AddScoped;; 
<;; 
ICommandHandler;; *
<;;* +
Commands;;+ 3
.;;3 4
AddCashDropCommand;;4 F
,;;F G
Commands;;H P
.;;P Q
AddCashDropResult;;Q b
>;;b c
,;;c d%
AddCashDropCommandHandler;;e ~
>;;~ 
(	;; Ä
)
;;Ä Å
;
;;Å Ç
services<< 
.<< 
	AddScoped<< 
<<< 
ICommandHandler<< *
<<<* +
Commands<<+ 3
.<<3 4!
AddDrawerBleedCommand<<4 I
,<<I J
Commands<<K S
.<<S T 
AddDrawerBleedResult<<T h
><<h i
,<<i j)
AddDrawerBleedCommandHandler	<<k á
>
<<á à
(
<<à â
)
<<â ä
;
<<ä ã
services?? 
.?? 
	AddScoped?? 
<?? 
ICommandHandler?? *
<??* +
Commands??+ 3
.??3 4
CreateShiftCommand??4 F
,??F G
Commands??H P
.??P Q
CreateShiftResult??Q b
>??b c
,??c d%
CreateShiftCommandHandler??e ~
>??~ 
(	?? Ä
)
??Ä Å
;
??Å Ç
services@@ 
.@@ 
	AddScoped@@ 
<@@ 
ICommandHandler@@ *
<@@* +
Commands@@+ 3
.@@3 4
UpdateShiftCommand@@4 F
,@@F G
Commands@@H P
.@@P Q
UpdateShiftResult@@Q b
>@@b c
,@@c d%
UpdateShiftCommandHandler@@e ~
>@@~ 
(	@@ Ä
)
@@Ä Å
;
@@Å Ç
servicesCC 
.CC 
	AddScopedCC 
<CC 
ICommandHandlerCC *
<CC* +
CommandsCC+ 3
.CC3 4"
CreateOrderTypeCommandCC4 J
,CCJ K
CommandsCCL T
.CCT U!
CreateOrderTypeResultCCU j
>CCj k
,CCk l*
CreateOrderTypeCommandHandler	CCm ä
>
CCä ã
(
CCã å
)
CCå ç
;
CCç é
servicesDD 
.DD 
	AddScopedDD 
<DD 
ICommandHandlerDD *
<DD* +
CommandsDD+ 3
.DD3 4"
UpdateOrderTypeCommandDD4 J
,DDJ K
CommandsDDL T
.DDT U!
UpdateOrderTypeResultDDU j
>DDj k
,DDk l*
UpdateOrderTypeCommandHandler	DDm ä
>
DDä ã
(
DDã å
)
DDå ç
;
DDç é
servicesGG 
.GG 
	AddScopedGG 
<GG 
ICommandHandlerGG *
<GG* +
CommandsGG+ 3
.GG3 4
CreateTableCommandGG4 F
,GGF G
CommandsGGH P
.GGP Q
CreateTableResultGGQ b
>GGb c
,GGc d%
CreateTableCommandHandlerGGe ~
>GG~ 
(	GG Ä
)
GGÄ Å
;
GGÅ Ç
servicesHH 
.HH 
	AddScopedHH 
<HH 
ICommandHandlerHH *
<HH* +
CommandsHH+ 3
.HH3 4
UpdateTableCommandHH4 F
,HHF G
CommandsHHH P
.HHP Q
UpdateTableResultHHQ b
>HHb c
,HHc d%
UpdateTableCommandHandlerHHe ~
>HH~ 
(	HH Ä
)
HHÄ Å
;
HHÅ Ç
servicesII 
.II 
	AddScopedII 
<II 
ICommandHandlerII *
<II* +
CommandsII+ 3
.II3 4&
AssignTableToTicketCommandII4 N
,IIN O
CommandsIIP X
.IIX Y%
AssignTableToTicketResultIIY r
>IIr s
,IIs t.
!AssignTableToTicketCommandHandler	IIu ñ
>
IIñ ó
(
IIó ò
)
IIò ô
;
IIô ö
servicesJJ 
.JJ 
	AddScopedJJ 
<JJ 
ICommandHandlerJJ *
<JJ* +
CommandsJJ+ 3
.JJ3 4(
TransferTicketToTableCommandJJ4 P
,JJP Q
CommandsJJR Z
.JJZ ['
TransferTicketToTableResultJJ[ v
>JJv w
,JJw x0
#TransferTicketToTableCommandHandler	JJy ú
>
JJú ù
(
JJù û
)
JJû ü
;
JJü †
servicesKK 
.KK 
	AddScopedKK 
<KK 
ICommandHandlerKK *
<KK* +
CommandsKK+ 3
.KK3 4
ReleaseTableCommandKK4 G
,KKG H
CommandsKKI Q
.KKQ R
ReleaseTableResultKKR d
>KKd e
,KKe f'
ReleaseTableCommandHandler	KKg Å
>
KKÅ Ç
(
KKÇ É
)
KKÉ Ñ
;
KKÑ Ö
servicesLL 
.LL 
	AddScopedLL 
<LL 
ICommandHandlerLL *
<LL* +
CommandsLL+ 3
.LL3 4
ChangeTableCommandLL4 F
,LLF G
CommandsLLH P
.LLP Q
ChangeTableResultLLQ b
>LLb c
,LLc d%
ChangeTableCommandHandlerLLe ~
>LL~ 
(	LL Ä
)
LLÄ Å
;
LLÅ Ç
servicesMM 
.MM 
	AddScopedMM 
<MM 
ICommandHandlerMM *
<MM* +
CommandsMM+ 3
.MM3 4
SetTaxExemptCommandMM4 G
,MMG H
CommandsMMI Q
.MMQ R
SetTaxExemptResultMMR d
>MMd e
,MMe f'
SetTaxExemptCommandHandler	MMg Å
>
MMÅ Ç
(
MMÇ É
)
MMÉ Ñ
;
MMÑ Ö
servicesNN 
.NN 
	AddScopedNN 
<NN 
ICommandHandlerNN *
<NN* +
CommandsNN+ 3
.NN3 4(
ChangeTicketOrderTypeCommandNN4 P
>NNP Q
,NNQ R/
#ChangeTicketOrderTypeCommandHandlerNNS v
>NNv w
(NNw x
)NNx y
;NNy z
servicesOO 
.OO 
	AddScopedOO 
<OO 
ICommandHandlerOO *
<OO* +
CommandsOO+ 3
.OO3 4$
SetTicketCustomerCommandOO4 L
>OOL M
,OOM N+
SetTicketCustomerCommandHandlerOOO n
>OOn o
(OOo p
)OOp q
;OOq r
servicesRR 
.RR 
	AddScopedRR 
<RR 
ICommandHandlerRR *
<RR* +
CommandsRR+ 3
.RR3 4$
MarkTicketAsReadyCommandRR4 L
>RRL M
,RRM N+
MarkTicketAsReadyCommandHandlerRRO n
>RRn o
(RRo p
)RRp q
;RRq r
servicesSS 
.SS 
	AddScopedSS 
<SS 
ICommandHandlerSS *
<SS* +
CommandsSS+ 3
.SS3 4!
DispatchTicketCommandSS4 I
>SSI J
,SSJ K(
DispatchTicketCommandHandlerSSL h
>SSh i
(SSi j
)SSj k
;SSk l
servicesTT 
.TT 
	AddScopedTT 
<TT 
ICommandHandlerTT *
<TT* +
CommandsTT+ 3
.TT3 4!
ScheduleTicketCommandTT4 I
>TTI J
,TTJ K(
ScheduleTicketCommandHandlerTTL h
>TTh i
(TTi j
)TTj k
;TTk l
servicesUU 
.UU 
	AddScopedUU 
<UU 
ICommandHandlerUU *
<UU* +
CommandsUU+ 3
.UU3 4'
FireScheduledTicketsCommandUU4 O
>UUO P
,UUP Q.
"FireScheduledTicketsCommandHandlerUUR t
>UUt u
(UUu v
)UUv w
;UUw x
servicesXX 
.XX 
	AddScopedXX 
<XX 
ICommandHandlerXX *
<XX* +
CommandsXX+ 3
.XX3 4!
PrintToKitchenCommandXX4 I
,XXI J
CommandsXXK S
.XXS T 
PrintToKitchenResultXXT h
>XXh i
,XXi j)
PrintToKitchenCommandHandler	XXk á
>
XXá à
(
XXà â
)
XXâ ä
;
XXä ã
servicesYY 
.YY 
	AddScopedYY 
<YY 
ICommandHandlerYY *
<YY* +
CommandsYY+ 3
.YY3 4
PrintReceiptCommandYY4 G
,YYG H
CommandsYYI Q
.YYQ R
PrintReceiptResultYYR d
>YYd e
,YYe f'
PrintReceiptCommandHandler	YYg Å
>
YYÅ Ç
(
YYÇ É
)
YYÉ Ñ
;
YYÑ Ö
services\\ 
.\\ 
	AddScoped\\ 
<\\ 
ICommandHandler\\ *
<\\* +
Commands\\+ 3
.\\3 4"
RemoveOrderLineCommand\\4 J
>\\J K
,\\K L)
RemoveOrderLineCommandHandler\\M j
>\\j k
(\\k l
)\\l m
;\\m n
services]] 
.]] 
	AddScoped]] 
<]] 
ICommandHandler]] *
<]]* +
Commands]]+ 3
.]]3 4"
ModifyOrderLineCommand]]4 J
>]]J K
,]]K L)
ModifyOrderLineCommandHandler]]M j
>]]j k
(]]k l
)]]l m
;]]m n
services^^ 
.^^ 
	AddScoped^^ 
<^^ 
ICommandHandler^^ *
<^^* +
Commands^^+ 3
.^^3 4'
AddOrderLineModifierCommand^^4 O
>^^O P
,^^P Q.
"AddOrderLineModifierCommandHandler^^R t
>^^t u
(^^u v
)^^v w
;^^w x
services__ 
.__ 
	AddScoped__ 
<__ 
ICommandHandler__ *
<__* +
Commands__+ 3
.__3 4*
RemoveOrderLineModifierCommand__4 R
>__R S
,__S T1
%RemoveOrderLineModifierCommandHandler__U z
>__z {
(__{ |
)__| }
;__} ~
services`` 
.`` 
	AddScoped`` 
<`` 
ICommandHandler`` *
<``* +
Commands``+ 3
.``3 4*
AddOrderLineInstructionCommand``4 R
>``R S
,``S T1
%AddOrderLineInstructionCommandHandler``U z
>``z {
(``{ |
)``| }
;``} ~
servicesaa 
.aa 
	AddScopedaa 
<aa 
ICommandHandleraa *
<aa* +
Commandsaa+ 3
.aa3 4 
ApplyDiscountCommandaa4 H
>aaH I
,aaI J'
ApplyDiscountCommandHandleraaK f
>aaf g
(aag h
)aah i
;aai j
servicesbb 
.bb 
	AddScopedbb 
<bb 
ICommandHandlerbb *
<bb* +
Commandsbb+ 3
.bb3 4
ApplyCouponCommandbb4 F
>bbF G
,bbG H%
ApplyCouponCommandHandlerbbI b
>bbb c
(bbc d
)bbd e
;bbe f
servicescc 
.cc 
	AddScopedcc 
<cc 
ICommandHandlercc *
<cc* +
Commandscc+ 3
.cc3 4$
AddOrderLineComboCommandcc4 L
>ccL M
,ccM N+
AddOrderLineComboCommandHandlerccO n
>ccn o
(cco p
)ccp q
;ccq r
servicesdd 
.dd 
	AddScopeddd 
<dd 
ICommandHandlerdd *
<dd* +
Commandsdd+ 3
.dd3 4
CloseTicketCommanddd4 F
>ddF G
,ddG H%
CloseTicketCommandHandlerddI b
>ddb c
(ddc d
)ddd e
;dde f
servicesee 
.ee 
	AddScopedee 
<ee 
ICommandHandleree *
<ee* +
Commandsee+ 3
.ee3 4#
UpdateTicketNoteCommandee4 K
>eeK L
,eeL M*
UpdateTicketNoteCommandHandlereeN l
>eel m
(eem n
)een o
;eeo p
servicesff 
.ff 
	AddScopedff 
<ff 
ICommandHandlerff *
<ff* +
Commandsff+ 3
.ff3 4-
!UpdateOrderLineInstructionCommandff4 U
>ffU V
,ffV W5
(UpdateOrderLineInstructionCommandHandler	ffX Ä
>
ffÄ Å
(
ffÅ Ç
)
ffÇ É
;
ffÉ Ñ
servicesgg 
.gg 
	AddScopedgg 
<gg 
ICommandHandlergg *
<gg* +
Commandsgg+ 3
.gg3 4
VoidTicketCommandgg4 E
>ggE F
,ggF G$
VoidTicketCommandHandlerggH `
>gg` a
(gga b
)ggb c
;ggc d
serviceshh 
.hh 
	AddScopedhh 
<hh 
ICommandHandlerhh *
<hh* +
Commandshh+ 3
.hh3 4
PayNowCommandhh4 A
,hhA B
CommandshhC K
.hhK L
PayNowResulthhL X
>hhX Y
,hhY Z 
PayNowCommandHandlerhh[ o
>hho p
(hhp q
)hhq r
;hhr s
servicesii 
.ii 
	AddScopedii 
<ii 
ICommandHandlerii *
<ii* +
Commandsii+ 3
.ii3 4
LogoutCommandii4 A
>iiA B
,iiB C 
LogoutCommandHandleriiD X
>iiX Y
(iiY Z
)iiZ [
;ii[ \
servicesjj 
.jj 
	AddScopedjj 
<jj 
ICommandHandlerjj *
<jj* +
Commandsjj+ 3
.jj3 4
SettleTicketCommandjj4 G
>jjG H
,jjH I&
SettleTicketCommandHandlerjjJ d
>jjd e
(jje f
)jjf g
;jjg h
serviceskk 
.kk 
	AddScopedkk 
<kk 
ICommandHandlerkk *
<kk* +
Commandskk+ 3
.kk3 4
ClockInCommandkk4 B
>kkB C
,kkC D!
ClockInCommandHandlerkkE Z
>kkZ [
(kk[ \
)kk\ ]
;kk] ^
servicesll 
.ll 
	AddScopedll 
<ll 
ICommandHandlerll *
<ll* +
Commandsll+ 3
.ll3 4
ClockOutCommandll4 C
>llC D
,llD E"
ClockOutCommandHandlerllF \
>ll\ ]
(ll] ^
)ll^ _
;ll_ `
servicesmm 
.mm 
	AddScopedmm 
<mm 
ICommandHandlermm *
<mm* +
Commandsmm+ 3
.mm3 4!
TransferTicketCommandmm4 I
>mmI J
,mmJ K(
TransferTicketCommandHandlermmL h
>mmh i
(mmi j
)mmj k
;mmk l
servicespp 
.pp 
	AddScopedpp 
<pp "
ITicketCreationServicepp 1
,pp1 2!
TicketCreationServicepp3 H
>ppH I
(ppI J
)ppJ K
;ppK L
servicesss 
.ss 
	AddScopedss 
<ss !
GetTicketQueryHandlerss 0
>ss0 1
(ss1 2
)ss2 3
;ss3 4
servicestt 
.tt 
	AddScopedtt 
<tt 
IQueryHandlertt (
<tt( )
Queriestt) 0
.tt0 1
GetTicketQuerytt1 ?
,tt? @
DTOsttA E
.ttE F
	TicketDtottF O
?ttO P
>ttP Q
,ttQ R!
GetTicketQueryHandlerttS h
>tth i
(tti j
)ttj k
;ttk l
servicesuu 
.uu 
	AddScopeduu 
<uu 
IQueryHandleruu (
<uu( )
Queriesuu) 0
.uu0 1"
GetTicketByNumberQueryuu1 G
,uuG H
DTOsuuI M
.uuM N
	TicketDtouuN W
?uuW X
>uuX Y
,uuY Z)
GetTicketByNumberQueryHandleruu[ x
>uux y
(uuy z
)uuz {
;uu{ |
servicesvv 
.vv 
	AddScopedvv 
<vv 
IQueryHandlervv (
<vv( )
Queriesvv) 0
.vv0 1
GetOpenTicketsQueryvv1 D
,vvD E
IEnumerablevvF Q
<vvQ R
DTOsvvR V
.vvV W
	TicketDtovvW `
>vv` a
>vva b
,vvb c&
GetOpenTicketsQueryHandlervvd ~
>vv~ 
(	vv Ä
)
vvÄ Å
;
vvÅ Ç
servicesww 
.ww 
	AddScopedww 
<ww 
IQueryHandlerww (
<ww( )
Queriesww) 0
.ww0 1&
GetCurrentCashSessionQueryww1 K
,wwK L
QuerieswwM T
.wwT U'
GetCurrentCashSessionResultwwU p
>wwp q
,wwq r.
!GetCurrentCashSessionQueryHandler	wws î
>
wwî ï
(
wwï ñ
)
wwñ ó
;
wwó ò
servicesxx 
.xx 
	AddScopedxx 
<xx 
IQueryHandlerxx (
<xx( )
Queriesxx) 0
.xx0 1
GetCashSessionQueryxx1 D
,xxD E
QueriesxxF M
.xxM N 
GetCashSessionResultxxN b
>xxb c
,xxc d&
GetCashSessionQueryHandlerxxe 
>	xx Ä
(
xxÄ Å
)
xxÅ Ç
;
xxÇ É
servicesyy 
.yy 
	AddScopedyy 
<yy 
IQueryHandleryy (
<yy( )
Queriesyy) 0
.yy0 1$
GetDrawerPullReportQueryyy1 I
,yyI J
QueriesyyK R
.yyR S%
GetDrawerPullReportResultyyS l
>yyl m
,yym n,
GetDrawerPullReportQueryHandler	yyo é
>
yyé è
(
yyè ê
)
yyê ë
;
yyë í
serviceszz 
.zz 
	AddScopedzz 
<zz 
IQueryHandlerzz (
<zz( )
Querieszz) 0
.zz0 1
GetShiftQueryzz1 >
,zz> ?
Querieszz@ G
.zzG H
GetShiftResultzzH V
>zzV W
,zzW X 
GetShiftQueryHandlerzzY m
>zzm n
(zzn o
)zzo p
;zzp q
services{{ 
.{{ 
	AddScoped{{ 
<{{ 
IQueryHandler{{ (
<{{( )
Queries{{) 0
.{{0 1 
GetCurrentShiftQuery{{1 E
,{{E F
Queries{{G N
.{{N O!
GetCurrentShiftResult{{O d
>{{d e
,{{e f(
GetCurrentShiftQueryHandler	{{g Ç
>
{{Ç É
(
{{É Ñ
)
{{Ñ Ö
;
{{Ö Ü
services|| 
.|| 
	AddScoped|| 
<|| 
IQueryHandler|| (
<||( )
Queries||) 0
.||0 1
GetShiftReportQuery||1 D
,||D E
Queries||F M
.||M N 
GetShiftReportResult||N b
>||b c
,||c d&
GetShiftReportQueryHandler||e 
>	|| Ä
(
||Ä Å
)
||Å Ç
;
||Ç É
services 
. 
	AddScoped 
< 
IQueryHandler (
<( )
Queries) 0
.0 1
GetOrderTypeQuery1 B
,B C
QueriesD K
.K L
GetOrderTypeResultL ^
>^ _
,_ `$
GetOrderTypeQueryHandlera y
>y z
(z {
){ |
;| }
services
ÇÇ 
.
ÇÇ 
	AddScoped
ÇÇ 
<
ÇÇ 
IQueryHandler
ÇÇ (
<
ÇÇ( )
Queries
ÇÇ) 0
.
ÇÇ0 1
GetTableQuery
ÇÇ1 >
,
ÇÇ> ?
Queries
ÇÇ@ G
.
ÇÇG H
GetTableResult
ÇÇH V
>
ÇÇV W
,
ÇÇW X"
GetTableQueryHandler
ÇÇY m
>
ÇÇm n
(
ÇÇn o
)
ÇÇo p
;
ÇÇp q
services
ÉÉ 
.
ÉÉ 
	AddScoped
ÉÉ 
<
ÉÉ 
IQueryHandler
ÉÉ (
<
ÉÉ( )
Queries
ÉÉ) 0
.
ÉÉ0 1%
GetAvailableTablesQuery
ÉÉ1 H
,
ÉÉH I
Queries
ÉÉJ Q
.
ÉÉQ R&
GetAvailableTablesResult
ÉÉR j
>
ÉÉj k
,
ÉÉk l-
GetAvailableTablesQueryHandlerÉÉm ã
>ÉÉã å
(ÉÉå ç
)ÉÉç é
;ÉÉé è
services
ÑÑ 
.
ÑÑ 
	AddScoped
ÑÑ 
<
ÑÑ 
IQueryHandler
ÑÑ (
<
ÑÑ( )
Queries
ÑÑ) 0
.
ÑÑ0 1
GetTableMapQuery
ÑÑ1 A
,
ÑÑA B
Queries
ÑÑC J
.
ÑÑJ K
GetTableMapResult
ÑÑK \
>
ÑÑ\ ]
,
ÑÑ] ^%
GetTableMapQueryHandler
ÑÑ_ v
>
ÑÑv w
(
ÑÑw x
)
ÑÑx y
;
ÑÑy z
services
ÜÜ 
.
ÜÜ 
	AddScoped
ÜÜ 
<
ÜÜ 
IQueryHandler
ÜÜ (
<
ÜÜ( )
Queries
ÜÜ) 0
.
ÜÜ0 1"
GetSalesBalanceQuery
ÜÜ1 E
,
ÜÜE F
DTOs
ÜÜG K
.
ÜÜK L
Reports
ÜÜL S
.
ÜÜS T#
SalesBalanceReportDto
ÜÜT i
>
ÜÜi j
,
ÜÜj k
Services
ÜÜl t
.
ÜÜt u
Reports
ÜÜu |
.
ÜÜ| }*
GetSalesBalanceQueryHandlerÜÜ} ò
>ÜÜò ô
(ÜÜô ö
)ÜÜö õ
;ÜÜõ ú
services
áá 
.
áá 
	AddScoped
áá 
<
áá 
IQueryHandler
áá (
<
áá( )
Queries
áá) 0
.
áá0 1"
GetSalesSummaryQuery
áá1 E
,
ááE F
DTOs
ááG K
.
ááK L
Reports
ááL S
.
ááS T#
SalesSummaryReportDto
ááT i
>
áái j
,
ááj k
Services
áál t
.
áát u
Reports
ááu |
.
áá| }*
GetSalesSummaryQueryHandleráá} ò
>ááò ô
(ááô ö
)ááö õ
;ááõ ú
services
àà 
.
àà 
	AddScoped
àà 
<
àà 
IQueryHandler
àà (
<
àà( )
Queries
àà) 0
.
àà0 1
Reports
àà1 8
.
àà8 9&
GetExceptionsReportQuery
àà9 Q
,
ààQ R
DTOs
ààS W
.
ààW X
Reports
ààX _
.
àà_ `!
ExceptionsReportDto
àà` s
>
ààs t
,
ààt u
Services
ààv ~
.
àà~ 
Reportsàà Ü
.ààÜ á/
GetExceptionsReportQueryHandlerààá ¶
>àà¶ ß
(ààß ®
)àà® ©
;àà© ™
services
ââ 
.
ââ 
	AddScoped
ââ 
<
ââ 
IQueryHandler
ââ (
<
ââ( )
Queries
ââ) 0
.
ââ0 1
Reports
ââ1 8
.
ââ8 9#
GetJournalReportQuery
ââ9 N
,
ââN O
DTOs
ââP T
.
ââT U
Reports
ââU \
.
ââ\ ]
JournalReportDto
ââ] m
>
ââm n
,
âân o
Services
ââp x
.
ââx y
Reportsâây Ä
.ââÄ Å,
GetJournalReportQueryHandlerââÅ ù
>ââù û
(ââû ü
)ââü †
;ââ† °
services
ää 
.
ää 
	AddScoped
ää 
<
ää 
IQueryHandler
ää (
<
ää( )
Queries
ää) 0
.
ää0 1
Reports
ää1 8
.
ää8 9(
GetProductivityReportQuery
ää9 S
,
ääS T
DTOs
ääU Y
.
ääY Z
Reports
ääZ a
.
ääa b#
ProductivityReportDto
ääb w
>
ääw x
,
ääx y
Servicesääz Ç
.ääÇ É
ReportsääÉ ä
.äää ã1
!GetProductivityReportQueryHandlerääã ¨
>ää¨ ≠
(ää≠ Æ
)ääÆ Ø
;ääØ ∞
services
ãã 
.
ãã 
	AddScoped
ãã 
<
ãã 
IQueryHandler
ãã (
<
ãã( )
Queries
ãã) 0
.
ãã0 1
Reports
ãã1 8
.
ãã8 9!
GetLaborReportQuery
ãã9 L
,
ããL M
DTOs
ããN R
.
ããR S
Reports
ããS Z
.
ããZ [
LaborReportDto
ãã[ i
>
ããi j
,
ããj k
Services
ããl t
.
ããt u
Reports
ããu |
.
ãã| })
GetLaborReportQueryHandlerãã} ó
>ããó ò
(ããò ô
)ããô ö
;ããö õ
services
åå 
.
åå 
	AddScoped
åå 
<
åå 
IQueryHandler
åå (
<
åå( )
Queries
åå) 0
.
åå0 1
Reports
åå1 8
.
åå8 9$
GetDeliveryReportQuery
åå9 O
,
ååO P
DTOs
ååQ U
.
ååU V
Reports
ååV ]
.
åå] ^
DeliveryReportDto
åå^ o
>
ååo p
,
ååp q
Services
åår z
.
ååz {
Reportsåå{ Ç
.ååÇ É-
GetDeliveryReportQueryHandlerååÉ †
>åå† °
(åå° ¢
)åå¢ £
;åå£ §
services
çç 
.
çç 
	AddScoped
çç 
<
çç 
IQueryHandler
çç (
<
çç( )
Queries
çç) 0
.
çç0 1
Reports
çç1 8
.
çç8 9!
GetSalesDetailQuery
çç9 L
,
ççL M
DTOs
ççN R
.
ççR S
Reports
ççS Z
.
ççZ ["
SalesDetailReportDto
çç[ o
>
çço p
,
ççp q
Services
ççr z
.
ççz {
Reportsçç{ Ç
.ççÇ É*
GetSalesDetailQueryHandlerççÉ ù
>ççù û
(ççû ü
)ççü †
;çç† °
services
éé 
.
éé 
	AddScoped
éé 
<
éé 
IQueryHandler
éé (
<
éé( )
Queries
éé) 0
.
éé0 1
Reports
éé1 8
.
éé8 9&
GetCreditCardReportQuery
éé9 Q
,
ééQ R
DTOs
ééS W
.
ééW X
Reports
ééX _
.
éé_ `!
CreditCardReportDto
éé` s
>
éés t
,
éét u
Services
éév ~
.
éé~ 
Reportséé Ü
.ééÜ á/
GetCreditCardReportQueryHandlerééá ¶
>éé¶ ß
(ééß ®
)éé® ©
;éé© ™
services
èè 
.
èè 
	AddScoped
èè 
<
èè 
IQueryHandler
èè (
<
èè( )
Queries
èè) 0
.
èè0 1
Reports
èè1 8
.
èè8 9%
GetMenuUsageReportQuery
èè9 P
,
èèP Q
DTOs
èèR V
.
èèV W
Reports
èèW ^
.
èè^ _ 
MenuUsageReportDto
èè_ q
>
èèq r
,
èèr s
Services
èèt |
.
èè| }
Reportsèè} Ñ
.èèÑ Ö.
GetMenuUsageReportQueryHandlerèèÖ £
>èè£ §
(èè§ •
)èè• ¶
;èè¶ ß
services
êê 
.
êê 
	AddScoped
êê 
<
êê 
IQueryHandler
êê (
<
êê( )
Queries
êê) 0
.
êê0 1
Reports
êê1 8
.
êê8 9#
GetPaymentReportQuery
êê9 N
,
êêN O
DTOs
êêP T
.
êêT U
Reports
êêU \
.
êê\ ]
PaymentReportDto
êê] m
>
êêm n
,
êên o
Services
êêp x
.
êêx y
Reportsêêy Ä
.êêÄ Å,
GetPaymentReportQueryHandlerêêÅ ù
>êêù û
(êêû ü
)êêü †
;êê† °
services
ëë 
.
ëë 
	AddScoped
ëë 
<
ëë 
IQueryHandler
ëë (
<
ëë( )
Queries
ëë) 0
.
ëë0 1
Reports
ëë1 8
.
ëë8 9.
 GetServerProductivityReportQuery
ëë9 Y
,
ëëY Z
DTOs
ëë[ _
.
ëë_ `
Reports
ëë` g
.
ëëg h*
ServerProductivityReportDtoëëh É
>ëëÉ Ñ
,ëëÑ Ö
ServicesëëÜ é
.ëëé è
Reportsëëè ñ
.ëëñ ó7
'GetServerProductivityReportQueryHandlerëëó æ
>ëëæ ø
(ëëø ¿
)ëë¿ ¡
;ëë¡ ¬
services
íí 
.
íí 
	AddScoped
íí 
<
íí 
IQueryHandler
íí (
<
íí( )
Queries
íí) 0
.
íí0 1
Reports
íí1 8
.
íí8 9'
GetHourlyLaborReportQuery
íí9 R
,
ííR S
DTOs
ííT X
.
ííX Y
Reports
ííY `
.
íí` a"
HourlyLaborReportDto
íía u
>
ííu v
,
íív w
Servicesííx Ä
.ííÄ Å
ReportsííÅ à
.ííà â0
 GetHourlyLaborReportQueryHandlerííâ ©
>íí© ™
(íí™ ´
)íí´ ¨
;íí¨ ≠
services
ìì 
.
ìì 
	AddScoped
ìì 
<
ìì 
IQueryHandler
ìì (
<
ìì( )
Queries
ìì) 0
.
ìì0 1
Reports
ìì1 8
.
ìì8 9
GetTipReportQuery
ìì9 J
,
ììJ K
DTOs
ììL P
.
ììP Q
Reports
ììQ X
.
ììX Y
TipReportDto
ììY e
>
ììe f
,
ììf g
Services
ììh p
.
ììp q
Reports
ììq x
.
ììx y'
GetTipReportQueryHandlerììy ë
>ììë í
(ììí ì
)ììì î
;ììî ï
services
îî 
.
îî 
	AddScoped
îî 
<
îî 
IQueryHandler
îî (
<
îî( )
Queries
îî) 0
.
îî0 1
Reports
îî1 8
.
îî8 9&
GetAttendanceReportQuery
îî9 Q
,
îîQ R
DTOs
îîS W
.
îîW X
Reports
îîX _
.
îî_ `!
AttendanceReportDto
îî` s
>
îîs t
,
îît u
Services
îîv ~
.
îî~ 
Reportsîî Ü
.îîÜ á/
GetAttendanceReportQueryHandlerîîá ¶
>îî¶ ß
(îîß ®
)îî® ©
;îî© ™
services
ïï 
.
ïï 
	AddScoped
ïï 
<
ïï 
IQueryHandler
ïï (
<
ïï( )
Queries
ïï) 0
.
ïï0 1
Reports
ïï1 8
.
ïï8 9#
GetCashOutReportQuery
ïï9 N
,
ïïN O
DTOs
ïïP T
.
ïïT U
Reports
ïïU \
.
ïï\ ]
CashOutReportDto
ïï] m
>
ïïm n
,
ïïn o
Services
ïïp x
.
ïïx y
Reportsïïy Ä
.ïïÄ Å,
GetCashOutReportQueryHandlerïïÅ ù
>ïïù û
(ïïû ü
)ïïü †
;ïï† °
services
òò 
.
òò 
	AddScoped
òò 
<
òò 
IQueryHandler
òò (
<
òò( )#
GetSystemBackupsQuery
òò) >
,
òò> ?$
GetSystemBackupsResult
òò@ V
>
òòV W
,
òòW X*
GetSystemBackupsQueryHandler
òòY u
>
òòu v
(
òòv w
)
òòw x
;
òòx y
services
õõ 
.
õõ 
	AddScoped
õõ 
<
õõ 
ICommandHandler
õõ *
<
õõ* +'
CreateSystemBackupCommand
õõ+ D
,
õõD E&
CreateSystemBackupResult
õõF ^
>
õõ^ _
,
õõ_ `/
 CreateSystemBackupCommandHandlerõõa Å
>õõÅ Ç
(õõÇ É
)õõÉ Ñ
;õõÑ Ö
services
úú 
.
úú 
	AddScoped
úú 
<
úú 
ICommandHandler
úú *
<
úú* +(
RestoreSystemBackupCommand
úú+ E
,
úúE F'
RestoreSystemBackupResult
úúG `
>
úú` a
,
úúa b0
!RestoreSystemBackupCommandHandlerúúc Ñ
>úúÑ Ö
(úúÖ Ü
)úúÜ á
;úúá à
services
ùù 
.
ùù 
	AddScoped
ùù 
<
ùù 
ICommandHandler
ùù *
<
ùù* ++
UpdateRestaurantConfigCommand
ùù+ H
,
ùùH I*
UpdateRestaurantConfigResult
ùùJ f
>
ùùf g
,
ùùg h3
$UpdateRestaurantConfigCommandHandlerùùi ç
>ùùç é
(ùùé è
)ùùè ê
;ùùê ë
services
ûû 
.
ûû 
	AddScoped
ûû 
<
ûû 
IQueryHandler
ûû (
<
ûû( )&
GetRestaurantConfigQuery
ûû) A
,
ûûA B'
GetRestaurantConfigResult
ûûC \
>
ûû\ ]
,
ûû] ^-
GetRestaurantConfigQueryHandler
ûû_ ~
>
ûû~ 
(ûû Ä
)ûûÄ Å
;ûûÅ Ç
services
üü 
.
üü 
	AddScoped
üü 
<
üü 
IQueryHandler
üü (
<
üü( )$
GetTerminalConfigQuery
üü) ?
,
üü? @%
GetTerminalConfigResult
üüA X
>
üüX Y
,
üüY Z+
GetTerminalConfigQueryHandler
üü[ x
>
üüx y
(
üüy z
)
üüz {
;
üü{ |
services
†† 
.
†† 
	AddScoped
†† 
<
†† 
ICommandHandler
†† *
<
††* +)
UpdateTerminalConfigCommand
††+ F
,
††F G(
UpdateTerminalConfigResult
††H b
>
††b c
,
††c d1
"UpdateTerminalConfigCommandHandler††e á
>††á à
(††à â
)††â ä
;††ä ã
services
°° 
.
°° 
	AddScoped
°° 
<
°° 
IQueryHandler
°° (
<
°°( ) 
GetCardConfigQuery
°°) ;
,
°°; <!
GetCardConfigResult
°°= P
>
°°P Q
,
°°Q R'
GetCardConfigQueryHandler
°°S l
>
°°l m
(
°°m n
)
°°n o
;
°°o p
services
¢¢ 
.
¢¢ 
	AddScoped
¢¢ 
<
¢¢ 
ICommandHandler
¢¢ *
<
¢¢* +%
UpdateCardConfigCommand
¢¢+ B
,
¢¢B C$
UpdateCardConfigResult
¢¢D Z
>
¢¢Z [
,
¢¢[ \,
UpdateCardConfigCommandHandler
¢¢] {
>
¢¢{ |
(
¢¢| }
)
¢¢} ~
;
¢¢~ 
services
££ 
.
££ 
	AddScoped
££ 
<
££ 
IQueryHandler
££ (
<
££( )#
GetPrinterGroupsQuery
££) >
,
££> ?$
GetPrinterGroupsResult
££@ V
>
££V W
,
££W X*
GetPrinterGroupsQueryHandler
££Y u
>
££u v
(
££v w
)
££w x
;
££x y
services
§§ 
.
§§ 
	AddScoped
§§ 
<
§§ 
IQueryHandler
§§ (
<
§§( )%
GetPrinterMappingsQuery
§§) @
,
§§@ A&
GetPrinterMappingsResult
§§B Z
>
§§Z [
,
§§[ \,
GetPrinterMappingsQueryHandler
§§] {
>
§§{ |
(
§§| }
)
§§} ~
;
§§~ 
services
•• 
.
•• 
	AddScoped
•• 
<
•• 
ICommandHandler
•• *
<
••* +(
UpdatePrinterGroupsCommand
••+ E
,
••E F'
UpdatePrinterGroupsResult
••G `
>
••` a
,
••a b0
!UpdatePrinterGroupsCommandHandler••c Ñ
>••Ñ Ö
(••Ö Ü
)••Ü á
;••á à
services
¶¶ 
.
¶¶ 
	AddScoped
¶¶ 
<
¶¶ 
ICommandHandler
¶¶ *
<
¶¶* +*
UpdatePrinterMappingsCommand
¶¶+ G
,
¶¶G H)
UpdatePrinterMappingsResult
¶¶I d
>
¶¶d e
,
¶¶e f2
#UpdatePrinterMappingsCommandHandler¶¶g ä
>¶¶ä ã
(¶¶ã å
)¶¶å ç
;¶¶ç é
services
©© 
.
©© 
	AddScoped
©© 
<
©© 
IQueryHandler
©© (
<
©©( )
GetUsersQuery
©©) 6
,
©©6 7
IEnumerable
©©8 C
<
©©C D
UserDto
©©D K
>
©©K L
>
©©L M
,
©©M N"
GetUsersQueryHandler
©©O c
>
©©c d
(
©©d e
)
©©e f
;
©©f g
services
™™ 
.
™™ 
	AddScoped
™™ 
<
™™ 
ICommandHandler
™™ *
<
™™* +
CreateUserCommand
™™+ <
,
™™< =
CreateUserResult
™™> N
>
™™N O
,
™™O P&
CreateUserCommandHandler
™™Q i
>
™™i j
(
™™j k
)
™™k l
;
™™l m
services
´´ 
.
´´ 
	AddScoped
´´ 
<
´´ 
ICommandHandler
´´ *
<
´´* +
UpdateUserCommand
´´+ <
,
´´< =
UpdateUserResult
´´> N
>
´´N O
,
´´O P&
UpdateUserCommandHandler
´´Q i
>
´´i j
(
´´j k
)
´´k l
;
´´l m
services
¨¨ 
.
¨¨ 
	AddScoped
¨¨ 
<
¨¨ 
ICommandHandler
¨¨ *
<
¨¨* +
DeleteUserCommand
¨¨+ <
,
¨¨< =
DeleteUserResult
¨¨> N
>
¨¨N O
,
¨¨O P&
DeleteUserCommandHandler
¨¨Q i
>
¨¨i j
(
¨¨j k
)
¨¨k l
;
¨¨l m
services
ØØ 
.
ØØ 
	AddScoped
ØØ 
<
ØØ 
ICommandHandler
ØØ *
<
ØØ* +
CreateRoleCommand
ØØ+ <
,
ØØ< =
CreateRoleResult
ØØ> N
>
ØØN O
,
ØØO P&
CreateRoleCommandHandler
ØØQ i
>
ØØi j
(
ØØj k
)
ØØk l
;
ØØl m
services
∞∞ 
.
∞∞ 
	AddScoped
∞∞ 
<
∞∞ 
ICommandHandler
∞∞ *
<
∞∞* +
UpdateRoleCommand
∞∞+ <
,
∞∞< =
UpdateRoleResult
∞∞> N
>
∞∞N O
,
∞∞O P&
UpdateRoleCommandHandler
∞∞Q i
>
∞∞i j
(
∞∞j k
)
∞∞k l
;
∞∞l m
services
±± 
.
±± 
	AddScoped
±± 
<
±± 
ICommandHandler
±± *
<
±±* +
DeleteRoleCommand
±±+ <
,
±±< =
DeleteRoleResult
±±> N
>
±±N O
,
±±O P&
DeleteRoleCommandHandler
±±Q i
>
±±i j
(
±±j k
)
±±k l
;
±±l m
services
≥≥ 
.
≥≥ 
	AddScoped
≥≥ 
<
≥≥ $
IKitchenRoutingService
≥≥ 1
,
≥≥1 2#
KitchenRoutingService
≥≥3 H
>
≥≥H I
(
≥≥I J
)
≥≥J K
;
≥≥K L
services
¥¥ 
.
¥¥ 
	AddScoped
¥¥ 
<
¥¥ #
IKitchenStatusService
¥¥ 0
,
¥¥0 1"
KitchenStatusService
¥¥2 F
>
¥¥F G
(
¥¥G H
)
¥¥H I
;
¥¥I J
services
µµ 
.
µµ 
	AddScoped
µµ 
<
µµ !
ICashSessionService
µµ .
,
µµ. / 
CashSessionService
µµ0 B
>
µµB C
(
µµC D
)
µµD E
;
µµE F
services
∂∂ 
.
∂∂ 
	AddScoped
∂∂ 
<
∂∂ !
IGroupSettleService
∂∂ .
,
∂∂. / 
GroupSettleService
∂∂0 B
>
∂∂B C
(
∂∂C D
)
∂∂D E
;
∂∂E F
services
∑∑ 
.
∑∑ 
	AddScoped
∑∑ 
<
∑∑ #
IMerchantBatchService
∑∑ 0
,
∑∑0 1"
MerchantBatchService
∑∑2 F
>
∑∑F G
(
∑∑G H
)
∑∑H I
;
∑∑I J
services
∏∏ 
.
∏∏ 
	AddScoped
∏∏ 
<
∏∏ !
TableLayoutExporter
∏∏ .
>
∏∏. /
(
∏∏/ 0
)
∏∏0 1
;
∏∏1 2
return
∫∫ 
services
∫∫ 
;
∫∫ 
}
ªª 
}ºº ∏
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\VoidTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
VoidTicketCommand 
{		 
public

 

Guid

 
TicketId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

UserId 
VoidedBy 
{ 
get  
;  !
set" %
;% &
}' (
=) *
null+ /
!/ 0
;0 1
public 

string 
Reason 
{ 
get 
; 
set  #
;# $
}% &
=' (
$str) /
;/ 0
public 

bool 
IsWasted 
{ 
get 
; 
set  #
;# $
}% &
} ∑

}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\VoidCardPaymentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class "
VoidCardPaymentCommand #
{		 
public

 

Guid

 
	PaymentId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
} 
public 
class !
VoidCardPaymentResult "
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
VoidCode 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
} ‹
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\UpdateUserCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
UpdateUserCommand 
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
public		 

string		 
	FirstName		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
=		* +
string		, 2
.		2 3
Empty		3 8
;		8 9
public

 

string

 
LastName

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
=

) *
string

+ 1
.

1 2
Empty

2 7
;

7 8
public 

string 
Pin 
{ 
get 
; 
set  
;  !
}" #
=$ %
string& ,
., -
Empty- 2
;2 3
public 

Guid 
RoleId 
{ 
get 
; 
set !
;! "
}# $
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
} 
public 
class 
UpdateUserResult 
{ 
public 

bool 
	IsSuccess 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Message 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
} ô
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\UpdateTicketNoteCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class #
UpdateTicketNoteCommand $
{		 
public

 

Guid

 
TicketId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

string 
? 
Note 
{ 
get 
; 
set "
;" #
}$ %
public 
#
UpdateTicketNoteCommand "
(" #
Guid# '
ticketId( 0
,0 1
string2 8
?8 9
note: >
)> ?
{ 
TicketId 
= 
ticketId 
; 
Note 
= 
note 
; 
} 
} Û
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\UpdateTableCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
UpdateTableCommand 
{ 
public 

Guid 
TableId 
{ 
get 
; 
set "
;" #
}$ %
public		 

int		 
?		 
TableNumber		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 

int

 
?

 
Capacity

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

int 
? 
X 
{ 
get 
; 
set 
; 
} 
public 

int 
? 
Y 
{ 
get 
; 
set 
; 
} 
public 

Guid 
? 
FloorId 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
? 
IsActive 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 
UpdateTableResult 
{ 
public 

Guid 
TableId 
{ 
get 
; 
set "
;" #
}$ %
public 

int 
TableNumber 
{ 
get  
;  !
set" %
;% &
}' (
} Ú
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\UpdateShiftCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
UpdateShiftCommand 
{ 
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public		 

string		 
?		 
Name		 
{		 
get		 
;		 
set		 "
;		" #
}		$ %
public

 

TimeSpan

 
?

 
	StartTime

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 

TimeSpan 
? 
EndTime 
{ 
get "
;" #
set$ '
;' (
}) *
public 

bool 
? 
IsActive 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 
UpdateShiftResult 
{ 
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
} È
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\UpdateOrderTypeCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class "
UpdateOrderTypeCommand #
{ 
public 

Guid 
OrderTypeId 
{ 
get !
;! "
set# &
;& '
}( )
public		 

string		 
?		 
Name		 
{		 
get		 
;		 
set		 "
;		" #
}		$ %
public

 

bool

 
?

 
CloseOnPaid

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 

bool 
? 
AllowSeatBasedOrder $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

bool 
? 
AllowToAddTipsLater $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

bool 
? 
IsBarTab 
{ 
get 
;  
set! $
;$ %
}& '
public 

bool 
? 
IsActive 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class !
UpdateOrderTypeResult "
{ 
public 

Guid 
OrderTypeId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
} ˚

àC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\UpdateOrderLineInstructionCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class -
!UpdateOrderLineInstructionCommand .
{		 
public

 

Guid

 
TicketId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

Guid 
OrderLineId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
Instruction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
-
!UpdateOrderLineInstructionCommand ,
(, -
Guid- 1
ticketId2 :
,: ;
Guid< @
orderLineIdA L
,L M
stringN T
?T U
instructionV a
)a b
{ 
TicketId 
= 
ticketId 
; 
OrderLineId 
= 
orderLineId !
;! "
Instruction 
= 
instruction !
;! "
} 
} ø
ÉC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\TransferTicketToTableCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class (
TransferTicketToTableCommand )
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
SourceTableId 
{ 
get  #
;# $
set% (
;( )
}* +
public		 

Guid		 
TargetTableId		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 

Guid

 
UserId

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
} 
public 
class '
TransferTicketToTableResult (
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
SourceTableId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Guid 
TargetTableId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
} æ
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\TransferTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class !
TransferTicketCommand "
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

UserId		 

NewOwnerId		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
=		+ ,
null		- 1
!		1 2
;		2 3
public

 

UserId

 
TransferredBy

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
=

. /
null

0 4
!

4 5
;

5 6
} Ù
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\TicketConfigurationCommands.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class (
ChangeTicketOrderTypeCommand )
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
OrderTypeId		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 

UserId

 
	ChangedBy

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
=

* +
null

, 0
!

0 1
;

1 2
} 
public 
class $
SetTicketCustomerCommand %
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
? 

CustomerId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
DeliveryAddress "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

string 
? 
ExtraDeliveryInfo $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

UserId 
	ChangedBy 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
} œ	
àC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\System\RestoreSystemBackupCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
class &
RestoreSystemBackupCommand '
{ 
public 

string 
FileName 
{ 
get  
;  !
}" #
public 
&
RestoreSystemBackupCommand %
(% &
string& ,
fileName- 5
)5 6
{		 
FileName

 
=

 
fileName

 
;

 
} 
} 
public 
class %
RestoreSystemBackupResult &
{ 
public 

bool 
Success 
{ 
get 
; 
}  
public 
%
RestoreSystemBackupResult $
($ %
bool% )
success* 1
)1 2
{ 
Success 
= 
success 
; 
} 
} Î
áC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\System\CreateSystemBackupCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
class %
CreateSystemBackupCommand &
{ 
} 
public 
class $
CreateSystemBackupResult %
{		 
public

 

string

 
FileName

 
{

 
get

  
;

  !
}

" #
public 
$
CreateSystemBackupResult #
(# $
string$ *
fileName+ 3
)3 4
{ 
FileName 
= 
fileName 
; 
} 
} Ä
èC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\UpdateTerminalConfigCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
class '
UpdateTerminalConfigCommand (
{ 
public 

TerminalDto 
Terminal 
{  !
get" %
;% &
}' (
public		 
'
UpdateTerminalConfigCommand		 &
(		& '
TerminalDto		' 2
terminal		3 ;
)		; <
{

 
Terminal 
= 
terminal 
; 
} 
} 
public 
class &
UpdateTerminalConfigResult '
{ 
public 

bool 
Success 
{ 
get 
; 
}  
public 

string 
Message 
{ 
get 
;  
}! "
public 
&
UpdateTerminalConfigResult %
(% &
bool& *
success+ 2
,2 3
string4 :
message; B
=C D
$strE G
)G H
{ 
Success 
= 
success 
; 
Message 
= 
message 
; 
} 
} °
åC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\UpdateRoleCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public		 
class		 $
UpdateRoleCommandHandler		 %
:		& '
ICommandHandler		( 7
<		7 8
UpdateRoleCommand		8 I
,		I J
UpdateRoleResult		K [
>		[ \
{

 
private 
readonly 
IRoleRepository $
_roleRepository% 4
;4 5
public 
$
UpdateRoleCommandHandler #
(# $
IRoleRepository$ 3
roleRepository4 B
)B C
{ 
_roleRepository 
= 
roleRepository (
;( )
} 
public 

async 
Task 
< 
UpdateRoleResult &
>& '
HandleAsync( 3
(3 4
UpdateRoleCommand4 E
commandF M
,M N
CancellationTokenO `
cancellationTokena r
=s t
defaultu |
)| }
{ 
try 
{ 	
var 
role 
= 
await 
_roleRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
RoleIdB H
)H I
;I J
if 
( 
role 
== 
null 
) 
return 
new 
UpdateRoleResult +
(+ ,
false, 1
,1 2
$str3 D
)D E
;E F
if 
( 
! 
string 
. 
IsNullOrWhiteSpace *
(* +
command+ 2
.2 3
Name3 7
)7 8
)8 9
{ 
role 
. 
SetName 
( 
command $
.$ %
Name% )
)) *
;* +
} 
role 
. 
UpdatePermissions "
(" #
command# *
.* +
Permissions+ 6
)6 7
;7 8
await!! 
_roleRepository!! !
.!!! "
UpdateAsync!!" -
(!!- .
role!!. 2
,!!2 3
cancellationToken!!4 E
)!!E F
;!!F G
return## 
new## 
UpdateRoleResult## '
(##' (
true##( ,
,##, -
$str##. J
)##J K
;##K L
}$$ 	
catch%% 
(%% 
	Exception%% 
ex%% 
)%% 
{&& 	
return'' 
new'' 
UpdateRoleResult'' '
(''' (
false''( -
,''- .
ex''/ 1
.''1 2
Message''2 9
)''9 :
;'': ;
}(( 	
})) 
}** „
ëC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\UpdateRestaurantConfigCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
record )
UpdateRestaurantConfigCommand +
(+ ,&
RestaurantConfigurationDto, F
ConfigurationG T
)T U
;U V
public 
record (
UpdateRestaurantConfigResult *
(* +
bool+ /
	IsSuccess0 9
,9 :
string; A
MessageB I
)I J
;J KÍ

êC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\UpdatePrinterMappingsCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
record '
UpdatePrinterMappingsResult )
() *
bool* .
Success/ 6
,6 7
string8 >
Message? F
)F G
;G H
public		 
class		 (
UpdatePrinterMappingsCommand		 )
{

 
public 

Guid 

TerminalId 
{ 
get  
;  !
}" #
public 

List 
< 
PrinterMappingDto !
>! "
Mappings# +
{, -
get. 1
;1 2
}3 4
public 
(
UpdatePrinterMappingsCommand '
(' (
Guid( ,

terminalId- 7
,7 8
List9 =
<= >
PrinterMappingDto> O
>O P
mappingsQ Y
)Y Z
{ 

TerminalId 
= 

terminalId 
;  
Mappings 
= 
mappings 
; 
} 
} ”
éC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\UpdatePrinterGroupsCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
record %
UpdatePrinterGroupsResult '
(' (
bool( ,
Success- 4
,4 5
string6 <
Message= D
)D E
;E F
public		 
class		 &
UpdatePrinterGroupsCommand		 '
{

 
public 

List 
< 
PrinterGroupDto 
>  
Groups! '
{( )
get* -
;- .
}/ 0
public 
&
UpdatePrinterGroupsCommand %
(% &
List& *
<* +
PrinterGroupDto+ :
>: ;
groups< B
)B C
{ 
Groups 
= 
groups 
; 
} 
} „
ãC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\UpdateCardConfigCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
record "
UpdateCardConfigResult $
($ %
bool% )
Success* 1
,1 2
string3 9
Message: A
)A B
;B C
public 
class #
UpdateCardConfigCommand $
{		 
public

 

CardConfigDto

 
Config

 
{

  !
get

" %
;

% &
}

' (
public 
#
UpdateCardConfigCommand "
(" #
CardConfigDto# 0
config1 7
)7 8
{ 
Config 
= 
config 
; 
} 
} „
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\RoleCommands.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
record 
CreateRoleCommand 
(  
string  &
Name' +
,+ ,
UserPermission- ;
Permissions< G
)G H
;H I
public 
record 
CreateRoleResult 
( 
bool #
	IsSuccess$ -
,- .
Guid/ 3
RoleId4 :
,: ;
string< B
MessageC J
)J K
;K L
public		 
record		 
UpdateRoleCommand		 
(		  
Guid		  $
RoleId		% +
,		+ ,
string		- 3
Name		4 8
,		8 9
UserPermission		: H
Permissions		I T
)		T U
;		U V
public

 
record

 
UpdateRoleResult

 
(

 
bool

 #
	IsSuccess

$ -
,

- .
string

/ 5
Message

6 =
)

= >
;

> ?
public 
record 
DeleteRoleCommand 
(  
Guid  $
RoleId% +
)+ ,
;, -
public 
record 
DeleteRoleResult 
( 
bool #
	IsSuccess$ -
,- .
string/ 5
Message6 =
)= >
;> ?Æ
åC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\DeleteRoleCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public 
class $
DeleteRoleCommandHandler %
:& '
ICommandHandler( 7
<7 8
DeleteRoleCommand8 I
,I J
DeleteRoleResultK [
>[ \
{		 
private

 
readonly

 
IRoleRepository

 $
_roleRepository

% 4
;

4 5
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
public 
$
DeleteRoleCommandHandler #
(# $
IRoleRepository$ 3
roleRepository4 B
,B C
IUserRepositoryD S
userRepositoryT b
)b c
{ 
_roleRepository 
= 
roleRepository (
;( )
_userRepository 
= 
userRepository (
;( )
} 
public 

async 
Task 
< 
DeleteRoleResult &
>& '
HandleAsync( 3
(3 4
DeleteRoleCommand4 E
commandF M
,M N
CancellationTokenO `
cancellationTokena r
=s t
defaultu |
)| }
{ 
try 
{ 	
var 
role 
= 
await 
_roleRepository ,
., -
GetByIdAsync- 9
(9 :
command: A
.A B
RoleIdB H
)H I
;I J
if 
( 
role 
== 
null 
) 
return 
new 
DeleteRoleResult +
(+ ,
false, 1
,1 2
$str3 D
)D E
;E F
var 
hasUsers 
= 
await  
_userRepository! 0
.0 1
HasUsersInRoleAsync1 D
(D E
commandE L
.L M
RoleIdM S
,S T
cancellationTokenU f
)f g
;g h
if 
( 
hasUsers 
) 
{ 
return 
new 
DeleteRoleResult +
(+ ,
false, 1
,1 2
$str3 m
)m n
;n o
}   
await"" 
_roleRepository""  
.""  !
DeleteAsync""! ,
("", -
role""- 1
,""1 2
cancellationToken""3 D
)""D E
;""E F
return$$ 
new$$ 
DeleteRoleResult$$ '
($$' (
true$$( ,
,$$, -
$str$$. J
)$$J K
;$$K L
}%% 	
catch&& 
(&& 
	Exception&& 
ex&& 
)&& 
{'' 	
return(( 
new(( 
DeleteRoleResult(( '
(((' (
false((( -
,((- .
ex((/ 1
.((1 2
Message((2 9
)((9 :
;((: ;
})) 	
}** 
}++ ¨
åC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SystemConfig\CreateRoleCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
.' (
SystemConfig( 4
;4 5
public		 
class		 $
CreateRoleCommandHandler		 %
:		& '
ICommandHandler		( 7
<		7 8
CreateRoleCommand		8 I
,		I J
CreateRoleResult		K [
>		[ \
{

 
private 
readonly 
IRoleRepository $
_roleRepository% 4
;4 5
public 
$
CreateRoleCommandHandler #
(# $
IRoleRepository$ 3
roleRepository4 B
)B C
{ 
_roleRepository 
= 
roleRepository (
;( )
} 
public 

async 
Task 
< 
CreateRoleResult &
>& '
HandleAsync( 3
(3 4
CreateRoleCommand4 E
commandF M
,M N
CancellationTokenO `
cancellationTokena r
=s t
defaultu |
)| }
{ 
try 
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
command* 1
.1 2
Name2 6
)6 7
)7 8
return 
new 
CreateRoleResult +
(+ ,
false, 1
,1 2
Guid3 7
.7 8
Empty8 =
,= >
$str? [
)[ \
;\ ]
var 
existing 
= 
await  
_roleRepository! 0
.0 1
GetByNameAsync1 ?
(? @
command@ G
.G H
NameH L
,L M
cancellationTokenN _
)_ `
;` a
if 
( 
existing 
!= 
null  
)  !
return 
new 
CreateRoleResult +
(+ ,
false, 1
,1 2
Guid3 7
.7 8
Empty8 =
,= >
$"? A
$strA W
{W X
commandX _
._ `
Name` d
}d e
$stre v
"v w
)w x
;x y
var 
role 
= 
Role 
. 
Create "
(" #
command# *
.* +
Name+ /
,/ 0
command1 8
.8 9
Permissions9 D
)D E
;E F
await 
_roleRepository !
.! "
AddAsync" *
(* +
role+ /
,/ 0
cancellationToken1 B
)B C
;C D
return!! 
new!! 
CreateRoleResult!! '
(!!' (
true!!( ,
,!!, -
role!!. 2
.!!2 3
Id!!3 5
,!!5 6
$str!!7 S
)!!S T
;!!T U
}"" 	
catch## 
(## 
	Exception## 
ex## 
)## 
{$$ 	
return%% 
new%% 
CreateRoleResult%% '
(%%' (
false%%( -
,%%- .
Guid%%/ 3
.%%3 4
Empty%%4 9
,%%9 :
ex%%; =
.%%= >
Message%%> E
)%%E F
;%%F G
}&& 	
}'' 
}(( ˇ
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SplitTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public

 
class

 
SplitTicketCommand

 
{ 
public 

Guid 
OriginalTicketId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

List 
< 
Guid 
> 
OrderLineIdsToSplit )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
new: =
(= >
)> ?
;? @
public 

UserId 
SplitBy 
{ 
get 
;  
set! $
;$ %
}& '
=( )
null* .
!. /
;/ 0
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

Guid 
OrderTypeId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
GlobalId 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 
class 
SplitTicketResult 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Guid 
NewTicketId 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
NewTicketNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

int 
OrderLinesMoved 
{  
get! $
;$ %
set& )
;) *
}+ ,
} ŸÇ
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SplitBySeatCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
{ 
public 

class %
SplitBySeatCommandHandler *
:+ ,
ICommandHandler- <
<< =
SplitBySeatCommand= O
,O P
SplitBySeatResultQ b
>b c
{ 
private 
readonly 
ITicketRepository *
_ticketRepository+ <
;< =
private 
readonly 
IEventPublisher (
_eventPublisher) 8
;8 9
public %
SplitBySeatCommandHandler (
(( )
ITicketRepository 
ticketRepository .
,. /
IEventPublisher 
eventPublisher *
)* +
{ 	
_ticketRepository 
= 
ticketRepository  0
;0 1
_eventPublisher 
= 
eventPublisher ,
;, -
} 	
public 
async 
Task 
< 
SplitBySeatResult +
>+ ,
HandleAsync- 8
(8 9
SplitBySeatCommand9 K
commandL S
,S T
CancellationTokenU f
cancellationTokeng x
=y z
default	{ Ç
)
Ç É
{ 	
var 
originalTicket 
=  
await! &
_ticketRepository' 8
.8 9
GetByIdAsync9 E
(E F
commandF M
.M N
OriginalTicketIdN ^
,^ _
cancellationToken` q
)q r
;r s
if   
(   
originalTicket   
==   !
null  " &
)  & '
{!! 
return"" 
new"" 
SplitBySeatResult"" ,
{## 
Success$$ 
=$$ 
false$$ #
,$$# $
OriginalTicketId%% $
=%%% &
command%%' .
.%%. /
OriginalTicketId%%/ ?
,%%? @
ErrorMessage&&  
=&&! "
$str&&# >
}'' 
;'' 
}(( 
var++ 
validationResult++  
=++! ""
ValidateTicketForSplit++# 9
(++9 :
originalTicket++: H
)++H I
;++I J
if,, 
(,, 
!,, 
validationResult,, !
.,,! "
IsValid,," )
),,) *
{-- 
return.. 
new.. 
SplitBySeatResult.. ,
{// 
Success00 
=00 
false00 #
,00# $
OriginalTicketId11 $
=11% &
command11' .
.11. /
OriginalTicketId11/ ?
,11? @
ErrorMessage22  
=22! "
validationResult22# 3
.223 4
ErrorMessage224 @
}33 
;33 
}44 
var77 

seatGroups77 
=77 
GroupItemsBySeat77 -
(77- .
originalTicket77. <
.77< =

OrderLines77= G
)77G H
;77H I
if88 
(88 

seatGroups88 
.88 
Count88  
<=88! #
$num88$ %
)88% &
{99 
return:: 
new:: 
SplitBySeatResult:: ,
{;; 
Success<< 
=<< 
false<< #
,<<# $
OriginalTicketId== $
===% &
command==' .
.==. /
OriginalTicketId==/ ?
,==? @
ErrorMessage>>  
=>>! "
$str>># X
}?? 
;?? 
}@@ 
usingCC 
varCC 
transactionCC !
=CC" #
awaitCC$ )
_ticketRepositoryCC* ;
.CC; <!
BeginTransactionAsyncCC< Q
(CCQ R
cancellationTokenCCR c
)CCc d
;CCd e
tryEE 
{FF 
varGG 

newTicketsGG 
=GG  
newGG! $
ListGG% )
<GG) *
TicketGG* 0
>GG0 1
(GG1 2
)GG2 3
;GG3 4
varHH 
seatToTicketMappingHH '
=HH( )
newHH* -

DictionaryHH. 8
<HH8 9
intHH9 <
,HH< =
GuidHH> B
>HHB C
(HHC D
)HHD E
;HHE F
foreachKK 
(KK 
varKK 
	seatGroupKK &
inKK' )

seatGroupsKK* 4
)KK4 5
{LL 
varMM 
	newTicketMM !
=MM" #
CreateTicketForSeatMM$ 7
(MM7 8
originalTicketMM8 F
,MMF G
	seatGroupMMH Q
.MMQ R
KeyMMR U
,MMU V
	seatGroupMMW `
.MM` a
ValueMMa f
,MMf g
commandMMh o
.MMo p
ProcessedByMMp {
,MM{ |
command	MM} Ñ
.
MMÑ Ö

TerminalId
MMÖ è
)
MMè ê
;
MMê ë
awaitNN 
_ticketRepositoryNN +
.NN+ ,
AddAsyncNN, 4
(NN4 5
	newTicketNN5 >
,NN> ?
cancellationTokenNN@ Q
)NNQ R
;NNR S

newTicketsOO 
.OO 
AddOO "
(OO" #
	newTicketOO# ,
)OO, -
;OO- .
seatToTicketMappingPP '
[PP' (
	seatGroupPP( 1
.PP1 2
KeyPP2 5
]PP5 6
=PP7 8
	newTicketPP9 B
.PPB C
IdPPC E
;PPE F
}QQ 
originalTicketTT 
.TT 
CloseTT $
(TT$ %
commandTT% ,
.TT, -
ProcessedByTT- 8
)TT8 9
;TT9 :
awaitUU 
_ticketRepositoryUU '
.UU' (
UpdateAsyncUU( 3
(UU3 4
originalTicketUU4 B
,UUB C
cancellationTokenUUD U
)UUU V
;UUV W
awaitXX #
PublishSplitBySeatEventXX -
(XX- .
commandXX. 5
,XX5 6
originalTicketXX7 E
,XXE F

newTicketsXXG Q
,XXQ R
seatToTicketMappingXXS f
)XXf g
;XXg h
await[[ 
transaction[[ !
.[[! "
CommitAsync[[" -
([[- .
cancellationToken[[. ?
)[[? @
;[[@ A
return]] 
new]] 
SplitBySeatResult]] ,
{^^ 
Success__ 
=__ 
true__ "
,__" #
OriginalTicketId`` $
=``% &
command``' .
.``. /
OriginalTicketId``/ ?
,``? @
NewTicketIdsaa  
=aa! "

newTicketsaa# -
.aa- .
Selectaa. 4
(aa4 5
taa5 6
=>aa7 9
taa: ;
.aa; <
Idaa< >
)aa> ?
.aa? @
ToListaa@ F
(aaF G
)aaG H
,aaH I
SeatToTicketMappingbb '
=bb( )
seatToTicketMappingbb* =
}cc 
;cc 
}dd 
catchee 
(ee 
	Exceptionee 
)ee 
{ff 
awaithh 
transactionhh !
.hh! "
RollbackAsynchh" /
(hh/ 0
cancellationTokenhh0 A
)hhA B
;hhB C
throwii 
;ii 
}jj 
}kk 	
privatemm !
SplitValidationResultmm %"
ValidateTicketForSplitmm& <
(mm< =
Ticketmm= C
ticketmmD J
)mmJ K
{nn 	
ifoo 
(oo 
ticketoo 
.oo 
Statusoo 
!=oo  
TicketStatusoo! -
.oo- .
Openoo. 2
)oo2 3
{pp 
returnqq 
newqq !
SplitValidationResultqq 0
{qq1 2
IsValidqq3 :
=qq; <
falseqq= B
,qqB C
ErrorMessageqqD P
=qqQ R
$strqqS g
}qqh i
;qqi j
}rr 
iftt 
(tt 
tickettt 
.tt 
Paymentstt 
.tt  
Anytt  #
(tt# $
)tt$ %
)tt% &
{uu 
returnvv 
newvv !
SplitValidationResultvv 0
{vv1 2
IsValidvv3 :
=vv; <
falsevv= B
,vvB C
ErrorMessagevvD P
=vvQ R
$strvvS v
}vvw x
;vvx y
}ww 
ifyy 
(yy 
!yy 
ticketyy 
.yy 

OrderLinesyy "
.yy" #
Anyyy# &
(yy& '
)yy' (
)yy( )
{zz 
return{{ 
new{{ !
SplitValidationResult{{ 0
{{{1 2
IsValid{{3 :
={{; <
false{{= B
,{{B C
ErrorMessage{{D P
={{Q R
$str{{S q
}{{r s
;{{s t
}|| 
return~~ 
new~~ !
SplitValidationResult~~ ,
{~~- .
IsValid~~/ 6
=~~7 8
true~~9 =
}~~> ?
;~~? @
} 	
private
ÅÅ 

Dictionary
ÅÅ 
<
ÅÅ 
int
ÅÅ 
,
ÅÅ 
List
ÅÅ  $
<
ÅÅ$ %
	OrderLine
ÅÅ% .
>
ÅÅ. /
>
ÅÅ/ 0
GroupItemsBySeat
ÅÅ1 A
(
ÅÅA B!
IReadOnlyCollection
ÅÅB U
<
ÅÅU V
	OrderLine
ÅÅV _
>
ÅÅ_ `

orderLines
ÅÅa k
)
ÅÅk l
{
ÇÇ 	
var
ÉÉ 

seatGroups
ÉÉ 
=
ÉÉ 
new
ÉÉ  

Dictionary
ÉÉ! +
<
ÉÉ+ ,
int
ÉÉ, /
,
ÉÉ/ 0
List
ÉÉ1 5
<
ÉÉ5 6
	OrderLine
ÉÉ6 ?
>
ÉÉ? @
>
ÉÉ@ A
(
ÉÉA B
)
ÉÉB C
;
ÉÉC D
foreach
ÖÖ 
(
ÖÖ 
var
ÖÖ 
	orderLine
ÖÖ "
in
ÖÖ# %

orderLines
ÖÖ& 0
)
ÖÖ0 1
{
ÜÜ 
var
áá 

seatNumber
áá 
=
áá  
	orderLine
áá! *
.
áá* +

SeatNumber
áá+ 5
??
áá6 8
$num
áá9 :
;
áá: ;
if
ââ 
(
ââ 
!
ââ 

seatGroups
ââ 
.
ââ  
ContainsKey
ââ  +
(
ââ+ ,

seatNumber
ââ, 6
)
ââ6 7
)
ââ7 8
{
ää 

seatGroups
ãã 
[
ãã 

seatNumber
ãã )
]
ãã) *
=
ãã+ ,
new
ãã- 0
List
ãã1 5
<
ãã5 6
	OrderLine
ãã6 ?
>
ãã? @
(
ãã@ A
)
ããA B
;
ããB C
}
åå 

seatGroups
éé 
[
éé 

seatNumber
éé %
]
éé% &
.
éé& '
Add
éé' *
(
éé* +
	orderLine
éé+ 4
)
éé4 5
;
éé5 6
}
èè 
return
ëë 

seatGroups
ëë 
;
ëë 
}
íí 	
private
îî 
Ticket
îî !
CreateTicketForSeat
îî *
(
îî* +
Ticket
îî+ 1
originalTicket
îî2 @
,
îî@ A
int
îîB E

seatNumber
îîF P
,
îîP Q
List
îîR V
<
îîV W
	OrderLine
îîW `
>
îî` a
items
îîb g
,
îîg h
UserId
îîi o
processedBy
îîp {
,
îî{ |
Guidîî} Å

terminalIdîîÇ å
)îîå ç
{
ïï 	
var
óó 
nextTicketNumber
óó  
=
óó! "
originalTicket
óó# 1
.
óó1 2
TicketNumber
óó2 >
+
óó? @
$num
óóA B
;
óóB C
var
ôô 
	newTicket
ôô 
=
ôô 
Ticket
ôô "
.
ôô" #
Create
ôô# )
(
ôô) *
nextTicketNumber
öö  
,
öö  !
processedBy
õõ 
,
õõ 

terminalId
úú 
,
úú 
originalTicket
ùù 
.
ùù 
ShiftId
ùù &
,
ùù& '
originalTicket
ûû 
.
ûû 
OrderTypeId
ûû *
,
ûû* +
Guid
üü 
.
üü 
NewGuid
üü 
(
üü 
)
üü 
.
üü 
ToString
üü '
(
üü' (
)
üü( )
)
†† 
;
†† 
	newTicket
££ 
.
££ 
Open
££ 
(
££ 
)
££ 
;
££ 
foreach
¶¶ 
(
¶¶ 
var
¶¶ 
item
¶¶ 
in
¶¶  
items
¶¶! &
)
¶¶& '
{
ßß 
var
©© 
newItem
©© 
=
©© 
	OrderLine
©© '
.
©©' (
Create
©©( .
(
©©. /
	newTicket
™™ 
.
™™ 
Id
™™  
,
™™  !
item
´´ 
.
´´ 

MenuItemId
´´ #
,
´´# $
item
¨¨ 
.
¨¨ 
MenuItemName
¨¨ %
,
¨¨% &
item
≠≠ 
.
≠≠ 
Quantity
≠≠ !
,
≠≠! "
item
ÆÆ 
.
ÆÆ 
	UnitPrice
ÆÆ "
,
ÆÆ" #
item
ØØ 
.
ØØ 
TaxRate
ØØ  
,
ØØ  !
item
∞∞ 
.
∞∞ 
CategoryName
∞∞ %
,
∞∞% &
item
±± 
.
±± 
	GroupName
±± "
)
≤≤ 
;
≤≤ 
foreach
µµ 
(
µµ 
var
µµ 
modifier
µµ %
in
µµ& (
item
µµ) -
.
µµ- .
	Modifiers
µµ. 7
)
µµ7 8
{
∂∂ 
newItem
∑∑ 
.
∑∑ 
AddModifier
∑∑ '
(
∑∑' (
modifier
∑∑( 0
)
∑∑0 1
;
∑∑1 2
}
∏∏ 
	newTicket
∫∫ 
.
∫∫ 
AddOrderLine
∫∫ &
(
∫∫& '
newItem
∫∫' .
)
∫∫. /
;
∫∫/ 0
}
ªª 
return
ΩΩ 
	newTicket
ΩΩ 
;
ΩΩ 
}
ææ 	
private
¿¿ 
async
¿¿ 
Task
¿¿ %
PublishSplitBySeatEvent
¿¿ 2
(
¿¿2 3 
SplitBySeatCommand
¿¿3 E
command
¿¿F M
,
¿¿M N
Ticket
¿¿O U
originalTicket
¿¿V d
,
¿¿d e
List
¿¿f j
<
¿¿j k
Ticket
¿¿k q
>
¿¿q r

newTickets
¿¿s }
,
¿¿} ~

Dictionary¿¿ â
<¿¿â ä
int¿¿ä ç
,¿¿ç é
Guid¿¿è ì
>¿¿ì î#
seatToTicketMapping¿¿ï ®
)¿¿® ©
{
¡¡ 	
var
¬¬ 

splitEvent
¬¬ 
=
¬¬ 
new
¬¬  $
TicketSplitBySeatEvent
¬¬! 7
(
¬¬7 8
originalTicket
√√ 
.
√√ 
Id
√√ !
,
√√! "

newTickets
ƒƒ 
.
ƒƒ 
Select
ƒƒ !
(
ƒƒ! "
t
ƒƒ" #
=>
ƒƒ$ &
t
ƒƒ' (
.
ƒƒ( )
Id
ƒƒ) +
)
ƒƒ+ ,
.
ƒƒ, -
ToList
ƒƒ- 3
(
ƒƒ3 4
)
ƒƒ4 5
,
ƒƒ5 6!
seatToTicketMapping
≈≈ #
.
≈≈# $
Count
≈≈$ )
,
≈≈) *!
seatToTicketMapping
∆∆ #
.
∆∆# $
ToDictionary
∆∆$ 0
(
∆∆0 1
kvp
«« 
=>
«« 
kvp
«« 
.
«« 
Key
«« "
,
««" #
kvp
»» 
=>
»» 

newTickets
»» %
.
»»% &
First
»»& +
(
»»+ ,
t
»», -
=>
»». 0
t
»»1 2
.
»»2 3
Id
»»3 5
==
»»6 8
kvp
»»9 <
.
»»< =
Value
»»= B
)
»»B C
.
»»C D

OrderLines
»»D N
.
»»N O
Count
»»O T
)
…… 
,
…… 
command
   
.
   
ProcessedBy
   #
,
  # $
Guid
ÀÀ 
.
ÀÀ 
NewGuid
ÀÀ 
(
ÀÀ 
)
ÀÀ 
)
ÃÃ 
;
ÃÃ 
await
ŒŒ 
_eventPublisher
ŒŒ !
.
ŒŒ! "
PublishAsync
ŒŒ" .
(
ŒŒ. /

splitEvent
ŒŒ/ 9
)
ŒŒ9 :
;
ŒŒ: ;
}
œœ 	
}
–– 
internal
““ 
class
““ #
SplitValidationResult
““ (
{
”” 
public
‘‘ 
bool
‘‘ 
IsValid
‘‘ 
{
‘‘ 
get
‘‘ !
;
‘‘! "
set
‘‘# &
;
‘‘& '
}
‘‘( )
public
’’ 
string
’’ 
?
’’ 
ErrorMessage
’’ #
{
’’$ %
get
’’& )
;
’’) *
set
’’+ .
;
’’. /
}
’’0 1
}
÷÷ 
}◊◊ Ø
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SplitBySeatCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
{ 
public 

class 
SplitBySeatCommand #
{ 
public 
Guid 
OriginalTicketId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public		 
UserId		 
ProcessedBy		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
=		0 1
null		2 6
!		6 7
;		7 8
public

 
Guid

 

TerminalId

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
GlobalId 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
} 
public 

class 
SplitBySeatResult "
{ 
public 
bool 
Success 
{ 
get !
;! "
set# &
;& '
}( )
public 
Guid 
OriginalTicketId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
List 
< 
Guid 
> 
NewTicketIds &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
(: ;
); <
;< =
public 

Dictionary 
< 
int 
, 
Guid #
># $
SeatToTicketMapping% 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
=G H
newI L
(L M
)M N
;N O
public 
string 
? 
ErrorMessage #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} ï
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SettleTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
SettleTicketCommand  
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
UserId		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
}

 «

zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SetTaxExemptCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
SetTaxExemptCommand  
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
IsTaxExempt 
{ 
get !
;! "
set# &
;& '
}( )
public		 

UserId		 

ModifiedBy		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
=		+ ,
null		- 1
!		1 2
;		2 3
}

 
public 
class 
SetTaxExemptResult 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
=& '
true( ,
;, -
public 

string 
? 
Error 
{ 
get 
; 
set  #
;# $
}% &
} ∆
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SetServiceChargeCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 #
SetServiceChargeCommand		 $
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
} 
public 
class "
SetServiceChargeResult #
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Money 
NewTotalAmount 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} …
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SetDeliveryChargeCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 $
SetDeliveryChargeCommand		 %
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
} 
public 
class #
SetDeliveryChargeResult $
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Money 
NewTotalAmount 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} ﬁ
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SetCustomerCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
SetCustomerCommand 
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

string		 
?		 
	GuestName		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 

string

 
?

 
PhoneNumber

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 

UserId 

ModifiedBy 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 
class 
SetCustomerResult 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
ErrorMessage 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
} …
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SetAdvancePaymentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 $
SetAdvancePaymentCommand		 %
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
} 
public 
class #
SetAdvancePaymentResult $
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Money 
NewTotalAmount 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} Ê
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\SetAdjustmentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		  
SetAdjustmentCommand		 !
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 
SetAdjustmentResult  
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Money 
NewTotalAmount 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} î
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ServerSectionCommands.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
record &
CreateServerSectionCommand (
(( )
string 

Name 
, 
Guid 
ServerId	 
, 
string		 

Description		 
=		 
$str		 
,		 
string

 

Color

 
=

 
$str

 
) 
: 
IRequest 
< 
ServerSectionDto 
> 
; 
public 
record &
UpdateServerSectionCommand (
(( )
Guid 
	SectionId	 
, 
string 

Name 
, 
string 

Description 
= 
$str 
, 
string 

Color 
= 
$str 
) 
: 
IRequest 
< 
ServerSectionDto 
> 
; 
public 
record &
DeleteServerSectionCommand (
(( )
Guid 
	SectionId	 
) 
: 
IRequest 
< 
bool 
> 
; 
public 
record .
"AssignTablesToServerSectionCommand 0
(0 1
Guid 
	SectionId	 
, 
List 
< 	
Guid	 
> 
TableIds 
) 
: 
IRequest 
< 
ServerSectionDto 
> 
; 
public 
record 0
$RemoveTablesFromServerSectionCommand 2
(2 3
Guid 
	SectionId	 
, 
List 
< 	
Guid	 
> 
TableIds 
)   
:   
IRequest   
<   
ServerSectionDto   
>   
;   
public"" 
record"" )
UpdateServerAssignmentCommand"" +
(""+ ,
Guid## 
	SectionId##	 
,## 
Guid$$ 
NewServerId$$	 
)%% 
:%% 
IRequest%% 
<%% 
ServerSectionDto%% 
>%% 
;%% 
public'' 
record'' "
GetServerSectionsQuery'' $
(''$ %
Guid(( 
?(( 	
ServerId((
 
=(( 
null(( 
,(( 
bool)) 
IncludeInactive))	 
=)) 
false))  
)** 
:** 
IRequest** 
<** 
List** 
<** 
ServerSectionDto** "
>**" #
>**# $
;**$ %
public,, 
record,, %
GetServerAssignmentsQuery,, '
(,,' (
bool-- 
IncludeInactive--	 
=-- 
false--  
).. 
:.. 
IRequest.. 
<.. 
List.. 
<.. 
ServerAssignmentDto.. %
>..% &
>..& '
;..' (†
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\RemoveOrderLineCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class "
RemoveOrderLineCommand #
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
OrderLineId		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
}

 Ù
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ReleaseTableCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
ReleaseTableCommand  
{ 
public 

Guid 
TableId 
{ 
get 
; 
set "
;" #
}$ %
}		 
public 
class 
ReleaseTableResult 
{ 
public 

Guid 
TableId 
{ 
get 
; 
set "
;" #
}$ %
} Ì
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\RefundTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 
RefundTicketCommand		  
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 
RefundTicketResult 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int !
RefundPaymentsCreated $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} º
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\RefundPaymentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		  
RefundPaymentCommand		 !
{

 
public 

Guid 
OriginalPaymentId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

Money 
RefundAmount 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
? 
GlobalId 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 
class 
RefundPaymentResult  
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Guid 
RefundPaymentId 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
TicketFullyRefunded #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} ¯
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ProcessPaymentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 !
ProcessPaymentCommand		 "
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

PaymentType 
PaymentType "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

Money 
? 
TenderAmount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

Money 
? 

TipsAmount 
{ 
get "
;" #
set$ '
;' (
}) *
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
? 
CashSessionId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
Note 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
GlobalId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
CardType 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
Last4 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
AuthCode 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
GiftCardNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
public   
class    
ProcessPaymentResult   !
{!! 
public"" 

Guid"" 
	PaymentId"" 
{"" 
get"" 
;""  
set""! $
;""$ %
}""& '
public## 

Money## 
ChangeAmount## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
=##, -
null##. 2
!##2 3
;##3 4
public$$ 

bool$$ 
TicketIsPaid$$ 
{$$ 
get$$ "
;$$" #
set$$$ '
;$$' (
}$$) *
}%% œ
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\PrintToKitchenCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class !
PrintToKitchenCommand "
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
?		 
OrderLineId		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
}

 
public 
class  
PrintToKitchenResult !
{ 
public 

int 
OrderLinesPrinted  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
Message 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
public 

List 
< 
string 
> 
Errors 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
new/ 2
(2 3
)3 4
;4 5
} œ

zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\PrintReceiptCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
PrintReceiptCommand  
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
?		 
	PaymentId		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 

ReceiptType

 
ReceiptType

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
=

1 2
ReceiptType

3 >
.

> ?
Ticket

? E
;

E F
} 
public 
enum 
ReceiptType 
{ 
Ticket 

,
 
Payment 
, 
Refund 

} 
public 
class 
PrintReceiptResult 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
} ”
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\PayNowCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 
PayNowCommand		 
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

decimal 
Amount 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 

TenderType 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
$str- 3
;3 4
public 

bool 
AutoPrintReceipt  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
true1 5
;5 6
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
} 
public 
class 
PayNowResult 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
Message 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
public 

decimal 

PaidAmount 
{ 
get  #
;# $
set% (
;( )
}* +
public 

List 
< 
string 
> 
Errors 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
new/ 2
(2 3
)3 4
;4 5
public 

static 
PayNowResult 
Failure &
(& '
string' -
message. 5
)5 6
=>7 9
new: =
(= >
)> ?
{@ A
SuccessB I
=J K
falseL Q
,Q R
MessageS Z
=[ \
message] d
}e f
;f g
public 

static 
PayNowResult 

Successful )
() *
decimal* 1
amount2 8
)8 9
=>: <
new= @
(@ A
)A B
{C D
SuccessE L
=M N
trueO S
,S T

PaidAmountU _
=` a
amountb h
}i j
;j k
} ˆ
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\OpenCashSessionCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class "
OpenCashSessionCommand #
{		 
public

 

UserId

 
UserId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
=

' (
null

) -
!

- .
;

. /
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

Money 
OpeningBalance 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} 
public 
class !
OpenCashSessionResult "
{ 
public 

Guid 
CashSessionId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
OpenedAt 
{ 
get "
;" #
set$ '
;' (
}) *
} ˜
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\OpenCashDrawerCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class !
OpenCashDrawerCommand "
{ 
public 

string 
? 
PrinterName 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public

 
class

 (
OpenCashDrawerCommandHandler

 )
:

* +
ICommandHandler

, ;
<

; <!
OpenCashDrawerCommand

< Q
>

Q R
{ 
private 
readonly 
ICashDrawerService '
_cashDrawerService( :
;: ;
private 
readonly  
IReceiptPrintService ) 
_receiptPrintService* >
;> ?
public 
(
OpenCashDrawerCommandHandler '
(' (
ICashDrawerService( :
cashDrawerService; L
,L M 
IReceiptPrintServiceN b
receiptPrintServicec v
)v w
{ 
_cashDrawerService 
= 
cashDrawerService .
;. / 
_receiptPrintService 
= 
receiptPrintService 2
;2 3
} 
public 

async 
Task 
HandleAsync !
(! "!
OpenCashDrawerCommand" 7
command8 ?
,? @
CancellationTokenA R
cancellationTokenS d
=e f
defaultg n
)n o
{ 
if 

( 
string 
. 
IsNullOrWhiteSpace %
(% &
command& -
.- .
PrinterName. 9
)9 :
): ;
{ 	
await  
_receiptPrintService &
.& '
OpenCashDrawerAsync' :
(: ;
cancellationToken; L
)L M
;M N
} 	
else 
{ 	
await 
_cashDrawerService $
.$ %
OpenDrawerAsync% 4
(4 5
command5 <
.< =
PrinterName= H
)H I
;I J
} 	
}   
}!! ü

}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ModifyOrderLineCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class "
ModifyOrderLineCommand #
{		 
public

 

Guid

 
TicketId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

Guid 
OrderLineId 
{ 
get !
;! "
set# &
;& '
}( )
public 

decimal 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
Instructions 
{  !
get" %
;% &
set' *
;* +
}, -
public 

List 
< 
Application 
. 
DTOs  
.  ! 
OrderLineModifierDto! 5
>5 6
?6 7
	Modifiers8 A
{B C
getD G
;G H
setI L
;L M
}N O
} Ã
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ModifierCommands.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 '
AddOrderLineModifierCommand		 (
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
OrderLineId 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 

ModifierId 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
=* +
$num, -
;- .
public 

string 
? 
SectionName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

Guid 
? %
ParentOrderLineModifierId *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 

UserId 
? 
AddedBy 
{ 
get  
;  !
set" %
;% &
}' (
} 
public 
class *
RemoveOrderLineModifierCommand +
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
OrderLineId 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 
OrderLineModifierId #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

UserId 
? 
	RemovedBy 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public"" 
class"" *
AddOrderLineInstructionCommand"" +
{## 
public$$ 

Guid$$ 
TicketId$$ 
{$$ 
get$$ 
;$$ 
set$$  #
;$$# $
}$$% &
public%% 

Guid%% 
OrderLineId%% 
{%% 
get%% !
;%%! "
set%%# &
;%%& '
}%%( )
public&& 

string&& 
Instruction&& 
{&& 
get&&  #
;&&# $
set&&% (
;&&( )
}&&* +
=&&, -
string&&. 4
.&&4 5
Empty&&5 :
;&&: ;
public'' 

UserId'' 
?'' 
AddedBy'' 
{'' 
get''  
;''  !
set''" %
;''% &
}''' (
}(( ¿
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\MergeTicketsCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
MergeTicketsCommand  
{ 
public 

Guid 
SourceTicketId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 

Guid		 
TargetTicketId		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 

Guid

 
ProcessedBy

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
} Ô
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\LogoutCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
LogoutCommand 
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
}		 ∫s
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\GroupSettleCommandHandler.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
{ 
public 

class %
GroupSettleCommandHandler *
:+ ,
ICommandHandler- <
<< =
GroupSettleCommand= O
,O P
GroupSettleResultQ b
>b c
{ 
private 
readonly 
ITicketRepository *
_ticketRepository+ <
;< =
private 
readonly 
IPaymentRepository +
_paymentRepository, >
;> ?
private 
readonly 
IEventPublisher (
_eventPublisher) 8
;8 9
private 
readonly "
ICashSessionRepository /"
_cashSessionRepository0 F
;F G
public %
GroupSettleCommandHandler (
(( )
ITicketRepository 
ticketRepository .
,. /
IPaymentRepository 
paymentRepository 0
,0 1
IEventPublisher 
eventPublisher *
,* +"
ICashSessionRepository "!
cashSessionRepository# 8
)8 9
{ 	
_ticketRepository 
= 
ticketRepository  0
;0 1
_paymentRepository 
=  
paymentRepository! 2
;2 3
_eventPublisher 
= 
eventPublisher ,
;, -"
_cashSessionRepository "
=# $!
cashSessionRepository% :
;: ;
}   	
public"" 
async"" 
Task"" 
<"" 
GroupSettleResult"" +
>""+ ,
HandleAsync""- 8
(""8 9
GroupSettleCommand""9 K
command""L S
,""S T
CancellationToken""U f
cancellationToken""g x
=""y z
default	""{ Ç
)
""Ç É
{## 	
var%% 
tickets%% 
=%% 
new%% 
List%% "
<%%" #
Ticket%%# )
>%%) *
(%%* +
)%%+ ,
;%%, -
foreach&& 
(&& 
var&& 
ticketId&& !
in&&" $
command&&% ,
.&&, -
	TicketIds&&- 6
)&&6 7
{'' 
var(( 
ticket(( 
=(( 
await(( "
_ticketRepository((# 4
.((4 5
GetByIdAsync((5 A
(((A B
ticketId((B J
)((J K
;((K L
if)) 
()) 
ticket)) 
==)) 
null)) "
)))" #
{** 
throw++ 
new++ %
InvalidOperationException++ 7
(++7 8
$"++8 :
$str++: A
{++A B
ticketId++B J
}++J K
$str++K U
"++U V
)++V W
;++W X
},, 
if-- 
(-- 
ticket-- 
.-- 
Status-- !
!=--" $
TicketStatus--% 1
.--1 2
Open--2 6
)--6 7
{.. 
throw// 
new// %
InvalidOperationException// 7
(//7 8
$"//8 :
$str//: A
{//A B
ticketId//B J
}//J K
$str//K W
"//W X
)//X Y
;//Y Z
}00 
tickets11 
.11 
Add11 
(11 
ticket11 "
)11" #
;11# $
}22 
var55 
totalDue55 
=55 
tickets55 "
.55" #
Sum55# &
(55& '
t55' (
=>55) +
t55, -
.55- .
	DueAmount55. 7
.557 8
Amount558 >
)55> ?
;55? @
if88 
(88 
command88 
.88 
Amount88 
.88 
Amount88 %
<88& '
totalDue88( 0
)880 1
{99 
throw:: 
new:: %
InvalidOperationException:: 3
(::3 4
$"::4 6
$str::6 E
{::E F
command::F M
.::M N
Amount::N T
.::T U
Amount::U [
}::[ \
$str::\ t
{::t u
totalDue::u }
}::} ~
"::~ 
)	:: Ä
;
::Ä Å
};; 
using>> 
var>> 
transaction>> !
=>>" #
await>>$ )
_ticketRepository>>* ;
.>>; <!
BeginTransactionAsync>>< Q
(>>Q R
)>>R S
;>>S T
try@@ 
{AA 
varBB 
paymentsBB 
=BB 
newBB "
ListBB# '
<BB' (
PaymentBB( /
>BB/ 0
(BB0 1
)BB1 2
;BB2 3
varCC 
settledTicketsCC "
=CC# $
newCC% (
ListCC) -
<CC- .
TicketCC. 4
>CC4 5
(CC5 6
)CC6 7
;CC7 8
foreachFF 
(FF 
varFF 
ticketFF #
inFF$ &
ticketsFF' .
)FF. /
{GG 
varII 
	ticketDueII !
=II" #
ticketII$ *
.II* +
	DueAmountII+ 4
.II4 5
AmountII5 ;
;II; <
varJJ 
ticketPaymentAmountJJ +
=JJ, -
	ticketDueJJ. 7
;JJ7 8
varMM 
paymentMM 
=MM  !"
CreatePaymentForTicketMM" 8
(MM8 9
commandMM9 @
,MM@ A
ticketMMB H
,MMH I
ticketPaymentAmountMMJ ]
)MM] ^
;MM^ _
awaitNN 
_paymentRepositoryNN ,
.NN, -
AddAsyncNN- 5
(NN5 6
paymentNN6 =
)NN= >
;NN> ?
paymentsOO 
.OO 
AddOO  
(OO  !
paymentOO! (
)OO( )
;OO) *
ticketRR 
.RR 

AddPaymentRR %
(RR% &
paymentRR& -
)RR- .
;RR. /
awaitSS 
_ticketRepositorySS +
.SS+ ,
UpdateAsyncSS, 7
(SS7 8
ticketSS8 >
)SS> ?
;SS? @
settledTicketsTT "
.TT" #
AddTT# &
(TT& '
ticketTT' -
)TT- .
;TT. /
}UU 
awaitXX #
PublishGroupSettleEventXX -
(XX- .
commandXX. 5
,XX5 6
ticketsXX7 >
,XX> ?
paymentsXX@ H
)XXH I
;XXI J
await[[ 
transaction[[ !
.[[! "
CommitAsync[[" -
([[- .
)[[. /
;[[/ 0
return]] 
new]] 
GroupSettleResult]] ,
{^^ 
Success__ 
=__ 
true__ "
,__" #
	TicketIds`` 
=`` 
command``  '
.``' (
	TicketIds``( 1
,``1 2

PaymentIdsaa 
=aa  
paymentsaa! )
.aa) *
Selectaa* 0
(aa0 1
paa1 2
=>aa3 5
paa6 7
.aa7 8
Idaa8 :
)aa: ;
.aa; <
ToListaa< B
(aaB C
)aaC D
,aaD E
TotalAmountbb 
=bb  !
commandbb" )
.bb) *
Amountbb* 0
,bb0 1
ChangeAmountcc  
=cc! "
newcc# &
Moneycc' ,
(cc, -
commandcc- 4
.cc4 5
TenderAmountcc5 A
.ccA B
AmountccB H
-ccI J
totalDueccK S
,ccS T
commandccU \
.cc\ ]
TenderAmountcc] i
.cci j
Currencyccj r
)ccr s
}dd 
;dd 
}ee 
catchff 
(ff 
	Exceptionff 
)ff 
{gg 
awaitii 
transactionii !
.ii! "
RollbackAsyncii" /
(ii/ 0
)ii0 1
;ii1 2
throwjj 
;jj 
}kk 
}ll 	
privatenn 
Paymentnn "
CreatePaymentForTicketnn .
(nn. /
GroupSettleCommandnn/ A
commandnnB I
,nnI J
TicketnnK Q
ticketnnR X
,nnX Y
decimalnnZ a
amountnnb h
)nnh i
{oo 	
Paymentpp 
paymentpp 
;pp 
ifrr 
(rr 
commandrr 
.rr 
PaymentTyperr #
==rr$ &
PaymentTyperr' 2
.rr2 3
Cashrr3 7
)rr7 8
{ss 
paymenttt 
=tt 
CashPaymenttt %
.tt% &
Creatett& ,
(tt, -
ticketuu 
.uu 
Iduu 
,uu 
newvv 
Moneyvv 
(vv 
amountvv $
,vv$ %
commandvv& -
.vv- .
Amountvv. 4
.vv4 5
Currencyvv5 =
)vv= >
,vv> ?
commandww 
.ww 
ProcessedByww '
,ww' (
commandxx 
.xx 

TerminalIdxx &
,xx& '
commandyy 
.yy 
GlobalIdyy $
)zz 
;zz 
}{{ 
else|| 
if|| 
(|| 
command|| 
.|| 
PaymentType|| (
==||) +
PaymentType||, 7
.||7 8

CreditCard||8 B
)||B C
{}} 
payment~~ 
=~~ 
CreditCardPayment~~ +
.~~+ ,
Create~~, 2
(~~2 3
ticket 
. 
Id 
, 
new
ÄÄ 
Money
ÄÄ 
(
ÄÄ 
amount
ÄÄ $
,
ÄÄ$ %
command
ÄÄ& -
.
ÄÄ- .
Amount
ÄÄ. 4
.
ÄÄ4 5
Currency
ÄÄ5 =
)
ÄÄ= >
,
ÄÄ> ?
command
ÅÅ 
.
ÅÅ 
ProcessedBy
ÅÅ '
,
ÅÅ' (
command
ÇÇ 
.
ÇÇ 

TerminalId
ÇÇ &
,
ÇÇ& '
null
ÉÉ 
,
ÉÉ 
$str
ÑÑ &
,
ÑÑ& '
command
ÖÖ 
.
ÖÖ 
AuthCode
ÖÖ $
,
ÖÖ$ %
null
ÜÜ 
,
ÜÜ 
command
áá 
.
áá 
CardType
áá $
,
áá$ %
command
àà 
.
àà 
GlobalId
àà $
)
ââ 
;
ââ 
if
åå 
(
åå 
!
åå 
string
åå 
.
åå 
IsNullOrEmpty
åå )
(
åå) *
command
åå* 1
.
åå1 2
AuthCode
åå2 :
)
åå: ;
)
åå; <
{
çç 
(
éé 
(
éé 
CreditCardPayment
éé '
)
éé' (
payment
éé( /
)
éé/ 0
.
éé0 1
	Authorize
éé1 :
(
éé: ;
command
éé; B
.
ééB C
AuthCode
ééC K
,
ééK L
null
ééM Q
,
ééQ R
command
ééS Z
.
ééZ [
CardType
éé[ c
)
ééc d
;
ééd e
}
èè 
}
êê 
else
ëë 
{
íí 
throw
îî 
new
îî #
NotSupportedException
îî /
(
îî/ 0
$"
îî0 2
$str
îî2 ?
{
îî? @
command
îî@ G
.
îîG H
PaymentType
îîH S
}
îîS T
$str
îîT z
"
îîz {
)
îî{ |
;
îî| }
}
ïï 
return
óó 
payment
óó 
;
óó 
}
òò 	
private
öö 
async
öö 
Task
öö %
PublishGroupSettleEvent
öö 2
(
öö2 3 
GroupSettleCommand
öö3 E
command
ööF M
,
ööM N
List
ööO S
<
ööS T
Ticket
ööT Z
>
ööZ [
tickets
öö\ c
,
ööc d
List
ööe i
<
ööi j
Payment
ööj q
>
ööq r
payments
öös {
)
öö{ |
{
õõ 	
var
úú 
groupSettleEvent
úú  
=
úú! "
new
úú# &
GroupSettled
úú' 3
(
úú3 4
command
ùù 
.
ùù 
	TicketIds
ùù !
,
ùù! "
command
ûû 
.
ûû 
Amount
ûû 
,
ûû 
command
üü 
.
üü 
PaymentType
üü #
,
üü# $
command
†† 
.
†† 
ProcessedBy
†† #
,
††# $
payments
°° 
.
°° 
Select
°° 
(
°°  
p
°°  !
=>
°°" $
p
°°% &
.
°°& '
Id
°°' )
)
°°) *
.
°°* +
ToList
°°+ 1
(
°°1 2
)
°°2 3
)
¢¢ 
;
¢¢ 
await
§§ 
_eventPublisher
§§ !
.
§§! "
PublishAsync
§§" .
(
§§. /
groupSettleEvent
§§/ ?
)
§§? @
;
§§@ A
}
•• 	
}
¶¶ 
public
®® 

class
®® 
GroupSettleResult
®® "
{
©© 
public
™™ 
bool
™™ 
Success
™™ 
{
™™ 
get
™™ !
;
™™! "
set
™™# &
;
™™& '
}
™™( )
public
´´ 
List
´´ 
<
´´ 
Guid
´´ 
>
´´ 
	TicketIds
´´ #
{
´´$ %
get
´´& )
;
´´) *
set
´´+ .
;
´´. /
}
´´0 1
=
´´2 3
new
´´4 7
(
´´7 8
)
´´8 9
;
´´9 :
public
¨¨ 
List
¨¨ 
<
¨¨ 
Guid
¨¨ 
>
¨¨ 

PaymentIds
¨¨ $
{
¨¨% &
get
¨¨' *
;
¨¨* +
set
¨¨, /
;
¨¨/ 0
}
¨¨1 2
=
¨¨3 4
new
¨¨5 8
(
¨¨8 9
)
¨¨9 :
;
¨¨: ;
public
≠≠ 
Money
≠≠ 
TotalAmount
≠≠  
{
≠≠! "
get
≠≠# &
;
≠≠& '
set
≠≠( +
;
≠≠+ ,
}
≠≠- .
=
≠≠/ 0
new
≠≠1 4
(
≠≠4 5
$num
≠≠5 7
,
≠≠7 8
$str
≠≠9 >
)
≠≠> ?
;
≠≠? @
public
ÆÆ 
Money
ÆÆ 
ChangeAmount
ÆÆ !
{
ÆÆ" #
get
ÆÆ$ '
;
ÆÆ' (
set
ÆÆ) ,
;
ÆÆ, -
}
ÆÆ. /
=
ÆÆ0 1
new
ÆÆ2 5
(
ÆÆ5 6
$num
ÆÆ6 8
,
ÆÆ8 9
$str
ÆÆ: ?
)
ÆÆ? @
;
ÆÆ@ A
public
ØØ 
string
ØØ 
?
ØØ 
ErrorMessage
ØØ #
{
ØØ$ %
get
ØØ& )
;
ØØ) *
set
ØØ+ .
;
ØØ. /
}
ØØ0 1
}
∞∞ 
}±± ”
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\GroupSettleCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
{ 
public 

class 
GroupSettleCommand #
{ 
public		 
List		 
<		 
Guid		 
>		 
	TicketIds		 #
{		$ %
get		& )
;		) *
set		+ .
;		. /
}		0 1
=		2 3
new		4 7
(		7 8
)		8 9
;		9 :
public

 
Money

 
Amount

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
=

* +
new

, /
(

/ 0
$num

0 2
,

2 3
$str

4 9
)

9 :
;

: ;
public 
Money 
TenderAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
new2 5
(5 6
$num6 8
,8 9
$str: ?
)? @
;@ A
public 
PaymentType 
PaymentType &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
UserId 
ProcessedBy !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
null2 6
!6 7
;7 8
public 
Guid 

TerminalId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
GlobalId 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
string 
? 
AuthCode 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
CardType 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 

AuthMethod !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ‰
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ExportImportCommands.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
record 
ExportLayoutCommand !
(! "
Guid 
LayoutId	 
, 
string 

FilePath 
)		 
:		 
IRequest		 
<		 
string		 
>		 
;		 
public 
record 
ImportLayoutCommand !
(! "
string 

FilePath 
) 
: 
IRequest 
< 
TableLayoutDto 
> 
; 
public 
record #
ExportAllLayoutsCommand %
(% &
string 

FilePath 
) 
: 
IRequest 
< 
string 
> 
; 
public 
record  
ImportLayoutsCommand "
(" #
string 

FilePath 
, 
bool 
ReplaceExisting	 
= 
false  
) 
: 
IRequest 
< 
List 
< 
TableLayoutDto  
>  !
>! "
;" #
public 
record 
CreateBackupCommand !
(! "
string 

FilePath 
) 
: 
IRequest 
< 
string 
> 
; 
public 
record  
RestoreBackupCommand "
(" #
string 

FilePath 
, 
bool 
ReplaceExisting	 
= 
false  
) 
: 
IRequest 
< 
List 
< 
TableLayoutDto  
>  !
>! "
;" #
public!! 
record!! %
ValidateLayoutFileCommand!! '
(!!' (
string"" 

FilePath"" 
)## 
:## 
IRequest## 
<## "
LayoutValidationResult## #
>### $
;##$ %
public%% 
class%% "
LayoutValidationResult%% #
{&& 
public'' 

bool'' 
IsValid'' 
{'' 
get'' 
;'' 
set'' "
;''" #
}''$ %
public(( 

string(( 
ErrorMessage(( 
{((  
get((! $
;(($ %
set((& )
;(() *
}((+ ,
=((- .
string((/ 5
.((5 6
Empty((6 ;
;((; <
public)) 

List)) 
<)) 
string)) 
>)) 
Warnings))  
{))! "
get))# &
;))& '
set))( +
;))+ ,
}))- .
=))/ 0
new))1 4
())4 5
)))5 6
;))6 7
public** 

int** 
LayoutCount** 
{** 
get**  
;**  !
set**" %
;**% &
}**' (
public++ 

int++ 

TableCount++ 
{++ 
get++ 
;++  
set++! $
;++$ %
}++& '
public,, 

string,, 
Metadata,, 
{,, 
get,,  
;,,  !
set,," %
;,,% &
},,' (
=,,) *
string,,+ 1
.,,1 2
Empty,,2 7
;,,7 8
}-- ç
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\DeliveryCommands.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class $
MarkTicketAsReadyCommand %
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
}		 
public 
class !
DispatchTicketCommand "
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
? 
DriverId 
{ 
get 
;  
set! $
;$ %
}& '
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
} 
public 
class !
ScheduleTicketCommand "
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

DateTime 
DeliveryDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
} 
public 
class '
FireScheduledTicketsCommand (
{ 
public 

DateTime 
DueBy 
{ 
get 
;  
set! $
;$ %
}& '
} ﬁ
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\DeleteUserCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
DeleteUserCommand 
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
}		 
public 
class 
DeleteUserResult 
{ 
public 

bool 
	IsSuccess 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Message 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
} ≤
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CreateUserCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
CreateUserCommand 
{ 
public 

string 
	FirstName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public		 

string		 
LastName		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
=		) *
string		+ 1
.		1 2
Empty		2 7
;		7 8
public

 

string

 
Username

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
=

) *
string

+ 1
.

1 2
Empty

2 7
;

7 8
public 

string 
Pin 
{ 
get 
; 
set  
;  !
}" #
=$ %
string& ,
., -
Empty- 2
;2 3
public 

Guid 
RoleId 
{ 
get 
; 
set !
;! "
}# $
} 
public 
class 
CreateUserResult 
{ 
public 

Guid 
UserId 
{ 
get 
; 
set !
;! "
}# $
public 

bool 
	IsSuccess 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Message 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
} ®
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CreateTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
CreateTicketCommand  
{		 
public

 

UserId

 
	CreatedBy

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
=

* +
null

, 0
!

0 1
;

1 2
public 

Guid 

TerminalId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

Guid 
OrderTypeId 
{ 
get !
;! "
set# &
;& '
}( )
public 

Guid 
? 

CustomerId 
{ 
get !
;! "
set# &
;& '
}( )
public 

List 
< 
int 
> 
? 
TableNumbers "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

int 
NumberOfGuests 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
$num. /
;/ 0
public 

string 
? 
GlobalId 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 
class 
CreateTicketResult 
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
TicketNumber 
{ 
get !
;! "
set# &
;& '
}( )
} ≠
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CreateTableLayoutCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
record $
CreateTableLayoutCommand &
(& '
string 

Name 
, 
Guid		 
?		 	
FloorId		
 
,		 
List

 
<

 	
TableDto

	 
>

 
Tables

 
,

 
bool 
IsDraft	 
= 
false 
) 
: 
IRequest 
< 
TableLayoutDto 
> 
; 
public 
record &
UpdateTablePositionCommand (
(( )
Guid 
TableId	 
, 
double 

X 
, 
double 

Y 
, 
TableShapeType 
Shape 
, 
double 

Width 
= 
$num 
, 
double 

Height 
= 
$num 
) 
: 
IRequest 
< 
TableDto 
> 
; 
public 
record "
SaveTableLayoutCommand $
($ %
Guid 
LayoutId	 
, 
string 

Name 
, 
List 
< 	
TableDto	 
> 
Tables 
, 
bool 
? 	
IsDraft
 
= 
null 
) 
: 
IRequest 
< 
TableLayoutDto 
> 
; 
public 
record $
DeleteTableLayoutCommand &
(& '
Guid 
LayoutId	 
)   
:   
IRequest   
<   
bool   
>   
;   
public"" 
record"" #
AddTableToLayoutCommand"" %
(""% &
Guid## 
LayoutId##	 
,## 
int$$ 
TableNumber$$ 
,$$ 
int%% 
Capacity%% 
,%% 
double&& 

X&& 
,&& 
double'' 

Y'' 
,'' 
TableShapeType(( 
Shape(( 
,(( 
double)) 

Width)) 
=)) 
$num)) 
,)) 
double** 

Height** 
=** 
$num** 
)++ 
:++ 
IRequest++ 
<++ 
TableDto++ 
>++ 
;++ 
public-- 
record-- (
RemoveTableFromLayoutCommand-- *
(--* +
Guid.. 
LayoutId..	 
,.. 
Guid// 
TableId//	 
)00 
:00 
IRequest00 
<00 
bool00 
>00 
;00 ≈
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CreateTableCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
CreateTableCommand 
{ 
public 

int 
TableNumber 
{ 
get  
;  !
set" %
;% &
}' (
public		 

int		 
Capacity		 
{		 
get		 
;		 
set		 "
;		" #
}		$ %
public

 

double

 
X

 
{

 
get

 
;

 
set

 
;

 
}

  !
public 

double 
Y 
{ 
get 
; 
set 
; 
}  !
public 

Guid 
? 
FloorId 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
} 
public 
class 
CreateTableResult 
{ 
public 

Guid 
TableId 
{ 
get 
; 
set "
;" #
}$ %
public 

int 
TableNumber 
{ 
get  
;  !
set" %
;% &
}' (
} å
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CreateShiftCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
CreateShiftCommand 
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public		 

TimeSpan		 
	StartTime		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 

TimeSpan

 
EndTime

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
} 
public 
class 
CreateShiftResult 
{ 
public 

Guid 
ShiftId 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
} ·
}C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CreateOrderTypeCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class "
CreateOrderTypeCommand #
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public		 

bool		 
CloseOnPaid		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 

bool

 
AllowSeatBasedOrder

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
public 

bool 
AllowToAddTipsLater #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

bool 
IsBarTab 
{ 
get 
; 
set  #
;# $
}% &
public 

bool 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
=' (
true) -
;- .
} 
public 
class !
CreateOrderTypeResult "
{ 
public 

Guid 
OrderTypeId 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
} ÷
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CloseTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
CloseTicketCommand 
{		 
public

 

Guid

 
TicketId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

UserId 
ClosedBy 
{ 
get  
;  !
set" %
;% &
}' (
=) *
null+ /
!/ 0
;0 1
} ˜
~C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CloseCashSessionCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class #
CloseCashSessionCommand $
{		 
public

 

Guid

 
CashSessionId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 

UserId 
ClosedBy 
{ 
get  
;  !
set" %
;% &
}' (
=) *
null+ /
!/ 0
;0 1
public 

Money 

ActualCash 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
} 
public 
class "
CloseCashSessionResult #
{ 
public 

Guid 
CashSessionId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Money 
ExpectedCash 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

Money 

ActualCash 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
public 

Money 

Difference 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
public 

DateTime 
ClosedAt 
{ 
get "
;" #
set$ '
;' (
}) *
} Ë
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ClockCommands.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
ClockInCommand 
{		 
public

 

UserId

 
UserId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
} 
public 
class 
ClockOutCommand 
{ 
public 

UserId 
UserId 
{ 
get 
; 
set  #
;# $
}% &
} ú

yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ChangeTableCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
ChangeTableCommand 
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 

NewTableId		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 

UserId

 
UserId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
} 
public 
class 
ChangeTableResult 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
ErrorMessage 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
} ¿
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ChangeSeatCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
ChangeSeatCommand 
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
OrderLineId		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 

int

 
?

 

SeatNumber

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
} û
ÄC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CaptureCardPaymentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class %
CaptureCardPaymentCommand &
{		 
public

 

Guid

 
	PaymentId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

Money 
? 
Amount 
{ 
get 
; 
set  #
;# $
}% &
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
} 
public 
class $
CaptureCardPaymentResult %
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
CaptureCode 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
ReferenceNumber "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
} â
ÑC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\CalculateServiceChargeCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 )
CalculateServiceChargeCommand		 *
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

decimal 
ServiceChargeRate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
} 
public 
class (
CalculateServiceChargeResult )
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Money 
CalculatedAmount !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
null2 6
!6 7
;7 8
public 

Money 
NewTotalAmount 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} Ù
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AuthorizeCardPaymentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class '
AuthorizeCardPaymentCommand (
{		 
public

 

Guid

 
	PaymentId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

string 

CardNumber 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
null- 1
!1 2
;2 3
public 

string 
? 
CardHolderName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

string 
? 
ExpirationDate !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

string 
? 
Cvv 
{ 
get 
; 
set !
;! "
}# $
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

string 
? 
ManualAuthCode !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
public 
class &
AuthorizeCardPaymentResult '
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
AuthorizationCode $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

string 
? 
ReferenceNumber "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

string 
? 
CardType 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
LastFourDigits !
{" #
get$ '
;' (
set) ,
;, -
}. /
} æ
ÅC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AssignTableToTicketCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class &
AssignTableToTicketCommand '
{ 
public 

Guid 
TableId 
{ 
get 
; 
set "
;" #
}$ %
public		 

Guid		 
TicketId		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
}

 
public 
class %
AssignTableToTicketResult &
{ 
public 

Guid 
TableId 
{ 
get 
; 
set "
;" #
}$ %
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
} «
{C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ApplyDiscountCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class  
ApplyDiscountCommand !
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
?		 
OrderLineId		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 

Guid

 

DiscountId

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
} …
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\ApplyCouponCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public		 
class		 
ApplyCouponCommand		 
{

 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 

CouponCode 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

UserId 
	AppliedBy 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
} ¨
ÇC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AddTipsToCardPaymentCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class '
AddTipsToCardPaymentCommand (
{		 
public

 

Guid

 
	PaymentId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

Money 

TipsAmount 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
} 
public 
class &
AddTipsToCardPaymentResult '
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
AuthorizationCode $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
} ≠
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AddPayoutCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
AddPayoutCommand 
{		 
public

 

Guid

 
CashSessionId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 
AddPayoutResult 
{ 
public 

Guid 
PayoutId 
{ 
get 
; 
set  #
;# $
}% &
public 

Guid 
CashSessionId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

Money 
UpdatedExpectedCash $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
null5 9
!9 :
;: ;
} Ø
zC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AddOrderLineCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
AddOrderLineCommand  
{		 
public

 

Guid

 
TicketId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

Guid 

MenuItemId 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
MenuItemName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

decimal 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
public 

Money 
	UnitPrice 
{ 
get  
;  !
set" %
;% &
}' (
=) *
null+ /
!/ 0
;0 1
public 

decimal 
TaxRate 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
CategoryName 
{  !
get" %
;% &
set' *
;* +
}, -
public 

string 
? 
	GroupName 
{ 
get "
;" #
set$ '
;' (
}) *
public 

UserId 
? 
AddedBy 
{ 
get  
;  !
set" %
;% &
}' (
public 

List 
< 
Magidesk 
. 
Domain 
.  
Entities  (
.( )
MenuModifier) 5
>5 6
	Modifiers7 @
{A B
getC F
;F G
setH K
;K L
}M N
=O P
newQ T
(T U
)U V
;V W
} 
public 
class 
AddOrderLineResult 
{ 
public 

Guid 
OrderLineId 
{ 
get !
;! "
set# &
;& '
}( )
} ±
C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AddOrderLineComboCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class $
AddOrderLineComboCommand %
{ 
public 

Guid 
TicketId 
{ 
get 
; 
set  #
;# $
}% &
public		 

Guid		 
OrderLineId		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 

List

 
<

 
ComboSelection

 
>

 

Selections

  *
{

+ ,
get

- 0
;

0 1
set

2 5
;

5 6
}

7 8
=

9 :
new

; >
(

> ?
)

? @
;

@ A
public 

class 
ComboSelection 
{ 
public 
Guid 
ComboGroupId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
Guid 
ComboGroupItemId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
=* +
$num, -
;- .
} 
} ¡
|C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AddDrawerBleedCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class !
AddDrawerBleedCommand "
{		 
public

 

Guid

 
CashSessionId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class  
AddDrawerBleedResult !
{ 
public 

Guid 
DrawerBleedId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Guid 
CashSessionId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

Money 
UpdatedExpectedCash $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
null5 9
!9 :
;: ;
} µ
yC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Magidesk.Application\Commands\AddCashDropCommand.cs
	namespace 	
Magidesk
 
. 
Application 
. 
Commands '
;' (
public 
class 
AddCashDropCommand 
{		 
public

 

Guid

 
CashSessionId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

UserId 
ProcessedBy 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
null. 2
!2 3
;3 4
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 
AddCashDropResult 
{ 
public 

Guid 

CashDropId 
{ 
get  
;  !
set" %
;% &
}' (
public 

Guid 
CashSessionId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

Money 
Amount 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

Money 
UpdatedExpectedCash $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
null5 9
!9 :
;: ;
} 