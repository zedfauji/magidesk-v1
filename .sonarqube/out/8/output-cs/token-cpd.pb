Ç
dC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\VoidTicketDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
VoidTicketDialog ,
:- .
ContentDialog/ <
{ 
public		 

VoidTicketViewModel		 
	ViewModel		 (
{		) *
get		+ .
;		. /
}		0 1
public 

VoidTicketDialog 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
VoidTicketViewModel4 G
>G H
(H I
)I J
;J K
DataContext 
= 
	ViewModel 
;  
} 
} Ú
_C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\VendorsPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
VendorsPage '
:( )
Page* .
{		 
public

 
%
VendorManagementViewModel

 $
	ViewModel

% .
{

/ 0
get

1 4
;

4 5
}

6 7
public 

VendorsPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4%
VendorManagementViewModel4 M
>M N
(N O
)O P
;P Q
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
	Microsoft0 9
.9 :
UI: <
.< =
Xaml= A
.A B

NavigationB L
.L M
NavigationEventArgsM `
ea b
)b c
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
await 
( 
	ViewModel 
. 
LoadVendorsCommand +
as, .
IAsyncRelayCommand/ A
)A B
.B C
ExecuteAsyncC O
(O P
nullP T
)T U
;U V
} 
} ú
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\UserManagementPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
UserManagementPage .
:/ 0
Page1 5
{ 
public		 
#
UserManagementViewModel		 "
	ViewModel		# ,
{		- .
get		/ 2
;		2 3
}		4 5
public 

UserManagementPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4#
UserManagementViewModel4 K
>K L
(L M
)M N
;N O
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
void 
OnNavigatedTo )
() *
	Microsoft* 3
.3 4
UI4 6
.6 7
Xaml7 ;
.; <

Navigation< F
.F G
NavigationEventArgsG Z
e[ \
)\ ]
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
	ViewModel 
. 
LoadCommand !
.! "

CanExecute" ,
(, -
null- 1
)1 2
)2 3
{ 	
	ViewModel 
. 
LoadCommand !
.! "
Execute" )
() *
null* .
). /
;/ 0
} 	
} 
} Ô
^C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\TicketPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 

TicketPage &
:' (
Page) -
{ 
public		 

TicketViewModel		 
	ViewModel		 $
{		% &
get		' *
;		* +
}		, -
public 


TicketPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
TicketViewModel4 C
>C D
(D E
)E F
;F G
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
void 
OnNavigatedTo )
() *
	Microsoft* 3
.3 4
UI4 6
.6 7
Xaml7 ;
.; <

Navigation< F
.F G
NavigationEventArgsG Z
e[ \
)\ ]
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
e 
. 
	Parameter 
is 
Magidesk #
.# $
Domain$ *
.* +
Entities+ 3
.3 4
	OrderType4 =
	orderType> G
)G H
{ 	
	ViewModel 
. 
OrderTypeIdText %
=& '
	orderType( 1
.1 2
Id2 4
.4 5
ToString5 =
(= >
)> ?
;? @
} 	
} 
} “
hC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\TicketManagementPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class  
TicketManagementPage 0
:1 2
Page3 7
{ 
public		 
%
TicketManagementViewModel		 $
	ViewModel		% .
{		/ 0
get		1 4
;		4 5
}		6 7
public 
 
TicketManagementPage 
(  
)  !
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4%
TicketManagementViewModel4 M
>M N
(N O
)O P
;P Q
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
	Microsoft0 9
.9 :
UI: <
.< =
Xaml= A
.A B

NavigationB L
.L M
NavigationEventArgsM `
ea b
)b c
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
await 
	ViewModel 
. 
RefreshAsync $
($ %
)% &
;& '
} 
} Ô2
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\TemplateEditorPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public		 
sealed		 
partial		 
class		 
TemplateEditorPage		 .
:		/ 0
Page		1 5
{

 
public 
#
TemplateEditorViewModel "
	ViewModel# ,
{- .
get/ 2
;2 3
}4 5
private 
	Microsoft 
. 
UI 
. 
Dispatching $
.$ %
DispatcherQueue% 4
_dispatcherQueue5 E
;E F
public 

TemplateEditorPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
_dispatcherQueue 
= 
	Microsoft $
.$ %
UI% '
.' (
Dispatching( 3
.3 4
DispatcherQueue4 C
.C D
GetForCurrentThreadD W
(W X
)X Y
;Y Z
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4#
TemplateEditorViewModel4 K
>K L
(L M
)M N
;N O
DataContext 
= 
	ViewModel 
;  
this 
. 
Loaded 
+= 
OnLoaded 
;  
this 
. 
Unloaded 
+= 

OnUnloaded #
;# $
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
NavigationEventArgs0 C
eD E
)E F
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
try 
{ 	
if 
( 
e 
. 
	Parameter 
is 
Guid #
id$ &
)& '
{   
await!! 
	ViewModel!! 
.!!  
InitializeAsync!!  /
(!!/ 0
id!!0 2
)!!2 3
;!!3 4
}"" 
else## 
{$$ 
await%% 
	ViewModel%% 
.%%  
InitializeAsync%%  /
(%%/ 0
null%%0 4
)%%4 5
;%%5 6
}&& 
}'' 	
catch(( 
((( 
	Exception(( 
ex(( 
)(( 
{)) 	
App** 
.** 

MessageBox** 
(** 
IntPtr** !
.**! "
Zero**" &
,**& '
$"**( *
$str*** J
{**J K
ex**K M
.**M N
Message**N U
}**U V
"**V W
,**W X
$str**Y `
,**` a
$num**b f
)**f g
;**g h
}++ 	
},, 
private.. 
async.. 
void.. 
OnLoaded.. 
(..  
object..  &
sender..' -
,..- .
RoutedEventArgs../ >
e..? @
)..@ A
{// 
if00 

(00 
DataContext00 
is00 #
TemplateEditorViewModel00 2
vm003 5
)005 6
{11 	
vm22 
.22 
PropertyChanged22 
+=22 !%
ViewModel_PropertyChanged22" ;
;22; <
if44 
(44 
!44 
string44 
.44 
IsNullOrEmpty44 %
(44% &
vm44& (
.44( )
PreviewHtml44) 4
)444 5
)445 6
{55 
try66 
{77 
await88 
PreviewWebView88 (
.88( )#
EnsureCoreWebView2Async88) @
(88@ A
)88A B
;88B C
PreviewWebView99 "
.99" #
NavigateToString99# 3
(993 4
vm994 6
.996 7
PreviewHtml997 B
)99B C
;99C D
}:: 
catch;; 
(;; 
	Exception;;  
ex;;! #
);;# $
{<< 
System>> 
.>> 
Diagnostics>> &
.>>& '
Debug>>' ,
.>>, -
	WriteLine>>- 6
(>>6 7
$">>7 9
$str>>9 O
{>>O P
ex>>P R
.>>R S
Message>>S Z
}>>Z [
">>[ \
)>>\ ]
;>>] ^
}?? 
}@@ 
}AA 	
}BB 
privateDD 
voidDD 

OnUnloadedDD 
(DD 
objectDD "
senderDD# )
,DD) *
RoutedEventArgsDD+ :
eDD; <
)DD< =
{EE 
ifFF 

(FF 
DataContextFF 
isFF #
TemplateEditorViewModelFF 2
vmFF3 5
)FF5 6
{GG 	
vmHH 
.HH 
PropertyChangedHH 
-=HH !%
ViewModel_PropertyChangedHH" ;
;HH; <
}II 	
}JJ 
privateLL 
voidLL %
ViewModel_PropertyChangedLL *
(LL* +
objectLL+ 1
?LL1 2
senderLL3 9
,LL9 :
SystemLL; A
.LLA B
ComponentModelLLB P
.LLP Q$
PropertyChangedEventArgsLLQ i
eLLj k
)LLk l
{MM 
ifNN 

(NN 
eNN 
.NN 
PropertyNameNN 
==NN 
nameofNN $
(NN$ %#
TemplateEditorViewModelNN% <
.NN< =
PreviewHtmlNN= H
)NNH I
)NNI J
{OO 	
ifQQ 
(QQ 
senderQQ 
isQQ #
TemplateEditorViewModelQQ 1
vmQQ2 4
)QQ4 5
{RR 
_dispatcherQueueSS  
.SS  !

TryEnqueueSS! +
(SS+ ,
(SS, -
)SS- .
=>SS/ 1
{TT 
tryUU 
{VV 
PreviewWebViewWW &
.WW& '
NavigateToStringWW' 7
(WW7 8
vmWW8 :
.WW: ;
PreviewHtmlWW; F
)WWF G
;WWG H
}XX 
catchYY 
{YY 
}YY= >
}ZZ 
)ZZ 
;ZZ 
}[[ 
}\\ 	
}]] 
}^^ Þ
`C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\TableMapPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
TableMapPage (
:) *
Page+ /
{		 
public

 

TableMapViewModel

 
	ViewModel

 &
{

' (
get

) ,
;

, -
}

. /
public 

TableMapPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
TableMapViewModel4 E
>E F
(F G
)G H
;H I
this 
. 
Name 
= 
$str 
; 
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
NavigationEventArgs0 C
eD E
)E F
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
e 
. 
	Parameter 
is 
Guid 
ticketId  (
)( )
{ 	
	ViewModel 
. 

SetContext  
(  !
ticketId! )
)) *
;* +
} 	
else 
{ 	
	ViewModel 
. 

SetContext  
(  !
null! %
)% &
;& '
} 	
await   
	ViewModel   
.   
LoadTablesCommand   )
.  ) *
ExecuteAsync  * 6
(  6 7
null  7 ;
)  ; <
;  < =
	ViewModel"" 
."" 
RequestShiftStart"" #
+=""$ &'
ViewModel_RequestShiftStart""' B
;""B C
}## 
	protected%% 
override%% 
void%% 
OnNavigatedFrom%% +
(%%+ ,
NavigationEventArgs%%, ?
e%%@ A
)%%A B
{&& 
base'' 
.'' 
OnNavigatedFrom'' 
('' 
e'' 
)'' 
;''  
	ViewModel(( 
.(( 
RequestShiftStart(( #
-=(($ &'
ViewModel_RequestShiftStart((' B
;((B C
})) 
private++ 
async++ 
void++ '
ViewModel_RequestShiftStart++ 2
(++2 3
object++3 9
?++9 :
sender++; A
,++A B
	EventArgs++C L
e++M N
)++N O
{,, 
var-- 
dialog-- 
=-- 
new-- 
Dialogs--  
.--  !
ShiftStartDialog--! 1
(--1 2
)--2 3
;--3 4
dialog.. 
... 
XamlRoot.. 
=.. 
this.. 
... 
XamlRoot.. '
;..' (
await// 
dialog// 
.// 
	ShowAsync// 
(// 
)//  
;//  !
}00 
}11 í
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\TableExplorerPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
TableExplorerPage -
:. /
Page0 4
{		 
public

 
"
TableExplorerViewModel

 !
	ViewModel

" +
{

, -
get

. 1
;

1 2
}

3 4
public 

TableExplorerPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4"
TableExplorerViewModel4 J
>J K
(K L
)L M
;M N
this 
. 
Name 
= 
$str 
; 
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
NavigationEventArgs0 C
eD E
)E F
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
await 
	ViewModel 
. 
LoadTablesCommand )
.) *
ExecuteAsync* 6
(6 7
null7 ;
); <
;< =
} 
} âZ
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\TableDesignerTestPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class !
TableDesignerTestPage 1
:2 3
Page4 8
{ 
private		 "
TableDesignerViewModel		 "

_viewModel		# -
;		- .
private

 
int

 
_passedTests

 
=

 
$num

  
;

  !
private 
int 
_failedTests 
= 
$num  
;  !
private 
int 
_totalTests 
= 
$num 
;  
public 
!
TableDesignerTestPage  
(  !
)! "
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #

_viewModel 
= 
App 
. 
Services !
.! "
GetRequiredService" 4
<4 5"
TableDesignerViewModel5 K
>K L
(L M
)M N
;N O
} 
private 
void 
BackButton_Click !
(! "
object" (
sender) /
,/ 0
RoutedEventArgs1 @
eA B
)B C
{ 
} 
private 
async 
void 
RunAllTests_Click (
(( )
object) /
sender0 6
,6 7
RoutedEventArgs8 G
eH I
)I J
{ 
await 
RunAllTestsAsync 
( 
)  
;  !
} 
private 
async 
void #
TestBasicWorkflow_Click .
(. /
object/ 5
sender6 <
,< =
RoutedEventArgs> M
eN O
)O P
{ 
await   
RunTestAsync   
(   
$str   +
,  + ,
async  - 2
(  3 4
)  4 5
=>  6 8
await  9 >

_viewModel  ? I
.  I J%
TestBasicDesignerWorkflow  J c
(  c d
)  d e
)  e f
;  f g
}!! 
private## 
async## 
void## 
TestDragDrop_Click## )
(##) *
object##* 0
sender##1 7
,##7 8
RoutedEventArgs##9 H
e##I J
)##J K
{$$ 
await%% 
RunTestAsync%% 
(%% 
$str%% (
,%%( )
async%%* /
(%%0 1
)%%1 2
=>%%3 5
await%%6 ;

_viewModel%%< F
.%%F G(
TestDragAndDropFunctionality%%G c
(%%c d
)%%d e
)%%e f
;%%f g
}&& 
private(( 
async(( 
void(( 
TestShapes_Click(( '
(((' (
object((( .
sender((/ 5
,((5 6
RoutedEventArgs((7 F
e((G H
)((H I
{)) 
await** 
RunTestAsync** 
(** 
$str** ,
,**, -
async**. 3
(**4 5
)**5 6
=>**7 9
await**: ?

_viewModel**@ J
.**J K
TestShapeSelection**K ]
(**] ^
)**^ _
)**_ `
;**` a
}++ 
private-- 
async-- 
Task-- 
RunAllTestsAsync-- '
(--' (
)--( )
{.. 
ResetTestResults// 
(// 
)// 
;// 

StatusText11 
.11 
Text11 
=11 
$str11 0
;110 1
TestProgress22 
.22 
Value22 
=22 
$num22 
;22 
var44 
tests44 
=44 
new44 
[44 
]44 
{55 	
new66 
{66 
Name66 
=66 
$str66 )
,66) *
Test66+ /
=660 1
(662 3
Func663 7
<667 8
Task668 <
<66< =
bool66= A
>66A B
>66B C
)66C D
(66D E
(66E F
)66F G
=>66H J

_viewModel66K U
.66U V%
TestBasicDesignerWorkflow66V o
(66o p
)66p q
)66q r
}66s t
,66t u
new77 
{77 
Name77 
=77 
$str77 &
,77& '
Test77( ,
=77- .
(77/ 0
Func770 4
<774 5
Task775 9
<779 :
bool77: >
>77> ?
>77? @
)77@ A
(77A B
(77B C
)77C D
=>77E G

_viewModel77H R
.77R S(
TestDragAndDropFunctionality77S o
(77o p
)77p q
)77q r
}77s t
,77t u
new88 
{88 
Name88 
=88 
$str88 *
,88* +
Test88, 0
=881 2
(883 4
Func884 8
<888 9
Task889 =
<88= >
bool88> B
>88B C
>88C D
)88D E
(88E F
(88F G
)88G H
=>88I K

_viewModel88L V
.88V W
TestShapeSelection88W i
(88i j
)88j k
)88k l
}88m n
}99 	
;99	 

for;; 
(;; 
int;; 
i;; 
=;; 
$num;; 
;;; 
i;; 
<;; 
tests;; !
.;;! "
Length;;" (
;;;( )
i;;* +
++;;+ -
);;- .
{<< 	
var== 
test== 
=== 
tests== 
[== 
i== 
]== 
;==  
await>> 
RunTestAsync>> 
(>> 
test>> #
.>># $
Name>>$ (
,>>( )
test>>* .
.>>. /
Test>>/ 3
)>>3 4
;>>4 5
TestProgress@@ 
.@@ 
Value@@ 
=@@  
(@@! "
(@@" #
i@@# $
+@@% &
$num@@' (
)@@( )
*@@* +
$num@@, /
)@@/ 0
/@@1 2
tests@@3 8
.@@8 9
Length@@9 ?
;@@? @
awaitAA 
TaskAA 
.AA 
DelayAA 
(AA 
$numAA  
)AA  !
;AA! "
}BB 	

StatusTextDD 
.DD 
TextDD 
=DD 
$"DD 
$strDD 9
{DD9 :
_passedTestsDD: F
}DDF G
$strDDG Q
{DDQ R
_failedTestsDDR ^
}DD^ _
"DD_ `
;DD` a
}EE 
privateGG 
asyncGG 
TaskGG 
RunTestAsyncGG #
(GG# $
stringGG$ *
testNameGG+ 3
,GG3 4
FuncGG5 9
<GG9 :
TaskGG: >
<GG> ?
boolGG? C
>GGC D
>GGD E
testFuncGGF N
)GGN O
{HH 
tryII 
{JJ 	
StatusBarTextKK 
.KK 
TextKK 
=KK  
$"KK! #
$strKK# +
{KK+ ,
testNameKK, 4
}KK4 5
$strKK5 8
"KK8 9
;KK9 :
UpdateResultsLL 
(LL 
$"LL 
$strLL 
{LL 
DateTimeLL &
.LL& '
NowLL' *
:LL* +
$strLL+ 3
}LL3 4
$strLL4 ?
{LL? @
testNameLL@ H
}LLH I
$strLLI U
"LLU V
)LLV W
;LLW X
varNN 
resultNN 
=NN 
awaitNN 
testFuncNN '
(NN' (
)NN( )
;NN) *
ifPP 
(PP 
resultPP 
)PP 
{QQ 
_passedTestsRR 
++RR 
;RR 
UpdateResultsSS 
(SS 
$"SS  
$strSS  !
{SS! "
DateTimeSS" *
.SS* +
NowSS+ .
:SS. /
$strSS/ 7
}SS7 8
$strSS8 <
{SS< =
testNameSS= E
}SSE F
$strSSF Q
"SSQ R
)SSR S
;SSS T
}TT 
elseUU 
{VV 
_failedTestsWW 
++WW 
;WW 
UpdateResultsXX 
(XX 
$"XX  
$strXX  !
{XX! "
DateTimeXX" *
.XX* +
NowXX+ .
:XX. /
$strXX/ 7
}XX7 8
$strXX8 <
{XX< =
testNameXX= E
}XXE F
$strXXF Q
"XXQ R
)XXR S
;XXS T
}YY 
}ZZ 	
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[ 
{\\ 	
_failedTests]] 
++]] 
;]] 
UpdateResults^^ 
(^^ 
$"^^ 
$str^^ 
{^^ 
DateTime^^ &
.^^& '
Now^^' *
:^^* +
$str^^+ 3
}^^3 4
$str^^4 8
{^^8 9
testName^^9 A
}^^A B
$str^^B J
{^^J K
ex^^K M
.^^M N
Message^^N U
}^^U V
$str^^V Z
"^^Z [
)^^[ \
;^^\ ]
}__ 	
finally`` 
{aa 	
_totalTestsbb 
++bb 
;bb 
UpdateStatisticscc 
(cc 
)cc 
;cc 
}dd 	
}ee 
privategg 
voidgg 
ResetTestResultsgg !
(gg! "
)gg" #
{hh 
_passedTestsii 
=ii 
$numii 
;ii 
_failedTestsjj 
=jj 
$numjj 
;jj 
_totalTestskk 
=kk 
$numkk 
;kk 
ResultsTextll 
.ll 
Textll 
=ll 
stringll !
.ll! "
Emptyll" '
;ll' (
UpdateStatisticsmm 
(mm 
)mm 
;mm 
}nn 
privatepp 
voidpp 
UpdateResultspp 
(pp 
stringpp %
messagepp& -
)pp- .
{qq 
ResultsTextrr 
.rr 
Textrr 
+=rr 
messagerr #
;rr# $
varss 
scrollViewerss 
=ss 
ResultsTextss &
.ss& '
Parentss' -
asss. 0
ScrollViewerss1 =
;ss= >
scrollViewertt 
?tt 
.tt 

ChangeViewtt  
(tt  !
$numtt! "
,tt" #
doublett$ *
.tt* +
MaxValuett+ 3
,tt3 4
nulltt5 9
)tt9 :
;tt: ;
}uu 
privateww 
voidww 
UpdateStatisticsww !
(ww! "
)ww" #
{xx 
PassedCountyy 
.yy 
Textyy 
=yy 
_passedTestsyy '
.yy' (
ToStringyy( 0
(yy0 1
)yy1 2
;yy2 3
FailedCountzz 
.zz 
Textzz 
=zz 
_failedTestszz '
.zz' (
ToStringzz( 0
(zz0 1
)zz1 2
;zz2 3

TotalCount{{ 
.{{ 
Text{{ 
={{ 
_totalTests{{ %
.{{% &
ToString{{& .
({{. /
){{/ 0
;{{0 1
}|| 
}}} §O
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\TableDesignerPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
TableDesignerPage -
:. /
Page0 4
{ 
private 
TableDto 
? 
_draggedTable #
;# $
private 
Point 
_dragStartPosition $
;$ %
private 
bool 
_isDragging 
= 
false $
;$ %
public 
"
TableDesignerViewModel !
	ViewModel" +
{, -
get. 1
;1 2
}3 4
public 

TableDesignerPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4"
TableDesignerViewModel4 J
>J K
(K L
)L M
;M N
ShapePalette 
. 
	ViewModel 
=  
	ViewModel! *
;* +
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
NavigationEventArgs0 C
eD E
)E F
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
try   
{!! 	
await"" 
	ViewModel"" 
."" 
LoadDataAsync"" )
("") *
)""* +
;""+ ,
}## 	
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$ 
{%% 	
try(( 
{)) 
var** 
dialogService** "
=**# $
App**% (
.**( )
Services**) 1
.**1 2
GetRequiredService**2 D
<**D E
Magidesk**E M
.**M N
Application**N Y
.**Y Z

Interfaces**Z d
.**d e
IDialogService**e s
>**s t
(**t u
)**u v
;**v w
await++ 
dialogService++ $
.++$ %
ShowErrorAsync++% 3
(++3 4
$str++4 D
,++D E
$str++F f
,++f g
ex++h j
.++j k
ToString++k s
(++s t
)++t u
)++u v
;++v w
},, 
catch-- 
{-- 
}--/ 0
}.. 	
}// 
private11 
void11 
Canvas_Tapped11 
(11 
object11 %
sender11& ,
,11, -!
TappedRoutedEventArgs11. C
e11D E
)11E F
{22 
if33 

(33 
!33 
	ViewModel33 
.33 
IsDesignMode33 #
)33# $
return33% +
;33+ ,
var55 
position55 
=55 
e55 
.55 
GetPosition55 $
(55$ %
null55% )
)55) *
;55* +
var66 
point66 
=66 
new66 
Point66 
(66 
(66 
int66 "
)66" #
position66# +
.66+ ,
X66, -
,66- .
(66/ 0
int660 3
)663 4
position664 <
.66< =
Y66= >
)66> ?
;66? @
	ViewModel77 
.77 
AddTableCommand77 !
.77! "
Execute77" )
(77) *
point77* /
)77/ 0
;770 1
}88 
private:: 
void:: 
Table_DragStarting:: #
(::# $
	UIElement::$ -
sender::. 4
,::4 5!
DragStartingEventArgs::6 K
args::L P
)::P Q
{;; 
if<< 

(<< 
!<< 
	ViewModel<< 
.<< 
IsDesignMode<< #
)<<# $
return<<% +
;<<+ ,
if>> 

(>> 
sender>> 
is>> 
FrameworkElement>> &
element>>' .
&&>>/ 1
element>>2 9
.>>9 :
DataContext>>: E
is>>F H
TableDto>>I Q
table>>R W
)>>W X
{?? 	
_draggedTable@@ 
=@@ 
table@@ !
;@@! "
_dragStartPositionAA 
=AA  
newAA! $
PointAA% *
(AA* +
$numAA+ ,
,AA, -
$numAA. /
)AA/ 0
;AA0 1
_isDraggingBB 
=BB 
trueBB 
;BB 
argsDD 
.DD 
DataDD 
.DD 
SetTextDD 
(DD 
$"DD  
$strDD  &
{DD& '
tableDD' ,
.DD, -
IdDD- /
}DD/ 0
"DD0 1
)DD1 2
;DD2 3
}HH 	
}II 
privateKK 
voidKK 

Table_DropKK 
(KK 
objectKK "
senderKK# )
,KK) *
DragEventArgsKK+ 8
eKK9 :
)KK: ;
{LL 
ifMM 

(MM 
!MM 
	ViewModelMM 
.MM 
IsDesignModeMM #
||MM$ &
_draggedTableMM' 4
==MM5 7
nullMM8 <
)MM< =
returnMM> D
;MMD E
varOO 
positionOO 
=OO 
eOO 
.OO 
GetPositionOO $
(OO$ %
nullOO% )
)OO) *
;OO* +
varPP 
newXPP 
=PP 
(PP 
intPP 
)PP 
(PP 
positionPP !
.PP! "
XPP" #
-PP$ %
$numPP& (
)PP( )
;PP) *
varQQ 
newYQQ 
=QQ 
(QQ 
intQQ 
)QQ 
(QQ 
positionQQ !
.QQ! "
YQQ" #
-QQ$ %
$numQQ& (
)QQ( )
;QQ) *
_draggedTableTT 
.TT 
XTT 
=TT 
newXTT 
;TT 
_draggedTableUU 
.UU 
YUU 
=UU 
newYUU 
;UU 
_draggedTableXX 
=XX 
nullXX 
;XX 
_isDraggingYY 
=YY 
falseYY 
;YY 
}ZZ 
private\\ 
void\\ 
Table_Tapped\\ 
(\\ 
object\\ $
sender\\% +
,\\+ ,!
TappedRoutedEventArgs\\- B
e\\C D
)\\D E
{]] 
if^^ 

(^^ 
sender^^ 
is^^ 
FrameworkElement^^ &
element^^' .
&&^^/ 1
element^^2 9
.^^9 :
DataContext^^: E
is^^F H
TableDto^^I Q
table^^R W
)^^W X
{__ 	
	ViewModel`` 
.`` 
SelectTableCommand`` (
.``( )
Execute``) 0
(``0 1
table``1 6
)``6 7
;``7 8
}aa 	
}bb 
privatedd 
voiddd %
Table_ManipulationStarteddd *
(dd* +
objectdd+ 1
senderdd2 8
,dd8 9.
"ManipulationStartedRoutedEventArgsdd: \
edd] ^
)dd^ _
{ee 
ifff 

(ff 
!ff 
	ViewModelff 
.ff 
IsDesignModeff #
)ff# $
returnff% +
;ff+ ,
ifhh 

(hh 
senderhh 
ishh 
FrameworkElementhh &
elementhh' .
&&hh/ 1
elementhh2 9
.hh9 :
DataContexthh: E
ishhF H
TableDtohhI Q
tablehhR W
)hhW X
{ii 	
_draggedTablejj 
=jj 
tablejj !
;jj! "
_dragStartPositionkk 
=kk  
ekk! "
.kk" #
Positionkk# +
;kk+ ,
_isDraggingll 
=ll 
truell 
;ll 
}mm 	
}nn 
privatepp 
voidpp #
Table_ManipulationDeltapp (
(pp( )
objectpp) /
senderpp0 6
,pp6 7,
 ManipulationDeltaRoutedEventArgspp8 X
eppY Z
)ppZ [
{qq 
ifrr 

(rr 
!rr 
_isDraggingrr 
||rr 
_draggedTablerr )
==rr* ,
nullrr- 1
)rr1 2
returnrr3 9
;rr9 :
vartt 
deltatt 
=tt 
ett 
.tt 
Deltatt 
;tt 
_draggedTableuu 
.uu 
Xuu 
=uu 
Mathuu 
.uu 
Maxuu "
(uu" #
$numuu# $
,uu$ %
(uu& '
intuu' *
)uu* +
(uu+ ,
_draggedTableuu, 9
.uu9 :
Xuu: ;
+uu< =
deltauu> C
.uuC D
TranslationuuD O
.uuO P
XuuP Q
)uuQ R
)uuR S
;uuS T
_draggedTablevv 
.vv 
Yvv 
=vv 
Mathvv 
.vv 
Maxvv "
(vv" #
$numvv# $
,vv$ %
(vv& '
intvv' *
)vv* +
(vv+ ,
_draggedTablevv, 9
.vv9 :
Yvv: ;
+vv< =
deltavv> C
.vvC D
TranslationvvD O
.vvO P
YvvP Q
)vvQ R
)vvR S
;vvS T
}ww 
privateyy 
voidyy '
Table_ManipulationCompletedyy ,
(yy, -
objectyy- 3
senderyy4 :
,yy: ;0
$ManipulationCompletedRoutedEventArgsyy< `
eyya b
)yyb c
{zz 
_isDragging{{ 
={{ 
false{{ 
;{{ 
_draggedTable|| 
=|| 
null|| 
;|| 
}}} 
}~~ ‚
dC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\SystemConfigPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
SystemConfigPage ,
:- .
Page/ 3
{ 
public		 
!
SystemConfigViewModel		  
	ViewModel		! *
{		+ ,
get		- 0
;		0 1
}		2 3
public 

SystemConfigPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4!
SystemConfigViewModel4 I
>I J
(J K
)K L
;L M
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
	Microsoft0 9
.9 :
UI: <
.< =
Xaml= A
.A B

NavigationB L
.L M
NavigationEventArgsM `
ea b
)b c
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
await 
	ViewModel 
. 
InitializeAsync '
(' (
)( )
;) *
} 
} é
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\SwitchboardPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
SwitchboardPage +
:, -
Page. 2
{		 
public

 
 
SwitchboardViewModel

 
	ViewModel

  )
{

* +
get

, /
;

/ 0
}

1 2
public 

SwitchboardPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4 
SwitchboardViewModel4 H
>H I
(I J
)J K
;K L
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
_ 	
=
 
	ViewModel 
. 
LoadTicketsAsync &
(& '
)' (
;( )
} 
} ú
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\SwipeCardDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
{ 
public		 

sealed		 
partial		 
class		 
SwipeCardDialog		  /
:		0 1
ContentDialog		2 ?
{

 
public 
SwipeCardViewModel !
	ViewModel" +
{, -
get. 1
;1 2
}3 4
public 
SwipeCardDialog 
( 
)  
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
App 
. 
Services $
.$ %
GetRequiredService% 7
<7 8
SwipeCardViewModel8 J
>J K
(K L
)L M
;M N
this 
. 
DataContext 
= 
	ViewModel (
;( )
this 
. 
Opened 
+= "
SwipeCardDialog_Opened 1
;1 2
} 	
private 
void "
SwipeCardDialog_Opened +
(+ ,
ContentDialog, 9
sender: @
,@ A(
ContentDialogOpenedEventArgsB ^
args_ c
)c d
{ 	
SwipeInputBox 
. 
Focus 
(  
	Microsoft  )
.) *
UI* ,
., -
Xaml- 1
.1 2

FocusState2 <
.< =
Programmatic= I
)I J
;J K
} 	
private 
void )
SwipeInputBox_PasswordChanged 2
(2 3
object3 9
sender: @
,@ A
	MicrosoftB K
.K L
UIL N
.N O
XamlO S
.S T
RoutedEventArgsT c
ed e
)e f
{ 	
if 
( 
	ViewModel 
!= 
null "
)" #
{   
	ViewModel!! 
.!! 
	SwipeData!! #
=!!$ %
SwipeInputBox!!& 3
.!!3 4
Password!!4 <
;!!< =
}"" 
}## 	
private%% 
void%% !
SwipeInputBox_KeyDown%% *
(%%* +
object%%+ 1
sender%%2 8
,%%8 9
KeyRoutedEventArgs%%: L
e%%M N
)%%N O
{&& 	
if'' 
('' 
e'' 
.'' 
Key'' 
=='' 
Windows''  
.''  !
System''! '
.''' (

VirtualKey''( 2
.''2 3
Enter''3 8
)''8 9
{(( 
if-- 
(-- 
!-- 
string-- 
.-- 
IsNullOrEmpty-- )
(--) *
SwipeInputBox--* 7
.--7 8
Password--8 @
)--@ A
)--A B
{.. 
Hide00 
(00 
)00 
;00 
}22 
}33 
}44 	
}55 
}66 þ
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\SplitTicketDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
{ 
public 

sealed 
partial 
class 
SplitTicketDialog  1
:2 3
ContentDialog4 A
{ 
public		  
SplitTicketViewModel		 #
	ViewModel		$ -
{		. /
get		0 3
;		3 4
}		5 6
public 
SplitTicketDialog  
(  !
)! "
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
App 
. 
Services $
.$ %
GetRequiredService% 7
<7 8 
SplitTicketViewModel8 L
>L M
(M N
)N O
;O P
this 
. 
DataContext 
= 
	ViewModel (
;( )
} 	
} 
} è
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\ShiftExplorerPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
ShiftExplorerPage -
:. /
Page0 4
{		 
public

 
"
ShiftExplorerViewModel

 !
	ViewModel

" +
{

, -
get

. 1
;

1 2
}

3 4
public 

ShiftExplorerPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4"
ShiftExplorerViewModel4 J
>J K
(K L
)L M
;M N
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
	ViewModel 
. 
LoadCommand !
.! "

CanExecute" ,
(, -
null- 1
)1 2
)2 3
{ 	
	ViewModel 
. 
LoadCommand !
.! "
Execute" )
() *
null* .
). /
;/ 0
} 	
} 
} Ø
^C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\SettlePage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 

SettlePage &
:' (
Page) -
{		 
public

 

SettleViewModel

 
	ViewModel

 $
{

% &
get

' *
;

* +
}

, -
public 


SettlePage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
SettleViewModel4 C
>C D
(D E
)E F
;F G
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
NavigationEventArgs0 C
eD E
)E F
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
e 
. 
	Parameter 
is 
Guid 
ticketId  (
)( )
{ 	
await 
	ViewModel 
. 
InitializeAsync +
(+ ,
ticketId, 4
)4 5
;5 6
} 	
} 
} 
`C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\SettingsPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
SettingsPage (
:) *
Page+ /
{ 
public		 

SettingsViewModel		 
	ViewModel		 &
{		' (
get		) ,
;		, -
}		. /
public 

SettingsPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
SettingsViewModel4 E
>E F
(F G
)G H
;H I
DataContext 
= 
	ViewModel 
;  
} 
} ¡
dC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\SalesReportsPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
SalesReportsPage ,
:- .
Page/ 3
{ 
public		 
!
SalesReportsViewModel		  
	ViewModel		! *
{		+ ,
get		- 0
;		0 1
}		2 3
public 

SalesReportsPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4!
SalesReportsViewModel4 I
>I J
(J K
)K L
;L M
DataContext 
= 
	ViewModel 
;  
} 
} ú
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\RoleManagementPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
RoleManagementPage .
:/ 0
Page1 5
{ 
public		 
#
RoleManagementViewModel		 "
	ViewModel		# ,
{		- .
get		/ 2
;		2 3
}		4 5
public 

RoleManagementPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4#
RoleManagementViewModel4 K
>K L
(L M
)M N
;N O
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
void 
OnNavigatedTo )
() *
	Microsoft* 3
.3 4
UI4 6
.6 7
Xaml7 ;
.; <

Navigation< F
.F G
NavigationEventArgsG Z
e[ \
)\ ]
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
	ViewModel 
. 
LoadCommand !
.! "

CanExecute" ,
(, -
null- 1
)1 2
)2 3
{ 	
	ViewModel 
. 
LoadCommand !
.! "
Execute" )
() *
null* .
). /
;/ 0
} 	
} 
} æ
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\PurchaseOrdersPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
PurchaseOrdersPage .
:/ 0
Page1 5
{		 
public

 
"
PurchaseOrderViewModel

 !
	ViewModel

" +
{

, -
get

. 1
;

1 2
}

3 4
public 

PurchaseOrdersPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4"
PurchaseOrderViewModel4 J
>J K
(K L
)L M
;M N
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
	Microsoft0 9
.9 :
UI: <
.< =
Xaml= A
.A B

NavigationB L
.L M
NavigationEventArgsM `
ea b
)b c
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
await 
( 
	ViewModel 
. 
LoadDataCommand (
as) +
IAsyncRelayCommand, >
)> ?
.? @
ExecuteAsync@ L
(L M
nullM Q
)Q R
;R S
} 
} Œ
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\PrintTemplatesPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
PrintTemplatesPage .
:/ 0
Page1 5
{		 
public

 
#
PrintTemplatesViewModel

 "
	ViewModel

# ,
{

- .
get

/ 2
;

2 3
}

4 5
public 

PrintTemplatesPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4#
PrintTemplatesViewModel4 K
>K L
(L M
)M N
;N O
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
NavigationEventArgs0 C
eD E
)E F
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
try 
{ 	
await 
	ViewModel 
. 
	LoadAsync %
(% &
)& '
;' (
} 	
catch 
( 
	Exception 
ex 
) 
{ 	
App 
. 

MessageBox 
( 
IntPtr !
.! "
Zero" &
,& '
$"( *
$str* D
{D E
exE G
.G H
MessageH O
}O P
"P Q
,Q R
$strS Z
,Z [
$num\ `
)` a
;a b
} 	
} 
} þ
]C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\PrintPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
	PrintPage %
:& '
Page( ,
{ 
public		 

PrintViewModel		 
	ViewModel		 #
{		$ %
get		& )
;		) *
}		+ ,
public 

	PrintPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
PrintViewModel4 B
>B C
(C D
)D E
;E F
DataContext 
= 
	ViewModel 
;  
} 
} ²
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\PaymentProcessWaitDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
; 
public 
sealed 
partial 
class $
PaymentProcessWaitDialog 4
:5 6
ContentDialog7 D
{ 
public		 
'
PaymentProcessWaitViewModel		 &
	ViewModel		' 0
{		1 2
get		3 6
;		6 7
}		8 9
public 
$
PaymentProcessWaitDialog #
(# $
)$ %
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
Magidesk 
. 
Presentation )
.) *
App* -
.- .
Services. 6
.6 7
GetRequiredService7 I
<I J'
PaymentProcessWaitViewModelJ e
>e f
(f g
)g h
;h i
this 
. 
DataContext 
= 
	ViewModel $
;$ %
} 
private 
void !
ContentDialog_Closing &
(& '
ContentDialog' 4
sender5 ;
,; <)
ContentDialogClosingEventArgs= Z
args[ _
)_ `
{ 
if 

( 
! 
	ViewModel 
. 
CanClose 
)  
{ 	
args   
.   
Cancel   
=   
true   
;   
}!! 	
}"" 
}## ˆ
_C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\PaymentPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
PaymentPage '
:( )
Page* .
{ 
public		 

PaymentViewModel		 
	ViewModel		 %
{		& '
get		( +
;		+ ,
}		- .
public 

PaymentPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
PaymentViewModel4 D
>D E
(E F
)F G
;G H
DataContext 
= 
	ViewModel 
;  
} 
} ”
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\PasswordEntryDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
PasswordEntryDialog /
:0 1
ContentDialog2 ?
{ 
public 

string 
Password 
=> 
PasswordInput +
.+ ,
Password, 4
;4 5
public

 

PasswordEntryDialog

 
(

 
)

  
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
} 
private 
void 
Numpad_Click 
( 
object $
sender% +
,+ ,
RoutedEventArgs- <
e= >
)> ?
{ 
if 

( 
sender 
is 
Button 
btn  
&&! #
btn$ '
.' (
Content( /
is0 2
string3 9
digit: ?
)? @
{ 	
PasswordInput 
. 
Password "
+=# %
digit& +
;+ ,
} 	
} 
private 
void 
Clear_Click 
( 
object #
sender$ *
,* +
RoutedEventArgs, ;
e< =
)= >
{ 
PasswordInput 
. 
Password 
=  
string! '
.' (
Empty( -
;- .
} 
private 
void 
Backspace_Click  
(  !
object! '
sender( .
,. /
RoutedEventArgs0 ?
e@ A
)A B
{ 
if 

( 
PasswordInput 
. 
Password "
." #
Length# )
>* +
$num, -
)- .
{ 	
PasswordInput   
.   
Password   "
=  # $
PasswordInput  % 2
.  2 3
Password  3 ;
[  ; <
..  < >
^  > ?
$num  ? @
]  @ A
;  A B
}!! 	
}"" 
}## ÷
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\OrderTypeSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public

 
sealed

 
partial

 
class

 $
OrderTypeSelectionDialog

 4
:

5 6
ContentDialog

7 D
{ 
public 
'
OrderTypeSelectionViewModel &
	ViewModel' 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 

	OrderType 
? 
SelectedOrderType '
=>( *
	ViewModel+ 4
?4 5
.5 6
SelectedOrderType6 G
;G H
public 
$
OrderTypeSelectionDialog #
(# $
)$ %
:& '
this( ,
(, -
App- 0
.0 1
Services1 9
.9 :
GetRequiredService: L
<L M'
OrderTypeSelectionViewModelM h
>h i
(i j
)j k
)k l
{ 
} 
public 
$
OrderTypeSelectionDialog #
(# $'
OrderTypeSelectionViewModel$ ?
	viewModel@ I
)I J
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
	viewModel 
; 
this 
. 
Opened 
+= +
OrderTypeSelectionDialog_Opened 6
;6 7
} 
private 
async 
void +
OrderTypeSelectionDialog_Opened 6
(6 7
ContentDialog7 D
senderE K
,K L(
ContentDialogOpenedEventArgsM i
argsj n
)n o
{ 
await 
	ViewModel 
. 
LoadOrderTypesAsync +
(+ ,
), -
;- .
} 
private 
void 
GridView_ItemClick #
(# $
object$ *
sender+ 1
,1 2
ItemClickEventArgs3 E
eF G
)G H
{   
if!! 

(!! 
e!! 
.!! 
ClickedItem!! 
is!! 
	OrderType!! &
	orderType!!' 0
)!!0 1
{"" 	
	ViewModel## 
.## 
SelectedOrderType## '
=##( )
	orderType##* 3
;##3 4
Hide$$ 
($$ 
)$$ 
;$$ 
}%% 	
}&& 
private(( 
void(( %
GridView_SelectionChanged(( *
(((* +
object((+ 1
sender((2 8
,((8 9%
SelectionChangedEventArgs((: S
e((T U
)((U V
{)) 
},, 
}-- ü
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\OrderTypeExplorerPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class !
OrderTypeExplorerPage 1
:2 3
Page4 8
{		 
public

 
&
OrderTypeExplorerViewModel

 %
	ViewModel

& /
{

0 1
get

2 5
;

5 6
}

7 8
public 
!
OrderTypeExplorerPage  
(  !
)! "
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4&
OrderTypeExplorerViewModel4 N
>N O
(O P
)P Q
;Q R
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
	ViewModel 
. 
LoadCommand !
.! "

CanExecute" ,
(, -
null- 1
)1 2
)2 3
{ 	
	ViewModel 
. 
LoadCommand !
.! "
Execute" )
() *
null* .
). /
;/ 0
} 	
} 
} ¾
bC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\OrderEntryPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
OrderEntryPage *
:+ ,
Page- 1
{		 
public

 

OrderEntryViewModel

 
	ViewModel

 (
{

) *
get

+ .
;

. /
}

0 1
public 

OrderEntryPage 
( 
) 
{ 
System 
. 
Diagnostics 
. 
Debug  
.  !
	WriteLine! *
(* +
$str+ N
)N O
;O P
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
OrderEntryViewModel4 G
>G H
(H I
)I J
;J K
DataContext 
= 
	ViewModel 
;  
System 
. 
Diagnostics 
. 
Debug  
.  !
	WriteLine! *
(* +
$str+ Q
)Q R
;R S
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
NavigationEventArgs0 C
eD E
)E F
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
Guid 
? 
ticketId 
= 
null 
; 
if 

( 
e 
. 
	Parameter 
is '
OrderEntryNavigationContext 6
context7 >
)> ?
{ 	
ticketId 
= 
context 
. 
TicketId '
;' (
	ViewModel 
.  
SetNavigationContext *
(* +
context+ 2
)2 3
;3 4
} 	
else   
if   
(   
e   
.   
	Parameter   
is   
Guid    $
id  % '
)  ' (
{!! 	
ticketId"" 
="" 
id"" 
;"" 
}## 	
await%% 
	ViewModel%% 
.%% 
InitializeAsync%% '
(%%' (
ticketId%%( 0
)%%0 1
;%%1 2
}&& 
}'' 	
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\OpenTicketsListDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class !
OpenTicketsListDialog 1
:2 3
ContentDialog4 A
{ 
public		 
$
OpenTicketsListViewModel		 #
	ViewModel		$ -
{		. /
get		0 3
;		3 4
}		5 6
public 
!
OpenTicketsListDialog  
(  !
)! "
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4$
OpenTicketsListViewModel4 L
>L M
(M N
)N O
;O P
this 
. 
DataContext 
= 
	ViewModel $
;$ %
} 
} ½
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\ModifierSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public		 
sealed		 
partial		 
class		 #
ModifierSelectionDialog		 3
:		4 5
ContentDialog		6 C
{

 
private 
readonly 
MenuItem 
	_menuItem '
;' (
public 
&
ModifierSelectionViewModel %
	ViewModel& /
{0 1
get2 5
;5 6
}7 8
public 
#
ModifierSelectionDialog "
(" #
MenuItem# +
menuItem, 4
)4 5
{ 
InitializeComponent 
( 
) 
; 
	_menuItem 
= 
menuItem 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4&
ModifierSelectionViewModel4 N
>N O
(O P
)P Q
;Q R
this 
. 
Loaded 
+= *
ModifierSelectionDialog_Loaded 5
;5 6
this 
. 
Closing 
+= +
ModifierSelectionDialog_Closing 7
;7 8
} 
private 
void *
ModifierSelectionDialog_Loaded /
(/ 0
object0 6
sender7 =
,= >
	Microsoft? H
.H I
UII K
.K L
XamlL P
.P Q
RoutedEventArgsQ `
ea b
)b c
{ 
	ViewModel 
. 
LoadModifiers 
(  
	_menuItem  )
)) *
;* +
} 
private 
void +
ModifierSelectionDialog_Closing 0
(0 1
ContentDialog1 >
sender? E
,E F)
ContentDialogClosingEventArgsG d
argse i
)i j
{ 
if 

( 
args 
. 
Result 
== 
ContentDialogResult .
.. /
Primary/ 6
)6 7
{   	
if!! 
(!! 
!!! 
	ViewModel!! 
.!! 
ValidateSelections!! -
(!!- .
)!!. /
)!!/ 0
{"" 
args## 
.## 
Cancel## 
=## 
true## "
;##" #
}$$ 
}%% 	
}&& 
}'' È
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\ModifierEditorPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
ModifierEditorPage .
:/ 0
Page1 5
{		 
public

 
#
ModifierEditorViewModel

 "
	ViewModel

# ,
{

- .
get

/ 2
;

2 3
}

4 5
public 

ModifierEditorPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4#
ModifierEditorViewModel4 K
>K L
(L M
)M N
;N O
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
	ViewModel 
. 
LoadDataCommand %
.% &

CanExecute& 0
(0 1
null1 5
)5 6
)6 7
{ 	
	ViewModel 
. 
LoadDataCommand %
.% &
Execute& -
(- .
null. 2
)2 3
;3 4
} 	
} 
} ¬
bC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\MenuEditorPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
MenuEditorPage *
:+ ,
Page- 1
{		 
public

 

MenuEditorViewModel

 
	ViewModel

 (
{

) *
get

+ .
;

. /
}

0 1
public 

MenuEditorPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !

GetService! +
<+ ,
MenuEditorViewModel, ?
>? @
(@ A
)A B
;B C
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
	ViewModel 
. 
LoadDataCommand %
.% &

CanExecute& 0
(0 1
null1 5
)5 6
)6 7
{ 	
	ViewModel 
. 
LoadDataCommand %
.% &
Execute& -
(- .
null. 2
)2 3
;3 4
} 	
} 
} ó

jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\ManagerFunctionsDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
{ 
public 

sealed 
partial 
class "
ManagerFunctionsDialog  6
:7 8
ContentDialog9 F
{ 
public		 %
ManagerFunctionsViewModel		 (
	ViewModel		) 2
{		3 4
get		5 8
;		8 9
}		: ;
public "
ManagerFunctionsDialog %
(% &
)& '
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
App 
. 
Services $
.$ %
GetRequiredService% 7
<7 8%
ManagerFunctionsViewModel8 Q
>Q R
(R S
)S T
;T U
	ViewModel 
. 
CloseAction !
=" #
($ %
)% &
=>' )
this* .
.. /
Hide/ 3
(3 4
)4 5
;5 6
this 
. 
DataContext 
= 
	ViewModel (
;( )
} 	
} 
} ”
\C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\MainPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
{ 
public 

partial 
class 
MainPage !
:" #
Page$ (
{ 
private 
readonly 
NavigationService *
_navigation+ 6
;6 7
public 
MainPage 
( 
) 
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
_navigation 
= 
App 
. 
Services &
.& '
GetRequiredService' 9
<9 :
NavigationService: K
>K L
(L M
)M N
;N O
} 	
private 
void 
OnGoBackClicked $
($ %
object% +
sender, 2
,2 3
RoutedEventArgs4 C
eD E
)E F
{ 	
if 
( 
_navigation 
. 
	CanGoBack %
)% &
{ 
_navigation 
. 
GoBack "
(" #
)# $
;$ %
} 
} 	
} 
} ä2
]C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\LoginPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
	LoginPage %
:& '
Page( ,
{ 
public		 

LoginViewModel		 
	ViewModel		 #
{		$ %
get		& )
;		) *
}		+ ,
public 

	LoginPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
LoginViewModel4 B
>B C
(C D
)D E
;E F
DataContext 
= 
	ViewModel 
;  
this 
. 
Loaded 
+= 
( 
s 
, 
e 
) 
=>  
this! %
.% &
Focus& +
(+ ,
	Microsoft, 5
.5 6
UI6 8
.8 9
Xaml9 =
.= >

FocusState> H
.H I
ProgrammaticI U
)U V
;V W
} 
	protected 
override 
void 
OnNavigatedTo )
() *
	Microsoft* 3
.3 4
UI4 6
.6 7
Xaml7 ;
.; <

Navigation< F
.F G
NavigationEventArgsG Z
e[ \
)\ ]
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
this 
. 
Focus 
( 
	Microsoft 
. 
UI 
.  
Xaml  $
.$ %

FocusState% /
./ 0
Programmatic0 <
)< =
;= >
} 
private 
void 
Page_KeyDown 
( 
object $
sender% +
,+ ,
	Microsoft- 6
.6 7
UI7 9
.9 :
Xaml: >
.> ?
Input? D
.D E
KeyRoutedEventArgsE W
eX Y
)Y Z
{ 
string   
?   
digit   
=   
null   
;   
if"" 

("" 
e"" 
."" 
Key"" 
>="" 
Windows"" 
."" 
System"" #
.""# $

VirtualKey""$ .
."". /
Number0""/ 6
&&""7 9
e"": ;
.""; <
Key""< ?
<=""@ B
Windows""C J
.""J K
System""K Q
.""Q R

VirtualKey""R \
.""\ ]
Number9""] d
)""d e
{## 	
digit$$ 
=$$ 
($$ 
e$$ 
.$$ 
Key$$ 
-$$ 
Windows$$ $
.$$$ %
System$$% +
.$$+ ,

VirtualKey$$, 6
.$$6 7
Number0$$7 >
)$$> ?
.$$? @
ToString$$@ H
($$H I
)$$I J
;$$J K
}%% 	
else&& 
if&& 
(&& 
e&& 
.&& 
Key&& 
>=&& 
Windows&& !
.&&! "
System&&" (
.&&( )

VirtualKey&&) 3
.&&3 4

NumberPad0&&4 >
&&&&? A
e&&B C
.&&C D
Key&&D G
<=&&H J
Windows&&K R
.&&R S
System&&S Y
.&&Y Z

VirtualKey&&Z d
.&&d e

NumberPad9&&e o
)&&o p
{'' 	
digit(( 
=(( 
((( 
e(( 
.(( 
Key(( 
-(( 
Windows(( $
.(($ %
System((% +
.((+ ,

VirtualKey((, 6
.((6 7

NumberPad0((7 A
)((A B
.((B C
ToString((C K
(((K L
)((L M
;((M N
})) 	
if++ 

(++ 
digit++ 
!=++ 
null++ 
)++ 
{,, 	
if-- 
(-- 
	ViewModel-- 
.-- 
AppendDigitCommand-- ,
.--, -

CanExecute--- 7
(--7 8
digit--8 =
)--= >
)--> ?
{.. 
	ViewModel// 
.// 
AppendDigitCommand// ,
.//, -
Execute//- 4
(//4 5
digit//5 :
)//: ;
;//; <
e00 
.00 
Handled00 
=00 
true00  
;00  !
}11 
}22 	
else33 
if33 
(33 
e33 
.33 
Key33 
==33 
Windows33 !
.33! "
System33" (
.33( )

VirtualKey33) 3
.333 4
Enter334 9
)339 :
{44 	
if55 
(55 
	ViewModel55 
.55 
LoginCommand55 &
.55& '

CanExecute55' 1
(551 2
null552 6
)556 7
)557 8
{66 
	ViewModel77 
.77 
LoginCommand77 &
.77& '
Execute77' .
(77. /
null77/ 3
)773 4
;774 5
e88 
.88 
Handled88 
=88 
true88  
;88  !
}99 
}:: 	
else;; 
if;; 
(;; 
e;; 
.;; 
Key;; 
==;; 
Windows;; !
.;;! "
System;;" (
.;;( )

VirtualKey;;) 3
.;;3 4
Back;;4 8
);;8 9
{<< 	
if== 
(== 
	ViewModel== 
.== "
RemoveLastDigitCommand== 0
.==0 1

CanExecute==1 ;
(==; <
null==< @
)==@ A
)==A B
{>> 
	ViewModel?? 
.?? "
RemoveLastDigitCommand?? 0
.??0 1
Execute??1 8
(??8 9
null??9 =
)??= >
;??> ?
e@@ 
.@@ 
Handled@@ 
=@@ 
true@@  
;@@  !
}AA 
}BB 	
}CC 
}DD Á
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\KitchenDisplayPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
KitchenDisplayPage .
:/ 0
Page1 5
{		 
public

 
#
KitchenDisplayViewModel

 "
	ViewModel

# ,
{

- .
get

/ 2
;

2 3
}

4 5
public 

KitchenDisplayPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
this 
. 
Name 
= 
$str 
; 
	ViewModel 
= 
App 
. 
Services  
.  !

GetService! +
<+ ,#
KitchenDisplayViewModel, C
>C D
(D E
)E F
!F G
;G H
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
	ViewModel 
. 
StartPolling 
( 
)  
;  !
} 
	protected 
override 
void 
OnNavigatedFrom +
(+ ,
NavigationEventArgs, ?
e@ A
)A B
{ 
base 
. 
OnNavigatedFrom 
( 
e 
) 
;  
	ViewModel 
. 
StopPolling 
( 
) 
;  
} 
} ¶
aC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\InventoryPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
InventoryPage )
:* +
Page, 0
{		 
public

 

InventoryViewModel

 
	ViewModel

 '
{

( )
get

* -
;

- .
}

/ 0
public 

InventoryPage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !

GetService! +
<+ ,
InventoryViewModel, >
>> ?
(? @
)@ A
!A B
;B C
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
	ViewModel 
. 
LoadDataCommand %
.% &

CanExecute& 0
(0 1
null1 5
)5 6
)6 7
{ 	
	ViewModel 
. 
LoadDataCommand %
.% &
Execute& -
(- .
null. 2
)2 3
;3 4
} 	
} 
} É	
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\GroupSettleTicketSelectionWindow.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
{ 
public 

sealed 
partial 
class ,
 GroupSettleTicketSelectionWindow  @
:A B
ContentDialogC P
{ 
public		 /
#GroupSettleTicketSelectionViewModel		 2
	ViewModel		3 <
{		= >
get		? B
;		B C
}		D E
public ,
 GroupSettleTicketSelectionWindow /
(/ 0
)0 1
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
App 
. 
Services $
.$ %
GetRequiredService% 7
<7 8/
#GroupSettleTicketSelectionViewModel8 [
>[ \
(\ ]
)] ^
;^ _
this 
. 
DataContext 
= 
	ViewModel (
;( )
} 	
} 
} ×

kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\GroupSettleTicketDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
{ 
public 

sealed 
partial 
class #
GroupSettleTicketDialog  7
:8 9
ContentDialog: G
{ 
public		 &
GroupSettleTicketViewModel		 )
	ViewModel		* 3
{		4 5
get		6 9
;		9 :
}		; <
public #
GroupSettleTicketDialog &
(& '
)' (
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
App 
. 
Services $
.$ %
GetRequiredService% 7
<7 8&
GroupSettleTicketViewModel8 R
>R S
(S T
)T U
;U V
this 
. 
DataContext 
= 
	ViewModel (
;( )
	ViewModel 
. 
CloseDialog !
=" #
($ %
)% &
=>' )
Hide* .
(. /
)/ 0
;0 1
} 	
} 
} ƒ
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\FloorManagementPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
FloorManagementPage /
:0 1
Page2 6
{ 
public		 
$
FloorManagementViewModel		 #
	ViewModel		$ -
{		. /
get		0 3
;		3 4
}		5 6
public 

FloorManagementPage 
( 
)  
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4$
FloorManagementViewModel4 L
>L M
(M N
)N O
;O P
} 
} Ñ
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\DrawerPullReportDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class "
DrawerPullReportDialog 2
:3 4
ContentDialog5 B
{ 
public		 
%
DrawerPullReportViewModel		 $
	ViewModel		% .
{		/ 0
get		1 4
;		4 5
}		6 7
public 
"
DrawerPullReportDialog !
(! "
)" #
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4%
DrawerPullReportViewModel4 M
>M N
(N O
)O P
;P Q
this 
. 
DataContext 
= 
	ViewModel $
;$ %
this 
. 
Loaded 
+= )
DrawerPullReportDialog_Loaded 4
;4 5
} 
private 
async 
void )
DrawerPullReportDialog_Loaded 4
(4 5
object5 ;
sender< B
,B C
	MicrosoftD M
.M N
UIN P
.P Q
XamlQ U
.U V
RoutedEventArgsV e
ef g
)g h
{ 
await 
	ViewModel 
. 
InitializeAsync '
(' (
)( )
;) *
} 
} œ
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\DiscountTaxPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
DiscountTaxPage +
:, -
Page. 2
{ 
public		 
 
DiscountTaxViewModel		 
	ViewModel		  )
{		* +
get		, /
;		/ 0
}		1 2
public 

DiscountTaxPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4 
DiscountTaxViewModel4 H
>H I
(I J
)J K
;K L
DataContext 
= 
	ViewModel 
;  
} 
} ²
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\TicketFeeDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class 
TicketFeeDialog +
:, -
ContentDialog. ;
{ 
public 

TicketFeeViewModel 
	ViewModel '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public		 

Action		 
?		 
CloseAction		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public 

TicketFeeDialog 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
new 
TicketFeeViewModel *
(* +
)+ ,
;, -
} 
public 

TicketFeeDialog 
( 
TicketFeeViewModel -
	viewModel. 7
)7 8
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
} 
} ”
pC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\TableSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class  
TableSelectionDialog 0
:1 2
ContentDialog3 @
{ 
public 
#
TableSelectionViewModel "
	ViewModel# ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public

 
 
TableSelectionDialog

 
(

  
)

  !
{ 
InitializeComponent 
( 
) 
; 
} 
} ±
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\SizeSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class 
SizeSelectionDialog /
:0 1
ContentDialog2 ?
{ 
public 
"
SizeSelectionViewModel !
	ViewModel" +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public

 

SizeSelectionDialog

 
(

 
)

  
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
} 
} ™
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\ShiftStartDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
.% &
Dialogs& -
;- .
public 
sealed 
partial 
class 
ShiftStartDialog ,
:- .
ContentDialog/ <
{		 
public

 

ShiftStartViewModel

 
	ViewModel

 (
{

) *
get

+ .
;

. /
}

0 1
public 

ShiftStartDialog 
( 
) 
: 
this  $
($ %
App% (
.( )
Services) 1
.1 2
GetRequiredService2 D
<D E
ShiftStartViewModelE X
>X Y
(Y Z
)Z [
)[ \
{ 
} 
public 

ShiftStartDialog 
( 
ShiftStartViewModel /
	viewModel0 9
)9 :
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
this 
. 
DataContext 
= 
	ViewModel $
;$ %
	ViewModel 
. 
CloseAction 
= 
(  !
result! '
)' (
=>) +
{ 	
this 
. 
Hide 
( 
) 
; 
} 	
;	 

this 
. 
Opened 
+= #
ShiftStartDialog_Opened .
;. /
} 
private 
async 
void #
ShiftStartDialog_Opened .
(. /
ContentDialog/ <
sender= C
,C D(
ContentDialogOpenedEventArgsE a
argsb f
)f g
{ 
try!! 
{"" 	
await## 
	ViewModel## 
.## 
InitializeAsync## +
(##+ ,
)##, -
;##- .
}$$ 	
catch%% 
(%% 
	Exception%% 
ex%% 
)%% 
{&& 	
try'' 
{(( 
var)) 
dialogService)) !
=))" #
App))$ '
.))' (
Services))( 0
.))0 1
GetRequiredService))1 C
<))C D
Magidesk))D L
.))L M
Application))M X
.))X Y

Interfaces))Y c
.))c d
IDialogService))d r
>))r s
())s t
)))t u
;))u v
await** 
dialogService** #
.**# $
ShowErrorAsync**$ 2
(**2 3
$str**3 F
,**F G
$str**H l
,**l m
ex**n p
.**p q
ToString**q y
(**y z
)**z {
)**{ |
;**| }
this++ 
.++ 
Hide++ 
(++ 
)++ 
;++ 
},, 
catch-- 
{.. 
this00 
.00 
Hide00 
(00 
)00 
;00 
}11 
}22 	
}33 
}44  

jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\ShiftEndDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
.% &
Dialogs& -
;- .
public 
sealed 
partial 
class 
ShiftEndDialog *
:+ ,
ContentDialog- :
{ 
public 

ShiftEndViewModel 
	ViewModel &
{' (
get) ,
;, -
}. /
public

 

ShiftEndDialog

 
(

 
ShiftEndViewModel

 +
	viewModel

, 5
)

5 6
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
this 
. 
DataContext 
= 
	ViewModel $
;$ %
	ViewModel 
. 
CloseAction 
= 
(  !
)! "
=># %
{ 	
this 
. 
Hide 
( 
) 
; 
} 	
;	 

} 
} ¹
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\SeatSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
{ 
public 

sealed 
partial 
class 
SeatSelectionDialog  3
:4 5
ContentDialog6 C
{ 
public "
SeatSelectionViewModel %
	ViewModel& /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public

 
SeatSelectionDialog

 "
(

" #
)

# $
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
new "
SeatSelectionViewModel 2
(2 3
)3 4
;4 5
this 
. 
DataContext 
= 
	ViewModel (
;( )
} 	
} 
} Ë
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\QuantityDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
; 
public 
sealed 
partial 
class 
QuantityDialog *
:+ ,
ContentDialog- :
{ 
public 

QuantityViewModel 
	ViewModel &
{' (
get) ,
;, -
}. /
public

 

QuantityDialog

 
(

 
)

 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
new 
QuantityViewModel )
() *
)* +
;+ ,
this 
. 
DataContext 
= 
	ViewModel $
;$ %
} 
} ¥
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\PriceEntryDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class 
PriceEntryDialog ,
:- .
ContentDialog/ <
{ 
public 

PriceEntryViewModel 
	ViewModel (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public

 

PriceEntryDialog

 
(

 
)

 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
} 
} ¸
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\PizzaModifierDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class 
PizzaModifierDialog /
:0 1
ContentDialog2 ?
{ 
public 
"
PizzaModifierViewModel !
	ViewModel" +
{		 
get

 
=>

 
(

 "
PizzaModifierViewModel

 &
)

& '
DataContext

' 2
;

2 3
set 
=> 
DataContext 
= 
value "
;" #
} 
public 

PizzaModifierDialog 
( 
)  
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
this 
. 
Opened 
+= &
PizzaModifierDialog_Opened 1
;1 2
this 
. 
PrimaryButtonClick 
+=  "2
&PizzaModifierDialog_PrimaryButtonClick# I
;I J
this 
. 
CloseButtonClick 
+=  0
$PizzaModifierDialog_CloseButtonClick! E
;E F
} 
private 
async 
void &
PizzaModifierDialog_Opened 1
(1 2
ContentDialog2 ?
sender@ F
,F G(
ContentDialogOpenedEventArgsH d
argse i
)i j
{ 
if 

( 
	ViewModel 
!= 
null 
) 
{ 	
await 
	ViewModel 
. 
InitializeAsync +
(+ ,
), -
;- .
} 	
} 
private 
void 2
&PizzaModifierDialog_PrimaryButtonClick 7
(7 8
ContentDialog8 E
senderF L
,L M-
!ContentDialogButtonClickEventArgsN o
argsp t
)t u
{ 
	ViewModel   
?   
.   
ConfirmCommand   !
.  ! "
Execute  " )
(  ) *
null  * .
)  . /
;  / 0
}!! 
private## 
void## 0
$PizzaModifierDialog_CloseButtonClick## 5
(##5 6
ContentDialog##6 C
sender##D J
,##J K-
!ContentDialogButtonClickEventArgs##L m
args##n r
)##r s
{$$ 
	ViewModel%% 
?%% 
.%% 
CancelCommand%%  
.%%  !
Execute%%! (
(%%( )
null%%) -
)%%- .
;%%. /
}&& 
}'' ß

gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\NotesDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
.% &
Dialogs& -
;- .
public 
sealed 
partial 
class 
NotesDialog '
:( )
ContentDialog* 7
{ 
public 

object 
	ViewModel 
{ 
get !
;! "
}# $
public

 

NotesDialog

 
(

 
object

 
	viewModel

 '
)

' (
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
DataContext 
= 
	ViewModel 
;  
if 

( 
	viewModel 
is  
NotesDialogViewModel -
vm. 0
)0 1
{ 	
vm 
. 
RequestClose 
+= 
(  
s  !
,! "
e# $
)$ %
=>& (
Hide) -
(- .
). /
;/ 0
} 	
} 
} ü

sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\ModifierSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class #
ModifierSelectionDialog 3
:4 5
ContentDialog6 C
{ 
public 
&
ModifierSelectionViewModel %
	ViewModel& /
{0 1
get2 5
;5 6
}7 8
public

 
#
ModifierSelectionDialog

 "
(

" #&
ModifierSelectionViewModel

# =
	viewModel

> G
)

G H
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
	ViewModel 
. 
CloseAction 
= 
(  !
)! "
=># %
Hide& *
(* +
)+ ,
;, -
Loaded 
+= 
async 
( 
s 
, 
e 
) 
=> !
await" '
	ViewModel( 1
.1 2
InitializeAsync2 A
(A B
)B C
;C D
} 
} ý	
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\MiscItemDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class 
MiscItemDialog *
:+ ,
ContentDialog- :
{ 
public 

MiscItemViewModel 
	ViewModel &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public

 

MiscItemDialog

 
(

 
)

 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
new 
MiscItemViewModel )
() *
)* +
;+ ,
} 
public 

MiscItemDialog 
( 
MiscItemViewModel +
	viewModel, 5
)5 6
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
} 
} ¾
nC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\MergeTicketsDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
{ 
public 

sealed 
partial 
class 
MergeTicketsDialog  2
:3 4
ContentDialog5 B
{ 
public !
MergeTicketsViewModel $
	ViewModel% .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public

 
MergeTicketsDialog

 !
(

! "
)

" #
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
} 
} ¥
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\ItemSearchDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class 
ItemSearchDialog ,
:- .
ContentDialog/ <
{ 
public 

ItemSearchViewModel 
	ViewModel (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public

 

ItemSearchDialog

 
(

 
)

 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
} 
} ²
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\GuestCountDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
.% &
Dialogs& -
;- .
public 
sealed 
partial 
class 
GuestCountDialog ,
:- .
ContentDialog/ <
{ 
public 

GuestCountViewModel 
	ViewModel (
{) *
get+ .
;. /
}0 1
public

 

GuestCountDialog

 
(

 
GuestCountViewModel

 /
	viewModel

0 9
)

9 :
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
} 
} í
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\CustomerSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class #
CustomerSelectionDialog 3
:4 5
ContentDialog6 C
{ 
public 
&
CustomerSelectionViewModel %
	ViewModel& /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
=> ?
new@ C
(C D
)D E
;E F
public

 
#
CustomerSelectionDialog

 "
(

" #
)

# $
{ 
InitializeComponent 
( 
) 
; 
} 
} ü

tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\CookingInstructionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class $
CookingInstructionDialog 4
:5 6
ContentDialog7 D
{ 
public 
'
CookingInstructionViewModel &
	ViewModel' 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public

 
$
CookingInstructionDialog

 #
(

# $
)

$ %
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
this 
. 
Loaded 
+= 
( 
s 
, 
e 
) 
=>  
{ 	
if 
( 
this 
. 
Content 
is  
Grid! %
grid& *
)* +
grid, 0
.0 1
Name1 5
=6 7
$str8 B
;B C
this 
. 
DataContext 
= 
	ViewModel  )
;) *
} 	
;	 

} 
} í

pC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\ComboSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class  
ComboSelectionDialog 0
:1 2
ContentDialog3 @
{ 
public 
#
ComboSelectionViewModel "
	ViewModel# ,
{- .
get/ 2
;2 3
}4 5
public

 
 
ComboSelectionDialog

 
(

  #
ComboSelectionViewModel

  7
	viewModel

8 A
)

A B
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
	ViewModel 
. 
CloseAction 
= 
(  !
)! "
=># %
Hide& *
(* +
)+ ,
;, -
Loaded 
+= 
async 
( 
s 
, 
e 
) 
=> !
await" '
	ViewModel( 1
.1 2
InitializeAsync2 A
(A B
)B C
;C D
} 
} Ý
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\CashEntryDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
.% &
Dialogs& -
;- .
public 
sealed 
partial 
class 
CashEntryDialog +
:, -
ContentDialog. ;
{ 
public 

decimal 
Amount 
{		 
get

 
{ 	
if 
( 
decimal 
. 
TryParse  
(  !
	AmountBox! *
.* +
Text+ /
,/ 0
out1 4
var5 8
val9 <
)< =
)= >
return? E
valF I
;I J
return 
$num 
; 
} 	
} 
public 

string 
Reason 
=> 
	ReasonBox %
.% &
Text& *
;* +
public 

CashEntryDialog 
( 
string !
title" '
,' (
string) /
message0 7
)7 8
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
this 
. 
Title 
= 
title 
; 
MessageTextBlock 
. 
Text 
= 
message  '
;' (
} 
} í

pC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Dialogs\AddOnSelectionDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
. 
Dialogs  
;  !
public 
sealed 
partial 
class  
AddOnSelectionDialog 0
:1 2
ContentDialog3 @
{ 
public 
#
AddOnSelectionViewModel "
	ViewModel# ,
{- .
get/ 2
;2 3
}4 5
public

 
 
AddOnSelectionDialog

 
(

  #
AddOnSelectionViewModel

  7
	viewModel

8 A
)

A B
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
	viewModel 
; 
	ViewModel 
. 
CloseAction 
= 
(  !
)! "
=># %
Hide& *
(* +
)+ ,
;, -
Loaded 
+= 
async 
( 
s 
, 
e 
) 
=> !
await" '
	ViewModel( 1
.1 2
InitializeAsync2 A
(A B
)B C
;C D
} 
} ÁI
uC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Components\VirtualizedTableCanvas.xaml.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  
Views		  %
.		% &

Components		& 0
;		0 1
public 
sealed 
partial 
class "
VirtualizedTableCanvas 2
:3 4
UserControl5 @
{ 
private "
TableDesignerViewModel "
?" #

_viewModel$ .
;. /
private 
DispatcherTimer 
? 
	_fpsTimer &
;& '
private 
DateTime 
_lastFrameTime #
=$ %
DateTime& .
.. /
UtcNow/ 5
;5 6
private 
int 
_frameCount 
= 
$num 
;  
private 
const 
int 
FPS_UPDATE_INTERVAL )
=* +
$num, 0
;0 1
public 
"
VirtualizedTableCanvas !
(! "
)" #
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	_fpsTimer 
= 
new 
DispatcherTimer '
(' (
)( )
;) *
	_fpsTimer 
. 
Interval 
= 
TimeSpan %
.% &
FromMilliseconds& 6
(6 7
FPS_UPDATE_INTERVAL7 J
)J K
;K L
	_fpsTimer 
. 
Tick 
+= 
	UpdateFPS #
;# $
	_fpsTimer 
. 
Start 
( 
) 
; 
this 
. 
Unloaded 
+= 

OnUnloaded #
;# $
} 
public   
"
TableDesignerViewModel   !
	ViewModel  " +
{!! 
get"" 
=>"" 

_viewModel"" 
!"" 
;"" 
set## 
{$$ 	

_viewModel%% 
=%% 
value%% 
;%% 
DataContext&& 
=&& 
value&& 
;&&  
}'' 	
}(( 
private** 
void** $
ScrollViewer_ViewChanged** )
(**) *
object*** 0
sender**1 7
,**7 8,
 ScrollViewerViewChangedEventArgs**9 Y
e**Z [
)**[ \
{++ 
UpdateVisibleTables,, 
(,, 
),, 
;,, 
}-- 
private// 
void// $
ScrollViewer_SizeChanged// )
(//) *
object//* 0
sender//1 7
,//7 8 
SizeChangedEventArgs//9 M
e//N O
)//O P
{00 
UpdateVisibleTables11 
(11 
)11 
;11 
}22 
private44 
void44 
UpdateVisibleTables44 $
(44$ %
)44% &
{55 
if66 

(66 

_viewModel66 
==66 
null66 
||66 !
MainScrollViewer66" 2
==663 5
null666 :
)66: ;
return66< B
;66B C
var88 
viewport88 
=88 
new88 
Rect88 
(88  
MainScrollViewer99 
.99 
HorizontalOffset99 -
,99- .
MainScrollViewer:: 
.:: 
VerticalOffset:: +
,::+ ,
MainScrollViewer;; 
.;; 
ViewportWidth;; *
,;;* +
MainScrollViewer<< 
.<< 
ViewportHeight<< +
)== 	
;==	 


_viewModel@@ 
.@@ 
UpdateVisibleTables@@ &
(@@& '
viewport@@' /
)@@/ 0
;@@0 1
}AA 
privateCC 
voidCC 
Table_DragStartingCC #
(CC# $
	UIElementCC$ -
senderCC. 4
,CC4 5!
DragStartingEventArgsCC6 K
argsCCL P
)CCP Q
{DD 
ifEE 

(EE 

_viewModelEE 
?EE 
.EE 
IsDesignModeEE $
!=EE% '
trueEE( ,
)EE, -
returnEE. 4
;EE4 5
ifGG 

(GG 
senderGG 
isGG 
FrameworkElementGG &
elementGG' .
&&GG/ 1
elementGG2 9
.GG9 :
DataContextGG: E
isGGF H
TableDtoGGI Q
tableGGR W
)GGW X
{HH 	
argsII 
.II 
DataII 
.II 
SetTextII 
(II 
$"II  
$strII  &
{II& '
tableII' ,
.II, -
IdII- /
}II/ 0
"II0 1
)II1 2
;II2 3
}JJ 	
}KK 
privateMM 
voidMM 

Table_DropMM 
(MM 
objectMM "
senderMM# )
,MM) *
DragEventArgsMM+ 8
eMM9 :
)MM: ;
{NN 
ifOO 

(OO 

_viewModelOO 
?OO 
.OO 
IsDesignModeOO $
!=OO% '
trueOO( ,
)OO, -
returnOO. 4
;OO4 5
varQQ 
positionQQ 
=QQ 
eQQ 
.QQ 
GetPositionQQ $
(QQ$ %
nullQQ% )
)QQ) *
;QQ* +
}SS 
privateUU 
voidUU 
Table_TappedUU 
(UU 
objectUU $
senderUU% +
,UU+ ,!
TappedRoutedEventArgsUU- B
eUUC D
)UUD E
{VV 
ifWW 

(WW 
senderWW 
isWW 
FrameworkElementWW &
elementWW' .
&&WW/ 1
elementWW2 9
.WW9 :
DataContextWW: E
isWWF H
TableDtoWWI Q
tableWWR W
)WWW X
{XX 	

_viewModelYY 
?YY 
.YY 
SelectTableCommandYY *
.YY* +
ExecuteYY+ 2
(YY2 3
tableYY3 8
)YY8 9
;YY9 :
}ZZ 	
}[[ 
private]] 
void]] %
Table_ManipulationStarted]] *
(]]* +
object]]+ 1
sender]]2 8
,]]8 9.
"ManipulationStartedRoutedEventArgs]]: \
e]]] ^
)]]^ _
{^^ 
if__ 

(__ 

_viewModel__ 
?__ 
.__ 
IsDesignMode__ $
!=__% '
true__( ,
)__, -
return__. 4
;__4 5
ifaa 

(aa 
senderaa 
isaa 
FrameworkElementaa &
elementaa' .
&&aa/ 1
elementaa2 9
.aa9 :
DataContextaa: E
isaaF H
TableDtoaaI Q
tableaaR W
)aaW X
{bb 	
}dd 	
}ee 
privategg 
voidgg #
Table_ManipulationDeltagg (
(gg( )
objectgg) /
sendergg0 6
,gg6 7,
 ManipulationDeltaRoutedEventArgsgg8 X
eggY Z
)ggZ [
{hh 
ifii 

(ii 

_viewModelii 
?ii 
.ii 
IsDesignModeii $
!=ii% '
trueii( ,
)ii, -
returnii. 4
;ii4 5
}ll 
privatenn 
voidnn '
Table_ManipulationCompletednn ,
(nn, -
objectnn- 3
sendernn4 :
,nn: ;0
$ManipulationCompletedRoutedEventArgsnn< `
enna b
)nnb c
{oo 
}qq 
privatess 
voidss 
	UpdateFPSss 
(ss 
objectss !
?ss! "
senderss# )
,ss) *
objectss+ 1
ess2 3
)ss3 4
{tt 
varuu 
nowuu 
=uu 
DateTimeuu 
.uu 
UtcNowuu !
;uu! "
varvv 
elapsedvv 
=vv 
(vv 
nowvv 
-vv 
_lastFrameTimevv +
)vv+ ,
.vv, -
TotalMillisecondsvv- >
;vv> ?
ifxx 

(xx 
elapsedxx 
>xx 
$numxx 
)xx 
{yy 	

_viewModelzz 
.zz 

CurrentFPSzz !
=zz" #
(zz$ %
intzz% (
)zz( )
(zz) *
_frameCountzz* 5
*zz6 7
$numzz8 <
/zz= >
elapsedzz? F
)zzF G
;zzG H
}{{ 	
_frameCount}} 
=}} 
$num}} 
;}} 
_lastFrameTime~~ 
=~~ 
now~~ 
;~~ 

_viewModel 
. 
LastRenderTime !
=" #
now$ '
;' (
}
€€ 
private
‚‚ 
void
‚‚ 

OnUnloaded
‚‚ 
(
‚‚ 
object
‚‚ "
sender
‚‚# )
,
‚‚) *
RoutedEventArgs
‚‚+ :
e
‚‚; <
)
‚‚< =
{
ƒƒ 
	_fpsTimer
„„ 
?
„„ 
.
„„ 
Stop
„„ 
(
„„ 
)
„„ 
;
„„ 
	_fpsTimer
…… 
=
…… 
null
…… 
;
…… 
}
†† 
}‡‡ ç
pC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\Components\TableShapePalette.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
.% &

Components& 0
;0 1
public 
sealed 
partial 
class 
TableShapePalette -
:. /
UserControl0 ;
{ 
public 
"
TableDesignerViewModel !
?! "
	ViewModel# ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public

 

TableShapePalette

 
(

 
)

 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
} 
} ú
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\CashSessionPage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
CashSessionPage +
:, -
Page. 2
{ 
public		 
 
CashSessionViewModel		 
	ViewModel		  )
{		* +
get		, /
;		/ 0
}		1 2
public 

CashSessionPage 
( 
) 
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4 
CashSessionViewModel4 H
>H I
(I J
)J K
;K L
DataContext 
= 
	ViewModel 
;  
} 
	protected 
override 
async 
void !
OnNavigatedTo" /
(/ 0
	Microsoft0 9
.9 :
UI: <
.< =
Xaml= A
.A B

NavigationB L
.L M
NavigationEventArgsM `
ea b
)b c
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
await 
	ViewModel 
. 
RefreshAsync $
($ %
)% &
;& '
} 
} ±
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\CashEntryDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
CashEntryDialog +
:, -
ContentDialog. ;
{ 
public 

decimal 
Amount 
{		 
get

 
{ 	
if 
( 
decimal 
. 
TryParse  
(  !
	AmountBox! *
.* +
Text+ /
,/ 0
out1 4
var5 8
val9 <
)< =
)= >
return? E
valF I
;I J
return 
$num 
; 
} 	
} 
public 

string 
Reason 
=> 
	ReasonBox %
.% &
Text& *
;* +
public 

CashEntryDialog 
( 
string !
title" '
,' (
string) /
message0 7
)7 8
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
this 
. 
Title 
= 
title 
; 
MessageTextBlock 
. 
Text 
= 
message  '
;' (
} 
} 	
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\CashDropManagementDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class $
CashDropManagementDialog 4
:5 6
ContentDialog7 D
{ 
public		 
'
CashDropManagementViewModel		 &
	ViewModel		' 0
{		1 2
get		3 6
;		6 7
}		8 9
public 
$
CashDropManagementDialog #
(# $
)$ %
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4'
CashDropManagementViewModel4 O
>O P
(P Q
)Q R
;R S
this 
. 
DataContext 
= 
	ViewModel $
;$ %
} 
} ³'
bC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\BackOfficePage.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Views  %
;% &
public 
sealed 
partial 
class 
BackOfficePage *
:+ ,
Page- 1
{		 
public

 

BackOfficeViewModel

 
	ViewModel

 (
{

) *
get

+ .
;

. /
}

0 1
public 

BackOfficePage 
( 
) 
{ 
this 
. 
InitializeComponent  
(  !
)! "
;" #
	ViewModel 
= 
App 
. 
Services  
.  !
GetRequiredService! 3
<3 4
BackOfficeViewModel4 G
>G H
(H I
)I J
;J K
var 
navView 
= 
this 
. 
Content "
as# %
Grid& *
;* +
if 

( 
navView 
? 
. 
Children 
[ 
$num 
]  
is! #
NavigationView$ 2
nv3 5
)5 6
{ 	
nv 
. 
SelectionChanged 
+=  "
Nv_SelectionChanged# 6
;6 7
} 	
} 
	protected 
override 
void 
OnNavigatedTo )
() *
NavigationEventArgs* =
e> ?
)? @
{ 
base 
. 
OnNavigatedTo 
( 
e 
) 
; 
if 

( 
e 
. 
	Parameter 
is 
Type 

targetType  *
)* +
{ 	
var   
navView   
=   
(   
this    
.    !
Content  ! (
as  ) +
Grid  , 0
)  0 1
?  1 2
.  2 3
Children  3 ;
[  ; <
$num  < =
]  = >
as  ? A
NavigationView  B P
;  P Q
if!! 
(!! 
navView!! 
!=!! 
null!!  
)!!  !
{"" 
var## 
item## 
=## 
	ViewModel## %
.##% &
NavigationItems##& 5
.##5 6
FirstOrDefault##6 D
(##D E
i##E F
=>##G I
i##J K
.##K L
PageType##L T
==##U W

targetType##X b
)##b c
;##c d
if$$ 
($$ 
item$$ 
!=$$ 
null$$ !
)$$! "
{%% 
navView&& 
.&& 
SelectedItem&& )
=&&* +
item&&, 0
;&&0 1
}(( 
})) 
}** 	
}++ 
private-- 
void-- 
Nv_SelectionChanged-- $
(--$ %
NavigationView--% 3
sender--4 :
,--: ;3
'NavigationViewSelectionChangedEventArgs--< c
args--d h
)--h i
{.. 
if// 

(// 
args// 
.// 
SelectedItem// 
is//  
NavigationItem//! /
item//0 4
)//4 5
{00 	
	ViewModel11 
.11 
NavigateCommand11 %
.11% &
Execute11& -
(11- .
item11. 2
)112 3
;113 4
if33 
(33 
item33 
.33 
PageType33 
==33  
typeof33! '
(33' (
object33( .
)33. /
)33/ 0
{44 
_55 
=55 #
ShowNotImplementedAsync55 +
(55+ ,
item55, 0
.550 1
Title551 6
)556 7
;557 8
return66 
;66 
}77 
ContentFrame99 
.99 
Navigate99 !
(99! "
item99" &
.99& '
PageType99' /
)99/ 0
;990 1
}:: 	
};; 
private== 
async== 
Task== #
ShowNotImplementedAsync== .
(==. /
string==/ 5
title==6 ;
)==; <
{>> 
var?? 
dialog?? 
=?? 
new?? 
ContentDialog?? &
{@@ 	
TitleAA 
=AA 
titleAA 
,AA 
ContentBB 
=BB 
$strBB ,
,BB, -
CloseButtonTextCC 
=CC 
$strCC "
,CC" #
XamlRootDD 
=DD 
thisDD 
.DD 
XamlRootDD $
}EE 	
;EE	 

awaitGG 
dialogGG 
.GG 
	ShowAsyncGG 
(GG 
)GG  
;GG  !
}HH 
}II È
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\AuthorizationCodeDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
{ 
public 

sealed 
partial 
class #
AuthorizationCodeDialog  7
:8 9
ContentDialog: G
{		 
public

 &
AuthorizationCodeViewModel

 )
	ViewModel

* 3
{

4 5
get

6 9
;

9 :
}

; <
public #
AuthorizationCodeDialog &
(& '
)' (
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
App 
. 
Services $
.$ %
GetRequiredService% 7
<7 8&
AuthorizationCodeViewModel8 R
>R S
(S T
)T U
;U V
this 
. 
DataContext 
= 
	ViewModel (
;( )
} 	
private 
void 
CardType_Checked %
(% &
object& ,
sender- 3
,3 4
	Microsoft5 >
.> ?
UI? A
.A B
XamlB F
.F G
RoutedEventArgsG V
eW X
)X Y
{ 	
if 
( 
sender 
is 
RadioButton %
rb& (
&&) +
rb, .
.. /
Tag/ 2
is3 5
string6 <
cardType= E
)E F
{ 
	ViewModel 
. 
SelectedCardType *
=+ ,
cardType- 5
;5 6
} 
} 	
} 
} ù
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Views\AuthorizationCaptureBatchDialog.xaml.cs
	namespace 	
Magidesk
 
. 
Views 
{ 
public 

sealed 
partial 
class +
AuthorizationCaptureBatchDialog  ?
:@ A
ContentDialogB O
{		 
public

 .
"AuthorizationCaptureBatchViewModel

 1
	ViewModel

2 ;
{

< =
get

> A
;

A B
}

C D
public +
AuthorizationCaptureBatchDialog .
(. /
)/ 0
{ 	
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
= 
App 
. 
Services $
.$ %
GetRequiredService% 7
<7 8.
"AuthorizationCaptureBatchViewModel8 Z
>Z [
([ \
)\ ]
;] ^
this 
. 
DataContext 
= 
	ViewModel (
;( )
this 
. 
Opened 
+= 2
&AuthorizationCaptureBatchDialog_Opened A
;A B
} 	
private 
async 
void 2
&AuthorizationCaptureBatchDialog_Opened A
(A B
ContentDialogB O
senderP V
,V W(
ContentDialogOpenedEventArgsX t
argsu y
)y z
{ 	
await 
	ViewModel 
. 
StartBatchCommand -
.- .
ExecuteAsync. :
(: ;
null; ?
)? @
;@ A
} 	
private 
void !
ContentDialog_Closing *
(* +
ContentDialog+ 8
sender9 ?
,? @)
ContentDialogClosingEventArgsA ^
args_ c
)c d
{ 	
if 
( 
	ViewModel 
. 
IsProcessing &
)& '
{ 
args   
.   
Cancel   
=   
true   "
;  " #
}!! 
}"" 	
}## 
}$$ ûB
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\VoidTicketViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class 
VoidTicketViewModel  
:! "
ViewModelBase# 0
{ 
private 
readonly 
ICommandHandler $
<$ %
VoidTicketCommand% 6
>6 7
_voidTicketHandler8 J
;J K
private 
readonly 
IUserService !
_userService" .
;. /
private 
	TicketDto 
_ticket 
; 
public 

	TicketDto 
Ticket 
{ 
get 
=> 
_ticket 
; 
set 
=> 
SetProperty 
( 
ref 
_ticket &
,& '
value( -
)- .
;. /
} 
private  
ObservableCollection  
<  !
string! '
>' (
_voidReasons) 5
;5 6
public 
 
ObservableCollection 
<  
string  &
>& '
VoidReasons( 3
{ 
get 
=> 
_voidReasons 
; 
set 
=> 
SetProperty 
( 
ref 
_voidReasons +
,+ ,
value- 2
)2 3
;3 4
} 
private!! 
string!! 
_selectedReason!! "
;!!" #
public"" 

string"" 
SelectedReason""  
{## 
get$$ 
=>$$ 
_selectedReason$$ 
;$$ 
set%% 
{&& 	
if'' 
('' 
SetProperty'' 
('' 
ref'' 
_selectedReason''  /
,''/ 0
value''1 6
)''6 7
)''7 8
{(( 
()) 
()) 
AsyncRelayCommand)) #
<))# $
object))$ *
?))* +
>))+ ,
))), -
VoidCommand))- 8
)))8 9
.))9 :#
NotifyCanExecuteChanged)): Q
())Q R
)))R S
;))S T
}** 
}++ 	
},, 
private.. 
bool.. 
	_isWasted.. 
;.. 
public// 

bool// 
IsWasted// 
{00 
get11 
=>11 
	_isWasted11 
;11 
set22 
=>22 
SetProperty22 
(22 
ref22 
	_isWasted22 (
,22( )
value22* /
)22/ 0
;220 1
}33 
private55 
string55 
_errorMessage55  
;55  !
public66 

string66 
ErrorMessage66 
{77 
get88 
=>88 
_errorMessage88 
;88 
set99 
=>99 
SetProperty99 
(99 
ref99 
_errorMessage99 ,
,99, -
value99. 3
)993 4
;994 5
}:: 
private<< 
bool<< 
	_hasError<< 
;<< 
public== 

bool== 
HasError== 
{>> 
get?? 
=>?? 
	_hasError?? 
;?? 
set@@ 
=>@@ 
SetProperty@@ 
(@@ 
ref@@ 
	_hasError@@ (
,@@( )
value@@* /
)@@/ 0
;@@0 1
}AA 
publicCC 

ICommandCC 
VoidCommandCC 
{CC  !
getCC" %
;CC% &
}CC' (
publicEE 

VoidTicketViewModelEE 
(EE 
ICommandHandlerFF 
<FF 
VoidTicketCommandFF )
>FF) *
voidTicketHandlerFF+ <
,FF< =
IUserServiceGG 
userServiceGG  
)GG  !
{HH 
_voidTicketHandlerII 
=II 
voidTicketHandlerII .
;II. /
_userServiceJJ 
=JJ 
userServiceJJ "
;JJ" #
VoidCommandMM 
=MM 
newMM 
AsyncRelayCommandMM +
<MM+ ,
objectMM, 2
?MM2 3
>MM3 4
(MM4 5
	VoidAsyncMM5 >
,MM> ?
CanVoidMM@ G
)MMG H
;MMH I
VoidReasonsPP 
=PP 
newPP  
ObservableCollectionPP .
<PP. /
stringPP/ 5
>PP5 6
{QQ 	
$strRR 
,RR 
$strSS #
,SS# $
$strTT 
,TT 
$strUU 
,UU 
$strVV 
}WW 	
;WW	 

IsWastedXX 
=XX 
trueXX 
;XX 
}YY 
public[[ 

void[[ 

Initialize[[ 
([[ 
	TicketDto[[ $
ticket[[% +
)[[+ ,
{\\ 
Ticket]] 
=]] 
ticket]] 
;]] 
SelectedReason^^ 
=^^ 
null^^ 
;^^ 
ErrorMessage__ 
=__ 
string__ 
.__ 
Empty__ #
;__# $
HasError`` 
=`` 
false`` 
;`` 
}aa 
privatecc 
asynccc 
Taskcc 
	VoidAsynccc  
(cc  !
objectcc! '
?cc' (
	parametercc) 2
)cc2 3
{dd 
ifee 

(ee 
	parameteree 
isee 
notee 
ContentDialogee *
dialogee+ 1
)ee1 2
returnee3 9
;ee9 :
ifgg 

(gg 
stringgg 
.gg 
IsNullOrEmptygg  
(gg  !
SelectedReasongg! /
)gg/ 0
)gg0 1
{hh 	
ErrorMessageii 
=ii 
$strii 4
;ii4 5
HasErrorjj 
=jj 
truejj 
;jj 
returnkk 
;kk 
}ll 	
trynn 
{oo 	
varpp 
currentUserpp 
=pp 
_userServicepp *
.pp* +
CurrentUserpp+ 6
;pp6 7
ifqq 
(qq 
currentUserqq 
==qq 
nullqq #
)qq# $
{rr 
ErrorMessagess 
=ss 
$strss  4
;ss4 5
HasErrortt 
=tt 
truett  
;tt  !
returnuu 
;uu 
}vv 
varxx 
commandxx 
=xx 
newxx 
VoidTicketCommandxx /
{yy 
TicketIdzz 
=zz 
Ticketzz !
.zz! "
Idzz" $
,zz$ %
VoidedBy{{ 
={{ 
new{{ 
Magidesk{{ '
.{{' (
Domain{{( .
.{{. /
ValueObjects{{/ ;
.{{; <
UserId{{< B
({{B C
currentUser{{C N
.{{N O
Id{{O Q
){{Q R
,{{R S
Reason|| 
=|| 
SelectedReason|| '
,||' (
IsWasted}} 
=}} 
IsWasted}} #
}~~ 
;~~ 
await
€€  
_voidTicketHandler
€€ $
.
€€$ %
HandleAsync
€€% 0
(
€€0 1
command
€€1 8
)
€€8 9
;
€€9 :
if
‚‚ 
(
‚‚ 
dialog
‚‚ 
is
‚‚ 
ContentDialog
‚‚ '
cd
‚‚( *
)
‚‚* +
{
ƒƒ 
cd
„„ 
.
„„ 
Hide
„„ 
(
„„ 
)
„„ 
;
„„ 
}
…… 
}
†† 	
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡ 
{
ˆˆ 	
ErrorMessage
‰‰ 
=
‰‰ 
ex
‰‰ 
.
‰‰ 
Message
‰‰ %
;
‰‰% &
HasError
ŠŠ 
=
ŠŠ 
true
ŠŠ 
;
ŠŠ 
}
‹‹ 	
}
ŒŒ 
private
ŽŽ 
bool
ŽŽ 
CanVoid
ŽŽ 
(
ŽŽ 
object
ŽŽ 
?
ŽŽ  
	parameter
ŽŽ! *
)
ŽŽ* +
{
 
return
 
!
 
string
 
.
 
IsNullOrEmpty
 $
(
$ %
SelectedReason
% 3
)
3 4
;
4 5
}
‘‘ 
}’’ ¤
aC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\ViewModelBase.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
abstract 
class 
ViewModelBase #
:$ %
CommunityToolkit& 6
.6 7
Mvvm7 ;
.; <
ComponentModel< J
.J K
ObservableObjectK [
{		 
private

 
bool

 
_isBusy

 
;

 
private 
string 
? 
_title 
; 
public 

bool 
IsBusy 
{ 
get 
=> 
_isBusy 
; 
set 
=> 
SetProperty 
( 
ref 
_isBusy &
,& '
value( -
)- .
;. /
} 
public 

string 
? 
Title 
{ 
get 
=> 
_title 
; 
set 
=> 
SetProperty 
( 
ref 
_title %
,% &
value' ,
), -
;- .
} 
private 
string 
? 
_statusMessage "
;" #
public 

string 
? 
StatusMessage  
{ 
get 
=> 
_statusMessage 
; 
set 
=> 
SetProperty 
( 
ref 
_statusMessage -
,- .
value/ 4
)4 5
;5 6
} 
} ÍQ
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\VendorManagementViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
;		* +
public 
class %
VendorManagementViewModel &
:' (
ViewModelBase) 6
{ 
private 
readonly 
IVendorRepository &
_vendorRepository' 8
;8 9
public 
 
ObservableCollection 
<  
Vendor  &
>& '
Vendors( /
{0 1
get2 5
;5 6
}7 8
=9 :
new; >
(> ?
)? @
;@ A
private 
Vendor 
? 
_selectedVendor #
;# $
public 

Vendor 
? 
SelectedVendor !
{ 
get 
=> 
_selectedVendor 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_selectedVendor  /
,/ 0
value1 6
)6 7
)7 8
{ 
if 
( 
value 
!= 
null !
)! "
{ 
EditingName 
=  !
value" '
.' (
Name( ,
;, -
EditingContact "
=# $
value% *
.* +
ContactPerson+ 8
??9 ;
string< B
.B C
EmptyC H
;H I
EditingEmail  
=! "
value# (
.( )
Email) .
??/ 1
string2 8
.8 9
Empty9 >
;> ?
EditingPhone  
=! "
value# (
.( )
PhoneNumber) 4
??5 7
string8 >
.> ?
Empty? D
;D E
EditingAddress "
=# $
value% *
.* +
Address+ 2
??3 5
string6 <
.< =
Empty= B
;B C
	IsEditing   
=   
true    $
;  $ %
}!! 
else"" 
{## 
	IsEditing$$ 
=$$ 
false$$  %
;$$% &
}%% 
}&& 
}'' 	
}(( 
private** 
string** 
_editingName** 
=**  !
string**" (
.**( )
Empty**) .
;**. /
private++ 
string++ 
_editingContact++ "
=++# $
string++% +
.+++ ,
Empty++, 1
;++1 2
private,, 
string,, 
_editingEmail,,  
=,,! "
string,,# )
.,,) *
Empty,,* /
;,,/ 0
private-- 
string-- 
_editingPhone--  
=--! "
string--# )
.--) *
Empty--* /
;--/ 0
private.. 
string.. 
_editingAddress.. "
=..# $
string..% +
...+ ,
Empty.., 1
;..1 2
private// 
bool// 

_isEditing// 
;// 
public11 

string11 
EditingName11 
{11 
get11  #
=>11$ &
_editingName11' 3
;113 4
set115 8
=>119 ;
SetProperty11< G
(11G H
ref11H K
_editingName11L X
,11X Y
value11Z _
)11_ `
;11` a
}11b c
public22 

string22 
EditingContact22  
{22! "
get22# &
=>22' )
_editingContact22* 9
;229 :
set22; >
=>22? A
SetProperty22B M
(22M N
ref22N Q
_editingContact22R a
,22a b
value22c h
)22h i
;22i j
}22k l
public33 

string33 
EditingEmail33 
{33  
get33! $
=>33% '
_editingEmail33( 5
;335 6
set337 :
=>33; =
SetProperty33> I
(33I J
ref33J M
_editingEmail33N [
,33[ \
value33] b
)33b c
;33c d
}33e f
public44 

string44 
EditingPhone44 
{44  
get44! $
=>44% '
_editingPhone44( 5
;445 6
set447 :
=>44; =
SetProperty44> I
(44I J
ref44J M
_editingPhone44N [
,44[ \
value44] b
)44b c
;44c d
}44e f
public55 

string55 
EditingAddress55  
{55! "
get55# &
=>55' )
_editingAddress55* 9
;559 :
set55; >
=>55? A
SetProperty55B M
(55M N
ref55N Q
_editingAddress55R a
,55a b
value55c h
)55h i
;55i j
}55k l
public66 

bool66 
	IsEditing66 
{66 
get66 
=>66  "

_isEditing66# -
;66- .
set66/ 2
=>663 5
SetProperty666 A
(66A B
ref66B E

_isEditing66F P
,66P Q
value66R W
)66W X
;66X Y
}66Z [
public88 

ICommand88 
LoadVendorsCommand88 &
{88' (
get88) ,
;88, -
}88. /
public99 

ICommand99 
AddVendorCommand99 $
{99% &
get99' *
;99* +
}99, -
public:: 

ICommand:: 
SaveVendorCommand:: %
{::& '
get::( +
;::+ ,
}::- .
public;; 

ICommand;; 
DeleteVendorCommand;; '
{;;( )
get;;* -
;;;- .
};;/ 0
public== 
%
VendorManagementViewModel== $
(==$ %
IVendorRepository==% 6
vendorRepository==7 G
)==G H
{>> 
_vendorRepository?? 
=?? 
vendorRepository?? ,
;??, -
Title@@ 
=@@ 
$str@@ #
;@@# $
LoadVendorsCommandBB 
=BB 
newBB  
AsyncRelayCommandBB! 2
(BB2 3
LoadVendorsAsyncBB3 C
)BBC D
;BBD E
AddVendorCommandCC 
=CC 
newCC 
AsyncRelayCommandCC 0
(CC0 1
AddVendorAsyncCC1 ?
)CC? @
;CC@ A
SaveVendorCommandDD 
=DD 
newDD 
AsyncRelayCommandDD  1
(DD1 2
SaveVendorAsyncDD2 A
)DDA B
;DDB C
DeleteVendorCommandEE 
=EE 
newEE !
AsyncRelayCommandEE" 3
(EE3 4
DeleteVendorAsyncEE4 E
)EEE F
;EEF G
}FF 
privateHH 
asyncHH 
TaskHH 
LoadVendorsAsyncHH '
(HH' (
)HH( )
{II 
IsBusyJJ 
=JJ 
trueJJ 
;JJ 
tryKK 
{LL 	
varMM 
vendorsMM 
=MM 
awaitMM 
_vendorRepositoryMM  1
.MM1 2
GetAllAsyncMM2 =
(MM= >
)MM> ?
;MM? @
VendorsNN 
.NN 
ClearNN 
(NN 
)NN 
;NN 
foreachOO 
(OO 
varOO 
vendorOO 
inOO  "
vendorsOO# *
)OO* +
VendorsOO, 3
.OO3 4
AddOO4 7
(OO7 8
vendorOO8 >
)OO> ?
;OO? @
}PP 	
finallyQQ 
{QQ 
IsBusyQQ 
=QQ 
falseQQ  
;QQ  !
}QQ" #
}RR 
privateTT 
asyncTT 
TaskTT 
AddVendorAsyncTT %
(TT% &
)TT& '
{UU 
varVV 
	newVendorVV 
=VV 
VendorVV 
.VV 
CreateVV %
(VV% &
$strVV& 2
)VV2 3
;VV3 4
awaitWW 
_vendorRepositoryWW 
.WW  
AddAsyncWW  (
(WW( )
	newVendorWW) 2
)WW2 3
;WW3 4
VendorsXX 
.XX 
AddXX 
(XX 
	newVendorXX 
)XX 
;XX 
SelectedVendorYY 
=YY 
	newVendorYY "
;YY" #
}ZZ 
private\\ 
async\\ 
Task\\ 
SaveVendorAsync\\ &
(\\& '
)\\' (
{]] 
if^^ 

(^^ 
SelectedVendor^^ 
==^^ 
null^^ "
)^^" #
return^^$ *
;^^* +
SelectedVendor`` 
.`` 
UpdateDetails`` $
(``$ %
EditingName``% 0
,``0 1
EditingContact``2 @
,``@ A
EditingEmail``B N
,``N O
EditingPhone``P \
,``\ ]
EditingAddress``^ l
)``l m
;``m n
awaitaa 
_vendorRepositoryaa 
.aa  
UpdateAsyncaa  +
(aa+ ,
SelectedVendoraa, :
)aa: ;
;aa; <
vardd 
indexdd 
=dd 
Vendorsdd 
.dd 
IndexOfdd #
(dd# $
SelectedVendordd$ 2
)dd2 3
;dd3 4
ifee 

(ee 
indexee 
>=ee 
$numee 
)ee 
Vendorsee 
[ee  
indexee  %
]ee% &
=ee' (
SelectedVendoree) 7
;ee7 8
}ff 
privatehh 
asynchh 
Taskhh 
DeleteVendorAsynchh (
(hh( )
)hh) *
{ii 
ifjj 

(jj 
SelectedVendorjj 
==jj 
nulljj "
)jj" #
returnjj$ *
;jj* +
awaitkk 
_vendorRepositorykk 
.kk  
DeleteAsynckk  +
(kk+ ,
SelectedVendorkk, :
.kk: ;
Idkk; =
)kk= >
;kk> ?
Vendorsll 
.ll 
Removell 
(ll 
SelectedVendorll %
)ll% &
;ll& '
SelectedVendormm 
=mm 
nullmm 
;mm 
}nn 
}oo ž’
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\UserManagementViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
sealed

 
partial

 
class

 #
UserManagementViewModel

 3
:

4 5
ViewModelBase

6 C
{ 
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
private 
readonly 
IRoleRepository $
_roleRepository% 4
;4 5
private 
readonly 
ICommandHandler $
<$ %
CreateUserCommand% 6
,6 7
CreateUserResult8 H
>H I
_createHandlerJ X
;X Y
private 
readonly 
ICommandHandler $
<$ %
UpdateUserCommand% 6
,6 7
UpdateUserResult8 H
>H I
_updateHandlerJ X
;X Y
private 
readonly 
ICommandHandler $
<$ %
DeleteUserCommand% 6
,6 7
DeleteUserResult8 H
>H I
_deleteHandlerJ X
;X Y
public 
 
ObservableCollection 
<  
User  $
>$ %
Users& +
{, -
get. 1
;1 2
}3 4
=5 6
new7 :
(: ;
); <
;< =
public 
 
ObservableCollection 
<  
Role  $
>$ %
Roles& +
{, -
get. 1
;1 2
}3 4
=5 6
new7 :
(: ;
); <
;< =
private 
User 
? 
_selectedUser 
;  
public 

User 
? 
SelectedUser 
{ 
get 
=> 
_selectedUser 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_selectedUser  -
,- .
value/ 4
)4 5
)5 6
{ 
HydrateEditor 
( 
) 
;  
OnPropertyChanged !
(! "
nameof" (
(( )
HasSelection) 5
)5 6
)6 7
;7 8
} 
}   	
}!! 
public## 

bool## 
HasSelection## 
=>## 
SelectedUser##  ,
!=##- /
null##0 4
;##4 5
private&& 
string&& 

_firstName&& 
=&& 
$str&&  "
;&&" #
private'' 
string'' 
	_lastName'' 
='' 
$str'' !
;''! "
private(( 
string(( 
_pin(( 
=(( 
$str(( 
;(( 
private)) 
Role)) 
?)) 
_selectedRole)) 
;))  
private** 
bool** 
	_isActive** 
;** 
public,, 

string,, 
	FirstName,, 
{,, 
get,, !
=>,," $

_firstName,,% /
;,,/ 0
set,,1 4
=>,,5 7
SetProperty,,8 C
(,,C D
ref,,D G

_firstName,,H R
,,,R S
value,,T Y
),,Y Z
;,,Z [
},,\ ]
public-- 

string-- 
LastName-- 
{-- 
get--  
=>--! #
	_lastName--$ -
;--- .
set--/ 2
=>--3 5
SetProperty--6 A
(--A B
ref--B E
	_lastName--F O
,--O P
value--Q V
)--V W
;--W X
}--Y Z
public.. 

string.. 
Pin.. 
{.. 
get.. 
=>.. 
_pin.. #
;..# $
set..% (
=>..) +
SetProperty.., 7
(..7 8
ref..8 ;
_pin..< @
,..@ A
value..B G
)..G H
;..H I
}..J K
public00 

Role00 
?00 
SelectedRole00 
{11 
get22 
=>22 
_selectedRole22 
;22 
set33 
=>33 
SetProperty33 
(33 
ref33 
_selectedRole33 ,
,33, -
value33. 3
)333 4
;334 5
}44 
public66 

bool66 
IsActive66 
{66 
get66 
=>66 !
	_isActive66" +
;66+ ,
set66- 0
=>661 3
SetProperty664 ?
(66? @
ref66@ C
	_isActive66D M
,66M N
value66O T
)66T U
;66U V
}66W X
private88 
string88 
_statusMessage88 !
=88" #
$str88$ +
;88+ ,
public99 

string99 
StatusMessage99 
{99  !
get99" %
=>99& (
_statusMessage99) 7
;997 8
set999 <
=>99= ?
SetProperty99@ K
(99K L
ref99L O
_statusMessage99P ^
,99^ _
value99` e
)99e f
;99f g
}99h i
public;; 

ICommand;; 
LoadCommand;; 
{;;  !
get;;" %
;;;% &
};;' (
public<< 

ICommand<< 

AddCommand<< 
{<<  
get<<! $
;<<$ %
}<<& '
public== 

ICommand== 
SaveCommand== 
{==  !
get==" %
;==% &
}==' (
public>> 

ICommand>> 
DeleteCommand>> !
{>>" #
get>>$ '
;>>' (
}>>) *
public@@ 
#
UserManagementViewModel@@ "
(@@" #
IUserRepositoryAA 
userRepositoryAA &
,AA& '
IRoleRepositoryBB 
roleRepositoryBB &
,BB& '
ICommandHandlerCC 
<CC 
CreateUserCommandCC )
,CC) *
CreateUserResultCC+ ;
>CC; <
createHandlerCC= J
,CCJ K
ICommandHandlerDD 
<DD 
UpdateUserCommandDD )
,DD) *
UpdateUserResultDD+ ;
>DD; <
updateHandlerDD= J
,DDJ K
ICommandHandlerEE 
<EE 
DeleteUserCommandEE )
,EE) *
DeleteUserResultEE+ ;
>EE; <
deleteHandlerEE= J
)EEJ K
{FF 
TitleGG 
=GG 
$strGG !
;GG! "
_userRepositoryHH 
=HH 
userRepositoryHH (
;HH( )
_roleRepositoryII 
=II 
roleRepositoryII (
;II( )
_createHandlerJJ 
=JJ 
createHandlerJJ &
;JJ& '
_updateHandlerKK 
=KK 
updateHandlerKK &
;KK& '
_deleteHandlerLL 
=LL 
deleteHandlerLL &
;LL& '
LoadCommandNN 
=NN 
newNN 
AsyncRelayCommandNN +
(NN+ ,
	LoadAsyncNN, 5
)NN5 6
;NN6 7

AddCommandOO 
=OO 
newOO 
AsyncRelayCommandOO *
(OO* +
AddAsyncOO+ 3
)OO3 4
;OO4 5
SaveCommandPP 
=PP 
newPP 
AsyncRelayCommandPP +
(PP+ ,
	SaveAsyncPP, 5
)PP5 6
;PP6 7
DeleteCommandQQ 
=QQ 
newQQ 
AsyncRelayCommandQQ -
(QQ- .
DeleteAsyncQQ. 9
,QQ9 :
(QQ; <
)QQ< =
=>QQ> @
HasSelectionQQA M
)QQM N
;QQN O
}RR 
privateTT 
asyncTT 
TaskTT 
	LoadAsyncTT  
(TT  !
)TT! "
{UU 
IsBusyVV 
=VV 
trueVV 
;VV 
tryWW 
{XX 	
varYY 
usersYY 
=YY 
awaitYY 
_userRepositoryYY -
.YY- .
GetAllAsyncYY. 9
(YY9 :
)YY: ;
;YY; <
varZZ 
rolesZZ 
=ZZ 
awaitZZ 
_roleRepositoryZZ -
.ZZ- .
GetAllAsyncZZ. 9
(ZZ9 :
)ZZ: ;
;ZZ; <
Users\\ 
.\\ 
Clear\\ 
(\\ 
)\\ 
;\\ 
foreach]] 
(]] 
var]] 
u]] 
in]] 
users]] #
)]]# $
Users]]% *
.]]* +
Add]]+ .
(]]. /
u]]/ 0
)]]0 1
;]]1 2
Roles__ 
.__ 
Clear__ 
(__ 
)__ 
;__ 
foreach`` 
(`` 
var`` 
r`` 
in`` 
roles`` #
)``# $
Roles``% *
.``* +
Add``+ .
(``. /
r``/ 0
)``0 1
;``1 2
StatusMessagebb 
=bb 
$"bb 
$strbb %
{bb% &
Usersbb& +
.bb+ ,
Countbb, 1
}bb1 2
$strbb2 9
"bb9 :
;bb: ;
}cc 	
catchdd 
(dd 
	Exceptiondd 
exdd 
)dd 
{ee 	
StatusMessageff 
=ff 
$"ff 
$strff %
{ff% &
exff& (
.ff( )
Messageff) 0
}ff0 1
"ff1 2
;ff2 3
}gg 	
finallyhh 
{hh 
IsBusyhh 
=hh 
falsehh  
;hh  !
}hh" #
}ii 
privatekk 
voidkk 
HydrateEditorkk 
(kk 
)kk  
{ll 
ifmm 

(mm 
SelectedUsermm 
!=mm 
nullmm  
)mm  !
{nn 	
	FirstNameoo 
=oo 
SelectedUseroo $
.oo$ %
	FirstNameoo% .
;oo. /
LastNamepp 
=pp 
SelectedUserpp #
.pp# $
LastNamepp$ ,
;pp, -
Pinqq 
=qq 
$strqq 
;qq 
SelectedRolerr 
=rr 
Rolesrr  
.rr  !
FirstOrDefaultrr! /
(rr/ 0
rrr0 1
=>rr2 4
rrr5 6
.rr6 7
Idrr7 9
==rr: <
SelectedUserrr= I
.rrI J
RoleIdrrJ P
)rrP Q
;rrQ R
IsActivess 
=ss 
SelectedUserss #
.ss# $
IsActivess$ ,
;ss, -
StatusMessagett 
=tt 
$"tt 
$strtt &
{tt& '
SelectedUsertt' 3
.tt3 4
	FirstNamett4 =
}tt= >
"tt> ?
;tt? @
}uu 	
elsevv 
{ww 	
	FirstNamexx 
=xx 
$strxx 
;xx 
LastNameyy 
=yy 
$stryy 
;yy 
Pinzz 
=zz 
$strzz 
;zz 
SelectedRole{{ 
={{ 
Roles{{  
.{{  !
FirstOrDefault{{! /
({{/ 0
){{0 1
;{{1 2
IsActive|| 
=|| 
true|| 
;|| 
StatusMessage}} 
=}} 
$str}} #
;}}# $
}~~ 	
(
€€ 	
(
€€	 

AsyncRelayCommand
€€
 
)
€€ 
DeleteCommand
€€ )
)
€€) *
.
€€* +%
NotifyCanExecuteChanged
€€+ B
(
€€B C
)
€€C D
;
€€D E
}
 
private
ƒƒ 
async
ƒƒ 
Task
ƒƒ 
AddAsync
ƒƒ 
(
ƒƒ  
)
ƒƒ  !
{
„„ 
SelectedUser
…… 
=
…… 
null
…… 
;
…… 
StatusMessage
†† 
=
†† 
$str
†† D
;
††D E
}
‡‡ 
private
‰‰ 
async
‰‰ 
Task
‰‰ 
	SaveAsync
‰‰  
(
‰‰  !
)
‰‰! "
{
ŠŠ 
if
‹‹ 

(
‹‹ 
string
‹‹ 
.
‹‹  
IsNullOrWhiteSpace
‹‹ %
(
‹‹% &
	FirstName
‹‹& /
)
‹‹/ 0
)
‹‹0 1
{
ŒŒ 	
StatusMessage
 
=
 
$str
 5
;
5 6
return
ŽŽ 
;
ŽŽ 
}
 	
if
 

(
 
SelectedRole
 
==
 
null
  
)
  !
{
‘‘ 	
StatusMessage
’’ 
=
’’ 
$str
’’ /
;
’’/ 0
return
““ 
;
““ 
}
”” 	
IsBusy
–– 
=
–– 
true
–– 
;
–– 
try
—— 
{
˜˜ 	
if
™™ 
(
™™ 
SelectedUser
™™ 
==
™™ 
null
™™  $
)
™™$ %
{
šš 
var
œœ 
cmd
œœ 
=
œœ 
new
œœ 
CreateUserCommand
œœ /
{
 
	FirstName
žž 
=
žž 
	FirstName
žž  )
,
žž) *
LastName
ŸŸ 
=
ŸŸ 
LastName
ŸŸ '
,
ŸŸ' (
Pin
   
=
   
Pin
   
,
   
RoleId
¡¡ 
=
¡¡ 
SelectedRole
¡¡ )
.
¡¡) *
Id
¡¡* ,
,
¡¡, -
Username
¢¢ 
=
¢¢ 
	FirstName
¢¢ (
.
¢¢( )
ToLower
¢¢) 0
(
¢¢0 1
)
¢¢1 2
}
££ 
;
££ 
var
¥¥ 
result
¥¥ 
=
¥¥ 
await
¥¥ "
_createHandler
¥¥# 1
.
¥¥1 2
HandleAsync
¥¥2 =
(
¥¥= >
cmd
¥¥> A
)
¥¥A B
;
¥¥B C
if
¦¦ 
(
¦¦ 
result
¦¦ 
.
¦¦ 
	IsSuccess
¦¦ $
)
¦¦$ %
{
§§ 
StatusMessage
¨¨ !
=
¨¨" #
$str
¨¨$ 3
;
¨¨3 4
await
©© 
	LoadAsync
©© #
(
©©# $
)
©©$ %
;
©©% &
}
ªª 
else
«« 
{
¬¬ 
StatusMessage
­­ !
=
­­" #
$"
­­$ &
$str
­­& 5
{
­­5 6
result
­­6 <
.
­­< =
Message
­­= D
}
­­D E
"
­­E F
;
­­F G
}
®® 
}
¯¯ 
else
°° 
{
±± 
var
³³ 
cmd
³³ 
=
³³ 
new
³³ 
UpdateUserCommand
³³ /
{
´´ 
UserId
µµ 
=
µµ 
SelectedUser
µµ )
.
µµ) *
Id
µµ* ,
,
µµ, -
	FirstName
¶¶ 
=
¶¶ 
	FirstName
¶¶  )
,
¶¶) *
LastName
·· 
=
·· 
LastName
·· '
,
··' (
Pin
¸¸ 
=
¸¸ 
Pin
¸¸ 
,
¸¸ 
RoleId
¹¹ 
=
¹¹ 
SelectedRole
¹¹ )
.
¹¹) *
Id
¹¹* ,
,
¹¹, -
IsActive
ºº 
=
ºº 
IsActive
ºº '
}
»» 
;
»» 
var
½½ 
result
½½ 
=
½½ 
await
½½ "
_updateHandler
½½# 1
.
½½1 2
HandleAsync
½½2 =
(
½½= >
cmd
½½> A
)
½½A B
;
½½B C
if
¾¾ 
(
¾¾ 
result
¾¾ 
.
¾¾ 
	IsSuccess
¾¾ $
)
¾¾$ %
{
¿¿ 
StatusMessage
ÀÀ !
=
ÀÀ" #
$str
ÀÀ$ 3
;
ÀÀ3 4
await
ÁÁ 
	LoadAsync
ÁÁ #
(
ÁÁ# $
)
ÁÁ$ %
;
ÁÁ% &
}
ÂÂ 
else
ÃÃ 
{
ÄÄ 
StatusMessage
ÅÅ !
=
ÅÅ" #
$"
ÅÅ$ &
$str
ÅÅ& 5
{
ÅÅ5 6
result
ÅÅ6 <
.
ÅÅ< =
Message
ÅÅ= D
}
ÅÅD E
"
ÅÅE F
;
ÅÅF G
}
ÆÆ 
}
ÇÇ 
}
ÈÈ 	
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ 
{
ÊÊ 	
StatusMessage
ËË 
=
ËË 
$"
ËË 
$str
ËË %
{
ËË% &
ex
ËË& (
.
ËË( )
Message
ËË) 0
}
ËË0 1
"
ËË1 2
;
ËË2 3
}
ÌÌ 	
finally
ÍÍ 
{
ÍÍ 
IsBusy
ÍÍ 
=
ÍÍ 
false
ÍÍ  
;
ÍÍ  !
}
ÍÍ" #
}
ÎÎ 
private
ÐÐ 
async
ÐÐ 
Task
ÐÐ 
DeleteAsync
ÐÐ "
(
ÐÐ" #
)
ÐÐ# $
{
ÑÑ 
if
ÒÒ 

(
ÒÒ 
SelectedUser
ÒÒ 
==
ÒÒ 
null
ÒÒ  
)
ÒÒ  !
return
ÒÒ" (
;
ÒÒ( )
IsBusy
ÕÕ 
=
ÕÕ 
true
ÕÕ 
;
ÕÕ 
try
ÖÖ 
{
×× 	
var
ØØ 
result
ØØ 
=
ØØ 
await
ØØ 
_deleteHandler
ØØ -
.
ØØ- .
HandleAsync
ØØ. 9
(
ØØ9 :
new
ØØ: =
DeleteUserCommand
ØØ> O
{
ØØP Q
UserId
ØØR X
=
ØØY Z
SelectedUser
ØØ[ g
.
ØØg h
Id
ØØh j
}
ØØk l
)
ØØl m
;
ØØm n
if
ÙÙ 
(
ÙÙ 
result
ÙÙ 
.
ÙÙ 
	IsSuccess
ÙÙ  
)
ÙÙ  !
{
ÚÚ 
StatusMessage
ÛÛ 
=
ÛÛ 
$str
ÛÛ  /
;
ÛÛ/ 0
await
ÜÜ 
	LoadAsync
ÜÜ 
(
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
SelectedUser
ÝÝ 
=
ÝÝ 
null
ÝÝ #
;
ÝÝ# $
}
ÞÞ 
else
ßß 
{
àà 
StatusMessage
áá 
=
áá 
$"
áá  "
$str
áá" 1
{
áá1 2
result
áá2 8
.
áá8 9
Message
áá9 @
}
áá@ A
"
ááA B
;
ááB C
}
ââ 
}
ãã 	
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää 
{
åå 	
StatusMessage
ææ 
=
ææ 
$"
ææ 
$str
ææ %
{
ææ% &
ex
ææ& (
.
ææ( )
Message
ææ) 0
}
ææ0 1
"
ææ1 2
;
ææ2 3
}
çç 	
finally
èè 
{
èè 
IsBusy
èè 
=
èè 
false
èè  
;
èè  !
}
èè" #
}
éé 
}êê ß÷
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\TicketViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
sealed

 
class

 
TicketViewModel

 #
:

$ %
ViewModelBase

& 3
{ 
private 
readonly 
ICommandHandler $
<$ %
CreateTicketCommand% 8
,8 9
CreateTicketResult: L
>L M
_createTicketN [
;[ \
private 
readonly 
ICommandHandler $
<$ %
AddOrderLineCommand% 8
,8 9
AddOrderLineResult: L
>L M
_addOrderLineN [
;[ \
private 
readonly 
ICommandHandler $
<$ %!
PrintToKitchenCommand% :
,: ; 
PrintToKitchenResult< P
>P Q
_printToKitchenR a
;a b
private 
readonly 
IQueryHandler "
<" #
GetTicketQuery# 1
,1 2
	TicketDto3 <
?< =
>= >

_getTicket? I
;I J
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly 
Services 
. 
NavigationService /
_navigationService0 B
;B C
private 
	TicketDto 
? 
_ticket 
; 
private 
string 
_createdByText !
=" #
Guid$ (
.( )
Empty) .
.. /
ToString/ 7
(7 8
)8 9
;9 :
private 
string 
_terminalIdText "
=# $
Guid% )
.) *
Empty* /
./ 0
ToString0 8
(8 9
)9 :
;: ;
private 
string 
_shiftIdText 
=  !
Guid" &
.& '
Empty' ,
., -
ToString- 5
(5 6
)6 7
;7 8
private 
string 
_orderTypeIdText #
=$ %
Guid& *
.* +
Empty+ 0
.0 1
ToString1 9
(9 :
): ;
;; <
private 
string 
_ticketIdText  
=! "
string# )
.) *
Empty* /
;/ 0
private 
string 
_menuItemIdText "
=# $
Guid% )
.) *
Empty* /
./ 0
ToString0 8
(8 9
)9 :
;: ;
private 
string 
_menuItemName  
=! "
$str# .
;. /
private 
string 
_quantityText  
=! "
$str# &
;& '
private 
string 
_unitPriceText !
=" #
$str$ (
;( )
private 
string 
_taxRateText 
=  !
$str" %
;% &
private   
string   
?   
_error   
;   
public"" 

TicketViewModel"" 
("" 
ICommandHandler## 
<## 
CreateTicketCommand## +
,##+ ,
CreateTicketResult##- ?
>##? @
createTicket##A M
,##M N
ICommandHandler$$ 
<$$ 
AddOrderLineCommand$$ +
,$$+ ,
AddOrderLineResult$$- ?
>$$? @
addOrderLine$$A M
,$$M N
ICommandHandler%% 
<%% !
PrintToKitchenCommand%% -
,%%- . 
PrintToKitchenResult%%/ C
>%%C D
printToKitchen%%E S
,%%S T
IQueryHandler&& 
<&& 
GetTicketQuery&& $
,&&$ %
	TicketDto&&& /
?&&/ 0
>&&0 1
	getTicket&&2 ;
,&&; <
IMenuRepository'' 
menuRepository'' &
,''& '
Services(( 
.(( 
NavigationService(( "
navigationService((# 4
)((4 5
{)) 
_createTicket** 
=** 
createTicket** $
;**$ %
_addOrderLine++ 
=++ 
addOrderLine++ $
;++$ %
_printToKitchen,, 
=,, 
printToKitchen,, (
;,,( )

_getTicket-- 
=-- 
	getTicket-- 
;-- 
_menuRepository.. 
=.. 
menuRepository.. (
;..( )
_navigationService// 
=// 
navigationService// .
;//. /
Title11 
=11 
$str11 
;11 
CreateTicketCommand33 
=33 
new33 !
AsyncRelayCommand33" 3
(333 4
CreateTicketAsync334 E
)33E F
;33F G
LoadTicketCommand44 
=44 
new44 
AsyncRelayCommand44  1
(441 2
LoadTicketAsync442 A
)44A B
;44B C!
AddOrderLineUiCommand55 
=55 
new55  #
AsyncRelayCommand55$ 5
(555 6
AddOrderLineAsync556 G
)55G H
;55H I 
SendToKitchenCommand66 
=66 
new66 "
AsyncRelayCommand66# 4
(664 5
SendToKitchenAsync665 G
)66G H
;66H I 
SplitTicketUiCommand77 
=77 
new77 "
AsyncRelayCommand77# 4
(774 5
SplitTicketAsync775 E
)77E F
;77F G
MoveTableUiCommand88 
=88 
new88  
RelayCommand88! -
(88- .
	MoveTable88. 7
)887 8
;888 9
SettleUiCommand99 
=99 
new99 
RelayCommand99 *
(99* +
Settle99+ 1
)991 2
;992 3
}:: 
private<< 
void<< 
	MoveTable<< 
(<< 
)<< 
{== 
if>> 

(>> 
Ticket>> 
==>> 
null>> 
)>> 
{?? 	
Error@@ 
=@@ 
$str@@ /
;@@/ 0
returnAA 
;AA 
}BB 	
_navigationServiceDD 
.DD 
NavigateDD #
(DD# $
typeofDD$ *
(DD* +
MagideskDD+ 3
.DD3 4
PresentationDD4 @
.DD@ A
ViewsDDA F
.DDF G
TableMapPageDDG S
)DDS T
,DDT U
TicketDDV \
.DD\ ]
IdDD] _
)DD_ `
;DD` a
}EE 
publicGG 

	TicketDtoGG 
?GG 
TicketGG 
{HH 
getII 
=>II 
_ticketII 
;II 
privateJJ 
setJJ 
{KK 	
ifLL 
(LL 
SetPropertyLL 
(LL 
refLL 
_ticketLL  '
,LL' (
valueLL) .
)LL. /
)LL/ 0
{MM 
OnPropertyChangedNN !
(NN! "
nameofNN" (
(NN( )
	HasTicketNN) 2
)NN2 3
)NN3 4
;NN4 5
OnPropertyChangedOO !
(OO! "
nameofOO" (
(OO( )
TicketHeaderTextOO) 9
)OO9 :
)OO: ;
;OO; <
OnPropertyChangedPP !
(PP! "
nameofPP" (
(PP( )

TotalsTextPP) 3
)PP3 4
)PP4 5
;PP5 6
OnPropertyChangedQQ !
(QQ! "
nameofQQ" (
(QQ( )

OrderLinesQQ) 3
)QQ3 4
)QQ4 5
;QQ5 6
OnPropertyChangedRR !
(RR! "
nameofRR" (
(RR( )
HasUnsentItemsRR) 7
)RR7 8
)RR8 9
;RR9 :
}SS 
}TT 	
}UU 
publicWW 

boolWW 
	HasTicketWW 
=>WW 
TicketWW #
!=WW$ &
nullWW' +
;WW+ ,
publicYY 

boolYY 
HasUnsentItemsYY 
=>YY !
TicketYY" (
?YY( )
.YY) *

OrderLinesYY* 4
.YY4 5
AnyYY5 8
(YY8 9
olYY9 ;
=>YY< >
olYY? A
.YYA B 
ShouldPrintToKitchenYYB V
&&YYW Y
!YYZ [
olYY[ ]
.YY] ^
PrintedToKitchenYY^ n
)YYn o
??YYp r
falseYYs x
;YYx y
public[[ 

string[[ 
TicketHeaderText[[ "
=>[[# %
Ticket[[& ,
==[[- /
null[[0 4
?\\ 	
$str\\
 
:]] 	
$"]]
 
$str]] 
{]] 
Ticket]] 
.]] 
TicketNumber]] (
}]]( )
$str]]) +
{]]+ ,
Ticket]], 2
.]]2 3
Status]]3 9
}]]9 :
$str]]: A
{]]A B
Ticket]]B H
.]]H I
Id]]I K
}]]K L
"]]L M
;]]M N
public__ 

string__ 

TotalsText__ 
=>__ 
Ticket__  &
==__' )
null__* .
?`` 	
string``
 
.`` 
Empty`` 
:aa 	
$"aa
 
$straa 
{aa 
Ticketaa 
.aa 
SubtotalAmountaa ,
}aa, -
$straa- 4
{aa4 5
Ticketaa5 ;
.aa; <
	TaxAmountaa< E
}aaE F
$straaF O
{aaO P
TicketaaP V
.aaV W
TotalAmountaaW b
}aab c
$straac j
{aaj k
Ticketaak q
.aaq r
	DueAmountaar {
}aa{ |
"aa| }
;aa} ~
publiccc 

IReadOnlyListcc 
<cc 
OrderLineDtocc %
>cc% &

OrderLinescc' 1
=>cc2 4
Ticketcc5 ;
?cc; <
.cc< =

OrderLinescc= G
??ccH J
newccK N
ListccO S
<ccS T
OrderLineDtoccT `
>cc` a
(cca b
)ccb c
;ccc d
publicee 

stringee 
CreatedByTextee 
{ff 
getgg 
=>gg 
_createdByTextgg 
;gg 
sethh 
=>hh 
SetPropertyhh 
(hh 
refhh 
_createdByTexthh -
,hh- .
valuehh/ 4
)hh4 5
;hh5 6
}ii 
publickk 

stringkk 
TerminalIdTextkk  
{ll 
getmm 
=>mm 
_terminalIdTextmm 
;mm 
setnn 
=>nn 
SetPropertynn 
(nn 
refnn 
_terminalIdTextnn .
,nn. /
valuenn0 5
)nn5 6
;nn6 7
}oo 
publicqq 

stringqq 
ShiftIdTextqq 
{rr 
getss 
=>ss 
_shiftIdTextss 
;ss 
settt 
=>tt 
SetPropertytt 
(tt 
reftt 
_shiftIdTexttt +
,tt+ ,
valuett- 2
)tt2 3
;tt3 4
}uu 
publicww 

stringww 
OrderTypeIdTextww !
{xx 
getyy 
=>yy 
_orderTypeIdTextyy 
;yy  
setzz 
=>zz 
SetPropertyzz 
(zz 
refzz 
_orderTypeIdTextzz /
,zz/ 0
valuezz1 6
)zz6 7
;zz7 8
}{{ 
public}} 

string}} 
TicketIdText}} 
{~~ 
get 
=> 
_ticketIdText 
; 
set
€€ 
=>
€€ 
SetProperty
€€ 
(
€€ 
ref
€€ 
_ticketIdText
€€ ,
,
€€, -
value
€€. 3
)
€€3 4
;
€€4 5
}
 
public
ƒƒ 

string
ƒƒ 
MenuItemIdText
ƒƒ  
{
„„ 
get
…… 
=>
…… 
_menuItemIdText
…… 
;
…… 
set
†† 
=>
†† 
SetProperty
†† 
(
†† 
ref
†† 
_menuItemIdText
†† .
,
††. /
value
††0 5
)
††5 6
;
††6 7
}
‡‡ 
public
‰‰ 

string
‰‰ 
MenuItemName
‰‰ 
{
ŠŠ 
get
‹‹ 
=>
‹‹ 
_menuItemName
‹‹ 
;
‹‹ 
set
ŒŒ 
=>
ŒŒ 
SetProperty
ŒŒ 
(
ŒŒ 
ref
ŒŒ 
_menuItemName
ŒŒ ,
,
ŒŒ, -
value
ŒŒ. 3
)
ŒŒ3 4
;
ŒŒ4 5
}
 
public
 

string
 
QuantityText
 
{
 
get
‘‘ 
=>
‘‘ 
_quantityText
‘‘ 
;
‘‘ 
set
’’ 
=>
’’ 
SetProperty
’’ 
(
’’ 
ref
’’ 
_quantityText
’’ ,
,
’’, -
value
’’. 3
)
’’3 4
;
’’4 5
}
““ 
public
•• 

string
•• 
UnitPriceText
•• 
{
–– 
get
—— 
=>
—— 
_unitPriceText
—— 
;
—— 
set
˜˜ 
=>
˜˜ 
SetProperty
˜˜ 
(
˜˜ 
ref
˜˜ 
_unitPriceText
˜˜ -
,
˜˜- .
value
˜˜/ 4
)
˜˜4 5
;
˜˜5 6
}
™™ 
public
›› 

string
›› 
TaxRateText
›› 
{
œœ 
get
 
=>
 
_taxRateText
 
;
 
set
žž 
=>
žž 
SetProperty
žž 
(
žž 
ref
žž 
_taxRateText
žž +
,
žž+ ,
value
žž- 2
)
žž2 3
;
žž3 4
}
ŸŸ 
public
¡¡ 

string
¡¡ 
?
¡¡ 
Error
¡¡ 
{
¢¢ 
get
££ 
=>
££ 
_error
££ 
;
££ 
private
¤¤ 
set
¤¤ 
{
¥¥ 	
if
¦¦ 
(
¦¦ 
SetProperty
¦¦ 
(
¦¦ 
ref
¦¦ 
_error
¦¦  &
,
¦¦& '
value
¦¦( -
)
¦¦- .
)
¦¦. /
{
§§ 
OnPropertyChanged
¨¨ !
(
¨¨! "
nameof
¨¨" (
(
¨¨( )
HasError
¨¨) 1
)
¨¨1 2
)
¨¨2 3
;
¨¨3 4
}
©© 
}
ªª 	
}
«« 
public
­­ 

bool
­­ 
HasError
­­ 
=>
­­ 
!
­­ 
string
­­ #
.
­­# $ 
IsNullOrWhiteSpace
­­$ 6
(
­­6 7
Error
­­7 <
)
­­< =
;
­­= >
public
¯¯ 

AsyncRelayCommand
¯¯ !
CreateTicketCommand
¯¯ 0
{
¯¯1 2
get
¯¯3 6
;
¯¯6 7
}
¯¯8 9
public
°° 

AsyncRelayCommand
°° 
LoadTicketCommand
°° .
{
°°/ 0
get
°°1 4
;
°°4 5
}
°°6 7
public
±± 

AsyncRelayCommand
±± #
AddOrderLineUiCommand
±± 2
{
±±3 4
get
±±5 8
;
±±8 9
}
±±: ;
public
²² 

AsyncRelayCommand
²² "
SendToKitchenCommand
²² 1
{
²²2 3
get
²²4 7
;
²²7 8
}
²²9 :
public
³³ 

AsyncRelayCommand
³³ "
SplitTicketUiCommand
³³ 1
{
³³2 3
get
³³4 7
;
³³7 8
}
³³9 :
public
´´ 

RelayCommand
´´  
MoveTableUiCommand
´´ *
{
´´+ ,
get
´´- 0
;
´´0 1
}
´´2 3
public
µµ 

RelayCommand
µµ 
SettleUiCommand
µµ '
{
µµ( )
get
µµ* -
;
µµ- .
}
µµ/ 0
private
·· 
void
·· 
Settle
·· 
(
·· 
)
·· 
{
¸¸ 
if
¹¹ 

(
¹¹ 
Ticket
¹¹ 
==
¹¹ 
null
¹¹ 
)
¹¹ 
{
ºº 	
Error
»» 
=
»» 
$str
»» 1
;
»»1 2
return
¼¼ 
;
¼¼ 
}
½½ 	 
_navigationService
¿¿ 
.
¿¿ 
Navigate
¿¿ #
(
¿¿# $
typeof
¿¿$ *
(
¿¿* +
Magidesk
¿¿+ 3
.
¿¿3 4
Presentation
¿¿4 @
.
¿¿@ A
Views
¿¿A F
.
¿¿F G

SettlePage
¿¿G Q
)
¿¿Q R
,
¿¿R S
Ticket
¿¿T Z
.
¿¿Z [
Id
¿¿[ ]
)
¿¿] ^
;
¿¿^ _
}
ÀÀ 
private
ÂÂ 
async
ÂÂ 
Task
ÂÂ 
SplitTicketAsync
ÂÂ '
(
ÂÂ' (
)
ÂÂ( )
{
ÃÃ 
Error
ÄÄ 
=
ÄÄ 
null
ÄÄ 
;
ÄÄ 
if
ÅÅ 

(
ÅÅ 
Ticket
ÅÅ 
==
ÅÅ 
null
ÅÅ 
)
ÅÅ 
return
ÅÅ "
;
ÅÅ" #
IsBusy
ÇÇ 
=
ÇÇ 
true
ÇÇ 
;
ÇÇ 
try
ÈÈ 
{
ÉÉ 	
var
ÊÊ 
dialog
ÊÊ 
=
ÊÊ 
new
ÊÊ 
Magidesk
ÊÊ &
.
ÊÊ& '
Presentation
ÊÊ' 3
.
ÊÊ3 4
Views
ÊÊ4 9
.
ÊÊ9 :
SplitTicketDialog
ÊÊ: K
(
ÊÊK L
)
ÊÊL M
;
ÊÊM N
dialog
ËË 
.
ËË 
	ViewModel
ËË 
.
ËË 

Initialize
ËË (
(
ËË( )
Ticket
ËË) /
)
ËË/ 0
;
ËË0 1
var
ÌÌ 
result
ÌÌ 
=
ÌÌ 
await
ÌÌ  
_navigationService
ÌÌ  2
.
ÌÌ2 3
ShowDialogAsync
ÌÌ3 B
(
ÌÌB C
dialog
ÌÌC I
)
ÌÌI J
;
ÌÌJ K
if
ÎÎ 
(
ÎÎ 
result
ÎÎ 
==
ÎÎ 
	Microsoft
ÎÎ $
.
ÎÎ$ %
UI
ÎÎ% '
.
ÎÎ' (
Xaml
ÎÎ( ,
.
ÎÎ, -
Controls
ÎÎ- 5
.
ÎÎ5 6!
ContentDialogResult
ÎÎ6 I
.
ÎÎI J
Primary
ÎÎJ Q
)
ÎÎQ R
{
ÏÏ 
await
ÒÒ 
LoadTicketAsync
ÒÒ &
(
ÒÒ& '
)
ÒÒ' (
;
ÒÒ( )
}
ÓÓ 
}
ÔÔ 	
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ 
{
ÖÖ 	
Error
×× 
=
×× 
ex
×× 
.
×× 
Message
×× 
;
×× 
}
ØØ 	
finally
ÙÙ 
{
ÚÚ 	
IsBusy
ÛÛ 
=
ÛÛ 
false
ÛÛ 
;
ÛÛ 
}
ÜÜ 	
}
ÝÝ 
private
ßß 
async
ßß 
Task
ßß  
SendToKitchenAsync
ßß )
(
ßß) *
)
ßß* +
{
àà 
Error
áá 
=
áá 
null
áá 
;
áá 
IsBusy
ââ 
=
ââ 
true
ââ 
;
ââ 
try
ãã 
{
ää 	
if
åå 
(
åå 
Ticket
åå 
==
åå 
null
åå 
)
åå 
return
åå  &
;
åå& '
var
çç 
result
çç 
=
çç 
await
çç 
_printToKitchen
çç .
.
çç. /
HandleAsync
çç/ :
(
çç: ;
new
çç; >#
PrintToKitchenCommand
çç? T
{
èè 
TicketId
éé 
=
éé 
Ticket
éé  
.
éé  !
Id
éé! #
}
êê 
)
êê 
;
êê 
if
ìì 
(
ìì 
result
ìì 
.
ìì 
Success
ìì 
)
ìì 
{
íí 
await
îî 
LoadTicketAsync
îî $
(
îî$ %
)
îî% &
;
îî& '
}
ïï 
}
ðð 	
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ 
{
òò 	
Error
óó 
=
óó 
ex
óó 
.
óó 
Message
óó 
;
óó 
}
ôô 	
finally
õõ 
{
öö 	
IsBusy
÷÷ 
=
÷÷ 
false
÷÷ 
;
÷÷ 
}
øø 	
}
ùù 
private
ûû 
async
ûû 
Task
ûû 
CreateTicketAsync
ûû (
(
ûû( )
)
ûû) *
{
üü 
Error
ýý 
=
ýý 
null
ýý 
;
ýý 
IsBusy
þþ 
=
þþ 
true
þþ 
;
þþ 
try
ÿÿ 
{
€€ 	
if
 
(
 
!
 
Guid
 
.
 
TryParse
 
(
 
CreatedByText
 ,
,
, -
out
. 1
var
2 5
	createdBy
6 ?
)
? @
)
@ A
{
B C
Error
D I
=
J K
$str
L `
;
` a
return
b h
;
h i
}
j k
if
‚‚ 
(
‚‚ 
!
‚‚ 
Guid
‚‚ 
.
‚‚ 
TryParse
‚‚ 
(
‚‚ 
TerminalIdText
‚‚ -
,
‚‚- .
out
‚‚/ 2
var
‚‚3 6

terminalId
‚‚7 A
)
‚‚A B
)
‚‚B C
{
‚‚D E
Error
‚‚F K
=
‚‚L M
$str
‚‚N c
;
‚‚c d
return
‚‚e k
;
‚‚k l
}
‚‚m n
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
Guid
ƒƒ 
.
ƒƒ 
TryParse
ƒƒ 
(
ƒƒ 
ShiftIdText
ƒƒ *
,
ƒƒ* +
out
ƒƒ, /
var
ƒƒ0 3
shiftId
ƒƒ4 ;
)
ƒƒ; <
)
ƒƒ< =
{
ƒƒ> ?
Error
ƒƒ@ E
=
ƒƒF G
$str
ƒƒH Z
;
ƒƒZ [
return
ƒƒ\ b
;
ƒƒb c
}
ƒƒd e
if
„„ 
(
„„ 
!
„„ 
Guid
„„ 
.
„„ 
TryParse
„„ 
(
„„ 
OrderTypeIdText
„„ .
,
„„. /
out
„„0 3
var
„„4 7
orderTypeId
„„8 C
)
„„C D
)
„„D E
{
„„F G
Error
„„H M
=
„„N O
$str
„„P f
;
„„f g
return
„„h n
;
„„n o
}
„„p q
var
†† 
result
†† 
=
†† 
await
†† 
_createTicket
†† ,
.
††, -
HandleAsync
††- 8
(
††8 9
new
††9 <!
CreateTicketCommand
††= P
{
‡‡ 
	CreatedBy
ˆˆ 
=
ˆˆ 
new
ˆˆ 
UserId
ˆˆ  &
(
ˆˆ& '
	createdBy
ˆˆ' 0
)
ˆˆ0 1
,
ˆˆ1 2

TerminalId
‰‰ 
=
‰‰ 

terminalId
‰‰ '
,
‰‰' (
ShiftId
ŠŠ 
=
ŠŠ 
shiftId
ŠŠ !
,
ŠŠ! "
OrderTypeId
‹‹ 
=
‹‹ 
orderTypeId
‹‹ )
}
ŒŒ 
)
ŒŒ 
;
ŒŒ 
TicketIdText
ŽŽ 
=
ŽŽ 
result
ŽŽ !
.
ŽŽ! "
TicketId
ŽŽ" *
.
ŽŽ* +
ToString
ŽŽ+ 3
(
ŽŽ3 4
)
ŽŽ4 5
;
ŽŽ5 6
await
 
LoadTicketAsync
 !
(
! "
)
" #
;
# $
}
 	
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘ 
{
’’ 	
Error
““ 
=
““ 
ex
““ 
.
““ 
Message
““ 
;
““ 
}
”” 	
finally
•• 
{
–– 	
IsBusy
—— 
=
—— 
false
—— 
;
—— 
}
˜˜ 	
}
™™ 
private
›› 
async
›› 
Task
›› 
LoadTicketAsync
›› &
(
››& '
)
››' (
{
œœ 
Error
 
=
 
null
 
;
 
IsBusy
žž 
=
žž 
true
žž 
;
žž 
try
ŸŸ 
{
   	
if
¡¡ 
(
¡¡ 
!
¡¡ 
Guid
¡¡ 
.
¡¡ 
TryParse
¡¡ 
(
¡¡ 
TicketIdText
¡¡ +
,
¡¡+ ,
out
¡¡- 0
var
¡¡1 4
ticketId
¡¡5 =
)
¡¡= >
)
¡¡> ?
{
¡¡@ A
Error
¡¡B G
=
¡¡H I
$str
¡¡J ]
;
¡¡] ^
return
¡¡_ e
;
¡¡e f
}
¡¡g h
Ticket
££ 
=
££ 
await
££ 

_getTicket
££ %
.
££% &
HandleAsync
££& 1
(
££1 2
new
££2 5
GetTicketQuery
££6 D
{
££E F
TicketId
££G O
=
££P Q
ticketId
££R Z
}
££[ \
)
££\ ]
;
££] ^
if
¥¥ 
(
¥¥ 
Ticket
¥¥ 
==
¥¥ 
null
¥¥ 
)
¥¥ 
{
¦¦ 
Error
§§ 
=
§§ 
$str
§§ +
;
§§+ ,
}
¨¨ 
}
©© 	
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª 
{
«« 	
Error
¬¬ 
=
¬¬ 
ex
¬¬ 
.
¬¬ 
Message
¬¬ 
;
¬¬ 
}
­­ 	
finally
®® 
{
¯¯ 	
IsBusy
°° 
=
°° 
false
°° 
;
°° 
}
±± 	
}
²² 
private
´´ 
async
´´ 
Task
´´ 
AddOrderLineAsync
´´ (
(
´´( )
)
´´) *
{
µµ 
Error
¶¶ 
=
¶¶ 
null
¶¶ 
;
¶¶ 
IsBusy
·· 
=
·· 
true
·· 
;
·· 
try
¸¸ 
{
¹¹ 	
if
ºº 
(
ºº 
Ticket
ºº 
==
ºº 
null
ºº 
)
ºº 
{
ºº  !
Error
ºº" '
=
ºº( )
$str
ºº* J
;
ººJ K
return
ººL R
;
ººR S
}
ººT U
if
»» 
(
»» 
!
»» 
Guid
»» 
.
»» 
TryParse
»» 
(
»» 
MenuItemIdText
»» -
,
»»- .
out
»»/ 2
var
»»3 6

menuItemId
»»7 A
)
»»A B
)
»»B C
{
»»D E
Error
»»F K
=
»»L M
$str
»»N c
;
»»c d
return
»»e k
;
»»k l
}
»»m n
if
¼¼ 
(
¼¼ 
!
¼¼ 
decimal
¼¼ 
.
¼¼ 
TryParse
¼¼ !
(
¼¼! "
QuantityText
¼¼" .
,
¼¼. /
out
¼¼0 3
var
¼¼4 7
qty
¼¼8 ;
)
¼¼; <
)
¼¼< =
{
¼¼> ?
Error
¼¼@ E
=
¼¼F G
$str
¼¼H [
;
¼¼[ \
return
¼¼] c
;
¼¼c d
}
¼¼e f
if
½½ 
(
½½ 
!
½½ 
decimal
½½ 
.
½½ 
TryParse
½½ !
(
½½! "
UnitPriceText
½½" /
,
½½/ 0
out
½½1 4
var
½½5 8
	unitPrice
½½9 B
)
½½B C
)
½½C D
{
½½E F
Error
½½G L
=
½½M N
$str
½½O d
;
½½d e
return
½½f l
;
½½l m
}
½½n o
if
¾¾ 
(
¾¾ 
!
¾¾ 
decimal
¾¾ 
.
¾¾ 
TryParse
¾¾ !
(
¾¾! "
TaxRateText
¾¾" -
,
¾¾- .
out
¾¾/ 2
var
¾¾3 6
taxRate
¾¾7 >
)
¾¾> ?
)
¾¾? @
{
¾¾A B
Error
¾¾C H
=
¾¾I J
$str
¾¾K ^
;
¾¾^ _
return
¾¾` f
;
¾¾f g
}
¾¾h i
var
ÁÁ 
menuItem
ÁÁ 
=
ÁÁ 
await
ÁÁ  
_menuRepository
ÁÁ! 0
.
ÁÁ0 1
GetByIdAsync
ÁÁ1 =
(
ÁÁ= >

menuItemId
ÁÁ> H
)
ÁÁH I
;
ÁÁI J
if
ÂÂ 
(
ÂÂ 
menuItem
ÂÂ 
==
ÂÂ 
null
ÂÂ  
)
ÂÂ  !
{
ÂÂ" #
Error
ÂÂ$ )
=
ÂÂ* +
$str
ÂÂ, B
;
ÂÂB C
return
ÂÂD J
;
ÂÂJ K
}
ÂÂL M
List
ÄÄ 
<
ÄÄ 
Magidesk
ÄÄ 
.
ÄÄ 
Domain
ÄÄ  
.
ÄÄ  !
Entities
ÄÄ! )
.
ÄÄ) *
MenuModifier
ÄÄ* 6
>
ÄÄ6 7
selectedModifiers
ÄÄ8 I
=
ÄÄJ K
new
ÄÄL O
(
ÄÄO P
)
ÄÄP Q
;
ÄÄQ R
if
ÇÇ 
(
ÇÇ 
menuItem
ÇÇ 
.
ÇÇ 
ModifierGroups
ÇÇ '
.
ÇÇ' (
Any
ÇÇ( +
(
ÇÇ+ ,
mg
ÇÇ, .
=>
ÇÇ/ 1
mg
ÇÇ2 4
.
ÇÇ4 5
ModifierGroup
ÇÇ5 B
.
ÇÇB C
IsActive
ÇÇC K
)
ÇÇK L
)
ÇÇL M
{
ÈÈ 
var
ËË 
dialog
ËË 
=
ËË 
new
ËË !
Magidesk
ËË" *
.
ËË* +
Presentation
ËË+ 7
.
ËË7 8
Views
ËË8 =
.
ËË= >%
ModifierSelectionDialog
ËË> U
(
ËËU V
menuItem
ËËV ^
)
ËË^ _
;
ËË_ `
var
ÎÎ 
result
ÎÎ 
=
ÎÎ 
await
ÎÎ # 
_navigationService
ÎÎ$ 6
.
ÎÎ6 7
ShowDialogAsync
ÎÎ7 F
(
ÎÎF G
dialog
ÎÎG M
)
ÎÎM N
;
ÎÎN O
if
ÐÐ 
(
ÐÐ 
result
ÐÐ 
!=
ÐÐ 
	Microsoft
ÐÐ (
.
ÐÐ( )
UI
ÐÐ) +
.
ÐÐ+ ,
Xaml
ÐÐ, 0
.
ÐÐ0 1
Controls
ÐÐ1 9
.
ÐÐ9 :!
ContentDialogResult
ÐÐ: M
.
ÐÐM N
Primary
ÐÐN U
)
ÐÐU V
{
ÑÑ 
return
ÓÓ 
;
ÓÓ 
}
ÔÔ 
selectedModifiers
ÖÖ "
=
ÖÖ# $
dialog
ÖÖ% +
.
ÖÖ+ ,
	ViewModel
ÖÖ, 5
.
ÖÖ5 6"
GetSelectedModifiers
ÖÖ6 J
(
ÖÖJ K
)
ÖÖK L
;
ÖÖL M
}
×× 
await
ÙÙ 
_addOrderLine
ÙÙ 
.
ÙÙ  
HandleAsync
ÙÙ  +
(
ÙÙ+ ,
new
ÙÙ, /!
AddOrderLineCommand
ÙÙ0 C
{
ÚÚ 
TicketId
ÛÛ 
=
ÛÛ 
Ticket
ÛÛ !
.
ÛÛ! "
Id
ÛÛ" $
,
ÛÛ$ %

MenuItemId
ÜÜ 
=
ÜÜ 

menuItemId
ÜÜ '
,
ÜÜ' (
MenuItemName
ÝÝ 
=
ÝÝ 
MenuItemName
ÝÝ +
,
ÝÝ+ ,
Quantity
ÞÞ 
=
ÞÞ 
qty
ÞÞ 
,
ÞÞ 
	UnitPrice
ßß 
=
ßß 
new
ßß 
Money
ßß  %
(
ßß% &
	unitPrice
ßß& /
)
ßß/ 0
,
ßß0 1
TaxRate
àà 
=
àà 
taxRate
àà !
,
àà! "
	Modifiers
áá 
=
áá 
selectedModifiers
áá -
}
ââ 
)
ââ 
;
ââ 
await
ää 
LoadTicketAsync
ää !
(
ää! "
)
ää" #
;
ää# $
}
åå 	
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ 
{
çç 	
Error
èè 
=
èè 
ex
èè 
.
èè 
Message
èè 
;
èè 
}
éé 	
finally
êê 
{
ëë 	
IsBusy
ìì 
=
ìì 
false
ìì 
;
ìì 
}
íí 	
}
îî 
}ïï ¹Æ
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\TicketManagementViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
sealed

 
class

 %
TicketManagementViewModel

 -
:

. /
ViewModelBase

0 =
{ 
private 
readonly 
IQueryHandler "
<" #
GetOpenTicketsQuery# 6
,6 7
IEnumerable8 C
<C D
	TicketDtoD M
>M N
>N O
_getOpenTicketsP _
;_ `
private 
readonly 
ICommandHandler $
<$ %
VoidTicketCommand% 6
>6 7
_voidTicket8 C
;C D
private 
readonly 
ICommandHandler $
<$ %
RefundTicketCommand% 8
,8 9
RefundTicketResult: L
>L M
_refundTicketN [
;[ \
private 
readonly 
ICommandHandler $
<$ %
SplitTicketCommand% 7
,7 8
SplitTicketResult9 J
>J K
_splitTicketL X
;X Y
private 
List 
< 
	TicketDto 
> 
_openTickets (
=) *
new+ .
(. /
)/ 0
;0 1
private 
	TicketDto 
? 
_selectedTicket &
;& '
private 
string 
_voidedByText  
=! "
Guid# '
.' (
Empty( -
.- .
ToString. 6
(6 7
)7 8
;8 9
private 
string "
_refundProcessedByText )
=* +
Guid, 0
.0 1
Empty1 6
.6 7
ToString7 ?
(? @
)@ A
;A B
private 
string !
_refundTerminalIdText (
=) *
Guid+ /
./ 0
Empty0 5
.5 6
ToString6 >
(> ?
)? @
;@ A
private 
string 
? 
_refundReason !
;! "
private 
string 
_splitByText 
=  !
Guid" &
.& '
Empty' ,
., -
ToString- 5
(5 6
)6 7
;7 8
private 
string  
_splitTerminalIdText '
=( )
Guid* .
.. /
Empty/ 4
.4 5
ToString5 =
(= >
)> ?
;? @
private 
string 
_splitShiftIdText $
=% &
Guid' +
.+ ,
Empty, 1
.1 2
ToString2 :
(: ;
); <
;< =
private 
string !
_splitOrderTypeIdText (
=) *
Guid+ /
./ 0
Empty0 5
.5 6
ToString6 >
(> ?
)? @
;@ A
private 
string 
? 
_error 
; 
private   
string   
?   
_lastResult   
;    
public"" 
%
TicketManagementViewModel"" $
(""$ %
IQueryHandler## 
<## 
GetOpenTicketsQuery## )
,##) *
IEnumerable##+ 6
<##6 7
	TicketDto##7 @
>##@ A
>##A B
getOpenTickets##C Q
,##Q R
ICommandHandler$$ 
<$$ 
VoidTicketCommand$$ )
>$$) *

voidTicket$$+ 5
,$$5 6
ICommandHandler%% 
<%% 
RefundTicketCommand%% +
,%%+ ,
RefundTicketResult%%- ?
>%%? @
refundTicket%%A M
,%%M N
ICommandHandler&& 
<&& 
SplitTicketCommand&& *
,&&* +
SplitTicketResult&&, =
>&&= >
splitTicket&&? J
)&&J K
{'' 
_getOpenTickets(( 
=(( 
getOpenTickets(( (
;((( )
_voidTicket)) 
=)) 

voidTicket))  
;))  !
_refundTicket** 
=** 
refundTicket** $
;**$ %
_splitTicket++ 
=++ 
splitTicket++ "
;++" #
Title-- 
=-- 
$str-- #
;--# $
RefreshCommand// 
=// 
new// 
AsyncRelayCommand// .
(//. /
RefreshAsync/// ;
)//; <
;//< =
VoidSelectedCommand00 
=00 
new00 !
AsyncRelayCommand00" 3
(003 4
VoidSelectedAsync004 E
)00E F
;00F G!
RefundSelectedCommand11 
=11 
new11  #
AsyncRelayCommand11$ 5
(115 6
RefundSelectedAsync116 I
)11I J
;11J K 
SplitSelectedCommand22 
=22 
new22 "
AsyncRelayCommand22# 4
(224 5
SplitSelectedAsync225 G
)22G H
;22H I
}33 
public55 

IReadOnlyList55 
<55 
	TicketDto55 "
>55" #
OpenTickets55$ /
{66 
get77 
=>77 
_openTickets77 
;77 
private88 
set88 
=>88 
SetProperty88 "
(88" #
ref88# &
_openTickets88' 3
,883 4
value885 :
.88: ;
ToList88; A
(88A B
)88B C
)88C D
;88D E
}99 
public;; 

	TicketDto;; 
?;; 
SelectedTicket;; $
{<< 
get== 
=>== 
_selectedTicket== 
;== 
set>> 
{?? 	
if@@ 
(@@ 
SetProperty@@ 
(@@ 
ref@@ 
_selectedTicket@@  /
,@@/ 0
value@@1 6
)@@6 7
)@@7 8
{AA 
OnPropertyChangedBB !
(BB! "
nameofBB" (
(BB( )
SelectedSummaryTextBB) <
)BB< =
)BB= >
;BB> ?
}CC 
}DD 	
}EE 
publicGG 

stringGG 
SelectedSummaryTextGG %
=>GG& (
SelectedTicketGG) 7
==GG8 :
nullGG; ?
?HH 	
$strHH
 
:II 	
$"II
 
$strII 
{II 
SelectedTicketII #
.II# $
TicketNumberII$ 0
}II0 1
$strII1 3
{II3 4
SelectedTicketII4 B
.IIB C
StatusIIC I
}III J
$strIIJ M
"IIM N
+IIO P
$"JJ
 
$strJJ 
{JJ 
SelectedTicketJJ "
.JJ" #
TotalAmountJJ# .
}JJ. /
$strJJ/ 7
{JJ7 8
SelectedTicketJJ8 F
.JJF G

PaidAmountJJG Q
}JJQ R
$strJJR Y
{JJY Z
SelectedTicketJJZ h
.JJh i
	DueAmountJJi r
}JJr s
$strJJs u
"JJu v
+JJw x
$"KK
 
$strKK 
{KK 
SelectedTicketKK "
.KK" #

OrderLinesKK# -
.KK- .
CountKK. 3
}KK3 4
$strKK4 @
{KK@ A
SelectedTicketKKA O
.KKO P
PaymentsKKP X
.KKX Y
CountKKY ^
}KK^ _
"KK_ `
;KK` a
publicMM 

stringMM 
VoidedByTextMM 
{NN 
getOO 
=>OO 
_voidedByTextOO 
;OO 
setPP 
=>PP 
SetPropertyPP 
(PP 
refPP 
_voidedByTextPP ,
,PP, -
valuePP. 3
)PP3 4
;PP4 5
}QQ 
publicSS 

stringSS !
RefundProcessedByTextSS '
{TT 
getUU 
=>UU "
_refundProcessedByTextUU %
;UU% &
setVV 
=>VV 
SetPropertyVV 
(VV 
refVV "
_refundProcessedByTextVV 5
,VV5 6
valueVV7 <
)VV< =
;VV= >
}WW 
publicYY 

stringYY  
RefundTerminalIdTextYY &
{ZZ 
get[[ 
=>[[ !
_refundTerminalIdText[[ $
;[[$ %
set\\ 
=>\\ 
SetProperty\\ 
(\\ 
ref\\ !
_refundTerminalIdText\\ 4
,\\4 5
value\\6 ;
)\\; <
;\\< =
}]] 
public__ 

string__ 
?__ 
RefundReason__ 
{`` 
getaa 
=>aa 
_refundReasonaa 
;aa 
setbb 
=>bb 
SetPropertybb 
(bb 
refbb 
_refundReasonbb ,
,bb, -
valuebb. 3
)bb3 4
;bb4 5
}cc 
publicee 

stringee 
SplitByTextee 
{ff 
getgg 
=>gg 
_splitByTextgg 
;gg 
sethh 
=>hh 
SetPropertyhh 
(hh 
refhh 
_splitByTexthh +
,hh+ ,
valuehh- 2
)hh2 3
;hh3 4
}ii 
publickk 

stringkk 
SplitTerminalIdTextkk %
{ll 
getmm 
=>mm  
_splitTerminalIdTextmm #
;mm# $
setnn 
=>nn 
SetPropertynn 
(nn 
refnn  
_splitTerminalIdTextnn 3
,nn3 4
valuenn5 :
)nn: ;
;nn; <
}oo 
publicqq 

stringqq 
SplitShiftIdTextqq "
{rr 
getss 
=>ss 
_splitShiftIdTextss  
;ss  !
settt 
=>tt 
SetPropertytt 
(tt 
reftt 
_splitShiftIdTexttt 0
,tt0 1
valuett2 7
)tt7 8
;tt8 9
}uu 
publicww 

stringww  
SplitOrderTypeIdTextww &
{xx 
getyy 
=>yy !
_splitOrderTypeIdTextyy $
;yy$ %
setzz 
=>zz 
SetPropertyzz 
(zz 
refzz !
_splitOrderTypeIdTextzz 4
,zz4 5
valuezz6 ;
)zz; <
;zz< =
}{{ 
public}} 

string}} 
?}} 
Error}} 
{~~ 
get 
=> 
_error 
; 
private
€€ 
set
€€ 
{
 	
if
‚‚ 
(
‚‚ 
SetProperty
‚‚ 
(
‚‚ 
ref
‚‚ 
_error
‚‚  &
,
‚‚& '
value
‚‚( -
)
‚‚- .
)
‚‚. /
{
ƒƒ 
OnPropertyChanged
„„ !
(
„„! "
nameof
„„" (
(
„„( )
HasError
„„) 1
)
„„1 2
)
„„2 3
;
„„3 4
}
…… 
}
†† 	
}
‡‡ 
public
‰‰ 

bool
‰‰ 
HasError
‰‰ 
=>
‰‰ 
!
‰‰ 
string
‰‰ #
.
‰‰# $ 
IsNullOrWhiteSpace
‰‰$ 6
(
‰‰6 7
Error
‰‰7 <
)
‰‰< =
;
‰‰= >
public
‹‹ 

string
‹‹ 
?
‹‹ 

LastResult
‹‹ 
{
ŒŒ 
get
 
=>
 
_lastResult
 
;
 
private
ŽŽ 
set
ŽŽ 
=>
ŽŽ 
SetProperty
ŽŽ "
(
ŽŽ" #
ref
ŽŽ# &
_lastResult
ŽŽ' 2
,
ŽŽ2 3
value
ŽŽ4 9
)
ŽŽ9 :
;
ŽŽ: ;
}
 
public
‘‘ 

AsyncRelayCommand
‘‘ 
RefreshCommand
‘‘ +
{
‘‘, -
get
‘‘. 1
;
‘‘1 2
}
‘‘3 4
public
’’ 

AsyncRelayCommand
’’ !
VoidSelectedCommand
’’ 0
{
’’1 2
get
’’3 6
;
’’6 7
}
’’8 9
public
““ 

AsyncRelayCommand
““ #
RefundSelectedCommand
““ 2
{
““3 4
get
““5 8
;
““8 9
}
““: ;
public
”” 

AsyncRelayCommand
”” "
SplitSelectedCommand
”” 1
{
””2 3
get
””4 7
;
””7 8
}
””9 :
public
–– 

async
–– 
Task
–– 
RefreshAsync
–– "
(
––" #
)
––# $
{
—— 
Error
˜˜ 
=
˜˜ 
null
˜˜ 
;
˜˜ 

LastResult
™™ 
=
™™ 
null
™™ 
;
™™ 
IsBusy
šš 
=
šš 
true
šš 
;
šš 
try
œœ 
{
 	
var
žž 
tickets
žž 
=
žž 
await
žž 
_getOpenTickets
žž  /
.
žž/ 0
HandleAsync
žž0 ;
(
žž; <
new
žž< ?!
GetOpenTicketsQuery
žž@ S
(
žžS T
)
žžT U
)
žžU V
;
žžV W
OpenTickets
ŸŸ 
=
ŸŸ 
tickets
ŸŸ !
.
ŸŸ! "
ToList
ŸŸ" (
(
ŸŸ( )
)
ŸŸ) *
;
ŸŸ* +
if
¡¡ 
(
¡¡ 
SelectedTicket
¡¡ 
!=
¡¡ !
null
¡¡" &
)
¡¡& '
{
¢¢ 
SelectedTicket
££ 
=
££  
OpenTickets
££! ,
.
££, -
FirstOrDefault
££- ;
(
££; <
t
££< =
=>
££> @
t
££A B
.
££B C
Id
££C E
==
££F H
SelectedTicket
££I W
.
££W X
Id
££X Z
)
££Z [
;
££[ \
}
¤¤ 
}
¥¥ 	
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦ 
{
§§ 	
Error
¨¨ 
=
¨¨ 
ex
¨¨ 
.
¨¨ 
Message
¨¨ 
;
¨¨ 
}
©© 	
finally
ªª 
{
«« 	
IsBusy
¬¬ 
=
¬¬ 
false
¬¬ 
;
¬¬ 
}
­­ 	
}
®® 
private
°° 
async
°° 
Task
°° 
VoidSelectedAsync
°° (
(
°°( )
)
°°) *
{
±± 
Error
²² 
=
²² 
null
²² 
;
²² 

LastResult
³³ 
=
³³ 
null
³³ 
;
³³ 
IsBusy
´´ 
=
´´ 
true
´´ 
;
´´ 
try
¶¶ 
{
·· 	
if
¸¸ 
(
¸¸ 
SelectedTicket
¸¸ 
==
¸¸ !
null
¸¸" &
)
¸¸& '
{
¸¸( )
Error
¸¸* /
=
¸¸0 1
$str
¸¸2 J
;
¸¸J K
return
¸¸L R
;
¸¸R S
}
¸¸T U
if
¹¹ 
(
¹¹ 
!
¹¹ 
Guid
¹¹ 
.
¹¹ 
TryParse
¹¹ 
(
¹¹ 
VoidedByText
¹¹ +
,
¹¹+ ,
out
¹¹- 0
var
¹¹1 4
voidedBy
¹¹5 =
)
¹¹= >
)
¹¹> ?
{
¹¹@ A
Error
¹¹B G
=
¹¹H I
$str
¹¹J ]
;
¹¹] ^
return
¹¹_ e
;
¹¹e f
}
¹¹g h
await
»» 
_voidTicket
»» 
.
»» 
HandleAsync
»» )
(
»») *
new
»»* -
VoidTicketCommand
»». ?
{
¼¼ 
TicketId
½½ 
=
½½ 
SelectedTicket
½½ )
.
½½) *
Id
½½* ,
,
½½, -
VoidedBy
¾¾ 
=
¾¾ 
new
¾¾ 
UserId
¾¾ %
(
¾¾% &
voidedBy
¾¾& .
)
¾¾. /
}
¿¿ 
)
¿¿ 
;
¿¿ 

LastResult
ÁÁ 
=
ÁÁ 
$"
ÁÁ 
$str
ÁÁ *
{
ÁÁ* +
SelectedTicket
ÁÁ+ 9
.
ÁÁ9 :
TicketNumber
ÁÁ: F
}
ÁÁF G
$str
ÁÁG H
"
ÁÁH I
;
ÁÁI J
await
ÂÂ 
RefreshAsync
ÂÂ 
(
ÂÂ 
)
ÂÂ  
;
ÂÂ  !
}
ÃÃ 	
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ 
{
ÅÅ 	
Error
ÆÆ 
=
ÆÆ 
ex
ÆÆ 
.
ÆÆ 
Message
ÆÆ 
;
ÆÆ 
}
ÇÇ 	
finally
ÈÈ 
{
ÉÉ 	
IsBusy
ÊÊ 
=
ÊÊ 
false
ÊÊ 
;
ÊÊ 
}
ËË 	
}
ÌÌ 
private
ÎÎ 
async
ÎÎ 
Task
ÎÎ !
RefundSelectedAsync
ÎÎ *
(
ÎÎ* +
)
ÎÎ+ ,
{
ÏÏ 
Error
ÐÐ 
=
ÐÐ 
null
ÐÐ 
;
ÐÐ 

LastResult
ÑÑ 
=
ÑÑ 
null
ÑÑ 
;
ÑÑ 
IsBusy
ÒÒ 
=
ÒÒ 
true
ÒÒ 
;
ÒÒ 
try
ÔÔ 
{
ÕÕ 	
if
ÖÖ 
(
ÖÖ 
SelectedTicket
ÖÖ 
==
ÖÖ !
null
ÖÖ" &
)
ÖÖ& '
{
ÖÖ( )
Error
ÖÖ* /
=
ÖÖ0 1
$str
ÖÖ2 J
;
ÖÖJ K
return
ÖÖL R
;
ÖÖR S
}
ÖÖT U
if
×× 
(
×× 
!
×× 
Guid
×× 
.
×× 
TryParse
×× 
(
×× #
RefundProcessedByText
×× 4
,
××4 5
out
××6 9
var
××: =
processedBy
××> I
)
××I J
)
××J K
{
××L M
Error
××N S
=
××T U
$str
××V l
;
××l m
return
××n t
;
××t u
}
××v w
if
ØØ 
(
ØØ 
!
ØØ 
Guid
ØØ 
.
ØØ 
TryParse
ØØ 
(
ØØ "
RefundTerminalIdText
ØØ 3
,
ØØ3 4
out
ØØ5 8
var
ØØ9 <

terminalId
ØØ= G
)
ØØG H
)
ØØH I
{
ØØJ K
Error
ØØL Q
=
ØØR S
$str
ØØT i
;
ØØi j
return
ØØk q
;
ØØq r
}
ØØs t
var
ÚÚ 
result
ÚÚ 
=
ÚÚ 
await
ÚÚ 
_refundTicket
ÚÚ ,
.
ÚÚ, -
HandleAsync
ÚÚ- 8
(
ÚÚ8 9
new
ÚÚ9 <!
RefundTicketCommand
ÚÚ= P
{
ÛÛ 
TicketId
ÜÜ 
=
ÜÜ 
SelectedTicket
ÜÜ )
.
ÜÜ) *
Id
ÜÜ* ,
,
ÜÜ, -
ProcessedBy
ÝÝ 
=
ÝÝ 
new
ÝÝ !
UserId
ÝÝ" (
(
ÝÝ( )
processedBy
ÝÝ) 4
)
ÝÝ4 5
,
ÝÝ5 6

TerminalId
ÞÞ 
=
ÞÞ 

terminalId
ÞÞ '
,
ÞÞ' (
Reason
ßß 
=
ßß 
RefundReason
ßß %
}
àà 
)
àà 
;
àà 
if
ââ 
(
ââ 
!
ââ 
result
ââ 
.
ââ 
Success
ââ 
)
ââ  
{
ãã 
Error
ää 
=
ää 
result
ää 
.
ää 
ErrorMessage
ää +
??
ää, .
$str
ää/ ?
;
ää? @
return
åå 
;
åå 
}
ææ 

LastResult
èè 
=
èè 
$"
èè 
$str
èè ,
{
èè, -
SelectedTicket
èè- ;
.
èè; <
TicketNumber
èè< H
}
èèH I
$str
èèI \
{
èè\ ]
result
èè] c
.
èèc d#
RefundPaymentsCreated
èèd y
}
èèy z
$str
èèz {
"
èè{ |
;
èè| }
await
éé 
RefreshAsync
éé 
(
éé 
)
éé  
;
éé  !
}
êê 	
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë 
{
ìì 	
Error
íí 
=
íí 
ex
íí 
.
íí 
Message
íí 
;
íí 
}
îî 	
finally
ïï 
{
ðð 	
IsBusy
ññ 
=
ññ 
false
ññ 
;
ññ 
}
òò 	
}
óó 
private
õõ 
async
õõ 
Task
õõ  
SplitSelectedAsync
õõ )
(
õõ) *
)
õõ* +
{
öö 
Error
÷÷ 
=
÷÷ 
null
÷÷ 
;
÷÷ 

LastResult
øø 
=
øø 
null
øø 
;
øø 
IsBusy
ùù 
=
ùù 
true
ùù 
;
ùù 
try
ûû 
{
üü 	
if
ýý 
(
ýý 
SelectedTicket
ýý 
==
ýý !
null
ýý" &
)
ýý& '
{
ýý( )
Error
ýý* /
=
ýý0 1
$str
ýý2 J
;
ýýJ K
return
ýýL R
;
ýýR S
}
ýýT U
if
þþ 
(
þþ 
!
þþ 
Guid
þþ 
.
þþ 
TryParse
þþ 
(
þþ 
SplitByText
þþ *
,
þþ* +
out
þþ, /
var
þþ0 3
splitBy
þþ4 ;
)
þþ; <
)
þþ< =
{
þþ> ?
Error
þþ@ E
=
þþF G
$str
þþH Z
;
þþZ [
return
þþ\ b
;
þþb c
}
þþd e
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 
Guid
ÿÿ 
.
ÿÿ 
TryParse
ÿÿ 
(
ÿÿ !
SplitTerminalIdText
ÿÿ 2
,
ÿÿ2 3
out
ÿÿ4 7
var
ÿÿ8 ;

terminalId
ÿÿ< F
)
ÿÿF G
)
ÿÿG H
{
ÿÿI J
Error
ÿÿK P
=
ÿÿQ R
$str
ÿÿS h
;
ÿÿh i
return
ÿÿj p
;
ÿÿp q
}
ÿÿr s
if
€€ 
(
€€ 
!
€€ 
Guid
€€ 
.
€€ 
TryParse
€€ 
(
€€ 
SplitShiftIdText
€€ /
,
€€/ 0
out
€€1 4
var
€€5 8
shiftId
€€9 @
)
€€@ A
)
€€A B
{
€€C D
Error
€€E J
=
€€K L
$str
€€M _
;
€€_ `
return
€€a g
;
€€g h
}
€€i j
if
 
(
 
!
 
Guid
 
.
 
TryParse
 
(
 "
SplitOrderTypeIdText
 3
,
3 4
out
5 8
var
9 <
orderTypeId
= H
)
H I
)
I J
{
K L
Error
M R
=
S T
$str
U k
;
k l
return
m s
;
s t
}
u v
var
„„ 

lineToMove
„„ 
=
„„ 
SelectedTicket
„„ +
.
„„+ ,

OrderLines
„„, 6
.
„„6 7
FirstOrDefault
„„7 E
(
„„E F
)
„„F G
;
„„G H
if
…… 
(
…… 

lineToMove
…… 
==
…… 
null
…… "
)
……" #
{
……$ %
Error
……& +
=
……, -
$str
……. S
;
……S T
return
……U [
;
……[ \
}
……] ^
var
‡‡ 
result
‡‡ 
=
‡‡ 
await
‡‡ 
_splitTicket
‡‡ +
.
‡‡+ ,
HandleAsync
‡‡, 7
(
‡‡7 8
new
‡‡8 ; 
SplitTicketCommand
‡‡< N
{
ˆˆ 
OriginalTicketId
‰‰  
=
‰‰! "
SelectedTicket
‰‰# 1
.
‰‰1 2
Id
‰‰2 4
,
‰‰4 5
SplitBy
ŠŠ 
=
ŠŠ 
new
ŠŠ 
UserId
ŠŠ $
(
ŠŠ$ %
splitBy
ŠŠ% ,
)
ŠŠ, -
,
ŠŠ- .

TerminalId
‹‹ 
=
‹‹ 

terminalId
‹‹ '
,
‹‹' (
ShiftId
ŒŒ 
=
ŒŒ 
shiftId
ŒŒ !
,
ŒŒ! "
OrderTypeId
 
=
 
orderTypeId
 )
,
) *!
OrderLineIdsToSplit
ŽŽ #
=
ŽŽ$ %
new
ŽŽ& )
List
ŽŽ* .
<
ŽŽ. /
Guid
ŽŽ/ 3
>
ŽŽ3 4
{
ŽŽ5 6

lineToMove
ŽŽ7 A
.
ŽŽA B
Id
ŽŽB D
}
ŽŽE F
}
 
)
 
;
 
if
‘‘ 
(
‘‘ 
!
‘‘ 
result
‘‘ 
.
‘‘ 
Success
‘‘ 
)
‘‘  
{
’’ 
Error
““ 
=
““ 
result
““ 
.
““ 
ErrorMessage
““ +
??
““, .
$str
““/ >
;
““> ?
return
”” 
;
”” 
}
•• 

LastResult
—— 
=
—— 
$"
—— 
$str
—— 1
{
——1 2
result
——2 8
.
——8 9
NewTicketNumber
——9 H
}
——H I
$str
——I X
{
——X Y
result
——Y _
.
——_ `
OrderLinesMoved
——` o
}
——o p
$str
——p q
"
——q r
;
——r s
await
˜˜ 
RefreshAsync
˜˜ 
(
˜˜ 
)
˜˜  
;
˜˜  !
}
™™ 	
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš 
{
›› 	
Error
œœ 
=
œœ 
ex
œœ 
.
œœ 
Message
œœ 
;
œœ 
}
 	
finally
žž 
{
ŸŸ 	
IsBusy
   
=
   
false
   
;
   
}
¡¡ 	
}
¢¢ 
}££ Ž!
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\TicketFeeViewModel.cs
	namespace 	
Magidesk
 
. 

ViewModels 
; 
public 
enum 
TicketFeeType 
{		 
ServiceCharge

 
,

 
DeliveryCharge 
, 

Adjustment 
} 
public 
partial 
class 
TicketFeeViewModel '
:( )
ObservableObject* :
{ 
private 
TicketFeeType 
_selectedFeeType *
;* +
public 

TicketFeeType 
SelectedFeeType (
{ 
get 
=> 
_selectedFeeType 
;  
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_selectedFeeType  0
,0 1
value2 7
)7 8
)8 9
{ 
OnPropertyChanged !
(! "
nameof" (
(( )
IsReasonVisible) 8
)8 9
)9 :
;: ;
} 
} 	
} 
private 
decimal 
_amount 
; 
public 

decimal 
Amount 
{   
get!! 
=>!! 
_amount!! 
;!! 
set"" 
=>"" 
SetProperty"" 
("" 
ref"" 
_amount"" &
,""& '
value""( -
)""- .
;"". /
}## 
private%% 
string%% 
_reason%% 
=%% 
string%% #
.%%# $
Empty%%$ )
;%%) *
public&& 

string&& 
Reason&& 
{'' 
get(( 
=>(( 
_reason(( 
;(( 
set)) 
=>)) 
SetProperty)) 
()) 
ref)) 
_reason)) &
,))& '
value))( -
)))- .
;)). /
}** 
public,, 
 
ObservableCollection,, 
<,,  
TicketFeeType,,  -
>,,- .
FeeTypes,,/ 7
{,,8 9
get,,: =
;,,= >
},,? @
=,,A B
new,,C F
(,,F G
Enum,,G K
.,,K L
	GetValues,,L U
<,,U V
TicketFeeType,,V c
>,,c d
(,,d e
),,e f
),,f g
;,,g h
public.. 

bool.. 
IsReasonVisible.. 
=>..  "
SelectedFeeType..# 2
==..3 5
TicketFeeType..6 C
...C D

Adjustment..D N
;..N O
[00 
ObservableProperty00 
]00 
private11 
bool11 
_isConfirmed11 
;11 
public33 

Action33 
?33 
CloseAction33 
{33  
get33! $
;33$ %
set33& )
;33) *
}33+ ,
public44 

Action44 
?44 
CancelAction44 
{44  !
get44" %
;44% &
set44' *
;44* +
}44, -
public66 

TicketFeeViewModel66 
(66 
)66 
{77 
SelectedFeeType88 
=88 
TicketFeeType88 '
.88' (
ServiceCharge88( 5
;885 6
}99 
[;; 
RelayCommand;; 
];; 
private<< 
void<< 
Confirm<< 
(<< 
)<< 
{== 
IsConfirmed>> 
=>> 
true>> 
;>> 
CloseAction?? 
??? 
.?? 
Invoke?? 
(?? 
)?? 
;?? 
}@@ 
[BB 
RelayCommandBB 
]BB 
privateCC 
voidCC 
CancelCC 
(CC 
)CC 
{DD 
IsConfirmedEE 
=EE 
falseEE 
;EE 
CancelActionFF 
?FF 
.FF 
InvokeFF 
(FF 
)FF 
;FF 
}GG 
}HH ð£
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\TemplateEditorViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class #
TemplateEditorViewModel $
:% &
ViewModelBase' 4
{ 
private 
readonly $
IPrintTemplateRepository -
_repository. 9
;9 :
private 
readonly .
"IRestaurantConfigurationRepository 7
_configRepo8 C
;C D
private 
readonly 
ITemplateEngine $
_engine% ,
;, -
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
Guid 
? 
_templateId 
; 
private 
string 
_name 
= 
string !
.! "
Empty" '
;' (
private 
string 
_content 
= 
string $
.$ %
Empty% *
;* +
private 
TemplateType 
_type 
=  
TemplateType! -
.- .
Receipt. 5
;5 6
private 
bool 
	_isSystem 
; 
public 

string 
Name 
{ 
get 
=> 
_name 
; 
set 
=> 
SetProperty 
( 
ref 
_name $
,$ %
value& +
)+ ,
;, -
} 
public   

string   
Content   
{!! 
get"" 
=>"" 
_content"" 
;"" 
set## 
=>## 
SetProperty## 
(## 
ref## 
_content## '
,##' (
value##) .
)##. /
;##/ 0
}$$ 
public&& 

TemplateType&& 
Type&& 
{'' 
get(( 
=>(( 
_type(( 
;(( 
set)) 
=>)) 
SetProperty)) 
()) 
ref)) 
_type)) $
,))$ %
value))& +
)))+ ,
;)), -
}** 
public,, 

bool,, 
IsSystem,, 
{-- 
get.. 
=>.. 
	_isSystem.. 
;.. 
set// 
=>// 
SetProperty// 
(// 
ref// 
	_isSystem// (
,//( )
value//* /
)/// 0
;//0 1
}00 
public22 

System22 
.22 
Collections22 
.22 
Generic22 %
.22% &
List22& *
<22* +
TemplateType22+ 7
>227 8
Types229 >
{22? @
get22A D
;22D E
}22F G
=22H I
Enum22J N
.22N O
	GetValues22O X
<22X Y
TemplateType22Y e
>22e f
(22f g
)22g h
.22h i
ToList22i o
(22o p
)22p q
;22q r
public44 

ICommand44 
RequestSaveCommand44 &
{44' (
get44) ,
;44, -
}44. /
public55 

ICommand55 
CancelCommand55 !
{55" #
get55$ '
;55' (
}55) *
public66 

ICommand66 !
RefreshPreviewCommand66 )
{66* +
get66, /
;66/ 0
}661 2
public88 
#
TemplateEditorViewModel88 "
(88" #$
IPrintTemplateRepository99  

repository99! +
,99+ ,.
"IRestaurantConfigurationRepository:: *

configRepo::+ 5
,::5 6
ITemplateEngine;; 
engine;; 
,;; 
NavigationService<< 
navigationService<< +
)<<+ ,
{== 
_repository>> 
=>> 

repository>>  
;>>  !
_configRepo?? 
=?? 

configRepo??  
;??  !
_engine@@ 
=@@ 
engine@@ 
;@@ 
_navigationServiceAA 
=AA 
navigationServiceAA .
;AA. /
TitleCC 
=CC 
$strCC 
;CC  
RequestSaveCommandEE 
=EE 
newEE  
AsyncRelayCommandEE! 2
(EE2 3
	SaveAsyncEE3 <
)EE< =
;EE= >
CancelCommandFF 
=FF 
newFF 
RelayCommandFF (
(FF( )
CancelFF) /
)FF/ 0
;FF0 1!
RefreshPreviewCommandGG 
=GG 
newGG  #
AsyncRelayCommandGG$ 5
(GG5 6
UpdatePreviewAsyncGG6 H
)GGH I
;GGI J
}HH 
publicJJ 

asyncJJ 
TaskJJ 
InitializeAsyncJJ %
(JJ% &
GuidJJ& *
?JJ* +
idJJ, .
)JJ. /
{KK 
tryLL 
{MM 	
_templateIdNN 
=NN 
idNN 
;NN 
ifOO 
(OO 
idOO 
.OO 
HasValueOO 
)OO 
{PP 
varQQ 
templateQQ 
=QQ 
awaitQQ $
_repositoryQQ% 0
.QQ0 1
GetByIdAsyncQQ1 =
(QQ= >
idQQ> @
.QQ@ A
ValueQQA F
)QQF G
;QQG H
ifRR 
(RR 
templateRR 
!=RR 
nullRR  $
)RR$ %
{SS 
NameTT 
=TT 
templateTT #
.TT# $
NameTT$ (
;TT( )
ContentUU 
=UU 
templateUU &
.UU& '
ContentUU' .
;UU. /
TypeVV 
=VV 
templateVV #
.VV# $
TypeVV$ (
;VV( )
IsSystemWW 
=WW 
templateWW '
.WW' (
IsSystemWW( 0
;WW0 1
TitleXX 
=XX 
$"XX 
$strXX $
{XX$ %
NameXX% )
}XX) *
"XX* +
;XX+ ,
}YY 
}ZZ 
else[[ 
{\\ 
Name^^ 
=^^ 
$str^^ %
;^^% &
Content__ 
=__ 
$str__ J
;__J K
Type`` 
=`` 
TemplateType`` #
.``# $
Receipt``$ +
;``+ ,
IsSystemaa 
=aa 
falseaa  
;aa  !
Titlebb 
=bb 
$strbb &
;bb& '
}cc 
awaitff 
UpdatePreviewAsyncff $
(ff$ %
)ff% &
;ff& '
}gg 	
catchhh 
(hh 
	Exceptionhh 
exhh 
)hh 
{ii 	
StatusMessagejj 
=jj 
$"jj 
$strjj 4
{jj4 5
exjj5 7
.jj7 8
Messagejj8 ?
}jj? @
"jj@ A
;jjA B
awaitkk 
_navigationServicekk $
.kk$ %
ShowErrorAsynckk% 3
(kk3 4
$strkk4 K
,kkK L
exkkM O
.kkO P
MessagekkP W
)kkW X
;kkX Y
}ll 	
}mm 
privateoo 
asyncoo 
Taskoo 
	SaveAsyncoo  
(oo  !
)oo! "
{pp 
tryqq 
{rr 	
iftt 
(tt 
!tt 
_enginett 
.tt 
Validatett !
(tt! "
Contenttt" )
,tt) *
outtt+ .
vartt/ 2
errortt3 8
)tt8 9
)tt9 :
{uu 
StatusMessagevv 
=vv 
$"vv  "
$strvv" 0
{vv0 1
errorvv1 6
}vv6 7
"vv7 8
;vv8 9
returnww 
;ww 
}xx 
ifzz 
(zz 
_templateIdzz 
.zz 
HasValuezz $
)zz$ %
{{{ 
var|| 
template|| 
=|| 
await|| $
_repository||% 0
.||0 1
GetByIdAsync||1 =
(||= >
_templateId||> I
.||I J
Value||J O
)||O P
;||P Q
if}} 
(}} 
template}} 
!=}} 
null}}  $
)}}$ %
{~~ 
if 
( 
template  
.  !
IsSystem! )
)) *
{
€€ 
StatusMessage
 %
=
& '
$str
( _
;
_ `
return
‚‚ 
;
‚‚ 
}
ƒƒ 
template
…… 
.
…… 

UpdateName
…… '
(
……' (
Name
……( ,
)
……, -
;
……- .
template
†† 
.
†† 
UpdateContent
†† *
(
††* +
Content
††+ 2
)
††2 3
;
††3 4
await
ˆˆ 
_repository
ˆˆ %
.
ˆˆ% &
UpdateAsync
ˆˆ& 1
(
ˆˆ1 2
template
ˆˆ2 :
)
ˆˆ: ;
;
ˆˆ; <
}
‰‰ 
}
ŠŠ 
else
‹‹ 
{
ŒŒ 
var
 
newTemplate
 
=
  !
PrintTemplate
" /
.
/ 0
Create
0 6
(
6 7
Name
7 ;
,
; <
Type
= A
,
A B
Content
C J
)
J K
;
K L
await
ŽŽ 
_repository
ŽŽ !
.
ŽŽ! "
AddAsync
ŽŽ" *
(
ŽŽ* +
newTemplate
ŽŽ+ 6
)
ŽŽ6 7
;
ŽŽ7 8
}
  
_navigationService
‘‘ 
.
‘‘ 
GoBack
‘‘ %
(
‘‘% &
)
‘‘& '
;
‘‘' (
}
’’ 	
catch
““ 
(
““ 
	Exception
““ 
ex
““ 
)
““ 
{
”” 	
StatusMessage
•• 
=
•• 
$"
•• 
$str
•• +
{
••+ ,
ex
••, .
.
••. /
Message
••/ 6
}
••6 7
"
••7 8
;
••8 9
}
–– 	
}
—— 
private
™™ 
void
™™ 
Cancel
™™ 
(
™™ 
)
™™ 
{
šš  
_navigationService
›› 
.
›› 
GoBack
›› !
(
››! "
)
››" #
;
››# $
}
œœ 
private
ŸŸ 
string
ŸŸ 
_previewHtml
ŸŸ 
=
ŸŸ  !
string
ŸŸ" (
.
ŸŸ( )
Empty
ŸŸ) .
;
ŸŸ. /
public
   

string
   
PreviewHtml
   
{
¡¡ 
get
¢¢ 
=>
¢¢ 
_previewHtml
¢¢ 
;
¢¢ 
set
££ 
=>
££ 
SetProperty
££ 
(
££ 
ref
££ 
_previewHtml
££ +
,
££+ ,
value
££- 2
)
££2 3
;
££3 4
}
¤¤ 
private
§§ 
Magidesk
§§ 
.
§§ 
Application
§§  
.
§§  !
DTOs
§§! %
.
§§% &
Printing
§§& .
.
§§. /
TicketPrintModel
§§/ ?
GetBaseMockModel
§§@ P
(
§§P Q
)
§§Q R
{
¨¨ 
return
©© 
new
©© 
Magidesk
©© 
.
©© 
Application
©© '
.
©©' (
DTOs
©©( ,
.
©©, -
Printing
©©- 5
.
©©5 6
TicketPrintModel
©©6 F
{
ªª 	
TicketNumber
«« 
=
«« 
$str
««  
,
««  !
Date
¬¬ 
=
¬¬ 
DateTime
¬¬ 
.
¬¬ 
Now
¬¬ 
.
¬¬  
ToString
¬¬  (
(
¬¬( )
$str
¬¬) 5
)
¬¬5 6
,
¬¬6 7
Time
­­ 
=
­­ 
DateTime
­­ 
.
­­ 
Now
­­ 
.
­­  
ToString
­­  (
(
­­( )
$str
­­) 0
)
­­0 1
,
­­1 2

ServerName
®® 
=
®® 
$str
®® #
,
®®# $
	TableName
¯¯ 
=
¯¯ 
$str
¯¯ !
,
¯¯! "
Subtotal
°° 
=
°° 
$str
°° 
,
°°  
Tax
±± 
=
±± 
$str
±± 
,
±± 
Total
²² 
=
²² 
$str
²² 
,
²² 

BalanceDue
³³ 
=
³³ 
$str
³³ !
,
³³! "

Restaurant
µµ 
=
µµ 
new
µµ 
Magidesk
µµ %
.
µµ% &
Application
µµ& 1
.
µµ1 2
DTOs
µµ2 6
.
µµ6 7
Printing
µµ7 ?
.
µµ? @"
RestaurantPrintModel
µµ@ T
{
¶¶ 
Name
·· 
=
·· 
$str
·· &
,
··& '
Address
¸¸ 
=
¸¸ 
$str
¸¸ 7
,
¸¸7 8
Phone
¹¹ 
=
¹¹ 
$str
¹¹ (
}
ºº 
,
ºº 
Lines
»» 
=
»» 
new
»» 
System
»» 
.
»» 
Collections
»» *
.
»»* +
Generic
»»+ 2
.
»»2 3
List
»»3 7
<
»»7 8
Magidesk
»»8 @
.
»»@ A
Application
»»A L
.
»»L M
DTOs
»»M Q
.
»»Q R
Printing
»»R Z
.
»»Z [!
OrderLinePrintModel
»»[ n
>
»»n o
{
¼¼ 
new
½½ 
(
½½ 
)
½½ 
{
½½ 
Quantity
½½  
=
½½! "
$num
½½# $
,
½½$ %
Name
½½& *
=
½½+ ,
$str
½½- ;
,
½½; <
Price
½½= B
=
½½C D
$str
½½E L
,
½½L M
Total
½½N S
=
½½T U
$str
½½V ]
,
½½] ^
Instructions
½½_ k
=
½½l m
$str
½½n y
,
½½y z
	Modifiers½½{ „
=½½… †
new½½‡ Š
(½½Š ‹
)½½‹ Œ
{½½ Ž
$str½½ ¦
}½½§ ¨
}½½© ª
,½½ª «
new
¾¾ 
(
¾¾ 
)
¾¾ 
{
¾¾ 
Quantity
¾¾  
=
¾¾! "
$num
¾¾# $
,
¾¾$ %
Name
¾¾& *
=
¾¾+ ,
$str
¾¾- 3
,
¾¾3 4
Price
¾¾5 :
=
¾¾; <
$str
¾¾= C
,
¾¾C D
Total
¾¾E J
=
¾¾K L
$str
¾¾M S
}
¾¾T U
,
¾¾U V
new
¿¿ 
(
¿¿ 
)
¿¿ 
{
¿¿ 
Quantity
¿¿  
=
¿¿! "
$num
¿¿# $
,
¿¿$ %
Name
¿¿& *
=
¿¿+ ,
$str
¿¿- <
,
¿¿< =
Price
¿¿> C
=
¿¿D E
$str
¿¿F L
,
¿¿L M
Total
¿¿N S
=
¿¿T U
$str
¿¿V \
}
¿¿] ^
}
ÀÀ 
,
ÀÀ 
Payments
ÁÁ 
=
ÁÁ 
new
ÁÁ 
System
ÁÁ !
.
ÁÁ! "
Collections
ÁÁ" -
.
ÁÁ- .
Generic
ÁÁ. 5
.
ÁÁ5 6
List
ÁÁ6 :
<
ÁÁ: ;
Magidesk
ÁÁ; C
.
ÁÁC D
Application
ÁÁD O
.
ÁÁO P
DTOs
ÁÁP T
.
ÁÁT U
Printing
ÁÁU ]
.
ÁÁ] ^
PaymentPrintModel
ÁÁ^ o
>
ÁÁo p
{
ÂÂ 
new
ÃÃ 
(
ÃÃ 
)
ÃÃ 
{
ÃÃ 
Type
ÃÃ 
=
ÃÃ 
$str
ÃÃ *
,
ÃÃ* +
Amount
ÃÃ, 2
=
ÃÃ3 4
$str
ÃÃ5 =
}
ÃÃ> ?
}
ÄÄ 
}
ÅÅ 	
;
ÅÅ	 

}
ÆÆ 
private
ÈÈ 
async
ÈÈ 
Task
ÈÈ  
UpdatePreviewAsync
ÈÈ )
(
ÈÈ) *
)
ÈÈ* +
{
ÉÉ 
try
ÊÊ 
{
ËË 	
var
ÍÍ 
model
ÍÍ 
=
ÍÍ 
GetBaseMockModel
ÍÍ (
(
ÍÍ( )
)
ÍÍ) *
;
ÍÍ* +
try
ÐÐ 
{
ÑÑ 
var
ÒÒ 
config
ÒÒ 
=
ÒÒ 
await
ÒÒ "
_configRepo
ÒÒ# .
.
ÒÒ. /#
GetConfigurationAsync
ÒÒ/ D
(
ÒÒD E
)
ÒÒE F
;
ÒÒF G
if
ÓÓ 
(
ÓÓ 
config
ÓÓ 
!=
ÓÓ 
null
ÓÓ "
)
ÓÓ" #
{
ÔÔ 
model
ÕÕ 
.
ÕÕ 

Restaurant
ÕÕ $
.
ÕÕ$ %
Name
ÕÕ% )
=
ÕÕ* +
config
ÕÕ, 2
.
ÕÕ2 3
Name
ÕÕ3 7
;
ÕÕ7 8
model
ÖÖ 
.
ÖÖ 

Restaurant
ÖÖ $
.
ÖÖ$ %
Address
ÖÖ% ,
=
ÖÖ- .
config
ÖÖ/ 5
.
ÖÖ5 6
Address
ÖÖ6 =
;
ÖÖ= >
model
×× 
.
×× 

Restaurant
×× $
.
××$ %
Phone
××% *
=
××+ ,
config
××- 3
.
××3 4
Phone
××4 9
;
××9 :
}
ØØ 
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
System
ÝÝ 
.
ÝÝ 
Diagnostics
ÝÝ "
.
ÝÝ" #
Debug
ÝÝ# (
.
ÝÝ( )
	WriteLine
ÝÝ) 2
(
ÝÝ2 3
$"
ÝÝ3 5
$str
ÝÝ5 R
{
ÝÝR S
ex
ÝÝS U
.
ÝÝU V
Message
ÝÝV ]
}
ÝÝ] ^
"
ÝÝ^ _
)
ÝÝ_ `
;
ÝÝ` a
}
ÞÞ 
var
àà 
json
àà 
=
àà 
await
àà 
_engine
àà $
.
àà$ %
RenderAsync
àà% 0
(
àà0 1
Content
àà1 8
,
àà8 9
model
àà: ?
)
àà? @
;
àà@ A
var
ää 
options
ää 
=
ää 
new
ää 
System
ää $
.
ää$ %
Text
ää% )
.
ää) *
Json
ää* .
.
ää. /#
JsonSerializerOptions
ää/ D
{
ääE F)
PropertyNameCaseInsensitive
ääG b
=
ääc d
true
ääe i
}
ääj k
;
ääk l
if
çç 
(
çç 
json
çç 
.
çç 
	TrimStart
çç 
(
çç 
)
çç  
.
çç  !

StartsWith
çç! +
(
çç+ ,
$str
çç, /
)
çç/ 0
)
çç0 1
{
èè 
var
éé 
doc
éé 
=
éé 
System
éé  
.
éé  !
Text
éé! %
.
éé% &
Json
éé& *
.
éé* +
JsonSerializer
éé+ 9
.
éé9 :
Deserialize
éé: E
<
ééE F
Magidesk
ééF N
.
ééN O
Infrastructure
ééO ]
.
éé] ^
Printing
éé^ f
.
ééf g
Models
éég m
.
éém n
PrintDocument
één {
>
éé{ |
(
éé| }
jsonéé} 
,éé ‚
optionsééƒ Š
)ééŠ ‹
;éé‹ Œ
if
êê 
(
êê 
doc
êê 
!=
êê 
null
êê 
)
êê  
{
ëë 
var
íí 
driver
íí 
=
íí  
new
íí! $
Magidesk
íí% -
.
íí- .
Infrastructure
íí. <
.
íí< =
Printing
íí= E
.
ííE F
Drivers
ííF M
.
ííM N
HtmlPreviewDriver
ííN _
(
íí_ `
)
íí` a
;
íía b
PreviewHtml
îî 
=
îî  !
driver
îî" (
.
îî( )
Render
îî) /
(
îî/ 0
doc
îî0 3
)
îî3 4
;
îî4 5
return
ïï 
;
ïï 
}
ðð 
}
ññ 
PreviewHtml
ôô 
=
ôô 
$"
ôô 
$str
ôô -
{
ôô- .
System
ôô. 4
.
ôô4 5
Net
ôô5 8
.
ôô8 9

WebUtility
ôô9 C
.
ôôC D

HtmlEncode
ôôD N
(
ôôN O
json
ôôO S
)
ôôS T
}
ôôT U
$str
ôôU i
"
ôôi j
;
ôôj k
}
öö 	
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷ 
{
øø 	
var
ùù 
msg
ùù 
=
ùù 
$"
ùù 
$str
ùù '
{
ùù' (
ex
ùù( *
.
ùù* +
Message
ùù+ 2
}
ùù2 3
"
ùù3 4
;
ùù4 5
PreviewHtml
úú 
=
úú 
$"
úú 
$str
úú S
{
úúS T
ex
úúT V
.
úúV W
Message
úúW ^
}
úú^ _
$str
úú_ q
"
úúq r
;
úúr s
await
ûû  
_navigationService
ûû $
.
ûû$ %
ShowErrorAsync
ûû% 3
(
ûû3 4
$str
ûû4 O
,
ûûO P
msg
ûûQ T
)
ûûT U
;
ûûU V
}
üü 	
}
ýý 
}þþ š¼
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\TableMapViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class 
TableMapViewModel 
:  
ViewModelBase! .
{ 
private 
readonly 
IQueryHandler "
<" #
GetTableMapQuery# 3
,3 4
GetTableMapResult5 F
>F G
_getTableMapH T
;T U
private 
readonly 
ICommandHandler $
<$ %
ChangeTableCommand% 7
,7 8
ChangeTableResult9 J
>J K
_changeTableL X
;X Y
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
Timer 
? 
_refreshTimer  
;  !
private 
readonly #
CancellationTokenSource ,$
_cancellationTokenSource- E
=F G
newH K
(K L
)L M
;M N
public 
 
ObservableCollection 
<  
TableDto  (
>( )
Tables* 0
{1 2
get3 6
;6 7
}8 9
=: ;
new< ?
(? @
)@ A
;A B
private 
TableDto 
? 
_selectedTable $
;$ %
public 

TableDto 
? 
SelectedTable "
{ 
get   
=>   
_selectedTable   
;   
set!! 
=>!! 
SetProperty!! 
(!! 
ref!! 
_selectedTable!! -
,!!- .
value!!/ 4
)!!4 5
;!!5 6
}"" 
private$$ 
bool$$ 
_isRealTimeEnabled$$ #
=$$$ %
true$$& *
;$$* +
public%% 

bool%% 
IsRealTimeEnabled%% !
{&& 
get'' 
=>'' 
_isRealTimeEnabled'' !
;''! "
set(( 
=>(( 
SetProperty(( 
((( 
ref(( 
_isRealTimeEnabled(( 1
,((1 2
value((3 8
)((8 9
;((9 :
})) 
private++ 
int++ 
_refreshInterval++  
=++! "
$num++# '
;++' (
public,, 

int,, 
RefreshInterval,, 
{-- 
get.. 
=>.. 
_refreshInterval.. 
;..  
set// 
=>// 
SetProperty// 
(// 
ref// 
_refreshInterval// /
,/// 0
value//1 6
)//6 7
;//7 8
}00 
private22 
DateTime22 
_lastRefresh22 !
=22" #
DateTime22$ ,
.22, -
MinValue22- 5
;225 6
public33 

DateTime33 
LastRefresh33 
{44 
get55 
=>55 
_lastRefresh55 
;55 
set66 
=>66 
SetProperty66 
(66 
ref66 
_lastRefresh66 +
,66+ ,
value66- 2
)662 3
;663 4
}77 
private:: 
Guid:: 
?:: 
_sourceTicketId:: !
;::! "
public;; 

Guid;; 
?;; 
SourceTicketId;; 
{<< 
get== 
=>== 
_sourceTicketId== 
;== 
set>> 
=>>> 
SetProperty>> 
(>> 
ref>> 
_sourceTicketId>> .
,>>. /
value>>0 5
)>>5 6
;>>6 7
}?? 
publicAA 

stringAA 

HeaderTextAA 
=>AA 
SourceTicketIdAA  .
.AA. /
HasValueAA/ 7
?AA8 9
$strAA: L
:AAM N
$strAAO Z
;AAZ [
publicCC 

AsyncRelayCommandCC 
LoadTablesCommandCC .
{CC/ 0
getCC1 4
;CC4 5
}CC6 7
publicDD 

AsyncRelayCommandDD  
RefreshTablesCommandDD 1
{DD2 3
getDD4 7
;DD7 8
}DD9 :
publicEE 

AsyncRelayCommandEE !
ToggleRealTimeCommandEE 2
{EE3 4
getEE5 8
;EE8 9
}EE: ;
publicFF 

AsyncRelayCommandFF 
<FF 
TableDtoFF %
>FF% &
SelectTableCommandFF' 9
{FF: ;
getFF< ?
;FF? @
}FFA B
privateHH 
readonlyHH 
IUserServiceHH !
_userServiceHH" .
;HH. /
privateII 
readonlyII "
ITicketCreationServiceII +"
_ticketCreationServiceII, B
;IIB C
privateJJ 
readonlyJJ  
IServiceScopeFactoryJJ ) 
_serviceScopeFactoryJJ* >
;JJ> ?
privateKK 
readonlyKK 
	MicrosoftKK 
.KK 
UIKK !
.KK! "
DispatchingKK" -
.KK- .
DispatcherQueueKK. =
_dispatcherQueueKK> N
;KKN O
publicMM 

TableMapViewModelMM 
(MM 
IQueryHandlerNN 
<NN 
GetTableMapQueryNN &
,NN& '
GetTableMapResultNN( 9
>NN9 :
getTableMapNN; F
,NNF G
ICommandHandlerOO 
<OO 
ChangeTableCommandOO *
,OO* +
ChangeTableResultOO, =
>OO= >
changeTableOO? J
,OOJ K
NavigationServicePP 
navigationServicePP +
,PP+ ,
IUserServiceQQ 
userServiceQQ  
,QQ  !"
ITicketCreationServiceRR !
ticketCreationServiceRR 4
,RR4 5 
IServiceScopeFactorySS 
serviceScopeFactorySS 0
)SS0 1
{TT 
_getTableMapUU 
=UU 
getTableMapUU "
;UU" #
_changeTableVV 
=VV 
changeTableVV "
;VV" #
_navigationServiceWW 
=WW 
navigationServiceWW .
;WW. /
_userServiceXX 
=XX 
userServiceXX "
;XX" #"
_ticketCreationServiceYY 
=YY  !
ticketCreationServiceYY! 6
;YY6 7 
_serviceScopeFactoryZZ 
=ZZ 
serviceScopeFactoryZZ 2
;ZZ2 3
_dispatcherQueue[[ 
=[[ 
	Microsoft[[ $
.[[$ %
UI[[% '
.[[' (
Dispatching[[( 3
.[[3 4
DispatcherQueue[[4 C
.[[C D
GetForCurrentThread[[D W
([[W X
)[[X Y
;[[Y Z
LoadTablesCommand]] 
=]] 
new]] 
AsyncRelayCommand]]  1
(]]1 2
LoadTablesAsync]]2 A
)]]A B
;]]B C 
RefreshTablesCommand^^ 
=^^ 
new^^ "
AsyncRelayCommand^^# 4
(^^4 5
RefreshTablesAsync^^5 G
)^^G H
;^^H I!
ToggleRealTimeCommand__ 
=__ 
new__  #
AsyncRelayCommand__$ 5
(__5 6
ToggleRealTimeAsync__6 I
)__I J
;__J K
SelectTableCommand`` 
=`` 
new``  
AsyncRelayCommand``! 2
<``2 3
TableDto``3 ;
>``; <
(``< =
SelectTableAsync``= M
)``M N
;``N O
Titlebb 
=bb 
$strbb 
;bb  
StartRealTimePollingee 
(ee 
)ee 
;ee 
}ff 
publichh 

eventhh 
EventHandlerhh 
?hh 
RequestShiftStarthh 0
;hh0 1
publicjj 

voidjj 

SetContextjj 
(jj 
Guidjj 
?jj  
sourceTicketIdjj! /
)jj/ 0
{kk 
SourceTicketIdll 
=ll 
sourceTicketIdll '
;ll' (
OnPropertyChangedmm 
(mm 
nameofmm  
(mm  !

HeaderTextmm! +
)mm+ ,
)mm, -
;mm- .
}nn 
privatepp 
doublepp 
_canvasWidthpp 
=pp  !
$numpp" &
;pp& '
publicqq 

doubleqq 
CanvasWidthqq 
{rr 
getss 
=>ss 
_canvasWidthss 
;ss 
settt 
=>tt 
SetPropertytt 
(tt 
reftt 
_canvasWidthtt +
,tt+ ,
valuett- 2
)tt2 3
;tt3 4
}uu 
privateww 
doubleww 
_canvasHeightww  
=ww! "
$numww# '
;ww' (
publicxx 

doublexx 
CanvasHeightxx 
{yy 
getzz 
=>zz 
_canvasHeightzz 
;zz 
set{{ 
=>{{ 
SetProperty{{ 
({{ 
ref{{ 
_canvasHeight{{ ,
,{{, -
value{{. 3
){{3 4
;{{4 5
}|| 
private~~ 
async~~ 
Task~~ 
LoadTablesAsync~~ &
(~~& '
)~~' (
{ 
IsBusy
€€ 
=
€€ 
true
€€ 
;
€€ 
try
 
{
‚‚ 	
var
ƒƒ 
result
ƒƒ 
=
ƒƒ 
await
ƒƒ 
_getTableMap
ƒƒ +
.
ƒƒ+ ,
HandleAsync
ƒƒ, 7
(
ƒƒ7 8
new
ƒƒ8 ;
GetTableMapQuery
ƒƒ< L
(
ƒƒL M
)
ƒƒM N
)
ƒƒN O
;
ƒƒO P
Tables
„„ 
.
„„ 
Clear
„„ 
(
„„ 
)
„„ 
;
„„ 
double
†† 
maxX
†† 
=
†† 
$num
†† 
;
†† 
double
‡‡ 
maxY
‡‡ 
=
‡‡ 
$num
‡‡ 
;
‡‡ 
foreach
‰‰ 
(
‰‰ 
var
‰‰ 
table
‰‰ 
in
‰‰ !
result
‰‰" (
.
‰‰( )
Tables
‰‰) /
)
‰‰/ 0
{
ŠŠ 
Tables
‹‹ 
.
‹‹ 
Add
‹‹ 
(
‹‹ 
table
‹‹  
)
‹‹  !
;
‹‹! "
double
ŽŽ 

tableRight
ŽŽ !
=
ŽŽ" #
table
ŽŽ$ )
.
ŽŽ) *
X
ŽŽ* +
+
ŽŽ, -
(
ŽŽ. /
table
ŽŽ/ 4
.
ŽŽ4 5
Width
ŽŽ5 :
>
ŽŽ; <
$num
ŽŽ= >
?
ŽŽ? @
table
ŽŽA F
.
ŽŽF G
Width
ŽŽG L
:
ŽŽM N
$num
ŽŽO R
)
ŽŽR S
;
ŽŽS T
double
 
tableBottom
 "
=
# $
table
% *
.
* +
Y
+ ,
+
- .
(
/ 0
table
0 5
.
5 6
Height
6 <
>
= >
$num
? @
?
A B
table
C H
.
H I
Height
I O
:
P Q
$num
R U
)
U V
;
V W
if
‘‘ 
(
‘‘ 

tableRight
‘‘ 
>
‘‘  
maxX
‘‘! %
)
‘‘% &
maxX
‘‘' +
=
‘‘, -

tableRight
‘‘. 8
;
‘‘8 9
if
’’ 
(
’’ 
tableBottom
’’ 
>
’’  !
maxY
’’" &
)
’’& '
maxY
’’( ,
=
’’- .
tableBottom
’’/ :
;
’’: ;
}
““ 
CanvasWidth
–– 
=
–– 
maxX
–– 
+
––  
$num
––! $
;
––$ %
CanvasHeight
—— 
=
—— 
maxY
—— 
+
——  !
$num
——" %
;
——% &
}
˜˜ 	
finally
™™ 
{
šš 	
IsBusy
›› 
=
›› 
false
›› 
;
›› 
}
œœ 	
}
 
private
ŸŸ 
async
ŸŸ 
Task
ŸŸ 
SelectTableAsync
ŸŸ '
(
ŸŸ' (
TableDto
ŸŸ( 0
?
ŸŸ0 1
table
ŸŸ2 7
)
ŸŸ7 8
{
   
if
¡¡ 

(
¡¡ 
table
¡¡ 
==
¡¡ 
null
¡¡ 
)
¡¡ 
return
¡¡ !
;
¡¡! "
SelectedTable
££ 
=
££ 
table
££ 
;
££ 
if
¥¥ 

(
¥¥ 
SourceTicketId
¥¥ 
.
¥¥ 
HasValue
¥¥ #
)
¥¥# $
{
¦¦ 	
if
¨¨ 
(
¨¨ 
table
¨¨ 
.
¨¨ 
Status
¨¨ 
!=
¨¨ 
TableStatus
¨¨  +
.
¨¨+ ,
	Available
¨¨, 5
)
¨¨5 6
{
©© 
return
«« 
;
«« 
}
¬¬ 
IsBusy
®® 
=
®® 
true
®® 
;
®® 
try
¯¯ 
{
°° 
var
±± 
result
±± 
=
±± 
await
±± "
_changeTable
±±# /
.
±±/ 0
HandleAsync
±±0 ;
(
±±; <
new
±±< ? 
ChangeTableCommand
±±@ R
{
²² 
TicketId
³³ 
=
³³ 
SourceTicketId
³³ -
.
³³- .
Value
³³. 3
,
³³3 4

NewTableId
´´ 
=
´´  
table
´´! &
.
´´& '
Id
´´' )
,
´´) *
UserId
µµ 
=
µµ 
new
µµ  
UserId
µµ! '
(
µµ' (
Guid
µµ( ,
.
µµ, -
Parse
µµ- 2
(
µµ2 3
$str
µµ3 Y
)
µµY Z
)
µµZ [
}
¶¶ 
)
¶¶ 
;
¶¶ 
if
¸¸ 
(
¸¸ 
result
¸¸ 
.
¸¸ 
Success
¸¸ "
)
¸¸" #
{
¹¹  
_navigationService
»» '
.
»»' (
Navigate
»»( 0
(
»»0 1
typeof
»»1 7
(
»»7 8
OrderEntryPage
»»8 F
)
»»F G
,
»»G H
new
»»I L)
OrderEntryNavigationContext
»»M h
(
»»h i
SourceTicketId
»»i w
.
»»w x
Value
»»x }
,
»»} ~
true»» ƒ
)»»ƒ „
)»»„ …
;»»… †

SetContext
¾¾ 
(
¾¾  
null
¾¾  $
)
¾¾$ %
;
¾¾% &
}
¿¿ 
else
ÀÀ 
{
ÁÁ 
}
ÃÃ 
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
IsBusy
ÇÇ 
=
ÇÇ 
false
ÇÇ 
;
ÇÇ 
}
ÈÈ 
return
ÊÊ 
;
ÊÊ 
}
ËË 	
if
ÎÎ 

(
ÎÎ 
table
ÎÎ 
.
ÎÎ 
Status
ÎÎ 
==
ÎÎ 
TableStatus
ÎÎ '
.
ÎÎ' (
Seat
ÎÎ( ,
&&
ÎÎ- /
table
ÎÎ0 5
.
ÎÎ5 6
CurrentTicketId
ÎÎ6 E
.
ÎÎE F
HasValue
ÎÎF N
)
ÎÎN O
{
ÏÏ 	 
_navigationService
ÑÑ 
.
ÑÑ  
Navigate
ÑÑ  (
(
ÑÑ( )
typeof
ÑÑ) /
(
ÑÑ/ 0
OrderEntryPage
ÑÑ0 >
)
ÑÑ> ?
,
ÑÑ? @
new
ÑÑA D)
OrderEntryNavigationContext
ÑÑE `
(
ÑÑ` a
table
ÑÑa f
.
ÑÑf g
CurrentTicketId
ÑÑg v
.
ÑÑv w
Value
ÑÑw |
,
ÑÑ| }
trueÑÑ~ ‚
)ÑÑ‚ ƒ
)ÑÑƒ „
;ÑÑ„ …
}
ÒÒ 	
else
ÓÓ 
if
ÓÓ 
(
ÓÓ 
table
ÓÓ 
.
ÓÓ 
Status
ÓÓ 
==
ÓÓ  
TableStatus
ÓÓ! ,
.
ÓÓ, -
	Available
ÓÓ- 6
)
ÓÓ6 7
{
ÔÔ 	
try
ÖÖ 
{
×× 
IsBusy
ØØ 
=
ØØ 
true
ØØ 
;
ØØ 
if
ÚÚ 
(
ÚÚ 
_userService
ÚÚ !
.
ÚÚ! "
CurrentUser
ÚÚ" -
?
ÚÚ- .
.
ÚÚ. /
Id
ÚÚ/ 1
==
ÚÚ2 4
null
ÚÚ5 9
)
ÚÚ9 :
return
ÚÚ; A
;
ÚÚA B
var
ÜÜ 
ticketId
ÜÜ 
=
ÜÜ 
await
ÜÜ  %$
_ticketCreationService
ÜÜ& <
.
ÜÜ< ='
CreateTicketForTableAsync
ÜÜ= V
(
ÜÜV W
table
ÜÜW \
.
ÜÜ\ ]
Id
ÜÜ] _
,
ÜÜ_ `
_userService
ÜÜa m
.
ÜÜm n
CurrentUser
ÜÜn y
.
ÜÜy z
Id
ÜÜz |
)
ÜÜ| }
;
ÜÜ} ~ 
_navigationService
ßß #
.
ßß# $
Navigate
ßß$ ,
(
ßß, -
typeof
ßß- 3
(
ßß3 4
OrderEntryPage
ßß4 B
)
ßßB C
,
ßßC D
new
ßßE H)
OrderEntryNavigationContext
ßßI d
(
ßßd e
ticketId
ßße m
,
ßßm n
true
ßßo s
)
ßßs t
)
ßßt u
;
ßßu v
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá  
)
áá  !
{
ââ 
System
ää 
.
ää 
Diagnostics
ää #
.
ää# $
Debug
ää$ )
.
ää) *
	WriteLine
ää* 3
(
ää3 4
$"
ää4 6
$str
ää6 X
{
ääX Y
ex
ääY [
.
ää[ \
Message
ää\ c
}
ääc d
"
ääd e
)
ääe f
;
ääf g
}
åå 
finally
ææ 
{
çç 
IsBusy
èè 
=
èè 
false
èè 
;
èè  
}
éé 
}
êê 	
}
ëë 
private
íí 
void
íí "
StartRealTimePolling
íí %
(
íí% &
)
íí& '
{
îî 
if
ïï 

(
ïï 
IsRealTimeEnabled
ïï 
)
ïï 
{
ðð 	
_refreshTimer
òò 
=
òò 
new
òò 
Timer
òò  %
(
òò% &
async
òò& +
_
òò, -
=>
òò. 0
await
òò1 6%
RefreshTableStatusAsync
òò7 N
(
òòN O
)
òòO P
,
òòP Q
null
óó% )
,
óó) *
TimeSpan
óó+ 3
.
óó3 4
FromMilliseconds
óó4 D
(
óóD E
RefreshInterval
óóE T
)
óóT U
,
óóU V
TimeSpan
óóW _
.
óó_ `
FromMilliseconds
óó` p
(
óóp q
RefreshIntervalóóq €
)óó€ 
)óó ‚
;óó‚ ƒ
}
ôô 	
}
õõ 
private
÷÷ 
void
÷÷ !
StopRealTimePolling
÷÷ $
(
÷÷$ %
)
÷÷% &
{
øø 
_refreshTimer
ùù 
?
ùù 
.
ùù 
Dispose
ùù 
(
ùù 
)
ùù  
;
ùù  !
}
úú 
private
üü 
async
üü 
Task
üü %
RefreshTableStatusAsync
üü .
(
üü. /
)
üü/ 0
{
ýý 
if
þþ 

(
þþ 
!
þþ 
IsRealTimeEnabled
þþ 
)
þþ 
return
þþ  &
;
þþ& '
try
€€ 
{
 	
using
‚‚ 
(
‚‚ 
var
‚‚ 
scope
‚‚ 
=
‚‚ "
_serviceScopeFactory
‚‚ 3
.
‚‚3 4
CreateScope
‚‚4 ?
(
‚‚? @
)
‚‚@ A
)
‚‚A B
{
ƒƒ 
var
„„ 
getTableMap
„„ 
=
„„  !
scope
„„" '
.
„„' (
ServiceProvider
„„( 7
.
„„7 8 
GetRequiredService
„„8 J
<
„„J K
IQueryHandler
„„K X
<
„„X Y
GetTableMapQuery
„„Y i
,
„„i j
GetTableMapResult
„„k |
>
„„| }
>
„„} ~
(
„„~ 
)„„ €
;„„€ 
var
…… 
result
…… 
=
…… 
await
…… "
getTableMap
……# .
.
……. /
HandleAsync
……/ :
(
……: ;
new
……; >
GetTableMapQuery
……? O
(
……O P
)
……P Q
)
……Q R
;
……R S
_dispatcherQueue
‹‹  
.
‹‹  !

TryEnqueue
‹‹! +
(
‹‹+ ,
(
‹‹, -
)
‹‹- .
=>
‹‹/ 1
{
ŒŒ 
foreach
ŽŽ 
(
ŽŽ 
var
ŽŽ  
updatedTable
ŽŽ! -
in
ŽŽ. 0
result
ŽŽ1 7
.
ŽŽ7 8
Tables
ŽŽ8 >
)
ŽŽ> ?
{
 
var
 
existingTable
 )
=
* +
Tables
, 2
.
2 3
FirstOrDefault
3 A
(
A B
t
B C
=>
D F
t
G H
.
H I
Id
I K
==
L N
updatedTable
O [
.
[ \
Id
\ ^
)
^ _
;
_ `
if
‘‘ 
(
‘‘ 
existingTable
‘‘ )
!=
‘‘* ,
null
‘‘- 1
&&
‘‘2 4
(
‘‘5 6
existingTable
‘‘6 C
.
‘‘C D
Status
‘‘D J
!=
‘‘K M
updatedTable
‘‘N Z
.
‘‘Z [
Status
‘‘[ a
||
‘‘b d
existingTable
‘‘e r
.
‘‘r s
CurrentTicketId‘‘s ‚
!=‘‘ƒ …
updatedTable‘‘† ’
.‘‘’ “
CurrentTicketId‘‘“ ¢
)‘‘¢ £
)‘‘£ ¤
{
’’ 
existingTable
““ )
.
““) *
Status
““* 0
=
““1 2
updatedTable
““3 ?
.
““? @
Status
““@ F
;
““F G
existingTable
”” )
.
””) *
CurrentTicketId
””* 9
=
””: ;
updatedTable
””< H
.
””H I
CurrentTicketId
””I X
;
””X Y
}
•• 
}
–– 
}
—— 
)
—— 
;
—— 
}
˜˜ 
_dispatcherQueue
šš 
.
šš 

TryEnqueue
šš '
(
šš' (
(
šš( )
)
šš) *
=>
šš+ -
LastRefresh
šš. 9
=
šš: ;
DateTime
šš< D
.
ššD E
UtcNow
ššE K
)
ššK L
;
ššL M
}
›› 	
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ 
{
 	
System
ŸŸ 
.
ŸŸ 
Diagnostics
ŸŸ 
.
ŸŸ 
Debug
ŸŸ $
.
ŸŸ$ %
	WriteLine
ŸŸ% .
(
ŸŸ. /
$"
ŸŸ/ 1
$str
ŸŸ1 P
{
ŸŸP Q
ex
ŸŸQ S
.
ŸŸS T
Message
ŸŸT [
}
ŸŸ[ \
"
ŸŸ\ ]
)
ŸŸ] ^
;
ŸŸ^ _
}
   	
}
¡¡ 
private
££ 
async
££ 
Task
££  
RefreshTablesAsync
££ )
(
££) *
)
££* +
{
¤¤ 
await
¥¥ 
LoadTablesAsync
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥  
LastRefresh
¦¦ 
=
¦¦ 
DateTime
¦¦ 
.
¦¦ 
UtcNow
¦¦ %
;
¦¦% &
}
§§ 
private
©© 
async
©© 
Task
©© !
ToggleRealTimeAsync
©© *
(
©©* +
)
©©+ ,
{
ªª 
IsRealTimeEnabled
«« 
=
«« 
!
«« 
IsRealTimeEnabled
«« .
;
««. /
if
­­ 

(
­­ 
IsRealTimeEnabled
­­ 
)
­­ 
{
®® 	"
StartRealTimePolling
¯¯  
(
¯¯  !
)
¯¯! "
;
¯¯" #
}
°° 	
else
±± 
{
²² 	!
StopRealTimePolling
³³ 
(
³³  
)
³³  !
;
³³! "
}
´´ 	
}
µµ 
public
·· 

void
·· 
Dispose
·· 
(
·· 
)
·· 
{
¸¸ &
_cancellationTokenSource
¹¹  
.
¹¹  !
Cancel
¹¹! '
(
¹¹' (
)
¹¹( )
;
¹¹) *!
StopRealTimePolling
ºº 
(
ºº 
)
ºº 
;
ºº &
_cancellationTokenSource
»»  
.
»»  !
Dispose
»»! (
(
»»( )
)
»») *
;
»»* +
}
¼¼ 
}½½ ›J
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\TableExplorerViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class "
TableExplorerViewModel #
:$ %
ViewModelBase& 3
{ 
private 
readonly 
IQueryHandler "
<" #
GetTableMapQuery# 3
,3 4
GetTableMapResult5 F
>F G
_getTableMapH T
;T U
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly "
ITicketCreationService +"
_ticketCreationService, B
;B C
private 
readonly 
IUserService !
_userService" .
;. /
public 
 
ObservableCollection 
<  
TableDto  (
>( )
	AllTables* 3
{4 5
get6 9
;9 :
}; <
== >
new? B
(B C
)C D
;D E
public 
 
ObservableCollection 
<  
TableDto  (
>( )
FilteredTables* 8
{9 :
get; >
;> ?
}@ A
=B C
newD G
(G H
)H I
;I J
private 
string 
_searchText 
=  
string! '
.' (
Empty( -
;- .
public 

string 

SearchText 
{ 
get 
=> 
_searchText 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_searchText  +
,+ ,
value- 2
)2 3
)3 4
{   
ApplyFilter!! 
(!! 
)!! 
;!! 
}"" 
}## 	
}$$ 
public&& 

AsyncRelayCommand&& 
LoadTablesCommand&& .
{&&/ 0
get&&1 4
;&&4 5
}&&6 7
public'' 

AsyncRelayCommand'' 
<'' 
TableDto'' %
>''% &
SelectTableCommand''' 9
{'': ;
get''< ?
;''? @
}''A B
public)) 
"
TableExplorerViewModel)) !
())! "
IQueryHandler** 
<** 
GetTableMapQuery** &
,**& '
GetTableMapResult**( 9
>**9 :
getTableMap**; F
,**F G
NavigationService++ 
navigationService++ +
,+++ ,"
ITicketCreationService,, !
ticketCreationService,, 4
,,,4 5
IUserService-- 
userService--  
)--  !
{.. 
_getTableMap// 
=// 
getTableMap// "
;//" #
_navigationService00 
=00 
navigationService00 .
;00. /"
_ticketCreationService11 
=11  !
ticketCreationService11! 6
;116 7
_userService22 
=22 
userService22 "
;22" #
Title44 
=44 
$str44  
;44  !
LoadTablesCommand55 
=55 
new55 
AsyncRelayCommand55  1
(551 2
LoadTablesAsync552 A
)55A B
;55B C
SelectTableCommand66 
=66 
new66  
AsyncRelayCommand66! 2
<662 3
TableDto663 ;
>66; <
(66< =
SelectTableAsync66= M
)66M N
;66N O
}77 
private99 
async99 
Task99 
LoadTablesAsync99 &
(99& '
)99' (
{:: 
IsBusy;; 
=;; 
true;; 
;;; 
try<< 
{== 	
var?? 
result?? 
=?? 
await?? 
_getTableMap?? +
.??+ ,
HandleAsync??, 7
(??7 8
new??8 ;
GetTableMapQuery??< L
(??L M
)??M N
)??N O
;??O P
	AllTables@@ 
.@@ 
Clear@@ 
(@@ 
)@@ 
;@@ 
foreachAA 
(AA 
varAA 
tableAA 
inAA !
resultAA" (
.AA( )
TablesAA) /
)AA/ 0
{BB 
	AllTablesCC 
.CC 
AddCC 
(CC 
tableCC #
)CC# $
;CC$ %
}DD 
ApplyFilterEE 
(EE 
)EE 
;EE 
}FF 	
finallyGG 
{HH 	
IsBusyII 
=II 
falseII 
;II 
}JJ 	
}KK 
privateMM 
voidMM 
ApplyFilterMM 
(MM 
)MM 
{NN 
FilteredTablesOO 
.OO 
ClearOO 
(OO 
)OO 
;OO 
varPP 
queryPP 
=PP 
	AllTablesPP 
.PP 
AsEnumerablePP *
(PP* +
)PP+ ,
;PP, -
ifRR 

(RR 
!RR 
stringRR 
.RR 
IsNullOrWhiteSpaceRR &
(RR& '

SearchTextRR' 1
)RR1 2
)RR2 3
{SS 	
queryTT 
=TT 
queryTT 
.TT 
WhereTT 
(TT  
tTT  !
=>TT" $
tTT% &
.TT& '
TableNumberTT' 2
.TT2 3
ToStringTT3 ;
(TT; <
)TT< =
.TT= >
ContainsTT> F
(TTF G

SearchTextTTG Q
,TTQ R
StringComparisonTTS c
.TTc d
OrdinalIgnoreCaseTTd u
)TTu v
)TTv w
;TTw x
}UU 	
foreachWW 
(WW 
varWW 
tableWW 
inWW 
queryWW #
.WW# $
OrderByWW$ +
(WW+ ,
tWW, -
=>WW. 0
tWW1 2
.WW2 3
TableNumberWW3 >
)WW> ?
)WW? @
{XX 	
FilteredTablesYY 
.YY 
AddYY 
(YY 
tableYY $
)YY$ %
;YY% &
}ZZ 	
}[[ 
private]] 
async]] 
Task]] 
SelectTableAsync]] '
(]]' (
TableDto]]( 0
?]]0 1
table]]2 7
)]]7 8
{^^ 
if__ 

(__ 
table__ 
==__ 
null__ 
)__ 
return__ !
;__! "
ifbb 

(bb 
tablebb 
.bb 
Statusbb 
==bb 
Domainbb "
.bb" #
Enumerationsbb# /
.bb/ 0
TableStatusbb0 ;
.bb; <
Seatbb< @
&&bbA C
tablebbD I
.bbI J
CurrentTicketIdbbJ Y
.bbY Z
HasValuebbZ b
)bbb c
{cc 	
_navigationServiceee 
.ee 
Navigateee '
(ee' (
typeofee( .
(ee. /
OrderEntryPageee/ =
)ee= >
,ee> ?
newee@ C'
OrderEntryNavigationContexteeD _
(ee_ `
tableee` e
.eee f
CurrentTicketIdeef u
.eeu v
Valueeev {
,ee{ |
true	ee} 
)
ee ‚
)
ee‚ ƒ
;
eeƒ „
}ff 	
elsegg 
ifgg 
(gg 
tablegg 
.gg 
Statusgg 
==gg  
Domaingg! '
.gg' (
Enumerationsgg( 4
.gg4 5
TableStatusgg5 @
.gg@ A
	AvailableggA J
)ggJ K
{hh 	
tryjj 
{kk 
IsBusyll 
=ll 
truell 
;ll 
ifnn 
(nn 
_userServicenn  
.nn  !
CurrentUsernn! ,
?nn, -
.nn- .
Idnn. 0
==nn1 3
nullnn4 8
)nn8 9
returnnn: @
;nn@ A
varpp 
ticketIdpp 
=pp 
awaitpp $"
_ticketCreationServicepp% ;
.pp; <%
CreateTicketForTableAsyncpp< U
(ppU V
tableppV [
.pp[ \
Idpp\ ^
,pp^ _
_userServicepp` l
.ppl m
CurrentUserppm x
.ppx y
Idppy {
)pp{ |
;pp| }
_navigationServicerr "
.rr" #
Navigaterr# +
(rr+ ,
typeofrr, 2
(rr2 3
OrderEntryPagerr3 A
)rrA B
,rrB C
newrrD G'
OrderEntryNavigationContextrrH c
(rrc d
ticketIdrrd l
,rrl m
truerrn r
)rrr s
)rrs t
;rrt u
}ss 
catchtt 
(tt 
	Exceptiontt 
extt 
)tt  
{uu 
Systemvv 
.vv 
Diagnosticsvv "
.vv" #
Debugvv# (
.vv( )
	WriteLinevv) 2
(vv2 3
$"vv3 5
$strvv5 \
{vv\ ]
exvv] _
.vv_ `
Messagevv` g
}vvg h
"vvh i
)vvi j
;vvj k
}ww 
finallyxx 
{yy 
IsBusyzz 
=zz 
falsezz 
;zz 
}{{ 
}|| 	
}}} 
}~~ “Ý
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\TableDesignerViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class "
TableDesignerViewModel +
:, -
ViewModelBase. ;
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly "
ITableLayoutRepository +"
_tableLayoutRepository, B
;B C
private 
readonly 
IDialogService #
_dialogService$ 2
;2 3
private 
readonly 
IFloorRepository %
_floorRepository& 6
;6 7
[ 
ObservableProperty 
] 
private  
ObservableCollection  
<  !
TableDto! )
>) *
_tables+ 2
=3 4
new5 8
(8 9
)9 :
;: ;
[ 
ObservableProperty 
] 
private    
ObservableCollection    
<    !
FloorDto  ! )
>  ) *
_floors  + 2
=  3 4
new  5 8
(  8 9
)  9 :
;  : ;
["" 
ObservableProperty"" 
]"" 
private## 
FloorDto## 
?## 
_selectedFloor## $
;##$ %
[%% 
ObservableProperty%% 
]%% 
private&& 
TableShapeType&& 
_selectedShape&& )
=&&* +
TableShapeType&&, :
.&&: ;
	Rectangle&&; D
;&&D E
[(( 
ObservableProperty(( 
](( 
private)) 
bool)) 
_isDesignMode)) 
=))  
true))! %
;))% &
[++ 
ObservableProperty++ 
]++ 
private,, 
string,, 
_layoutName,, 
=,,  
string,,! '
.,,' (
Empty,,( -
;,,- .
private// 
Guid// 
?// 
_currentLayoutId// "
;//" #
[11 
ObservableProperty11 
]11 
private22 
bool22 
_isDirty22 
;22 
[44 
ObservableProperty44 
]44 
private55 
bool55 
_isDraftMode55 
=55 
true55  $
;55$ %
[77 
ObservableProperty77 
]77 
private88 
TableDto88 
?88 
_selectedTable88 $
;88$ %
[:: 
ObservableProperty:: 
]:: 
private;; 
bool;; 
_isBusy;; 
;;; 
[== 
ObservableProperty== 
]== 
private>> 
bool>> 
_isRendering>> 
;>> 
[@@ 
ObservableProperty@@ 
]@@ 
privateAA 
intAA 
_currentFPSAA 
;AA 
[CC 
ObservablePropertyCC 
]CC 
privateDD 
DateTimeDD 
_lastRenderTimeDD $
;DD$ %
[FF 
ObservablePropertyFF 
]FF 
privateGG 
intGG 
_visibleTableCountGG "
;GG" #
[II 
ObservablePropertyII 
]II 
privateJJ 
intJJ 
_canvasWidthJJ 
=JJ 
$numJJ #
;JJ# $
[LL 
ObservablePropertyLL 
]LL 
privateMM 
intMM 
_canvasHeightMM 
=MM 
$numMM  $
;MM$ %
[OO 
ObservablePropertyOO 
]OO 
privatePP 
stringPP 
_backgroundColorPP #
=PP$ %
$strPP& /
;PP/ 0
[RR 
ObservablePropertyRR 
]RR 
privateSS  
ObservableCollectionSS  
<SS  !
TableDtoSS! )
>SS) *
_visibleTablesSS+ 9
=SS: ;
newSS< ?
(SS? @
)SS@ A
;SSA B
privateUU 
RectUU 
	_viewportUU 
=UU 
RectUU !
.UU! "
EmptyUU" '
;UU' (
privateVV 
readonlyVV 
objectVV 
_renderLockVV '
=VV( )
newVV* -
objectVV. 4
(VV4 5
)VV5 6
;VV6 7
privateWW 
boolWW $
_isVirtualizationEnabledWW )
=WW* +
trueWW, 0
;WW0 1
publicYY 

IRelayCommandYY 
<YY 
PointYY 
>YY 
AddTableCommandYY  /
{YY0 1
getYY2 5
;YY5 6
}YY7 8
publicZZ 

IRelayCommandZZ 
<ZZ 
TableDtoZZ !
>ZZ! "
DeleteTableCommandZZ# 5
{ZZ6 7
getZZ8 ;
;ZZ; <
}ZZ= >
public[[ 

IRelayCommand[[ 
SaveLayoutCommand[[ *
{[[+ ,
get[[- 0
;[[0 1
}[[2 3
public\\ 

IRelayCommand\\ 
LoadLayoutCommand\\ *
{\\+ ,
get\\- 0
;\\0 1
}\\2 3
public]] 

IRelayCommand]] 
<]] 
TableDto]] !
>]]! "
StartDragCommand]]# 3
{]]4 5
get]]6 9
;]]9 :
}]]; <
public^^ 

IRelayCommand^^ 
<^^ 
TableDto^^ !
>^^! "
SelectTableCommand^^# 5
{^^6 7
get^^8 ;
;^^; <
}^^= >
public__ 

IRelayCommand__ #
ToggleDesignModeCommand__ 0
{__1 2
get__3 6
;__6 7
}__8 9
public`` 

IRelayCommand`` 
<`` 
TableDto`` !
>``! "&
UpdateTablePositionCommand``# =
{``> ?
get``@ C
;``C D
}``E F
publicaa 

IRelayCommandaa !
DiscardChangesCommandaa .
{aa/ 0
getaa1 4
;aa4 5
}aa6 7
publiccc 
"
TableDesignerViewModelcc !
(cc! "
	IMediatordd 
mediatordd 
,dd 
NavigationServiceee 
navigationServiceee +
,ee+ ,
ITableRepositoryff 
tableRepositoryff (
,ff( )"
ITableLayoutRepositoryhh !
tableLayoutRepositoryhh 4
,hh4 5
IDialogServiceii 
dialogServiceii $
,ii$ %
IFloorRepositoryjj 
floorRepositoryjj (
)jj( )
{kk 
	_mediatorll 
=ll 
mediatorll 
;ll 
_navigationServicemm 
=mm 
navigationServicemm .
;mm. /
_tableRepositorynn 
=nn 
tableRepositorynn *
;nn* +"
_tableLayoutRepositoryoo 
=oo  !
tableLayoutRepositoryoo! 6
;oo6 7
_dialogServicepp 
=pp 
dialogServicepp &
;pp& '
_floorRepositoryqq 
=qq 
floorRepositoryqq *
;qq* +
AddTableCommandss 
=ss 
newss 
AsyncRelayCommandss /
<ss/ 0
Pointss0 5
>ss5 6
(ss6 7
AddTableAsyncss7 D
)ssD E
;ssE F
DeleteTableCommandtt 
=tt 
newtt  
AsyncRelayCommandtt! 2
<tt2 3
TableDtott3 ;
>tt; <
(tt< =
DeleteTableAsynctt= M
)ttM N
;ttN O
SaveLayoutCommanduu 
=uu 
newuu 
AsyncRelayCommanduu  1
(uu1 2
SaveLayoutAsyncuu2 A
)uuA B
;uuB C
LoadLayoutCommandvv 
=vv 
newvv 
AsyncRelayCommandvv  1
(vv1 2
LoadLayoutAsyncvv2 A
)vvA B
;vvB C
StartDragCommandww 
=ww 
newww 
RelayCommandww +
<ww+ ,
TableDtoww, 4
>ww4 5
(ww5 6
	StartDragww6 ?
)ww? @
;ww@ A
SelectTableCommandxx 
=xx 
newxx  
RelayCommandxx! -
<xx- .
TableDtoxx. 6
>xx6 7
(xx7 8
SelectTablexx8 C
)xxC D
;xxD E#
ToggleDesignModeCommandyy 
=yy  !
newyy" %
RelayCommandyy& 2
(yy2 3
ToggleDesignModeyy3 C
)yyC D
;yyD E&
UpdateTablePositionCommandzz "
=zz# $
newzz% (
AsyncRelayCommandzz) :
<zz: ;
TableDtozz; C
>zzC D
(zzD E$
UpdateTablePositionAsynczzE ]
)zz] ^
;zz^ _!
DiscardChangesCommand{{ 
={{ 
new{{  #
AsyncRelayCommand{{$ 5
({{5 6
DiscardChangesAsync{{6 I
){{I J
;{{J K
Title}} 
=}} 
$str}}  
;}}  !
}~~ 
public
€€ 

async
€€ 
Task
€€ 
LoadDataAsync
€€ #
(
€€# $
)
€€$ %
{
 
if
‚‚ 

(
‚‚ 
IsBusy
‚‚ 
)
‚‚ 
return
‚‚ 
;
‚‚ 
IsBusy
ƒƒ 
=
ƒƒ 
true
ƒƒ 
;
ƒƒ 
try
„„ 
{
…… 	
await
†† 
LoadFloorsAsync
†† !
(
††! "
)
††" #
;
††# $
await
‡‡ 
LoadTablesAsync
‡‡ !
(
‡‡! "
)
‡‡" #
;
‡‡# $
}
ˆˆ 	
finally
‰‰ 
{
ŠŠ 	
IsBusy
‹‹ 
=
‹‹ 
false
‹‹ 
;
‹‹ 
}
ŒŒ 	
}
 
private
 
async
 
Task
 
LoadFloorsAsync
 &
(
& '
)
' (
{
‘‘ 
IsBusy
’’ 
=
’’ 
true
’’ 
;
’’ 
try
““ 
{
”” 	
Floors
•• 
.
•• 
Clear
•• 
(
•• 
)
•• 
;
•• 
var
–– 
floors
–– 
=
–– 
await
–– 
_floorRepository
–– /
.
––/ 0
GetAllAsync
––0 ;
(
––; <
)
––< =
;
––= >
if
˜˜ 
(
˜˜ 
!
˜˜ 
floors
˜˜ 
.
˜˜ 
Any
˜˜ 
(
˜˜ 
)
˜˜ 
)
˜˜ 
{
™™ 
var
›› 
defaultFloor
››  
=
››! "
Magidesk
››# +
.
››+ ,
Domain
››, 2
.
››2 3
Entities
››3 ;
.
››; <
Floor
››< A
.
››A B
Create
››B H
(
››H I
$str
œœ  
,
œœ  !
$str
 )
,
) *
$num
žž 
,
žž 
$num
ŸŸ 
)
   
;
   
await
¢¢ 
_floorRepository
¢¢ &
.
¢¢& '
AddAsync
¢¢' /
(
¢¢/ 0
defaultFloor
¢¢0 <
)
¢¢< =
;
¢¢= >
floors
££ 
=
££ 
new
££ 
[
££ 
]
££ 
{
££  
defaultFloor
££! -
}
££. /
;
££/ 0
}
¤¤ 
foreach
¦¦ 
(
¦¦ 
var
¦¦ 
floor
¦¦ 
in
¦¦ !
floors
¦¦" (
)
¦¦( )
{
§§ 
Floors
¨¨ 
.
¨¨ 
Add
¨¨ 
(
¨¨ 
new
¨¨ 
FloorDto
¨¨ '
{
©© 
Id
ªª 
=
ªª 
floor
ªª 
.
ªª 
Id
ªª !
,
ªª! "
Name
«« 
=
«« 
floor
««  
.
««  !
Name
««! %
,
««% &
Description
¬¬ 
=
¬¬  !
floor
¬¬" '
.
¬¬' (
Description
¬¬( 3
,
¬¬3 4
Width
­­ 
=
­­ 
floor
­­ !
.
­­! "
Width
­­" '
,
­­' (
Height
®® 
=
®® 
floor
®® "
.
®®" #
Height
®®# )
,
®®) *
IsActive
¯¯ 
=
¯¯ 
floor
¯¯ $
.
¯¯$ %
IsActive
¯¯% -
,
¯¯- .
	CreatedAt
°° 
=
°° 
floor
°°  %
.
°°% &
	CreatedAt
°°& /
,
°°/ 0
	UpdatedAt
±± 
=
±± 
floor
±±  %
.
±±% &
	UpdatedAt
±±& /
,
±±/ 0
BackgroundColor
²² #
=
²²$ %
floor
²²& +
.
²²+ ,
BackgroundColor
²², ;
}
³³ 
)
³³ 
;
³³ 
}
´´ 
SelectedFloor
¶¶ 
=
¶¶ 
Floors
¶¶ "
.
¶¶" #
FirstOrDefault
¶¶# 1
(
¶¶1 2
)
¶¶2 3
;
¶¶3 4
_currentLayoutId
·· 
=
·· 
null
·· #
;
··# $
}
¸¸ 	
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹ 
{
ºº 	
await
»» 
ShowErrorAsync
»»  
(
»»  !
$"
»»! #
$str
»»# 9
{
»»9 :
ex
»»: <
.
»»< =
Message
»»= D
}
»»D E
"
»»E F
)
»»F G
;
»»G H
}
¼¼ 	
finally
½½ 
{
¾¾ 	
IsBusy
¿¿ 
=
¿¿ 
false
¿¿ 
;
¿¿ 
}
ÀÀ 	
}
ÁÁ 
private
ÃÃ 
async
ÃÃ 
Task
ÃÃ 
LoadTablesAsync
ÃÃ &
(
ÃÃ& '
)
ÃÃ' (
{
ÄÄ 
if
ÅÅ 

(
ÅÅ 
SelectedFloor
ÅÅ 
==
ÅÅ 
null
ÅÅ !
)
ÅÅ! "
return
ÅÅ# )
;
ÅÅ) *
var
ÉÉ 
activeTables
ÉÉ 
=
ÉÉ 
await
ÉÉ  
_tableRepository
ÉÉ! 1
.
ÉÉ1 2
GetActiveAsync
ÉÉ2 @
(
ÉÉ@ A
)
ÉÉA B
;
ÉÉB C
Tables
ÊÊ 
.
ÊÊ 
Clear
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
foreach
ÌÌ 
(
ÌÌ 
var
ÌÌ 
table
ÌÌ 
in
ÌÌ 
activeTables
ÌÌ *
)
ÌÌ* +
{
ÍÍ 	
Tables
ÎÎ 
.
ÎÎ 
Add
ÎÎ 
(
ÎÎ 
new
ÎÎ 
TableDto
ÎÎ #
{
ÏÏ 
Id
ÐÐ 
=
ÐÐ 
table
ÐÐ 
.
ÐÐ 
Id
ÐÐ 
,
ÐÐ 
TableNumber
ÑÑ 
=
ÑÑ 
table
ÑÑ #
.
ÑÑ# $
TableNumber
ÑÑ$ /
,
ÑÑ/ 0
Capacity
ÒÒ 
=
ÒÒ 
table
ÒÒ  
.
ÒÒ  !
Capacity
ÒÒ! )
,
ÒÒ) *
X
ÓÓ 
=
ÓÓ 
table
ÓÓ 
.
ÓÓ 
X
ÓÓ 
,
ÓÓ 
Y
ÔÔ 
=
ÔÔ 
table
ÔÔ 
.
ÔÔ 
Y
ÔÔ 
,
ÔÔ 
Status
ÕÕ 
=
ÕÕ 
table
ÕÕ 
.
ÕÕ 
Status
ÕÕ %
,
ÕÕ% &
IsActive
ÖÖ 
=
ÖÖ 
table
ÖÖ  
.
ÖÖ  !
IsActive
ÖÖ! )
}
×× 
)
×× 
;
×× 
}
ØØ 	
IsDirty
ÙÙ 
=
ÙÙ 
false
ÙÙ 
;
ÙÙ 
}
ÚÚ 
private
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
AddTableAsync
ÜÜ $
(
ÜÜ$ %
Point
ÜÜ% *
position
ÜÜ+ 3
)
ÜÜ3 4
{
ÝÝ 
if
ÞÞ 

(
ÞÞ 
!
ÞÞ 
IsDesignMode
ÞÞ 
)
ÞÞ 
return
ÞÞ !
;
ÞÞ! "
var
àà 
nextTableNumber
àà 
=
àà 
Tables
àà $
.
àà$ %
Count
àà% *
>
àà+ ,
$num
àà- .
?
àà/ 0
Tables
àà1 7
.
àà7 8
Max
àà8 ;
(
àà; <
t
àà< =
=>
àà> @
t
ààA B
.
ààB C
TableNumber
ààC N
)
ààN O
+
ààP Q
$num
ààR S
:
ààT U
$num
ààV W
;
ààW X
var
ââ 
command
ââ 
=
ââ 
new
ââ %
AddTableToLayoutCommand
ââ 1
(
ââ1 2
_currentLayoutId
ãã 
??
ãã 
Guid
ãã  $
.
ãã$ %
NewGuid
ãã% ,
(
ãã, -
)
ãã- .
,
ãã. /
nextTableNumber
ää 
,
ää 
$num
åå 
,
åå 
position
ææ 
.
ææ 
X
ææ 
,
ææ 
position
çç 
.
çç 
Y
çç 
,
çç 
SelectedShape
èè 
)
éé 	
;
éé	 

try
ëë 
{
ìì 	
var
íí 
newTable
íí 
=
íí 
await
íí  
	_mediator
íí! *
.
íí* +
Send
íí+ /
(
íí/ 0
command
íí0 7
)
íí7 8
;
íí8 9
Tables
îî 
.
îî 
Add
îî 
(
îî 
newTable
îî 
)
îî  
;
îî  !
}
ïï 	
catch
ðð 
(
ðð 
	Exception
ðð 
ex
ðð 
)
ðð 
{
òò 	
await
óó 
ShowErrorAsync
óó !
(
óó! "
$"
óó" $
$str
óó$ 8
{
óó8 9
ex
óó9 ;
.
óó; <
Message
óó< C
}
óóC D
"
óóD E
)
óóE F
;
óóF G
}
ôô 	
}
õõ 
private
÷÷ 
async
÷÷ 
Task
÷÷ 
DeleteTableAsync
÷÷ '
(
÷÷' (
TableDto
÷÷( 0
?
÷÷0 1
table
÷÷2 7
)
÷÷7 8
{
øø 
if
ùù 

(
ùù 
table
ùù 
==
ùù 
null
ùù 
||
ùù 
!
ùù 
IsDesignMode
ùù *
)
ùù* +
return
ùù, 2
;
ùù2 3
try
ûû 
{
üü 	
if
þþ 
(
þþ 
table
þþ 
.
þþ 
Status
þþ 
!=
þþ 
TableStatus
þþ  +
.
þþ+ ,
	Available
þþ, 5
)
þþ5 6
{
ÿÿ 
await
€€ 
ShowErrorAsync
€€ $
(
€€$ %
$"
€€% '
$str
€€' ;
{
€€; <
table
€€< A
.
€€A B
TableNumber
€€B M
}
€€M N
$str
€€N g
{
€€g h
table
€€h m
.
€€m n
Status
€€n t
}
€€t u
$str€€u ”
"€€” •
)€€• –
;€€– —
return
 
;
 
}
‚‚ 
var
…… 
	confirmed
…… 
=
…… 
await
…… !#
ShowConfirmationAsync
……" 7
(
……7 8
$"
……8 :
$str
……: G
{
……G H
table
……H M
.
……M N
TableNumber
……N Y
}
……Y Z
$str
……Z [
"
……[ \
,
……\ ]
$str
†† [
)
††[ \
;
††\ ]
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
	confirmed
ˆˆ 
)
ˆˆ 
return
ˆˆ "
;
ˆˆ" #
Tables
ŠŠ 
.
ŠŠ 
Remove
ŠŠ 
(
ŠŠ 
table
ŠŠ 
)
ŠŠ  
;
ŠŠ  !
}
ŽŽ 	
catch
 
(
 
	Exception
 
ex
 
)
 
{
 	
await
‘‘ 
ShowErrorAsync
‘‘  
(
‘‘  !
$"
‘‘! #
$str
‘‘# 9
{
‘‘9 :
ex
‘‘: <
.
‘‘< =
Message
‘‘= D
}
‘‘D E
"
‘‘E F
)
‘‘F G
;
‘‘G H
}
’’ 	
}
““ 
private
•• 
async
•• 
Task
•• 
<
•• 
bool
•• 
>
•• &
UpdateTablePositionAsync
•• 5
(
••5 6
TableDto
••6 >
?
••> ?
table
••@ E
)
••E F
{
–– 
if
—— 

(
—— 
table
—— 
==
—— 
null
—— 
||
—— 
!
—— 
IsDesignMode
—— *
)
——* +
return
——, 2
false
——3 8
;
——8 9
if
šš 

(
šš 
table
šš 
.
šš 
Status
šš 
!=
šš 
TableStatus
šš '
.
šš' (
	Available
šš( 1
)
šš1 2
{
›› 	
await
œœ 
ShowErrorAsync
œœ  
(
œœ  !
$"
œœ! #
$str
œœ# 5
{
œœ5 6
table
œœ6 ;
.
œœ; <
TableNumber
œœ< G
}
œœG H
$str
œœH a
{
œœa b
table
œœb g
.
œœg h
Status
œœh n
}
œœn o
$strœœo ‚
"œœ‚ ƒ
)œœƒ „
;œœ„ …
await
 
LoadTablesAsync
 !
(
! "
)
" #
;
# $
return
žž 
false
žž 
;
žž 
}
ŸŸ 	
try
¡¡ 
{
¢¢ 	
var
¤¤ 
maxX
¤¤ 
=
¤¤ 
SelectedFloor
¤¤ $
?
¤¤$ %
.
¤¤% &
Width
¤¤& +
??
¤¤, .
$num
¤¤/ 3
;
¤¤3 4
var
¥¥ 
maxY
¥¥ 
=
¥¥ 
SelectedFloor
¥¥ $
?
¥¥$ %
.
¥¥% &
Height
¥¥& ,
??
¥¥- /
$num
¥¥0 4
;
¥¥4 5
if
§§ 
(
§§ 
table
§§ 
.
§§ 
X
§§ 
<
§§ 
$num
§§ 
||
§§ 
table
§§ $
.
§§$ %
Y
§§% &
<
§§' (
$num
§§) *
||
§§+ -
table
§§. 3
.
§§3 4
X
§§4 5
>
§§6 7
maxX
§§8 <
-
§§= >
$num
§§? B
||
§§C E
table
§§F K
.
§§K L
Y
§§L M
>
§§N O
maxY
§§P T
-
§§U V
$num
§§W Z
)
§§Z [
{
¨¨ 
table
ªª 
.
ªª 
X
ªª 
=
ªª 
Math
ªª 
.
ªª 
Max
ªª "
(
ªª" #
$num
ªª# $
,
ªª$ %
Math
ªª& *
.
ªª* +
Min
ªª+ .
(
ªª. /
maxX
ªª/ 3
-
ªª4 5
$num
ªª6 9
,
ªª9 :
table
ªª; @
.
ªª@ A
X
ªªA B
)
ªªB C
)
ªªC D
;
ªªD E
table
«« 
.
«« 
Y
«« 
=
«« 
Math
«« 
.
«« 
Max
«« "
(
««" #
$num
««# $
,
««$ %
Math
««& *
.
««* +
Min
««+ .
(
««. /
maxY
««/ 3
-
««4 5
$num
««6 9
,
««9 :
table
««; @
.
««@ A
Y
««A B
)
««B C
)
««C D
;
««D E
return
¬¬ 
false
¬¬ 
;
¬¬ 
}
­­ 
var
°° 
overlappingTable
°°  
=
°°! "
Tables
°°# )
.
°°) *
FirstOrDefault
°°* 8
(
°°8 9
t
°°9 :
=>
°°; =
t
±± 
.
±± 
Id
±± 
!=
±± 
table
±± 
.
±± 
Id
±±  
&&
±±! #
Math
²² 
.
²² 
Abs
²² 
(
²² 
t
²² 
.
²² 
X
²² 
-
²² 
table
²² $
.
²²$ %
X
²²% &
)
²²& '
<
²²( )
$num
²²* -
&&
²². 0
Math
³³ 
.
³³ 
Abs
³³ 
(
³³ 
t
³³ 
.
³³ 
Y
³³ 
-
³³ 
table
³³ $
.
³³$ %
Y
³³% &
)
³³& '
<
³³( )
$num
³³* -
)
³³- .
;
³³. /
if
µµ 
(
µµ 
overlappingTable
µµ  
!=
µµ! #
null
µµ$ (
)
µµ( )
{
¶¶ 
await
·· 
ShowErrorAsync
·· $
(
··$ %
$"
··% '
$str
··' -
{
··- .
table
··. 3
.
··3 4
TableNumber
··4 ?
}
··? @
$str
··@ U
{
··U V
overlappingTable
··V f
.
··f g
TableNumber
··g r
}
··r s
$str··s ˜
"··˜ ™
)··™ š
;··š ›
return
¸¸ 
false
¸¸ 
;
¸¸ 
}
¹¹ 
var
¼¼ 
oldX
¼¼ 
=
¼¼ 
table
¼¼ 
.
¼¼ 
X
¼¼ 
;
¼¼ 
var
½½ 
oldY
½½ 
=
½½ 
table
½½ 
.
½½ 
Y
½½ 
;
½½ 
var
ËË 
command
ËË 
=
ËË 
new
ËË (
UpdateTablePositionCommand
ËË 8
(
ËË8 9
table
ÌÌ 
.
ÌÌ 
Id
ÌÌ 
,
ÌÌ 
table
ÍÍ 
.
ÍÍ 
X
ÍÍ 
,
ÍÍ 
table
ÎÎ 
.
ÎÎ 
Y
ÎÎ 
,
ÎÎ 
table
ÏÏ 
.
ÏÏ 
Shape
ÏÏ 
,
ÏÏ 
table
ÐÐ 
.
ÐÐ 
Width
ÐÐ 
>
ÐÐ 
$num
ÐÐ 
?
ÐÐ  !
table
ÐÐ" '
.
ÐÐ' (
Width
ÐÐ( -
:
ÐÐ. /
$num
ÐÐ0 3
,
ÐÐ3 4
table
ÑÑ 
.
ÑÑ 
Height
ÑÑ 
>
ÑÑ 
$num
ÑÑ  
?
ÑÑ! "
table
ÑÑ# (
.
ÑÑ( )
Height
ÑÑ) /
:
ÑÑ0 1
$num
ÑÑ2 5
)
ÒÒ 
;
ÒÒ 
try
ÔÔ 
{
ÕÕ 
await
ÖÖ 
	_mediator
ÖÖ 
.
ÖÖ  
Send
ÖÖ  $
(
ÖÖ$ %
command
ÖÖ% ,
)
ÖÖ, -
;
ÖÖ- .
return
×× 
true
×× 
;
×× 
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ 
await
ææ 
ShowErrorAsync
ææ $
(
ææ$ %
$"
ææ% '
$str
ææ' F
{
ææF G
ex
ææG I
.
ææI J
Message
ææJ Q
}
ææQ R
$str
ææR g
"
ææg h
)
ææh i
;
ææi j
await
çç 
LoadTablesAsync
çç %
(
çç% &
)
çç& '
;
çç' (
return
èè 
false
èè 
;
èè 
}
éé 
}
êê 	
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë 
{
ìì 	
await
íí 
ShowErrorAsync
íí  
(
íí  !
$"
íí! #
$str
íí# G
{
ííG H
ex
ííH J
.
ííJ K
Message
ííK R
}
ííR S
"
ííS T
)
ííT U
;
ííU V
return
îî 
false
îî 
;
îî 
}
ïï 	
}
ðð 
private
òò 
async
òò 
Task
òò 
SaveLayoutAsync
òò &
(
òò& '
)
òò' (
{
óó 
if
ôô 

(
ôô 
string
ôô 
.
ôô  
IsNullOrWhiteSpace
ôô %
(
ôô% &

LayoutName
ôô& 0
)
ôô0 1
)
ôô1 2
{
õõ 	
await
öö 
ShowErrorAsync
öö  
(
öö  !
$str
öö! L
)
ööL M
;
ööM N
return
÷÷ 
;
÷÷ 
}
øø 	
if
úú 

(
úú 
!
úú 
Tables
úú 
.
úú 
Any
úú 
(
úú 
)
úú 
)
úú 
{
ûû 	
await
üü 
ShowErrorAsync
üü  
(
üü  !
$str
üü! U
)
üüU V
;
üüV W
return
ýý 
;
ýý 
}
þþ 	
IsBusy
€€ 
=
€€ 
true
€€ 
;
€€ 
try
 
{
‚‚ 	
var
„„ 
isUnique
„„ 
=
„„ 
await
„„  $
_tableLayoutRepository
„„! 7
.
„„7 8%
IsLayoutNameUniqueAsync
„„8 O
(
„„O P

LayoutName
„„P Z
,
„„Z [
_currentLayoutId
„„\ l
)
„„l m
;
„„m n
if
…… 
(
…… 
!
…… 
isUnique
…… 
)
…… 
{
†† 
await
‡‡ 
ShowErrorAsync
‡‡ $
(
‡‡$ %
$"
‡‡% '
$str
‡‡' 4
{
‡‡4 5

LayoutName
‡‡5 ?
}
‡‡? @
$str
‡‡@ q
"
‡‡q r
)
‡‡r s
;
‡‡s t
return
ˆˆ 
;
ˆˆ 
}
‰‰ 
if
‹‹ 
(
‹‹ 
_currentLayoutId
‹‹  
.
‹‹  !
HasValue
‹‹! )
)
‹‹) *
{
ŒŒ 
var
ŽŽ 
command
ŽŽ 
=
ŽŽ 
new
ŽŽ !$
SaveTableLayoutCommand
ŽŽ" 8
(
ŽŽ8 9
_currentLayoutId
 $
.
$ %
Value
% *
,
* +

LayoutName
 
,
 
Tables
‘‘ 
.
‘‘ 
ToList
‘‘ !
(
‘‘! "
)
‘‘" #
,
‘‘# $
IsDraftMode
’’ 
)
““ 
;
““ 
await
”” 
	_mediator
”” 
.
””  
Send
””  $
(
””$ %
command
””% ,
)
””, -
;
””- .
await
•• 
ShowSuccessAsync
•• &
(
••& '
$"
••' )
$str
••) 1
{
••1 2

LayoutName
••2 <
}
••< =
$str
••= T
"
••T U
)
••U V
;
••V W
}
–– 
else
—— 
{
˜˜ 
var
šš 
newLayoutId
šš 
=
šš  !
Guid
šš" &
.
šš& '
NewGuid
šš' .
(
šš. /
)
šš/ 0
;
šš0 1
var
›› 
command
›› 
=
›› 
new
›› !&
CreateTableLayoutCommand
››" :
(
››: ;

LayoutName
œœ 
,
œœ 
SelectedFloor
 !
?
! "
.
" #
Id
# %
??
& (
Guid
) -
.
- .
NewGuid
. 5
(
5 6
)
6 7
,
7 8
Tables
žž 
.
žž 
ToList
žž !
(
žž! "
)
žž" #
,
žž# $
IsDraftMode
ŸŸ 
)
   
;
   
var
¢¢ 
createdLayout
¢¢ !
=
¢¢" #
await
¢¢$ )
	_mediator
¢¢* 3
.
¢¢3 4
Send
¢¢4 8
(
¢¢8 9
command
¢¢9 @
)
¢¢@ A
;
¢¢A B
_currentLayoutId
££  
=
££! "
createdLayout
££# 0
.
££0 1
Id
££1 3
;
££3 4
await
¤¤ 
ShowSuccessAsync
¤¤ &
(
¤¤& '
$"
¤¤' )
$str
¤¤) 1
{
¤¤1 2

LayoutName
¤¤2 <
}
¤¤< =
$str
¤¤= T
"
¤¤T U
)
¤¤U V
;
¤¤V W
}
¥¥ 
IsDirty
§§ 
=
§§ 
false
§§ 
;
§§ 
}
«« 	
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬ 
{
­­ 	
await
®® 
ShowErrorAsync
®®  
(
®®  !
$"
®®! #
$str
®®# 8
{
®®8 9
ex
®®9 ;
.
®®; <
Message
®®< C
}
®®C D
"
®®D E
)
®®E F
;
®®F G
}
¯¯ 	
finally
°° 
{
±± 	
IsBusy
²² 
=
²² 
false
²² 
;
²² 
}
³³ 	
}
´´ 
private
¶¶ 
async
¶¶ 
Task
¶¶ 
LoadLayoutAsync
¶¶ &
(
¶¶& '
)
¶¶' (
{
·· 
IsBusy
¸¸ 
=
¸¸ 
true
¸¸ 
;
¸¸ 
try
¹¹ 
{
ºº 	
await
»» 
LoadFloorsAsync
»» !
(
»»! "
)
»»" #
;
»»# $
await
¼¼ 
LoadTablesAsync
¼¼ !
(
¼¼! "
)
¼¼" #
;
¼¼# $
if
¿¿ 
(
¿¿ 
SelectedFloor
¿¿ 
!=
¿¿  
null
¿¿! %
)
¿¿% &
{
ÀÀ 
var
ÁÁ 
layouts
ÁÁ 
=
ÁÁ 
await
ÁÁ #$
_tableLayoutRepository
ÁÁ$ :
.
ÁÁ: ;$
GetLayoutsByFloorAsync
ÁÁ; Q
(
ÁÁQ R
SelectedFloor
ÁÁR _
.
ÁÁ_ `
Id
ÁÁ` b
)
ÁÁb c
;
ÁÁc d
var
ÃÃ 
activeLayout
ÃÃ  
=
ÃÃ! "
layouts
ÃÃ# *
.
ÃÃ* +
FirstOrDefault
ÃÃ+ 9
(
ÃÃ9 :
l
ÃÃ: ;
=>
ÃÃ< >
l
ÃÃ? @
.
ÃÃ@ A
IsActive
ÃÃA I
)
ÃÃI J
??
ÃÃK M
layouts
ÃÃN U
.
ÃÃU V
FirstOrDefault
ÃÃV d
(
ÃÃd e
)
ÃÃe f
;
ÃÃf g
if
ÅÅ 
(
ÅÅ 
activeLayout
ÅÅ  
!=
ÅÅ! #
null
ÅÅ$ (
)
ÅÅ( )
{
ÆÆ 

LayoutName
ÇÇ 
=
ÇÇ  
activeLayout
ÇÇ! -
.
ÇÇ- .
Name
ÇÇ. 2
;
ÇÇ2 3
_currentLayoutId
ÈÈ $
=
ÈÈ% &
activeLayout
ÈÈ' 3
.
ÈÈ3 4
Id
ÈÈ4 6
;
ÈÈ6 7
_isDraftMode
ÉÉ  
=
ÉÉ! "
activeLayout
ÉÉ# /
.
ÉÉ/ 0
IsDraft
ÉÉ0 7
;
ÉÉ7 8
OnPropertyChanged
ÊÊ %
(
ÊÊ% &
nameof
ÊÊ& ,
(
ÊÊ, -
IsDraftMode
ÊÊ- 8
)
ÊÊ8 9
)
ÊÊ9 :
;
ÊÊ: ;
Tables
ÌÌ 
.
ÌÌ 
Clear
ÌÌ  
(
ÌÌ  !
)
ÌÌ! "
;
ÌÌ" #
foreach
ÎÎ 
(
ÎÎ 
var
ÎÎ  
tableDto
ÎÎ! )
in
ÎÎ* ,
activeLayout
ÎÎ- 9
.
ÎÎ9 :
Tables
ÎÎ: @
)
ÎÎ@ A
{
ÏÏ 
Tables
ÐÐ 
.
ÐÐ 
Add
ÐÐ "
(
ÐÐ" #
tableDto
ÐÐ# +
)
ÐÐ+ ,
;
ÐÐ, -
}
ÑÑ 
}
ÒÒ 
else
ÓÓ 
{
ÔÔ 
_currentLayoutId
ÖÖ $
=
ÖÖ% &
null
ÖÖ' +
;
ÖÖ+ ,

LayoutName
×× 
=
××  
string
××! '
.
××' (
Empty
××( -
;
××- .
}
ØØ 
}
ÙÙ 
}
ÚÚ 	
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ 
{
ÜÜ 	
await
ÝÝ 
ShowErrorAsync
ÝÝ  
(
ÝÝ  !
$"
ÝÝ! #
$str
ÝÝ# 9
{
ÝÝ9 :
ex
ÝÝ: <
.
ÝÝ< =
Message
ÝÝ= D
}
ÝÝD E
"
ÝÝE F
)
ÝÝF G
;
ÝÝG H
}
ÞÞ 	
finally
ßß 
{
àà 	
IsBusy
áá 
=
áá 
false
áá 
;
áá 
}
ââ 	
}
ãã 
public
ææ 

async
ææ 
Task
ææ 
<
ææ 
bool
ææ 
>
ææ '
TestBasicDesignerWorkflow
ææ 5
(
ææ5 6
)
ææ6 7
{
çç 
try
èè 
{
éé 	

LayoutName
ëë 
=
ëë 
$str
ëë &
;
ëë& '
await
ìì 
AddTableAsync
ìì 
(
ìì  
new
ìì  #
Point
ìì$ )
(
ìì) *
$num
ìì* -
,
ìì- .
$num
ìì/ 2
)
ìì2 3
)
ìì3 4
;
ìì4 5
await
íí 
AddTableAsync
íí 
(
íí  
new
íí  #
Point
íí$ )
(
íí) *
$num
íí* -
,
íí- .
$num
íí/ 2
)
íí2 3
)
íí3 4
;
íí4 5
await
îî 
AddTableAsync
îî 
(
îî  
new
îî  #
Point
îî$ )
(
îî) *
$num
îî* -
,
îî- .
$num
îî/ 2
)
îî2 3
)
îî3 4
;
îî4 5
await
ññ 
SaveLayoutAsync
ññ !
(
ññ! "
)
ññ" #
;
ññ# $
await
ôô 
LoadLayoutAsync
ôô !
(
ôô! "
)
ôô" #
;
ôô# $
if
÷÷ 
(
÷÷ 
Tables
÷÷ 
.
÷÷ 
Count
÷÷ 
!=
÷÷ 
$num
÷÷  !
)
÷÷! "
{
øø 
await
ùù 
ShowErrorAsync
ùù $
(
ùù$ %
$"
ùù% '
$str
ùù' D
{
ùùD E
Tables
ùùE K
.
ùùK L
Count
ùùL Q
}
ùùQ R
"
ùùR S
)
ùùS T
;
ùùT U
return
úú 
false
úú 
;
úú 
}
ûû 
var
þþ 
tableToDelete
þþ 
=
þþ 
Tables
þþ  &
.
þþ& '
FirstOrDefault
þþ' 5
(
þþ5 6
)
þþ6 7
;
þþ7 8
if
ÿÿ 
(
ÿÿ 
tableToDelete
ÿÿ 
!=
ÿÿ  
null
ÿÿ! %
)
ÿÿ% &
{
€€ 
await
 
DeleteTableAsync
 &
(
& '
tableToDelete
' 4
)
4 5
;
5 6
}
‚‚ 
if
…… 
(
…… 
Tables
…… 
.
…… 
Count
…… 
!=
…… 
$num
……  !
)
……! "
{
†† 
await
‡‡ 
ShowErrorAsync
‡‡ $
(
‡‡$ %
$"
‡‡% '
$str
‡‡' S
{
‡‡S T
Tables
‡‡T Z
.
‡‡Z [
Count
‡‡[ `
}
‡‡` a
"
‡‡a b
)
‡‡b c
;
‡‡c d
return
ˆˆ 
false
ˆˆ 
;
ˆˆ 
}
‰‰ 
await
‹‹ 
ShowSuccessAsync
‹‹ "
(
‹‹" #
$str
‹‹# I
)
‹‹I J
;
‹‹J K
return
ŒŒ 
true
ŒŒ 
;
ŒŒ 
}
 	
catch
ŽŽ 
(
ŽŽ 
	Exception
ŽŽ 
ex
ŽŽ 
)
ŽŽ 
{
 	
await
 
ShowErrorAsync
  
(
  !
$"
! #
$str
# 0
{
0 1
ex
1 3
.
3 4
Message
4 ;
}
; <
"
< =
)
= >
;
> ?
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 	
}
““ 
public
•• 

async
•• 
Task
•• 
<
•• 
bool
•• 
>
•• *
TestDragAndDropFunctionality
•• 8
(
••8 9
)
••9 :
{
–– 
try
—— 
{
˜˜ 	
var
šš 
	testTable
šš 
=
šš 
new
šš 
TableDto
šš  (
{
›› 
Id
œœ 
=
œœ 
Guid
œœ 
.
œœ 
NewGuid
œœ !
(
œœ! "
)
œœ" #
,
œœ# $
TableNumber
 
=
 
$num
 
,
  
Capacity
žž 
=
žž 
$num
žž 
,
žž 
X
ŸŸ 
=
ŸŸ 
$num
ŸŸ 
,
ŸŸ 
Y
   
=
   
$num
   
,
   
Status
¡¡ 
=
¡¡ 
TableStatus
¡¡ $
.
¡¡$ %
	Available
¡¡% .
,
¡¡. /
IsActive
¢¢ 
=
¢¢ 
true
¢¢ 
}
££ 
;
££ 
Tables
¤¤ 
.
¤¤ 
Add
¤¤ 
(
¤¤ 
	testTable
¤¤  
)
¤¤  !
;
¤¤! "
var
§§ 
newX
§§ 
=
§§ 
$num
§§ 
;
§§ 
var
¨¨ 
newY
¨¨ 
=
¨¨ 
$num
¨¨ 
;
¨¨ 
	testTable
«« 
.
«« 
X
«« 
=
«« 
newX
«« 
;
«« 
	testTable
¬¬ 
.
¬¬ 
Y
¬¬ 
=
¬¬ 
newY
¬¬ 
;
¬¬ 
if
¯¯ 
(
¯¯ 
	testTable
¯¯ 
.
¯¯ 
X
¯¯ 
!=
¯¯ 
newX
¯¯ #
||
¯¯$ &
	testTable
¯¯' 0
.
¯¯0 1
Y
¯¯1 2
!=
¯¯3 5
newY
¯¯6 :
)
¯¯: ;
{
°° 
await
±± 
ShowErrorAsync
±± $
(
±±$ %
$str
±±% L
)
±±L M
;
±±M N
return
²² 
false
²² 
;
²² 
}
³³ 
	testTable
¶¶ 
.
¶¶ 
X
¶¶ 
=
¶¶ 
-
¶¶ 
$num
¶¶ 
;
¶¶ 
	testTable
·· 
.
·· 
Y
·· 
=
·· 
-
·· 
$num
·· 
;
·· 
if
¹¹ 
(
¹¹ 
	testTable
¹¹ 
.
¹¹ 
X
¹¹ 
!=
¹¹ 
$num
¹¹  
||
¹¹! #
	testTable
¹¹$ -
.
¹¹- .
Y
¹¹. /
!=
¹¹0 2
$num
¹¹3 4
)
¹¹4 5
{
ºº 
await
»» 
ShowErrorAsync
»» $
(
»»$ %
$str
»»% B
)
»»B C
;
»»C D
return
¼¼ 
false
¼¼ 
;
¼¼ 
}
½½ 
var
ÀÀ 
overlappingTable
ÀÀ  
=
ÀÀ! "
new
ÀÀ# &
TableDto
ÀÀ' /
{
ÁÁ 
Id
ÂÂ 
=
ÂÂ 
Guid
ÂÂ 
.
ÂÂ 
NewGuid
ÂÂ !
(
ÂÂ! "
)
ÂÂ" #
,
ÂÂ# $
TableNumber
ÃÃ 
=
ÃÃ 
$num
ÃÃ 
,
ÃÃ  
Capacity
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
,
ÄÄ 
X
ÅÅ 
=
ÅÅ 
$num
ÅÅ 
,
ÅÅ 
Y
ÆÆ 
=
ÆÆ 
$num
ÆÆ 
,
ÆÆ 
Status
ÇÇ 
=
ÇÇ 
TableStatus
ÇÇ $
.
ÇÇ$ %
	Available
ÇÇ% .
,
ÇÇ. /
IsActive
ÈÈ 
=
ÈÈ 
true
ÈÈ 
}
ÉÉ 
;
ÉÉ 
Tables
ÊÊ 
.
ÊÊ 
Add
ÊÊ 
(
ÊÊ 
overlappingTable
ÊÊ '
)
ÊÊ' (
;
ÊÊ( )
var
ÍÍ 
updateResult
ÍÍ 
=
ÍÍ 
await
ÍÍ $&
UpdateTablePositionAsync
ÍÍ% =
(
ÍÍ= >
overlappingTable
ÍÍ> N
)
ÍÍN O
;
ÍÍO P
if
ÎÎ 
(
ÎÎ 
!
ÎÎ 
updateResult
ÎÎ 
)
ÎÎ 
{
ÏÏ 
}
ÑÑ 
await
ÓÓ 
ShowSuccessAsync
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# M
)
ÓÓM N
;
ÓÓN O
return
ÔÔ 
true
ÔÔ 
;
ÔÔ 
}
ÕÕ 	
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ 
{
×× 	
await
ØØ 
ShowErrorAsync
ØØ  
(
ØØ  !
$"
ØØ! #
$str
ØØ# >
{
ØØ> ?
ex
ØØ? A
.
ØØA B
Message
ØØB I
}
ØØI J
"
ØØJ K
)
ØØK L
;
ØØL M
return
ÙÙ 
false
ÙÙ 
;
ÙÙ 
}
ÚÚ 	
}
ÛÛ 
public
ÝÝ 

async
ÝÝ 
Task
ÝÝ 
<
ÝÝ 
bool
ÝÝ 
>
ÝÝ  
TestShapeSelection
ÝÝ .
(
ÝÝ. /
)
ÝÝ/ 0
{
ÞÞ 
try
ßß 
{
àà 	
var
ââ 
shapes
ââ 
=
ââ 
new
ââ 
[
ââ 
]
ââ 
{
ãã 
TableShapeType
ää 
.
ää 
	Rectangle
ää (
,
ää( )
TableShapeType
åå 
.
åå 
Square
åå %
,
åå% &
TableShapeType
ææ 
.
ææ 
Round
ææ $
,
ææ$ %
TableShapeType
çç 
.
çç 
Oval
çç #
}
èè 
;
èè 
foreach
êê 
(
êê 
var
êê 
shape
êê 
in
êê !
shapes
êê" (
)
êê( )
{
ëë 
SelectedShape
ìì 
=
ìì 
shape
ìì  %
;
ìì% &
await
ïï 
AddTableAsync
ïï #
(
ïï# $
new
ïï$ '
Point
ïï( -
(
ïï- .
$num
ïï. 1
+
ïï2 3
(
ïï4 5
int
ïï5 8
)
ïï8 9
shape
ïï9 >
*
ïï? @
$num
ïïA D
,
ïïD E
$num
ïïF I
)
ïïI J
)
ïïJ K
;
ïïK L
var
òò 
createdTable
òò  
=
òò! "
Tables
òò# )
.
òò) *
LastOrDefault
òò* 7
(
òò7 8
)
òò8 9
;
òò9 :
if
óó 
(
óó 
createdTable
óó  
==
óó! #
null
óó$ (
||
óó) +
createdTable
óó, 8
.
óó8 9
Shape
óó9 >
!=
óó? A
shape
óóB G
)
óóG H
{
ôô 
await
õõ 
ShowErrorAsync
õõ (
(
õõ( )
$"
õõ) +
$str
õõ+ F
{
õõF G
shape
õõG L
}
õõL M
"
õõM N
)
õõN O
;
õõO P
return
öö 
false
öö  
;
öö  !
}
÷÷ 
Tables
úú 
.
úú 
Remove
úú 
(
úú 
createdTable
úú *
)
úú* +
;
úú+ ,
}
ûû 
await
ýý 
ShowSuccessAsync
ýý "
(
ýý" #
$str
ýý# A
)
ýýA B
;
ýýB C
return
þþ 
true
þþ 
;
þþ 
}
ÿÿ 	
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€ 
{
 	
await
‚‚ 
ShowErrorAsync
‚‚  
(
‚‚  !
$"
‚‚! #
$str
‚‚# @
{
‚‚@ A
ex
‚‚A C
.
‚‚C D
Message
‚‚D K
}
‚‚K L
"
‚‚L M
)
‚‚M N
;
‚‚N O
return
ƒƒ 
false
ƒƒ 
;
ƒƒ 
}
„„ 	
}
…… 
private
‡‡ 
void
‡‡ 
	StartDrag
‡‡ 
(
‡‡ 
TableDto
‡‡ #
?
‡‡# $
table
‡‡% *
)
‡‡* +
{
ˆˆ 
if
‰‰ 

(
‰‰ 
table
‰‰ 
==
‰‰ 
null
‰‰ 
||
‰‰ 
!
‰‰ 
IsDesignMode
‰‰ *
)
‰‰* +
return
‰‰, 2
;
‰‰2 3
SelectedTable
ŠŠ 
=
ŠŠ 
table
ŠŠ 
;
ŠŠ 
}
‹‹ 
private
 
void
 
SelectTable
 
(
 
TableDto
 %
?
% &
table
' ,
)
, -
{
ŽŽ 
if
 

(
 
table
 
==
 
null
 
)
 
return
 !
;
! "
SelectedTable
 
=
 
table
 
;
 
}
‘‘ 
private
““ 
void
““ 
ToggleDesignMode
““ !
(
““! "
)
““" #
{
”” 
IsDesignMode
•• 
=
•• 
!
•• 
IsDesignMode
•• $
;
••$ %
}
–– 
private
˜˜ 
async
˜˜ 
Task
˜˜ !
DiscardChangesAsync
˜˜ *
(
˜˜* +
)
˜˜+ ,
{
™™ 
if
šš 

(
šš 
IsDirty
šš 
)
šš 
{
›› 	
var
œœ 
	confirmed
œœ 
=
œœ 
await
œœ !#
ShowConfirmationAsync
œœ" 7
(
œœ7 8
$str
œœ8 J
,
œœJ K
$str
 V
)
V W
;
W X
if
žž 
(
žž 
!
žž 
	confirmed
žž 
)
žž 
return
žž "
;
žž" #
}
ŸŸ 	
await
¡¡ 
LoadTablesAsync
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡  
}
¢¢ 
partial
¤¤ 
void
¤¤ $
OnSelectedFloorChanged
¤¤ '
(
¤¤' (
FloorDto
¤¤( 0
?
¤¤0 1
value
¤¤2 7
)
¤¤7 8
{
¥¥ 
if
¦¦ 

(
¦¦ 
value
¦¦ 
!=
¦¦ 
null
¦¦ 
&&
¦¦ 
!
¦¦ 
IsBusy
¦¦ $
)
¦¦$ %
{
§§ 	
_
¨¨ 
=
¨¨ 
LoadTablesAsync
¨¨ 
(
¨¨  
)
¨¨  !
;
¨¨! "
}
©© 	
}
ªª 
private
¬¬ 
int
¬¬  
GetNextTableNumber
¬¬ "
(
¬¬" #
)
¬¬# $
{
­­ 
return
®® 
Tables
®® 
.
®® 
Count
®® 
>
®® 
$num
®® 
?
®®  !
Tables
®®" (
.
®®( )
Max
®®) ,
(
®®, -
t
®®- .
=>
®®/ 1
t
®®2 3
.
®®3 4
TableNumber
®®4 ?
)
®®? @
+
®®A B
$num
®®C D
:
®®E F
$num
®®G H
;
®®H I
}
¯¯ 
private
±± 
async
±± 
Task
±± 
<
±± 
bool
±± 
>
±± #
ShowConfirmationAsync
±± 2
(
±±2 3
string
±±3 9
title
±±: ?
,
±±? @
string
±±A G
message
±±H O
)
±±O P
{
²² 
return
³³ 
await
³³ 
_dialogService
³³ #
.
³³# $#
ShowConfirmationAsync
³³$ 9
(
³³9 :
title
³³: ?
,
³³? @
message
³³A H
)
³³H I
;
³³I J
}
´´ 
private
¶¶ 
async
¶¶ 
Task
¶¶ 
ShowErrorAsync
¶¶ %
(
¶¶% &
string
¶¶& ,
message
¶¶- 4
)
¶¶4 5
{
·· 
await
¸¸ 
_dialogService
¸¸ 
.
¸¸ 
ShowErrorAsync
¸¸ +
(
¸¸+ ,
$str
¸¸, B
,
¸¸B C
message
¸¸D K
)
¸¸K L
;
¸¸L M
}
¹¹ 
private
»» 
async
»» 
Task
»» 
ShowSuccessAsync
»» '
(
»»' (
string
»»( .
message
»»/ 6
)
»»6 7
{
¼¼ 
await
½½ 
_dialogService
½½ 
.
½½ 
ShowMessageAsync
½½ -
(
½½- .
$str
½½. 7
,
½½7 8
message
½½9 @
)
½½@ A
;
½½A B
}
¾¾ 
public
ÁÁ 

void
ÁÁ !
UpdateVisibleTables
ÁÁ #
(
ÁÁ# $
Rect
ÁÁ$ (
viewport
ÁÁ) 1
)
ÁÁ1 2
{
ÂÂ 
if
ÃÃ 

(
ÃÃ 
!
ÃÃ &
_isVirtualizationEnabled
ÃÃ %
)
ÃÃ% &
{
ÄÄ 	
VisibleTables
ÅÅ 
=
ÅÅ 
new
ÅÅ "
ObservableCollection
ÅÅ  4
<
ÅÅ4 5
TableDto
ÅÅ5 =
>
ÅÅ= >
(
ÅÅ> ?
Tables
ÅÅ? E
)
ÅÅE F
;
ÅÅF G
VisibleTableCount
ÆÆ 
=
ÆÆ 
Tables
ÆÆ  &
.
ÆÆ& '
Count
ÆÆ' ,
;
ÆÆ, -
return
ÇÇ 
;
ÇÇ 
}
ÈÈ 	
lock
ÊÊ 
(
ÊÊ 
_renderLock
ÊÊ 
)
ÊÊ 
{
ËË 	
	_viewport
ÌÌ 
=
ÌÌ 
viewport
ÌÌ  
;
ÌÌ  !
var
ÏÏ 
padding
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
var
ÐÐ 
visibleBounds
ÐÐ 
=
ÐÐ 
new
ÐÐ  #
Rect
ÐÐ$ (
(
ÐÐ( )
viewport
ÑÑ 
.
ÑÑ 
X
ÑÑ 
-
ÑÑ 
padding
ÑÑ $
,
ÑÑ$ %
viewport
ÒÒ 
.
ÒÒ 
Y
ÒÒ 
-
ÒÒ 
padding
ÒÒ $
,
ÒÒ$ %
viewport
ÓÓ 
.
ÓÓ 
Width
ÓÓ 
+
ÓÓ  
(
ÓÓ! "
padding
ÓÓ" )
*
ÓÓ* +
$num
ÓÓ, -
)
ÓÓ- .
,
ÓÓ. /
viewport
ÔÔ 
.
ÔÔ 
Height
ÔÔ 
+
ÔÔ  !
(
ÔÔ" #
padding
ÔÔ# *
*
ÔÔ+ ,
$num
ÔÔ- .
)
ÔÔ. /
)
ÕÕ 
;
ÕÕ 
var
ØØ 
visibleTables
ØØ 
=
ØØ 
Tables
ØØ  &
.
ØØ& '
Where
ØØ' ,
(
ØØ, -
table
ØØ- 2
=>
ØØ3 5
IsTableVisible
ÙÙ 
(
ÙÙ 
table
ÙÙ $
,
ÙÙ$ %
visibleBounds
ÙÙ& 3
)
ÙÙ3 4
)
ÙÙ4 5
.
ÙÙ5 6
ToList
ÙÙ6 <
(
ÙÙ< =
)
ÙÙ= >
;
ÙÙ> ?
if
ÜÜ 
(
ÜÜ 
!
ÜÜ 
visibleTables
ÜÜ 
.
ÜÜ 
SequenceEqual
ÜÜ ,
(
ÜÜ, -
VisibleTables
ÜÜ- :
)
ÜÜ: ;
)
ÜÜ; <
{
ÝÝ 
VisibleTables
ÞÞ 
=
ÞÞ 
new
ÞÞ  #"
ObservableCollection
ÞÞ$ 8
<
ÞÞ8 9
TableDto
ÞÞ9 A
>
ÞÞA B
(
ÞÞB C
visibleTables
ÞÞC P
)
ÞÞP Q
;
ÞÞQ R
VisibleTableCount
ßß !
=
ßß" #
visibleTables
ßß$ 1
.
ßß1 2
Count
ßß2 7
;
ßß7 8
}
àà 
}
áá 	
}
ââ 
private
ää 
bool
ää 
IsTableVisible
ää 
(
ää  
TableDto
ää  (
table
ää) .
,
ää. /
Rect
ää0 4
visibleBounds
ää5 B
)
ääB C
{
åå 
var
ææ 

tableWidth
ææ 
=
ææ 
table
ææ 
.
ææ 
Width
ææ $
>
ææ% &
$num
ææ' (
?
ææ) *
table
ææ+ 0
.
ææ0 1
Width
ææ1 6
:
ææ7 8
$num
ææ9 <
;
ææ< =
var
çç 
tableHeight
çç 
=
çç 
table
çç 
.
çç  
Height
çç  &
>
çç' (
$num
çç) *
?
çç+ ,
table
çç- 2
.
çç2 3
Height
çç3 9
:
çç: ;
$num
çç< ?
;
çç? @
return
éé 
table
éé 
.
éé 
X
éé 
<
éé 
visibleBounds
éé &
.
éé& '
X
éé' (
+
éé) *
visibleBounds
éé+ 8
.
éé8 9
Width
éé9 >
&&
éé? A
table
êê 
.
êê 
X
êê 
+
êê 

tableWidth
êê #
>
êê$ %
visibleBounds
êê& 3
.
êê3 4
X
êê4 5
&&
êê6 8
table
ëë 
.
ëë 
Y
ëë 
<
ëë 
visibleBounds
ëë &
.
ëë& '
Y
ëë' (
+
ëë) *
visibleBounds
ëë+ 8
.
ëë8 9
Height
ëë9 ?
&&
ëë@ B
table
ìì 
.
ìì 
Y
ìì 
+
ìì 
tableHeight
ìì $
>
ìì% &
visibleBounds
ìì' 4
.
ìì4 5
Y
ìì5 6
;
ìì6 7
}
íí 
public
ïï 

void
ïï %
OptimizeForLargeLayouts
ïï '
(
ïï' (
)
ïï( )
{
ðð 
if
ññ 

(
ññ 
Tables
ññ 
.
ññ 
Count
ññ 
>
ññ 
$num
ññ 
)
ññ 
{
òò 	&
_isVirtualizationEnabled
óó $
=
óó% &
true
óó' +
;
óó+ ,
}
ôô 	
else
õõ 
{
öö 	&
_isVirtualizationEnabled
÷÷ $
=
÷÷% &
false
÷÷' ,
;
÷÷, -
VisibleTables
øø 
=
øø 
new
øø "
ObservableCollection
øø  4
<
øø4 5
TableDto
øø5 =
>
øø= >
(
øø> ?
Tables
øø? E
)
øøE F
;
øøF G
VisibleTableCount
ùù 
=
ùù 
Tables
ùù  &
.
ùù& '
Count
ùù' ,
;
ùù, -
}
úú 	
}
ûû 
public
ýý 

void
ýý "
ToggleVirtualization
ýý $
(
ýý$ %
)
ýý% &
{
þþ &
_isVirtualizationEnabled
ÿÿ  
=
ÿÿ! "
!
ÿÿ# $&
_isVirtualizationEnabled
ÿÿ$ <
;
ÿÿ< =
if
 

(
 &
_isVirtualizationEnabled
 $
)
$ %
{
‚‚ 	
if
„„ 
(
„„ 
	_viewport
„„ 
!=
„„ 
Rect
„„ !
.
„„! "
Empty
„„" '
)
„„' (
{
…… !
UpdateVisibleTables
†† #
(
††# $
	_viewport
††$ -
)
††- .
;
††. /
}
‡‡ 
}
ˆˆ 	
else
‰‰ 
{
ŠŠ 	
VisibleTables
‹‹ 
=
‹‹ 
new
‹‹ "
ObservableCollection
‹‹  4
<
‹‹4 5
TableDto
‹‹5 =
>
‹‹= >
(
‹‹> ?
Tables
‹‹? E
)
‹‹E F
;
‹‹F G
VisibleTableCount
ŒŒ 
=
ŒŒ 
Tables
ŒŒ  &
.
ŒŒ& '
Count
ŒŒ' ,
;
ŒŒ, -
}
 	
}
ŽŽ 
public
 

void
 !
SetCanvasDimensions
 #
(
# $
int
$ '
width
( -
,
- .
int
/ 2
height
3 9
,
9 :
string
; A
backgroundColor
B Q
)
Q R
{
‘‘ 
CanvasWidth
’’ 
=
’’ 
width
’’ 
;
’’ 
CanvasHeight
““ 
=
““ 
height
““ 
;
““ 
BackgroundColor
”” 
=
”” 
backgroundColor
”” )
;
””) *
if
—— 

(
—— 
SelectedFloor
—— 
!=
—— 
null
—— !
)
——! "
{
˜˜ 	
SelectedFloor
™™ 
.
™™ 
Width
™™ 
=
™™  !
width
™™" '
;
™™' (
SelectedFloor
šš 
.
šš 
Height
šš  
=
šš! "
height
šš# )
;
šš) *
SelectedFloor
›› 
.
›› 
BackgroundColor
›› )
=
››* +
backgroundColor
››, ;
;
››; <
}
œœ 	
}
 
public
ŸŸ 
 
PerformanceMetrics
ŸŸ #
GetPerformanceMetrics
ŸŸ 3
(
ŸŸ3 4
)
ŸŸ4 5
{
   
return
¡¡ 
new
¡¡  
PerformanceMetrics
¡¡ %
{
¢¢ 	
TotalTables
££ 
=
££ 
Tables
££  
.
££  !
Count
££! &
,
££& '
VisibleTables
¤¤ 
=
¤¤ 
VisibleTableCount
¤¤ -
,
¤¤- .

CurrentFPS
¥¥ 
=
¥¥ 

CurrentFPS
¥¥ #
,
¥¥# $%
IsVirtualizationEnabled
¦¦ #
=
¦¦$ %&
_isVirtualizationEnabled
¦¦& >
,
¦¦> ?
CanvasWidth
§§ 
=
§§ 
CanvasWidth
§§ %
,
§§% &
CanvasHeight
¨¨ 
=
¨¨ 
CanvasHeight
¨¨ '
,
¨¨' (
LastRenderTime
©© 
=
©© 
LastRenderTime
©© +
,
©©+ ,
MemoryUsage
ªª 
=
ªª 
GC
ªª 
.
ªª 
GetTotalMemory
ªª +
(
ªª+ ,
false
ªª, 1
)
ªª1 2
}
«« 	
;
««	 

}
¬¬ 
}­­ 
public¯¯ 
class
¯¯  
PerformanceMetrics
¯¯ 
{°° 
public
±± 

int
±± 
TotalTables
±± 
{
±± 
get
±±  
;
±±  !
set
±±" %
;
±±% &
}
±±' (
public
²² 

int
²² 
VisibleTables
²² 
{
²² 
get
²² "
;
²²" #
set
²²$ '
;
²²' (
}
²²) *
public
³³ 

int
³³ 

CurrentFPS
³³ 
{
³³ 
get
³³ 
;
³³  
set
³³! $
;
³³$ %
}
³³& '
public
´´ 

bool
´´ %
IsVirtualizationEnabled
´´ '
{
´´( )
get
´´* -
;
´´- .
set
´´/ 2
;
´´2 3
}
´´4 5
public
µµ 

int
µµ 
CanvasWidth
µµ 
{
µµ 
get
µµ  
;
µµ  !
set
µµ" %
;
µµ% &
}
µµ' (
public
¶¶ 

int
¶¶ 
CanvasHeight
¶¶ 
{
¶¶ 
get
¶¶ !
;
¶¶! "
set
¶¶# &
;
¶¶& '
}
¶¶( )
public
·· 

DateTime
·· 
LastRenderTime
·· "
{
··# $
get
··% (
;
··( )
set
··* -
;
··- .
}
··/ 0
public
¸¸ 

long
¸¸ 
MemoryUsage
¸¸ 
{
¸¸ 
get
¸¸ !
;
¸¸! "
set
¸¸# &
;
¸¸& '
}
¸¸( )
}¹¹ —Ê
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\SystemConfigViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class !
SystemConfigViewModel *
:+ ,
ViewModelBase- :
{ 
private 
readonly 
IQueryHandler "
<" #!
GetSystemBackupsQuery# 8
,8 9"
GetSystemBackupsResult: P
>P Q
_getBackupsR ]
;] ^
private 
readonly 
ICommandHandler $
<$ %%
CreateSystemBackupCommand% >
,> ?$
CreateSystemBackupResult@ X
>X Y
_createBackupZ g
;g h
private 
readonly 
ICommandHandler $
<$ %&
RestoreSystemBackupCommand% ?
,? @%
RestoreSystemBackupResultA Z
>Z [
_restoreBackup\ j
;j k
private 
readonly 
IQueryHandler "
<" #$
GetRestaurantConfigQuery# ;
,; <%
GetRestaurantConfigResult= V
>V W

_getConfigX b
;b c
private 
readonly 
ICommandHandler $
<$ %)
UpdateRestaurantConfigCommand% B
,B C(
UpdateRestaurantConfigResultD `
>` a
_updateConfigb o
;o p
private 
readonly 
IQueryHandler "
<" #"
GetTerminalConfigQuery# 9
,9 :#
GetTerminalConfigResult; R
>R S
_getTerminalConfigT f
;f g
private 
readonly 
ICommandHandler $
<$ %'
UpdateTerminalConfigCommand% @
,@ A&
UpdateTerminalConfigResultB \
>\ ]!
_updateTerminalConfig^ s
;s t
private 
readonly 
IQueryHandler "
<" #
GetCardConfigQuery# 5
,5 6
GetCardConfigResult7 J
>J K
_getCardConfigL Z
;Z [
private 
readonly 
ICommandHandler $
<$ %#
UpdateCardConfigCommand% <
,< ="
UpdateCardConfigResult> T
>T U
_updateCardConfigV g
;g h
private 
readonly 
IQueryHandler "
<" #!
GetPrinterGroupsQuery# 8
,8 9"
GetPrinterGroupsResult: P
>P Q
_getPrinterGroupsR c
;c d
private 
readonly 
IQueryHandler "
<" ##
GetPrinterMappingsQuery# :
,: ;$
GetPrinterMappingsResult< T
>T U
_getPrinterMappingsV i
;i j
private 
readonly 
ICommandHandler $
<$ %&
UpdatePrinterGroupsCommand% ?
,? @%
UpdatePrinterGroupsResultA Z
>Z [ 
_updatePrinterGroups\ p
;p q
private 
readonly 
ICommandHandler $
<$ %(
UpdatePrinterMappingsCommand% A
,A B'
UpdatePrinterMappingsResultC ^
>^ _"
_updatePrinterMappings` v
;v w
private 
readonly 
IPrintingService %
_printingService& 6
;6 7
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private   
readonly   
Magidesk   
.   
Application   )
.  ) *

Interfaces  * 4
.  4 5$
IPrintTemplateRepository  5 M
_templateRepository  N a
;  a b
public"" 
 
ObservableCollection"" 
<""  
BackupInfoDto""  -
>""- .
Backups""/ 6
{""7 8
get""9 <
;""< =
}""> ?
=""@ A
new""B E
(""E F
)""F G
;""G H
public## 
 
ObservableCollection## 
<##  
PrinterGroupDto##  /
>##/ 0
PrinterGroups##1 >
{##? @
get##A D
;##D E
}##F G
=##H I
new##J M
(##M N
)##N O
;##O P
public$$ 
 
ObservableCollection$$ 
<$$  
PrinterMappingDto$$  1
>$$1 2
PrinterMappings$$3 B
{$$C D
get$$E H
;$$H I
}$$J K
=$$L M
new$$N Q
($$Q R
)$$R S
;$$S T
public%% 
 
ObservableCollection%% 
<%%  
string%%  &
>%%& '
SystemPrinters%%( 6
{%%7 8
get%%9 <
;%%< =
}%%> ?
=%%@ A
new%%B E
(%%E F
)%%F G
;%%G H
public&& 
 
ObservableCollection&& 
<&&  
PrinterFormat&&  -
>&&- .
PrinterFormats&&/ =
{&&> ?
get&&@ C
;&&C D
}&&E F
=&&G H
new&&I L
(&&L M
Enum&&M Q
.&&Q R
	GetValues&&R [
<&&[ \
PrinterFormat&&\ i
>&&i j
(&&j k
)&&k l
)&&l m
;&&m n
public'' 
 
ObservableCollection'' 
<''  
CutBehavior''  +
>''+ ,
CutBehaviors''- 9
{'': ;
get''< ?
;''? @
}''A B
=''C D
new''E H
(''H I
Enum''I M
.''M N
	GetValues''N W
<''W X
CutBehavior''X c
>''c d
(''d e
)''e f
)''f g
;''g h
public(( 
 
ObservableCollection(( 
<((  
Magidesk((  (
.((( )
Domain(() /
.((/ 0
Entities((0 8
.((8 9
PrintTemplate((9 F
>((F G
AvailableTemplates((H Z
{(([ \
get((] `
;((` a
}((b c
=((d e
new((f i
(((i j
)((j k
;((k l
private** 
string** 
_statusMessage** !
=**" #
string**$ *
.*** +
Empty**+ 0
;**0 1
public++ 

string++ 
StatusMessage++ 
{,, 
get-- 
=>-- 
_statusMessage-- 
;-- 
set.. 
{.. 
SetProperty.. 
(.. 
ref.. 
_statusMessage.. ,
,.., -
value... 3
)..3 4
;..4 5
OnPropertyChanged..6 G
(..G H
nameof..H N
(..N O
HasStatusMessage..O _
).._ `
)..` a
;..a b
}..c d
}// 
public11 

bool11 
HasStatusMessage11  
=>11! #
!11$ %
string11% +
.11+ ,
IsNullOrEmpty11, 9
(119 :
StatusMessage11: G
)11G H
;11H I
private22 
bool22 
_isRestoring22 
;22 
public33 

bool33 
IsRestoring33 
{44 
get55 
=>55 
_isRestoring55 
;55 
set66 
{77 	
SetProperty88 
(88 
ref88 
_isRestoring88 (
,88( )
value88* /
)88/ 0
;880 1 
RestoreBackupCommand99  
?99  !
.99! "#
NotifyCanExecuteChanged99" 9
(999 :
)99: ;
;99; <
}:: 	
};; 
private== &
RestaurantConfigurationDto== &
?==& '
_configuration==( 6
;==6 7
public>> 
&
RestaurantConfigurationDto>> %
?>>% &
Configuration>>' 4
{?? 
get@@ 
=>@@ 
_configuration@@ 
;@@ 
setAA 
=>AA 
SetPropertyAA 
(AA 
refAA 
_configurationAA -
,AA- .
valueAA/ 4
)AA4 5
;AA5 6
}BB 
privateDD 
TerminalDtoDD 
?DD "
_terminalConfigurationDD /
;DD/ 0
publicEE 

TerminalDtoEE 
?EE !
TerminalConfigurationEE -
{FF 
getGG 
=>GG "
_terminalConfigurationGG %
;GG% &
setHH 
=>HH 
SetPropertyHH 
(HH 
refHH "
_terminalConfigurationHH 5
,HH5 6
valueHH7 <
)HH< =
;HH= >
}II 
privateKK 
CardConfigDtoKK 
?KK 
_cardConfigurationKK -
;KK- .
publicLL 

CardConfigDtoLL 
?LL 
CardConfigurationLL +
{MM 
getNN 
=>NN 
_cardConfigurationNN !
;NN! "
setOO 
=>OO 
SetPropertyOO 
(OO 
refOO 
_cardConfigurationOO 1
,OO1 2
valueOO3 8
)OO8 9
;OO9 :
}PP 
publicRR 

IAsyncRelayCommandRR 
LoadBackupsCommandRR 0
{RR1 2
getRR3 6
;RR6 7
}RR8 9
publicSS 

IAsyncRelayCommandSS 
CreateBackupCommandSS 1
{SS2 3
getSS4 7
;SS7 8
}SS9 :
publicTT 

IAsyncRelayCommandTT 
<TT 
stringTT $
>TT$ % 
RestoreBackupCommandTT& :
{TT; <
getTT= @
;TT@ A
}TTB C
publicUU 

IAsyncRelayCommandUU $
SaveConfigurationCommandUU 6
{UU7 8
getUU9 <
;UU< =
}UU> ?
publicVV 

IAsyncRelayCommandVV ,
 SaveTerminalConfigurationCommandVV >
{VV? @
getVVA D
;VVD E
}VVF G
publicWW 

IAsyncRelayCommandWW (
SaveCardConfigurationCommandWW :
{WW; <
getWW= @
;WW@ A
}WWB C
publicXX 

IAsyncRelayCommandXX 
SavePrintersCommandXX 1
{XX2 3
getXX4 7
;XX7 8
}XX9 :
publicYY 
!
SystemConfigViewModelYY  
(YY  !
IQueryHandlerZZ 
<ZZ !
GetSystemBackupsQueryZZ +
,ZZ+ ,"
GetSystemBackupsResultZZ- C
>ZZC D

getBackupsZZE O
,ZZO P
ICommandHandler[[ 
<[[ %
CreateSystemBackupCommand[[ 1
,[[1 2$
CreateSystemBackupResult[[3 K
>[[K L
createBackup[[M Y
,[[Y Z
ICommandHandler\\ 
<\\ &
RestoreSystemBackupCommand\\ 2
,\\2 3%
RestoreSystemBackupResult\\4 M
>\\M N
restoreBackup\\O \
,\\\ ]
IQueryHandler]] 
<]] $
GetRestaurantConfigQuery]] .
,]]. /%
GetRestaurantConfigResult]]0 I
>]]I J
	getConfig]]K T
,]]T U
ICommandHandler^^ 
<^^ )
UpdateRestaurantConfigCommand^^ 5
,^^5 6(
UpdateRestaurantConfigResult^^7 S
>^^S T
updateConfig^^U a
,^^a b
IQueryHandler__ 
<__ "
GetTerminalConfigQuery__ ,
,__, -#
GetTerminalConfigResult__. E
>__E F
getTerminalConfig__G X
,__X Y
ICommandHandler`` 
<`` '
UpdateTerminalConfigCommand`` 3
,``3 4&
UpdateTerminalConfigResult``5 O
>``O P 
updateTerminalConfig``Q e
,``e f
IQueryHandleraa 
<aa 
GetCardConfigQueryaa (
,aa( )
GetCardConfigResultaa* =
>aa= >
getCardConfigaa? L
,aaL M
ICommandHandlerbb 
<bb #
UpdateCardConfigCommandbb /
,bb/ 0"
UpdateCardConfigResultbb1 G
>bbG H
updateCardConfigbbI Y
,bbY Z
IQueryHandlercc 
<cc !
GetPrinterGroupsQuerycc +
,cc+ ,"
GetPrinterGroupsResultcc- C
>ccC D
getPrinterGroupsccE U
,ccU V
IQueryHandlerdd 
<dd #
GetPrinterMappingsQuerydd -
,dd- .$
GetPrinterMappingsResultdd/ G
>ddG H
getPrinterMappingsddI [
,dd[ \
ICommandHandleree 
<ee &
UpdatePrinterGroupsCommandee 2
,ee2 3%
UpdatePrinterGroupsResultee4 M
>eeM N
updatePrinterGroupseeO b
,eeb c
ICommandHandlerff 
<ff (
UpdatePrinterMappingsCommandff 4
,ff4 5'
UpdatePrinterMappingsResultff6 Q
>ffQ R!
updatePrinterMappingsffS h
,ffh i
IPrintingServicegg 
printingServicegg (
,gg( )
ITerminalContexthh 
terminalContexthh (
,hh( )
NavigationServiceii 
navigationServiceii +
,ii+ ,
Magideskjj 
.jj 
Applicationjj 
.jj 

Interfacesjj '
.jj' ($
IPrintTemplateRepositoryjj( @
templateRepositoryjjA S
)jjS T
{kk 
_getBackupsll 
=ll 

getBackupsll  
;ll  !
_createBackupmm 
=mm 
createBackupmm $
;mm$ %
_restoreBackupnn 
=nn 
restoreBackupnn &
;nn& '

_getConfigoo 
=oo 
	getConfigoo 
;oo 
_updateConfigpp 
=pp 
updateConfigpp $
;pp$ %
_getTerminalConfigqq 
=qq 
getTerminalConfigqq .
;qq. /!
_updateTerminalConfigrr 
=rr  
updateTerminalConfigrr  4
;rr4 5
_getCardConfigss 
=ss 
getCardConfigss &
;ss& '
_updateCardConfigtt 
=tt 
updateCardConfigtt ,
;tt, -
_getPrinterGroupsuu 
=uu 
getPrinterGroupsuu ,
;uu, -
_getPrinterMappingsvv 
=vv 
getPrinterMappingsvv 0
;vv0 1 
_updatePrinterGroupsww 
=ww 
updatePrinterGroupsww 2
;ww2 3"
_updatePrinterMappingsxx 
=xx  !
updatePrinterMappingsxx! 6
;xx6 7
_printingServiceyy 
=yy 
printingServiceyy *
;yy* +
_terminalContextzz 
=zz 
terminalContextzz *
;zz* +
_navigationService{{ 
={{ 
navigationService{{ .
;{{. /
_templateRepository|| 
=|| 
templateRepository|| 0
;||0 1
Title~~ 
=~~ 
$str~~ 1
;~~1 2"
_terminalConfiguration 
=  
new! $
TerminalDto% 0
(0 1
)1 2
;2 3 
_cardConfiguration
€€ 
=
€€ 
new
€€  
CardConfigDto
€€! .
(
€€. /
)
€€/ 0
;
€€0 1 
LoadBackupsCommand
 
=
 
new
  
AsyncRelayCommand
! 2
(
2 3
LoadBackupsAsync
3 C
)
C D
;
D E!
CreateBackupCommand
‚‚ 
=
‚‚ 
new
‚‚ !
AsyncRelayCommand
‚‚" 3
(
‚‚3 4
CreateBackupAsync
‚‚4 E
)
‚‚E F
;
‚‚F G"
RestoreBackupCommand
ƒƒ 
=
ƒƒ 
new
ƒƒ "
AsyncRelayCommand
ƒƒ# 4
<
ƒƒ4 5
string
ƒƒ5 ;
>
ƒƒ; <
(
ƒƒ< = 
RestoreBackupAsync
ƒƒ= O
,
ƒƒO P
_
ƒƒQ R
=>
ƒƒS U
!
ƒƒV W
IsRestoring
ƒƒW b
)
ƒƒb c
;
ƒƒc d&
SaveConfigurationCommand
„„  
=
„„! "
new
„„# &
AsyncRelayCommand
„„' 8
(
„„8 9$
SaveConfigurationAsync
„„9 O
)
„„O P
;
„„P Q.
 SaveTerminalConfigurationCommand
…… (
=
……) *
new
……+ .
AsyncRelayCommand
……/ @
(
……@ A,
SaveTerminalConfigurationAsync
……A _
)
……_ `
;
……` a*
SaveCardConfigurationCommand
†† $
=
††% &
new
††' *
AsyncRelayCommand
††+ <
(
††< =(
SaveCardConfigurationAsync
††= W
)
††W X
;
††X Y!
SavePrintersCommand
‡‡ 
=
‡‡ 
new
‡‡ !
AsyncRelayCommand
‡‡" 3
(
‡‡3 4
SavePrintersAsync
‡‡4 E
)
‡‡E F
;
‡‡F G
}
ˆˆ 
public
ŠŠ 

async
ŠŠ 
Task
ŠŠ 
InitializeAsync
ŠŠ %
(
ŠŠ% &
)
ŠŠ& '
{
‹‹ 
await
ŒŒ 
LoadBackupsAsync
ŒŒ 
(
ŒŒ 
)
ŒŒ  
;
ŒŒ  !
await
 $
LoadConfigurationAsync
 $
(
$ %
)
% &
;
& '
await
ŽŽ ,
LoadTerminalConfigurationAsync
ŽŽ ,
(
ŽŽ, -
)
ŽŽ- .
;
ŽŽ. /
await
 (
LoadCardConfigurationAsync
 (
(
( )
)
) *
;
* +
await
 
LoadPrintersAsync
 
(
  
)
  !
;
! "
}
‘‘ 
private
““ 
async
““ 
Task
““ $
LoadConfigurationAsync
““ -
(
““- .
)
““. /
{
”” 
try
•• 
{
–– 	
var
—— 
result
—— 
=
—— 
await
—— 

_getConfig
—— )
.
——) *
HandleAsync
——* 5
(
——5 6
new
——6 9&
GetRestaurantConfigQuery
——: R
(
——R S
)
——S T
)
——T U
;
——U V
Configuration
˜˜ 
=
˜˜ 
result
˜˜ "
.
˜˜" #
Configuration
˜˜# 0
;
˜˜0 1
}
™™ 	
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš 
{
›› 	
StatusMessage
œœ 
=
œœ 
$str
œœ :
;
œœ: ;
await
žž  
_navigationService
žž $
.
žž$ %
ShowErrorAsync
žž% 3
(
žž3 4
$str
žž4 I
,
žžI J
$"
žžK M
$str
žžM p
{
žžp q
ex
žžq s
.
žžs t
Message
žžt {
}
žž{ |
"
žž| }
)
žž} ~
;
žž~ 
}
ŸŸ 	
}
   
private
¢¢ 
async
¢¢ 
Task
¢¢ ,
LoadTerminalConfigurationAsync
¢¢ 5
(
¢¢5 6
)
¢¢6 7
{
££ 
try
¤¤ 
{
¥¥ 	
var
¦¦ 
terminalKey
¦¦ 
=
¦¦ 
_terminalContext
¦¦ .
.
¦¦. /
TerminalIdentity
¦¦/ ?
??
¦¦@ B
Environment
¦¦C N
.
¦¦N O
MachineName
¦¦O Z
;
¦¦Z [
var
§§ 
result
§§ 
=
§§ 
await
§§  
_getTerminalConfig
§§ 1
.
§§1 2
HandleAsync
§§2 =
(
§§= >
new
§§> A$
GetTerminalConfigQuery
§§B X
(
§§X Y
terminalKey
§§Y d
)
§§d e
)
§§e f
;
§§f g#
TerminalConfiguration
¨¨ !
=
¨¨" #
result
¨¨$ *
.
¨¨* +
Terminal
¨¨+ 3
;
¨¨3 4
}
©© 	
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª 
{
«« 	
StatusMessage
¬¬ 
=
¬¬ 
$str
¬¬ C
;
¬¬C D
await
®®  
_navigationService
®® $
.
®®$ %
ShowErrorAsync
®®% 3
(
®®3 4
$str
®®4 I
,
®®I J
$"
®®K M
$str
®®M p
{
®®p q
ex
®®q s
.
®®s t
Message
®®t {
}
®®{ |
"
®®| }
)
®®} ~
;
®®~ 
}
¯¯ 	
}
°° 
private
²² 
async
²² 
Task
²² (
LoadCardConfigurationAsync
²² 1
(
²²1 2
)
²²2 3
{
³³ 
try
´´ 
{
µµ 	
var
¶¶ 

terminalId
¶¶ 
=
¶¶ 
_terminalContext
¶¶ -
.
¶¶- .

TerminalId
¶¶. 8
;
¶¶8 9
if
·· 
(
·· 
!
·· 

terminalId
·· 
.
·· 
HasValue
·· $
)
··$ %
return
··& ,
;
··, -
var
¹¹ 
result
¹¹ 
=
¹¹ 
await
¹¹ 
_getCardConfig
¹¹ -
.
¹¹- .
HandleAsync
¹¹. 9
(
¹¹9 :
new
¹¹: = 
GetCardConfigQuery
¹¹> P
(
¹¹P Q

terminalId
¹¹Q [
.
¹¹[ \
Value
¹¹\ a
)
¹¹a b
)
¹¹b c
;
¹¹c d
CardConfiguration
ºº 
=
ºº 
result
ºº  &
.
ºº& '
Config
ºº' -
;
ºº- .
}
»» 	
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼ 
{
½½ 	
StatusMessage
¾¾ 
=
¾¾ 
$str
¾¾ ?
;
¾¾? @
await
ÀÀ  
_navigationService
ÀÀ %
.
ÀÀ% &
ShowErrorAsync
ÀÀ& 4
(
ÀÀ4 5
$str
ÀÀ5 J
,
ÀÀJ K
$"
ÀÀL N
$str
ÀÀN m
{
ÀÀm n
ex
ÀÀn p
.
ÀÀp q
Message
ÀÀq x
}
ÀÀx y
"
ÀÀy z
)
ÀÀz {
;
ÀÀ{ |
}
ÁÁ 	
}
ÂÂ 
private
ÄÄ 
async
ÄÄ 
Task
ÄÄ 
LoadPrintersAsync
ÄÄ (
(
ÄÄ( )
)
ÄÄ) *
{
ÅÅ 
try
ÆÆ 
{
ÇÇ 	
var
ÉÉ 
systemPrinters
ÉÉ 
=
ÉÉ  
await
ÉÉ! &
_printingService
ÉÉ' 7
.
ÉÉ7 8$
GetSystemPrintersAsync
ÉÉ8 N
(
ÉÉN O
)
ÉÉO P
;
ÉÉP Q
SystemPrinters
ÊÊ 
.
ÊÊ 
Clear
ÊÊ  
(
ÊÊ  !
)
ÊÊ! "
;
ÊÊ" #
foreach
ËË 
(
ËË 
var
ËË 
printer
ËË  
in
ËË! #
systemPrinters
ËË$ 2
)
ËË2 3
{
ÌÌ 
SystemPrinters
ÍÍ 
.
ÍÍ 
Add
ÍÍ "
(
ÍÍ" #
printer
ÍÍ# *
)
ÍÍ* +
;
ÍÍ+ ,
}
ÎÎ 
var
ÑÑ 
groupsResult
ÑÑ 
=
ÑÑ 
await
ÑÑ $
_getPrinterGroups
ÑÑ% 6
.
ÑÑ6 7
HandleAsync
ÑÑ7 B
(
ÑÑB C
new
ÑÑC F#
GetPrinterGroupsQuery
ÑÑG \
(
ÑÑ\ ]
)
ÑÑ] ^
)
ÑÑ^ _
;
ÑÑ_ `
PrinterGroups
ÒÒ 
.
ÒÒ 
Clear
ÒÒ 
(
ÒÒ  
)
ÒÒ  !
;
ÒÒ! "
foreach
ÓÓ 
(
ÓÓ 
var
ÓÓ 
group
ÓÓ 
in
ÓÓ !
groupsResult
ÓÓ" .
.
ÓÓ. /
Groups
ÓÓ/ 5
)
ÓÓ5 6
{
ÔÔ 
PrinterGroups
ÕÕ 
.
ÕÕ 
Add
ÕÕ !
(
ÕÕ! "
group
ÕÕ" '
)
ÕÕ' (
;
ÕÕ( )
}
ÖÖ 
var
ÙÙ 

terminalId
ÙÙ 
=
ÙÙ 
_terminalContext
ÙÙ -
.
ÙÙ- .

TerminalId
ÙÙ. 8
;
ÙÙ8 9
if
ÚÚ 
(
ÚÚ 

terminalId
ÚÚ 
.
ÚÚ 
HasValue
ÚÚ #
)
ÚÚ# $
{
ÛÛ 
var
ÜÜ 
mappingsResult
ÜÜ "
=
ÜÜ# $
await
ÜÜ% *!
_getPrinterMappings
ÜÜ+ >
.
ÜÜ> ?
HandleAsync
ÜÜ? J
(
ÜÜJ K
new
ÜÜK N%
GetPrinterMappingsQuery
ÜÜO f
(
ÜÜf g

terminalId
ÜÜg q
.
ÜÜq r
Value
ÜÜr w
)
ÜÜw x
)
ÜÜx y
;
ÜÜy z
PrinterMappings
ÝÝ 
.
ÝÝ  
Clear
ÝÝ  %
(
ÝÝ% &
)
ÝÝ& '
;
ÝÝ' (
foreach
ÞÞ 
(
ÞÞ 
var
ÞÞ 
mapping
ÞÞ $
in
ÞÞ% '
mappingsResult
ÞÞ( 6
.
ÞÞ6 7
Mappings
ÞÞ7 ?
)
ÞÞ? @
{
ßß 
PrinterMappings
àà #
.
àà# $
Add
àà$ '
(
àà' (
mapping
àà( /
)
àà/ 0
;
àà0 1
}
áá 
foreach
ää 
(
ää 
var
ää 
group
ää "
in
ää# %
PrinterGroups
ää& 3
)
ää3 4
{
åå 
if
ææ 
(
ææ 
!
ææ 
PrinterMappings
ææ (
.
ææ( )
Any
ææ) ,
(
ææ, -
m
ææ- .
=>
ææ/ 1
m
ææ2 3
.
ææ3 4
PrinterGroupId
ææ4 B
==
ææC E
group
ææF K
.
ææK L
Id
ææL N
)
ææN O
)
ææO P
{
çç 
PrinterMappings
èè '
.
èè' (
Add
èè( +
(
èè+ ,
new
èè, /
PrinterMappingDto
èè0 A
{
éé 

TerminalId
êê &
=
êê' (

terminalId
êê) 3
.
êê3 4
Value
êê4 9
,
êê9 :
PrinterGroupId
ëë *
=
ëë+ ,
group
ëë- 2
.
ëë2 3
Id
ëë3 5
,
ëë5 6
PrinterGroupName
ìì ,
=
ìì- .
group
ìì/ 4
.
ìì4 5
Name
ìì5 9
,
ìì9 :
PrinterName
íí '
=
íí( )
string
íí* 0
.
íí0 1
Empty
íí1 6
}
îî 
)
îî 
;
îî 
}
ïï 
}
ðð 
}
ññ 
var
ôô 
	templates
ôô 
=
ôô 
await
ôô !!
_templateRepository
ôô" 5
.
ôô5 6
GetAllAsync
ôô6 A
(
ôôA B
)
ôôB C
;
ôôC D 
AvailableTemplates
õõ 
.
õõ 
Clear
õõ $
(
õõ$ %
)
õõ% &
;
õõ& '
foreach
öö 
(
öö 
var
öö 
tmpl
öö 
in
öö  
	templates
öö! *
)
öö* +
{
÷÷  
AvailableTemplates
øø "
.
øø" #
Add
øø# &
(
øø& '
tmpl
øø' +
)
øø+ ,
;
øø, -
}
ùù 
}
úú 	
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû 
{
üü 	
StatusMessage
ýý 
=
ýý 
$str
ýý =
;
ýý= >
await
ÿÿ  
_navigationService
ÿÿ $
.
ÿÿ$ %
ShowErrorAsync
ÿÿ% 3
(
ÿÿ3 4
$str
ÿÿ4 I
,
ÿÿI J
$"
ÿÿK M
$str
ÿÿM g
{
ÿÿg h
ex
ÿÿh j
.
ÿÿj k
Message
ÿÿk r
}
ÿÿr s
"
ÿÿs t
)
ÿÿt u
;
ÿÿu v
}
€€ 	
}
 
private
ƒƒ 
async
ƒƒ 
Task
ƒƒ 
SavePrintersAsync
ƒƒ (
(
ƒƒ( )
)
ƒƒ) *
{
„„ 
IsBusy
…… 
=
…… 
true
…… 
;
…… 
StatusMessage
†† 
=
†† 
$str
†† 4
;
††4 5
try
‡‡ 
{
ˆˆ 	
await
‰‰ "
_updatePrinterGroups
‰‰ &
.
‰‰& '
HandleAsync
‰‰' 2
(
‰‰2 3
new
‰‰3 6(
UpdatePrinterGroupsCommand
‰‰7 Q
(
‰‰Q R
new
‰‰R U
List
‰‰V Z
<
‰‰Z [
PrinterGroupDto
‰‰[ j
>
‰‰j k
(
‰‰k l
PrinterGroups
‰‰l y
)
‰‰y z
)
‰‰z {
)
‰‰{ |
;
‰‰| }
if
ŠŠ 
(
ŠŠ 
_terminalContext
ŠŠ  
.
ŠŠ  !

TerminalId
ŠŠ! +
.
ŠŠ+ ,
HasValue
ŠŠ, 4
)
ŠŠ4 5
{
‹‹ 
await
ŒŒ $
_updatePrinterMappings
ŒŒ ,
.
ŒŒ, -
HandleAsync
ŒŒ- 8
(
ŒŒ8 9
new
ŒŒ9 <*
UpdatePrinterMappingsCommand
ŒŒ= Y
(
ŒŒY Z
_terminalContext
ŒŒZ j
.
ŒŒj k

TerminalId
ŒŒk u
.
ŒŒu v
Value
ŒŒv {
,
ŒŒ{ |
newŒŒ} €
ListŒŒ …
<ŒŒ… †!
PrinterMappingDtoŒŒ† —
>ŒŒ— ˜
(ŒŒ˜ ™
PrinterMappingsŒŒ™ ¨
)ŒŒ¨ ©
)ŒŒ© ª
)ŒŒª «
;ŒŒ« ¬
}
 
StatusMessage
ŽŽ 
=
ŽŽ 
$str
ŽŽ B
;
ŽŽB C
}
 	
catch
 
(
 
	Exception
 
ex
 
)
 
{
‘‘ 	
StatusMessage
’’ 
=
’’ 
$str
’’ <
;
’’< =
await
””  
_navigationService
”” $
.
””$ %
ShowErrorAsync
””% 3
(
””3 4
$str
””4 A
,
””A B
$"
””C E
$str
””E g
{
””g h
ex
””h j
.
””j k
Message
””k r
}
””r s
"
””s t
)
””t u
;
””u v
}
•• 	
finally
–– 
{
—— 	
IsBusy
˜˜ 
=
˜˜ 
false
˜˜ 
;
˜˜ 
}
™™ 	
}
šš 
private
œœ 
async
œœ 
Task
œœ (
SaveCardConfigurationAsync
œœ 1
(
œœ1 2
)
œœ2 3
{
 
if
žž 

(
žž 
CardConfiguration
žž 
==
žž  
null
žž! %
)
žž% &
return
žž' -
;
žž- .
IsBusy
   
=
   
true
   
;
   
StatusMessage
¡¡ 
=
¡¡ 
$str
¡¡ 6
;
¡¡6 7
try
¢¢ 
{
££ 	
var
¤¤ 
result
¤¤ 
=
¤¤ 
await
¤¤ 
_updateCardConfig
¤¤ 0
.
¤¤0 1
HandleAsync
¤¤1 <
(
¤¤< =
new
¤¤= @%
UpdateCardConfigCommand
¤¤A X
(
¤¤X Y
CardConfiguration
¤¤Y j
)
¤¤j k
)
¤¤k l
;
¤¤l m
StatusMessage
¥¥ 
=
¥¥ 
$str
¥¥ D
;
¥¥D E
}
¦¦ 	
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§ 
{
¨¨ 	
StatusMessage
©© 
=
©© 
$str
©© >
;
©©> ?
await
««  
_navigationService
«« $
.
««$ %
ShowErrorAsync
««% 3
(
««3 4
$str
««4 A
,
««A B
$"
««C E
$str
««E d
{
««d e
ex
««e g
.
««g h
Message
««h o
}
««o p
"
««p q
)
««q r
;
««r s
}
¬¬ 	
finally
­­ 
{
®® 	
IsBusy
¯¯ 
=
¯¯ 
false
¯¯ 
;
¯¯ 
}
°° 	
}
±± 
private
³³ 
async
³³ 
Task
³³ $
SaveConfigurationAsync
³³ -
(
³³- .
)
³³. /
{
´´ 
if
µµ 

(
µµ 
Configuration
µµ 
==
µµ 
null
µµ !
)
µµ! "
return
µµ# )
;
µµ) *
IsBusy
·· 
=
·· 
true
·· 
;
·· 
StatusMessage
¸¸ 
=
¸¸ 
$str
¸¸ 1
;
¸¸1 2
try
¹¹ 
{
ºº 	
var
»» 
result
»» 
=
»» 
await
»» 
_updateConfig
»» ,
.
»», -
HandleAsync
»»- 8
(
»»8 9
new
»»9 <+
UpdateRestaurantConfigCommand
»»= Z
(
»»Z [
Configuration
»»[ h
)
»»h i
)
»»i j
;
»»j k
StatusMessage
¼¼ 
=
¼¼ 
$str
¼¼ ?
;
¼¼? @
}
½½ 	
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾ 
{
¿¿ 	
StatusMessage
ÀÀ 
=
ÀÀ 
$str
ÀÀ 9
;
ÀÀ9 :
await
ÂÂ  
_navigationService
ÂÂ %
.
ÂÂ% &
ShowErrorAsync
ÂÂ& 4
(
ÂÂ4 5
$str
ÂÂ5 B
,
ÂÂB C
$"
ÂÂD F
$str
ÂÂF i
{
ÂÂi j
ex
ÂÂj l
.
ÂÂl m
Message
ÂÂm t
}
ÂÂt u
"
ÂÂu v
)
ÂÂv w
;
ÂÂw x
}
ÃÃ 	
finally
ÄÄ 
{
ÅÅ 	
IsBusy
ÆÆ 
=
ÆÆ 
false
ÆÆ 
;
ÆÆ 
}
ÇÇ 	
}
ÈÈ 
private
ÊÊ 
async
ÊÊ 
Task
ÊÊ ,
SaveTerminalConfigurationAsync
ÊÊ 5
(
ÊÊ5 6
)
ÊÊ6 7
{
ËË 
if
ÌÌ 

(
ÌÌ #
TerminalConfiguration
ÌÌ !
==
ÌÌ" $
null
ÌÌ% )
)
ÌÌ) *
return
ÌÌ+ 1
;
ÌÌ1 2
IsBusy
ÎÎ 
=
ÎÎ 
true
ÎÎ 
;
ÎÎ 
StatusMessage
ÏÏ 
=
ÏÏ 
$str
ÏÏ :
;
ÏÏ: ;
try
ÐÐ 
{
ÑÑ 	
var
ÒÒ 
result
ÒÒ 
=
ÒÒ 
await
ÒÒ #
_updateTerminalConfig
ÒÒ 4
.
ÒÒ4 5
HandleAsync
ÒÒ5 @
(
ÒÒ@ A
new
ÒÒA D)
UpdateTerminalConfigCommand
ÒÒE `
(
ÒÒ` a#
TerminalConfiguration
ÒÒa v
)
ÒÒv w
)
ÒÒw x
;
ÒÒx y
StatusMessage
ÓÓ 
=
ÓÓ 
$str
ÓÓ H
;
ÓÓH I
}
ÔÔ 	
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ 
{
ÖÖ 	
StatusMessage
×× 
=
×× 
$str
×× B
;
××B C
await
ÙÙ  
_navigationService
ÙÙ $
.
ÙÙ$ %
ShowErrorAsync
ÙÙ% 3
(
ÙÙ3 4
$str
ÙÙ4 A
,
ÙÙA B
$"
ÙÙC E
$str
ÙÙE h
{
ÙÙh i
ex
ÙÙi k
.
ÙÙk l
Message
ÙÙl s
}
ÙÙs t
"
ÙÙt u
)
ÙÙu v
;
ÙÙv w
}
ÚÚ 	
finally
ÛÛ 
{
ÜÜ 	
IsBusy
ÝÝ 
=
ÝÝ 
false
ÝÝ 
;
ÝÝ 
}
ÞÞ 	
}
ßß 
private
áá 
async
áá 
Task
áá 
LoadBackupsAsync
áá '
(
áá' (
)
áá( )
{
ââ 
IsBusy
ãã 
=
ãã 
true
ãã 
;
ãã 
StatusMessage
ää 
=
ää 
string
ää 
.
ää 
Empty
ää $
;
ää$ %
try
åå 
{
ææ 	
var
çç 
result
çç 
=
çç 
await
çç 
_getBackups
çç *
.
çç* +
HandleAsync
çç+ 6
(
çç6 7
new
çç7 :#
GetSystemBackupsQuery
çç; P
(
ççP Q
)
ççQ R
)
ççR S
;
ççS T
Backups
èè 
.
èè 
Clear
èè 
(
èè 
)
èè 
;
èè 
foreach
éé 
(
éé 
var
éé 
backup
éé 
in
éé  "
result
éé# )
.
éé) *
Backups
éé* 1
)
éé1 2
{
êê 
Backups
ëë 
.
ëë 
Add
ëë 
(
ëë 
backup
ëë "
)
ëë" #
;
ëë# $
}
ìì 
}
íí 	
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî 
{
ïï 	
StatusMessage
ðð 
=
ðð 
$"
ðð 
$str
ðð 5
{
ðð5 6
ex
ðð6 8
.
ðð8 9
Message
ðð9 @
}
ðð@ A
"
ððA B
;
ððB C
}
ññ 	
finally
òò 
{
óó 	
IsBusy
ôô 
=
ôô 
false
ôô 
;
ôô 
}
õõ 	
}
öö 
private
øø 
async
øø 
Task
øø 
CreateBackupAsync
øø (
(
øø( )
)
øø) *
{
ùù 
IsBusy
úú 
=
úú 
true
úú 
;
úú 
StatusMessage
ûû 
=
ûû 
$str
ûû ,
;
ûû, -
try
üü 
{
ýý 	
var
þþ 
result
þþ 
=
þþ 
await
þþ 
_createBackup
þþ ,
.
þþ, -
HandleAsync
þþ- 8
(
þþ8 9
new
þþ9 <'
CreateSystemBackupCommand
þþ= V
(
þþV W
)
þþW X
)
þþX Y
;
þþY Z
StatusMessage
ÿÿ 
=
ÿÿ 
$"
ÿÿ 
$str
ÿÿ ;
{
ÿÿ; <
result
ÿÿ< B
.
ÿÿB C
FileName
ÿÿC K
}
ÿÿK L
"
ÿÿL M
;
ÿÿM N
await
€€ 
LoadBackupsAsync
€€ "
(
€€" #
)
€€# $
;
€€$ %
}
 	
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚ 
{
ƒƒ 	
StatusMessage
„„ 
=
„„ 
$"
„„ 
$str
„„ -
{
„„- .
ex
„„. 0
.
„„0 1
Message
„„1 8
}
„„8 9
"
„„9 :
;
„„: ;
}
…… 	
finally
†† 
{
‡‡ 	
IsBusy
ˆˆ 
=
ˆˆ 
false
ˆˆ 
;
ˆˆ 
}
‰‰ 	
}
ŠŠ 
private
ŒŒ 
async
ŒŒ 
Task
ŒŒ  
RestoreBackupAsync
ŒŒ )
(
ŒŒ) *
string
ŒŒ* 0
?
ŒŒ0 1
fileName
ŒŒ2 :
)
ŒŒ: ;
{
 
if
ŽŽ 

(
ŽŽ 
string
ŽŽ 
.
ŽŽ 
IsNullOrEmpty
ŽŽ  
(
ŽŽ  !
fileName
ŽŽ! )
)
ŽŽ) *
)
ŽŽ* +
return
ŽŽ, 2
;
ŽŽ2 3
var
 
dialog
 
=
 
new
 
	Microsoft
 "
.
" #
UI
# %
.
% &
Xaml
& *
.
* +
Controls
+ 3
.
3 4
ContentDialog
4 A
{
‘‘ 	
Title
’’ 
=
’’ 
$str
’’ $
,
’’$ %
Content
““ 
=
““ 
$"
““ 
$str
““ (
{
““( )
fileName
““) 1
}
““1 2
$str
““2 V
"
““V W
,
““W X
PrimaryButtonText
”” 
=
”” 
$str
””  )
,
””) *
CloseButtonText
•• 
=
•• 
$str
•• &
,
••& '
DefaultButton
–– 
=
–– 
	Microsoft
–– %
.
––% &
UI
––& (
.
––( )
Xaml
––) -
.
––- .
Controls
––. 6
.
––6 7!
ContentDialogButton
––7 J
.
––J K
Close
––K P
,
––P Q
XamlRoot
—— 
=
—— 
App
—— 
.
——  
MainWindowInstance
—— -
.
——- .
Content
——. 5
.
——5 6
XamlRoot
——6 >
}
˜˜ 	
;
˜˜	 

var
šš 
confirmation
šš 
=
šš 
await
šš  
dialog
šš! '
.
šš' (
	ShowAsync
šš( 1
(
šš1 2
)
šš2 3
;
šš3 4
if
›› 

(
›› 
confirmation
›› 
!=
›› 
	Microsoft
›› %
.
››% &
UI
››& (
.
››( )
Xaml
››) -
.
››- .
Controls
››. 6
.
››6 7!
ContentDialogResult
››7 J
.
››J K
Primary
››K R
)
››R S
{
œœ 	
return
 
;
 
}
žž 	
IsRestoring
   
=
   
true
   
;
   
IsBusy
¡¡ 
=
¡¡ 
true
¡¡ 
;
¡¡ 
StatusMessage
¢¢ 
=
¢¢ 
$"
¢¢ 
$str
¢¢ ,
{
¢¢, -
fileName
¢¢- 5
}
¢¢5 6
$str
¢¢6 9
"
¢¢9 :
;
¢¢: ;
try
¤¤ 
{
¥¥ 	
await
¦¦ 
_restoreBackup
¦¦  
.
¦¦  !
HandleAsync
¦¦! ,
(
¦¦, -
new
¦¦- 0(
RestoreSystemBackupCommand
¦¦1 K
(
¦¦K L
fileName
¦¦L T
)
¦¦T U
)
¦¦U V
;
¦¦V W
StatusMessage
§§ 
=
§§ 
$str
§§ ]
;
§§] ^
}
¨¨ 	
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©© 
{
ªª 	
StatusMessage
«« 
=
«« 
$"
«« 
$str
«« .
{
««. /
ex
««/ 1
.
««1 2
Message
««2 9
}
««9 :
"
««: ;
;
««; <
var
­­ 
errorDialog
­­ 
=
­­ 
new
­­ "
	Microsoft
­­# ,
.
­­, -
UI
­­- /
.
­­/ 0
Xaml
­­0 4
.
­­4 5
Controls
­­5 =
.
­­= >
ContentDialog
­­> K
{
®® 
Title
¯¯ 
=
¯¯ 
$str
¯¯ )
,
¯¯) *
Content
°° 
=
°° 
$"
°° 
$str
°° =
{
°°= >
ex
°°> @
.
°°@ A
Message
°°A H
}
°°H I
$str
°°I r
"
°°r s
,
°°s t
CloseButtonText
±±  
=
±±! "
$str
±±# '
,
±±' (
XamlRoot
²² 
=
²² 
App
²² 
.
²²   
MainWindowInstance
²²  2
.
²²2 3
Content
²²3 :
.
²²: ;
XamlRoot
²²; C
}
³³ 
;
³³ 
await
´´ 
errorDialog
´´ 
.
´´ 
	ShowAsync
´´ (
(
´´( )
)
´´) *
;
´´* +
}
µµ 	
finally
¶¶ 
{
·· 	
IsBusy
¸¸ 
=
¸¸ 
false
¸¸ 
;
¸¸ 
IsRestoring
¹¹ 
=
¹¹ 
false
¹¹ 
;
¹¹  
}
ºº 	
}
»» 
}¼¼ å‹
hC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\SwitchboardViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class  
SwitchboardViewModel !
:" #
ViewModelBase$ 1
{ 
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly 
IQueryHandler "
<" #
GetOpenTicketsQuery# 6
,6 7
IEnumerable8 C
<C D
	TicketDtoD M
>M N
>N O"
_getOpenTicketsHandlerP f
;f g
private 
readonly 
ICommandHandler $
<$ %
ClockInCommand% 3
>3 4
_clockInHandler5 D
;D E
private 
readonly 
ICommandHandler $
<$ %
ClockOutCommand% 4
>4 5
_clockOutHandler6 F
;F G
private 
readonly !
IAttendanceRepository *!
_attendanceRepository+ @
;@ A
private   
readonly   
ICommandHandler   $
<  $ %
CreateTicketCommand  % 8
,  8 9
CreateTicketResult  : L
>  L M 
_createTicketHandler  N b
;  b c
private!! 
readonly!! 
IUserService!! !
_userService!!" .
;!!. /
private"" 
readonly"" 
ITerminalContext"" %
_terminalContext""& 6
;""6 7
private$$  
ObservableCollection$$  
<$$  !
	TicketDto$$! *
>$$* +
_openTickets$$, 8
=$$9 :
new$$; >
($$> ?
)$$? @
;$$@ A
public%% 
 
ObservableCollection%% 
<%%  
	TicketDto%%  )
>%%) *
OpenTickets%%+ 6
{&& 
get'' 
=>'' 
_openTickets'' 
;'' 
set(( 
=>(( 
SetProperty(( 
((( 
ref(( 
_openTickets(( +
,((+ ,
value((- 2
)((2 3
;((3 4
})) 
private++ 
	TicketDto++ 
?++ 
_selectedTicket++ &
;++& '
public,, 

	TicketDto,, 
?,, 
SelectedTicket,, $
{-- 
get.. 
=>.. 
_selectedTicket.. 
;.. 
set// 
=>// 
SetProperty// 
(// 
ref// 
_selectedTicket// .
,//. /
value//0 5
)//5 6
;//6 7
}00 
public22 

ICommand22 
LoadTicketsCommand22 &
{22' (
get22) ,
;22, -
}22. /
public33 

ICommand33 
NewTicketCommand33 $
{33% &
get33' *
;33* +
}33, -
public44 

ICommand44 
ClockInCommand44 "
{44# $
get44% (
;44( )
}44* +
public55 

ICommand55 
ClockOutCommand55 #
{55$ %
get55& )
;55) *
}55+ ,
public66 

ICommand66 
EditTicketCommand66 %
{66& '
get66( +
;66+ ,
}66- .
public77 

ICommand77 
SettleCommand77 !
{77" #
get77$ '
;77' (
}77) *
public88 

ICommand88 
DrawerPullCommand88 %
{88& '
get88( +
;88+ ,
}88- .
public99 

ICommand99 "
PerformCashDropCommand99 *
{99+ ,
get99- 0
;990 1
}992 3
public:: 

ICommand::  
PerformPayoutCommand:: (
{::) *
get::+ .
;::. /
}::0 1
public;; 

ICommand;; %
PerformDrawerBleedCommand;; -
{;;. /
get;;0 3
;;;3 4
};;5 6
public<< 

ICommand<< $
PerformOpenDrawerCommand<< ,
{<<- .
get<</ 2
;<<2 3
}<<4 5
public== 

ICommand== $
ShowDrawerBalanceCommand== ,
{==- .
get==/ 2
;==2 3
}==4 5
public>> 

ICommand>> 
KitchenCommand>> "
{>># $
get>>% (
;>>( )
}>>* +
public@@ 

ICommand@@ 
TablesCommand@@ !
{@@" #
get@@$ '
;@@' (
}@@) *
publicAA 

ICommandAA #
ManagerFunctionsCommandAA +
{AA, -
getAA. 1
;AA1 2
}AA3 4
publicBB 

ICommandBB 
BackOfficeCommandBB %
{BB& '
getBB( +
;BB+ ,
}BB- .
publicCC 

ICommandCC 
LogoutCommandCC !
{CC" #
getCC$ '
;CC' (
}CC) *
publicDD 

ICommandDD 
ShutdownCommandDD #
{DD$ %
getDD& )
;DD) *
}DD+ ,
privateFF 
readonlyFF 
ISecurityServiceFF %
_securityServiceFF& 6
;FF6 7
privateGG 
readonlyGG !
IAesEncryptionServiceGG *
_encryptionServiceGG+ =
;GG= >
privateHH 
readonlyHH %
ISwitchboardDialogServiceHH .%
_switchboardDialogServiceHH/ H
;HHH I
privateII 
readonlyII  
IOrderTypeRepositoryII ) 
_orderTypeRepositoryII* >
;II> ?
privateJJ 
readonlyJJ 
IShiftRepositoryJJ %
_shiftRepositoryJJ& 6
;JJ6 7
privateKK 
readonlyKK 
ICommandHandlerKK $
<KK$ %"
OpenCashSessionCommandKK% ;
,KK; <!
OpenCashSessionResultKK= R
>KKR S
_openSessionHandlerKKT g
;KKg h
publicMM 
 
SwitchboardViewModelMM 
(MM  
NavigationServiceNN 
navigationServiceNN +
,NN+ ,"
ICashSessionRepositoryOO !
cashSessionRepositoryOO 4
,OO4 5
IQueryHandlerPP 
<PP 
GetOpenTicketsQueryPP )
,PP) *
IEnumerablePP+ 6
<PP6 7
	TicketDtoPP7 @
>PP@ A
>PPA B!
getOpenTicketsHandlerPPC X
,PPX Y
ICommandHandlerQQ 
<QQ 
ClockInCommandQQ &
>QQ& '
clockInHandlerQQ( 6
,QQ6 7
ICommandHandlerRR 
<RR 
ClockOutCommandRR '
>RR' (
clockOutHandlerRR) 8
,RR8 9!
IAttendanceRepositorySS  
attendanceRepositorySS 2
,SS2 3
ICommandHandlerTT 
<TT 
CreateTicketCommandTT +
,TT+ ,
CreateTicketResultTT- ?
>TT? @
createTicketHandlerTTA T
,TTT U
IUserServiceUU 
userServiceUU  
,UU  !
ITerminalContextVV 
terminalContextVV (
,VV( )
ISecurityServiceWW 
securityServiceWW (
,WW( )!
IAesEncryptionServiceXX 
encryptionServiceXX /
,XX/ 0%
ISwitchboardDialogServiceYY !$
switchboardDialogServiceYY" :
,YY: ; 
IOrderTypeRepositoryZZ 
orderTypeRepositoryZZ 0
,ZZ0 1
IShiftRepository[[ 
shiftRepository[[ (
,[[( )
ICommandHandler\\ 
<\\ "
OpenCashSessionCommand\\ .
,\\. /!
OpenCashSessionResult\\0 E
>\\E F
openSessionHandler\\G Y
)\\Y Z
{]] 
_navigationService^^ 
=^^ 
navigationService^^ .
;^^. /"
_cashSessionRepository__ 
=__  !
cashSessionRepository__! 6
;__6 7"
_getOpenTicketsHandler`` 
=``  !
getOpenTicketsHandler``! 6
;``6 7
_clockInHandleraa 
=aa 
clockInHandleraa (
;aa( )
_clockOutHandlerbb 
=bb 
clockOutHandlerbb *
;bb* +!
_attendanceRepositorycc 
=cc  
attendanceRepositorycc  4
;cc4 5 
_createTicketHandlerdd 
=dd 
createTicketHandlerdd 2
;dd2 3
_userServiceee 
=ee 
userServiceee "
;ee" #
_terminalContextff 
=ff 
terminalContextff *
;ff* +
_securityServicegg 
=gg 
securityServicegg *
;gg* +
_encryptionServicehh 
=hh 
encryptionServicehh .
;hh. /%
_switchboardDialogServiceii !
=ii" #$
switchboardDialogServiceii$ <
;ii< = 
_orderTypeRepositoryjj 
=jj 
orderTypeRepositoryjj 2
;jj2 3
_shiftRepositorykk 
=kk 
shiftRepositorykk *
;kk* +
_openSessionHandlerll 
=ll 
openSessionHandlerll 0
;ll0 1
Titlemm 
=mm 
$strmm 
;mm 
LoadTicketsCommandoo 
=oo 
newoo  
AsyncRelayCommandoo! 2
(oo2 3
LoadTicketsAsyncoo3 C
)ooC D
;ooD E
ClockInCommandpp 
=pp 
newpp 
AsyncRelayCommandpp .
(pp. /
ClockInAsyncpp/ ;
)pp; <
;pp< =
ClockOutCommandqq 
=qq 
newqq 
AsyncRelayCommandqq /
(qq/ 0
ClockOutAsyncqq0 =
)qq= >
;qq> ?
EditTicketCommandrr 
=rr 
newrr 
RelayCommandrr  ,
(rr, -

EditTicketrr- 7
)rr7 8
;rr8 9
SettleCommandss 
=ss 
newss 
RelayCommandss (
(ss( )
Settless) /
)ss/ 0
;ss0 1
DrawerPullCommandtt 
=tt 
newtt 
RelayCommandtt  ,
(tt, -

DrawerPulltt- 7
)tt7 8
;tt8 9"
PerformCashDropCommanduu 
=uu  
newuu! $
AsyncRelayCommanduu% 6
(uu6 7 
PerformCashDropAsyncuu7 K
)uuK L
;uuL M 
PerformPayoutCommandvv 
=vv 
newvv "
AsyncRelayCommandvv# 4
(vv4 5
PerformPayoutAsyncvv5 G
)vvG H
;vvH I%
PerformDrawerBleedCommandww !
=ww" #
newww$ '
AsyncRelayCommandww( 9
(ww9 :#
PerformDrawerBleedAsyncww: Q
)wwQ R
;wwR S$
PerformOpenDrawerCommandxx  
=xx! "
newxx# &
AsyncRelayCommandxx' 8
(xx8 9"
PerformOpenDrawerAsyncxx9 O
)xxO P
;xxP Q$
ShowDrawerBalanceCommandyy  
=yy! "
newyy# &
AsyncRelayCommandyy' 8
(yy8 9"
ShowDrawerBalanceAsyncyy9 O
)yyO P
;yyP Q
KitchenCommand{{ 
={{ 
new{{ 
RelayCommand{{ )
({{) *
({{* +
){{+ ,
=>{{- /
_navigationService{{0 B
.{{B C
Navigate{{C K
({{K L
typeof{{L R
({{R S
Views{{S X
.{{X Y
KitchenDisplayPage{{Y k
){{k l
){{l m
){{m n
;{{n o
TablesCommand}} 
=}} 
new}} 
RelayCommand}} (
(}}( )
(}}) *
)}}* +
=>}}, .
_navigationService}}/ A
.}}A B
Navigate}}B J
(}}J K
typeof}}K Q
(}}Q R
Views}}R W
.}}W X
TableMapPage}}X d
)}}d e
)}}e f
)}}f g
;}}g h#
ManagerFunctionsCommand~~ 
=~~  !
new~~" %
AsyncRelayCommand~~& 7
(~~7 8!
ManagerFunctionsAsync~~8 M
)~~M N
;~~N O
BackOfficeCommand 
= 
new 
AsyncRelayCommand  1
(1 2
BackOfficeAsync2 A
)A B
;B C
LogoutCommand
€€ 
=
€€ 
new
€€ 
RelayCommand
€€ (
(
€€( )
(
€€) *
)
€€* +
=>
€€, .
{
€€/ 0 
_navigationService
 
.
 
Navigate
 '
(
' (
typeof
( .
(
. /
Views
/ 4
.
4 5
	LoginPage
5 >
)
> ?
)
? @
;
@ A
}
‚‚ 	
)
‚‚	 

;
‚‚
 
ShutdownCommand
ƒƒ 
=
ƒƒ 
new
ƒƒ 
RelayCommand
ƒƒ *
(
ƒƒ* +
(
ƒƒ+ ,
)
ƒƒ, -
=>
ƒƒ. 0
{
ƒƒ1 2
try
ƒƒ3 6
{
ƒƒ7 8
	Microsoft
ƒƒ9 B
.
ƒƒB C
UI
ƒƒC E
.
ƒƒE F
Xaml
ƒƒF J
.
ƒƒJ K
Application
ƒƒK V
.
ƒƒV W
Current
ƒƒW ^
.
ƒƒ^ _
Exit
ƒƒ_ c
(
ƒƒc d
)
ƒƒd e
;
ƒƒe f
}
ƒƒg h
catch
ƒƒi n
{
ƒƒo p
}
ƒƒp q
}
ƒƒr s
)
ƒƒs t
;
ƒƒt u
NewTicketCommand
…… 
=
…… 
new
…… 
AsyncRelayCommand
…… 0
(
……0 1
NewTicketAsync
……1 ?
)
……? @
;
……@ A
}
‡‡ 
private
‰‰ 
async
‰‰ 
Task
‰‰ 
BackOfficeAsync
‰‰ &
(
‰‰& '
)
‰‰' (
{
ŠŠ 
var
ŒŒ 
passwordDialog
ŒŒ 
=
ŒŒ 
new
ŒŒ  
Views
ŒŒ! &
.
ŒŒ& '!
PasswordEntryDialog
ŒŒ' :
(
ŒŒ: ;
)
ŒŒ; <
;
ŒŒ< =
passwordDialog
 
.
 
XamlRoot
 
=
  !
App
" %
.
% & 
MainWindowInstance
& 8
.
8 9
Content
9 @
.
@ A
XamlRoot
A I
;
I J
var
ŽŽ 
result
ŽŽ 
=
ŽŽ 
await
ŽŽ  
_navigationService
ŽŽ -
.
ŽŽ- .
ShowDialogAsync
ŽŽ. =
(
ŽŽ= >
passwordDialog
ŽŽ> L
)
ŽŽL M
;
ŽŽM N
if
 

(
 
result
 
!=
 !
ContentDialogResult
 )
.
) *
Primary
* 1
)
1 2
return
3 9
;
9 :
var
’’ 
pin
’’ 
=
’’ 
passwordDialog
’’  
.
’’  !
Password
’’! )
;
’’) *
if
““ 

(
““ 
string
““ 
.
““  
IsNullOrWhiteSpace
““ %
(
““% &
pin
““& )
)
““) *
)
““* +
return
““, 2
;
““2 3
try
•• 
{
–– 	
var
—— 
encryptedPin
—— 
=
——  
_encryptionService
—— 1
.
——1 2
Encrypt
——2 9
(
——9 :
pin
——: =
)
——= >
;
——> ?
var
˜˜ 
user
˜˜ 
=
˜˜ 
await
˜˜ 
_securityService
˜˜ -
.
˜˜- .
GetUserByPinAsync
˜˜. ?
(
˜˜? @
encryptedPin
˜˜@ L
)
˜˜L M
;
˜˜M N
if
šš 
(
šš 
user
šš 
==
šš 
null
šš 
)
šš 
{
›› 
await
œœ  
_navigationService
œœ (
.
œœ( )
ShowErrorAsync
œœ) 7
(
œœ7 8
$str
œœ8 O
,
œœO P
$str
œœQ _
)
œœ_ `
;
œœ` a
return
 
;
 
}
žž 
var
¡¡ 
adminPermissions
¡¡  
=
¡¡! "
UserPermission
¡¡# 1
.
¡¡1 2
ManageUsers
¡¡2 =
|
¡¡> ?
UserPermission
¡¡@ N
.
¡¡N O
ManageTableLayout
¡¡O `
|
¡¡a b
UserPermission
¢¢! /
.
¢¢/ 0

ManageMenu
¢¢0 :
|
¢¢; <
UserPermission
¢¢= K
.
¢¢K L
ViewReports
¢¢L W
|
¢¢X Y
UserPermission
££! /
.
££/ 0!
SystemConfiguration
££0 C
;
££C D
if
¥¥ 
(
¥¥ 
(
¥¥ 
user
¥¥ 
.
¥¥ 
Role
¥¥ 
.
¥¥ 
Permissions
¥¥ &
&
¥¥' (
adminPermissions
¥¥) 9
)
¥¥9 :
==
¥¥; =
$num
¥¥> ?
)
¥¥? @
{
¦¦ 
await
§§  
_navigationService
§§ (
.
§§( )
ShowErrorAsync
§§) 7
(
§§7 8
$str
§§8 G
,
§§G H
$str
§§I }
)
§§} ~
;
§§~ 
return
¨¨ 
;
¨¨ 
}
©©  
_navigationService
¬¬ 
.
¬¬ 
Navigate
¬¬ '
(
¬¬' (
typeof
¬¬( .
(
¬¬. /
Views
¬¬/ 4
.
¬¬4 5
BackOfficePage
¬¬5 C
)
¬¬C D
)
¬¬D E
;
¬¬E F
}
­­ 	
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®® 
{
¯¯ 	
await
±±  
_navigationService
±± $
.
±±$ %
ShowErrorAsync
±±% 3
(
±±3 4
$str
±±4 B
,
±±B C
$"
±±D F
$str
±±F d
{
±±d e
ex
±±e g
.
±±g h
Message
±±h o
}
±±o p
"
±±p q
)
±±q r
;
±±r s
}
²² 	
}
³³ 
private
µµ 
async
µµ 
Task
µµ #
ManagerFunctionsAsync
µµ ,
(
µµ, -
)
µµ- .
{
¶¶ 
var
¸¸ 
passwordDialog
¸¸ 
=
¸¸ 
new
¸¸  
Views
¸¸! &
.
¸¸& '!
PasswordEntryDialog
¸¸' :
(
¸¸: ;
)
¸¸; <
;
¸¸< =
passwordDialog
¹¹ 
.
¹¹ 
XamlRoot
¹¹ 
=
¹¹  !
App
¹¹" %
.
¹¹% & 
MainWindowInstance
¹¹& 8
.
¹¹8 9
Content
¹¹9 @
.
¹¹@ A
XamlRoot
¹¹A I
;
¹¹I J
var
ºº 
result
ºº 
=
ºº 
await
ºº  
_navigationService
ºº -
.
ºº- .
ShowDialogAsync
ºº. =
(
ºº= >
passwordDialog
ºº> L
)
ººL M
;
ººM N
if
¼¼ 

(
¼¼ 
result
¼¼ 
!=
¼¼ !
ContentDialogResult
¼¼ )
.
¼¼) *
Primary
¼¼* 1
)
¼¼1 2
return
¼¼3 9
;
¼¼9 :
var
¾¾ 
pin
¾¾ 
=
¾¾ 
passwordDialog
¾¾  
.
¾¾  !
Password
¾¾! )
;
¾¾) *
if
¿¿ 

(
¿¿ 
string
¿¿ 
.
¿¿  
IsNullOrWhiteSpace
¿¿ %
(
¿¿% &
pin
¿¿& )
)
¿¿) *
)
¿¿* +
return
¿¿, 2
;
¿¿2 3
try
ÁÁ 
{
ÂÂ 	
var
ÃÃ 
encryptedPin
ÃÃ 
=
ÃÃ  
_encryptionService
ÃÃ 1
.
ÃÃ1 2
Encrypt
ÃÃ2 9
(
ÃÃ9 :
pin
ÃÃ: =
)
ÃÃ= >
;
ÃÃ> ?
var
ÄÄ 
user
ÄÄ 
=
ÄÄ 
await
ÄÄ 
_securityService
ÄÄ -
.
ÄÄ- .
GetUserByPinAsync
ÄÄ. ?
(
ÄÄ? @
encryptedPin
ÄÄ@ L
)
ÄÄL M
;
ÄÄM N
if
ÆÆ 
(
ÆÆ 
user
ÆÆ 
==
ÆÆ 
null
ÆÆ 
)
ÆÆ 
{
ÇÇ 
await
ÈÈ  
_navigationService
ÈÈ (
.
ÈÈ( )
ShowErrorAsync
ÈÈ) 7
(
ÈÈ7 8
$str
ÈÈ8 O
,
ÈÈO P
$str
ÈÈQ _
)
ÈÈ_ `
;
ÈÈ` a
return
ÉÉ 
;
ÉÉ 
}
ÊÊ 
var
ÍÍ  
managerPermissions
ÍÍ "
=
ÍÍ# $
UserPermission
ÍÍ% 3
.
ÍÍ3 4

VoidTicket
ÍÍ4 >
|
ÍÍ? @
UserPermission
ÍÍA O
.
ÍÍO P
RefundPayment
ÍÍP ]
|
ÍÍ^ _
UserPermission
ÎÎ# 1
.
ÎÎ1 2

OpenDrawer
ÎÎ2 <
|
ÎÎ= >
UserPermission
ÎÎ? M
.
ÎÎM N

CloseBatch
ÎÎN X
|
ÎÎY Z
UserPermission
ÏÏ# 1
.
ÏÏ1 2
ApplyDiscount
ÏÏ2 ?
|
ÏÏ@ A
UserPermission
ÏÏB P
.
ÏÏP Q
ManageUsers
ÏÏQ \
|
ÏÏ] ^
UserPermission
ÐÐ# 1
.
ÐÐ1 2
ManageTableLayout
ÐÐ2 C
|
ÐÐD E
UserPermission
ÐÐF T
.
ÐÐT U

ManageMenu
ÐÐU _
|
ÐÐ` a
UserPermission
ÑÑ# 1
.
ÑÑ1 2
ViewReports
ÑÑ2 =
|
ÑÑ> ?
UserPermission
ÑÑ@ N
.
ÑÑN O!
SystemConfiguration
ÑÑO b
;
ÑÑb c
if
ÓÓ 
(
ÓÓ 
(
ÓÓ 
user
ÓÓ 
.
ÓÓ 
Role
ÓÓ 
.
ÓÓ 
Permissions
ÓÓ &
&
ÓÓ' ( 
managerPermissions
ÓÓ) ;
)
ÓÓ; <
==
ÓÓ= ?
$num
ÓÓ@ A
)
ÓÓA B
{
ÔÔ 
await
ÕÕ  
_navigationService
ÕÕ )
.
ÕÕ) *
ShowErrorAsync
ÕÕ* 8
(
ÕÕ8 9
$str
ÕÕ9 H
,
ÕÕH I
$str
ÕÕJ z
)
ÕÕz {
;
ÕÕ{ |
return
ÖÖ 
;
ÖÖ 
}
×× 
var
ÚÚ 
dialog
ÚÚ 
=
ÚÚ 
new
ÚÚ 
Views
ÚÚ "
.
ÚÚ" #$
ManagerFunctionsDialog
ÚÚ# 9
(
ÚÚ9 :
)
ÚÚ: ;
;
ÚÚ; <
await
ÛÛ  
_navigationService
ÛÛ $
.
ÛÛ$ %
ShowDialogAsync
ÛÛ% 4
(
ÛÛ4 5
dialog
ÛÛ5 ;
)
ÛÛ; <
;
ÛÛ< =
}
ÜÜ 	
catch
ÝÝ 
(
ÝÝ 
	Exception
ÝÝ 
ex
ÝÝ 
)
ÝÝ 
{
ÞÞ 	
await
àà  
_navigationService
àà $
.
àà$ %
ShowErrorAsync
àà% 3
(
àà3 4
$str
àà4 B
,
ààB C
$"
ààD F
$str
ààF b
{
ààb c
ex
ààc e
.
ààe f
Message
ààf m
}
ààm n
"
ààn o
)
àào p
;
ààp q
}
áá 	
}
ââ 
private
ää 
async
ää 
Task
ää 
NewTicketAsync
ää %
(
ää% &
)
ää& '
{
åå 
var
èè 
orderTypeVm
èè 
=
èè 
new
èè )
OrderTypeSelectionViewModel
èè 9
(
èè9 :"
_orderTypeRepository
èè: N
)
èèN O
;
èèO P
await
éé '
_switchboardDialogService
éé '
.
éé' ()
ShowOrderTypeSelectionAsync
éé( C
(
ééC D
orderTypeVm
ééD O
)
ééO P
;
ééP Q
if
ëë 

(
ëë 
orderTypeVm
ëë 
.
ëë 
SelectedOrderType
ëë )
!=
ëë* ,
null
ëë- 1
)
ëë1 2
{
ìì 	
var
íí 
selectedOrderType
íí !
=
íí" #
orderTypeVm
íí$ /
.
íí/ 0
SelectedOrderType
íí0 A
;
ííA B
if
ðð 
(
ðð 
selectedOrderType
ðð !
.
ðð! "
RequiresTable
ðð" /
)
ðð/ 0
{
ññ 
await
ôô  
_navigationService
ôô (
.
ôô( )
ShowErrorAsync
ôô) 7
(
ôô7 8
$str
ôô8 I
,
ôôI J
$"
ôôK M
$str
ôôM Y
{
ôôY Z
selectedOrderType
ôôZ k
.
ôôk l
Name
ôôl p
}
ôôp q
$strôôq §
"ôô§ ¨
)ôô¨ ©
;ôô© ª
return
õõ 
;
õõ 
}
öö 
if
øø 
(
øø 
selectedOrderType
øø !
.
øø! "
RequiresCustomer
øø" 2
)
øø2 3
{
ùù 
await
üü  
_navigationService
üü (
.
üü( )
ShowErrorAsync
üü) 7
(
üü7 8
$str
üü8 I
,
üüI J
$"
üüK M
$str
üüM Y
{
üüY Z
selectedOrderType
üüZ k
.
üük l
Name
üül p
}
üüp q
$strüüq ­
"üü­ ®
)üü® ¯
;üü¯ °
return
ýý 
;
ýý 
}
þþ 
int
€€ 
numberOfGuests
€€ 
=
€€  
$num
€€! "
;
€€" #
if
‚‚ 
(
‚‚ 
selectedOrderType
‚‚ !
.
‚‚! "
Name
‚‚" &
.
‚‚& '
ToUpper
‚‚' .
(
‚‚. /
)
‚‚/ 0
.
‚‚0 1
Contains
‚‚1 9
(
‚‚9 :
$str
‚‚: C
)
‚‚C D
)
‚‚D E
{
ƒƒ 
var
†† 
guestCountVm
††  
=
††! "
new
††# &!
GuestCountViewModel
††' :
(
††: ;
)
††; <
;
††< =
await
ˆˆ '
_switchboardDialogService
ˆˆ /
.
ˆˆ/ 0!
ShowGuestCountAsync
ˆˆ0 C
(
ˆˆC D
guestCountVm
ˆˆD P
)
ˆˆP Q
;
ˆˆQ R
if
ŠŠ 
(
ŠŠ 
guestCountVm
ŠŠ  
.
ŠŠ  !

GuestCount
ŠŠ! +
>
ŠŠ, -
$num
ŠŠ. /
)
ŠŠ/ 0
{
‹‹ 
numberOfGuests
ŒŒ "
=
ŒŒ# $
guestCountVm
ŒŒ% 1
.
ŒŒ1 2

GuestCount
ŒŒ2 <
;
ŒŒ< =
}
 
else
ŽŽ 
{
 
numberOfGuests
’’ "
=
’’# $
$num
’’% &
;
’’& '
}
““ 
}
”” 
if
—— 
(
—— 
_userService
—— 
.
—— 
CurrentUser
—— (
?
——( )
.
——) *
Id
——* ,
==
——- /
null
——0 4
)
——4 5
{
˜˜ 
await
™™  
_navigationService
™™ (
.
™™( )
ShowErrorAsync
™™) 7
(
™™7 8
$str
™™8 I
,
™™I J
$str
™™K x
)
™™x y
;
™™y z
return
šš 
;
šš 
}
›› 
if
 
(
 
_terminalContext
  
.
  !

TerminalId
! +
==
, .
null
/ 3
)
3 4
{
žž 
await
ŸŸ  
_navigationService
ŸŸ (
.
ŸŸ( )
ShowErrorAsync
ŸŸ) 7
(
ŸŸ7 8
$str
ŸŸ8 I
,
ŸŸI J
$strŸŸK ’
)ŸŸ’ “
;ŸŸ“ ”
return
   
;
   
}
¡¡ 
var
££ 
userId
££ 
=
££ 
_userService
££ %
.
££% &
CurrentUser
££& 1
.
££1 2
Id
££2 4
;
££4 5
var
¤¤ 

terminalId
¤¤ 
=
¤¤ 
_terminalContext
¤¤ -
.
¤¤- .

TerminalId
¤¤. 8
.
¤¤8 9
Value
¤¤9 >
;
¤¤> ?
var
§§ 
session
§§ 
=
§§ 
await
§§ $
_cashSessionRepository
§§  6
.
§§6 7-
GetOpenSessionByTerminalIdAsync
§§7 V
(
§§V W

terminalId
§§W a
)
§§a b
;
§§b c
if
¨¨ 
(
¨¨ 
session
¨¨ 
==
¨¨ 
null
¨¨ 
)
¨¨  
{
©© 
var
«« 
shiftStartVm
««  
=
««! "
new
««# &!
ShiftStartViewModel
««' :
(
««: ;
_shiftRepository
««; K
,
««K L!
_openSessionHandler
««M `
,
««` a
_userService
««b n
,
««n o
_terminalContext««p €
)««€ 
;«« ‚
await
­­ '
_switchboardDialogService
­­ /
.
­­/ 0!
ShowShiftStartAsync
­­0 C
(
­­C D
shiftStartVm
­­D P
)
­­P Q
;
­­Q R
session
°° 
=
°° 
await
°° $
_cashSessionRepository
°°  6
.
°°6 7-
GetOpenSessionByTerminalIdAsync
°°7 V
(
°°V W

terminalId
°°W a
)
°°a b
;
°°b c
if
±± 
(
±± 
session
±± 
==
±± 
null
±± #
)
±±# $
{
²² 
return
´´ 
;
´´ 
}
µµ 
}
¶¶ 
var
¸¸ 
shiftId
¸¸ 
=
¸¸ 
session
¸¸ !
.
¸¸! "
Id
¸¸" $
;
¸¸$ %
var
»» 
command
»» 
=
»» 
new
»» !
CreateTicketCommand
»» 1
{
¼¼ 
	CreatedBy
½½ 
=
½½ 
userId
½½ "
,
½½" #

TerminalId
¾¾ 
=
¾¾ 

terminalId
¾¾ '
,
¾¾' (
ShiftId
¿¿ 
=
¿¿ 
shiftId
¿¿ !
,
¿¿! "
OrderTypeId
ÀÀ 
=
ÀÀ 
selectedOrderType
ÀÀ /
.
ÀÀ/ 0
Id
ÀÀ0 2
,
ÀÀ2 3
NumberOfGuests
ÁÁ 
=
ÁÁ  
numberOfGuests
ÁÁ! /
}
ÂÂ 
;
ÂÂ 
try
ÄÄ 
{
ÅÅ 
var
ÆÆ 
result
ÆÆ 
=
ÆÆ 
await
ÆÆ ""
_createTicketHandler
ÆÆ# 7
.
ÆÆ7 8
HandleAsync
ÆÆ8 C
(
ÆÆC D
command
ÆÆD K
)
ÆÆK L
;
ÆÆL M 
_navigationService
ÉÉ "
.
ÉÉ" #
Navigate
ÉÉ# +
(
ÉÉ+ ,
typeof
ÉÉ, 2
(
ÉÉ2 3
Views
ÉÉ3 8
.
ÉÉ8 9
OrderEntryPage
ÉÉ9 G
)
ÉÉG H
,
ÉÉH I
result
ÉÉJ P
.
ÉÉP Q
TicketId
ÉÉQ Y
)
ÉÉY Z
;
ÉÉZ [
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
await
ÎÎ  
_navigationService
ÎÎ (
.
ÎÎ( )
ShowErrorAsync
ÎÎ) 7
(
ÎÎ7 8
$str
ÎÎ8 N
,
ÎÎN O
$"
ÎÎP R
$str
ÎÎR s
{
ÎÎs t
ex
ÎÎt v
.
ÎÎv w
Message
ÎÎw ~
}
ÎÎ~ 
$strÎÎ ¤
"ÎÎ¤ ¥
)ÎÎ¥ ¦
;ÎÎ¦ §
}
ÏÏ 
}
ÐÐ 	
}
ÑÑ 
public
ÓÓ 

async
ÓÓ 
Task
ÓÓ 
LoadTicketsAsync
ÓÓ &
(
ÓÓ& '
)
ÓÓ' (
{
ÔÔ 
try
ÕÕ 
{
ÖÖ 	
var
×× 
tickets
×× 
=
×× 
await
×× $
_getOpenTicketsHandler
××  6
.
××6 7
HandleAsync
××7 B
(
××B C
new
××C F!
GetOpenTicketsQuery
××G Z
(
××Z [
)
××[ \
)
××\ ]
;
××] ^
OpenTickets
ØØ 
=
ØØ 
new
ØØ "
ObservableCollection
ØØ 2
<
ØØ2 3
	TicketDto
ØØ3 <
>
ØØ< =
(
ØØ= >
tickets
ØØ> E
.
ØØE F
OrderBy
ØØF M
(
ØØM N
t
ØØN O
=>
ØØP R
t
ØØS T
.
ØØT U
TableNumbers
ØØU a
.
ØØa b
FirstOrDefault
ØØb p
(
ØØp q
)
ØØq r
)
ØØr s
)
ØØs t
;
ØØt u
}
ÙÙ 	
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ 
{
ÛÛ 	
await
ÞÞ  
_navigationService
ÞÞ %
.
ÞÞ% &
ShowErrorAsync
ÞÞ& 4
(
ÞÞ4 5
$str
ÞÞ5 G
,
ÞÞG H
$"
ÞÞI K
$str
ÞÞK i
{
ÞÞi j
ex
ÞÞj l
.
ÞÞl m
Message
ÞÞm t
}
ÞÞt u
$strÞÞu —
"ÞÞ— ˜
)ÞÞ˜ ™
;ÞÞ™ š
}
ßß 	
}
àà 
private
ââ 
void
ââ 

EditTicket
ââ 
(
ââ 
)
ââ 
{
ãã 
if
ää 

(
ää 
SelectedTicket
ää 
!=
ää 
null
ää "
)
ää" #
{
åå 	 
_navigationService
çç 
.
çç  
Navigate
çç  (
(
çç( )
typeof
çç) /
(
çç/ 0
Views
çç0 5
.
çç5 6
OrderEntryPage
çç6 D
)
ççD E
,
ççE F
SelectedTicket
ççG U
.
ççU V
Id
ççV X
)
ççX Y
;
ççY Z
}
èè 	
else
éé 
{
êê 	 
_navigationService
ìì 
.
ìì  
Navigate
ìì  (
(
ìì( )
typeof
ìì) /
(
ìì/ 0
Views
ìì0 5
.
ìì5 6
MainPage
ìì6 >
)
ìì> ?
)
ìì? @
;
ìì@ A
}
íí 	
}
îî 
private
ðð 
void
ðð 
Settle
ðð 
(
ðð 
)
ðð 
{
ññ 
var
óó 
dialog
óó 
=
óó 
new
óó 
Magidesk
óó !
.
óó! "
Presentation
óó" .
.
óó. /
Views
óó/ 4
.
óó4 5#
OpenTicketsListDialog
óó5 J
(
óóJ K
)
óóK L
;
óóL M
dialog
ôô 
.
ôô 
XamlRoot
ôô 
=
ôô 
App
ôô 
.
ôô  
MainWindowInstance
ôô 0
.
ôô0 1
Content
ôô1 8
.
ôô8 9
XamlRoot
ôô9 A
;
ôôA B
_
õõ 	
=
õõ
  
_navigationService
õõ 
.
õõ 
ShowDialogAsync
õõ .
(
õõ. /
dialog
õõ/ 5
)
õõ5 6
;
õõ6 7
}
öö 
private
øø 
async
øø 
void
øø 

DrawerPull
øø !
(
øø! "
)
øø" #
{
ùù 
var
ûû 
dialog
ûû 
=
ûû 
new
ûû 
Magidesk
ûû !
.
ûû! "
Presentation
ûû" .
.
ûû. /
Views
ûû/ 4
.
ûû4 5$
DrawerPullReportDialog
ûû5 K
(
ûûK L
)
ûûL M
;
ûûM N
dialog
üü 
.
üü 
XamlRoot
üü 
=
üü 
App
üü 
.
üü  
MainWindowInstance
üü 0
.
üü0 1
Content
üü1 8
.
üü8 9
XamlRoot
üü9 A
;
üüA B
await
ýý  
_navigationService
ýý  
.
ýý  !
ShowDialogAsync
ýý! 0
(
ýý0 1
dialog
ýý1 7
)
ýý7 8
;
ýý8 9
}
þþ 
private
€€ 
async
€€ 
Task
€€ "
PerformCashDropAsync
€€ +
(
€€+ ,
)
€€, -
{
 
var
ƒƒ 
dialog
ƒƒ 
=
ƒƒ 
new
ƒƒ 
Magidesk
ƒƒ !
.
ƒƒ! "
Presentation
ƒƒ" .
.
ƒƒ. /
Views
ƒƒ/ 4
.
ƒƒ4 5&
CashDropManagementDialog
ƒƒ5 M
(
ƒƒM N
)
ƒƒN O
;
ƒƒO P
dialog
„„ 
.
„„ 
XamlRoot
„„ 
=
„„ 
App
„„ 
.
„„  
MainWindowInstance
„„ 0
.
„„0 1
Content
„„1 8
.
„„8 9
XamlRoot
„„9 A
;
„„A B
await
……  
_navigationService
……  
.
……  !
ShowDialogAsync
……! 0
(
……0 1
dialog
……1 7
)
……7 8
;
……8 9
}
†† 
private
ˆˆ 
async
ˆˆ 
Task
ˆˆ  
PerformPayoutAsync
ˆˆ )
(
ˆˆ) *
)
ˆˆ* +
{
‰‰ 
await
ŠŠ	 )
PerformDrawerOperationAsync
ŠŠ *
(
ŠŠ* +
isPayout
ŠŠ+ 3
:
ŠŠ3 4
true
ŠŠ5 9
)
ŠŠ9 :
;
ŠŠ: ;
}
‹‹ 
private
 
async
 
Task
 %
PerformDrawerBleedAsync
 .
(
. /
)
/ 0
{
ŽŽ 
await
	 )
PerformDrawerOperationAsync
 *
(
* +
isPayout
+ 3
:
3 4
true
5 9
,
9 :
isBleed
; B
:
B C
true
D H
)
H I
;
I J
}
 
private
’’ 
async
’’ 
Task
’’ $
PerformOpenDrawerAsync
’’ -
(
’’- .
)
’’. /
{
““ 
if
•• 

(
•• 
_terminalContext
•• 
.
•• 

TerminalId
•• '
==
••( *
null
••+ /
)
••/ 0
{
–– 	
return
—— 
;
—— 
}
˜˜ 	
var
šš 

terminalId
šš 
=
šš 
_terminalContext
šš )
.
šš) *

TerminalId
šš* 4
.
šš4 5
Value
šš5 :
;
šš: ;
try
›› 
{
œœ 	
var
 
session
 
=
 
await
 $
_cashSessionRepository
  6
.
6 7-
GetOpenSessionByTerminalIdAsync
7 V
(
V W

terminalId
W a
)
a b
;
b c
if
žž 
(
žž 
session
žž 
!=
žž 
null
žž 
)
žž  
{
ŸŸ 
var
   
transaction
    
=
  ! "
new
  # &
Magidesk
  ' /
.
  / 0
Domain
  0 6
.
  6 7
Entities
  7 ?
.
  ? @!
TerminalTransaction
  @ S
(
  S T
session
¡¡ 
.
¡¡ 
Id
¡¡ 
,
¡¡  
Magidesk
¢¢ 
.
¢¢ 
Domain
¢¢ $
.
¢¢$ %
Enumerations
¢¢% 1
.
¢¢1 2%
TerminalTransactionType
¢¢2 I
.
¢¢I J
NoSale
¢¢J P
,
¢¢P Q
Magidesk
££ 
.
££ 
Domain
££ $
.
££$ %
ValueObjects
££% 1
.
££1 2
Money
££2 7
.
££7 8
Zero
££8 <
(
££< =
)
££= >
,
££> ?
$str
¤¤ )
)
¤¤) *
;
¤¤* +
session
¦¦ 
.
¦¦ 
AddTransaction
¦¦ '
(
¦¦' (
transaction
¦¦( 3
)
¦¦3 4
;
¦¦4 5
await
§§ $
_cashSessionRepository
§§ -
.
§§- .
UpdateAsync
§§. 9
(
§§9 :
session
§§: A
)
§§A B
;
§§B C
}
¨¨ 
}
©© 	
catch
ªª 
(
ªª 
System
ªª 
.
ªª 
	Exception
ªª 
ex
ªª  "
)
ªª" #
{
«« 	
await
­­  
_navigationService
­­ %
.
­­% &
ShowErrorAsync
­­& 4
(
­­4 5
$str
­­5 C
,
­­C D
$"
­­E G
$str
­­G _
{
­­_ `
ex
­­` b
.
­­b c
Message
­­c j
}
­­j k
"
­­k l
)
­­l m
;
­­m n
}
®® 	
}
¯¯ 
private
±± 
async
±± 
Task
±± $
ShowDrawerBalanceAsync
±± -
(
±±- .
)
±±. /
{
²² 
if
³³ 

(
³³ 
_terminalContext
³³ 
.
³³ 

TerminalId
³³ '
==
³³( *
null
³³+ /
)
³³/ 0
{
´´ 	
return
µµ 
;
µµ 
}
¶¶ 	
var
¸¸ 

terminalId
¸¸ 
=
¸¸ 
_terminalContext
¸¸ )
.
¸¸) *

TerminalId
¸¸* 4
.
¸¸4 5
Value
¸¸5 :
;
¸¸: ;
try
¹¹ 
{
ºº 	
var
»» 
session
»» 
=
»» 
await
»» $
_cashSessionRepository
»»  6
.
»»6 7-
GetOpenSessionByTerminalIdAsync
»»7 V
(
»»V W

terminalId
»»W a
)
»»a b
;
»»b c
string
½½ 
message
½½ 
=
½½ 
$str
½½ 5
;
½½5 6
if
¾¾ 
(
¾¾ 
session
¾¾ 
!=
¾¾ 
null
¾¾ 
)
¾¾  
{
¿¿ 
message
ÀÀ 
=
ÀÀ 
$"
ÀÀ 
$str
ÀÀ 9
{
ÀÀ9 :
session
ÀÀ: A
.
ÀÀA B
ExpectedCash
ÀÀB N
:
ÀÀN O
$str
ÀÀO P
}
ÀÀP Q
"
ÀÀQ R
;
ÀÀR S
}
ÁÁ 
await
ÃÃ  
_navigationService
ÃÃ $
.
ÃÃ$ %
ShowMessageAsync
ÃÃ% 5
(
ÃÃ5 6
$str
ÃÃ6 F
,
ÃÃF G
message
ÃÃH O
)
ÃÃO P
;
ÃÃP Q
}
ÄÄ 	
catch
ÅÅ 
(
ÅÅ 
System
ÅÅ 
.
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ  "
)
ÅÅ" #
{
ÆÆ 	
await
ÈÈ  
_navigationService
ÈÈ %
.
ÈÈ% &
ShowErrorAsync
ÈÈ& 4
(
ÈÈ4 5
$str
ÈÈ5 D
,
ÈÈD E
$"
ÈÈF H
$str
ÈÈH e
{
ÈÈe f
ex
ÈÈf h
.
ÈÈh i
Message
ÈÈi p
}
ÈÈp q
"
ÈÈq r
)
ÈÈr s
;
ÈÈs t
}
ÉÉ 	
}
ÊÊ 
private
ÌÌ 
async
ÌÌ 
Task
ÌÌ )
PerformDrawerOperationAsync
ÌÌ 2
(
ÌÌ2 3
bool
ÌÌ3 7
isPayout
ÌÌ8 @
,
ÌÌ@ A
bool
ÌÌB F
isBleed
ÌÌG N
=
ÌÌO P
false
ÌÌQ V
)
ÌÌV W
{
ÍÍ 
string
ÎÎ 
title
ÎÎ 
;
ÎÎ 
string
ÏÏ 
message
ÏÏ 
;
ÏÏ 
if
ÑÑ 

(
ÑÑ 
isBleed
ÑÑ 
)
ÑÑ 
{
ÒÒ 	
title
ÓÓ 
=
ÓÓ 
$str
ÓÓ "
;
ÓÓ" #
message
ÔÔ 
=
ÔÔ 
$str
ÔÔ N
;
ÔÔN O
}
ÕÕ 	
else
ÖÖ 
{
×× 	
title
ØØ 
=
ØØ 
isPayout
ØØ 
?
ØØ 
$str
ØØ  )
:
ØØ* +
$str
ØØ, 7
;
ØØ7 8
message
ÙÙ 
=
ÙÙ 
isPayout
ÙÙ 
?
ÙÙ  !
$str
ÙÙ" G
:
ÙÙH I
$str
ÙÙJ k
;
ÙÙk l
}
ÚÚ 	
var
ÜÜ 
dialog
ÜÜ 
=
ÜÜ 
new
ÜÜ 
Magidesk
ÜÜ !
.
ÜÜ! "
Presentation
ÜÜ" .
.
ÜÜ. /
Views
ÜÜ/ 4
.
ÜÜ4 5
CashEntryDialog
ÜÜ5 D
(
ÜÜD E
title
ÜÜE J
,
ÜÜJ K
message
ÜÜL S
)
ÜÜS T
;
ÜÜT U
var
ÝÝ 
result
ÝÝ 
=
ÝÝ 
await
ÝÝ  
_navigationService
ÝÝ -
.
ÝÝ- .
ShowDialogAsync
ÝÝ. =
(
ÝÝ= >
dialog
ÝÝ> D
)
ÝÝD E
;
ÝÝE F
if
ßß 

(
ßß 
result
ßß 
==
ßß !
ContentDialogResult
ßß )
.
ßß) *
Primary
ßß* 1
)
ßß1 2
{
àà 	
var
áá 
amount
áá 
=
áá 
new
áá 
Magidesk
áá %
.
áá% &
Domain
áá& ,
.
áá, -
ValueObjects
áá- 9
.
áá9 :
Money
áá: ?
(
áá? @
dialog
áá@ F
.
ááF G
Amount
ááG M
)
ááM N
;
ááN O
var
ââ 
reason
ââ 
=
ââ 
dialog
ââ 
.
ââ  
Reason
ââ  &
;
ââ& '
if
ää 
(
ää 
_userService
ää 
.
ää 
CurrentUser
ää (
?
ää( )
.
ää) *
Id
ää* ,
==
ää- /
null
ää0 4
||
ää5 7
_terminalContext
ää8 H
.
ääH I

TerminalId
ääI S
==
ääT V
null
ääW [
)
ää[ \
{
åå 
return
ææ 
;
ææ 
}
çç 
var
éé 
userId
éé 
=
éé 
_userService
éé %
.
éé% &
CurrentUser
éé& 1
.
éé1 2
Id
éé2 4
;
éé4 5
var
êê 

terminalId
êê 
=
êê 
_terminalContext
êê -
.
êê- .

TerminalId
êê. 8
.
êê8 9
Value
êê9 >
;
êê> ?
try
ìì 
{
íí 
var
îî 
session
îî 
=
îî 
await
îî #$
_cashSessionRepository
îî$ :
.
îî: ;-
GetOpenSessionByTerminalIdAsync
îî; Z
(
îîZ [

terminalId
îî[ e
)
îîe f
;
îîf g
if
ïï 
(
ïï 
session
ïï 
==
ïï 
null
ïï #
)
ïï# $
return
ïï% +
;
ïï+ ,
if
ññ 
(
ññ 
isBleed
ññ 
)
ññ 
{
òò 
var
óó 
bleed
óó 
=
óó 
Magidesk
óó  (
.
óó( )
Domain
óó) /
.
óó/ 0
Entities
óó0 8
.
óó8 9
DrawerBleed
óó9 D
.
óóD E
Create
óóE K
(
óóK L
session
óóL S
.
óóS T
Id
óóT V
,
óóV W
amount
óóX ^
,
óó^ _
userId
óó` f
,
óóf g
reason
óóh n
)
óón o
;
óóo p
session
ôô 
.
ôô 
AddDrawerBleed
ôô *
(
ôô* +
bleed
ôô+ 0
)
ôô0 1
;
ôô1 2
}
õõ 
else
öö 
if
öö 
(
öö 
isPayout
öö !
)
öö! "
{
÷÷ 
var
øø 
payout
øø 
=
øø  
Magidesk
øø! )
.
øø) *
Domain
øø* 0
.
øø0 1
Entities
øø1 9
.
øø9 :
Payout
øø: @
.
øø@ A
Create
øøA G
(
øøG H
session
øøH O
.
øøO P
Id
øøP R
,
øøR S
amount
øøT Z
,
øøZ [
userId
øø\ b
,
øøb c
reason
øød j
)
øøj k
;
øøk l
session
ùù 
.
ùù 
	AddPayout
ùù %
(
ùù% &
payout
ùù& ,
)
ùù, -
;
ùù- .
}
úú 
else
ûû 
{
üü 
var
ýý 
drop
ýý 
=
ýý 
Magidesk
ýý '
.
ýý' (
Domain
ýý( .
.
ýý. /
Entities
ýý/ 7
.
ýý7 8
CashDrop
ýý8 @
.
ýý@ A
Create
ýýA G
(
ýýG H
session
ýýH O
.
ýýO P
Id
ýýP R
,
ýýR S
amount
ýýT Z
,
ýýZ [
userId
ýý\ b
,
ýýb c
reason
ýýd j
)
ýýj k
;
ýýk l
session
þþ 
.
þþ 
AddCashDrop
þþ '
(
þþ' (
drop
þþ( ,
)
þþ, -
;
þþ- .
}
ÿÿ 
await
 $
_cashSessionRepository
 ,
.
, -
UpdateAsync
- 8
(
8 9
session
9 @
)
@ A
;
A B
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
System
ƒƒ 
.
ƒƒ 
	Exception
ƒƒ #
ex
ƒƒ$ &
)
ƒƒ& '
{
„„ 
await
††  
_navigationService
†† (
.
††( )
ShowErrorAsync
††) 7
(
††7 8
$str
††8 K
,
††K L
$"
††M O
$str
††O i
{
††i j
ex
††j l
.
††l m
Message
††m t
}
††t u
"
††u v
)
††v w
;
††w x
}
‡‡ 
}
ˆˆ 	
}
‰‰ 
private
ŠŠ 
async
ŠŠ 
Task
ŠŠ 
ClockInAsync
ŠŠ #
(
ŠŠ# $
)
ŠŠ$ %
{
‹‹ 
if
ŒŒ	 
(
ŒŒ 
_userService
ŒŒ 
.
ŒŒ 
CurrentUser
ŒŒ %
?
ŒŒ% &
.
ŒŒ& '
Id
ŒŒ' )
==
ŒŒ* ,
null
ŒŒ- 1
)
ŒŒ1 2
{
	 

return
ŽŽ 
;
ŽŽ 
}
	 

var
‘‘	 
userId
‘‘ 
=
‘‘ 
_userService
‘‘ "
.
‘‘" #
CurrentUser
‘‘# .
.
‘‘. /
Id
‘‘/ 1
;
‘‘1 2
var
’’	 
command
’’ 
=
’’ 
new
’’ 
ClockInCommand
’’ )
{
’’* +
UserId
’’, 2
=
’’3 4
userId
’’5 ;
}
’’< =
;
’’= >
try
““	 
{
””	 

await
•• 
_clockInHandler
•• "
.
••" #
HandleAsync
••# .
(
••. /
command
••/ 6
)
••6 7
;
••7 8
}
––	 

catch
——
 
(
—— 
	Exception
—— 
ex
—— 
)
—— 
{
˜˜
 
await
šš  
_navigationService
šš &
.
šš& '
ShowErrorAsync
šš' 5
(
šš5 6
$str
šš6 G
,
ššG H
$"
ššI K
$str
ššK `
{
šš` a
ex
šša c
.
ššc d
Message
ššd k
}
ššk l
"
ššl m
)
ššm n
;
ššn o
}
››
 
}
œœ 
private
žž 
async
žž 
Task
žž 
ClockOutAsync
žž $
(
žž$ %
)
žž% &
{
ŸŸ 
if
  	 
(
   
_userService
   
.
   
CurrentUser
   %
?
  % &
.
  & '
Id
  ' )
==
  * ,
null
  - 1
)
  1 2
{
¡¡	 

return
¢¢ 
;
¢¢ 
}
££	 

var
¥¥	 
userId
¥¥ 
=
¥¥ 
_userService
¥¥ "
.
¥¥" #
CurrentUser
¥¥# .
.
¥¥. /
Id
¥¥/ 1
;
¥¥1 2
var
¦¦	 
command
¦¦ 
=
¦¦ 
new
¦¦ 
ClockOutCommand
¦¦ *
{
¦¦+ ,
UserId
¦¦- 3
=
¦¦4 5
userId
¦¦6 <
}
¦¦= >
;
¦¦> ?
try
§§	 
{
¨¨	 

await
©© 
_clockOutHandler
©© #
.
©©# $
HandleAsync
©©$ /
(
©©/ 0
command
©©0 7
)
©©7 8
;
©©8 9
}
ªª	 

catch
««
 
(
«« 
	Exception
«« 
ex
«« 
)
«« 
{
¬¬
 
await
®®  
_navigationService
®® &
.
®®& '
ShowErrorAsync
®®' 5
(
®®5 6
$str
®®6 G
,
®®G H
$"
®®I K
$str
®®K a
{
®®a b
ex
®®b d
.
®®d e
Message
®®e l
}
®®l m
"
®®m n
)
®®n o
;
®®o p
}
¯¯
 
}
°° 
}±± Õ
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\SwipeCardViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
{ 
public 

partial 
class 
SwipeCardViewModel +
:, -
ViewModelBase. ;
{ 
private		 
string		 
_instructionText		 '
=		( )
$str		* @
;		@ A
public

 
string

 
InstructionText

 %
{ 	
get 
=> 
_instructionText #
;# $
set 
=> 
SetProperty 
( 
ref "
_instructionText# 3
,3 4
value5 :
): ;
;; <
} 	
private 
string 

_swipeData !
=" #
string$ *
.* +
Empty+ 0
;0 1
public 
string 
	SwipeData 
{ 	
get 
=> 

_swipeData 
; 
set 
=> 
SetProperty 
( 
ref "

_swipeData# -
,- .
value/ 4
)4 5
;5 6
} 	
public 
SwipeCardViewModel !
(! "
)" #
{ 	
Title 
= 
$str  
;  !
} 	
[ 	
RelayCommand	 
] 
private 
void 
ProcessSwipe !
(! "
)" #
{ 	
}"" 	
}## 
}$$ ò³
hC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\SplitTicketViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class  
SplitTicketViewModel !
:" #
ViewModelBase$ 1
{ 
private 
readonly 
ICommandHandler $
<$ %
SplitTicketCommand% 7
,7 8
SplitTicketResult9 J
>J K
_splitTicketHandlerL _
;_ `
private 
readonly 
ICommandHandler $
<$ %
SplitBySeatCommand% 7
,7 8
SplitBySeatResult9 J
>J K
_splitBySeatHandlerL _
;_ `
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
	TicketDto 
_originalTicket %
;% &
public 

	TicketDto 
OriginalTicket #
{ 
get 
=> 
_originalTicket 
; 
set 
=> 
SetProperty 
( 
ref 
_originalTicket .
,. /
value0 5
)5 6
;6 7
} 
private    
ObservableCollection    
<    !
OrderLineDto  ! -
>  - .
_originalItems  / =
;  = >
public!! 
 
ObservableCollection!! 
<!!  
OrderLineDto!!  ,
>!!, -
OriginalItems!!. ;
{"" 
get## 
=>## 
_originalItems## 
;## 
set$$ 
=>$$ 
SetProperty$$ 
($$ 
ref$$ 
_originalItems$$ -
,$$- .
value$$/ 4
)$$4 5
;$$5 6
}%% 
private''  
ObservableCollection''  
<''  !
OrderLineDto''! -
>''- .
_splitItems''/ :
;'': ;
public(( 
 
ObservableCollection(( 
<((  
OrderLineDto((  ,
>((, -

SplitItems((. 8
{)) 
get** 
=>** 
_splitItems** 
;** 
set++ 
=>++ 
SetProperty++ 
(++ 
ref++ 
_splitItems++ *
,++* +
value++, 1
)++1 2
;++2 3
},, 
private// 
bool// 
_splitByItemsMode// "
=//# $
true//% )
;//) *
public00 

bool00 
SplitByItemsMode00  
{11 
get22 
=>22 
_splitByItemsMode22  
;22  !
set33 
{44 	
if55 
(55 
SetProperty55 
(55 
ref55 
_splitByItemsMode55  1
,551 2
value553 8
)558 9
)559 :
{66 
if77 
(77 
value77 
)77 
{88 
SplitEvenlyMode99 #
=99$ %
false99& +
;99+ ,
SplitByAmountMode:: %
=::& '
false::( -
;::- .
SplitBySeatMode;; #
=;;$ %
false;;& +
;;;+ ,
}<< 
UpdateSeatGroups==  
(==  !
)==! "
;==" #
}>> 
}?? 	
}@@ 
privateBB 
boolBB 
_splitEvenlyModeBB !
;BB! "
publicCC 

boolCC 
SplitEvenlyModeCC 
{DD 
getEE 
=>EE 
_splitEvenlyModeEE 
;EE  
setFF 
{GG 	
ifHH 
(HH 
SetPropertyHH 
(HH 
refHH 
_splitEvenlyModeHH  0
,HH0 1
valueHH2 7
)HH7 8
)HH8 9
{II 
ifJJ 
(JJ 
valueJJ 
)JJ 
{KK 
SplitByItemsModeLL $
=LL% &
falseLL' ,
;LL, -
SplitByAmountModeMM %
=MM& '
falseMM( -
;MM- .
SplitBySeatModeNN #
=NN$ %
falseNN& +
;NN+ ,
}OO 
}PP 
}QQ 	
}RR 
privateTT 
boolTT 
_splitByAmountModeTT #
;TT# $
publicUU 

boolUU 
SplitByAmountModeUU !
{VV 
getWW 
=>WW 
_splitByAmountModeWW !
;WW! "
setXX 
{YY 	
ifZZ 
(ZZ 
SetPropertyZZ 
(ZZ 
refZZ 
_splitByAmountModeZZ  2
,ZZ2 3
valueZZ4 9
)ZZ9 :
)ZZ: ;
{[[ 
if\\ 
(\\ 
value\\ 
)\\ 
{]] 
SplitByItemsMode^^ $
=^^% &
false^^' ,
;^^, -
SplitEvenlyMode__ #
=__$ %
false__& +
;__+ ,
SplitBySeatMode`` #
=``$ %
false``& +
;``+ ,
}aa 
}bb 
}cc 	
}dd 
privateff 
boolff 
_splitBySeatModeff !
;ff! "
publicgg 

boolgg 
SplitBySeatModegg 
{hh 
getii 
=>ii 
_splitBySeatModeii 
;ii  
setjj 
{kk 	
ifll 
(ll 
SetPropertyll 
(ll 
refll 
_splitBySeatModell  0
,ll0 1
valuell2 7
)ll7 8
)ll8 9
{mm 
ifnn 
(nn 
valuenn 
)nn 
{oo 
SplitByItemsModepp $
=pp% &
falsepp' ,
;pp, -
SplitEvenlyModeqq #
=qq$ %
falseqq& +
;qq+ ,
SplitByAmountModerr %
=rr& '
falserr( -
;rr- .
}ss 
UpdateSeatGroupstt  
(tt  !
)tt! "
;tt" #
}uu 
}vv 	
}ww 
privateyy 
decimalyy 
_splitAmountInputyy %
;yy% &
publiczz 

decimalzz 
SplitAmountInputzz #
{{{ 
get|| 
=>|| 
_splitAmountInput||  
;||  !
set}} 
=>}} 
SetProperty}} 
(}} 
ref}} 
_splitAmountInput}} 0
,}}0 1
value}}2 7
)}}7 8
;}}8 9
}~~ 
private
€€ "
ObservableCollection
€€  
<
€€  !
decimal
€€! (
>
€€( )
_splitAmounts
€€* 7
;
€€7 8
public
 
"
ObservableCollection
 
<
  
decimal
  '
>
' (
SplitAmounts
) 5
{
‚‚ 
get
ƒƒ 
=>
ƒƒ 
_splitAmounts
ƒƒ 
;
ƒƒ 
set
„„ 
=>
„„ 
SetProperty
„„ 
(
„„ 
ref
„„ 
_splitAmounts
„„ ,
,
„„, -
value
„„. 3
)
„„3 4
;
„„4 5
}
…… 
public
‡‡ 

decimal
‡‡ 
SplitAmountsTotal
‡‡ $
=>
‡‡% '
SplitAmounts
‡‡( 4
?
‡‡4 5
.
‡‡5 6
Sum
‡‡6 9
(
‡‡9 :
)
‡‡: ;
??
‡‡< >
$num
‡‡? A
;
‡‡A B
public
ˆˆ 

decimal
ˆˆ #
SplitAmountsRemainder
ˆˆ (
=>
ˆˆ) +!
TotalAmountOriginal
ˆˆ, ?
-
ˆˆ@ A
SplitAmountsTotal
ˆˆB S
;
ˆˆS T
private
ŠŠ "
ObservableCollection
ŠŠ  
<
ŠŠ  !
SeatGroupDto
ŠŠ! -
>
ŠŠ- .
_seatGroups
ŠŠ/ :
;
ŠŠ: ;
public
‹‹ 
"
ObservableCollection
‹‹ 
<
‹‹  
SeatGroupDto
‹‹  ,
>
‹‹, -

SeatGroups
‹‹. 8
{
ŒŒ 
get
 
=>
 
_seatGroups
 
;
 
set
ŽŽ 
=>
ŽŽ 
SetProperty
ŽŽ 
(
ŽŽ 
ref
ŽŽ 
_seatGroups
ŽŽ *
,
ŽŽ* +
value
ŽŽ, 1
)
ŽŽ1 2
;
ŽŽ2 3
}
 
private
‘‘ 
bool
‘‘ !
_hasUnassignedItems
‘‘ $
;
‘‘$ %
public
’’ 

bool
’’  
HasUnassignedItems
’’ "
{
““ 
get
”” 
=>
”” !
_hasUnassignedItems
”” "
;
””" #
set
•• 
=>
•• 
SetProperty
•• 
(
•• 
ref
•• !
_hasUnassignedItems
•• 2
,
••2 3
value
••4 9
)
••9 :
;
••: ;
}
–– 
private
˜˜ 
bool
˜˜ 
_hasSingleSeat
˜˜ 
;
˜˜  
public
™™ 

bool
™™ 
HasSingleSeat
™™ 
{
šš 
get
›› 
=>
›› 
_hasSingleSeat
›› 
;
›› 
set
œœ 
=>
œœ 
SetProperty
œœ 
(
œœ 
ref
œœ 
_hasSingleSeat
œœ -
,
œœ- .
value
œœ/ 4
)
œœ4 5
;
œœ5 6
}
 
public
ŸŸ 

decimal
ŸŸ !
TotalAmountOriginal
ŸŸ &
=>
ŸŸ' )
OriginalItems
ŸŸ* 7
?
ŸŸ7 8
.
ŸŸ8 9
Sum
ŸŸ9 <
(
ŸŸ< =
i
ŸŸ= >
=>
ŸŸ? A
i
ŸŸB C
.
ŸŸC D
TotalAmount
ŸŸD O
)
ŸŸO P
??
ŸŸQ S
$num
ŸŸT U
;
ŸŸU V
public
   

decimal
   
TotalAmountSplit
   #
=>
  $ &

SplitItems
  ' 1
?
  1 2
.
  2 3
Sum
  3 6
(
  6 7
i
  7 8
=>
  9 ;
i
  < =
.
  = >
TotalAmount
  > I
)
  I J
??
  K M
$num
  N O
;
  O P
private
¢¢ 
string
¢¢ 
_errorMessage
¢¢  
;
¢¢  !
public
££ 

string
££ 
ErrorMessage
££ 
{
¤¤ 
get
¥¥ 
=>
¥¥ 
_errorMessage
¥¥ 
;
¥¥ 
set
¦¦ 
=>
¦¦ 
SetProperty
¦¦ 
(
¦¦ 
ref
¦¦ 
_errorMessage
¦¦ ,
,
¦¦, -
value
¦¦. 3
)
¦¦3 4
;
¦¦4 5
}
§§ 
private
©© 
bool
©© 
	_hasError
©© 
;
©© 
public
ªª 

bool
ªª 
HasError
ªª 
{
«« 
get
¬¬ 
=>
¬¬ 
	_hasError
¬¬ 
;
¬¬ 
set
­­ 
=>
­­ 
SetProperty
­­ 
(
­­ 
ref
­­ 
	_hasError
­­ (
,
­­( )
value
­­* /
)
­­/ 0
;
­­0 1
}
®® 
public
°° 

ICommand
°°  
MoveToSplitCommand
°° &
{
°°' (
get
°°) ,
;
°°, -
}
°°. /
public
±± 

ICommand
±± #
MoveToOriginalCommand
±± )
{
±±* +
get
±±, /
;
±±/ 0
}
±±1 2
public
²² 

ICommand
²² !
ConfirmSplitCommand
²² '
{
²²( )
get
²²* -
;
²²- .
}
²²/ 0
public
´´ 

ICommand
´´ #
AddSplitAmountCommand
´´ )
{
´´* +
get
´´, /
;
´´/ 0
}
´´1 2
public
µµ 

ICommand
µµ &
RemoveSplitAmountCommand
µµ ,
{
µµ- .
get
µµ/ 2
;
µµ2 3
}
µµ4 5
public
·· 
"
SplitTicketViewModel
·· 
(
··  
ICommandHandler
¸¸ 
<
¸¸  
SplitTicketCommand
¸¸ *
,
¸¸* +
SplitTicketResult
¸¸, =
>
¸¸= > 
splitTicketHandler
¸¸? Q
,
¸¸Q R
ICommandHandler
¹¹ 
<
¹¹  
SplitBySeatCommand
¹¹ *
,
¹¹* +
SplitBySeatResult
¹¹, =
>
¹¹= > 
splitBySeatHandler
¹¹? Q
,
¹¹Q R
IUserService
ºº 
userService
ºº  
,
ºº  !
ITerminalContext
»» 
terminalContext
»» (
,
»»( )$
ICashSessionRepository
¼¼ #
cashSessionRepository
¼¼ 4
)
¼¼4 5
{
½½ !
_splitTicketHandler
¾¾ 
=
¾¾  
splitTicketHandler
¾¾ 0
;
¾¾0 1!
_splitBySeatHandler
¿¿ 
=
¿¿  
splitBySeatHandler
¿¿ 0
;
¿¿0 1
_userService
ÀÀ 
=
ÀÀ 
userService
ÀÀ "
;
ÀÀ" #
_terminalContext
ÁÁ 
=
ÁÁ 
terminalContext
ÁÁ *
;
ÁÁ* +$
_cashSessionRepository
ÂÂ 
=
ÂÂ  #
cashSessionRepository
ÂÂ! 6
;
ÂÂ6 7

SplitItems
ÄÄ 
=
ÄÄ 
new
ÄÄ "
ObservableCollection
ÄÄ -
<
ÄÄ- .
OrderLineDto
ÄÄ. :
>
ÄÄ: ;
(
ÄÄ; <
)
ÄÄ< =
;
ÄÄ= >
OriginalItems
ÅÅ 
=
ÅÅ 
new
ÅÅ "
ObservableCollection
ÅÅ 0
<
ÅÅ0 1
OrderLineDto
ÅÅ1 =
>
ÅÅ= >
(
ÅÅ> ?
)
ÅÅ? @
;
ÅÅ@ A

SeatGroups
ÆÆ 
=
ÆÆ 
new
ÆÆ "
ObservableCollection
ÆÆ -
<
ÆÆ- .
SeatGroupDto
ÆÆ. :
>
ÆÆ: ;
(
ÆÆ; <
)
ÆÆ< =
;
ÆÆ= >
SplitAmounts
ÇÇ 
=
ÇÇ 
new
ÇÇ "
ObservableCollection
ÇÇ /
<
ÇÇ/ 0
decimal
ÇÇ0 7
>
ÇÇ7 8
(
ÇÇ8 9
)
ÇÇ9 :
;
ÇÇ: ; 
MoveToSplitCommand
ÉÉ 
=
ÉÉ 
new
ÉÉ  
RelayCommand
ÉÉ! -
<
ÉÉ- .
object
ÉÉ. 4
?
ÉÉ4 5
>
ÉÉ5 6
(
ÉÉ6 7
MoveToSplit
ÉÉ7 B
)
ÉÉB C
;
ÉÉC D#
MoveToOriginalCommand
ÊÊ 
=
ÊÊ 
new
ÊÊ  #
RelayCommand
ÊÊ$ 0
<
ÊÊ0 1
object
ÊÊ1 7
?
ÊÊ7 8
>
ÊÊ8 9
(
ÊÊ9 :
MoveToOriginal
ÊÊ: H
)
ÊÊH I
;
ÊÊI J!
ConfirmSplitCommand
ËË 
=
ËË 
new
ËË !
AsyncRelayCommand
ËË" 3
<
ËË3 4
object
ËË4 :
?
ËË: ;
>
ËË; <
(
ËË< =
ConfirmSplitAsync
ËË= N
)
ËËN O
;
ËËO P#
AddSplitAmountCommand
ÍÍ 
=
ÍÍ 
new
ÍÍ  #
RelayCommand
ÍÍ$ 0
(
ÍÍ0 1
AddSplitAmount
ÍÍ1 ?
)
ÍÍ? @
;
ÍÍ@ A&
RemoveSplitAmountCommand
ÎÎ  
=
ÎÎ! "
new
ÎÎ# &
RelayCommand
ÎÎ' 3
<
ÎÎ3 4
object
ÎÎ4 :
?
ÎÎ: ;
>
ÎÎ; <
(
ÎÎ< =
RemoveSplitAmount
ÎÎ= N
)
ÎÎN O
;
ÎÎO P
}
ÏÏ 
public
ÑÑ 

void
ÑÑ 

Initialize
ÑÑ 
(
ÑÑ 
	TicketDto
ÑÑ $
ticket
ÑÑ% +
)
ÑÑ+ ,
{
ÒÒ 
OriginalTicket
ÓÓ 
=
ÓÓ 
ticket
ÓÓ 
;
ÓÓ  
OriginalItems
ÕÕ 
=
ÕÕ 
new
ÕÕ "
ObservableCollection
ÕÕ 0
<
ÕÕ0 1
OrderLineDto
ÕÕ1 =
>
ÕÕ= >
(
ÕÕ> ?
ticket
ÕÕ? E
.
ÕÕE F

OrderLines
ÕÕF P
)
ÕÕP Q
;
ÕÕQ R

SplitItems
ÖÖ 
.
ÖÖ 
Clear
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
SplitAmounts
×× 
.
×× 
Clear
×× 
(
×× 
)
×× 
;
×× 
SplitAmountInput
ØØ 
=
ØØ 
$num
ØØ 
;
ØØ 
ErrorMessage
ÙÙ 
=
ÙÙ 
string
ÙÙ 
.
ÙÙ 
Empty
ÙÙ #
;
ÙÙ# $
HasError
ÚÚ 
=
ÚÚ 
false
ÚÚ 
;
ÚÚ 
UpdateSeatGroups
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ  
RaiseTotalsChanged
ÝÝ 
(
ÝÝ 
)
ÝÝ 
;
ÝÝ 
}
ÞÞ 
private
àà 
void
àà 
AddSplitAmount
àà 
(
àà  
)
àà  !
{
áá 
HasError
ââ 
=
ââ 
false
ââ 
;
ââ 
ErrorMessage
ãã 
=
ãã 
string
ãã 
.
ãã 
Empty
ãã #
;
ãã# $
if
åå 

(
åå 
SplitAmountInput
åå 
<=
åå 
$num
åå  !
)
åå! "
{
ææ 	
HasError
çç 
=
çç 
true
çç 
;
çç 
ErrorMessage
èè 
=
èè 
$str
èè ;
;
èè; <
return
éé 
;
éé 
}
êê 	
if
ìì 

(
ìì 
SplitAmountInput
ìì 
>
ìì #
SplitAmountsRemainder
ìì 4
)
ìì4 5
{
íí 	
HasError
îî 
=
îî 
true
îî 
;
îî 
ErrorMessage
ïï 
=
ïï 
$str
ïï >
;
ïï> ?
return
ðð 
;
ðð 
}
ññ 	
SplitAmounts
óó 
.
óó 
Add
óó 
(
óó 
decimal
óó  
.
óó  !
Round
óó! &
(
óó& '
SplitAmountInput
óó' 7
,
óó7 8
$num
óó9 :
)
óó: ;
)
óó; <
;
óó< =
SplitAmountInput
ôô 
=
ôô 
$num
ôô 
;
ôô 
OnPropertyChanged
õõ 
(
õõ 
nameof
õõ  
(
õõ  !
SplitAmountsTotal
õõ! 2
)
õõ2 3
)
õõ3 4
;
õõ4 5
OnPropertyChanged
öö 
(
öö 
nameof
öö  
(
öö  !#
SplitAmountsRemainder
öö! 6
)
öö6 7
)
öö7 8
;
öö8 9
}
÷÷ 
private
ùù 
void
ùù 
RemoveSplitAmount
ùù "
(
ùù" #
object
ùù# )
?
ùù) *
	parameter
ùù+ 4
)
ùù4 5
{
úú 
if
ûû 

(
ûû 
	parameter
ûû 
is
ûû 
decimal
ûû  
amount
ûû! '
)
ûû' (
{
üü 	
SplitAmounts
ýý 
.
ýý 
Remove
ýý 
(
ýý  
amount
ýý  &
)
ýý& '
;
ýý' (
OnPropertyChanged
þþ 
(
þþ 
nameof
þþ $
(
þþ$ %
SplitAmountsTotal
þþ% 6
)
þþ6 7
)
þþ7 8
;
þþ8 9
OnPropertyChanged
ÿÿ 
(
ÿÿ 
nameof
ÿÿ $
(
ÿÿ$ %#
SplitAmountsRemainder
ÿÿ% :
)
ÿÿ: ;
)
ÿÿ; <
;
ÿÿ< =
}
€€ 	
}
 
private
ƒƒ 
void
ƒƒ 
UpdateSeatGroups
ƒƒ !
(
ƒƒ! "
)
ƒƒ" #
{
„„ 
if
…… 

(
…… 
!
…… 
SplitBySeatMode
…… 
)
…… 
{
†† 	

SeatGroups
‡‡ 
.
‡‡ 
Clear
‡‡ 
(
‡‡ 
)
‡‡ 
;
‡‡ 
return
ˆˆ 
;
ˆˆ 
}
‰‰ 	
var
‹‹ 

seatGroups
‹‹ 
=
‹‹ 
OriginalItems
‹‹ &
.
ŒŒ 
GroupBy
ŒŒ 
(
ŒŒ 
item
ŒŒ 
=>
ŒŒ 
item
ŒŒ !
.
ŒŒ! "

SeatNumber
ŒŒ" ,
??
ŒŒ- /
$num
ŒŒ0 1
)
ŒŒ1 2
.
 
OrderBy
 
(
 
g
 
=>
 
g
 
.
 
Key
 
)
  
.
ŽŽ 
Select
ŽŽ 
(
ŽŽ 
g
ŽŽ 
=>
ŽŽ 
new
ŽŽ 
SeatGroupDto
ŽŽ )
{
 

SeatNumber
 
=
 
g
 
.
 
Key
 "
,
" #
SeatDisplay
‘‘ 
=
‘‘ 
g
‘‘ 
.
‘‘  
Key
‘‘  #
==
‘‘$ &
$num
‘‘' (
?
‘‘) *
$str
‘‘+ 7
:
‘‘8 9
$"
‘‘: <
$str
‘‘< A
{
‘‘A B
g
‘‘B C
.
‘‘C D
Key
‘‘D G
}
‘‘G H
"
‘‘H I
,
‘‘I J
Items
’’ 
=
’’ 
new
’’ "
ObservableCollection
’’ 0
<
’’0 1
OrderLineDto
’’1 =
>
’’= >
(
’’> ?
g
’’? @
)
’’@ A
,
’’A B
TotalAmount
““ 
=
““ 
g
““ 
.
““  
Sum
““  #
(
““# $
item
““$ (
=>
““) +
item
““, 0
.
““0 1
TotalAmount
““1 <
)
““< =
}
”” 
)
”” 
.
•• 
ToList
•• 
(
•• 
)
•• 
;
•• 

SeatGroups
—— 
=
—— 
new
—— "
ObservableCollection
—— -
<
——- .
SeatGroupDto
——. :
>
——: ;
(
——; <

seatGroups
——< F
)
——F G
;
——G H 
HasUnassignedItems
™™ 
=
™™ 

seatGroups
™™ '
.
™™' (
Any
™™( +
(
™™+ ,
g
™™, -
=>
™™. 0
g
™™1 2
.
™™2 3

SeatNumber
™™3 =
==
™™> @
$num
™™A B
)
™™B C
;
™™C D
HasSingleSeat
šš 
=
šš 

seatGroups
šš "
.
šš" #
Count
šš# (
<=
šš) +
$num
šš, -
;
šš- .
}
›› 
private
 
void
 
MoveToSplit
 
(
 
object
 #
?
# $
	parameter
% .
)
. /
{
žž 
if
ŸŸ 

(
ŸŸ 
	parameter
ŸŸ 
is
ŸŸ 
IList
ŸŸ 
<
ŸŸ 
object
ŸŸ %
>
ŸŸ% &
selectedItems
ŸŸ' 4
)
ŸŸ4 5
{
   	
var
¡¡ 
itemsToMove
¡¡ 
=
¡¡ 
selectedItems
¡¡ +
.
¡¡+ ,
Cast
¡¡, 0
<
¡¡0 1
OrderLineDto
¡¡1 =
>
¡¡= >
(
¡¡> ?
)
¡¡? @
.
¡¡@ A
ToList
¡¡A G
(
¡¡G H
)
¡¡H I
;
¡¡I J
foreach
¢¢ 
(
¢¢ 
var
¢¢ 
item
¢¢ 
in
¢¢  
itemsToMove
¢¢! ,
)
¢¢, -
{
££ 
OriginalItems
¤¤ 
.
¤¤ 
Remove
¤¤ $
(
¤¤$ %
item
¤¤% )
)
¤¤) *
;
¤¤* +

SplitItems
¥¥ 
.
¥¥ 
Add
¥¥ 
(
¥¥ 
item
¥¥ #
)
¥¥# $
;
¥¥$ %
}
¦¦  
RaiseTotalsChanged
§§ 
(
§§ 
)
§§  
;
§§  !
UpdateSeatGroups
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
}
©© 	
}
ªª 
private
¬¬ 
void
¬¬ 
MoveToOriginal
¬¬ 
(
¬¬  
object
¬¬  &
?
¬¬& '
	parameter
¬¬( 1
)
¬¬1 2
{
­­ 
if
®® 

(
®® 
	parameter
®® 
is
®® 
IList
®® 
<
®® 
object
®® %
>
®®% &
selectedItems
®®' 4
)
®®4 5
{
¯¯ 	
var
°° 
itemsToMove
°° 
=
°° 
selectedItems
°° +
.
°°+ ,
Cast
°°, 0
<
°°0 1
OrderLineDto
°°1 =
>
°°= >
(
°°> ?
)
°°? @
.
°°@ A
ToList
°°A G
(
°°G H
)
°°H I
;
°°I J
foreach
±± 
(
±± 
var
±± 
item
±± 
in
±±  
itemsToMove
±±! ,
)
±±, -
{
²² 

SplitItems
³³ 
.
³³ 
Remove
³³ !
(
³³! "
item
³³" &
)
³³& '
;
³³' (
OriginalItems
´´ 
.
´´ 
Add
´´ !
(
´´! "
item
´´" &
)
´´& '
;
´´' (
}
µµ  
RaiseTotalsChanged
¶¶ 
(
¶¶ 
)
¶¶  
;
¶¶  !
UpdateSeatGroups
·· 
(
·· 
)
·· 
;
·· 
}
¸¸ 	
}
¹¹ 
private
»» 
void
»»  
RaiseTotalsChanged
»» #
(
»»# $
)
»»$ %
{
¼¼ 
OnPropertyChanged
½½ 
(
½½ 
nameof
½½  
(
½½  !!
TotalAmountOriginal
½½! 4
)
½½4 5
)
½½5 6
;
½½6 7
OnPropertyChanged
¾¾ 
(
¾¾ 
nameof
¾¾  
(
¾¾  !
TotalAmountSplit
¾¾! 1
)
¾¾1 2
)
¾¾2 3
;
¾¾3 4
}
¿¿ 
private
ÁÁ 
async
ÁÁ 
Task
ÁÁ 
ConfirmSplitAsync
ÁÁ (
(
ÁÁ( )
object
ÁÁ) /
?
ÁÁ/ 0
	parameter
ÁÁ1 :
)
ÁÁ: ;
{
ÂÂ 
ErrorMessage
ÃÃ 
=
ÃÃ 
string
ÃÃ 
.
ÃÃ 
Empty
ÃÃ #
;
ÃÃ# $
HasError
ÄÄ 
=
ÄÄ 
false
ÄÄ 
;
ÄÄ 
if
ÆÆ 

(
ÆÆ 
SplitBySeatMode
ÆÆ 
)
ÆÆ 
{
ÇÇ 	
await
ÈÈ %
ConfirmSplitBySeatAsync
ÈÈ )
(
ÈÈ) *
	parameter
ÈÈ* 3
)
ÈÈ3 4
;
ÈÈ4 5
}
ÉÉ 	
else
ÊÊ 
if
ÊÊ 
(
ÊÊ 
SplitByAmountMode
ÊÊ "
)
ÊÊ" #
{
ËË 	
await
ÌÌ '
ConfirmSplitByAmountAsync
ÌÌ +
(
ÌÌ+ ,
	parameter
ÌÌ, 5
)
ÌÌ5 6
;
ÌÌ6 7
}
ÍÍ 	
else
ÎÎ 
if
ÎÎ 
(
ÎÎ 
SplitEvenlyMode
ÎÎ  
)
ÎÎ  !
{
ÏÏ 	
ErrorMessage
ÑÑ 
=
ÑÑ 
$str
ÑÑ ^
;
ÑÑ^ _
HasError
ÒÒ 
=
ÒÒ 
true
ÒÒ 
;
ÒÒ 
}
ÓÓ 	
else
ÔÔ 
{
ÕÕ 	
await
ÖÖ &
ConfirmSplitByItemsAsync
ÖÖ *
(
ÖÖ* +
	parameter
ÖÖ+ 4
)
ÖÖ4 5
;
ÖÖ5 6
}
×× 	
}
ØØ 
private
ÚÚ 
Task
ÚÚ '
ConfirmSplitByAmountAsync
ÚÚ *
(
ÚÚ* +
object
ÚÚ+ 1
?
ÚÚ1 2
	parameter
ÚÚ3 <
)
ÚÚ< =
{
ÛÛ 
if
ÜÜ 

(
ÜÜ 
SplitAmounts
ÜÜ 
.
ÜÜ 
Count
ÜÜ 
==
ÜÜ !
$num
ÜÜ" #
)
ÜÜ# $
{
ÝÝ 	
ErrorMessage
ÞÞ 
=
ÞÞ 
$str
ÞÞ @
;
ÞÞ@ A
HasError
ßß 
=
ßß 
true
ßß 
;
ßß 
return
àà 
Task
àà 
.
àà 
CompletedTask
àà %
;
àà% &
}
áá 	
if
ãã 

(
ãã 
SplitAmounts
ãã 
.
ãã 
Any
ãã 
(
ãã 
a
ãã 
=>
ãã !
a
ãã" #
<=
ãã$ &
$num
ãã' (
)
ãã( )
)
ãã) *
{
ää 	
ErrorMessage
åå 
=
åå 
$str
åå F
;
ååF G
HasError
ææ 
=
ææ 
true
ææ 
;
ææ 
return
çç 
Task
çç 
.
çç 
CompletedTask
çç %
;
çç% &
}
èè 	
if
êê 

(
êê 
SplitAmountsTotal
êê 
>
êê !
TotalAmountOriginal
êê  3
)
êê3 4
{
ëë 	
ErrorMessage
ìì 
=
ìì 
$str
ìì C
;
ììC D
HasError
íí 
=
íí 
true
íí 
;
íí 
return
îî 
Task
îî 
.
îî 
CompletedTask
îî %
;
îî% &
}
ïï 	
ErrorMessage
òò 
=
òò 
$str
òò ]
;
òò] ^
HasError
óó 
=
óó 
true
óó 
;
óó 
return
ôô 
Task
ôô 
.
ôô 
CompletedTask
ôô !
;
ôô! "
}
õõ 
private
÷÷ 
async
÷÷ 
Task
÷÷ &
ConfirmSplitByItemsAsync
÷÷ /
(
÷÷/ 0
object
÷÷0 6
?
÷÷6 7
	parameter
÷÷8 A
)
÷÷A B
{
øø 
if
ùù 

(
ùù 

SplitItems
ùù 
.
ùù 
Count
ùù 
==
ùù 
$num
ùù  !
)
ùù! "
{
úú 	
ErrorMessage
ûû 
=
ûû 
$str
ûû B
;
ûûB C
HasError
üü 
=
üü 
true
üü 
;
üü 
return
ýý 
;
ýý 
}
þþ 	
if
€€ 

(
€€ 
OriginalItems
€€ 
.
€€ 
Count
€€ 
==
€€  "
$num
€€# $
)
€€$ %
{
 	
ErrorMessage
‚‚ 
=
‚‚ 
$str‚‚ €
;‚‚€ 
HasError
ƒƒ 
=
ƒƒ 
true
ƒƒ 
;
ƒƒ 
return
„„ 
;
„„ 
}
…… 	
try
‡‡ 
{
ˆˆ 	
var
‰‰ 
currentUser
‰‰ 
=
‰‰ 
_userService
‰‰ *
.
‰‰* +
CurrentUser
‰‰+ 6
;
‰‰6 7
if
ŠŠ 
(
ŠŠ 
currentUser
ŠŠ 
==
ŠŠ 
null
ŠŠ #
)
ŠŠ# $
{
‹‹ 
ErrorMessage
ŒŒ 
=
ŒŒ 
$str
ŒŒ 3
;
ŒŒ3 4
HasError
 
=
 
true
 
;
  
return
ŽŽ 
;
ŽŽ 
}
 
if
‘‘ 
(
‘‘ 
_terminalContext
‘‘  
.
‘‘  !

TerminalId
‘‘! +
==
‘‘, .
null
‘‘/ 3
)
‘‘3 4
{
’’ 
ErrorMessage
““ 
=
““ 
$str
““ 9
;
““9 :
HasError
”” 
=
”” 
true
”” 
;
”” 
return
•• 
;
•• 
}
–– 
var
˜˜ 

terminalId
˜˜ 
=
˜˜ 
_terminalContext
˜˜ -
.
˜˜- .

TerminalId
˜˜. 8
.
˜˜8 9
Value
˜˜9 >
;
˜˜> ?
var
šš 
session
šš 
=
šš 
await
šš $
_cashSessionRepository
šš  6
.
šš6 7-
GetOpenSessionByTerminalIdAsync
šš7 V
(
ššV W

terminalId
ššW a
)
šša b
;
ššb c
if
›› 
(
›› 
session
›› 
==
›› 
null
›› 
)
››  
{
œœ 
ErrorMessage
 
=
 
$str
 T
;
T U
HasError
žž 
=
žž 
true
žž 
;
žž  
return
ŸŸ 
;
ŸŸ 
}
   
var
¢¢ 
command
¢¢ 
=
¢¢ 
new
¢¢  
SplitTicketCommand
¢¢ 0
{
££ 
OriginalTicketId
¤¤  
=
¤¤! "
OriginalTicket
¤¤# 1
.
¤¤1 2
Id
¤¤2 4
,
¤¤4 5!
OrderLineIdsToSplit
¥¥ #
=
¥¥$ %

SplitItems
¥¥& 0
.
¥¥0 1
Select
¥¥1 7
(
¥¥7 8
x
¥¥8 9
=>
¥¥: <
x
¥¥= >
.
¥¥> ?
Id
¥¥? A
)
¥¥A B
.
¥¥B C
ToList
¥¥C I
(
¥¥I J
)
¥¥J K
,
¥¥K L
SplitBy
¦¦ 
=
¦¦ 
new
¦¦ 
UserId
¦¦ $
(
¦¦$ %
currentUser
¦¦% 0
.
¦¦0 1
Id
¦¦1 3
)
¦¦3 4
,
¦¦4 5

TerminalId
§§ 
=
§§ 

terminalId
§§ '
,
§§' (
ShiftId
¨¨ 
=
¨¨ 
session
¨¨ !
.
¨¨! "
Id
¨¨" $
,
¨¨$ %
OrderTypeId
©© 
=
©© 
OriginalTicket
©© ,
.
©©, -
OrderTypeId
©©- 8
,
©©8 9
GlobalId
ªª 
=
ªª 
Guid
ªª 
.
ªª  
NewGuid
ªª  '
(
ªª' (
)
ªª( )
.
ªª) *
ToString
ªª* 2
(
ªª2 3
)
ªª3 4
}
«« 
;
«« 
var
­­ 
result
­­ 
=
­­ 
await
­­ !
_splitTicketHandler
­­ 2
.
­­2 3
HandleAsync
­­3 >
(
­­> ?
command
­­? F
)
­­F G
;
­­G H
if
¯¯ 
(
¯¯ 
result
¯¯ 
.
¯¯ 
Success
¯¯ 
)
¯¯ 
{
°° 
if
±± 
(
±± 
	parameter
±± 
is
±±  
ContentDialog
±±! .
dialog
±±/ 5
)
±±5 6
{
²² 
dialog
³³ 
.
³³ 
Hide
³³ 
(
³³  
)
³³  !
;
³³! "
}
´´ 
}
µµ 
else
¶¶ 
{
·· 
ErrorMessage
¸¸ 
=
¸¸ 
result
¸¸ %
.
¸¸% &
ErrorMessage
¸¸& 2
??
¸¸3 5
$str
¸¸6 S
;
¸¸S T
HasError
¹¹ 
=
¹¹ 
true
¹¹ 
;
¹¹  
}
ºº 
}
»» 	
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼ 
{
½½ 	
ErrorMessage
¾¾ 
=
¾¾ 
ex
¾¾ 
.
¾¾ 
Message
¾¾ %
;
¾¾% &
HasError
¿¿ 
=
¿¿ 
true
¿¿ 
;
¿¿ 
}
ÀÀ 	
}
ÁÁ 
private
ÃÃ 
async
ÃÃ 
Task
ÃÃ %
ConfirmSplitBySeatAsync
ÃÃ .
(
ÃÃ. /
object
ÃÃ/ 5
?
ÃÃ5 6
	parameter
ÃÃ7 @
)
ÃÃ@ A
{
ÄÄ 
if
ÅÅ 

(
ÅÅ 
HasSingleSeat
ÅÅ 
)
ÅÅ 
{
ÆÆ 	
ErrorMessage
ÇÇ 
=
ÇÇ 
$str
ÇÇ Q
;
ÇÇQ R
HasError
ÈÈ 
=
ÈÈ 
true
ÈÈ 
;
ÈÈ 
return
ÉÉ 
;
ÉÉ 
}
ÊÊ 	
try
ÌÌ 
{
ÍÍ 	
var
ÎÎ 
currentUser
ÎÎ 
=
ÎÎ 
_userService
ÎÎ *
.
ÎÎ* +
CurrentUser
ÎÎ+ 6
;
ÎÎ6 7
if
ÏÏ 
(
ÏÏ 
currentUser
ÏÏ 
==
ÏÏ 
null
ÏÏ #
)
ÏÏ# $
{
ÐÐ 
ErrorMessage
ÑÑ 
=
ÑÑ 
$str
ÑÑ 3
;
ÑÑ3 4
HasError
ÒÒ 
=
ÒÒ 
true
ÒÒ 
;
ÒÒ  
return
ÓÓ 
;
ÓÓ 
}
ÔÔ 
if
ÖÖ 
(
ÖÖ 
_terminalContext
ÖÖ  
.
ÖÖ  !

TerminalId
ÖÖ! +
==
ÖÖ, .
null
ÖÖ/ 3
)
ÖÖ3 4
{
×× 
ErrorMessage
ØØ 
=
ØØ 
$str
ØØ 9
;
ØØ9 :
HasError
ÙÙ 
=
ÙÙ 
true
ÙÙ 
;
ÙÙ 
return
ÚÚ 
;
ÚÚ 
}
ÛÛ 
var
ÝÝ 

terminalId
ÝÝ 
=
ÝÝ 
_terminalContext
ÝÝ -
.
ÝÝ- .

TerminalId
ÝÝ. 8
.
ÝÝ8 9
Value
ÝÝ9 >
;
ÝÝ> ?
var
ßß 
session
ßß 
=
ßß 
await
ßß $
_cashSessionRepository
ßß  6
.
ßß6 7-
GetOpenSessionByTerminalIdAsync
ßß7 V
(
ßßV W

terminalId
ßßW a
)
ßßa b
;
ßßb c
if
àà 
(
àà 
session
àà 
==
àà 
null
àà 
)
àà  
{
áá 
ErrorMessage
ââ 
=
ââ 
$str
ââ T
;
ââT U
HasError
ãã 
=
ãã 
true
ãã 
;
ãã  
return
ää 
;
ää 
}
åå 
var
çç 
command
çç 
=
çç 
new
çç  
SplitBySeatCommand
çç 0
{
èè 
OriginalTicketId
éé  
=
éé! "
OriginalTicket
éé# 1
.
éé1 2
Id
éé2 4
,
éé4 5
ProcessedBy
êê 
=
êê 
new
êê !
UserId
êê" (
(
êê( )
currentUser
êê) 4
.
êê4 5
Id
êê5 7
)
êê7 8
,
êê8 9

TerminalId
ëë 
=
ëë 

terminalId
ëë '
,
ëë' (
GlobalId
ìì 
=
ìì 
Guid
ìì 
.
ìì  
NewGuid
ìì  '
(
ìì' (
)
ìì( )
.
ìì) *
ToString
ìì* 2
(
ìì2 3
)
ìì3 4
}
íí 
;
íí 
var
ïï 
result
ïï 
=
ïï 
await
ïï !
_splitBySeatHandler
ïï 2
.
ïï2 3
HandleAsync
ïï3 >
(
ïï> ?
command
ïï? F
)
ïïF G
;
ïïG H
if
ññ 
(
ññ 
result
ññ 
.
ññ 
Success
ññ 
)
ññ 
{
òò 
if
óó 
(
óó 
	parameter
óó 
is
óó  
ContentDialog
óó! .
dialog
óó/ 5
)
óó5 6
{
ôô 
dialog
õõ 
.
õõ 
Hide
õõ 
(
õõ  
)
õõ  !
;
õõ! "
}
öö 
}
÷÷ 
else
øø 
{
ùù 
ErrorMessage
úú 
=
úú 
result
úú %
.
úú% &
ErrorMessage
úú& 2
??
úú3 5
$str
úú6 [
;
úú[ \
HasError
ûû 
=
ûû 
true
ûû 
;
ûû  
}
üü 
}
ýý 	
catch
þþ 
(
þþ 
	Exception
þþ 
ex
þþ 
)
þþ 
{
ÿÿ 	
ErrorMessage
€€ 
=
€€ 
ex
€€ 
.
€€ 
Message
€€ %
;
€€% &
HasError
 
=
 
true
 
;
 
}
‚‚ 	
}
ƒƒ 
}„„ 
public†† 
class
†† 
SeatGroupDto
†† 
{‡‡ 
public
ˆˆ 

int
ˆˆ 

SeatNumber
ˆˆ 
{
ˆˆ 
get
ˆˆ 
;
ˆˆ  
set
ˆˆ! $
;
ˆˆ$ %
}
ˆˆ& '
public
‰‰ 

string
‰‰ 
SeatDisplay
‰‰ 
{
‰‰ 
get
‰‰  #
;
‰‰# $
set
‰‰% (
;
‰‰( )
}
‰‰* +
=
‰‰, -
string
‰‰. 4
.
‰‰4 5
Empty
‰‰5 :
;
‰‰: ;
public
ŠŠ 
"
ObservableCollection
ŠŠ 
<
ŠŠ  
OrderLineDto
ŠŠ  ,
>
ŠŠ, -
Items
ŠŠ. 3
{
ŠŠ4 5
get
ŠŠ6 9
;
ŠŠ9 :
set
ŠŠ; >
;
ŠŠ> ?
}
ŠŠ@ A
=
ŠŠB C
new
ŠŠD G
(
ŠŠG H
)
ŠŠH I
;
ŠŠI J
public
‹‹ 

decimal
‹‹ 
TotalAmount
‹‹ 
{
‹‹  
get
‹‹! $
;
‹‹$ %
set
‹‹& )
;
‹‹) *
}
‹‹+ ,
}ŒŒ ­…
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\ShiftExplorerViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
;		* +
public 
sealed 
class "
ShiftExplorerViewModel *
:+ ,
ViewModelBase- :
{ 
private 
readonly 
IShiftRepository %
_shiftRepository& 6
;6 7
private 
readonly 
ICommandHandler $
<$ %
CreateShiftCommand% 7
,7 8
CreateShiftResult9 J
>J K
_createL S
;S T
private 
readonly 
ICommandHandler $
<$ %
UpdateShiftCommand% 7
,7 8
UpdateShiftResult9 J
>J K
_updateL S
;S T
public 
 
ObservableCollection 
<  
Shift  %
>% &
Shifts' -
{. /
get0 3
;3 4
}5 6
=7 8
new9 <
(< =
)= >
;> ?
private 
Shift 
? 
_selectedShift !
;! "
public 

Shift 
? 
SelectedShift 
{ 
get 
=> 
_selectedShift 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_selectedShift  .
,. /
value0 5
)5 6
)6 7
{ &
HydrateEditorFromSelection *
(* +
)+ ,
;, -
OnPropertyChanged !
(! "
nameof" (
(( )
HasSelection) 5
)5 6
)6 7
;7 8
} 
} 	
} 
public!! 

bool!! 
HasSelection!! 
=>!! 
SelectedShift!!  -
!=!!. 0
null!!1 5
;!!5 6
private## 
string## 
_editingName## 
=##  !
string##" (
.##( )
Empty##) .
;##. /
public$$ 

string$$ 
EditingName$$ 
{%% 
get&& 
=>&& 
_editingName&& 
;&& 
set'' 
=>'' 
SetProperty'' 
('' 
ref'' 
_editingName'' +
,''+ ,
value''- 2
)''2 3
;''3 4
}(( 
private** 
string** 
_editingStartTime** $
=**% &
$str**' .
;**. /
public++ 

string++ 
EditingStartTime++ "
{,, 
get-- 
=>-- 
_editingStartTime--  
;--  !
set.. 
=>.. 
SetProperty.. 
(.. 
ref.. 
_editingStartTime.. 0
,..0 1
value..2 7
)..7 8
;..8 9
}// 
private11 
string11 
_editingEndTime11 "
=11# $
$str11% ,
;11, -
public22 

string22 
EditingEndTime22  
{33 
get44 
=>44 
_editingEndTime44 
;44 
set55 
=>55 
SetProperty55 
(55 
ref55 
_editingEndTime55 .
,55. /
value550 5
)555 6
;556 7
}66 
private88 
bool88 
_editingIsActive88 !
;88! "
public99 

bool99 
EditingIsActive99 
{:: 
get;; 
=>;; 
_editingIsActive;; 
;;;  
set<< 
=><< 
SetProperty<< 
(<< 
ref<< 
_editingIsActive<< /
,<</ 0
value<<1 6
)<<6 7
;<<7 8
}== 
private?? 
string?? 
_statusMessage?? !
=??" #
$str??$ +
;??+ ,
public@@ 

string@@ 
StatusMessage@@ 
{AA 
getBB 
=>BB 
_statusMessageBB 
;BB 
setCC 
=>CC 
SetPropertyCC 
(CC 
refCC 
_statusMessageCC -
,CC- .
valueCC/ 4
)CC4 5
;CC5 6
}DD 
publicFF 

ICommandFF 
LoadCommandFF 
{FF  !
getFF" %
;FF% &
}FF' (
publicGG 

ICommandGG 

AddCommandGG 
{GG  
getGG! $
;GG$ %
}GG& '
publicHH 

ICommandHH 
SaveCommandHH 
{HH  !
getHH" %
;HH% &
}HH' (
publicII 

ICommandII 
DeactivateCommandII %
{II& '
getII( +
;II+ ,
}II- .
publicKK 
"
ShiftExplorerViewModelKK !
(KK! "
IShiftRepositoryLL 
shiftRepositoryLL (
,LL( )
ICommandHandlerMM 
<MM 
CreateShiftCommandMM *
,MM* +
CreateShiftResultMM, =
>MM= >
createMM? E
,MME F
ICommandHandlerNN 
<NN 
UpdateShiftCommandNN *
,NN* +
UpdateShiftResultNN, =
>NN= >
updateNN? E
)NNE F
{OO 
_shiftRepositoryPP 
=PP 
shiftRepositoryPP *
;PP* +
_createQQ 
=QQ 
createQQ 
;QQ 
_updateRR 
=RR 
updateRR 
;RR 
TitleTT 
=TT 
$strTT  
;TT  !
LoadCommandVV 
=VV 
newVV 
AsyncRelayCommandVV +
(VV+ ,
	LoadAsyncVV, 5
)VV5 6
;VV6 7

AddCommandWW 
=WW 
newWW 
AsyncRelayCommandWW *
(WW* +
AddAsyncWW+ 3
)WW3 4
;WW4 5
SaveCommandXX 
=XX 
newXX 
AsyncRelayCommandXX +
(XX+ ,
	SaveAsyncXX, 5
,XX5 6
(XX7 8
)XX8 9
=>XX: <
SelectedShiftXX= J
!=XXK M
nullXXN R
)XXR S
;XXS T
DeactivateCommandYY 
=YY 
newYY 
AsyncRelayCommandYY  1
(YY1 2
DeactivateAsyncYY2 A
,YYA B
(YYC D
)YYD E
=>YYF H
SelectedShiftYYI V
!=YYW Y
nullYYZ ^
)YY^ _
;YY_ `
}ZZ 
private\\ 
void\\ &
HydrateEditorFromSelection\\ +
(\\+ ,
)\\, -
{]] 
if^^ 

(^^ 
SelectedShift^^ 
==^^ 
null^^ !
)^^! "
{__ 	
EditingName`` 
=`` 
string``  
.``  !
Empty``! &
;``& '
EditingStartTimeaa 
=aa 
$straa &
;aa& '
EditingEndTimebb 
=bb 
$strbb $
;bb$ %
EditingIsActivecc 
=cc 
falsecc #
;cc# $
returndd 
;dd 
}ee 	
EditingNamegg 
=gg 
SelectedShiftgg #
.gg# $
Namegg$ (
;gg( )
EditingStartTimehh 
=hh 
SelectedShifthh (
.hh( )
	StartTimehh) 2
.hh2 3
ToStringhh3 ;
(hh; <
$strhh< E
,hhE F
CultureInfohhG R
.hhR S
InvariantCulturehhS c
)hhc d
;hhd e
EditingEndTimeii 
=ii 
SelectedShiftii &
.ii& '
EndTimeii' .
.ii. /
ToStringii/ 7
(ii7 8
$strii8 A
,iiA B
CultureInfoiiC N
.iiN O
InvariantCultureiiO _
)ii_ `
;ii` a
EditingIsActivejj 
=jj 
SelectedShiftjj '
.jj' (
IsActivejj( 0
;jj0 1
}kk 
privatemm 
staticmm 
boolmm 
TryParseTimemm $
(mm$ %
stringmm% +
valuemm, 1
,mm1 2
outmm3 6
TimeSpanmm7 ?
timemm@ D
)mmD E
{nn 
returnoo 
TimeSpanoo 
.oo 
TryParseExactoo %
(oo% &
valueoo& +
,oo+ ,
$stroo- 5
,oo5 6
CultureInfooo7 B
.ooB C
InvariantCultureooC S
,ooS T
outooU X
timeooY ]
)oo] ^
||pp 
TimeSpanpp 
.pp 
TryParseExactpp %
(pp% &
valuepp& +
,pp+ ,
$strpp- 6
,pp6 7
CultureInfopp8 C
.ppC D
InvariantCultureppD T
,ppT U
outppV Y
timeppZ ^
)pp^ _
;pp_ `
}qq 
privatess 
asyncss 
Taskss 
	LoadAsyncss  
(ss  !
)ss! "
{tt 
IsBusyuu 
=uu 
trueuu 
;uu 
tryvv 
{ww 	
varxx 
allxx 
=xx 
awaitxx 
_shiftRepositoryxx ,
.xx, -
GetAllAsyncxx- 8
(xx8 9
)xx9 :
;xx: ;
Shiftsyy 
.yy 
Clearyy 
(yy 
)yy 
;yy 
foreachzz 
(zz 
varzz 
szz 
inzz 
allzz !
)zz! "
{{{ 
Shifts|| 
.|| 
Add|| 
(|| 
s|| 
)|| 
;|| 
}}} 
StatusMessage 
= 
$str %
;% &
}
€€ 	
catch
 
(
 
	Exception
 
ex
 
)
 
{
‚‚ 	
StatusMessage
ƒƒ 
=
ƒƒ 
$"
ƒƒ 
$str
ƒƒ +
{
ƒƒ+ ,
ex
ƒƒ, .
.
ƒƒ. /
Message
ƒƒ/ 6
}
ƒƒ6 7
"
ƒƒ7 8
;
ƒƒ8 9
}
„„ 	
finally
…… 
{
†† 	
IsBusy
‡‡ 
=
‡‡ 
false
‡‡ 
;
‡‡ 
}
ˆˆ 	
}
‰‰ 
private
‹‹ 
async
‹‹ 
Task
‹‹ 
AddAsync
‹‹ 
(
‹‹  
)
‹‹  !
{
ŒŒ 
IsBusy
 
=
 
true
 
;
 
try
ŽŽ 
{
 	
var
 
result
 
=
 
await
 
_create
 &
.
& '
HandleAsync
' 2
(
2 3
new
3 6 
CreateShiftCommand
7 I
{
‘‘ 
Name
’’ 
=
’’ 
$str
’’ "
,
’’" #
	StartTime
““ 
=
““ 
new
““ 
TimeSpan
““  (
(
““( )
$num
““) *
,
““* +
$num
““, -
,
““- .
$num
““/ 0
)
““0 1
,
““1 2
EndTime
”” 
=
”” 
new
”” 
TimeSpan
”” &
(
””& '
$num
””' )
,
””) *
$num
””+ ,
,
””, -
$num
””. /
)
””/ 0
,
””0 1
IsActive
•• 
=
•• 
true
•• 
}
–– 
)
–– 
;
–– 
await
˜˜ 
	LoadAsync
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
SelectedShift
™™ 
=
™™ 
Shifts
™™ "
.
™™" #
FirstOrDefault
™™# 1
(
™™1 2
x
™™2 3
=>
™™4 6
x
™™7 8
.
™™8 9
Id
™™9 ;
==
™™< >
result
™™? E
.
™™E F
ShiftId
™™F M
)
™™M N
;
™™N O
StatusMessage
šš 
=
šš 
$str
šš ,
;
šš, -
}
›› 	
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ 
{
 	
StatusMessage
žž 
=
žž 
$"
žž 
$str
žž -
{
žž- .
ex
žž. 0
.
žž0 1
Message
žž1 8
}
žž8 9
"
žž9 :
;
žž: ;
}
ŸŸ 	
finally
   
{
¡¡ 	
IsBusy
¢¢ 
=
¢¢ 
false
¢¢ 
;
¢¢ 
}
££ 	
}
¤¤ 
private
¦¦ 
async
¦¦ 
Task
¦¦ 
	SaveAsync
¦¦  
(
¦¦  !
)
¦¦! "
{
§§ 
if
¨¨ 

(
¨¨ 
SelectedShift
¨¨ 
==
¨¨ 
null
¨¨ !
)
¨¨! "
return
¨¨# )
;
¨¨) *
if
ªª 

(
ªª 
!
ªª 
TryParseTime
ªª 
(
ªª 
EditingStartTime
ªª *
,
ªª* +
out
ªª, /
var
ªª0 3
start
ªª4 9
)
ªª9 :
)
ªª: ;
{
«« 	
StatusMessage
¬¬ 
=
¬¬ 
$str
¬¬ <
;
¬¬< =
return
­­ 
;
­­ 
}
®® 	
if
°° 

(
°° 
!
°° 
TryParseTime
°° 
(
°° 
EditingEndTime
°° (
,
°°( )
out
°°* -
var
°°. 1
end
°°2 5
)
°°5 6
)
°°6 7
{
±± 	
StatusMessage
²² 
=
²² 
$str
²² :
;
²²: ;
return
³³ 
;
³³ 
}
´´ 	
IsBusy
¶¶ 
=
¶¶ 
true
¶¶ 
;
¶¶ 
try
·· 
{
¸¸ 	
await
¹¹ 
_update
¹¹ 
.
¹¹ 
HandleAsync
¹¹ %
(
¹¹% &
new
¹¹& ) 
UpdateShiftCommand
¹¹* <
{
ºº 
ShiftId
»» 
=
»» 
SelectedShift
»» '
.
»»' (
Id
»»( *
,
»»* +
Name
¼¼ 
=
¼¼ 
EditingName
¼¼ "
,
¼¼" #
	StartTime
½½ 
=
½½ 
start
½½ !
,
½½! "
EndTime
¾¾ 
=
¾¾ 
end
¾¾ 
,
¾¾ 
IsActive
¿¿ 
=
¿¿ 
EditingIsActive
¿¿ *
}
ÀÀ 
)
ÀÀ 
;
ÀÀ 
await
ÂÂ 
	LoadAsync
ÂÂ 
(
ÂÂ 
)
ÂÂ 
;
ÂÂ 
SelectedShift
ÃÃ 
=
ÃÃ 
Shifts
ÃÃ "
.
ÃÃ" #
FirstOrDefault
ÃÃ# 1
(
ÃÃ1 2
x
ÃÃ2 3
=>
ÃÃ4 6
x
ÃÃ7 8
.
ÃÃ8 9
Id
ÃÃ9 ;
==
ÃÃ< >
SelectedShift
ÃÃ? L
.
ÃÃL M
Id
ÃÃM O
)
ÃÃO P
;
ÃÃP Q
StatusMessage
ÄÄ 
=
ÄÄ 
$str
ÄÄ $
;
ÄÄ$ %
}
ÅÅ 	
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
ex
ÆÆ 
)
ÆÆ 
{
ÇÇ 	
StatusMessage
ÈÈ 
=
ÈÈ 
$"
ÈÈ 
$str
ÈÈ +
{
ÈÈ+ ,
ex
ÈÈ, .
.
ÈÈ. /
Message
ÈÈ/ 6
}
ÈÈ6 7
"
ÈÈ7 8
;
ÈÈ8 9
}
ÉÉ 	
finally
ÊÊ 
{
ËË 	
IsBusy
ÌÌ 
=
ÌÌ 
false
ÌÌ 
;
ÌÌ 
}
ÍÍ 	
}
ÎÎ 
private
ÐÐ 
async
ÐÐ 
Task
ÐÐ 
DeactivateAsync
ÐÐ &
(
ÐÐ& '
)
ÐÐ' (
{
ÑÑ 
if
ÒÒ 

(
ÒÒ 
SelectedShift
ÒÒ 
==
ÒÒ 
null
ÒÒ !
)
ÒÒ! "
return
ÒÒ# )
;
ÒÒ) *
IsBusy
ÔÔ 
=
ÔÔ 
true
ÔÔ 
;
ÔÔ 
try
ÕÕ 
{
ÖÖ 	
await
×× 
_update
×× 
.
×× 
HandleAsync
×× %
(
××% &
new
××& ) 
UpdateShiftCommand
××* <
{
ØØ 
ShiftId
ÙÙ 
=
ÙÙ 
SelectedShift
ÙÙ '
.
ÙÙ' (
Id
ÙÙ( *
,
ÙÙ* +
IsActive
ÚÚ 
=
ÚÚ 
false
ÚÚ  
}
ÛÛ 
)
ÛÛ 
;
ÛÛ 
await
ÝÝ 
	LoadAsync
ÝÝ 
(
ÝÝ 
)
ÝÝ 
;
ÝÝ 
SelectedShift
ÞÞ 
=
ÞÞ 
null
ÞÞ  
;
ÞÞ  !
StatusMessage
ßß 
=
ßß 
$str
ßß *
;
ßß* +
}
àà 	
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá 
{
ââ 	
StatusMessage
ãã 
=
ãã 
$"
ãã 
$str
ãã 1
{
ãã1 2
ex
ãã2 4
.
ãã4 5
Message
ãã5 <
}
ãã< =
"
ãã= >
;
ãã> ?
}
ää 	
finally
åå 
{
ææ 	
IsBusy
çç 
=
çç 
false
çç 
;
çç 
}
èè 	
}
éé 
}êê ¹…
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\SettleViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
sealed 
class 
SettleViewModel #
:$ %
ViewModelBase& 3
{ 
private 
readonly 
IQueryHandler "
<" #
GetTicketQuery# 1
,1 2
	TicketDto3 <
?< =
>= >

_getTicket? I
;I J
private 
readonly 
ICommandHandler $
<$ %!
ProcessPaymentCommand% :
,: ; 
ProcessPaymentResult< P
>P Q
_processPaymentR a
;a b
private 
readonly 
ICommandHandler $
<$ %
SetTaxExemptCommand% 8
,8 9
SetTaxExemptResult: L
>L M
_setTaxExemptN [
;[ \
private 
readonly 
ICommandHandler $
<$ %
LogoutCommand% 2
>2 3
_logoutHandler4 B
;B C
private 
readonly 
Services 
. 
NavigationService /
_navigationService0 B
;B C
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly 
ICommandHandler $
<$ %!
OpenCashDrawerCommand% :
>: ;
_openCashDrawer< K
;K L
private 
	TicketDto 
? 
_ticket 
; 
private 
decimal 
_tenderAmount !
;! "
private 
string 
_numpadInput 
=  !
$str" $
;$ %
private 
string 
? 
_error 
; 
private 
string 
? 
_statusMessage "
;" #
private 
Guid 
	_ticketId 
; 
public!! 

SettleViewModel!! 
(!! 
IQueryHandler"" 
<"" 
GetTicketQuery"" $
,""$ %
	TicketDto""& /
?""/ 0
>""0 1
	getTicket""2 ;
,""; <
ICommandHandler## 
<## !
ProcessPaymentCommand## -
,##- . 
ProcessPaymentResult##/ C
>##C D
processPayment##E S
,##S T
ICommandHandler$$ 
<$$ 
SetTaxExemptCommand$$ +
,$$+ ,
SetTaxExemptResult$$- ?
>$$? @
setTaxExempt$$A M
,$$M N
ICommandHandler%% 
<%% 
LogoutCommand%% %
>%%% &
logoutHandler%%' 4
,%%4 5
Services&& 
.&& 
NavigationService&& "
navigationService&&# 4
,&&4 5
IUserService'' 
userService''  
,''  !
ITerminalContext(( 
terminalContext(( (
,((( )"
ICashSessionRepository)) !
cashSessionRepository)) 4
,))4 5
ICommandHandler** 
<** !
OpenCashDrawerCommand** -
>**- .
openCashDrawer**/ =
)**= >
{++ 

_getTicket,, 
=,, 
	getTicket,, 
;,, 
_processPayment-- 
=-- 
processPayment-- (
;--( )
_setTaxExempt.. 
=.. 
setTaxExempt.. $
;..$ %
_logoutHandler// 
=// 
logoutHandler// &
;//& '
_navigationService00 
=00 
navigationService00 .
;00. /
_userService11 
=11 
userService11 "
;11" #
_terminalContext22 
=22 
terminalContext22 *
;22* +"
_cashSessionRepository33 
=33  !
cashSessionRepository33! 6
;336 7
_openCashDrawer44 
=44 
openCashDrawer44 (
;44( )
Title66 
=66 
$str66 
;66  
NumpadCommand88 
=88 
new88 
RelayCommand88 (
<88( )
string88) /
>88/ 0
(880 1
OnNumpadInput881 >
)88> ?
;88? @
ClearNumpadCommand99 
=99 
new99  
RelayCommand99! -
(99- .
OnClearNumpad99. ;
)99; <
;99< =
BackspaceCommand:: 
=:: 
new:: 
RelayCommand:: +
(::+ ,
OnBackspace::, 7
)::7 8
;::8 9!
ProcessPaymentCommand;; 
=;; 
new;;  #
AsyncRelayCommand;;$ 5
<;;5 6
string;;6 <
>;;< =
(;;= >
ProcessPaymentAsync;;> Q
);;Q R
;;;R S"
ToggleTaxExemptCommand<< 
=<<  
new<<! $
AsyncRelayCommand<<% 6
(<<6 7 
ToggleTaxExemptAsync<<7 K
)<<K L
;<<L M
CloseCommand== 
=== 
new== 
RelayCommand== '
(==' (
OnClose==( /
)==/ 0
;==0 1
NextAmountCommand?? 
=?? 
new?? 
RelayCommand??  ,
(??, -
OnNextAmount??- 9
)??9 :
;??: ;
NoSaleCommand@@ 
=@@ 
new@@ 
AsyncRelayCommand@@ -
(@@- .
OnNoSaleAsync@@. ;
)@@; <
;@@< =
LogoutUiCommandAA 
=AA 
newAA 
AsyncRelayCommandAA /
(AA/ 0
OnLogoutAsyncAA0 =
)AA= >
;AA> ?
TestWaitCommandBB 
=BB 
newBB 
AsyncRelayCommandBB /
(BB/ 0
TestWaitAsyncBB0 =
)BB= >
;BB> ?
SwipeCardCommandCC 
=CC 
newCC 
AsyncRelayCommandCC 0
(CC0 1
SwipeCardAsyncCC1 ?
)CC? @
;CC@ A
ExactAmountCommandDD 
=DD 
newDD  
RelayCommandDD! -
(DD- .
OnExactAmountDD. ;
)DD; <
;DD< =
QuickCashCommandEE 
=EE 
newEE 
RelayCommandEE +
<EE+ ,
stringEE, 2
>EE2 3
(EE3 4
OnQuickCashEE4 ?
)EE? @
;EE@ A
}FF 
publicHH 

	TicketDtoHH 
?HH 
TicketHH 
{II 
getJJ 
=>JJ 
_ticketJJ 
;JJ 
privateKK 
setKK 
{LL 	
ifMM 
(MM 
SetPropertyMM 
(MM 
refMM 
_ticketMM  '
,MM' (
valueMM) .
)MM. /
)MM/ 0
{NN 
OnPropertyChangedOO !
(OO! "
nameofOO" (
(OO( )
TotalAmountOO) 4
)OO4 5
)OO5 6
;OO6 7
OnPropertyChangedPP !
(PP! "
nameofPP" (
(PP( )

PaidAmountPP) 3
)PP3 4
)PP4 5
;PP5 6
OnPropertyChangedQQ !
(QQ! "
nameofQQ" (
(QQ( )
	DueAmountQQ) 2
)QQ2 3
)QQ3 4
;QQ4 5
OnPropertyChangedRR !
(RR! "
nameofRR" (
(RR( )
IsTaxExemptRR) 4
)RR4 5
)RR5 6
;RR6 7
OnPropertyChangedSS !
(SS! "
nameofSS" (
(SS( )
	TaxAmountSS) 2
)SS2 3
)SS3 4
;SS4 5
OnPropertyChangedTT !
(TT! "
nameofTT" (
(TT( )
TicketNumberTT) 5
)TT5 6
)TT6 7
;TT7 8
OnPropertyChangedUU !
(UU! "
nameofUU" (
(UU( )
	TableNameUU) 2
)UU2 3
)UU3 4
;UU4 5
ifXX 
(XX 
stringXX 
.XX 
IsNullOrEmptyXX (
(XX( )
_numpadInputXX) 5
)XX5 6
&&XX7 9
valueXX: ?
!=XX@ B
nullXXC G
)XXG H
{YY 
TenderAmountZZ 
=ZZ  !
valueZZ" '
.ZZ' (
	DueAmountZZ( 1
;ZZ1 2
}[[ 
}\\ 
}]] 	
}^^ 
public`` 

decimal`` 
TenderAmount`` 
{aa 
getbb 
=>bb 
_tenderAmountbb 
;bb 
setcc 
=>cc 
SetPropertycc 
(cc 
refcc 
_tenderAmountcc ,
,cc, -
valuecc. 3
)cc3 4
;cc4 5
}dd 
publicff 

stringff 
NumpadInputff 
{gg 
gethh 
=>hh 
_numpadInputhh 
;hh 
setii 
{jj 	
ifkk 
(kk 
SetPropertykk 
(kk 
refkk 
_numpadInputkk  ,
,kk, -
valuekk. 3
)kk3 4
)kk4 5
{ll 
ifmm 
(mm 
decimalmm 
.mm 
TryParsemm $
(mm$ %
valuemm% *
,mm* +
outmm, /
varmm0 3
amountmm4 :
)mm: ;
)mm; <
{nn 
TenderAmountrr  
=rr! "
amountrr# )
;rr) *
}ss 
elsett 
iftt 
(tt 
stringtt 
.tt  
IsNullOrEmptytt  -
(tt- .
valuett. 3
)tt3 4
)tt4 5
{uu 
TenderAmountvv  
=vv! "
$numvv# $
;vv$ %
}ww 
}xx 
}yy 	
}zz 
public|| 

bool|| 
IsTaxExempt|| 
=>|| 
Ticket|| %
?||% &
.||& '
IsTaxExempt||' 2
??||3 5
false||6 ;
;||; <
public}} 

decimal}} 
TotalAmount}} 
=>}} !
Ticket}}" (
?}}( )
.}}) *
TotalAmount}}* 5
??}}6 8
$num}}9 :
;}}: ;
public~~ 

decimal~~ 

PaidAmount~~ 
=>~~  
Ticket~~! '
?~~' (
.~~( )

PaidAmount~~) 3
??~~4 6
$num~~7 8
;~~8 9
public 

decimal 
	DueAmount 
=> 
Ticket  &
?& '
.' (
	DueAmount( 1
??2 4
$num5 6
;6 7
public
€€ 

decimal
€€ 
	TaxAmount
€€ 
=>
€€ 
Ticket
€€  &
?
€€& '
.
€€' (
	TaxAmount
€€( 1
??
€€2 4
$num
€€5 6
;
€€6 7
public
 

string
 
TicketNumber
 
=>
 !
Ticket
" (
!=
) +
null
, 0
?
1 2
$"
3 5
$str
5 =
{
= >
Ticket
> D
.
D E
TicketNumber
E Q
}
Q R
"
R S
:
T U
$str
V a
;
a b
public
‚‚ 

string
‚‚ 
	TableName
‚‚ 
=>
‚‚ 
Ticket
‚‚ %
?
‚‚% &
.
‚‚& '
	TableName
‚‚' 0
??
‚‚1 3
$str
‚‚4 >
;
‚‚> ?
public
„„ 

bool
„„ 
HasDueAmount
„„ 
=>
„„ 
	DueAmount
„„  )
>
„„* +
$num
„„, -
;
„„- .
public
†† 

string
†† 
?
†† 
Error
†† 
{
‡‡ 
get
ˆˆ 
=>
ˆˆ 
_error
ˆˆ 
;
ˆˆ 
set
‰‰ 
{
ŠŠ 	
if
‹‹ 
(
‹‹ 
SetProperty
‹‹ 
(
‹‹ 
ref
‹‹ 
_error
‹‹  &
,
‹‹& '
value
‹‹( -
)
‹‹- .
&&
‹‹/ 1
!
‹‹2 3
string
‹‹3 9
.
‹‹9 :
IsNullOrEmpty
‹‹: G
(
‹‹G H
value
‹‹H M
)
‹‹M N
)
‹‹N O
{
ŒŒ 
StatusMessage
 
=
 
null
  $
;
$ %
}
ŽŽ 
}
 	
}
 
public
’’ 

string
’’ 
?
’’ 
StatusMessage
’’  
{
““ 
get
”” 
=>
”” 
_statusMessage
”” 
;
”” 
set
•• 
{
–– 	
if
—— 
(
—— 
SetProperty
—— 
(
—— 
ref
—— 
_statusMessage
——  .
,
——. /
value
——0 5
)
——5 6
&&
——7 9
!
——: ;
string
——; A
.
——A B
IsNullOrEmpty
——B O
(
——O P
value
——P U
)
——U V
)
——V W
{
˜˜ 
Error
™™ 
=
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
}
œœ 
public
   

RelayCommand
   
<
   
string
   
>
   
NumpadCommand
    -
{
  . /
get
  0 3
;
  3 4
}
  5 6
public
¡¡ 

RelayCommand
¡¡  
ClearNumpadCommand
¡¡ *
{
¡¡+ ,
get
¡¡- 0
;
¡¡0 1
}
¡¡2 3
public
¢¢ 

RelayCommand
¢¢ 
BackspaceCommand
¢¢ (
{
¢¢) *
get
¢¢+ .
;
¢¢. /
}
¢¢0 1
public
££ 

AsyncRelayCommand
££ 
<
££ 
string
££ #
>
££# $#
ProcessPaymentCommand
££% :
{
££; <
get
££= @
;
££@ A
}
££B C
public
¤¤ 

AsyncRelayCommand
¤¤ $
ToggleTaxExemptCommand
¤¤ 3
{
¤¤4 5
get
¤¤6 9
;
¤¤9 :
}
¤¤; <
public
¥¥ 

RelayCommand
¥¥ 
CloseCommand
¥¥ $
{
¥¥% &
get
¥¥' *
;
¥¥* +
}
¥¥, -
public
¦¦ 

RelayCommand
¦¦ 
NextAmountCommand
¦¦ )
{
¦¦* +
get
¦¦, /
;
¦¦/ 0
}
¦¦1 2
public
§§ 

AsyncRelayCommand
§§ 
NoSaleCommand
§§ *
{
§§+ ,
get
§§- 0
;
§§0 1
}
§§2 3
public
¨¨ 

AsyncRelayCommand
¨¨ 
LogoutUiCommand
¨¨ ,
{
¨¨- .
get
¨¨/ 2
;
¨¨2 3
}
¨¨4 5
public
©© 

RelayCommand
©©  
ExactAmountCommand
©© *
{
©©+ ,
get
©©- 0
;
©©0 1
}
©©2 3
public
ªª 

RelayCommand
ªª 
<
ªª 
string
ªª 
>
ªª 
QuickCashCommand
ªª  0
{
ªª1 2
get
ªª3 6
;
ªª6 7
}
ªª8 9
private
¬¬ 
async
¬¬ 
Task
¬¬ 
OnLogoutAsync
¬¬ $
(
¬¬$ %
)
¬¬% &
{
­­ 
try
®® 
{
¯¯ 	
if
±± 
(
±± 
_userService
±± 
.
±± 
CurrentUser
±± (
==
±±) +
null
±±, 0
)
±±0 1
return
±±2 8
;
±±8 9
var
²² 
userId
²² 
=
²² 
_userService
²² %
.
²²% &
CurrentUser
²²& 1
.
²²1 2
Id
²²2 4
;
²²4 5
await
³³ 
_logoutHandler
³³  
.
³³  !
HandleAsync
³³! ,
(
³³, -
new
³³- 0
LogoutCommand
³³1 >
{
³³? @
UserId
³³A G
=
³³H I
userId
³³J P
}
³³Q R
)
³³R S
;
³³S T 
_navigationService
´´ 
.
´´ 
Navigate
´´ '
(
´´' (
typeof
´´( .
(
´´. /
Magidesk
´´/ 7
.
´´7 8
Presentation
´´8 D
.
´´D E
Views
´´E J
.
´´J K
	LoginPage
´´K T
)
´´T U
)
´´U V
;
´´V W
}
µµ 	
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶ 
{
·· 	
Error
¸¸ 
=
¸¸ 
ex
¸¸ 
.
¸¸ 
Message
¸¸ 
;
¸¸ 
}
¹¹ 	
}
ºº 
private
¼¼ 
void
¼¼ 
OnNextAmount
¼¼ 
(
¼¼ 
)
¼¼ 
{
½½ 
if
¾¾ 

(
¾¾ 
	DueAmount
¾¾ 
<=
¾¾ 
$num
¾¾ 
)
¾¾ 
return
¾¾ "
;
¾¾" #
var
ÂÂ 
nextAmt
ÂÂ 
=
ÂÂ 
Math
ÂÂ 
.
ÂÂ 
Ceiling
ÂÂ "
(
ÂÂ" #
	DueAmount
ÂÂ# ,
)
ÂÂ, -
;
ÂÂ- .
if
ÃÃ 

(
ÃÃ 
nextAmt
ÃÃ 
==
ÃÃ 
	DueAmount
ÃÃ  
)
ÃÃ  !
{
ÄÄ 	
}
ÇÇ 	
NumpadInput
ÊÊ 
=
ÊÊ 
nextAmt
ÊÊ 
.
ÊÊ 
ToString
ÊÊ &
(
ÊÊ& '
$str
ÊÊ' +
)
ÊÊ+ ,
;
ÊÊ, -
TenderAmount
ËË 
=
ËË 
nextAmt
ËË 
;
ËË 
}
ÌÌ 
private
ÎÎ 
void
ÎÎ 
OnExactAmount
ÎÎ 
(
ÎÎ 
)
ÎÎ  
{
ÏÏ 
if
ÑÑ 

(
ÑÑ 
	DueAmount
ÑÑ 
<=
ÑÑ 
$num
ÑÑ 
)
ÑÑ 
return
ÑÑ "
;
ÑÑ" #
TenderAmount
×× 
=
×× 
	DueAmount
××  
;
××  !
NumpadInput
ØØ 
=
ØØ 
	DueAmount
ØØ 
.
ØØ  
ToString
ØØ  (
(
ØØ( )
$str
ØØ) -
)
ØØ- .
;
ØØ. /
}
ÙÙ 
private
ÛÛ 
void
ÛÛ 
OnQuickCash
ÛÛ 
(
ÛÛ 
string
ÛÛ #
?
ÛÛ# $
	amountStr
ÛÛ% .
)
ÛÛ. /
{
ÜÜ 
if
ÞÞ 

(
ÞÞ 
decimal
ÞÞ 
.
ÞÞ 
TryParse
ÞÞ 
(
ÞÞ 
	amountStr
ÞÞ &
,
ÞÞ& '
out
ÞÞ( +
var
ÞÞ, /
amount
ÞÞ0 6
)
ÞÞ6 7
)
ÞÞ7 8
{
ßß 	
if
àà 
(
àà 
amount
àà 
<=
àà 
$num
àà 
)
àà 
return
àà #
;
àà# $
var
ãã 
newTenderAmount
ãã 
=
ãã  !
TenderAmount
ãã" .
+
ãã/ 0
amount
ãã1 7
;
ãã7 8
TenderAmount
ää 
=
ää 
newTenderAmount
ää *
;
ää* +
NumpadInput
åå 
=
åå 
newTenderAmount
åå )
.
åå) *
ToString
åå* 2
(
åå2 3
$str
åå3 7
)
åå7 8
;
åå8 9
}
ææ 	
}
çç 
private
éé 
async
éé 
Task
éé 
OnNoSaleAsync
éé $
(
éé$ %
)
éé% &
{
êê 
IsBusy
íí 
=
íí 
true
íí 
;
íí 
try
îî 
{
ïï 	
await
ðð 
_openCashDrawer
ðð !
.
ðð! "
HandleAsync
ðð" -
(
ðð- .
new
ðð. 1#
OpenCashDrawerCommand
ðð2 G
(
ððG H
)
ððH I
)
ððI J
;
ððJ K
StatusMessage
ññ 
=
ññ 
$str
ññ 5
;
ññ5 6
}
òò 	
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó 
{
óó 
Error
óó $
=
óó% &
ex
óó' )
.
óó) *
Message
óó* 1
;
óó1 2
}
óó3 4
finally
ôô 
{
ôô 
IsBusy
ôô 
=
ôô 
false
ôô  
;
ôô  !
}
ôô" #
}
õõ 
public
÷÷ 

async
÷÷ 
Task
÷÷ 
InitializeAsync
÷÷ %
(
÷÷% &
Guid
÷÷& *
ticketId
÷÷+ 3
)
÷÷3 4
{
øø 
	_ticketId
ùù 
=
ùù 
ticketId
ùù 
;
ùù 
await
úú 
LoadTicketAsync
úú 
(
úú 
)
úú 
;
úú  
}
ûû 
private
ýý 
async
ýý 
Task
ýý 
LoadTicketAsync
ýý &
(
ýý& '
)
ýý' (
{
þþ 
IsBusy
ÿÿ 
=
ÿÿ 
true
ÿÿ 
;
ÿÿ 
Error
€€ 
=
€€ 
null
€€ 
;
€€ 
try
 
{
‚‚ 	
Ticket
ƒƒ 
=
ƒƒ 
await
ƒƒ 

_getTicket
ƒƒ %
.
ƒƒ% &
HandleAsync
ƒƒ& 1
(
ƒƒ1 2
new
ƒƒ2 5
GetTicketQuery
ƒƒ6 D
{
ƒƒE F
TicketId
ƒƒG O
=
ƒƒP Q
	_ticketId
ƒƒR [
}
ƒƒ\ ]
)
ƒƒ] ^
;
ƒƒ^ _
if
„„ 
(
„„ 
Ticket
„„ 
==
„„ 
null
„„ 
)
„„ 
{
…… 
Error
†† 
=
†† 
$str
†† +
;
††+ ,
}
‡‡ 
}
ˆˆ 	
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰ 
{
ŠŠ 	
Error
‹‹ 
=
‹‹ 
ex
‹‹ 
.
‹‹ 
Message
‹‹ 
;
‹‹ 
}
ŒŒ 	
finally
 
{
ŽŽ 	
IsBusy
 
=
 
false
 
;
 
}
 	
}
‘‘ 
private
““ 
void
““ 
OnNumpadInput
““ 
(
““ 
string
““ %
?
““% &
value
““' ,
)
““, -
{
”” 
if
•• 

(
•• 
value
•• 
==
•• 
null
•• 
)
•• 
return
•• !
;
••! "
if
—— 

(
—— 
value
—— 
==
—— 
$str
—— 
)
—— 
{
˜˜ 	
if
™™ 
(
™™ 
!
™™ 
NumpadInput
™™ 
.
™™ 
Contains
™™ %
(
™™% &
$str
™™& )
)
™™) *
)
™™* +
{
šš 
NumpadInput
›› 
+=
›› 
$str
›› "
;
››" #
}
œœ 
}
 	
else
žž 
{
ŸŸ 	
NumpadInput
   
+=
   
value
    
;
    !
}
¡¡ 	
}
¢¢ 
private
¤¤ 
void
¤¤ 
OnClearNumpad
¤¤ 
(
¤¤ 
)
¤¤  
{
¥¥ 
NumpadInput
¦¦ 
=
¦¦ 
$str
¦¦ 
;
¦¦ 
TenderAmount
§§ 
=
§§ 
$num
§§ 
;
§§ 
}
¨¨ 
private
ªª 
void
ªª 
OnBackspace
ªª 
(
ªª 
)
ªª 
{
«« 
if
¬¬ 

(
¬¬ 
NumpadInput
¬¬ 
.
¬¬ 
Length
¬¬ 
>
¬¬  
$num
¬¬! "
)
¬¬" #
{
­­ 	
NumpadInput
®® 
=
®® 
NumpadInput
®® %
[
®®% &
..
®®& (
^
®®( )
$num
®®) *
]
®®* +
;
®®+ ,
}
¯¯ 	
}
°° 
private
²² 
async
²² 
Task
²² "
ToggleTaxExemptAsync
²² +
(
²²+ ,
)
²², -
{
³³ 
if
´´ 

(
´´ 
Ticket
´´ 
==
´´ 
null
´´ 
)
´´ 
return
´´ "
;
´´" #
IsBusy
¶¶ 
=
¶¶ 
true
¶¶ 
;
¶¶ 
Error
·· 
=
·· 
null
·· 
;
·· 
try
¸¸ 
{
¹¹ 	
var
ºº 
result
ºº 
=
ºº 
await
ºº 
_setTaxExempt
ºº ,
.
ºº, -
HandleAsync
ºº- 8
(
ºº8 9
new
ºº9 <!
SetTaxExemptCommand
ºº= P
{
»» 
TicketId
¼¼ 
=
¼¼ 
Ticket
¼¼ !
.
¼¼! "
Id
¼¼" $
,
¼¼$ %
IsTaxExempt
½½ 
=
½½ 
!
½½ 
Ticket
½½ %
.
½½% &
IsTaxExempt
½½& 1
,
½½1 2

ModifiedBy
¾¾ 
=
¾¾ 
_userService
¾¾ )
.
¾¾) *
CurrentUser
¾¾* 5
!=
¾¾6 8
null
¾¾9 =
?
¾¾> ?
new
¾¾@ C
UserId
¾¾D J
(
¾¾J K
_userService
¾¾K W
.
¾¾W X
CurrentUser
¾¾X c
.
¾¾c d
Id
¾¾d f
)
¾¾f g
:
¾¾h i
new
¾¾j m
UserId
¾¾n t
(
¾¾t u
Guid
¾¾u y
.
¾¾y z
Empty
¾¾z 
)¾¾ €
}
¿¿ 
)
¿¿ 
;
¿¿ 
if
ÁÁ 
(
ÁÁ 
result
ÁÁ 
.
ÁÁ 
Success
ÁÁ 
)
ÁÁ 
{
ÂÂ 
await
ÃÃ 
LoadTicketAsync
ÃÃ %
(
ÃÃ% &
)
ÃÃ& '
;
ÃÃ' (
}
ÄÄ 
else
ÅÅ 
{
ÆÆ 
Error
ÇÇ 
=
ÇÇ 
result
ÇÇ 
.
ÇÇ 
Error
ÇÇ $
;
ÇÇ$ %
}
ÈÈ 
}
ÉÉ 	
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ 
{
ËË 	
Error
ÌÌ 
=
ÌÌ 
ex
ÌÌ 
.
ÌÌ 
Message
ÌÌ 
;
ÌÌ 
}
ÍÍ 	
finally
ÎÎ 
{
ÏÏ 	
IsBusy
ÐÐ 
=
ÐÐ 
false
ÐÐ 
;
ÐÐ 
}
ÑÑ 	
}
ÒÒ 
private
ÔÔ 
async
ÔÔ 
Task
ÔÔ !
ProcessPaymentAsync
ÔÔ *
(
ÔÔ* +
string
ÔÔ+ 1
?
ÔÔ1 2
paymentTypeString
ÔÔ3 D
)
ÔÔD E
{
ÕÕ 
if
ÖÖ 

(
ÖÖ 
Ticket
ÖÖ 
==
ÖÖ 
null
ÖÖ 
||
ÖÖ 
string
ÖÖ $
.
ÖÖ$ %
IsNullOrEmpty
ÖÖ% 2
(
ÖÖ2 3
paymentTypeString
ÖÖ3 D
)
ÖÖD E
)
ÖÖE F
return
ÖÖG M
;
ÖÖM N
if
ØØ 

(
ØØ 
!
ØØ 
Enum
ØØ 
.
ØØ 
TryParse
ØØ 
<
ØØ 
Magidesk
ØØ #
.
ØØ# $
Domain
ØØ$ *
.
ØØ* +
Enumerations
ØØ+ 7
.
ØØ7 8
PaymentType
ØØ8 C
>
ØØC D
(
ØØD E
paymentTypeString
ØØE V
,
ØØV W
out
ØØX [
var
ØØ\ _
paymentType
ØØ` k
)
ØØk l
)
ØØl m
{
ÙÙ 	
Error
ÚÚ 
=
ÚÚ 
$"
ÚÚ 
$str
ÚÚ ,
{
ÚÚ, -
paymentTypeString
ÚÚ- >
}
ÚÚ> ?
"
ÚÚ? @
;
ÚÚ@ A
return
ÛÛ 
;
ÛÛ 
}
ÜÜ 	
IsBusy
ÞÞ 
=
ÞÞ 
true
ÞÞ 
;
ÞÞ 
Error
ßß 
=
ßß 
null
ßß 
;
ßß 
try
àà 
{
áá 	
var
åå 
amountToPay
åå 
=
åå 
TenderAmount
åå *
>
åå+ ,
$num
åå- .
&&
åå/ 1
TenderAmount
åå2 >
<
åå? @
	DueAmount
ååA J
?
ææ 
TenderAmount
ææ 
:
çç 
	DueAmount
çç 
;
çç 
if
éé 
(
éé 
TenderAmount
éé 
>
éé 
$num
éé  
&&
éé! #
TenderAmount
éé$ 0
>=
éé1 3
	DueAmount
éé4 =
)
éé= >
{
êê 
amountToPay
ëë 
=
ëë 
	DueAmount
ëë '
;
ëë' (
}
ìì 
if
ïï 
(
ïï 
TenderAmount
ïï 
<=
ïï 
$num
ïï  !
)
ïï! "
{
ðð 
amountToPay
ññ 
=
ññ 
	DueAmount
ññ '
;
ññ' (
TenderAmount
òò 
=
òò 
	DueAmount
òò (
;
òò( )
}
óó 
var
öö 
currency
öö 
=
öö 
$str
öö  
;
öö  !
if
øø 
(
øø 
_userService
øø 
.
øø 
CurrentUser
øø (
==
øø) +
null
øø, 0
||
øø1 3
_terminalContext
øø4 D
.
øøD E

TerminalId
øøE O
==
øøP R
null
øøS W
)
øøW X
{
ùù 
Error
úú 
=
úú 
$str
úú ;
;
úú; <
return
ûû 
;
ûû 
}
üü 
var
þþ 
userId
þþ 
=
þþ 
_userService
þþ %
.
þþ% &
CurrentUser
þþ& 1
.
þþ1 2
Id
þþ2 4
;
þþ4 5
var
ÿÿ 

terminalId
ÿÿ 
=
ÿÿ 
_terminalContext
ÿÿ -
.
ÿÿ- .

TerminalId
ÿÿ. 8
.
ÿÿ8 9
Value
ÿÿ9 >
;
ÿÿ> ?
var
 
command
 
=
 
new
 #
ProcessPaymentCommand
 3
{
‚‚ 
TicketId
ƒƒ 
=
ƒƒ 
Ticket
ƒƒ !
.
ƒƒ! "
Id
ƒƒ" $
,
ƒƒ$ %
PaymentType
„„ 
=
„„ 
paymentType
„„ )
,
„„) *
Amount
…… 
=
…… 
new
…… 
Money
…… "
(
……" #
amountToPay
……# .
,
……. /
currency
……0 8
)
……8 9
,
……9 :
ProcessedBy
†† 
=
†† 
new
†† !
UserId
††" (
(
††( )
userId
††) /
)
††/ 0
,
††0 1

TerminalId
‡‡ 
=
‡‡ 

terminalId
‡‡ '
,
‡‡' (
GlobalId
ˆˆ 
=
ˆˆ 
Guid
ˆˆ 
.
ˆˆ  
NewGuid
ˆˆ  '
(
ˆˆ' (
)
ˆˆ( )
.
ˆˆ) *
ToString
ˆˆ* 2
(
ˆˆ2 3
)
ˆˆ3 4
}
‰‰ 
;
‰‰ 
if
‹‹ 
(
‹‹ 
paymentType
‹‹ 
==
‹‹ 
PaymentType
‹‹ *
.
‹‹* +
Cash
‹‹+ /
)
‹‹/ 0
{
ŒŒ 
command
 
.
 
TenderAmount
 %
=
& '
new
( +
Money
, 1
(
1 2
TenderAmount
2 >
,
> ?
currency
@ H
)
H I
;
I J
var
 
session
 
=
 
await
 $$
_cashSessionRepository
% ;
.
; <-
GetOpenSessionByTerminalIdAsync
< [
(
[ \

terminalId
\ f
)
f g
;
g h
if
‘‘ 
(
‘‘ 
session
‘‘ 
!=
‘‘ 
null
‘‘  $
)
‘‘$ %
{
’’ 
command
““ 
.
““ 
CashSessionId
““ *
=
““+ ,
session
““- 4
.
““4 5
Id
““5 7
;
““7 8
}
”” 
else
•• 
{
–– 
Error
™™ 
=
™™ 
$str
™™ 6
;
™™6 7
return
šš 
;
šš 
}
›› 
}
œœ 
else
 
if
 
(
 
paymentType
  
==
! #
PaymentType
$ /
.
/ 0

CreditCard
0 :
)
: ;
{
žž 
command
   
.
   
Last4
   
=
   
$str
    &
;
  & '
command
¡¡ 
.
¡¡ 
CardType
¡¡  
=
¡¡! "
$str
¡¡# )
;
¡¡) *
command
¢¢ 
.
¢¢ 
AuthCode
¢¢  
=
¢¢! "
$str
¢¢# ,
;
¢¢, -
}
££ 
else
¤¤ 
if
¤¤ 
(
¤¤ 
paymentType
¤¤  
==
¤¤! #
PaymentType
¤¤$ /
.
¤¤/ 0
GiftCertificate
¤¤0 ?
)
¤¤? @
{
¥¥ 
command
§§ 
.
§§ 
GiftCardNumber
§§ &
=
§§' (
$str
§§) 5
;
§§5 6
}
¨¨ 
var
ªª 
result
ªª 
=
ªª 
await
ªª 
_processPayment
ªª .
.
ªª. /
HandleAsync
ªª/ :
(
ªª: ;
command
ªª; B
)
ªªB C
;
ªªC D
if
¬¬ 
(
¬¬ 
result
¬¬ 
.
¬¬ 
TicketIsPaid
¬¬ #
)
¬¬# $
{
­­ 
OnClose
¯¯ 
(
¯¯ 
)
¯¯ 
;
¯¯ 
}
°° 
else
±± 
{
²² 
await
´´ 
LoadTicketAsync
´´ %
(
´´% &
)
´´& '
;
´´' (
OnClearNumpad
·· 
(
·· 
)
·· 
;
··  
}
¸¸ 
if
ºº 
(
ºº 
paymentType
ºº 
==
ºº 
PaymentType
ºº *
.
ºº* +
Cash
ºº+ /
&&
ºº0 2
result
ºº3 9
.
ºº9 :
ChangeAmount
ºº: F
.
ººF G
Amount
ººG M
>
ººN O
$num
ººP Q
)
ººQ R
{
»» 
var
½½ 
changeDialog
½½ !
=
½½" #
new
½½$ '
	Microsoft
½½( 1
.
½½1 2
UI
½½2 4
.
½½4 5
Xaml
½½5 9
.
½½9 :
Controls
½½: B
.
½½B C
ContentDialog
½½C P
{
¾¾ 
Title
¿¿ 
=
¿¿ 
$str
¿¿ )
,
¿¿) *
Content
ÀÀ 
=
ÀÀ 
$"
ÀÀ !
$str
ÀÀ! F
{
ÀÀF G
result
ÀÀG M
.
ÀÀM N
ChangeAmount
ÀÀN Z
}
ÀÀZ [
"
ÀÀ[ \
,
ÀÀ\ ]
CloseButtonText
ÁÁ $
=
ÁÁ% &
$str
ÁÁ' +
,
ÁÁ+ ,
XamlRoot
ÂÂ 
=
ÂÂ 
App
ÂÂ  #
.
ÂÂ# $ 
MainWindowInstance
ÂÂ$ 6
.
ÂÂ6 7
Content
ÂÂ7 >
.
ÂÂ> ?
XamlRoot
ÂÂ? G
}
ÃÃ 
;
ÃÃ 
await
ÄÄ  
_navigationService
ÄÄ )
.
ÄÄ) *
ShowDialogAsync
ÄÄ* 9
(
ÄÄ9 :
changeDialog
ÄÄ: F
)
ÄÄF G
;
ÄÄG H
Error
ÆÆ 
=
ÆÆ 
$"
ÆÆ 
$str
ÆÆ '
{
ÆÆ' (
result
ÆÆ( .
.
ÆÆ. /
ChangeAmount
ÆÆ/ ;
}
ÆÆ; <
"
ÆÆ< =
;
ÆÆ= >
}
ÇÇ 
}
ÈÈ 	
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ 
{
ÊÊ 	
Error
ËË 
=
ËË 
ex
ËË 
.
ËË 
Message
ËË 
;
ËË 
var
ÎÎ 
dialog
ÎÎ 
=
ÎÎ 
new
ÎÎ 
	Microsoft
ÎÎ '
.
ÎÎ' (
UI
ÎÎ( *
.
ÎÎ* +
Xaml
ÎÎ+ /
.
ÎÎ/ 0
Controls
ÎÎ0 8
.
ÎÎ8 9
ContentDialog
ÎÎ9 F
{
ÏÏ 
Title
ÐÐ 
=
ÐÐ 
$str
ÐÐ )
,
ÐÐ) *
Content
ÑÑ 
=
ÑÑ 
$"
ÑÑ 
$str
ÑÑ J
{
ÑÑJ K
ex
ÑÑK M
.
ÑÑM N
Message
ÑÑN U
}
ÑÑU V
"
ÑÑV W
,
ÑÑW X
CloseButtonText
ÒÒ  
=
ÒÒ! "
$str
ÒÒ# '
,
ÒÒ' (
XamlRoot
ÓÓ 
=
ÓÓ 
App
ÓÓ 
.
ÓÓ   
MainWindowInstance
ÓÓ  2
.
ÓÓ2 3
Content
ÓÓ3 :
.
ÓÓ: ;
XamlRoot
ÓÓ; C
}
ÔÔ 
;
ÔÔ 
await
ÕÕ  
_navigationService
ÕÕ %
.
ÕÕ% &
ShowDialogAsync
ÕÕ& 5
(
ÕÕ5 6
dialog
ÕÕ6 <
)
ÕÕ< =
;
ÕÕ= >
}
ÖÖ 	
finally
×× 
{
ØØ 	
IsBusy
ÙÙ 
=
ÙÙ 
false
ÙÙ 
;
ÙÙ 
}
ÚÚ 	
}
ÛÛ 
private
ÝÝ 
void
ÝÝ 
OnClose
ÝÝ 
(
ÝÝ 
)
ÝÝ 
{
ÞÞ 
if
ßß 

(
ßß 
Ticket
ßß 
!=
ßß 
null
ßß 
&&
ßß 
(
ßß 
Ticket
ßß %
.
ßß% &
Status
ßß& ,
==
ßß- /
TicketStatus
ßß0 <
.
ßß< =
Paid
ßß= A
||
ßßB D
Ticket
ßßE K
.
ßßK L
Status
ßßL R
==
ßßS U
TicketStatus
ßßV b
.
ßßb c
Closed
ßßc i
)
ßßi j
)
ßßj k
{
àà 	 
_navigationService
ââ 
.
ââ 
Navigate
ââ '
(
ââ' (
typeof
ââ( .
(
ââ. /
Magidesk
ââ/ 7
.
ââ7 8
Presentation
ââ8 D
.
ââD E
Views
ââE J
.
ââJ K
SwitchboardPage
ââK Z
)
ââZ [
)
ââ[ \
;
ââ\ ]
}
ãã 	
else
ää 
{
åå 	 
_navigationService
ææ 
.
ææ 
GoBack
ææ %
(
ææ% &
)
ææ& '
;
ææ' (
}
çç 	
}
èè 
public
êê 

AsyncRelayCommand
êê 
TestWaitCommand
êê ,
{
êê- .
get
êê/ 2
;
êê2 3
}
êê4 5
public
ëë 

AsyncRelayCommand
ëë 
SwipeCardCommand
ëë -
{
ëë. /
get
ëë0 3
;
ëë3 4
}
ëë5 6
private
íí 
async
íí 
Task
íí 
TestWaitAsync
íí $
(
íí$ %
)
íí% &
{
îî 
var
ïï 
dialog
ïï 
=
ïï 
new
ïï 
Magidesk
ïï !
.
ïï! "
Views
ïï" '
.
ïï' (&
PaymentProcessWaitDialog
ïï( @
(
ïï@ A
)
ïïA B
;
ïïB C
dialog
ðð 
.
ðð 
	ViewModel
ðð 
.
ðð 

SetMessage
ðð #
(
ðð# $
$str
ðð$ A
)
ððA B
;
ððB C
var
ùù 
	closeTask
ùù 
=
ùù 
Task
ùù 
.
ùù 
Run
ùù  
(
ùù  !
async
ùù! &
(
ùù' (
)
ùù( )
=>
ùù* ,
{
úú 	
try
ûû 
{
üü 
await
ýý 
Task
ýý 
.
ýý 
Delay
ýý  
(
ýý  !
$num
ýý! %
)
ýý% &
;
ýý& ' 
_navigationService
ÿÿ "
.
ÿÿ" #
DispatcherQueue
ÿÿ# 2
.
ÿÿ2 3

TryEnqueue
ÿÿ3 =
(
ÿÿ= >
(
ÿÿ> ?
)
ÿÿ? @
=>
ÿÿA C
{
€€ 
dialog
 
.
 
	ViewModel
 $
.
$ %

AllowClose
% /
(
/ 0
)
0 1
;
1 2
dialog
‚‚ 
.
‚‚ 
Hide
‚‚ 
(
‚‚  
)
‚‚  !
;
‚‚! "
}
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
„„ 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
†† 
System
‡‡ 
.
‡‡ 
Diagnostics
‡‡ "
.
‡‡" #
Debug
‡‡# (
.
‡‡( )
	WriteLine
‡‡) 2
(
‡‡2 3
$"
‡‡3 5
$str
‡‡5 M
{
‡‡M N
ex
‡‡N P
}
‡‡P Q
"
‡‡Q R
)
‡‡R S
;
‡‡S T
}
ˆˆ 
}
‰‰ 	
)
‰‰	 

;
‰‰
 
await
‹‹  
_navigationService
‹‹  
.
‹‹  !
ShowDialogAsync
‹‹! 0
(
‹‹0 1
dialog
‹‹1 7
)
‹‹7 8
;
‹‹8 9
}
ŒŒ 
private
ŽŽ 
async
ŽŽ 
Task
ŽŽ 
SwipeCardAsync
ŽŽ %
(
ŽŽ% &
)
ŽŽ& '
{
 
if
 

(
 
Ticket
 
==
 
null
 
)
 
return
 "
;
" #
var
’’ 
dialog
’’ 
=
’’ 
new
’’ 
Magidesk
’’ !
.
’’! "
Views
’’" '
.
’’' (
SwipeCardDialog
’’( 7
(
’’7 8
)
’’8 9
;
’’9 :
var
““ 
result
““ 
=
““ 
await
““  
_navigationService
““ -
.
““- .
ShowDialogAsync
““. =
(
““= >
dialog
““> D
)
““D E
;
““E F
if
šš 

(
šš 
result
šš 
==
šš 
	Microsoft
šš 
.
šš  
UI
šš  "
.
šš" #
Xaml
šš# '
.
šš' (
Controls
šš( 0
.
šš0 1!
ContentDialogResult
šš1 D
.
ššD E
Primary
ššE L
)
ššL M
{
›› 	
var
 

authDialog
 
=
 
new
  
Magidesk
! )
.
) *
Views
* /
.
/ 0%
AuthorizationCodeDialog
0 G
(
G H
)
H I
;
I J
var
žž 

authResult
žž 
=
žž 
await
žž " 
_navigationService
žž# 5
.
žž5 6
ShowDialogAsync
žž6 E
(
žžE F

authDialog
žžF P
)
žžP Q
;
žžQ R
if
   
(
   

authResult
   
==
   
	Microsoft
   '
.
  ' (
UI
  ( *
.
  * +
Xaml
  + /
.
  / 0
Controls
  0 8
.
  8 9!
ContentDialogResult
  9 L
.
  L M
Primary
  M T
)
  T U
{
¡¡ 
var
££ 
authCode
££ 
=
££ 

authDialog
££ )
.
££) *
	ViewModel
££* 3
.
££3 4
AuthCode
££4 <
;
££< =
var
¤¤ 
cardType
¤¤ 
=
¤¤ 

authDialog
¤¤ )
.
¤¤) *
	ViewModel
¤¤* 3
.
¤¤3 4
SelectedCardType
¤¤4 D
;
¤¤D E
if
¦¦ 
(
¦¦ 
!
¦¦ 
string
¦¦ 
.
¦¦  
IsNullOrWhiteSpace
¦¦ .
(
¦¦. /
authCode
¦¦/ 7
)
¦¦7 8
)
¦¦8 9
{
§§ 
await
©© +
ProcessCreditCardPaymentAsync
©© 7
(
©©7 8
cardType
©©8 @
,
©©@ A
authCode
©©B J
,
©©J K
$str
©©L _
)
©©_ `
;
©©` a
}
ªª 
}
«« 
}
¬¬ 	
else
­­ 
if
­­ 
(
­­ 
result
­­ 
==
­­ 
	Microsoft
­­ $
.
­­$ %
UI
­­% '
.
­­' (
Xaml
­­( ,
.
­­, -
Controls
­­- 5
.
­­5 6!
ContentDialogResult
­­6 I
.
­­I J
	Secondary
­­J S
)
­­S T
{
®® 	
var
°° 

authDialog
°° 
=
°° 
new
°°  
Magidesk
°°! )
.
°°) *
Views
°°* /
.
°°/ 0%
AuthorizationCodeDialog
°°0 G
(
°°G H
)
°°H I
;
°°I J
var
±± 

authResult
±± 
=
±± 
await
±± " 
_navigationService
±±# 5
.
±±5 6
ShowDialogAsync
±±6 E
(
±±E F

authDialog
±±F P
)
±±P Q
;
±±Q R
if
³³ 
(
³³ 

authResult
³³ 
==
³³ 
	Microsoft
³³ '
.
³³' (
UI
³³( *
.
³³* +
Xaml
³³+ /
.
³³/ 0
Controls
³³0 8
.
³³8 9!
ContentDialogResult
³³9 L
.
³³L M
Primary
³³M T
)
³³T U
{
´´ 
var
¶¶ 
authCode
¶¶ 
=
¶¶ 

authDialog
¶¶ )
.
¶¶) *
	ViewModel
¶¶* 3
.
¶¶3 4
AuthCode
¶¶4 <
;
¶¶< =
var
·· 
cardType
·· 
=
·· 

authDialog
·· )
.
··) *
	ViewModel
··* 3
.
··3 4
SelectedCardType
··4 D
;
··D E
if
¹¹ 
(
¹¹ 
!
¹¹ 
string
¹¹ 
.
¹¹  
IsNullOrWhiteSpace
¹¹ .
(
¹¹. /
authCode
¹¹/ 7
)
¹¹7 8
)
¹¹8 9
{
ºº 
await
¼¼ +
ProcessCreditCardPaymentAsync
¼¼ 7
(
¼¼7 8
cardType
¼¼8 @
,
¼¼@ A
authCode
¼¼B J
,
¼¼J K
$str
¼¼L X
)
¼¼X Y
;
¼¼Y Z
}
½½ 
}
¾¾ 
}
¿¿ 	
else
ÀÀ 
{
ÁÁ 	
if
ÃÃ 
(
ÃÃ 
!
ÃÃ 
string
ÃÃ 
.
ÃÃ 
IsNullOrEmpty
ÃÃ %
(
ÃÃ% &
dialog
ÃÃ& ,
.
ÃÃ, -
	ViewModel
ÃÃ- 6
.
ÃÃ6 7
	SwipeData
ÃÃ7 @
)
ÃÃ@ A
)
ÃÃA B
{
ÄÄ 
await
ÆÆ +
ProcessCreditCardPaymentAsync
ÆÆ 3
(
ÆÆ3 4
$str
ÆÆ4 :
,
ÆÆ: ;
$str
ÆÆ< C
+
ÆÆD E
DateTime
ÆÆF N
.
ÆÆN O
Now
ÆÆO R
.
ÆÆR S
ToString
ÆÆS [
(
ÆÆ[ \
$str
ÆÆ\ l
)
ÆÆl m
,
ÆÆm n
$str
ÆÆo {
)
ÆÆ{ |
;
ÆÆ| }
}
ÇÇ 
}
ÈÈ 	
}
ÉÉ 
private
ËË 
async
ËË 
Task
ËË +
ProcessCreditCardPaymentAsync
ËË 4
(
ËË4 5
string
ËË5 ;
cardType
ËË< D
,
ËËD E
string
ËËF L
authCode
ËËM U
,
ËËU V
string
ËËW ]

authMethod
ËË^ h
)
ËËh i
{
ÌÌ 
IsBusy
ÍÍ 
=
ÍÍ 
true
ÍÍ 
;
ÍÍ 
Error
ÎÎ 
=
ÎÎ 
null
ÎÎ 
;
ÎÎ 
try
ÐÐ 
{
ÑÑ 	
var
ÓÓ 

waitDialog
ÓÓ 
=
ÓÓ 
new
ÓÓ  
Magidesk
ÓÓ! )
.
ÓÓ) *
Views
ÓÓ* /
.
ÓÓ/ 0&
PaymentProcessWaitDialog
ÓÓ0 H
(
ÓÓH I
)
ÓÓI J
;
ÓÓJ K

waitDialog
ÔÔ 
.
ÔÔ 
	ViewModel
ÔÔ  
.
ÔÔ  !
Message
ÔÔ! (
=
ÔÔ) *
$"
ÔÔ+ -
$str
ÔÔ- 8
{
ÔÔ8 9
cardType
ÔÔ9 A
}
ÔÔA B
$str
ÔÔB M
"
ÔÔM N
;
ÔÔN O
var
×× 
showDialogTask
×× 
=
××   
_navigationService
××! 3
.
××3 4
ShowDialogAsync
××4 C
(
××C D

waitDialog
××D N
)
××N O
;
××O P
await
ÚÚ 
Task
ÚÚ 
.
ÚÚ 
Delay
ÚÚ 
(
ÚÚ 
$num
ÚÚ !
)
ÚÚ! "
;
ÚÚ" # 
_navigationService
ÝÝ 
.
ÝÝ 
DispatcherQueue
ÝÝ .
.
ÝÝ. /

TryEnqueue
ÝÝ/ 9
(
ÝÝ9 :
(
ÝÝ: ;
)
ÝÝ; <
=>
ÝÝ= ?
{
ÞÞ 

waitDialog
ßß 
.
ßß 
	ViewModel
ßß $
.
ßß$ %

AllowClose
ßß% /
(
ßß/ 0
)
ßß0 1
;
ßß1 2

waitDialog
àà 
.
àà 
Hide
àà 
(
àà  
)
àà  !
;
àà! "
}
áá 
)
áá 
;
áá 
await
ää 
showDialogTask
ää  
;
ää  !
var
ææ 
success
ææ 
=
ææ 
true
ææ 
;
ææ 
if
èè 
(
èè 
success
èè 
)
èè 
{
éé 
await
íí !
ProcessPaymentAsync
íí )
(
íí) *
$str
íí* 6
)
íí6 7
;
íí7 8
Error
ðð 
=
ðð 
$"
ðð 
$str
ðð 1
{
ðð1 2
cardType
ðð2 :
}
ðð: ;
$str
ðð; =
{
ðð= >

authMethod
ðð> H
}
ððH I
$str
ððI J
"
ððJ K
;
ððK L
}
ññ 
else
òò 
{
óó 
Error
ôô 
=
ôô 
$str
ôô /
;
ôô/ 0
}
õõ 
}
öö 	
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷ 
{
øø 	
Error
ùù 
=
ùù 
$"
ùù 
$str
ùù *
{
ùù* +
ex
ùù+ -
.
ùù- .
Message
ùù. 5
}
ùù5 6
"
ùù6 7
;
ùù7 8
var
ûû 
dialog
ûû 
=
ûû 
new
ûû 
	Microsoft
ûû &
.
ûû& '
UI
ûû' )
.
ûû) *
Xaml
ûû* .
.
ûû. /
Controls
ûû/ 7
.
ûû7 8
ContentDialog
ûû8 E
{
üü 
Title
ýý 
=
ýý 
$str
ýý ,
,
ýý, -
Content
þþ 
=
þþ 
$"
þþ 
$str
þþ >
{
þþ> ?
ex
þþ? A
.
þþA B
Message
þþB I
}
þþI J
"
þþJ K
,
þþK L
CloseButtonText
ÿÿ 
=
ÿÿ  !
$str
ÿÿ" &
,
ÿÿ& '
XamlRoot
€€ 
=
€€ 
App
€€ 
.
€€  
MainWindowInstance
€€ 1
.
€€1 2
Content
€€2 9
.
€€9 :
XamlRoot
€€: B
}
 
;
 
await
‚‚  
_navigationService
‚‚ $
.
‚‚$ %
ShowDialogAsync
‚‚% 4
(
‚‚4 5
dialog
‚‚5 ;
)
‚‚; <
;
‚‚< =
}
ƒƒ 	
finally
„„ 
{
…… 	
IsBusy
†† 
=
†† 
false
†† 
;
†† 
}
‡‡ 	
}
ˆˆ 
}‰‰ ²G
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\SettingsViewModel.cs
	namespace

 	
Magidesk


 
.

 
Presentation

 
.

  

ViewModels

  *
;

* +
public 
sealed 
partial 
class 
SettingsViewModel -
:. /
ViewModelBase0 =
{ 
private 
readonly 
IQueryHandler "
<" #$
GetRestaurantConfigQuery# ;
,; <%
GetRestaurantConfigResult= V
>V W
_getQueryHandlerX h
;h i
private 
readonly 
ICommandHandler $
<$ %)
UpdateRestaurantConfigCommand% B
,B C(
UpdateRestaurantConfigResultD `
>` a!
_updateCommandHandlerb w
;w x
private 
bool 
_isKioskMode 
; 
private 
string 
_restaurantName "
=# $
$str% '
;' (
private 
string 
_restaurantAddress %
=& '
$str( *
;* +
private 
string 
_restaurantPhone #
=$ %
$str& (
;( )
private 
string 
_restaurantEmail #
=$ %
$str& (
;( )
private 
string 
_restaurantWebsite %
=& '
$str( *
;* +
private 
string 
_receiptFooter !
=" #
$str$ &
;& '
private 
string 
_taxId 
= 
$str 
; 
public 

SettingsViewModel 
( 
IQueryHandler 
< $
GetRestaurantConfigQuery .
,. /%
GetRestaurantConfigResult0 I
>I J
getQueryHandlerK Z
,Z [
ICommandHandler 
< )
UpdateRestaurantConfigCommand 5
,5 6(
UpdateRestaurantConfigResult7 S
>S T 
updateCommandHandlerU i
)i j
{ 
Title 
= 
$str 
; 
_getQueryHandler 
= 
getQueryHandler *
;* +!
_updateCommandHandler   
=    
updateCommandHandler    4
;  4 5
LoadSettingsCommand"" 
="" 
new"" !
AsyncRelayCommand""" 3
(""3 4
LoadSettingsAsync""4 E
)""E F
;""F G
SaveSettingsCommand## 
=## 
new## !
AsyncRelayCommand##" 3
(##3 4
SaveSettingsAsync##4 E
)##E F
;##F G
LoadSettingsCommand%% 
.%% 
Execute%% #
(%%# $
null%%$ (
)%%( )
;%%) *
}&& 
public(( 

IAsyncRelayCommand(( 
LoadSettingsCommand(( 1
{((2 3
get((4 7
;((7 8
}((9 :
public)) 

IAsyncRelayCommand)) 
SaveSettingsCommand)) 1
{))2 3
get))4 7
;))7 8
}))9 :
public++ 

bool++ 
IsKioskMode++ 
{,, 
get-- 
=>-- 
_isKioskMode-- 
;-- 
set.. 
=>.. 
SetProperty.. 
(.. 
ref.. 
_isKioskMode.. +
,..+ ,
value..- 2
)..2 3
;..3 4
}// 
public11 

string11 
RestaurantName11  
{11! "
get11# &
=>11' )
_restaurantName11* 9
;119 :
set11; >
=>11? A
SetProperty11B M
(11M N
ref11N Q
_restaurantName11R a
,11a b
value11c h
)11h i
;11i j
}11k l
public22 

string22 
RestaurantAddress22 #
{22$ %
get22& )
=>22* ,
_restaurantAddress22- ?
;22? @
set22A D
=>22E G
SetProperty22H S
(22S T
ref22T W
_restaurantAddress22X j
,22j k
value22l q
)22q r
;22r s
}22t u
public33 

string33 
RestaurantPhone33 !
{33" #
get33$ '
=>33( *
_restaurantPhone33+ ;
;33; <
set33= @
=>33A C
SetProperty33D O
(33O P
ref33P S
_restaurantPhone33T d
,33d e
value33f k
)33k l
;33l m
}33n o
public44 

string44 
RestaurantEmail44 !
{44" #
get44$ '
=>44( *
_restaurantEmail44+ ;
;44; <
set44= @
=>44A C
SetProperty44D O
(44O P
ref44P S
_restaurantEmail44T d
,44d e
value44f k
)44k l
;44l m
}44n o
public55 

string55 
RestaurantWebsite55 #
{55$ %
get55& )
=>55* ,
_restaurantWebsite55- ?
;55? @
set55A D
=>55E G
SetProperty55H S
(55S T
ref55T W
_restaurantWebsite55X j
,55j k
value55l q
)55q r
;55r s
}55t u
public66 

string66 
ReceiptFooter66 
{66  !
get66" %
=>66& (
_receiptFooter66) 7
;667 8
set669 <
=>66= ?
SetProperty66@ K
(66K L
ref66L O
_receiptFooter66P ^
,66^ _
value66` e
)66e f
;66f g
}66h i
public77 

string77 
TaxId77 
{77 
get77 
=>77  
_taxId77! '
;77' (
set77) ,
=>77- /
SetProperty770 ;
(77; <
ref77< ?
_taxId77@ F
,77F G
value77H M
)77M N
;77N O
}77P Q
private99 
async99 
Task99 
LoadSettingsAsync99 (
(99( )
)99) *
{:: 
var;; 
result;; 
=;; 
await;; 
_getQueryHandler;; +
.;;+ ,
HandleAsync;;, 7
(;;7 8
new;;8 ;$
GetRestaurantConfigQuery;;< T
(;;T U
);;U V
);;V W
;;;W X
if<< 

(<< 
result<< 
?<< 
.<< 
Configuration<< !
!=<<" $
null<<% )
)<<) *
{== 	
var>> 
c>> 
=>> 
result>> 
.>> 
Configuration>> (
;>>( )
RestaurantName?? 
=?? 
c?? 
.?? 
Name?? #
;??# $
RestaurantAddress@@ 
=@@ 
c@@  !
.@@! "
Address@@" )
;@@) *
RestaurantPhoneAA 
=AA 
cAA 
.AA  
PhoneAA  %
;AA% &
RestaurantEmailBB 
=BB 
cBB 
.BB  
EmailBB  %
;BB% &
RestaurantWebsiteCC 
=CC 
cCC  !
.CC! "
WebsiteCC" )
;CC) *
ReceiptFooterDD 
=DD 
cDD 
.DD  
ReceiptFooterMessageDD 2
;DD2 3
TaxIdEE 
=EE 
cEE 
.EE 
TaxIdEE 
;EE 
IsKioskModeFF 
=FF 
cFF 
.FF 
IsKioskModeFF '
;FF' (
}GG 	
}HH 
privateJJ 
asyncJJ 
TaskJJ 
SaveSettingsAsyncJJ (
(JJ( )
)JJ) *
{KK 
varLL 
dtoLL 
=LL 
newLL &
RestaurantConfigurationDtoLL 0
{MM 	
NameNN 
=NN 
RestaurantNameNN !
,NN! "
AddressOO 
=OO 
RestaurantAddressOO '
,OO' (
PhonePP 
=PP 
RestaurantPhonePP #
,PP# $
EmailQQ 
=QQ 
RestaurantEmailQQ #
,QQ# $
WebsiteRR 
=RR 
RestaurantWebsiteRR '
,RR' ( 
ReceiptFooterMessageSS  
=SS! "
ReceiptFooterSS# 0
,SS0 1
TaxIdTT 
=TT 
TaxIdTT 
,TT 
IsKioskModeUU 
=UU 
IsKioskModeUU %
}VV 	
;VV	 

varXX 
resultXX 
=XX 
awaitXX !
_updateCommandHandlerXX 0
.XX0 1
HandleAsyncXX1 <
(XX< =
newXX= @)
UpdateRestaurantConfigCommandXXA ^
(XX^ _
dtoXX_ b
)XXb c
)XXc d
;XXd e
ifYY 

(YY 
resultYY 
.YY 
	IsSuccessYY 
)YY 
{ZZ 	
}\\ 	
}]] 
}^^ ¢Ö
tC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\ServerSectionManagementViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class ,
 ServerSectionManagementViewModel 5
:6 7
ViewModelBase8 E
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
private 
readonly $
IServerSectionRepository -$
_serverSectionRepository. F
;F G
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private 
readonly 
IUserRepository $
_userRepository% 4
;4 5
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
[ 
ObservableProperty 
] 
private  
ObservableCollection  
<  !
ServerSectionDto! 1
>1 2
_serverSections3 B
=C D
newE H
(H I
)I J
;J K
[ 
ObservableProperty 
] 
private  
ObservableCollection  
<  !
UserDto! (
>( )
_servers* 2
=3 4
new5 8
(8 9
)9 :
;: ;
[ 
ObservableProperty 
] 
private  
ObservableCollection  
<  !
TableDto! )
>) *
_availableTables+ ;
=< =
new> A
(A B
)B C
;C D
[!! 
ObservableProperty!! 
]!! 
private"" 
ServerSectionDto"" 
?"" 
_selectedSection"" .
;"". /
[$$ 
ObservableProperty$$ 
]$$ 
private%% 
UserDto%% 
?%% 
_selectedServer%% $
;%%$ %
['' 
ObservableProperty'' 
]'' 
private(( 
string(( 
_sectionName(( 
=((  !
string((" (
.((( )
Empty(() .
;((. /
[** 
ObservableProperty** 
]** 
private++ 
string++ 
_sectionDescription++ &
=++' (
string++) /
.++/ 0
Empty++0 5
;++5 6
[-- 
ObservableProperty-- 
]-- 
private.. 
string.. 
_sectionColor..  
=..! "
$str..# ,
;.., -
[00 
ObservableProperty00 
]00 
private11 
bool11 
_isEditMode11 
;11 
[33 
ObservableProperty33 
]33 
private44 
bool44 
_isBusy44 
;44 
[66 
ObservableProperty66 
]66 
private77 
int77 
_assignedTableCount77 #
;77# $
public99 

IRelayCommand99  
CreateSectionCommand99 -
{99. /
get990 3
;993 4
}995 6
public:: 

IRelayCommand::  
UpdateSectionCommand:: -
{::. /
get::0 3
;::3 4
}::5 6
public;; 

IRelayCommand;;  
DeleteSectionCommand;; -
{;;. /
get;;0 3
;;;3 4
};;5 6
public<< 

IRelayCommand<< 
ClearFormCommand<< )
{<<* +
get<<, /
;<</ 0
}<<1 2
public== 

IRelayCommand== 
AssignTablesCommand== ,
{==- .
get==/ 2
;==2 3
}==4 5
public>> 

IRelayCommand>> 
RemoveTablesCommand>> ,
{>>- .
get>>/ 2
;>>2 3
}>>4 5
public?? 

IRelayCommand?? 
RefreshCommand?? '
{??( )
get??* -
;??- .
}??/ 0
publicAA 
,
 ServerSectionManagementViewModelAA +
(AA+ ,
	IMediatorBB 
mediatorBB 
,BB $
IServerSectionRepositoryCC  #
serverSectionRepositoryCC! 8
,CC8 9
ITableRepositoryDD 
tableRepositoryDD (
,DD( )
IUserRepositoryEE 
userRepositoryEE &
,EE& '
NavigationServiceFF 
navigationServiceFF +
)FF+ ,
{GG 
	_mediatorHH 
=HH 
mediatorHH 
;HH $
_serverSectionRepositoryII  
=II! "#
serverSectionRepositoryII# :
;II: ;
_tableRepositoryJJ 
=JJ 
tableRepositoryJJ *
;JJ* +
_userRepositoryKK 
=KK 
userRepositoryKK (
;KK( )
_navigationServiceLL 
=LL 
navigationServiceLL .
;LL. / 
CreateSectionCommandNN 
=NN 
newNN "
AsyncRelayCommandNN# 4
(NN4 5
CreateSectionAsyncNN5 G
)NNG H
;NNH I 
UpdateSectionCommandOO 
=OO 
newOO "
AsyncRelayCommandOO# 4
(OO4 5
UpdateSectionAsyncOO5 G
)OOG H
;OOH I 
DeleteSectionCommandPP 
=PP 
newPP "
AsyncRelayCommandPP# 4
<PP4 5
ServerSectionDtoPP5 E
>PPE F
(PPF G
DeleteSectionAsyncPPG Y
)PPY Z
;PPZ [
ClearFormCommandQQ 
=QQ 
newQQ 
RelayCommandQQ +
(QQ+ ,
	ClearFormQQ, 5
)QQ5 6
;QQ6 7
AssignTablesCommandRR 
=RR 
newRR !
AsyncRelayCommandRR" 3
(RR3 4
AssignTablesAsyncRR4 E
)RRE F
;RRF G
RemoveTablesCommandSS 
=SS 
newSS !
AsyncRelayCommandSS" 3
(SS3 4
RemoveTablesAsyncSS4 E
)SSE F
;SSF G
RefreshCommandTT 
=TT 
newTT 
AsyncRelayCommandTT .
(TT. /
RefreshDataAsyncTT/ ?
)TT? @
;TT@ A
TitleVV 
=VV 
$strVV +
;VV+ ,
LoadDataAsyncWW 
(WW 
)WW 
;WW 
}XX 
privateZZ 
asyncZZ 
TaskZZ 
LoadDataAsyncZZ $
(ZZ$ %
)ZZ% &
{[[ 
IsBusy\\ 
=\\ 
true\\ 
;\\ 
try]] 
{^^ 	
await__ #
LoadServerSectionsAsync__ )
(__) *
)__* +
;__+ ,
await`` 
LoadServersAsync`` "
(``" #
)``# $
;``$ %
awaitaa $
LoadAvailableTablesAsyncaa *
(aa* +
)aa+ ,
;aa, -
}bb 	
finallycc 
{dd 	
IsBusyee 
=ee 
falseee 
;ee 
}ff 	
}gg 
privateii 
asyncii 
Taskii #
LoadServerSectionsAsyncii .
(ii. /
)ii/ 0
{jj 
varkk 
sectionskk 
=kk 
awaitkk 
	_mediatorkk &
.kk& '
Sendkk' +
(kk+ ,
newkk, /"
GetServerSectionsQuerykk0 F
(kkF G
)kkG H
)kkH I
;kkI J
ServerSectionsll 
.ll 
Clearll 
(ll 
)ll 
;ll 
foreachnn 
(nn 
varnn 
sectionnn 
innn 
sectionsnn  (
)nn( )
{oo 	
ServerSectionspp 
.pp 
Addpp 
(pp 
sectionpp &
)pp& '
;pp' (
}qq 	
}rr 
privatett 
asynctt 
Tasktt 
LoadServersAsynctt '
(tt' (
)tt( )
{uu 
Serversww 
.ww 
Clearww 
(ww 
)ww 
;ww 
Serversxx 
.xx 
Addxx 
(xx 
newxx 
UserDtoxx 
{yy 	
Idzz 
=zz 
Guidzz 
.zz 
NewGuidzz 
(zz 
)zz 
,zz  
	FirstName{{ 
={{ 
$str{{ 
,{{ 
LastName|| 
=|| 
$str|| 
,|| 
Email}} 
=}} 
$str}} -
,}}- .
IsActive~~ 
=~~ 
true~~ 
} 	
)	 

;
 
Servers
 
.
 
Add
 
(
 
new
 
UserDto
 
{
‚‚ 	
Id
ƒƒ 
=
ƒƒ 
Guid
ƒƒ 
.
ƒƒ 
NewGuid
ƒƒ 
(
ƒƒ 
)
ƒƒ 
,
ƒƒ  
	FirstName
„„ 
=
„„ 
$str
„„ 
,
„„ 
LastName
…… 
=
…… 
$str
…… 
,
…… 
Email
†† 
=
†† 
$str
†† /
,
††/ 0
IsActive
‡‡ 
=
‡‡ 
true
‡‡ 
}
ˆˆ 	
)
ˆˆ	 

;
ˆˆ
 
SelectedServer
ŠŠ 
=
ŠŠ 
Servers
ŠŠ  
.
ŠŠ  !
FirstOrDefault
ŠŠ! /
(
ŠŠ/ 0
)
ŠŠ0 1
;
ŠŠ1 2
}
‹‹ 
private
 
async
 
Task
 &
LoadAvailableTablesAsync
 /
(
/ 0
)
0 1
{
ŽŽ 
var
 
tables
 
=
 
await
 
_tableRepository
 +
.
+ ,
GetAvailableAsync
, =
(
= >
)
> ?
;
? @
AvailableTables
 
.
 
Clear
 
(
 
)
 
;
  
foreach
’’ 
(
’’ 
var
’’ 
table
’’ 
in
’’ 
tables
’’ $
)
’’$ %
{
““ 	
AvailableTables
”” 
.
”” 
Add
”” 
(
””  
new
””  #
TableDto
””$ ,
{
•• 
Id
–– 
=
–– 
table
–– 
.
–– 
Id
–– 
,
–– 
TableNumber
—— 
=
—— 
table
—— #
.
——# $
TableNumber
——$ /
,
——/ 0
Capacity
˜˜ 
=
˜˜ 
table
˜˜  
.
˜˜  !
Capacity
˜˜! )
,
˜˜) *
X
™™ 
=
™™ 
table
™™ 
.
™™ 
X
™™ 
,
™™ 
Y
šš 
=
šš 
table
šš 
.
šš 
Y
šš 
,
šš 
Status
›› 
=
›› 
table
›› 
.
›› 
Status
›› %
,
››% &
IsActive
œœ 
=
œœ 
table
œœ  
.
œœ  !
IsActive
œœ! )
}
 
)
 
;
 
}
žž 	
}
ŸŸ 
private
¡¡ 
async
¡¡ 
Task
¡¡  
CreateSectionAsync
¡¡ )
(
¡¡) *
)
¡¡* +
{
¢¢ 
if
££ 

(
££ 
string
££ 
.
££  
IsNullOrWhiteSpace
££ %
(
££% &
SectionName
££& 1
)
££1 2
||
££3 5
SelectedServer
££6 D
==
££E G
null
££H L
)
££L M
{
¤¤ 	
await
¥¥ 
ShowErrorAsync
¥¥  
(
¥¥  !
$str
¥¥! S
)
¥¥S T
;
¥¥T U
return
¦¦ 
;
¦¦ 
}
§§ 	
IsBusy
©© 
=
©© 
true
©© 
;
©© 
try
ªª 
{
«« 	
var
¬¬ 
command
¬¬ 
=
¬¬ 
new
¬¬ (
CreateServerSectionCommand
¬¬ 8
(
¬¬8 9
SectionName
­­ 
,
­­ 
SelectedServer
®® 
.
®® 
Id
®® !
,
®®! " 
SectionDescription
¯¯ "
,
¯¯" #
SectionColor
°° 
)
±± 
;
±± 
var
³³ 

newSection
³³ 
=
³³ 
await
³³ "
	_mediator
³³# ,
.
³³, -
Send
³³- 1
(
³³1 2
command
³³2 9
)
³³9 :
;
³³: ;
ServerSections
´´ 
.
´´ 
Add
´´ 
(
´´ 

newSection
´´ )
)
´´) *
;
´´* +
	ClearForm
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶ 
await
·· 
ShowSuccessAsync
·· "
(
··" #
$"
··# %
$str
··% 5
{
··5 6
SectionName
··6 A
}
··A B
$str
··B Y
"
··Y Z
)
··Z [
;
··[ \
}
¸¸ 	
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹ 
{
ºº 	
await
»» 
ShowErrorAsync
»»  
(
»»  !
$"
»»! #
$str
»»# B
{
»»B C
ex
»»C E
.
»»E F
Message
»»F M
}
»»M N
"
»»N O
)
»»O P
;
»»P Q
}
¼¼ 	
finally
½½ 
{
¾¾ 	
IsBusy
¿¿ 
=
¿¿ 
false
¿¿ 
;
¿¿ 
}
ÀÀ 	
}
ÁÁ 
private
ÃÃ 
async
ÃÃ 
Task
ÃÃ  
UpdateSectionAsync
ÃÃ )
(
ÃÃ) *
)
ÃÃ* +
{
ÄÄ 
if
ÅÅ 

(
ÅÅ 
SelectedSection
ÅÅ 
==
ÅÅ 
null
ÅÅ #
||
ÅÅ$ &
string
ÅÅ' -
.
ÅÅ- . 
IsNullOrWhiteSpace
ÅÅ. @
(
ÅÅ@ A
SectionName
ÅÅA L
)
ÅÅL M
)
ÅÅM N
{
ÆÆ 	
await
ÇÇ 
ShowErrorAsync
ÇÇ  
(
ÇÇ  !
$str
ÇÇ! L
)
ÇÇL M
;
ÇÇM N
return
ÈÈ 
;
ÈÈ 
}
ÉÉ 	
IsBusy
ËË 
=
ËË 
true
ËË 
;
ËË 
try
ÌÌ 
{
ÍÍ 	
var
ÎÎ 
command
ÎÎ 
=
ÎÎ 
new
ÎÎ (
UpdateServerSectionCommand
ÎÎ 8
(
ÎÎ8 9
SelectedSection
ÏÏ 
.
ÏÏ  
Id
ÏÏ  "
,
ÏÏ" #
SectionName
ÐÐ 
,
ÐÐ  
SectionDescription
ÑÑ "
,
ÑÑ" #
SectionColor
ÒÒ 
)
ÓÓ 
;
ÓÓ 
var
ÕÕ 
updatedSection
ÕÕ 
=
ÕÕ  
await
ÕÕ! &
	_mediator
ÕÕ' 0
.
ÕÕ0 1
Send
ÕÕ1 5
(
ÕÕ5 6
command
ÕÕ6 =
)
ÕÕ= >
;
ÕÕ> ?
var
ØØ 
index
ØØ 
=
ØØ 
ServerSections
ØØ &
.
ØØ& '
IndexOf
ØØ' .
(
ØØ. /
SelectedSection
ØØ/ >
)
ØØ> ?
;
ØØ? @
if
ÙÙ 
(
ÙÙ 
index
ÙÙ 
>=
ÙÙ 
$num
ÙÙ 
)
ÙÙ 
{
ÚÚ 
ServerSections
ÛÛ 
[
ÛÛ 
index
ÛÛ $
]
ÛÛ$ %
=
ÛÛ& '
updatedSection
ÛÛ( 6
;
ÛÛ6 7
SelectedSection
ÜÜ 
=
ÜÜ  !
updatedSection
ÜÜ" 0
;
ÜÜ0 1
}
ÝÝ 
await
ßß 
ShowSuccessAsync
ßß "
(
ßß" #
$"
ßß# %
$str
ßß% 5
{
ßß5 6
SectionName
ßß6 A
}
ßßA B
$str
ßßB Y
"
ßßY Z
)
ßßZ [
;
ßß[ \

IsEditMode
àà 
=
àà 
false
àà 
;
àà 
}
áá 	
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ 
{
ãã 	
await
ää 
ShowErrorAsync
ää  
(
ää  !
$"
ää! #
$str
ää# B
{
ääB C
ex
ääC E
.
ääE F
Message
ääF M
}
ääM N
"
ääN O
)
ääO P
;
ääP Q
}
åå 	
finally
ææ 
{
çç 	
IsBusy
èè 
=
èè 
false
èè 
;
èè 
}
éé 	
}
êê 
private
ìì 
async
ìì 
Task
ìì  
DeleteSectionAsync
ìì )
(
ìì) *
ServerSectionDto
ìì* :
?
ìì: ;
section
ìì< C
)
ììC D
{
íí 
if
îî 

(
îî 
section
îî 
==
îî 
null
îî 
)
îî 
{
ïï 	
await
ðð 
ShowErrorAsync
ðð  
(
ðð  !
$str
ðð! E
)
ððE F
;
ððF G
return
ññ 
;
ññ 
}
òò 	
if
ôô 

(
ôô 
section
ôô 
.
ôô 

TableCount
ôô 
>
ôô  
$num
ôô! "
)
ôô" #
{
õõ 	
await
öö 
ShowErrorAsync
öö  
(
öö  !
$"
öö! #
$str
öö# :
{
öö: ;
section
öö; B
.
ööB C
Name
ööC G
}
ööG H
$str
ööH Y
{
ööY Z
section
ööZ a
.
ööa b

TableCount
ööb l
}
ööl m
$strööm š
"ööš ›
)öö› œ
;ööœ 
return
÷÷ 
;
÷÷ 
}
øø 	
var
úú 
	confirmed
úú 
=
úú 
await
úú #
ShowConfirmationAsync
úú 3
(
úú3 4
$"
úú4 6
$str
úú6 M
{
úúM N
section
úúN U
.
úúU V
Name
úúV Z
}
úúZ [
$str
úú[ ]
"
úú] ^
,
úú^ _
$str
ûû `
)
ûû` a
;
ûûa b
if
ýý 

(
ýý 
!
ýý 
	confirmed
ýý 
)
ýý 
return
ýý 
;
ýý 
IsBusy
ÿÿ 
=
ÿÿ 
true
ÿÿ 
;
ÿÿ 
try
€€ 
{
 	
var
‚‚ 
command
‚‚ 
=
‚‚ 
new
‚‚ (
DeleteServerSectionCommand
‚‚ 8
(
‚‚8 9
section
‚‚9 @
.
‚‚@ A
Id
‚‚A C
)
‚‚C D
;
‚‚D E
var
ƒƒ 
result
ƒƒ 
=
ƒƒ 
await
ƒƒ 
	_mediator
ƒƒ (
.
ƒƒ( )
Send
ƒƒ) -
(
ƒƒ- .
command
ƒƒ. 5
)
ƒƒ5 6
;
ƒƒ6 7
if
…… 
(
…… 
result
…… 
)
…… 
{
†† 
ServerSections
‡‡ 
.
‡‡ 
Remove
‡‡ %
(
‡‡% &
section
‡‡& -
)
‡‡- .
;
‡‡. /
if
‰‰ 
(
‰‰ 
SelectedSection
‰‰ #
==
‰‰$ &
section
‰‰' .
)
‰‰. /
{
ŠŠ 
SelectedSection
‹‹ #
=
‹‹$ %
null
‹‹& *
;
‹‹* +
	ClearForm
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ  
}
 
await
 
ShowSuccessAsync
 &
(
& '
$"
' )
$str
) 9
{
9 :
section
: A
.
A B
Name
B F
}
F G
$str
G ^
"
^ _
)
_ `
;
` a
}
 
}
‘‘ 	
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’ 
{
““ 	
await
”” 
ShowErrorAsync
””  
(
””  !
$"
””! #
$str
””# B
{
””B C
ex
””C E
.
””E F
Message
””F M
}
””M N
"
””N O
)
””O P
;
””P Q
}
•• 	
finally
–– 
{
—— 	
IsBusy
˜˜ 
=
˜˜ 
false
˜˜ 
;
˜˜ 
}
™™ 	
}
šš 
private
œœ 
async
œœ 
Task
œœ 
AssignTablesAsync
œœ (
(
œœ( )
)
œœ) *
{
 
if
žž 

(
žž 
SelectedSection
žž 
==
žž 
null
žž #
)
žž# $
{
ŸŸ 	
await
   
ShowErrorAsync
    
(
    !
$str
  ! H
)
  H I
;
  I J
return
¡¡ 
;
¡¡ 
}
¢¢ 	
var
¥¥ 
selectedTableIds
¥¥ 
=
¥¥ 
AvailableTables
¥¥ .
.
¥¥. /
Where
¥¥/ 4
(
¥¥4 5
t
¥¥5 6
=>
¥¥7 9
t
¥¥: ;
.
¥¥; <

IsSelected
¥¥< F
)
¥¥F G
.
¥¥G H
Select
¥¥H N
(
¥¥N O
t
¥¥O P
=>
¥¥Q S
t
¥¥T U
.
¥¥U V
Id
¥¥V X
)
¥¥X Y
.
¥¥Y Z
ToList
¥¥Z `
(
¥¥` a
)
¥¥a b
;
¥¥b c
if
§§ 

(
§§ 
!
§§ 
selectedTableIds
§§ 
.
§§ 
Any
§§ !
(
§§! "
)
§§" #
)
§§# $
{
¨¨ 	
await
©© 
ShowErrorAsync
©©  
(
©©  !
$str
©©! B
)
©©B C
;
©©C D
return
ªª 
;
ªª 
}
«« 	
IsBusy
­­ 
=
­­ 
true
­­ 
;
­­ 
try
®® 
{
¯¯ 	
var
°° 
command
°° 
=
°° 
new
°° 0
"AssignTablesToServerSectionCommand
°° @
(
°°@ A
SelectedSection
±± 
.
±±  
Id
±±  "
,
±±" #
selectedTableIds
²²  
)
³³ 
;
³³ 
var
µµ 
updatedSection
µµ 
=
µµ  
await
µµ! &
	_mediator
µµ' 0
.
µµ0 1
Send
µµ1 5
(
µµ5 6
command
µµ6 =
)
µµ= >
;
µµ> ?
var
¸¸ 
index
¸¸ 
=
¸¸ 
ServerSections
¸¸ &
.
¸¸& '
IndexOf
¸¸' .
(
¸¸. /
SelectedSection
¸¸/ >
)
¸¸> ?
;
¸¸? @
if
¹¹ 
(
¹¹ 
index
¹¹ 
>=
¹¹ 
$num
¹¹ 
)
¹¹ 
{
ºº 
ServerSections
»» 
[
»» 
index
»» $
]
»»$ %
=
»»& '
updatedSection
»»( 6
;
»»6 7
SelectedSection
¼¼ 
=
¼¼  !
updatedSection
¼¼" 0
;
¼¼0 1
}
½½ 
await
¿¿ 
ShowSuccessAsync
¿¿ "
(
¿¿" #
$"
¿¿# %
$str
¿¿% .
{
¿¿. /
selectedTableIds
¿¿/ ?
.
¿¿? @
Count
¿¿@ E
}
¿¿E F
$str
¿¿F Z
{
¿¿Z [
SelectedSection
¿¿[ j
.
¿¿j k
Name
¿¿k o
}
¿¿o p
$str
¿¿p r
"
¿¿r s
)
¿¿s t
;
¿¿t u
}
ÀÀ 	
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ 
ex
ÁÁ 
)
ÁÁ 
{
ÂÂ 	
await
ÃÃ 
ShowErrorAsync
ÃÃ  
(
ÃÃ  !
$"
ÃÃ! #
$str
ÃÃ# ;
{
ÃÃ; <
ex
ÃÃ< >
.
ÃÃ> ?
Message
ÃÃ? F
}
ÃÃF G
"
ÃÃG H
)
ÃÃH I
;
ÃÃI J
}
ÄÄ 	
finally
ÅÅ 
{
ÆÆ 	
IsBusy
ÇÇ 
=
ÇÇ 
false
ÇÇ 
;
ÇÇ 
}
ÈÈ 	
}
ÉÉ 
private
ËË 
async
ËË 
Task
ËË 
RemoveTablesAsync
ËË (
(
ËË( )
)
ËË) *
{
ÌÌ 
await
ÎÎ 
ShowErrorAsync
ÎÎ 
(
ÎÎ 
$str
ÎÎ O
)
ÎÎO P
;
ÎÎP Q
}
ÏÏ 
private
ÑÑ 
async
ÑÑ 
Task
ÑÑ 
RefreshDataAsync
ÑÑ '
(
ÑÑ' (
)
ÑÑ( )
{
ÒÒ 
await
ÓÓ 
LoadDataAsync
ÓÓ 
(
ÓÓ 
)
ÓÓ 
;
ÓÓ 
}
ÔÔ 
private
ÖÖ 
void
ÖÖ 
	ClearForm
ÖÖ 
(
ÖÖ 
)
ÖÖ 
{
×× 
SectionName
ØØ 
=
ØØ 
string
ØØ 
.
ØØ 
Empty
ØØ "
;
ØØ" # 
SectionDescription
ÙÙ 
=
ÙÙ 
string
ÙÙ #
.
ÙÙ# $
Empty
ÙÙ$ )
;
ÙÙ) *
SectionColor
ÚÚ 
=
ÚÚ 
$str
ÚÚ  
;
ÚÚ  !
SelectedSection
ÛÛ 
=
ÛÛ 
null
ÛÛ 
;
ÛÛ 

IsEditMode
ÜÜ 
=
ÜÜ 
false
ÜÜ 
;
ÜÜ 
}
ÝÝ 
partial
ßß 
void
ßß &
OnSelectedSectionChanged
ßß )
(
ßß) *
ServerSectionDto
ßß* :
?
ßß: ;
value
ßß< A
)
ßßA B
{
àà 
if
áá 

(
áá 
value
áá 
!=
áá 
null
áá 
)
áá 
{
ââ 	
SectionName
ãã 
=
ãã 
value
ãã 
.
ãã  
Name
ãã  $
;
ãã$ % 
SectionDescription
ää 
=
ää  
value
ää! &
.
ää& '
Description
ää' 2
;
ää2 3
SectionColor
åå 
=
åå 
value
åå  
.
åå  !
Color
åå! &
;
åå& '
SelectedServer
ææ 
=
ææ 
Servers
ææ $
.
ææ$ %
FirstOrDefault
ææ% 3
(
ææ3 4
s
ææ4 5
=>
ææ6 8
s
ææ9 :
.
ææ: ;
Id
ææ; =
==
ææ> @
value
ææA F
.
ææF G
ServerId
ææG O
)
ææO P
;
ææP Q 
AssignedTableCount
çç 
=
çç  
value
çç! &
.
çç& '

TableCount
çç' 1
;
çç1 2

IsEditMode
èè 
=
èè 
true
èè 
;
èè 
}
éé 	
}
êê 
private
ìì 
async
ìì 
Task
ìì 
<
ìì 
bool
ìì 
>
ìì #
ShowConfirmationAsync
ìì 2
(
ìì2 3
string
ìì3 9
title
ìì: ?
,
ìì? @
string
ììA G
message
ììH O
)
ììO P
{
íí 
return
ïï 
true
ïï 
;
ïï 
}
ðð 
private
òò 
async
òò 
Task
òò 
ShowErrorAsync
òò %
(
òò% &
string
òò& ,
message
òò- 4
)
òò4 5
{
óó 
System
õõ 
.
õõ 
Diagnostics
õõ 
.
õõ 
Debug
õõ  
.
õõ  !
	WriteLine
õõ! *
(
õõ* +
$"
õõ+ -
$str
õõ- 4
{
õõ4 5
message
õõ5 <
}
õõ< =
"
õõ= >
)
õõ> ?
;
õõ? @
}
öö 
private
øø 
async
øø 
Task
øø 
ShowSuccessAsync
øø '
(
øø' (
string
øø( .
message
øø/ 6
)
øø6 7
{
ùù 
System
ûû 
.
ûû 
Diagnostics
ûû 
.
ûû 
Debug
ûû  
.
ûû  !
	WriteLine
ûû! *
(
ûû* +
$"
ûû+ -
$str
ûû- 6
{
ûû6 7
message
ûû7 >
}
ûû> ?
"
ûû? @
)
ûû@ A
;
ûûA B
}
üü 
}ýý Ë„
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\SalesReportsViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
;		* +
public 
enum 
ReportProperties 
{ 
SalesSummary 
, 
SalesDetail 
, 
SalesBalance 
, 

Exceptions 
, 
CreditCardReport 
, 
PaymentReport 
, 
MenuUsageReport 
, $
ServerProductivityReport 
, 
HourlyLaborReport 
, 
Journal 
, 
Productivity 
, 
Labor 	
,	 

Delivery 
, 
Tips 
, 	

Attendance 
, 
CashOut 
} 
public 
partial 
class !
SalesReportsViewModel *
:+ ,
ViewModelBase- :
{   
private!! 
readonly!! 
IQueryHandler!! "
<!!" # 
GetSalesSummaryQuery!!# 7
,!!7 8!
SalesSummaryReportDto!!9 N
>!!N O
_getSalesSummary!!P `
;!!` a
private"" 
readonly"" 
IQueryHandler"" "
<""" #
GetSalesDetailQuery""# 6
,""6 7 
SalesDetailReportDto""8 L
>""L M
_getSalesDetail""N ]
;""] ^
private## 
readonly## 
IQueryHandler## "
<##" # 
GetSalesBalanceQuery### 7
,##7 8!
SalesBalanceReportDto##9 N
>##N O
_getSalesBalance##P `
;##` a
private$$ 
readonly$$ 
IQueryHandler$$ "
<$$" #$
GetExceptionsReportQuery$$# ;
,$$; <
ExceptionsReportDto$$= P
>$$P Q 
_getExceptionsReport$$R f
;$$f g
private%% 
readonly%% 
IQueryHandler%% "
<%%" #$
GetCreditCardReportQuery%%# ;
,%%; <
CreditCardReportDto%%= P
>%%P Q 
_getCreditCardReport%%R f
;%%f g
private&& 
readonly&& 
IQueryHandler&& "
<&&" #!
GetPaymentReportQuery&&# 8
,&&8 9
PaymentReportDto&&: J
>&&J K
_getPaymentReport&&L ]
;&&] ^
private'' 
readonly'' 
IQueryHandler'' "
<''" ##
GetMenuUsageReportQuery''# :
,'': ;
MenuUsageReportDto''< N
>''N O
_getMenuUsageReport''P c
;''c d
private(( 
readonly(( 
IQueryHandler(( "
<((" #,
 GetServerProductivityReportQuery((# C
,((C D'
ServerProductivityReportDto((E `
>((` a(
_getServerProductivityReport((b ~
;((~ 
private)) 
readonly)) 
IQueryHandler)) "
<))" #%
GetHourlyLaborReportQuery))# <
,))< = 
HourlyLaborReportDto))> R
>))R S!
_getHourlyLaborReport))T i
;))i j
private** 
readonly** 
IQueryHandler** "
<**" #!
GetJournalReportQuery**# 8
,**8 9
JournalReportDto**: J
>**J K
_getJournalReport**L ]
;**] ^
private++ 
readonly++ 
IQueryHandler++ "
<++" #&
GetProductivityReportQuery++# =
,++= >!
ProductivityReportDto++? T
>++T U"
_getProductivityReport++V l
;++l m
private,, 
readonly,, 
IQueryHandler,, "
<,," #
GetLaborReportQuery,,# 6
,,,6 7
LaborReportDto,,8 F
>,,F G
_getLaborReport,,H W
;,,W X
private-- 
readonly-- 
IQueryHandler-- "
<--" #"
GetDeliveryReportQuery--# 9
,--9 :
DeliveryReportDto--; L
>--L M
_getDeliveryReport--N `
;--` a
private.. 
readonly.. 
IQueryHandler.. "
<.." #
GetTipReportQuery..# 4
,..4 5
TipReportDto..6 B
>..B C
_getTipReport..D Q
;..Q R
private// 
readonly// 
IQueryHandler// "
<//" #$
GetAttendanceReportQuery//# ;
,//; <
AttendanceReportDto//= P
>//P Q 
_getAttendanceReport//R f
;//f g
private00 
readonly00 
IQueryHandler00 "
<00" #!
GetCashOutReportQuery00# 8
,008 9
CashOutReportDto00: J
>00J K
_getCashOutReport00L ]
;00] ^
private22 
DateTimeOffset22 

_startDate22 %
=22& '
DateTime22( 0
.220 1
Today221 6
;226 7
private33 
DateTimeOffset33 
_endDate33 #
=33$ %
DateTime33& .
.33. /
Today33/ 4
.334 5
AddDays335 <
(33< =
$num33= >
)33> ?
.33? @

AddSeconds33@ J
(33J K
-33K L
$num33L M
)33M N
;33N O
private44 
ReportProperties44 
_selectedReportType44 0
;440 1
private55 
string55 
_error55 
=55 
string55 "
.55" #
Empty55# (
;55( )
public88 

System88 
.88 
Windows88 
.88 
Input88 
.88  
ICommand88  (
SetDateRangeCommand88) <
{88= >
get88? B
;88B C
}88D E
private<< !
SalesSummaryReportDto<< !
?<<! "
_salesSummary<<# 0
;<<0 1
private==  
SalesDetailReportDto==  
?==  !
_salesDetail==" .
;==. /
private>> !
SalesBalanceReportDto>> !
?>>! "
_salesBalance>># 0
;>>0 1
private?? 
ExceptionsReportDto?? 
???  
_exceptionsReport??! 2
;??2 3
private@@ 
CreditCardReportDto@@ 
?@@  
_creditCardReport@@! 2
;@@2 3
privateAA 
PaymentReportDtoAA 
?AA 
_paymentReportAA ,
;AA, -
privateBB 
MenuUsageReportDtoBB 
?BB 
_menuUsageReportBB  0
;BB0 1
privateCC '
ServerProductivityReportDtoCC '
?CC' (%
_serverProductivityReportCC) B
;CCB C
privateDD  
HourlyLaborReportDtoDD  
?DD  !
_hourlyLaborReportDD" 4
;DD4 5
privateEE 
JournalReportDtoEE 
?EE 
_journalReportEE ,
;EE, -
privateFF !
ProductivityReportDtoFF !
?FF! "
_productivityReportFF# 6
;FF6 7
privateGG 
LaborReportDtoGG 
?GG 
_laborReportGG (
;GG( )
privateHH 
DeliveryReportDtoHH 
?HH 
_deliveryReportHH .
;HH. /
privateII 
TipReportDtoII 
?II 

_tipReportII $
;II$ %
privateJJ 
AttendanceReportDtoJJ 
?JJ  
_attendanceReportJJ! 2
;JJ2 3
privateKK 
CashOutReportDtoKK 
?KK 
_cashOutReportKK ,
;KK, -
publicMM 
!
SalesReportsViewModelMM  
(MM  !
IQueryHandlerNN 
<NN  
GetSalesSummaryQueryNN *
,NN* +!
SalesSummaryReportDtoNN, A
>NNA B
getSalesSummaryNNC R
,NNR S
IQueryHandlerOO 
<OO 
GetSalesDetailQueryOO )
,OO) * 
SalesDetailReportDtoOO+ ?
>OO? @
getSalesDetailOOA O
,OOO P
IQueryHandlerPP 
<PP  
GetSalesBalanceQueryPP *
,PP* +!
SalesBalanceReportDtoPP, A
>PPA B
getSalesBalancePPC R
,PPR S
IQueryHandlerQQ 
<QQ $
GetExceptionsReportQueryQQ .
,QQ. /
ExceptionsReportDtoQQ0 C
>QQC D
getExceptionsReportQQE X
,QQX Y
IQueryHandlerRR 
<RR $
GetCreditCardReportQueryRR .
,RR. /
CreditCardReportDtoRR0 C
>RRC D
getCreditCardReportRRE X
,RRX Y
IQueryHandlerSS 
<SS !
GetPaymentReportQuerySS +
,SS+ ,
PaymentReportDtoSS- =
>SS= >
getPaymentReportSS? O
,SSO P
IQueryHandlerTT 
<TT #
GetMenuUsageReportQueryTT -
,TT- .
MenuUsageReportDtoTT/ A
>TTA B
getMenuUsageReportTTC U
,TTU V
IQueryHandlerUU 
<UU ,
 GetServerProductivityReportQueryUU 6
,UU6 7'
ServerProductivityReportDtoUU8 S
>UUS T'
getServerProductivityReportUUU p
,UUp q
IQueryHandlerVV 
<VV %
GetHourlyLaborReportQueryVV /
,VV/ 0 
HourlyLaborReportDtoVV1 E
>VVE F 
getHourlyLaborReportVVG [
,VV[ \
IQueryHandlerWW 
<WW !
GetJournalReportQueryWW +
,WW+ ,
JournalReportDtoWW- =
>WW= >
getJournalReportWW? O
,WWO P
IQueryHandlerXX 
<XX &
GetProductivityReportQueryXX 0
,XX0 1!
ProductivityReportDtoXX2 G
>XXG H!
getProductivityReportXXI ^
,XX^ _
IQueryHandlerYY 
<YY 
GetLaborReportQueryYY )
,YY) *
LaborReportDtoYY+ 9
>YY9 :
getLaborReportYY; I
,YYI J
IQueryHandlerZZ 
<ZZ "
GetDeliveryReportQueryZZ ,
,ZZ, -
DeliveryReportDtoZZ. ?
>ZZ? @
getDeliveryReportZZA R
,ZZR S
IQueryHandler[[ 
<[[ 
GetTipReportQuery[[ '
,[[' (
TipReportDto[[) 5
>[[5 6
getTipReport[[7 C
,[[C D
IQueryHandler\\ 
<\\ $
GetAttendanceReportQuery\\ .
,\\. /
AttendanceReportDto\\0 C
>\\C D
getAttendanceReport\\E X
,\\X Y
IQueryHandler]] 
<]] !
GetCashOutReportQuery]] +
,]]+ ,
CashOutReportDto]]- =
>]]= >
getCashOutReport]]? O
)]]O P
{^^ 
_getSalesSummary__ 
=__ 
getSalesSummary__ *
;__* +
_getSalesDetail`` 
=`` 
getSalesDetail`` (
;``( )
_getSalesBalanceaa 
=aa 
getSalesBalanceaa *
;aa* + 
_getExceptionsReportbb 
=bb 
getExceptionsReportbb 2
;bb2 3 
_getCreditCardReportcc 
=cc 
getCreditCardReportcc 2
;cc2 3
_getPaymentReportdd 
=dd 
getPaymentReportdd ,
;dd, -
_getMenuUsageReportee 
=ee 
getMenuUsageReportee 0
;ee0 1(
_getServerProductivityReportff $
=ff% &'
getServerProductivityReportff' B
;ffB C!
_getHourlyLaborReportgg 
=gg  
getHourlyLaborReportgg  4
;gg4 5
_getJournalReporthh 
=hh 
getJournalReporthh ,
;hh, -"
_getProductivityReportii 
=ii  !
getProductivityReportii! 6
;ii6 7
_getLaborReportjj 
=jj 
getLaborReportjj (
;jj( )
_getDeliveryReportkk 
=kk 
getDeliveryReportkk .
;kk. /
_getTipReportll 
=ll 
getTipReportll $
;ll$ % 
_getAttendanceReportmm 
=mm 
getAttendanceReportmm 2
;mm2 3
_getCashOutReportnn 
=nn 
getCashOutReportnn ,
;nn, -
Titlepp 
=pp 
$strpp 
;pp 
LoadReportCommandqq 
=qq 
newqq 
AsyncRelayCommandqq  1
(qq1 2
LoadReportAsyncqq2 A
)qqA B
;qqB C
SetDateRangeCommandrr 
=rr 
newrr !
RelayCommandrr" .
<rr. /
stringrr/ 5
>rr5 6
(rr6 7
SetDateRangerr7 C
)rrC D
;rrD E
}ss 
privateuu 
voiduu 
SetDateRangeuu 
(uu 
stringuu $
rangeuu% *
)uu* +
{vv 
varww 
nowww 
=ww 
DateTimeOffsetww  
.ww  !
Nowww! $
;ww$ %
switchxx 
(xx 
rangexx 
?xx 
.xx 
ToLowerxx 
(xx 
)xx  
)xx  !
{yy 	
casezz 
$strzz 
:zz 
	StartDate{{ 
={{ 
now{{ 
.{{  
Date{{  $
;{{$ %
EndDate|| 
=|| 
now|| 
.|| 
Date|| "
.||" #
AddDays||# *
(||* +
$num||+ ,
)||, -
.||- .

AddSeconds||. 8
(||8 9
-||9 :
$num||: ;
)||; <
;||< =
break}} 
;}} 
case~~ 
$str~~ 
:~~ 
	StartDate 
= 
now 
.  
Date  $
.$ %
AddDays% ,
(, -
-- .
$num. /
)/ 0
;0 1
EndDate
€€ 
=
€€ 
now
€€ 
.
€€ 
Date
€€ "
.
€€" #

AddSeconds
€€# -
(
€€- .
-
€€. /
$num
€€/ 0
)
€€0 1
;
€€1 2
break
 
;
 
case
‚‚ 
$str
‚‚ 
:
‚‚ 
var
„„ 
diff
„„ 
=
„„ 
(
„„ 
$num
„„ 
+
„„ 
(
„„  !
now
„„! $
.
„„$ %
	DayOfWeek
„„% .
-
„„/ 0
	DayOfWeek
„„1 :
.
„„: ;
Monday
„„; A
)
„„A B
)
„„B C
%
„„D E
$num
„„F G
;
„„G H
	StartDate
…… 
=
…… 
now
…… 
.
……  
Date
……  $
.
……$ %
AddDays
……% ,
(
……, -
-
……- .
$num
……. /
*
……0 1
diff
……2 6
)
……6 7
;
……7 8
EndDate
†† 
=
†† 
now
†† 
.
†† 
Date
†† "
.
††" #
AddDays
††# *
(
††* +
$num
††+ ,
)
††, -
.
††- .

AddSeconds
††. 8
(
††8 9
-
††9 :
$num
††: ;
)
††; <
;
††< =
break
‡‡ 
;
‡‡ 
case
ˆˆ 
$str
ˆˆ 
:
ˆˆ 
	StartDate
‰‰ 
=
‰‰ 
new
‰‰  
DateTime
‰‰! )
(
‰‰) *
now
‰‰* -
.
‰‰- .
Year
‰‰. 2
,
‰‰2 3
now
‰‰4 7
.
‰‰7 8
Month
‰‰8 =
,
‰‰= >
$num
‰‰? @
)
‰‰@ A
;
‰‰A B
EndDate
ŠŠ 
=
ŠŠ 
now
ŠŠ 
.
ŠŠ 
Date
ŠŠ #
.
ŠŠ# $
AddDays
ŠŠ$ +
(
ŠŠ+ ,
$num
ŠŠ, -
)
ŠŠ- .
.
ŠŠ. /

AddSeconds
ŠŠ/ 9
(
ŠŠ9 :
-
ŠŠ: ;
$num
ŠŠ; <
)
ŠŠ< =
;
ŠŠ= >
break
‹‹ 
;
‹‹ 
}
ŒŒ 	
}
ŽŽ 
public
 

DateTimeOffset
 
	StartDate
 #
{
‘‘ 
get
’’ 
=>
’’ 

_startDate
’’ 
;
’’ 
set
““ 
=>
““ 
SetProperty
““ 
(
““ 
ref
““ 

_startDate
““ )
,
““) *
value
““+ 0
)
““0 1
;
““1 2
}
”” 
public
–– 

DateTimeOffset
–– 
EndDate
–– !
{
—— 
get
˜˜ 
=>
˜˜ 
_endDate
˜˜ 
;
˜˜ 
set
™™ 
=>
™™ 
SetProperty
™™ 
(
™™ 
ref
™™ 
_endDate
™™ '
,
™™' (
value
™™) .
)
™™. /
;
™™/ 0
}
šš 
public
œœ 

ReportProperties
œœ  
SelectedReportType
œœ .
{
 
get
žž 
=>
žž !
_selectedReportType
žž "
;
žž" #
set
ŸŸ 
{
   	
if
¡¡ 
(
¡¡ 
SetProperty
¡¡ 
(
¡¡ 
ref
¡¡ !
_selectedReportType
¡¡  3
,
¡¡3 4
value
¡¡5 :
)
¡¡: ;
)
¡¡; <
{
¢¢ 
OnPropertyChanged
¥¥ !
(
¥¥! "
nameof
¥¥" (
(
¥¥( )#
IsSalesSummaryVisible
¥¥) >
)
¥¥> ?
)
¥¥? @
;
¥¥@ A
OnPropertyChanged
¦¦ !
(
¦¦! "
nameof
¦¦" (
(
¦¦( )"
IsSalesDetailVisible
¦¦) =
)
¦¦= >
)
¦¦> ?
;
¦¦? @
OnPropertyChanged
§§ !
(
§§! "
nameof
§§" (
(
§§( )#
IsSalesBalanceVisible
§§) >
)
§§> ?
)
§§? @
;
§§@ A
OnPropertyChanged
¨¨ !
(
¨¨! "
nameof
¨¨" (
(
¨¨( )'
IsExceptionsReportVisible
¨¨) B
)
¨¨B C
)
¨¨C D
;
¨¨D E
OnPropertyChanged
©© !
(
©©! "
nameof
©©" (
(
©©( )'
IsCreditCardReportVisible
©©) B
)
©©B C
)
©©C D
;
©©D E
OnPropertyChanged
ªª !
(
ªª! "
nameof
ªª" (
(
ªª( )$
IsPaymentReportVisible
ªª) ?
)
ªª? @
)
ªª@ A
;
ªªA B
OnPropertyChanged
«« !
(
««! "
nameof
««" (
(
««( )&
IsMenuUsageReportVisible
««) A
)
««A B
)
««B C
;
««C D
OnPropertyChanged
¬¬ !
(
¬¬! "
nameof
¬¬" (
(
¬¬( )/
!IsServerProductivityReportVisible
¬¬) J
)
¬¬J K
)
¬¬K L
;
¬¬L M
OnPropertyChanged
­­ !
(
­­! "
nameof
­­" (
(
­­( )(
IsHourlyLaborReportVisible
­­) C
)
­­C D
)
­­D E
;
­­E F
OnPropertyChanged
®® !
(
®®! "
nameof
®®" (
(
®®( )$
IsJournalReportVisible
®®) ?
)
®®? @
)
®®@ A
;
®®A B
OnPropertyChanged
¯¯ !
(
¯¯! "
nameof
¯¯" (
(
¯¯( ))
IsProductivityReportVisible
¯¯) D
)
¯¯D E
)
¯¯E F
;
¯¯F G
OnPropertyChanged
°° !
(
°°! "
nameof
°°" (
(
°°( )"
IsLaborReportVisible
°°) =
)
°°= >
)
°°> ?
;
°°? @
OnPropertyChanged
±± !
(
±±! "
nameof
±±" (
(
±±( )%
IsDeliveryReportVisible
±±) @
)
±±@ A
)
±±A B
;
±±B C
OnPropertyChanged
²² !
(
²²! "
nameof
²²" (
(
²²( ) 
IsTipReportVisible
²²) ;
)
²²; <
)
²²< =
;
²²= >
OnPropertyChanged
´´ !
(
´´! "
nameof
´´" (
(
´´( )
HasSalesSummary
´´) 8
)
´´8 9
)
´´9 :
;
´´: ;
OnPropertyChanged
µµ !
(
µµ! "
nameof
µµ" (
(
µµ( )
HasSalesDetail
µµ) 7
)
µµ7 8
)
µµ8 9
;
µµ9 :
OnPropertyChanged
¶¶ !
(
¶¶! "
nameof
¶¶" (
(
¶¶( )
HasSalesBalance
¶¶) 8
)
¶¶8 9
)
¶¶9 :
;
¶¶: ;
OnPropertyChanged
·· !
(
··! "
nameof
··" (
(
··( )!
HasExceptionsReport
··) <
)
··< =
)
··= >
;
··> ?
OnPropertyChanged
¸¸ !
(
¸¸! "
nameof
¸¸" (
(
¸¸( )!
HasCreditCardReport
¸¸) <
)
¸¸< =
)
¸¸= >
;
¸¸> ?
OnPropertyChanged
¹¹ !
(
¹¹! "
nameof
¹¹" (
(
¹¹( )
HasPaymentReport
¹¹) 9
)
¹¹9 :
)
¹¹: ;
;
¹¹; <
OnPropertyChanged
ºº !
(
ºº! "
nameof
ºº" (
(
ºº( ) 
HasMenuUsageReport
ºº) ;
)
ºº; <
)
ºº< =
;
ºº= >
OnPropertyChanged
»» !
(
»»! "
nameof
»»" (
(
»»( ))
HasServerProductivityReport
»») D
)
»»D E
)
»»E F
;
»»F G
OnPropertyChanged
¼¼ !
(
¼¼! "
nameof
¼¼" (
(
¼¼( )"
HasHourlyLaborReport
¼¼) =
)
¼¼= >
)
¼¼> ?
;
¼¼? @
OnPropertyChanged
½½ !
(
½½! "
nameof
½½" (
(
½½( )
HasJournalReport
½½) 9
)
½½9 :
)
½½: ;
;
½½; <
OnPropertyChanged
¾¾ !
(
¾¾! "
nameof
¾¾" (
(
¾¾( )#
HasProductivityReport
¾¾) >
)
¾¾> ?
)
¾¾? @
;
¾¾@ A
OnPropertyChanged
¿¿ !
(
¿¿! "
nameof
¿¿" (
(
¿¿( )
HasLaborReport
¿¿) 7
)
¿¿7 8
)
¿¿8 9
;
¿¿9 :
OnPropertyChanged
ÀÀ !
(
ÀÀ! "
nameof
ÀÀ" (
(
ÀÀ( )
HasDeliveryReport
ÀÀ) :
)
ÀÀ: ;
)
ÀÀ; <
;
ÀÀ< =
OnPropertyChanged
ÁÁ !
(
ÁÁ! "
nameof
ÁÁ" (
(
ÁÁ( )
HasTipReport
ÁÁ) 5
)
ÁÁ5 6
)
ÁÁ6 7
;
ÁÁ7 8
OnPropertyChanged
ÂÂ !
(
ÂÂ! "
nameof
ÂÂ" (
(
ÂÂ( )!
HasAttendanceReport
ÂÂ) <
)
ÂÂ< =
)
ÂÂ= >
;
ÂÂ> ?
OnPropertyChanged
ÃÃ !
(
ÃÃ! "
nameof
ÃÃ" (
(
ÃÃ( )
HasCashOutReport
ÃÃ) 9
)
ÃÃ9 :
)
ÃÃ: ;
;
ÃÃ; <
OnPropertyChanged
ÄÄ !
(
ÄÄ! "
nameof
ÄÄ" (
(
ÄÄ( )$
IsCashOutReportVisible
ÄÄ) ?
)
ÄÄ? @
)
ÄÄ@ A
;
ÄÄA B
}
ÅÅ 
}
ÆÆ 	
}
ÇÇ 
public
ÉÉ 
"
ObservableCollection
ÉÉ 
<
ÉÉ  
ReportProperties
ÉÉ  0
>
ÉÉ0 1
ReportTypes
ÉÉ2 =
{
ÉÉ> ?
get
ÉÉ@ C
;
ÉÉC D
}
ÉÉE F
=
ÉÉG H
new
ÉÉI L
(
ÉÉL M
Enum
ÉÉM Q
.
ÉÉQ R
	GetValues
ÉÉR [
<
ÉÉ[ \
ReportProperties
ÉÉ\ l
>
ÉÉl m
(
ÉÉm n
)
ÉÉn o
)
ÉÉo p
;
ÉÉp q
public
ËË 

bool
ËË #
IsSalesSummaryVisible
ËË %
=>
ËË& ( 
SelectedReportType
ËË) ;
==
ËË< >
ReportProperties
ËË? O
.
ËËO P
SalesSummary
ËËP \
;
ËË\ ]
public
ÌÌ 

bool
ÌÌ "
IsSalesDetailVisible
ÌÌ $
=>
ÌÌ% ' 
SelectedReportType
ÌÌ( :
==
ÌÌ; =
ReportProperties
ÌÌ> N
.
ÌÌN O
SalesDetail
ÌÌO Z
;
ÌÌZ [
public
ÍÍ 

bool
ÍÍ #
IsSalesBalanceVisible
ÍÍ %
=>
ÍÍ& ( 
SelectedReportType
ÍÍ) ;
==
ÍÍ< >
ReportProperties
ÍÍ? O
.
ÍÍO P
SalesBalance
ÍÍP \
;
ÍÍ\ ]
public
ÎÎ 

bool
ÎÎ '
IsExceptionsReportVisible
ÎÎ )
=>
ÎÎ* , 
SelectedReportType
ÎÎ- ?
==
ÎÎ@ B
ReportProperties
ÎÎC S
.
ÎÎS T

Exceptions
ÎÎT ^
;
ÎÎ^ _
public
ÏÏ 

bool
ÏÏ '
IsCreditCardReportVisible
ÏÏ )
=>
ÏÏ* , 
SelectedReportType
ÏÏ- ?
==
ÏÏ@ B
ReportProperties
ÏÏC S
.
ÏÏS T
CreditCardReport
ÏÏT d
;
ÏÏd e
public
ÐÐ 

bool
ÐÐ $
IsPaymentReportVisible
ÐÐ &
=>
ÐÐ' ) 
SelectedReportType
ÐÐ* <
==
ÐÐ= ?
ReportProperties
ÐÐ@ P
.
ÐÐP Q
PaymentReport
ÐÐQ ^
;
ÐÐ^ _
public
ÑÑ 

bool
ÑÑ &
IsMenuUsageReportVisible
ÑÑ (
=>
ÑÑ) + 
SelectedReportType
ÑÑ, >
==
ÑÑ? A
ReportProperties
ÑÑB R
.
ÑÑR S
MenuUsageReport
ÑÑS b
;
ÑÑb c
public
ÒÒ 

bool
ÒÒ /
!IsServerProductivityReportVisible
ÒÒ 1
=>
ÒÒ2 4 
SelectedReportType
ÒÒ5 G
==
ÒÒH J
ReportProperties
ÒÒK [
.
ÒÒ[ \&
ServerProductivityReport
ÒÒ\ t
;
ÒÒt u
public
ÓÓ 

bool
ÓÓ (
IsHourlyLaborReportVisible
ÓÓ *
=>
ÓÓ+ - 
SelectedReportType
ÓÓ. @
==
ÓÓA C
ReportProperties
ÓÓD T
.
ÓÓT U
HourlyLaborReport
ÓÓU f
;
ÓÓf g
public
ÔÔ 

bool
ÔÔ $
IsJournalReportVisible
ÔÔ &
=>
ÔÔ' ) 
SelectedReportType
ÔÔ* <
==
ÔÔ= ?
ReportProperties
ÔÔ@ P
.
ÔÔP Q
Journal
ÔÔQ X
;
ÔÔX Y
public
ÕÕ 

bool
ÕÕ )
IsProductivityReportVisible
ÕÕ +
=>
ÕÕ, . 
SelectedReportType
ÕÕ/ A
==
ÕÕB D
ReportProperties
ÕÕE U
.
ÕÕU V
Productivity
ÕÕV b
;
ÕÕb c
public
ÖÖ 

bool
ÖÖ "
IsLaborReportVisible
ÖÖ $
=>
ÖÖ% ' 
SelectedReportType
ÖÖ( :
==
ÖÖ; =
ReportProperties
ÖÖ> N
.
ÖÖN O
Labor
ÖÖO T
;
ÖÖT U
public
×× 

bool
×× %
IsDeliveryReportVisible
×× '
=>
××( * 
SelectedReportType
××+ =
==
××> @
ReportProperties
××A Q
.
××Q R
Delivery
××R Z
;
××Z [
public
ØØ 

bool
ØØ  
IsTipReportVisible
ØØ "
=>
ØØ# % 
SelectedReportType
ØØ& 8
==
ØØ9 ;
ReportProperties
ØØ< L
.
ØØL M
Tips
ØØM Q
;
ØØQ R
public
ÙÙ 

bool
ÙÙ '
IsAttendanceReportVisible
ÙÙ )
=>
ÙÙ* , 
SelectedReportType
ÙÙ- ?
==
ÙÙ@ B
ReportProperties
ÙÙC S
.
ÙÙS T

Attendance
ÙÙT ^
;
ÙÙ^ _
public
ÚÚ 

bool
ÚÚ $
IsCashOutReportVisible
ÚÚ &
=>
ÚÚ' ) 
SelectedReportType
ÚÚ* <
==
ÚÚ= ?
ReportProperties
ÚÚ@ P
.
ÚÚP Q
CashOut
ÚÚQ X
;
ÚÚX Y
public
ÜÜ 
#
SalesSummaryReportDto
ÜÜ  
?
ÜÜ  !
SalesSummary
ÜÜ" .
{
ÝÝ 
get
ÞÞ 
=>
ÞÞ 
_salesSummary
ÞÞ 
;
ÞÞ 
private
ßß 
set
ßß 
=>
ßß 
SetProperty
ßß "
(
ßß" #
ref
ßß# &
_salesSummary
ßß' 4
,
ßß4 5
value
ßß6 ;
)
ßß; <
;
ßß< =
}
àà 
public
ââ 
"
SalesDetailReportDto
ââ 
?
ââ  
SalesDetail
ââ! ,
{
ãã 
get
ää 
=>
ää 
_salesDetail
ää 
;
ää 
private
åå 
set
åå 
=>
åå 
SetProperty
åå "
(
åå" #
ref
åå# &
_salesDetail
åå' 3
,
åå3 4
value
åå5 :
)
åå: ;
;
åå; <
}
ææ 
public
èè 
#
SalesBalanceReportDto
èè  
?
èè  !
SalesBalance
èè" .
{
éé 
get
êê 
=>
êê 
_salesBalance
êê 
;
êê 
private
ëë 
set
ëë 
=>
ëë 
SetProperty
ëë "
(
ëë" #
ref
ëë# &
_salesBalance
ëë' 4
,
ëë4 5
value
ëë6 ;
)
ëë; <
;
ëë< =
}
ìì 
public
îî 
!
ExceptionsReportDto
îî 
?
îî 
ExceptionsReport
îî  0
{
ïï 
get
ðð 
=>
ðð 
_exceptionsReport
ðð  
;
ðð  !
private
ññ 
set
ññ 
=>
ññ 
SetProperty
ññ "
(
ññ" #
ref
ññ# &
_exceptionsReport
ññ' 8
,
ññ8 9
value
ññ: ?
)
ññ? @
;
ññ@ A
}
òò 
public
ôô 
!
CreditCardReportDto
ôô 
?
ôô 
CreditCardReport
ôô  0
{
õõ 
get
öö 
=>
öö 
_creditCardReport
öö  
;
öö  !
private
÷÷ 
set
÷÷ 
=>
÷÷ 
SetProperty
÷÷ "
(
÷÷" #
ref
÷÷# &
_creditCardReport
÷÷' 8
,
÷÷8 9
value
÷÷: ?
)
÷÷? @
;
÷÷@ A
}
øø 
public
úú 

PaymentReportDto
úú 
?
úú 
PaymentReport
úú *
{
ûû 
get
üü 
=>
üü 
_paymentReport
üü 
;
üü 
private
ýý 
set
ýý 
=>
ýý 
SetProperty
ýý "
(
ýý" #
ref
ýý# &
_paymentReport
ýý' 5
,
ýý5 6
value
ýý7 <
)
ýý< =
;
ýý= >
}
þþ 
public
€€ 
 
MenuUsageReportDto
€€ 
?
€€ 
MenuUsageReport
€€ .
{
 
get
‚‚ 
=>
‚‚ 
_menuUsageReport
‚‚ 
;
‚‚  
private
ƒƒ 
set
ƒƒ 
=>
ƒƒ 
SetProperty
ƒƒ "
(
ƒƒ" #
ref
ƒƒ# &
_menuUsageReport
ƒƒ' 7
,
ƒƒ7 8
value
ƒƒ9 >
)
ƒƒ> ?
;
ƒƒ? @
}
„„ 
public
†† 
)
ServerProductivityReportDto
†† &
?
††& '&
ServerProductivityReport
††( @
{
‡‡ 
get
ˆˆ 
=>
ˆˆ '
_serverProductivityReport
ˆˆ (
;
ˆˆ( )
private
‰‰ 
set
‰‰ 
=>
‰‰ 
SetProperty
‰‰ "
(
‰‰" #
ref
‰‰# &'
_serverProductivityReport
‰‰' @
,
‰‰@ A
value
‰‰B G
)
‰‰G H
;
‰‰H I
}
ŠŠ 
public
ŒŒ 
"
HourlyLaborReportDto
ŒŒ 
?
ŒŒ  
HourlyLaborReport
ŒŒ! 2
{
 
get
ŽŽ 
=>
ŽŽ  
_hourlyLaborReport
ŽŽ !
;
ŽŽ! "
private
 
set
 
=>
 
SetProperty
 "
(
" #
ref
# & 
_hourlyLaborReport
' 9
,
9 :
value
; @
)
@ A
;
A B
}
 
public
’’ 

JournalReportDto
’’ 
?
’’ 
JournalReport
’’ *
{
““ 
get
”” 
=>
”” 
_journalReport
”” 
;
”” 
private
•• 
set
•• 
=>
•• 
SetProperty
•• "
(
••" #
ref
••# &
_journalReport
••' 5
,
••5 6
value
••7 <
)
••< =
;
••= >
}
–– 
public
˜˜ 
#
ProductivityReportDto
˜˜  
?
˜˜  ! 
ProductivityReport
˜˜" 4
{
™™ 
get
šš 
=>
šš !
_productivityReport
šš "
;
šš" #
private
›› 
set
›› 
=>
›› 
SetProperty
›› "
(
››" #
ref
››# &!
_productivityReport
››' :
,
››: ;
value
››< A
)
››A B
;
››B C
}
œœ 
public
žž 

LaborReportDto
žž 
?
žž 
LaborReport
žž &
{
ŸŸ 
get
   
=>
   
_laborReport
   
;
   
private
¡¡ 
set
¡¡ 
=>
¡¡ 
SetProperty
¡¡ "
(
¡¡" #
ref
¡¡# &
_laborReport
¡¡' 3
,
¡¡3 4
value
¡¡5 :
)
¡¡: ;
;
¡¡; <
}
¢¢ 
public
¤¤ 

DeliveryReportDto
¤¤ 
?
¤¤ 
DeliveryReport
¤¤ ,
{
¥¥ 
get
¦¦ 
=>
¦¦ 
_deliveryReport
¦¦ 
;
¦¦ 
private
§§ 
set
§§ 
=>
§§ 
SetProperty
§§ "
(
§§" #
ref
§§# &
_deliveryReport
§§' 6
,
§§6 7
value
§§8 =
)
§§= >
;
§§> ?
}
¨¨ 
public
ªª 

TipReportDto
ªª 
?
ªª 
	TipReport
ªª "
{
«« 
get
¬¬ 
=>
¬¬ 

_tipReport
¬¬ 
;
¬¬ 
private
­­ 
set
­­ 
=>
­­ 
SetProperty
­­ "
(
­­" #
ref
­­# &

_tipReport
­­' 1
,
­­1 2
value
­­3 8
)
­­8 9
;
­­9 :
}
®® 
public
°° 
!
AttendanceReportDto
°° 
?
°° 
AttendanceReport
°°  0
{
±± 
get
²² 
=>
²² 
_attendanceReport
²²  
;
²²  !
private
³³ 
set
³³ 
=>
³³ 
SetProperty
³³ "
(
³³" #
ref
³³# &
_attendanceReport
³³' 8
,
³³8 9
value
³³: ?
)
³³? @
;
³³@ A
}
´´ 
public
¶¶ 

CashOutReportDto
¶¶ 
?
¶¶ 
CashOutReport
¶¶ *
{
·· 
get
¸¸ 
=>
¸¸ 
_cashOutReport
¸¸ 
;
¸¸ 
private
¹¹ 
set
¹¹ 
=>
¹¹ 
SetProperty
¹¹ "
(
¹¹" #
ref
¹¹# &
_cashOutReport
¹¹' 5
,
¹¹5 6
value
¹¹7 <
)
¹¹< =
;
¹¹= >
}
ºº 
public
¼¼ 

bool
¼¼ 
HasSalesSummary
¼¼ 
=>
¼¼  "
SalesSummary
¼¼# /
!=
¼¼0 2
null
¼¼3 7
;
¼¼7 8
public
½½ 

bool
½½ 
HasSalesDetail
½½ 
=>
½½ !
SalesDetail
½½" -
!=
½½. 0
null
½½1 5
;
½½5 6
public
¾¾ 

bool
¾¾ 
HasSalesBalance
¾¾ 
=>
¾¾  "
SalesBalance
¾¾# /
!=
¾¾0 2
null
¾¾3 7
;
¾¾7 8
public
¿¿ 

bool
¿¿ !
HasExceptionsReport
¿¿ #
=>
¿¿$ &
ExceptionsReport
¿¿' 7
!=
¿¿8 :
null
¿¿; ?
;
¿¿? @
public
ÀÀ 

bool
ÀÀ !
HasCreditCardReport
ÀÀ #
=>
ÀÀ$ &
CreditCardReport
ÀÀ' 7
!=
ÀÀ8 :
null
ÀÀ; ?
;
ÀÀ? @
public
ÁÁ 

bool
ÁÁ 
HasPaymentReport
ÁÁ  
=>
ÁÁ! #
PaymentReport
ÁÁ$ 1
!=
ÁÁ2 4
null
ÁÁ5 9
;
ÁÁ9 :
public
ÂÂ 

bool
ÂÂ  
HasMenuUsageReport
ÂÂ "
=>
ÂÂ# %
MenuUsageReport
ÂÂ& 5
!=
ÂÂ6 8
null
ÂÂ9 =
;
ÂÂ= >
public
ÃÃ 

bool
ÃÃ )
HasServerProductivityReport
ÃÃ +
=>
ÃÃ, .&
ServerProductivityReport
ÃÃ/ G
!=
ÃÃH J
null
ÃÃK O
;
ÃÃO P
public
ÄÄ 

bool
ÄÄ "
HasHourlyLaborReport
ÄÄ $
=>
ÄÄ% '
HourlyLaborReport
ÄÄ( 9
!=
ÄÄ: <
null
ÄÄ= A
;
ÄÄA B
public
ÅÅ 

bool
ÅÅ 
HasJournalReport
ÅÅ  
=>
ÅÅ! #
JournalReport
ÅÅ$ 1
!=
ÅÅ2 4
null
ÅÅ5 9
;
ÅÅ9 :
public
ÆÆ 

bool
ÆÆ #
HasProductivityReport
ÆÆ %
=>
ÆÆ& ( 
ProductivityReport
ÆÆ) ;
!=
ÆÆ< >
null
ÆÆ? C
;
ÆÆC D
public
ÇÇ 

bool
ÇÇ 
HasLaborReport
ÇÇ 
=>
ÇÇ !
LaborReport
ÇÇ" -
!=
ÇÇ. 0
null
ÇÇ1 5
;
ÇÇ5 6
public
ÈÈ 

bool
ÈÈ 
HasDeliveryReport
ÈÈ !
=>
ÈÈ" $
DeliveryReport
ÈÈ% 3
!=
ÈÈ4 6
null
ÈÈ7 ;
;
ÈÈ; <
public
ÉÉ 

bool
ÉÉ 
HasTipReport
ÉÉ 
=>
ÉÉ 
	TipReport
ÉÉ  )
!=
ÉÉ* ,
null
ÉÉ- 1
;
ÉÉ1 2
public
ÊÊ 

bool
ÊÊ !
HasAttendanceReport
ÊÊ #
=>
ÊÊ$ &
AttendanceReport
ÊÊ' 7
!=
ÊÊ8 :
null
ÊÊ; ?
;
ÊÊ? @
public
ËË 

bool
ËË 
HasCashOutReport
ËË  
=>
ËË! #
CashOutReport
ËË$ 1
!=
ËË2 4
null
ËË5 9
;
ËË9 :
public
ÍÍ 

string
ÍÍ 
Error
ÍÍ 
{
ÎÎ 
get
ÏÏ 
=>
ÏÏ 
_error
ÏÏ 
;
ÏÏ 
set
ÐÐ 
{
ÑÑ 	
if
ÒÒ 
(
ÒÒ 
SetProperty
ÒÒ 
(
ÒÒ 
ref
ÒÒ 
_error
ÒÒ  &
,
ÒÒ& '
value
ÒÒ( -
)
ÒÒ- .
)
ÒÒ. /
{
ÓÓ 
OnPropertyChanged
ÔÔ !
(
ÔÔ! "
nameof
ÔÔ" (
(
ÔÔ( )
HasError
ÔÔ) 1
)
ÔÔ1 2
)
ÔÔ2 3
;
ÔÔ3 4
}
ÕÕ 
}
ÖÖ 	
}
×× 
public
ÙÙ 

bool
ÙÙ 
HasError
ÙÙ 
=>
ÙÙ 
!
ÙÙ 
string
ÙÙ #
.
ÙÙ# $
IsNullOrEmpty
ÙÙ$ 1
(
ÙÙ1 2
Error
ÙÙ2 7
)
ÙÙ7 8
;
ÙÙ8 9
public
ÛÛ 

AsyncRelayCommand
ÛÛ 
LoadReportCommand
ÛÛ .
{
ÛÛ/ 0
get
ÛÛ1 4
;
ÛÛ4 5
}
ÛÛ6 7
private
ÝÝ 
async
ÝÝ 
Task
ÝÝ 
LoadReportAsync
ÝÝ &
(
ÝÝ& '
)
ÝÝ' (
{
ÞÞ 
IsBusy
ßß 
=
ßß 
true
ßß 
;
ßß 
Error
àà 
=
àà 
string
àà 
.
àà 
Empty
àà 
;
àà 
try
ââ 
{
ãã 	
var
ää 
start
ää 
=
ää 
	StartDate
ää !
.
ää! "
LocalDateTime
ää" /
;
ää/ 0
var
åå 
end
åå 
=
åå 
EndDate
åå 
.
åå 
LocalDateTime
åå +
;
åå+ ,
if
èè 
(
èè 
end
èè 
.
èè 
	TimeOfDay
èè 
==
èè  
TimeSpan
èè! )
.
èè) *
Zero
èè* .
&&
èè/ 1
end
èè2 5
==
èè6 8
start
èè9 >
)
èè> ?
{
éé 
end
êê 
=
êê 
end
êê 
.
êê 
AddDays
êê !
(
êê! "
$num
êê" #
)
êê# $
.
êê$ %

AddSeconds
êê% /
(
êê/ 0
-
êê0 1
$num
êê1 2
)
êê2 3
;
êê3 4
}
ëë 
switch
íí 
(
íí  
SelectedReportType
íí &
)
íí& '
{
îî 
case
ïï 
ReportProperties
ïï %
.
ïï% &
SalesSummary
ïï& 2
:
ïï2 3
var
ðð 
salesReport
ðð #
=
ðð$ %
await
ðð& +
_getSalesSummary
ðð, <
.
ðð< =
HandleAsync
ðð= H
(
ððH I
new
ððI L"
GetSalesSummaryQuery
ððM a
(
ðða b
start
ððb g
,
ððg h
end
ðði l
)
ððl m
)
ððm n
;
ððn o
SalesSummary
ññ  
=
ññ! "
salesReport
ññ# .
;
ññ. /
break
òò 
;
òò 
case
ôô 
ReportProperties
ôô %
.
ôô% &
SalesDetail
ôô& 1
:
ôô1 2
var
õõ 
salesDetail
õõ #
=
õõ$ %
await
õõ& +
_getSalesDetail
õõ, ;
.
õõ; <
HandleAsync
õõ< G
(
õõG H
new
õõH K!
GetSalesDetailQuery
õõL _
(
õõ_ `
start
õõ` e
,
õõe f
end
õõg j
)
õõj k
)
õõk l
;
õõl m
SalesDetail
öö 
=
öö  !
salesDetail
öö" -
;
öö- .
break
÷÷ 
;
÷÷ 
case
ùù 
ReportProperties
ùù %
.
ùù% &
SalesBalance
ùù& 2
:
ùù2 3
var
úú 
salesBalance
úú $
=
úú% &
await
úú' ,
_getSalesBalance
úú- =
.
úú= >
HandleAsync
úú> I
(
úúI J
new
úúJ M"
GetSalesBalanceQuery
úúN b
(
úúb c
start
úúc h
,
úúh i
end
úúj m
)
úúm n
)
úún o
;
úúo p
SalesBalance
ûû  
=
ûû! "
salesBalance
ûû# /
;
ûû/ 0
break
üü 
;
üü 
case
þþ 
ReportProperties
þþ %
.
þþ% &

Exceptions
þþ& 0
:
þþ0 1
var
ÿÿ 

exceptions
ÿÿ "
=
ÿÿ# $
await
ÿÿ% *"
_getExceptionsReport
ÿÿ+ ?
.
ÿÿ? @
HandleAsync
ÿÿ@ K
(
ÿÿK L
new
ÿÿL O&
GetExceptionsReportQuery
ÿÿP h
(
ÿÿh i
start
ÿÿi n
,
ÿÿn o
end
ÿÿp s
)
ÿÿs t
)
ÿÿt u
;
ÿÿu v
ExceptionsReport
€€ $
=
€€% &

exceptions
€€' 1
;
€€1 2
break
 
;
 
case
ƒƒ 
ReportProperties
ƒƒ %
.
ƒƒ% &
CreditCardReport
ƒƒ& 6
:
ƒƒ6 7
var
„„ 
creditCardReport
„„ (
=
„„) *
await
„„+ 0"
_getCreditCardReport
„„1 E
.
„„E F
HandleAsync
„„F Q
(
„„Q R
new
„„R U&
GetCreditCardReportQuery
„„V n
(
„„n o
start
„„o t
,
„„t u
end
„„v y
)
„„y z
)
„„z {
;
„„{ |
CreditCardReport
…… $
=
……% &
creditCardReport
……' 7
;
……7 8
break
†† 
;
†† 
case
ˆˆ 
ReportProperties
ˆˆ %
.
ˆˆ% &
PaymentReport
ˆˆ& 3
:
ˆˆ3 4
var
‰‰ 
paymentReport
‰‰ %
=
‰‰& '
await
‰‰( -
_getPaymentReport
‰‰. ?
.
‰‰? @
HandleAsync
‰‰@ K
(
‰‰K L
new
‰‰L O#
GetPaymentReportQuery
‰‰P e
(
‰‰e f
start
‰‰f k
,
‰‰k l
end
‰‰m p
)
‰‰p q
)
‰‰q r
;
‰‰r s
PaymentReport
ŠŠ !
=
ŠŠ" #
paymentReport
ŠŠ$ 1
;
ŠŠ1 2
break
‹‹ 
;
‹‹ 
case
 
ReportProperties
 %
.
% &
MenuUsageReport
& 5
:
5 6
var
ŽŽ 
menuUsageReport
ŽŽ '
=
ŽŽ( )
await
ŽŽ* /!
_getMenuUsageReport
ŽŽ0 C
.
ŽŽC D
HandleAsync
ŽŽD O
(
ŽŽO P
new
ŽŽP S%
GetMenuUsageReportQuery
ŽŽT k
(
ŽŽk l
start
ŽŽl q
,
ŽŽq r
end
ŽŽs v
)
ŽŽv w
)
ŽŽw x
;
ŽŽx y
MenuUsageReport
 #
=
$ %
menuUsageReport
& 5
;
5 6
break
 
;
 
case
’’ 
ReportProperties
’’ %
.
’’% &&
ServerProductivityReport
’’& >
:
’’> ?
var
““ &
serverProductivityReport
““ 0
=
““1 2
await
““3 8*
_getServerProductivityReport
““9 U
.
““U V
HandleAsync
““V a
(
““a b
new
““b e/
 GetServerProductivityReportQuery““f †
(““† ‡
start““‡ Œ
,““Œ 
end““Ž ‘
)““‘ ’
)““’ “
;“““ ”&
ServerProductivityReport
”” ,
=
””- .&
serverProductivityReport
””/ G
;
””G H
break
•• 
;
•• 
case
—— 
ReportProperties
—— %
.
——% &
HourlyLaborReport
——& 7
:
——7 8
var
˜˜ 
hourlyLaborReport
˜˜ )
=
˜˜* +
await
˜˜, 1#
_getHourlyLaborReport
˜˜2 G
.
˜˜G H
HandleAsync
˜˜H S
(
˜˜S T
new
˜˜T W'
GetHourlyLaborReportQuery
˜˜X q
(
˜˜q r
start
˜˜r w
,
˜˜w x
end
˜˜y |
)
˜˜| }
)
˜˜} ~
;
˜˜~ 
HourlyLaborReport
™™ %
=
™™& '
hourlyLaborReport
™™( 9
;
™™9 :
break
šš 
;
šš 
case
œœ 
ReportProperties
œœ %
.
œœ% &
Journal
œœ& -
:
œœ- .
var
 
journal
 
=
  !
await
" '
_getJournalReport
( 9
.
9 :
HandleAsync
: E
(
E F
new
F I#
GetJournalReportQuery
J _
(
_ `
start
` e
,
e f
end
g j
,
j k
null
l p
,
p q
null
r v
)
v w
)
w x
;
x y
JournalReport
žž !
=
žž" #
journal
žž$ +
;
žž+ ,
break
ŸŸ 
;
ŸŸ 
case
¡¡ 
ReportProperties
¡¡ %
.
¡¡% &
Productivity
¡¡& 2
:
¡¡2 3
var
¢¢ 
productivity
¢¢ $
=
¢¢% &
await
¢¢' ,$
_getProductivityReport
¢¢- C
.
¢¢C D
HandleAsync
¢¢D O
(
¢¢O P
new
¢¢P S(
GetProductivityReportQuery
¢¢T n
(
¢¢n o
start
¢¢o t
,
¢¢t u
end
¢¢v y
,
¢¢y z
null
¢¢{ 
)¢¢ €
)¢¢€ 
;¢¢ ‚ 
ProductivityReport
££ &
=
££' (
productivity
££) 5
;
££5 6
break
¤¤ 
;
¤¤ 
case
¦¦ 
ReportProperties
¦¦ %
.
¦¦% &
Labor
¦¦& +
:
¦¦+ ,
var
§§ 
laborReport
§§ #
=
§§$ %
await
§§& +
_getLaborReport
§§, ;
.
§§; <
HandleAsync
§§< G
(
§§G H
new
§§H K!
GetLaborReportQuery
§§L _
(
§§_ `
start
§§` e
,
§§e f
end
§§g j
)
§§j k
)
§§k l
;
§§l m
LaborReport
¨¨ 
=
¨¨  !
laborReport
¨¨" -
;
¨¨- .
break
©© 
;
©© 
case
«« 
ReportProperties
«« %
.
««% &
Delivery
««& .
:
««. /
var
¬¬ 
deliveryReport
¬¬ &
=
¬¬' (
await
¬¬) . 
_getDeliveryReport
¬¬/ A
.
¬¬A B
HandleAsync
¬¬B M
(
¬¬M N
new
¬¬N Q$
GetDeliveryReportQuery
¬¬R h
(
¬¬h i
start
¬¬i n
,
¬¬n o
end
¬¬p s
)
¬¬s t
)
¬¬t u
;
¬¬u v
DeliveryReport
­­ "
=
­­# $
deliveryReport
­­% 3
;
­­3 4
break
®® 
;
®® 
case
°° 
ReportProperties
°° %
.
°°% &
Tips
°°& *
:
°°* +
var
±± 

tipsReport
±± "
=
±±# $
await
±±% *
_getTipReport
±±+ 8
.
±±8 9
HandleAsync
±±9 D
(
±±D E
new
±±E H
GetTipReportQuery
±±I Z
(
±±Z [
start
±±[ `
,
±±` a
end
±±b e
)
±±e f
)
±±f g
;
±±g h
	TipReport
²² 
=
²² 

tipsReport
²²  *
;
²²* +
break
³³ 
;
³³ 
case
µµ 
ReportProperties
µµ %
.
µµ% &

Attendance
µµ& 0
:
µµ0 1
var
¶¶ 
attendanceReport
¶¶ (
=
¶¶) *
await
¶¶+ 0"
_getAttendanceReport
¶¶1 E
.
¶¶E F
HandleAsync
¶¶F Q
(
¶¶Q R
new
¶¶R U&
GetAttendanceReportQuery
¶¶V n
(
¶¶n o
start
¶¶o t
,
¶¶t u
end
¶¶v y
)
¶¶y z
)
¶¶z {
;
¶¶{ |
AttendanceReport
·· $
=
··% &
attendanceReport
··' 7
;
··7 8
break
¸¸ 
;
¸¸ 
case
ºº 
ReportProperties
ºº %
.
ºº% &
CashOut
ºº& -
:
ºº- .
var
»» 
cashOutReport
»» %
=
»»& '
await
»»( -
_getCashOutReport
»». ?
.
»»? @
HandleAsync
»»@ K
(
»»K L
new
»»L O#
GetCashOutReportQuery
»»P e
(
»»e f
start
»»f k
,
»»k l
end
»»m p
)
»»p q
)
»»q r
;
»»r s
CashOutReport
¼¼ !
=
¼¼" #
cashOutReport
¼¼$ 1
;
¼¼1 2
break
½½ 
;
½½ 
}
¾¾ 
}
¿¿ 	
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ 
{
ÁÁ 	
Error
ÂÂ 
=
ÂÂ 
ex
ÂÂ 
.
ÂÂ 
Message
ÂÂ 
;
ÂÂ 
}
ÃÃ 	
finally
ÄÄ 
{
ÅÅ 	
IsBusy
ÆÆ 
=
ÆÆ 
false
ÆÆ 
;
ÆÆ 
}
ÇÇ 	
}
ÈÈ 
}ÉÉ ëŒ
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\RoleManagementViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class 
PermissionItem #
:$ %
ObservableObject& 6
{ 
public 

UserPermission 
Value 
{  !
get" %
;% &
}' (
public 

string 
Name 
{ 
get 
; 
} 
private 
bool 
_isSelected 
; 
public 

bool 

IsSelected 
{ 
get 
=> 
_isSelected 
; 
set 
=> 
SetProperty 
( 
ref 
_isSelected *
,* +
value, 1
)1 2
;2 3
} 
public 

PermissionItem 
( 
UserPermission (
value) .
,. /
string0 6
name7 ;
,; <
bool= A

isSelectedB L
)L M
{ 
Value 
= 
value 
; 
Name 
= 
name 
; 
_isSelected 
= 

isSelected  
;  !
}   
}!! 
public## 
partial## 
class## #
RoleManagementViewModel## ,
:##- .
ViewModelBase##/ <
{$$ 
private%% 
readonly%% 
IRoleRepository%% $
_roleRepository%%% 4
;%%4 5
private&& 
readonly&& 
ICommandHandler&& $
<&&$ %
CreateRoleCommand&&% 6
,&&6 7
CreateRoleResult&&8 H
>&&H I
_createHandler&&J X
;&&X Y
private'' 
readonly'' 
ICommandHandler'' $
<''$ %
UpdateRoleCommand''% 6
,''6 7
UpdateRoleResult''8 H
>''H I
_updateHandler''J X
;''X Y
private(( 
readonly(( 
ICommandHandler(( $
<(($ %
DeleteRoleCommand((% 6
,((6 7
DeleteRoleResult((8 H
>((H I
_deleteHandler((J X
;((X Y
public** 
 
ObservableCollection** 
<**  
Role**  $
>**$ %
Roles**& +
{**, -
get**. 1
;**1 2
}**3 4
=**5 6
new**7 :
(**: ;
)**; <
;**< =
public++ 
 
ObservableCollection++ 
<++  
PermissionItem++  .
>++. /
Permissions++0 ;
{++< =
get++> A
;++A B
}++C D
=++E F
new++G J
(++J K
)++K L
;++L M
private-- 
Role-- 
?-- 
_selectedRole-- 
;--  
public.. 

Role.. 
?.. 
SelectedRole.. 
{// 
get00 
=>00 
_selectedRole00 
;00 
set11 
{22 	
if33 
(33 
SetProperty33 
(33 
ref33 
_selectedRole33  -
,33- .
value33/ 4
)334 5
)335 6
{44 
HydrateEditor55 
(55 
)55 
;55  
OnPropertyChanged66 !
(66! "
nameof66" (
(66( )
HasSelection66) 5
)665 6
)666 7
;667 8
(77 
(77 
AsyncRelayCommand77 #
)77# $
DeleteCommand77$ 1
)771 2
.772 3#
NotifyCanExecuteChanged773 J
(77J K
)77K L
;77L M
}88 
}99 	
}:: 
public<< 

bool<< 
HasSelection<< 
=><< 
SelectedRole<<  ,
!=<<- /
null<<0 4
;<<4 5
private>> 
string>> 
	_roleName>> 
=>> 
$str>> !
;>>! "
public?? 

string?? 
RoleName?? 
{@@ 
getAA 
=>AA 
	_roleNameAA 
;AA 
setBB 
=>BB 
SetPropertyBB 
(BB 
refBB 
	_roleNameBB (
,BB( )
valueBB* /
)BB/ 0
;BB0 1
}CC 
privateEE 
stringEE 
_statusMessageEE !
=EE" #
$strEE$ +
;EE+ ,
publicFF 

stringFF 
StatusMessageFF 
{GG 
getHH 
=>HH 
_statusMessageHH 
;HH 
setII 
=>II 
SetPropertyII 
(II 
refII 
_statusMessageII -
,II- .
valueII/ 4
)II4 5
;II5 6
}JJ 
publicLL 

ICommandLL 
LoadCommandLL 
{LL  !
getLL" %
;LL% &
}LL' (
publicMM 

ICommandMM 

AddCommandMM 
{MM  
getMM! $
;MM$ %
}MM& '
publicNN 

ICommandNN 
SaveCommandNN 
{NN  !
getNN" %
;NN% &
}NN' (
publicOO 

ICommandOO 
DeleteCommandOO !
{OO" #
getOO$ '
;OO' (
}OO) *
publicQQ 
#
RoleManagementViewModelQQ "
(QQ" #
IRoleRepositoryRR 
roleRepositoryRR &
,RR& '
ICommandHandlerSS 
<SS 
CreateRoleCommandSS )
,SS) *
CreateRoleResultSS+ ;
>SS; <
createHandlerSS= J
,SSJ K
ICommandHandlerTT 
<TT 
UpdateRoleCommandTT )
,TT) *
UpdateRoleResultTT+ ;
>TT; <
updateHandlerTT= J
,TTJ K
ICommandHandlerUU 
<UU 
DeleteRoleCommandUU )
,UU) *
DeleteRoleResultUU+ ;
>UU; <
deleteHandlerUU= J
)UUJ K
{VV 
TitleWW 
=WW 
$strWW !
;WW! "
_roleRepositoryXX 
=XX 
roleRepositoryXX (
;XX( )
_createHandlerYY 
=YY 
createHandlerYY &
;YY& '
_updateHandlerZZ 
=ZZ 
updateHandlerZZ &
;ZZ& '
_deleteHandler[[ 
=[[ 
deleteHandler[[ &
;[[& '
LoadCommand]] 
=]] 
new]] 
AsyncRelayCommand]] +
(]]+ ,
	LoadAsync]], 5
)]]5 6
;]]6 7

AddCommand^^ 
=^^ 
new^^ 
RelayCommand^^ %
(^^% &

PrepareAdd^^& 0
)^^0 1
;^^1 2
SaveCommand__ 
=__ 
new__ 
AsyncRelayCommand__ +
(__+ ,
	SaveAsync__, 5
)__5 6
;__6 7
DeleteCommand`` 
=`` 
new`` 
AsyncRelayCommand`` -
(``- .
DeleteAsync``. 9
,``9 :
(``; <
)``< =
=>``> @
HasSelection``A M
)``M N
;``N O!
InitializePermissionsbb 
(bb 
)bb 
;bb  
}cc 
privateee 
voidee !
InitializePermissionsee &
(ee& '
)ee' (
{ff 
Permissionsgg 
.gg 
Cleargg 
(gg 
)gg 
;gg 
varhh 
valueshh 
=hh 
Enumhh 
.hh 
	GetValueshh #
<hh# $
UserPermissionhh$ 2
>hh2 3
(hh3 4
)hh4 5
;hh5 6
foreachii 
(ii 
varii 
valii 
inii 
valuesii "
)ii" #
{jj 	
ifkk 
(kk 
valkk 
==kk 
UserPermissionkk %
.kk% &
Nonekk& *
)kk* +
continuekk, 4
;kk4 5
Permissionsmm 
.mm 
Addmm 
(mm 
newmm 
PermissionItemmm  .
(mm. /
valmm/ 2
,mm2 3
valmm4 7
.mm7 8
ToStringmm8 @
(mm@ A
)mmA B
,mmB C
falsemmD I
)mmI J
)mmJ K
;mmK L
}nn 	
}oo 
publicqq 

asyncqq 
Taskqq 
	LoadAsyncqq 
(qq  
)qq  !
{rr 
IsBusyss 
=ss 
truess 
;ss 
trytt 
{uu 	
varvv 
rolesvv 
=vv 
awaitvv 
_roleRepositoryvv -
.vv- .
GetAllAsyncvv. 9
(vv9 :
)vv: ;
;vv; <
Rolesww 
.ww 
Clearww 
(ww 
)ww 
;ww 
foreachxx 
(xx 
varxx 
rxx 
inxx 
rolesxx #
)xx# $
Rolesxx% *
.xx* +
Addxx+ .
(xx. /
rxx/ 0
)xx0 1
;xx1 2
StatusMessageyy 
=yy 
$"yy 
$stryy %
{yy% &
Rolesyy& +
.yy+ ,
Countyy, 1
}yy1 2
$stryy2 9
"yy9 :
;yy: ;
if|| 
(|| 
SelectedRole|| 
!=|| 
null||  $
)||$ %
{}} 
SelectedRole~~ 
=~~ 
Roles~~ $
.~~$ %
FirstOrDefault~~% 3
(~~3 4
r~~4 5
=>~~6 8
r~~9 :
.~~: ;
Id~~; =
==~~> @
SelectedRole~~A M
.~~M N
Id~~N P
)~~P Q
;~~Q R
} 
}
€€ 	
catch
 
(
 
	Exception
 
ex
 
)
 
{
‚‚ 	
StatusMessage
ƒƒ 
=
ƒƒ 
$"
ƒƒ 
$str
ƒƒ -
{
ƒƒ- .
ex
ƒƒ. 0
.
ƒƒ0 1
Message
ƒƒ1 8
}
ƒƒ8 9
"
ƒƒ9 :
;
ƒƒ: ;
}
„„ 	
finally
…… 
{
…… 
IsBusy
…… 
=
…… 
false
……  
;
……  !
}
……" #
}
†† 
private
ˆˆ 
void
ˆˆ 

PrepareAdd
ˆˆ 
(
ˆˆ 
)
ˆˆ 
{
‰‰ 
SelectedRole
ŠŠ 
=
ŠŠ 
null
ŠŠ 
;
ŠŠ 
RoleName
‹‹ 
=
‹‹ 
$str
‹‹ 
;
‹‹ 
foreach
ŽŽ 
(
ŽŽ 
var
ŽŽ 
p
ŽŽ 
in
ŽŽ 
Permissions
ŽŽ %
)
ŽŽ% &
p
ŽŽ' (
.
ŽŽ( )

IsSelected
ŽŽ) 3
=
ŽŽ4 5
false
ŽŽ6 ;
;
ŽŽ; <
StatusMessage
 
=
 
$str
 5
;
5 6
}
‘‘ 
private
““ 
void
““ 
HydrateEditor
““ 
(
““ 
)
““  
{
”” 
if
•• 

(
•• 
SelectedRole
•• 
!=
•• 
null
••  
)
••  !
{
–– 	
RoleName
—— 
=
—— 
SelectedRole
—— #
.
——# $
Name
——$ (
;
——( )
foreach
™™ 
(
™™ 
var
™™ 
p
™™ 
in
™™ 
Permissions
™™ )
)
™™) *
{
šš 
p
›› 
.
›› 

IsSelected
›› 
=
›› 
SelectedRole
›› +
.
››+ ,
Permissions
››, 7
.
››7 8
HasFlag
››8 ?
(
››? @
p
››@ A
.
››A B
Value
››B G
)
››G H
;
››H I
}
œœ 
StatusMessage
 
=
 
$"
 
$str
 &
{
& '
SelectedRole
' 3
.
3 4
Name
4 8
}
8 9
"
9 :
;
: ;
}
žž 	
}
ŸŸ 
private
¡¡ 
async
¡¡ 
Task
¡¡ 
	SaveAsync
¡¡  
(
¡¡  !
)
¡¡! "
{
¢¢ 
if
££ 

(
££ 
string
££ 
.
££  
IsNullOrWhiteSpace
££ %
(
££% &
RoleName
££& .
)
££. /
)
££/ 0
{
¤¤ 	
StatusMessage
¥¥ 
=
¥¥ 
$str
¥¥ 4
;
¥¥4 5
return
¦¦ 
;
¦¦ 
}
§§ 	
UserPermission
ªª 
combined
ªª 
=
ªª  !
UserPermission
ªª" 0
.
ªª0 1
None
ªª1 5
;
ªª5 6
foreach
«« 
(
«« 
var
«« 
p
«« 
in
«« 
Permissions
«« %
)
««% &
{
¬¬ 	
if
­­ 
(
­­ 
p
­­ 
.
­­ 

IsSelected
­­ 
)
­­ 
combined
­­ &
|=
­­' )
p
­­* +
.
­­+ ,
Value
­­, 1
;
­­1 2
}
®® 	
IsBusy
°° 
=
°° 
true
°° 
;
°° 
try
±± 
{
²² 	
if
³³ 
(
³³ 
SelectedRole
³³ 
==
³³ 
null
³³  $
)
³³$ %
{
´´ 
var
¶¶ 
result
¶¶ 
=
¶¶ 
await
¶¶ "
_createHandler
¶¶# 1
.
¶¶1 2
HandleAsync
¶¶2 =
(
¶¶= >
new
¶¶> A
CreateRoleCommand
¶¶B S
(
¶¶S T
RoleName
¶¶T \
,
¶¶\ ]
combined
¶¶^ f
)
¶¶f g
)
¶¶g h
;
¶¶h i
if
·· 
(
·· 
result
·· 
.
·· 
	IsSuccess
·· $
)
··$ %
{
¸¸ 
StatusMessage
¹¹ !
=
¹¹" #
$str
¹¹$ 3
;
¹¹3 4
await
ºº 
	LoadAsync
ºº #
(
ºº# $
)
ºº$ %
;
ºº% &
}
»» 
else
¼¼ 
{
½½ 
StatusMessage
¾¾ !
=
¾¾" #
$"
¾¾$ &
$str
¾¾& 5
{
¾¾5 6
result
¾¾6 <
.
¾¾< =
Message
¾¾= D
}
¾¾D E
"
¾¾E F
;
¾¾F G
}
¿¿ 
}
ÀÀ 
else
ÁÁ 
{
ÂÂ 
var
ÄÄ 
result
ÄÄ 
=
ÄÄ 
await
ÄÄ "
_updateHandler
ÄÄ# 1
.
ÄÄ1 2
HandleAsync
ÄÄ2 =
(
ÄÄ= >
new
ÄÄ> A
UpdateRoleCommand
ÄÄB S
(
ÄÄS T
SelectedRole
ÄÄT `
.
ÄÄ` a
Id
ÄÄa c
,
ÄÄc d
RoleName
ÄÄe m
,
ÄÄm n
combined
ÄÄo w
)
ÄÄw x
)
ÄÄx y
;
ÄÄy z
if
ÅÅ 
(
ÅÅ 
result
ÅÅ 
.
ÅÅ 
	IsSuccess
ÅÅ $
)
ÅÅ$ %
{
ÆÆ 
StatusMessage
ÇÇ !
=
ÇÇ" #
$str
ÇÇ$ 3
;
ÇÇ3 4
await
ÈÈ 
	LoadAsync
ÈÈ #
(
ÈÈ# $
)
ÈÈ$ %
;
ÈÈ% &
}
ÉÉ 
else
ÊÊ 
{
ËË 
StatusMessage
ÌÌ !
=
ÌÌ" #
$"
ÌÌ$ &
$str
ÌÌ& 5
{
ÌÌ5 6
result
ÌÌ6 <
.
ÌÌ< =
Message
ÌÌ= D
}
ÌÌD E
"
ÌÌE F
;
ÌÌF G
}
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
catch
ÐÐ 
(
ÐÐ 
	Exception
ÐÐ 
ex
ÐÐ 
)
ÐÐ 
{
ÑÑ 	
StatusMessage
ÒÒ 
=
ÒÒ 
$"
ÒÒ 
$str
ÒÒ %
{
ÒÒ% &
ex
ÒÒ& (
.
ÒÒ( )
Message
ÒÒ) 0
}
ÒÒ0 1
"
ÒÒ1 2
;
ÒÒ2 3
}
ÓÓ 	
finally
ÔÔ 
{
ÔÔ 
IsBusy
ÔÔ 
=
ÔÔ 
false
ÔÔ  
;
ÔÔ  !
}
ÔÔ" #
}
ÕÕ 
private
×× 
async
×× 
Task
×× 
DeleteAsync
×× "
(
××" #
)
××# $
{
ØØ 
if
ÙÙ 

(
ÙÙ 
SelectedRole
ÙÙ 
==
ÙÙ 
null
ÙÙ  
)
ÙÙ  !
return
ÙÙ" (
;
ÙÙ( )
IsBusy
ÛÛ 
=
ÛÛ 
true
ÛÛ 
;
ÛÛ 
try
ÜÜ 
{
ÝÝ 	
var
ÞÞ 
result
ÞÞ 
=
ÞÞ 
await
ÞÞ 
_deleteHandler
ÞÞ -
.
ÞÞ- .
HandleAsync
ÞÞ. 9
(
ÞÞ9 :
new
ÞÞ: =
DeleteRoleCommand
ÞÞ> O
(
ÞÞO P
SelectedRole
ÞÞP \
.
ÞÞ\ ]
Id
ÞÞ] _
)
ÞÞ_ `
)
ÞÞ` a
;
ÞÞa b
if
ßß 
(
ßß 
result
ßß 
.
ßß 
	IsSuccess
ßß  
)
ßß  !
{
àà 
StatusMessage
áá 
=
áá 
$str
áá  /
;
áá/ 0
await
ââ 
	LoadAsync
ââ 
(
ââ  
)
ââ  !
;
ââ! "

PrepareAdd
ãã 
(
ãã 
)
ãã 
;
ãã 
}
ää 
else
åå 
{
ææ 
StatusMessage
çç 
=
çç 
$"
çç  "
$str
çç" 1
{
çç1 2
result
çç2 8
.
çç8 9
Message
çç9 @
}
çç@ A
"
ççA B
;
ççB C
}
èè 
}
éé 	
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê 
{
ëë 	
StatusMessage
ìì 
=
ìì 
$"
ìì 
$str
ìì %
{
ìì% &
ex
ìì& (
.
ìì( )
Message
ìì) 0
}
ìì0 1
"
ìì1 2
;
ìì2 3
}
íí 	
finally
îî 
{
îî 
IsBusy
îî 
=
îî 
false
îî  
;
îî  !
}
îî" #
}
ïï 
}ðð ç
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\RecipeLineViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class 
RecipeLineViewModel  
:! "
ViewModelBase# 0
{ 
private 
decimal 
	_quantity 
; 
public

 

Guid

 
InventoryItemId

 
{

  !
get

" %
;

% &
}

' (
public 

string 
Name 
{ 
get 
; 
} 
public 

string 
Unit 
{ 
get 
; 
} 
public 

decimal 
Quantity 
{ 
get 
=> 
	_quantity 
; 
set 
=> 
SetProperty 
( 
ref 
	_quantity (
,( )
value* /
)/ 0
;0 1
} 
public 

RecipeLineViewModel 
( 
InventoryItem ,
item- 1
,1 2
decimal3 :
quantity; C
)C D
{ 
InventoryItemId 
= 
item 
. 
Id !
;! "
Name 
= 
item 
. 
Name 
; 
Unit 
= 
item 
. 
Unit 
; 
Quantity 
= 
quantity 
; 
} 
} „+
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\QuantityViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
sealed 
partial 
class 
QuantityViewModel -
:. /
ViewModelBase0 =
{ 
private 
readonly 
int 
_maxQuantity %
=& '
$num( +
;+ ,
private

 
string

 
_displayText

 
=

  !
$str

" %
;

% &
public 

string 
DisplayText 
{ 
get 
=> 
_displayText 
; 
set 
=> 
SetProperty 
( 
ref 
_displayText +
,+ ,
value- 2
)2 3
;3 4
} 
private 
string 
_errorMessage  
=! "
string# )
.) *
Empty* /
;/ 0
public 

string 
ErrorMessage 
{ 
get 
=> 
_errorMessage 
; 
set 
=> 
SetProperty 
( 
ref 
_errorMessage ,
,, -
value. 3
)3 4
;4 5
} 
private 
decimal 
_currentValue !
=" #
$num$ %
;% &
public 

decimal 
ResultQuantity !
=>" $
_currentValue% 2
;2 3
public 

QuantityViewModel 
( 
) 
{ 
Title 
= 
$str  
;  !
} 
[!! 
RelayCommand!! 
]!! 
private"" 
void"" 
AppendNumber"" 
("" 
string"" $
number""% +
)""+ ,
{## 
ErrorMessage$$ 
=$$ 
string$$ 
.$$ 
Empty$$ #
;$$# $
if&& 

(&& 
DisplayText&& 
==&& 
$str&& 
||&& !
DisplayText&&" -
==&&. 0
$str&&1 4
)&&4 5
{'' 	
if)) 
()) 
_currentValue)) 
==))  
$num))! "
&&))# %
DisplayText))& 1
==))2 4
$str))5 8
)))8 9
{** 
DisplayText++ 
=++ 
number++ %
;++% &
},, 
else-- 
{.. 
DisplayText// 
+=// 
number// %
;//% &
}00 
}11 	
else22 
{33 	
DisplayText44 
+=44 
number44 !
;44! "
}55 	
if77 

(77 
decimal77 
.77 
TryParse77 
(77 
DisplayText77 (
,77( )
out77* -
var77. 1
result772 8
)778 9
)779 :
{88 	
if99 
(99 
result99 
>99 
_maxQuantity99 %
)99% &
{:: 
DisplayText;; 
=;; 
_maxQuantity;; *
.;;* +
ToString;;+ 3
(;;3 4
);;4 5
;;;5 6
ErrorMessage<< 
=<< 
$"<< !
$str<<! 1
{<<1 2
_maxQuantity<<2 >
}<<> ?
"<<? @
;<<@ A
}== 
_currentValue>> 
=>> 
decimal>> #
.>># $
Parse>>$ )
(>>) *
DisplayText>>* 5
)>>5 6
;>>6 7
}?? 	
}@@ 
[BB 
RelayCommandBB 
]BB 
privateCC 
voidCC 
	BackspaceCC 
(CC 
)CC 
{DD 
ErrorMessageEE 
=EE 
stringEE 
.EE 
EmptyEE #
;EE# $
ifFF 

(FF 
DisplayTextFF 
.FF 
LengthFF 
>FF  
$numFF! "
)FF" #
{GG 	
DisplayTextHH 
=HH 
DisplayTextHH %
.HH% &
	SubstringHH& /
(HH/ 0
$numHH0 1
,HH1 2
DisplayTextHH3 >
.HH> ?
LengthHH? E
-HHF G
$numHHH I
)HHI J
;HHJ K
}II 	
elseJJ 
{KK 	
DisplayTextLL 
=LL 
$strLL 
;LL 
}MM 	
ifOO 

(OO 
decimalOO 
.OO 
TryParseOO 
(OO 
DisplayTextOO (
,OO( )
outOO* -
varOO. 1
resultOO2 8
)OO8 9
)OO9 :
{PP 	
_currentValueQQ 
=QQ 
resultQQ "
;QQ" #
}RR 	
}SS 
[UU 
RelayCommandUU 
]UU 
privateVV 
voidVV 
ClearVV 
(VV 
)VV 
{WW 
ErrorMessageXX 
=XX 
stringXX 
.XX 
EmptyXX #
;XX# $
DisplayTextYY 
=YY 
$strYY 
;YY 
_currentValueZZ 
=ZZ 
$numZZ 
;ZZ 
}[[ 
}\\ µb
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\PurchaseOrderViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class "
PurchaseOrderViewModel #
:$ %
ViewModelBase& 3
{ 
private 
readonly $
IPurchaseOrderRepository -
_poRepository. ;
;; <
private 
readonly 
IVendorRepository &
_vendorRepository' 8
;8 9
private 
readonly $
IInventoryItemRepository - 
_inventoryRepository. B
;B C
private 
readonly *
IInventoryAdjustmentRepository 3!
_adjustmentRepository4 I
;I J
public 
 
ObservableCollection 
<  
PurchaseOrder  -
>- .
PurchaseOrders/ =
{> ?
get@ C
;C D
}E F
=G H
newI L
(L M
)M N
;N O
public 
 
ObservableCollection 
<  
Vendor  &
>& '
AvailableVendors( 8
{9 :
get; >
;> ?
}@ A
=B C
newD G
(G H
)H I
;I J
public 
 
ObservableCollection 
<  
InventoryItem  -
>- .
AvailableItems/ =
{> ?
get@ C
;C D
}E F
=G H
newI L
(L M
)M N
;N O
private 
PurchaseOrder 
? 
_selectedPO &
;& '
public 

PurchaseOrder 
? 

SelectedPO $
{ 
get 
=> 
_selectedPO 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_selectedPO  +
,+ ,
value- 2
)2 3
)3 4
{ 
OnPropertyChanged   !
(  ! "
nameof  " (
(  ( )
CanOrder  ) 1
)  1 2
)  2 3
;  3 4
OnPropertyChanged!! !
(!!! "
nameof!!" (
(!!( )

CanReceive!!) 3
)!!3 4
)!!4 5
;!!5 6
}"" 
}## 	
}$$ 
private&& 
Vendor&& 
?&& 
_selectedVendor&& #
;&&# $
public'' 

Vendor'' 
?'' 
SelectedVendor'' !
{''" #
get''$ '
=>''( *
_selectedVendor''+ :
;'': ;
set''< ?
=>''@ B
SetProperty''C N
(''N O
ref''O R
_selectedVendor''S b
,''b c
value''d i
)''i j
;''j k
}''l m
public)) 

bool)) 
CanOrder)) 
=>)) 

SelectedPO)) &
?))& '
.))' (
Status))( .
==))/ 1
PurchaseOrderStatus))2 E
.))E F
Draft))F K
;))K L
public** 

bool** 

CanReceive** 
=>** 

SelectedPO** (
?**( )
.**) *
Status*** 0
==**1 3
PurchaseOrderStatus**4 G
.**G H
Ordered**H O
;**O P
public,, 

ICommand,, 
LoadDataCommand,, #
{,,$ %
get,,& )
;,,) *
},,+ ,
public-- 

ICommand-- 
CreatePOCommand-- #
{--$ %
get--& )
;--) *
}--+ ,
public.. 

ICommand.. 
OrderPOCommand.. "
{..# $
get..% (
;..( )
}..* +
public// 

ICommand// 
ReceivePOCommand// $
{//% &
get//' *
;//* +
}//, -
public00 

ICommand00 
AddLineCommand00 "
{00# $
get00% (
;00( )
}00* +
public22 
"
PurchaseOrderViewModel22 !
(22! "$
IPurchaseOrderRepository33  
poRepository33! -
,33- .
IVendorRepository44 
vendorRepository44 *
,44* +$
IInventoryItemRepository55  
inventoryRepository55! 4
,554 5*
IInventoryAdjustmentRepository66 & 
adjustmentRepository66' ;
)66; <
{77 
_poRepository88 
=88 
poRepository88 $
;88$ %
_vendorRepository99 
=99 
vendorRepository99 ,
;99, - 
_inventoryRepository:: 
=:: 
inventoryRepository:: 2
;::2 3!
_adjustmentRepository;; 
=;;  
adjustmentRepository;;  4
;;;4 5
Title== 
=== 
$str== !
;==! "
LoadDataCommand?? 
=?? 
new?? 
AsyncRelayCommand?? /
(??/ 0
LoadDataAsync??0 =
)??= >
;??> ?
CreatePOCommand@@ 
=@@ 
new@@ 
AsyncRelayCommand@@ /
(@@/ 0
CreatePOAsync@@0 =
)@@= >
;@@> ?
OrderPOCommandAA 
=AA 
newAA 
AsyncRelayCommandAA .
(AA. /
OrderPOAsyncAA/ ;
)AA; <
;AA< =
ReceivePOCommandBB 
=BB 
newBB 
AsyncRelayCommandBB 0
(BB0 1
ReceivePOAsyncBB1 ?
)BB? @
;BB@ A
}CC 
privateEE 
asyncEE 
TaskEE 
LoadDataAsyncEE $
(EE$ %
)EE% &
{FF 
IsBusyGG 
=GG 
trueGG 
;GG 
tryHH 
{II 	
varJJ 
posJJ 
=JJ 
awaitJJ 
_poRepositoryJJ )
.JJ) *
GetAllAsyncJJ* 5
(JJ5 6
)JJ6 7
;JJ7 8
PurchaseOrdersKK 
.KK 
ClearKK  
(KK  !
)KK! "
;KK" #
foreachLL 
(LL 
varLL 
poLL 
inLL 
posLL "
)LL" #
PurchaseOrdersLL$ 2
.LL2 3
AddLL3 6
(LL6 7
poLL7 9
)LL9 :
;LL: ;
varNN 
vendorsNN 
=NN 
awaitNN 
_vendorRepositoryNN  1
.NN1 2
GetAllAsyncNN2 =
(NN= >
)NN> ?
;NN? @
AvailableVendorsOO 
.OO 
ClearOO "
(OO" #
)OO# $
;OO$ %
foreachPP 
(PP 
varPP 
vPP 
inPP 
vendorsPP %
)PP% &
AvailableVendorsPP' 7
.PP7 8
AddPP8 ;
(PP; <
vPP< =
)PP= >
;PP> ?
varRR 
itemsRR 
=RR 
awaitRR  
_inventoryRepositoryRR 2
.RR2 3
GetAllAsyncRR3 >
(RR> ?
)RR? @
;RR@ A
AvailableItemsSS 
.SS 
ClearSS  
(SS  !
)SS! "
;SS" #
foreachTT 
(TT 
varTT 
iTT 
inTT 
itemsTT #
)TT# $
AvailableItemsTT% 3
.TT3 4
AddTT4 7
(TT7 8
iTT8 9
)TT9 :
;TT: ;
}UU 	
finallyVV 
{VV 
IsBusyVV 
=VV 
falseVV  
;VV  !
}VV" #
}WW 
privateYY 
asyncYY 
TaskYY 
CreatePOAsyncYY $
(YY$ %
)YY% &
{ZZ 
if[[ 

([[ 
SelectedVendor[[ 
==[[ 
null[[ "
)[[" #
return[[$ *
;[[* +
var]] 
poNumber]] 
=]] 
$"]] 
$str]] 
{]] 
DateTime]] %
.]]% &
Now]]& )
:]]) *
$str]]* 2
}]]2 3
$str]]3 4
{]]4 5
PurchaseOrders]]5 C
.]]C D
Count]]D I
+]]J K
$num]]L M
:]]M N
$str]]N P
}]]P Q
"]]Q R
;]]R S
var^^ 
po^^ 
=^^ 
PurchaseOrder^^ 
.^^ 
Create^^ %
(^^% &
poNumber^^& .
,^^. /
SelectedVendor^^0 >
.^^> ?
Id^^? A
)^^A B
;^^B C
await__ 
_poRepository__ 
.__ 
AddAsync__ $
(__$ %
po__% '
)__' (
;__( )
PurchaseOrders`` 
.`` 
Insert`` 
(`` 
$num`` 
,``  
po``! #
)``# $
;``$ %

SelectedPOaa 
=aa 
poaa 
;aa 
}bb 
privatedd 
asyncdd 
Taskdd 
OrderPOAsyncdd #
(dd# $
)dd$ %
{ee 
ifff 

(ff 

SelectedPOff 
==ff 
nullff 
)ff 
returnff  &
;ff& '

SelectedPOgg 
.gg 
MarkAsOrderedgg  
(gg  !
)gg! "
;gg" #
awaithh 
_poRepositoryhh 
.hh 
UpdateAsynchh '
(hh' (

SelectedPOhh( 2
)hh2 3
;hh3 4
OnPropertyChangedii 
(ii 
nameofii  
(ii  !
CanOrderii! )
)ii) *
)ii* +
;ii+ ,
OnPropertyChangedjj 
(jj 
nameofjj  
(jj  !

CanReceivejj! +
)jj+ ,
)jj, -
;jj- .
}kk 
privatemm 
asyncmm 
Taskmm 
ReceivePOAsyncmm %
(mm% &
)mm& '
{nn 
ifoo 

(oo 

SelectedPOoo 
==oo 
nulloo 
)oo 
returnoo  &
;oo& '
IsBusyqq 
=qq 
trueqq 
;qq 
tryrr 
{ss 	

SelectedPOtt 
.tt 
MarkAsReceivedtt %
(tt% &
)tt& '
;tt' (
foreachww 
(ww 
varww 
lineww 
inww  

SelectedPOww! +
.ww+ ,
Linesww, 1
)ww1 2
{xx 
varyy 
itemyy 
=yy 
awaityy   
_inventoryRepositoryyy! 5
.yy5 6
GetByIdAsyncyy6 B
(yyB C
lineyyC G
.yyG H
InventoryItemIdyyH W
)yyW X
;yyX Y
ifzz 
(zz 
itemzz 
!=zz 
nullzz  
)zz  !
{{{ 
item|| 
.|| 
AdjustStock|| $
(||$ %
line||% )
.||) *
QuantityExpected||* :
)||: ;
;||; <
await}}  
_inventoryRepository}} .
.}}. /
UpdateAsync}}/ :
(}}: ;
item}}; ?
)}}? @
;}}@ A
var
€€ 
adj
€€ 
=
€€ !
InventoryAdjustment
€€ 1
.
€€1 2
Create
€€2 8
(
€€8 9
item
€€9 =
.
€€= >
Id
€€> @
,
€€@ A
line
€€B F
.
€€F G
QuantityExpected
€€G W
,
€€W X
$"
€€Y [
$str
€€[ j
{
€€j k

SelectedPO
€€k u
.
€€u v
PONumber
€€v ~
}
€€~ 
"€€ €
)€€€ 
;€€ ‚
await
 #
_adjustmentRepository
 /
.
/ 0
AddAsync
0 8
(
8 9
adj
9 <
)
< =
;
= >
}
‚‚ 
}
ƒƒ 
await
…… 
_poRepository
…… 
.
……  
UpdateAsync
……  +
(
……+ ,

SelectedPO
……, 6
)
……6 7
;
……7 8
OnPropertyChanged
†† 
(
†† 
nameof
†† $
(
††$ %
CanOrder
††% -
)
††- .
)
††. /
;
††/ 0
OnPropertyChanged
‡‡ 
(
‡‡ 
nameof
‡‡ $
(
‡‡$ %

CanReceive
‡‡% /
)
‡‡/ 0
)
‡‡0 1
;
‡‡1 2
}
ˆˆ 	
finally
‰‰ 
{
‰‰ 
IsBusy
‰‰ 
=
‰‰ 
false
‰‰  
;
‰‰  !
}
‰‰" #
}
ŠŠ 
}‹‹ ÝX
bC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\PrintViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
sealed 
class 
PrintViewModel "
:# $
ViewModelBase% 2
{ 
private		 
readonly		 
ICommandHandler		 $
<		$ %!
PrintToKitchenCommand		% :
,		: ; 
PrintToKitchenResult		< P
>		P Q
_printToKitchen		R a
;		a b
private

 
readonly

 
ICommandHandler

 $
<

$ %
PrintReceiptCommand

% 8
,

8 9
PrintReceiptResult

: L
>

L M
_printReceipt

N [
;

[ \
private 
string 
_ticketIdText  
=! "
string# )
.) *
Empty* /
;/ 0
private 
string 
_orderLineIdText #
=$ %
string& ,
., -
Empty- 2
;2 3
private 
string 
_paymentIdText !
=" #
string$ *
.* +
Empty+ 0
;0 1
private 
ReceiptType  
_selectedReceiptType ,
=- .
ReceiptType/ :
.: ;
Ticket; A
;A B
private 
string 
? 
_lastResult 
;  
private 
string 
? 
_error 
; 
public 

PrintViewModel 
( 
ICommandHandler 
< !
PrintToKitchenCommand -
,- . 
PrintToKitchenResult/ C
>C D
printToKitchenE S
,S T
ICommandHandler 
< 
PrintReceiptCommand +
,+ ,
PrintReceiptResult- ?
>? @
printReceiptA M
)M N
{ 
_printToKitchen 
= 
printToKitchen (
;( )
_printReceipt 
= 
printReceipt $
;$ %
Title 
= 
$str 
; 
PrintKitchenCommand 
= 
new !
AsyncRelayCommand" 3
(3 4
PrintKitchenAsync4 E
)E F
;F G
PrintReceiptCommand 
= 
new !
AsyncRelayCommand" 3
(3 4
PrintReceiptAsync4 E
)E F
;F G
} 
public!! 

string!! 
TicketIdText!! 
{"" 
get## 
=>## 
_ticketIdText## 
;## 
set$$ 
=>$$ 
SetProperty$$ 
($$ 
ref$$ 
_ticketIdText$$ ,
,$$, -
value$$. 3
)$$3 4
;$$4 5
}%% 
public'' 

string'' 
OrderLineIdText'' !
{(( 
get)) 
=>)) 
_orderLineIdText)) 
;))  
set** 
=>** 
SetProperty** 
(** 
ref** 
_orderLineIdText** /
,**/ 0
value**1 6
)**6 7
;**7 8
}++ 
public-- 

string-- 
PaymentIdText-- 
{.. 
get// 
=>// 
_paymentIdText// 
;// 
set00 
=>00 
SetProperty00 
(00 
ref00 
_paymentIdText00 -
,00- .
value00/ 4
)004 5
;005 6
}11 
public33 

ReceiptType33 
SelectedReceiptType33 *
{44 
get55 
=>55  
_selectedReceiptType55 #
;55# $
set66 
=>66 
SetProperty66 
(66 
ref66  
_selectedReceiptType66 3
,663 4
value665 :
)66: ;
;66; <
}77 
public99 

IEnumerable99 
<99 
ReceiptType99 "
>99" #
ReceiptTypes99$ 0
=>991 3
Enum994 8
.998 9
	GetValues999 B
<99B C
ReceiptType99C N
>99N O
(99O P
)99P Q
;99Q R
public;; 

string;; 
?;; 

LastResult;; 
{<< 
get== 
=>== 
_lastResult== 
;== 
private>> 
set>> 
=>>> 
SetProperty>> "
(>>" #
ref>># &
_lastResult>>' 2
,>>2 3
value>>4 9
)>>9 :
;>>: ;
}?? 
publicAA 

stringAA 
?AA 
ErrorAA 
{BB 
getCC 
=>CC 
_errorCC 
;CC 
privateDD 
setDD 
{EE 	
ifFF 
(FF 
SetPropertyFF 
(FF 
refFF 
_errorFF  &
,FF& '
valueFF( -
)FF- .
)FF. /
{GG 
OnPropertyChangedHH !
(HH! "
nameofHH" (
(HH( )
HasErrorHH) 1
)HH1 2
)HH2 3
;HH3 4
}II 
}JJ 	
}KK 
publicMM 

boolMM 
HasErrorMM 
=>MM 
!MM 
stringMM #
.MM# $
IsNullOrWhiteSpaceMM$ 6
(MM6 7
ErrorMM7 <
)MM< =
;MM= >
publicOO 

AsyncRelayCommandOO 
PrintKitchenCommandOO 0
{OO1 2
getOO3 6
;OO6 7
}OO8 9
publicPP 

AsyncRelayCommandPP 
PrintReceiptCommandPP 0
{PP1 2
getPP3 6
;PP6 7
}PP8 9
privateRR 
asyncRR 
TaskRR 
PrintKitchenAsyncRR (
(RR( )
)RR) *
{SS 
ErrorTT 
=TT 
nullTT 
;TT 

LastResultUU 
=UU 
nullUU 
;UU 
IsBusyVV 
=VV 
trueVV 
;VV 
tryXX 
{YY 	
ifZZ 
(ZZ 
!ZZ 
GuidZZ 
.ZZ 
TryParseZZ 
(ZZ 
TicketIdTextZZ +
,ZZ+ ,
outZZ- 0
varZZ1 4
ticketIdZZ5 =
)ZZ= >
)ZZ> ?
{[[ 
Error\\ 
=\\ 
$str\\ +
;\\+ ,
return]] 
;]] 
}^^ 
Guid`` 
?`` 
orderLineId`` 
=`` 
null``  $
;``$ %
ifaa 
(aa 
!aa 
stringaa 
.aa 
IsNullOrWhiteSpaceaa *
(aa* +
OrderLineIdTextaa+ :
)aa: ;
)aa; <
{bb 
ifcc 
(cc 
!cc 
Guidcc 
.cc 
TryParsecc "
(cc" #
OrderLineIdTextcc# 2
,cc2 3
outcc4 7
varcc8 ;
olidcc< @
)cc@ A
)ccA B
{dd 
Erroree 
=ee 
$stree 2
;ee2 3
returnff 
;ff 
}gg 
orderLineIdii 
=ii 
olidii "
;ii" #
}jj 
varll 
resultll 
=ll 
awaitll 
_printToKitchenll .
.ll. /
HandleAsyncll/ :
(ll: ;
newll; >!
PrintToKitchenCommandll? T
{mm 
TicketIdnn 
=nn 
ticketIdnn #
,nn# $
OrderLineIdoo 
=oo 
orderLineIdoo )
}pp 
)pp 
;pp 

LastResultrr 
=rr 
resultrr 
.rr  
Successrr  '
?ss 
$"ss 
$strss 5
{ss5 6
resultss6 <
.ss< =
OrderLinesPrintedss= N
}ssN O
"ssO P
:tt 
$strtt :
;tt: ;
}uu 	
catchvv 
(vv 
	Exceptionvv 
exvv 
)vv 
{ww 	
Errorxx 
=xx 
exxx 
.xx 
Messagexx 
;xx 
}yy 	
finallyzz 
{{{ 	
IsBusy|| 
=|| 
false|| 
;|| 
}}} 	
}~~ 
private
€€ 
async
€€ 
Task
€€ 
PrintReceiptAsync
€€ (
(
€€( )
)
€€) *
{
 
Error
‚‚ 
=
‚‚ 
null
‚‚ 
;
‚‚ 

LastResult
ƒƒ 
=
ƒƒ 
null
ƒƒ 
;
ƒƒ 
IsBusy
„„ 
=
„„ 
true
„„ 
;
„„ 
try
†† 
{
‡‡ 	
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
Guid
ˆˆ 
.
ˆˆ 
TryParse
ˆˆ 
(
ˆˆ 
TicketIdText
ˆˆ +
,
ˆˆ+ ,
out
ˆˆ- 0
var
ˆˆ1 4
ticketId
ˆˆ5 =
)
ˆˆ= >
)
ˆˆ> ?
{
‰‰ 
Error
ŠŠ 
=
ŠŠ 
$str
ŠŠ +
;
ŠŠ+ ,
return
‹‹ 
;
‹‹ 
}
ŒŒ 
Guid
ŽŽ 
?
ŽŽ 
	paymentId
ŽŽ 
=
ŽŽ 
null
ŽŽ "
;
ŽŽ" #
if
 
(
 
!
 
string
 
.
  
IsNullOrWhiteSpace
 *
(
* +
PaymentIdText
+ 8
)
8 9
)
9 :
{
 
if
‘‘ 
(
‘‘ 
!
‘‘ 
Guid
‘‘ 
.
‘‘ 
TryParse
‘‘ "
(
‘‘" #
PaymentIdText
‘‘# 0
,
‘‘0 1
out
‘‘2 5
var
‘‘6 9
pid
‘‘: =
)
‘‘= >
)
‘‘> ?
{
’’ 
Error
““ 
=
““ 
$str
““ 0
;
““0 1
return
”” 
;
”” 
}
•• 
	paymentId
—— 
=
—— 
pid
—— 
;
——  
}
˜˜ 
var
šš 
result
šš 
=
šš 
await
šš 
_printReceipt
šš ,
.
šš, -
HandleAsync
šš- 8
(
šš8 9
new
šš9 <!
PrintReceiptCommand
šš= P
{
›› 
TicketId
œœ 
=
œœ 
ticketId
œœ #
,
œœ# $
	PaymentId
 
=
 
	paymentId
 %
,
% &
ReceiptType
žž 
=
žž !
SelectedReceiptType
žž 1
}
ŸŸ 
)
ŸŸ 
;
ŸŸ 

LastResult
¡¡ 
=
¡¡ 
result
¡¡ 
.
¡¡  
Success
¡¡  '
?
¡¡( )
$str
¡¡* =
:
¡¡> ?
$str
¡¡@ W
;
¡¡W X
}
¢¢ 	
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££ 
{
¤¤ 	
Error
¥¥ 
=
¥¥ 
ex
¥¥ 
.
¥¥ 
Message
¥¥ 
;
¥¥ 
}
¦¦ 	
finally
§§ 
{
¨¨ 	
IsBusy
©© 
=
©© 
false
©© 
;
©© 
}
ªª 	
}
«« 
}¬¬  )
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\PrintTemplatesViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class #
PrintTemplatesViewModel $
:% &
ViewModelBase' 4
{ 
private 
readonly $
IPrintTemplateRepository -
_repository. 9
;9 :
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
public 
 
ObservableCollection 
<  
PrintTemplate  -
>- .
	Templates/ 8
{9 :
get; >
;> ?
}@ A
=B C
newD G
(G H
)H I
;I J
private 
PrintTemplate 
? 
_selectedTemplate ,
;, -
public 

PrintTemplate 
? 
SelectedTemplate *
{ 
get 
=> 
_selectedTemplate  
;  !
set 
=> 
SetProperty 
( 
ref 
_selectedTemplate 0
,0 1
value2 7
)7 8
;8 9
} 
public 

ICommand 
LoadCommand 
{  !
get" %
;% &
}' (
public 

ICommand 

AddCommand 
{  
get! $
;$ %
}& '
public 

ICommand 
EditCommand 
{  !
get" %
;% &
}' (
public   
#
PrintTemplatesViewModel   "
(  " #$
IPrintTemplateRepository!!  

repository!!! +
,!!+ ,
NavigationService"" 
navigationService"" +
)""+ ,
{## 
_repository$$ 
=$$ 

repository$$  
;$$  !
_navigationService%% 
=%% 
navigationService%% .
;%%. /
Title'' 
='' 
$str'' !
;''! "
LoadCommand)) 
=)) 
new)) 
AsyncRelayCommand)) +
())+ ,
	LoadAsync)), 5
)))5 6
;))6 7

AddCommand** 
=** 
new** 
AsyncRelayCommand** *
(*** +
AddAsync**+ 3
)**3 4
;**4 5
EditCommand++ 
=++ 
new++ 
AsyncRelayCommand++ +
<+++ ,
PrintTemplate++, 9
>++9 :
(++: ;
	EditAsync++; D
)++D E
;++E F
},, 
public.. 

async.. 
Task.. 
	LoadAsync.. 
(..  
)..  !
{// 
IsBusy00 
=00 
true00 
;00 
try11 
{22 	
	Templates33 
.33 
Clear33 
(33 
)33 
;33 
var44 
items44 
=44 
await44 
_repository44 )
.44) *
GetAllAsync44* 5
(445 6
)446 7
;447 8
foreach55 
(55 
var55 
item55 
in55  
items55! &
)55& '
{66 
	Templates77 
.77 
Add77 
(77 
item77 "
)77" #
;77# $
}88 
}99 	
catch:: 
(:: 
	Exception:: 
ex:: 
):: 
{;; 	
StatusMessage<< 
=<< 
$"<< 
$str<< 7
{<<7 8
ex<<8 :
.<<: ;
Message<<; B
}<<B C
"<<C D
;<<D E
await== 
_navigationService== $
.==$ %
ShowErrorAsync==% 3
(==3 4
$str==4 D
,==D E
$"==F H
$str==H c
{==c d
ex==d f
.==f g
Message==g n
}==n o
"==o p
)==p q
;==q r
}>> 	
finally?? 
{@@ 	
IsBusyAA 
=AA 
falseAA 
;AA 
}BB 	
}CC 
privateEE 
asyncEE 
TaskEE 
AddAsyncEE 
(EE  
)EE  !
{FF 
_navigationServiceHH 
.HH 
NavigateHH #
(HH# $
typeofHH$ *
(HH* +
TemplateEditorPageHH+ =
)HH= >
)HH> ?
;HH? @
}II 
privateKK 
asyncKK 
TaskKK 
	EditAsyncKK  
(KK  !
PrintTemplateKK! .
?KK. /
templateKK0 8
)KK8 9
{LL 
ifMM 

(MM 
templateMM 
==MM 
nullMM 
)MM 
returnMM $
;MM$ %
_navigationServicePP 
.PP 
NavigatePP #
(PP# $
typeofPP$ *
(PP* +
TemplateEditorPagePP+ =
)PP= >
,PP> ?
templatePP@ H
.PPH I
IdPPI K
)PPK L
;PPL M
}QQ 
}RR ‡’
dC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\PaymentViewModel.cs
	namespace

 	
Magidesk


 
.

 
Presentation

 
.

  

ViewModels

  *
;

* +
public 
sealed 
class 
PaymentViewModel $
:% &
ViewModelBase' 4
{ 
private 
readonly 
IQueryHandler "
<" #
GetTicketQuery# 1
,1 2
	TicketDto3 <
?< =
>= >

_getTicket? I
;I J
private 
readonly 
ICommandHandler $
<$ %!
ProcessPaymentCommand% :
,: ; 
ProcessPaymentResult< P
>P Q
_processPaymentR a
;a b
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
	TicketDto 
? 
_ticket 
; 
private 
string 
_ticketIdText  
=! "
string# )
.) *
Empty* /
;/ 0
private 
string 
_processedByText #
=$ %
Guid& *
.* +
Empty+ 0
.0 1
ToString1 9
(9 :
): ;
;; <
private 
string 
_terminalIdText "
=# $
Guid% )
.) *
Empty* /
./ 0
ToString0 8
(8 9
)9 :
;: ;
private 
string 
_cashSessionIdText %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
string 
_amountText 
=  
$str! $
;$ %
private 
string 
_tenderText 
=  
$str! $
;$ %
private 
string 
	_tipsText 
= 
$str "
;" #
private 
string 
? 
_note 
; 
private 
string 
? 
_error 
; 
public   

PaymentViewModel   
(   
IQueryHandler!! 
<!! 
GetTicketQuery!! $
,!!$ %
	TicketDto!!& /
?!!/ 0
>!!0 1
	getTicket!!2 ;
,!!; <
ICommandHandler"" 
<"" !
ProcessPaymentCommand"" -
,""- . 
ProcessPaymentResult""/ C
>""C D
processPayment""E S
,""S T
NavigationService## 
navigationService## +
)##+ ,
{$$ 

_getTicket%% 
=%% 
	getTicket%% 
;%% 
_processPayment&& 
=&& 
processPayment&& (
;&&( )
_navigationService'' 
='' 
navigationService'' .
;''. /
Title)) 
=)) 
$str)) 
;)) 
LoadTicketCommand++ 
=++ 
new++ 
AsyncRelayCommand++  1
(++1 2
LoadTicketAsync++2 A
)++A B
;++B C
CashPayCommand,, 
=,, 
new,, 
AsyncRelayCommand,, .
(,,. /
CashPayAsync,,/ ;
),,; <
;,,< =
GoBackCommand-- 
=-- 
new-- 
RelayCommand-- (
(--( )
GoBack--) /
)--/ 0
;--0 1
}.. 
public00 

	TicketDto00 
?00 
Ticket00 
{11 
get22 
=>22 
_ticket22 
;22 
private33 
set33 
{44 	
if55 
(55 
SetProperty55 
(55 
ref55 
_ticket55  '
,55' (
value55) .
)55. /
)55/ 0
{66 
OnPropertyChanged77 !
(77! "
nameof77" (
(77( )
	HasTicket77) 2
)772 3
)773 4
;774 5
OnPropertyChanged88 !
(88! "
nameof88" (
(88( )
TicketHeaderText88) 9
)889 :
)88: ;
;88; <
OnPropertyChanged99 !
(99! "
nameof99" (
(99( )

TotalsText99) 3
)993 4
)994 5
;995 6
OnPropertyChanged:: !
(::! "
nameof::" (
(::( )
Payments::) 1
)::1 2
)::2 3
;::3 4
OnPropertyChanged;; !
(;;! "
nameof;;" (
(;;( )
DueAmountText;;) 6
);;6 7
);;7 8
;;;8 9
}<< 
}== 	
}>> 
public@@ 

bool@@ 
	HasTicket@@ 
=>@@ 
Ticket@@ #
!=@@$ &
null@@' +
;@@+ ,
publicBB 

stringBB 
TicketIdTextBB 
{CC 
getDD 
=>DD 
_ticketIdTextDD 
;DD 
setEE 
=>EE 
SetPropertyEE 
(EE 
refEE 
_ticketIdTextEE ,
,EE, -
valueEE. 3
)EE3 4
;EE4 5
}FF 
publicHH 

stringHH 
TicketHeaderTextHH "
=>HH# %
TicketHH& ,
==HH- /
nullHH0 4
?II 	
$strII
 
:JJ 	
$"JJ
 
$strJJ 
{JJ 
TicketJJ 
.JJ 
TicketNumberJJ (
}JJ( )
$strJJ) +
{JJ+ ,
TicketJJ, 2
.JJ2 3
StatusJJ3 9
}JJ9 :
$strJJ: A
{JJA B
TicketJJB H
.JJH I
IdJJI K
}JJK L
"JJL M
;JJM N
publicLL 

stringLL 

TotalsTextLL 
=>LL 
TicketLL  &
==LL' )
nullLL* .
?MM 	
stringMM
 
.MM 
EmptyMM 
:NN 	
$"NN
 
$strNN 
{NN 
TicketNN 
.NN 
TotalAmountNN &
}NN& '
$strNN' /
{NN/ 0
TicketNN0 6
.NN6 7

PaidAmountNN7 A
}NNA B
$strNNB I
{NNI J
TicketNNJ P
.NNP Q
	DueAmountNNQ Z
}NNZ [
"NN[ \
;NN\ ]
publicPP 

stringPP 
DueAmountTextPP 
=>PP  "
TicketPP# )
==PP* ,
nullPP- 1
?PP2 3
stringPP4 :
.PP: ;
EmptyPP; @
:PPA B
TicketPPC I
.PPI J
	DueAmountPPJ S
.PPS T
ToStringPPT \
(PP\ ]
)PP] ^
;PP^ _
publicRR 

IReadOnlyListRR 
<RR 

PaymentDtoRR #
>RR# $
PaymentsRR% -
=>RR. 0
TicketRR1 7
?RR7 8
.RR8 9
PaymentsRR9 A
??RRB D
newRRE H
ListRRI M
<RRM N

PaymentDtoRRN X
>RRX Y
(RRY Z
)RRZ [
;RR[ \
publicTT 

stringTT 
ProcessedByTextTT !
{UU 
getVV 
=>VV 
_processedByTextVV 
;VV  
setWW 
=>WW 
SetPropertyWW 
(WW 
refWW 
_processedByTextWW /
,WW/ 0
valueWW1 6
)WW6 7
;WW7 8
}XX 
publicZZ 

stringZZ 
TerminalIdTextZZ  
{[[ 
get\\ 
=>\\ 
_terminalIdText\\ 
;\\ 
set]] 
=>]] 
SetProperty]] 
(]] 
ref]] 
_terminalIdText]] .
,]]. /
value]]0 5
)]]5 6
;]]6 7
}^^ 
public`` 

string`` 
CashSessionIdText`` #
{aa 
getbb 
=>bb 
_cashSessionIdTextbb !
;bb! "
setcc 
=>cc 
SetPropertycc 
(cc 
refcc 
_cashSessionIdTextcc 1
,cc1 2
valuecc3 8
)cc8 9
;cc9 :
}dd 
publicff 

stringff 

AmountTextff 
{gg 
gethh 
=>hh 
_amountTexthh 
;hh 
setii 
=>ii 
SetPropertyii 
(ii 
refii 
_amountTextii *
,ii* +
valueii, 1
)ii1 2
;ii2 3
}jj 
publicll 

stringll 

TenderTextll 
{mm 
getnn 
=>nn 
_tenderTextnn 
;nn 
setoo 
=>oo 
SetPropertyoo 
(oo 
refoo 
_tenderTextoo *
,oo* +
valueoo, 1
)oo1 2
;oo2 3
}pp 
publicrr 

stringrr 
TipsTextrr 
{ss 
gettt 
=>tt 
	_tipsTexttt 
;tt 
setuu 
=>uu 
SetPropertyuu 
(uu 
refuu 
	_tipsTextuu (
,uu( )
valueuu* /
)uu/ 0
;uu0 1
}vv 
publicxx 

stringxx 
?xx 
Notexx 
{yy 
getzz 
=>zz 
_notezz 
;zz 
set{{ 
=>{{ 
SetProperty{{ 
({{ 
ref{{ 
_note{{ $
,{{$ %
value{{& +
){{+ ,
;{{, -
}|| 
public~~ 

string~~ 
?~~ 
Error~~ 
{ 
get
€€ 
=>
€€ 
_error
€€ 
;
€€ 
private
 
set
 
{
‚‚ 	
if
ƒƒ 
(
ƒƒ 
SetProperty
ƒƒ 
(
ƒƒ 
ref
ƒƒ 
_error
ƒƒ  &
,
ƒƒ& '
value
ƒƒ( -
)
ƒƒ- .
)
ƒƒ. /
{
„„ 
OnPropertyChanged
…… !
(
……! "
nameof
……" (
(
……( )
HasError
……) 1
)
……1 2
)
……2 3
;
……3 4
}
†† 
}
‡‡ 	
}
ˆˆ 
public
ŠŠ 

bool
ŠŠ 
HasError
ŠŠ 
=>
ŠŠ 
!
ŠŠ 
string
ŠŠ #
.
ŠŠ# $ 
IsNullOrWhiteSpace
ŠŠ$ 6
(
ŠŠ6 7
Error
ŠŠ7 <
)
ŠŠ< =
;
ŠŠ= >
public
ŒŒ 

AsyncRelayCommand
ŒŒ 
LoadTicketCommand
ŒŒ .
{
ŒŒ/ 0
get
ŒŒ1 4
;
ŒŒ4 5
}
ŒŒ6 7
public
 

AsyncRelayCommand
 
CashPayCommand
 +
{
, -
get
. 1
;
1 2
}
3 4
public
ŽŽ 

RelayCommand
ŽŽ 
GoBackCommand
ŽŽ %
{
ŽŽ& '
get
ŽŽ( +
;
ŽŽ+ ,
}
ŽŽ- .
private
 
void
 
GoBack
 
(
 
)
 
{
‘‘ 
if
’’ 

(
’’  
_navigationService
’’ 
.
’’ 
	CanGoBack
’’ (
)
’’( )
{
““ 	 
_navigationService
”” 
.
”” 
GoBack
”” %
(
””% &
)
””& '
;
””' (
}
•• 	
}
–– 
private
˜˜ 
async
˜˜ 
Task
˜˜ 
LoadTicketAsync
˜˜ &
(
˜˜& '
)
˜˜' (
{
™™ 
Error
šš 
=
šš 
null
šš 
;
šš 
IsBusy
›› 
=
›› 
true
›› 
;
›› 
try
œœ 
{
 	
if
žž 
(
žž 
!
žž 
Guid
žž 
.
žž 
TryParse
žž 
(
žž 
TicketIdText
žž +
,
žž+ ,
out
žž- 0
var
žž1 4
ticketId
žž5 =
)
žž= >
)
žž> ?
{
žž@ A
Error
žžB G
=
žžH I
$str
žžJ ]
;
žž] ^
return
žž_ e
;
žže f
}
žžg h
Ticket
   
=
   
await
   

_getTicket
   %
.
  % &
HandleAsync
  & 1
(
  1 2
new
  2 5
GetTicketQuery
  6 D
{
  E F
TicketId
  G O
=
  P Q
ticketId
  R Z
}
  [ \
)
  \ ]
;
  ] ^
if
¡¡ 
(
¡¡ 
Ticket
¡¡ 
==
¡¡ 
null
¡¡ 
)
¡¡ 
{
¢¢ 
Error
££ 
=
££ 
$str
££ +
;
££+ ,
}
¤¤ 
}
¥¥ 	
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦ 
{
§§ 	
Error
¨¨ 
=
¨¨ 
ex
¨¨ 
.
¨¨ 
Message
¨¨ 
;
¨¨ 
}
©© 	
finally
ªª 
{
«« 	
IsBusy
¬¬ 
=
¬¬ 
false
¬¬ 
;
¬¬ 
}
­­ 	
}
®® 
private
°° 
async
°° 
Task
°° 
CashPayAsync
°° #
(
°°# $
)
°°$ %
{
±± 
Error
²² 
=
²² 
null
²² 
;
²² 
IsBusy
³³ 
=
³³ 
true
³³ 
;
³³ 
try
´´ 
{
µµ 	
if
¶¶ 
(
¶¶ 
Ticket
¶¶ 
==
¶¶ 
null
¶¶ 
)
¶¶ 
{
¶¶  !
Error
¶¶" '
=
¶¶( )
$str
¶¶* @
;
¶¶@ A
return
¶¶B H
;
¶¶H I
}
¶¶J K
if
·· 
(
·· 
!
·· 
Guid
·· 
.
·· 
TryParse
·· 
(
·· 
ProcessedByText
·· .
,
··. /
out
··0 3
var
··4 7
processedBy
··8 C
)
··C D
)
··D E
{
··F G
Error
··H M
=
··N O
$str
··P f
;
··f g
return
··h n
;
··n o
}
··p q
if
¸¸ 
(
¸¸ 
!
¸¸ 
Guid
¸¸ 
.
¸¸ 
TryParse
¸¸ 
(
¸¸ 
TerminalIdText
¸¸ -
,
¸¸- .
out
¸¸/ 2
var
¸¸3 6

terminalId
¸¸7 A
)
¸¸A B
)
¸¸B C
{
¸¸D E
Error
¸¸F K
=
¸¸L M
$str
¸¸N c
;
¸¸c d
return
¸¸e k
;
¸¸k l
}
¸¸m n
if
¹¹ 
(
¹¹ 
!
¹¹ 
decimal
¹¹ 
.
¹¹ 
TryParse
¹¹ !
(
¹¹! "

AmountText
¹¹" ,
,
¹¹, -
out
¹¹. 1
var
¹¹2 5
amount
¹¹6 <
)
¹¹< =
)
¹¹= >
{
¹¹? @
Error
¹¹A F
=
¹¹G H
$str
¹¹I Z
;
¹¹Z [
return
¹¹\ b
;
¹¹b c
}
¹¹d e
if
ºº 
(
ºº 
!
ºº 
decimal
ºº 
.
ºº 
TryParse
ºº !
(
ºº! "

TenderText
ºº" ,
,
ºº, -
out
ºº. 1
var
ºº2 5
tender
ºº6 <
)
ºº< =
)
ºº= >
{
ºº? @
Error
ººA F
=
ººG H
$str
ººI Z
;
ººZ [
return
ºº\ b
;
ººb c
}
ººd e
if
»» 
(
»» 
!
»» 
decimal
»» 
.
»» 
TryParse
»» !
(
»»! "
TipsText
»»" *
,
»»* +
out
»», /
var
»»0 3
tips
»»4 8
)
»»8 9
)
»»9 :
{
»»; <
Error
»»= B
=
»»C D
$str
»»E T
;
»»T U
return
»»V \
;
»»\ ]
}
»»^ _
Guid
½½ 
?
½½ 
cashSessionId
½½ 
=
½½  !
null
½½" &
;
½½& '
if
¾¾ 
(
¾¾ 
!
¾¾ 
string
¾¾ 
.
¾¾  
IsNullOrWhiteSpace
¾¾ *
(
¾¾* +
CashSessionIdText
¾¾+ <
)
¾¾< =
)
¾¾= >
{
¿¿ 
if
ÀÀ 
(
ÀÀ 
!
ÀÀ 
Guid
ÀÀ 
.
ÀÀ 
TryParse
ÀÀ "
(
ÀÀ" #
CashSessionIdText
ÀÀ# 4
,
ÀÀ4 5
out
ÀÀ6 9
var
ÀÀ: =
csid
ÀÀ> B
)
ÀÀB C
)
ÀÀC D
{
ÀÀE F
Error
ÀÀG L
=
ÀÀM N
$str
ÀÀO g
;
ÀÀg h
return
ÀÀi o
;
ÀÀo p
}
ÀÀq r
cashSessionId
ÁÁ 
=
ÁÁ 
csid
ÁÁ  $
;
ÁÁ$ %
}
ÂÂ 
await
ÄÄ 
_processPayment
ÄÄ !
.
ÄÄ! "
HandleAsync
ÄÄ" -
(
ÄÄ- .
new
ÄÄ. 1#
ProcessPaymentCommand
ÄÄ2 G
{
ÅÅ 
TicketId
ÆÆ 
=
ÆÆ 
Ticket
ÆÆ !
.
ÆÆ! "
Id
ÆÆ" $
,
ÆÆ$ %
PaymentType
ÇÇ 
=
ÇÇ 
PaymentType
ÇÇ )
.
ÇÇ) *
Cash
ÇÇ* .
,
ÇÇ. /
Amount
ÈÈ 
=
ÈÈ 
new
ÈÈ 
Money
ÈÈ "
(
ÈÈ" #
amount
ÈÈ# )
)
ÈÈ) *
,
ÈÈ* +
TenderAmount
ÉÉ 
=
ÉÉ 
new
ÉÉ "
Money
ÉÉ# (
(
ÉÉ( )
tender
ÉÉ) /
)
ÉÉ/ 0
,
ÉÉ0 1

TipsAmount
ÊÊ 
=
ÊÊ 
tips
ÊÊ !
>
ÊÊ" #
$num
ÊÊ$ %
?
ÊÊ& '
new
ÊÊ( +
Money
ÊÊ, 1
(
ÊÊ1 2
tips
ÊÊ2 6
)
ÊÊ6 7
:
ÊÊ8 9
null
ÊÊ: >
,
ÊÊ> ?
ProcessedBy
ËË 
=
ËË 
new
ËË !
UserId
ËË" (
(
ËË( )
processedBy
ËË) 4
)
ËË4 5
,
ËË5 6

TerminalId
ÌÌ 
=
ÌÌ 

terminalId
ÌÌ '
,
ÌÌ' (
CashSessionId
ÍÍ 
=
ÍÍ 
cashSessionId
ÍÍ  -
,
ÍÍ- .
Note
ÎÎ 
=
ÎÎ 
Note
ÎÎ 
}
ÏÏ 
)
ÏÏ 
;
ÏÏ 
await
ÑÑ 
LoadTicketAsync
ÑÑ !
(
ÑÑ! "
)
ÑÑ" #
;
ÑÑ# $
}
ÒÒ 	
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ 
{
ÔÔ 	
Error
ÕÕ 
=
ÕÕ 
ex
ÕÕ 
.
ÕÕ 
Message
ÕÕ 
;
ÕÕ 
}
ÖÖ 	
finally
×× 
{
ØØ 	
IsBusy
ÙÙ 
=
ÙÙ 
false
ÙÙ 
;
ÙÙ 
}
ÚÚ 	
}
ÛÛ 
}ÜÜ ¨
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\PaymentProcessWaitViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
sealed 
partial 
class '
PaymentProcessWaitViewModel 7
:8 9
ViewModelBase: G
{ 
private 
string 
_message 
= 
$str .
;. /
public

 

string

 
Message

 
{ 
get 
=> 
_message 
; 
set 
=> 
SetProperty 
( 
ref 
_message '
,' (
value) .
). /
;/ 0
} 
public 

bool 
CanClose 
{ 
get 
; 
set  #
;# $
}% &
=' (
false) .
;. /
public 
'
PaymentProcessWaitViewModel &
(& '
)' (
{ 
Title 
= 
$str $
;$ %
} 
public 

void 

SetMessage 
( 
string !
message" )
)) *
{ 
Message 
= 
message 
; 
} 
public 

void 

AllowClose 
( 
) 
{ 
CanClose 
= 
true 
; 
} 
} ×
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\OrderTypeSelectionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
class

 '
OrderTypeSelectionViewModel

 (
:

) *
ViewModelBase

+ 8
{ 
private 
readonly  
IOrderTypeRepository ) 
_orderTypeRepository* >
;> ?
private 
	OrderType 
? 
_selectedOrderType )
;) *
public 
 
ObservableCollection 
<  
	OrderType  )
>) *

OrderTypes+ 5
{6 7
get8 ;
;; <
}= >
=? @
newA D
(D E
)E F
;F G
public 

	OrderType 
? 
SelectedOrderType '
{ 
get 
=> 
_selectedOrderType !
;! "
set 
=> 
SetProperty 
( 
ref 
_selectedOrderType 1
,1 2
value3 8
)8 9
;9 :
} 
public 
'
OrderTypeSelectionViewModel &
(& ' 
IOrderTypeRepository' ;
orderTypeRepository< O
)O P
{  
_orderTypeRepository 
= 
orderTypeRepository 2
;2 3
} 
public 

async 
Task 
LoadOrderTypesAsync )
() *
)* +
{ 
IsBusy 
= 
true 
; 
try 
{   	
var!! 
types!! 
=!! 
await!!  
_orderTypeRepository!! 2
.!!2 3
GetActiveAsync!!3 A
(!!A B
)!!B C
;!!C D

OrderTypes"" 
."" 
Clear"" 
("" 
)"" 
;"" 
foreach## 
(## 
var## 
type## 
in##  
types##! &
)##& '
{$$ 

OrderTypes%% 
.%% 
Add%% 
(%% 
type%% #
)%%# $
;%%$ %
}&& 
}'' 	
finally(( 
{)) 	
IsBusy** 
=** 
false** 
;** 
}++ 	
},, 
}-- „„
nC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\OrderTypeExplorerViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
sealed

 
class

 &
OrderTypeExplorerViewModel

 .
:

/ 0
ViewModelBase

1 >
{ 
private 
readonly  
IOrderTypeRepository ) 
_orderTypeRepository* >
;> ?
private 
readonly 
ICommandHandler $
<$ %"
CreateOrderTypeCommand% ;
,; <!
CreateOrderTypeResult= R
>R S
_createT [
;[ \
private 
readonly 
ICommandHandler $
<$ %"
UpdateOrderTypeCommand% ;
,; <!
UpdateOrderTypeResult= R
>R S
_updateT [
;[ \
public 
 
ObservableCollection 
<  
	OrderType  )
>) *

OrderTypes+ 5
{6 7
get8 ;
;; <
}= >
=? @
newA D
(D E
)E F
;F G
private 
	OrderType 
? 
_selectedOrderType )
;) *
public 

	OrderType 
? 
SelectedOrderType '
{ 
get 
=> 
_selectedOrderType !
;! "
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_selectedOrderType  2
,2 3
value4 9
)9 :
): ;
{ &
HydrateEditorFromSelection *
(* +
)+ ,
;, -
OnPropertyChanged !
(! "
nameof" (
(( )
HasSelection) 5
)5 6
)6 7
;7 8
} 
} 	
} 
public   

bool   
HasSelection   
=>   
SelectedOrderType    1
!=  2 4
null  5 9
;  9 :
private"" 
string"" 
_editingName"" 
=""  !
string""" (
.""( )
Empty"") .
;"". /
public## 

string## 
EditingName## 
{$$ 
get%% 
=>%% 
_editingName%% 
;%% 
set&& 
=>&& 
SetProperty&& 
(&& 
ref&& 
_editingName&& +
,&&+ ,
value&&- 2
)&&2 3
;&&3 4
}'' 
private)) 
bool)) 
_editingIsActive)) !
;))! "
public** 

bool** 
EditingIsActive** 
{++ 
get,, 
=>,, 
_editingIsActive,, 
;,,  
set-- 
=>-- 
SetProperty-- 
(-- 
ref-- 
_editingIsActive-- /
,--/ 0
value--1 6
)--6 7
;--7 8
}.. 
private00 
bool00 
_editingCloseOnPaid00 $
;00$ %
public11 

bool11 
EditingCloseOnPaid11 "
{22 
get33 
=>33 
_editingCloseOnPaid33 "
;33" #
set44 
=>44 
SetProperty44 
(44 
ref44 
_editingCloseOnPaid44 2
,442 3
value444 9
)449 :
;44: ;
}55 
private77 
bool77 '
_editingAllowSeatBasedOrder77 ,
;77, -
public88 

bool88 &
EditingAllowSeatBasedOrder88 *
{99 
get:: 
=>:: '
_editingAllowSeatBasedOrder:: *
;::* +
set;; 
=>;; 
SetProperty;; 
(;; 
ref;; '
_editingAllowSeatBasedOrder;; :
,;;: ;
value;;< A
);;A B
;;;B C
}<< 
private>> 
bool>> '
_editingAllowToAddTipsLater>> ,
;>>, -
public?? 

bool?? &
EditingAllowToAddTipsLater?? *
{@@ 
getAA 
=>AA '
_editingAllowToAddTipsLaterAA *
;AA* +
setBB 
=>BB 
SetPropertyBB 
(BB 
refBB '
_editingAllowToAddTipsLaterBB :
,BB: ;
valueBB< A
)BBA B
;BBB C
}CC 
privateEE 
boolEE 
_editingIsBarTabEE !
;EE! "
publicFF 

boolFF 
EditingIsBarTabFF 
{GG 
getHH 
=>HH 
_editingIsBarTabHH 
;HH  
setII 
=>II 
SetPropertyII 
(II 
refII 
_editingIsBarTabII /
,II/ 0
valueII1 6
)II6 7
;II7 8
}JJ 
privateLL 
stringLL 
_statusMessageLL !
=LL" #
$strLL$ +
;LL+ ,
publicMM 

stringMM 
StatusMessageMM 
{NN 
getOO 
=>OO 
_statusMessageOO 
;OO 
setPP 
=>PP 
SetPropertyPP 
(PP 
refPP 
_statusMessagePP -
,PP- .
valuePP/ 4
)PP4 5
;PP5 6
}QQ 
publicSS 

ICommandSS 
LoadCommandSS 
{SS  !
getSS" %
;SS% &
}SS' (
publicTT 

ICommandTT 

AddCommandTT 
{TT  
getTT! $
;TT$ %
}TT& '
publicUU 

ICommandUU 
SaveCommandUU 
{UU  !
getUU" %
;UU% &
}UU' (
publicVV 

ICommandVV 
DeactivateCommandVV %
{VV& '
getVV( +
;VV+ ,
}VV- .
publicXX 
&
OrderTypeExplorerViewModelXX %
(XX% & 
IOrderTypeRepositoryYY 
orderTypeRepositoryYY 0
,YY0 1
ICommandHandlerZZ 
<ZZ "
CreateOrderTypeCommandZZ .
,ZZ. /!
CreateOrderTypeResultZZ0 E
>ZZE F
createZZG M
,ZZM N
ICommandHandler[[ 
<[[ "
UpdateOrderTypeCommand[[ .
,[[. /!
UpdateOrderTypeResult[[0 E
>[[E F
update[[G M
)[[M N
{\\  
_orderTypeRepository]] 
=]] 
orderTypeRepository]] 2
;]]2 3
_create^^ 
=^^ 
create^^ 
;^^ 
_update__ 
=__ 
update__ 
;__ 
Titleaa 
=aa 
$straa %
;aa% &
LoadCommandcc 
=cc 
newcc 
AsyncRelayCommandcc +
(cc+ ,
	LoadAsynccc, 5
)cc5 6
;cc6 7

AddCommanddd 
=dd 
newdd 
AsyncRelayCommanddd *
(dd* +
AddAsyncdd+ 3
)dd3 4
;dd4 5
SaveCommandee 
=ee 
newee 
AsyncRelayCommandee +
(ee+ ,
	SaveAsyncee, 5
,ee5 6
(ee7 8
)ee8 9
=>ee: <
SelectedOrderTypeee= N
!=eeO Q
nulleeR V
)eeV W
;eeW X
DeactivateCommandff 
=ff 
newff 
AsyncRelayCommandff  1
(ff1 2
DeactivateAsyncff2 A
,ffA B
(ffC D
)ffD E
=>ffF H
SelectedOrderTypeffI Z
!=ff[ ]
nullff^ b
)ffb c
;ffc d
}gg 
privateii 
voidii &
HydrateEditorFromSelectionii +
(ii+ ,
)ii, -
{jj 
ifkk 

(kk 
SelectedOrderTypekk 
==kk  
nullkk! %
)kk% &
{ll 	
EditingNamemm 
=mm 
stringmm  
.mm  !
Emptymm! &
;mm& '
EditingIsActivenn 
=nn 
falsenn #
;nn# $
EditingCloseOnPaidoo 
=oo  
falseoo! &
;oo& '&
EditingAllowSeatBasedOrderpp &
=pp' (
falsepp) .
;pp. /&
EditingAllowToAddTipsLaterqq &
=qq' (
falseqq) .
;qq. /
EditingIsBarTabrr 
=rr 
falserr #
;rr# $
returnss 
;ss 
}tt 	
EditingNamevv 
=vv 
SelectedOrderTypevv '
.vv' (
Namevv( ,
;vv, -
EditingIsActiveww 
=ww 
SelectedOrderTypeww +
.ww+ ,
IsActiveww, 4
;ww4 5
EditingCloseOnPaidxx 
=xx 
SelectedOrderTypexx .
.xx. /
CloseOnPaidxx/ :
;xx: ;&
EditingAllowSeatBasedOrderyy "
=yy# $
SelectedOrderTypeyy% 6
.yy6 7
AllowSeatBasedOrderyy7 J
;yyJ K&
EditingAllowToAddTipsLaterzz "
=zz# $
SelectedOrderTypezz% 6
.zz6 7
AllowToAddTipsLaterzz7 J
;zzJ K
EditingIsBarTab{{ 
={{ 
SelectedOrderType{{ +
.{{+ ,
IsBarTab{{, 4
;{{4 5
}|| 
private~~ 
async~~ 
Task~~ 
	LoadAsync~~  
(~~  !
)~~! "
{ 
IsBusy
€€ 
=
€€ 
true
€€ 
;
€€ 
try
 
{
‚‚ 	
var
ƒƒ 
all
ƒƒ 
=
ƒƒ 
await
ƒƒ "
_orderTypeRepository
ƒƒ 0
.
ƒƒ0 1
GetAllAsync
ƒƒ1 <
(
ƒƒ< =
)
ƒƒ= >
;
ƒƒ> ?

OrderTypes
„„ 
.
„„ 
Clear
„„ 
(
„„ 
)
„„ 
;
„„ 
foreach
…… 
(
…… 
var
…… 
ot
…… 
in
…… 
all
…… "
)
……" #
{
†† 

OrderTypes
‡‡ 
.
‡‡ 
Add
‡‡ 
(
‡‡ 
ot
‡‡ !
)
‡‡! "
;
‡‡" #
}
ˆˆ 
StatusMessage
ŠŠ 
=
ŠŠ 
$str
ŠŠ %
;
ŠŠ% &
}
‹‹ 	
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ 
{
 	
StatusMessage
ŽŽ 
=
ŽŽ 
$"
ŽŽ 
$str
ŽŽ +
{
ŽŽ+ ,
ex
ŽŽ, .
.
ŽŽ. /
Message
ŽŽ/ 6
}
ŽŽ6 7
"
ŽŽ7 8
;
ŽŽ8 9
}
 	
finally
 
{
‘‘ 	
IsBusy
’’ 
=
’’ 
false
’’ 
;
’’ 
}
““ 	
}
”” 
private
–– 
async
–– 
Task
–– 
AddAsync
–– 
(
––  
)
––  !
{
—— 
IsBusy
˜˜ 
=
˜˜ 
true
˜˜ 
;
˜˜ 
try
™™ 
{
šš 	
var
›› 
result
›› 
=
›› 
await
›› 
_create
›› &
.
››& '
HandleAsync
››' 2
(
››2 3
new
››3 6$
CreateOrderTypeCommand
››7 M
{
œœ 
Name
 
=
 
$str
 '
,
' (
CloseOnPaid
žž 
=
žž 
false
žž #
,
žž# $!
AllowSeatBasedOrder
ŸŸ #
=
ŸŸ$ %
false
ŸŸ& +
,
ŸŸ+ ,!
AllowToAddTipsLater
   #
=
  $ %
false
  & +
,
  + ,
IsBarTab
¡¡ 
=
¡¡ 
false
¡¡  
,
¡¡  !
IsActive
¢¢ 
=
¢¢ 
true
¢¢ 
}
££ 
)
££ 
;
££ 
await
¥¥ 
	LoadAsync
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
SelectedOrderType
¦¦ 
=
¦¦ 

OrderTypes
¦¦  *
.
¦¦* +
FirstOrDefault
¦¦+ 9
(
¦¦9 :
x
¦¦: ;
=>
¦¦< >
x
¦¦? @
.
¦¦@ A
Id
¦¦A C
==
¦¦D F
result
¦¦G M
.
¦¦M N
OrderTypeId
¦¦N Y
)
¦¦Y Z
;
¦¦Z [
StatusMessage
§§ 
=
§§ 
$str
§§ 1
;
§§1 2
}
¨¨ 	
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©© 
{
ªª 	
StatusMessage
«« 
=
«« 
$"
«« 
$str
«« -
{
««- .
ex
««. 0
.
««0 1
Message
««1 8
}
««8 9
"
««9 :
;
««: ;
}
¬¬ 	
finally
­­ 
{
®® 	
IsBusy
¯¯ 
=
¯¯ 
false
¯¯ 
;
¯¯ 
}
°° 	
}
±± 
private
³³ 
async
³³ 
Task
³³ 
	SaveAsync
³³  
(
³³  !
)
³³! "
{
´´ 
if
µµ 

(
µµ 
SelectedOrderType
µµ 
==
µµ  
null
µµ! %
)
µµ% &
return
µµ' -
;
µµ- .
IsBusy
·· 
=
·· 
true
·· 
;
·· 
try
¸¸ 
{
¹¹ 	
await
ºº 
_update
ºº 
.
ºº 
HandleAsync
ºº %
(
ºº% &
new
ºº& )$
UpdateOrderTypeCommand
ºº* @
{
»» 
OrderTypeId
¼¼ 
=
¼¼ 
SelectedOrderType
¼¼ /
.
¼¼/ 0
Id
¼¼0 2
,
¼¼2 3
Name
½½ 
=
½½ 
EditingName
½½ "
,
½½" #
IsActive
¾¾ 
=
¾¾ 
EditingIsActive
¾¾ *
,
¾¾* +
CloseOnPaid
¿¿ 
=
¿¿  
EditingCloseOnPaid
¿¿ 0
,
¿¿0 1!
AllowSeatBasedOrder
ÀÀ #
=
ÀÀ$ %(
EditingAllowSeatBasedOrder
ÀÀ& @
,
ÀÀ@ A!
AllowToAddTipsLater
ÁÁ #
=
ÁÁ$ %(
EditingAllowToAddTipsLater
ÁÁ& @
,
ÁÁ@ A
IsBarTab
ÂÂ 
=
ÂÂ 
EditingIsBarTab
ÂÂ *
}
ÃÃ 
)
ÃÃ 
;
ÃÃ 
await
ÅÅ 
	LoadAsync
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
SelectedOrderType
ÆÆ 
=
ÆÆ 

OrderTypes
ÆÆ  *
.
ÆÆ* +
FirstOrDefault
ÆÆ+ 9
(
ÆÆ9 :
x
ÆÆ: ;
=>
ÆÆ< >
x
ÆÆ? @
.
ÆÆ@ A
Id
ÆÆA C
==
ÆÆD F
SelectedOrderType
ÆÆG X
.
ÆÆX Y
Id
ÆÆY [
)
ÆÆ[ \
;
ÆÆ\ ]
StatusMessage
ÇÇ 
=
ÇÇ 
$str
ÇÇ $
;
ÇÇ$ %
}
ÈÈ 	
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ 
{
ÊÊ 	
StatusMessage
ËË 
=
ËË 
$"
ËË 
$str
ËË +
{
ËË+ ,
ex
ËË, .
.
ËË. /
Message
ËË/ 6
}
ËË6 7
"
ËË7 8
;
ËË8 9
}
ÌÌ 	
finally
ÍÍ 
{
ÎÎ 	
IsBusy
ÏÏ 
=
ÏÏ 
false
ÏÏ 
;
ÏÏ 
}
ÐÐ 	
}
ÑÑ 
private
ÓÓ 
async
ÓÓ 
Task
ÓÓ 
DeactivateAsync
ÓÓ &
(
ÓÓ& '
)
ÓÓ' (
{
ÔÔ 
if
ÕÕ 

(
ÕÕ 
SelectedOrderType
ÕÕ 
==
ÕÕ  
null
ÕÕ! %
)
ÕÕ% &
return
ÕÕ' -
;
ÕÕ- .
IsBusy
×× 
=
×× 
true
×× 
;
×× 
try
ØØ 
{
ÙÙ 	
await
ÚÚ 
_update
ÚÚ 
.
ÚÚ 
HandleAsync
ÚÚ %
(
ÚÚ% &
new
ÚÚ& )$
UpdateOrderTypeCommand
ÚÚ* @
{
ÛÛ 
OrderTypeId
ÜÜ 
=
ÜÜ 
SelectedOrderType
ÜÜ /
.
ÜÜ/ 0
Id
ÜÜ0 2
,
ÜÜ2 3
IsActive
ÝÝ 
=
ÝÝ 
false
ÝÝ  
}
ÞÞ 
)
ÞÞ 
;
ÞÞ 
await
àà 
	LoadAsync
àà 
(
àà 
)
àà 
;
àà 
SelectedOrderType
áá 
=
áá 
null
áá  $
;
áá$ %
StatusMessage
ââ 
=
ââ 
$str
ââ *
;
ââ* +
}
ãã 	
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää 
{
åå 	
StatusMessage
ææ 
=
ææ 
$"
ææ 
$str
ææ 1
{
ææ1 2
ex
ææ2 4
.
ææ4 5
Message
ææ5 <
}
ææ< =
"
ææ= >
;
ææ> ?
}
çç 	
finally
èè 
{
éé 	
IsBusy
êê 
=
êê 
false
êê 
;
êê 
}
ëë 	
}
ìì 
}íí ä¾
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\OrderEntryViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class 
OrderEntryViewModel (
:) *
ViewModelBase+ 8
{ 
private 
readonly #
IMenuCategoryRepository ,
_categoryRepository- @
;@ A
private 
readonly  
IMenuGroupRepository )
_groupRepository* :
;: ;
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly 
IQueryHandler "
<" #
GetTicketQuery# 1
,1 2
	TicketDto3 <
?< =
>= >
_getTicketHandler? P
;P Q
private 
readonly 
ICommandHandler $
<$ %
CreateTicketCommand% 8
,8 9
CreateTicketResult: L
>L M 
_createTicketHandlerN b
;b c
private 
readonly 
ICommandHandler $
<$ %
AddOrderLineCommand% 8
,8 9
AddOrderLineResult: L
>L M 
_addOrderLineHandlerN b
;b c
private 
readonly 
ICommandHandler $
<$ %!
PrintToKitchenCommand% :
,: ; 
PrintToKitchenResult< P
>P Q"
_printToKitchenHandlerR h
;h i
private 
readonly 
ICommandHandler $
<$ %"
ModifyOrderLineCommand% ;
>; <#
_modifyOrderLineHandler= T
;T U
private 
readonly 
ICommandHandler $
<$ %"
RemoveOrderLineCommand% ;
>; <#
_removeOrderLineHandler= T
;T U
private   
readonly   
ICommandHandler   $
<  $ %
PayNowCommand  % 2
,  2 3
PayNowResult  4 @
>  @ A
_payNowHandler  B P
;  P Q
private!! 
readonly!! 
ICommandHandler!! $
<!!$ %#
SetServiceChargeCommand!!% <
,!!< ="
SetServiceChargeResult!!> T
>!!T U$
_setServiceChargeHandler!!V n
;!!n o
private"" 
readonly"" 
ICommandHandler"" $
<""$ %$
SetDeliveryChargeCommand""% =
,""= >#
SetDeliveryChargeResult""? V
>""V W%
_setDeliveryChargeHandler""X q
;""q r
private## 
readonly## 
ICommandHandler## $
<##$ % 
SetAdjustmentCommand##% 9
,##9 :
SetAdjustmentResult##; N
>##N O!
_setAdjustmentHandler##P e
;##e f
private$$ 
readonly$$ 
NavigationService$$ &
_navigationService$$' 9
;$$9 :
private%% 
readonly%% 
IUserService%% !
_userService%%" .
;%%. /
private&& 
readonly&& 
ITerminalContext&& %
_terminalContext&&& 6
;&&6 7
private'' 
readonly'' 
ICommandHandler'' $
<''$ %
ChangeSeatCommand''% 6
>''6 7
_changeSeatHandler''8 J
;''J K
private(( 
readonly(( 
ICommandHandler(( $
<(($ %
MergeTicketsCommand((% 8
>((8 9 
_mergeTicketsHandler((: N
;((N O
private)) 
readonly)) 
ICommandHandler)) $
<))$ %
ChangeTableCommand))% 7
,))7 8
ChangeTableResult))9 J
>))J K
_changeTableHandler))L _
;))_ `
private** 
readonly** 
ICommandHandler** $
<**$ %
SetCustomerCommand**% 7
,**7 8
SetCustomerResult**9 J
>**J K
_setCustomerHandler**L _
;**_ `
private++ 
readonly++ 
IServiceProvider++ %
_serviceProvider++& 6
;++6 7
private,, 
readonly,, "
IKitchenRoutingService,, +"
_kitchenRoutingService,,, B
;,,B C
private.. 
	TicketDto.. 
?.. 
_ticket.. 
;.. 
private// 
MenuCategory// 
?// 
_selectedCategory// +
;//+ ,
private11 
	MenuGroup11 
?11 
_selectedGroup11 %
;11% &
private22 
string22 
_searchText22 
=22  
string22! '
.22' (
Empty22( -
;22- .
public44 

string44 

SearchText44 
{55 
get66 
=>66 
_searchText66 
;66 
set77 
{88 	
if99 
(99 
SetProperty99 
(99 
ref99 
_searchText99  +
,99+ ,
value99- 2
)992 3
)993 4
{:: 
}<< 
}== 	
}>> 
public@@ 

ICommand@@ 
SettleCommand@@ !
{@@" #
get@@$ '
;@@' (
}@@) *
publicAA 

ICommandAA 
QuickPayCommandAA #
{AA$ %
getAA& )
;AA) *
}AA+ ,
publicCC 
 
ObservableCollectionCC 
<CC  
MenuCategoryCC  ,
>CC, -

CategoriesCC. 8
{CC9 :
getCC; >
;CC> ?
}CC@ A
=CCB C
newCCD G
(CCG H
)CCH I
;CCI J
publicDD 
 
ObservableCollectionDD 
<DD  
	MenuGroupDD  )
>DD) *
GroupsDD+ 1
{DD2 3
getDD4 7
;DD7 8
}DD9 :
=DD; <
newDD= @
(DD@ A
)DDA B
;DDB C
publicFF 
 
ObservableCollectionFF 
<FF  
MenuItemFF  (
>FF( )
ItemsFF* /
{FF0 1
getFF2 5
;FF5 6
}FF7 8
=FF9 :
newFF; >
(FF> ?
)FF? @
;FF@ A
privateHH 
decimalHH 
_pendingQuantityHH $
=HH% &
$numHH' (
;HH( )
publicII 

decimalII 
PendingQuantityII "
{JJ 
getKK 
=>KK 
_pendingQuantityKK 
;KK  
setLL 
{MM 	
ifNN 
(NN 
SetPropertyNN 
(NN 
refNN 
_pendingQuantityNN  0
,NN0 1
valueNN2 7
)NN7 8
)NN8 9
{OO 
OnPropertyChangedPP !
(PP! "
nameofPP" (
(PP( )
PendingQuantityTextPP) <
)PP< =
)PP= >
;PP> ?
OnPropertyChangedQQ !
(QQ! "
nameofQQ" (
(QQ( )$
IsPendingQuantityVisibleQQ) A
)QQA B
)QQB C
;QQC D
}RR 
}SS 	
}TT 
publicVV 

stringVV 
PendingQuantityTextVV %
=>VV& (
$"VV) +
$strVV+ 5
{VV5 6
PendingQuantityVV6 E
}VVE F
"VVF G
;VVG H
publicWW 

boolWW $
IsPendingQuantityVisibleWW (
=>WW) +
PendingQuantityWW, ;
!=WW< >
$numWW? @
;WW@ A
publicYY 

ICommandYY 
SetQuantityCommandYY &
{YY' (
getYY) ,
;YY, -
}YY. /
public[[ 

	TicketDto[[ 
?[[ 
Ticket[[ 
{\\ 
get]] 
=>]] 
_ticket]] 
;]] 
private^^ 
set^^ 
{__ 	
if`` 
(`` 
SetProperty`` 
(`` 
ref``  
_ticket``! (
,``( )
value``* /
)``/ 0
)``0 1
{aa 
OnPropertyChangedbb "
(bb" #
nameofbb# )
(bb) *
	HasTicketbb* 3
)bb3 4
)bb4 5
;bb5 6
OnPropertyChangedcc "
(cc" #
nameofcc# )
(cc) *

OrderLinescc* 4
)cc4 5
)cc5 6
;cc6 7
OnPropertyChangeddd "
(dd" #
nameofdd# )
(dd) *
TicketHeaderTextdd* :
)dd: ;
)dd; <
;dd< =
OnPropertyChangedee "
(ee" #
nameofee# )
(ee) *
GuestCountTextee* 8
)ee8 9
)ee9 :
;ee: ;
OnPropertyChangedff "
(ff" #
nameofff# )
(ff) *

TotalsTextff* 4
)ff4 5
)ff5 6
;ff6 7
OnPropertyChangedgg "
(gg" #
nameofgg# )
(gg) *
SubTotalTextgg* 6
)gg6 7
)gg7 8
;gg8 9
OnPropertyChangedhh "
(hh" #
nameofhh# )
(hh) *
TaxTexthh* 1
)hh1 2
)hh2 3
;hh3 4
OnPropertyChangedii "
(ii" #
nameofii# )
(ii) *
DiscountTextii* 6
)ii6 7
)ii7 8
;ii8 9
OnPropertyChangedjj "
(jj" #
nameofjj# )
(jj) *
HasDiscountjj* 5
)jj5 6
)jj6 7
;jj7 8
OnPropertyChangedkk "
(kk" #
nameofkk# )
(kk) *
HasUnsentItemskk* 8
)kk8 9
)kk9 :
;kk: ;
OnPropertyChangedll "
(ll" #
nameofll# )
(ll) *
HasTicketWithItemsll* <
)ll< =
)ll= >
;ll> ?
}mm 
}nn 	
}oo 
publicqq 

boolqq 
	HasTicketqq 
=>qq 
Ticketqq #
!=qq$ &
nullqq' +
;qq+ ,
publicss 

boolss 
HasTicketWithItemsss "
=>ss# %
Ticketss& ,
!=ss- /
nullss0 4
&&ss5 7
Ticketss8 >
.ss> ?

OrderLinesss? I
.ssI J
AnyssJ M
(ssM N
)ssN O
;ssO P
publicuu 

IReadOnlyListuu 
<uu 
OrderLineDtouu %
>uu% &

OrderLinesuu' 1
=>uu2 4
Ticketuu5 ;
?uu; <
.uu< =

OrderLinesuu= G
??uuH J
newuuK N
ListuuO S
<uuS T
OrderLineDtouuT `
>uu` a
(uua b
)uub c
;uuc d
publicww 

boolww 
HasUnsentItemsww 
=>ww !
Ticketww" (
?ww( )
.ww) *

OrderLinesww* 4
.ww4 5
Anyww5 8
(ww8 9
olww9 ;
=>ww< >
olww? A
.wwA B 
ShouldPrintToKitchenwwB V
&&wwW Y
!wwZ [
olww[ ]
.ww] ^
PrintedToKitchenww^ n
)wwn o
??wwp r
falsewws x
;wwx y
publicyy 

stringyy 
TicketHeaderTextyy "
=>yy# %
Ticketyy& ,
==yy- /
nullyy0 4
?zz 	
$strzz
 
:{{ 	
$"{{
 
$str{{ 
{{{ 
Ticket{{ 
.{{ 
TicketNumber{{ (
}{{( )
$str{{) +
{{{+ ,
Ticket{{, 2
.{{2 3
Status{{3 9
}{{9 :
$str{{: ;
"{{; <
;{{< =
public}} 

string}} 
GuestCountText}}  
=>}}! #
Ticket}}$ *
==}}+ -
null}}. 2
?}}3 4
$str}}5 7
:}}8 9
$"}}: <
$str}}< D
{}}D E
Ticket}}E K
.}}K L
NumberOfGuests}}L Z
}}}Z [
"}}[ \
;}}\ ]
public 

string 
SubTotalText 
=> !
Ticket" (
==) +
null, 0
?1 2
$str3 :
:; <
$"= ?
{? @
Ticket@ F
.F G
SubtotalAmountG U
:U V
$strV W
}W X
"X Y
;Y Z
public
€€ 

string
€€ 
TaxText
€€ 
=>
€€ 
Ticket
€€ #
==
€€$ &
null
€€' +
?
€€, -
$str
€€. 5
:
€€6 7
$"
€€8 :
{
€€: ;
Ticket
€€; A
.
€€A B
	TaxAmount
€€B K
:
€€K L
$str
€€L M
}
€€M N
"
€€N O
;
€€O P
public
 

string
 
DiscountText
 
=>
 !
Ticket
" (
==
) +
null
, 0
?
1 2
$str
3 :
:
; <
$"
= ?
$str
? @
{
@ A
Ticket
A G
.
G H
DiscountAmount
H V
:
V W
$str
W X
}
X Y
"
Y Z
;
Z [
public
‚‚ 

bool
‚‚ 
HasDiscount
‚‚ 
=>
‚‚ 
(
‚‚  
Ticket
‚‚  &
?
‚‚& '
.
‚‚' (
DiscountAmount
‚‚( 6
??
‚‚7 9
$num
‚‚: ;
)
‚‚; <
>
‚‚= >
$num
‚‚? @
;
‚‚@ A
public
„„ 

string
„„ 

TotalsText
„„ 
=>
„„ 
Ticket
„„  &
==
„„' )
null
„„* .
?
…… 	
$str
……
 
:
†† 	
$"
††
 
{
†† 
Ticket
†† 
.
†† 
TotalAmount
†† 
:
††  
$str
††  !
}
††! "
"
††" #
;
††# $
public
ˆˆ 

bool
ˆˆ '
IsSelectionModeCategories
ˆˆ )
=>
ˆˆ* ,
SelectedCategory
ˆˆ- =
==
ˆˆ> @
null
ˆˆA E
;
ˆˆE F
public
‰‰ 

bool
‰‰ #
IsSelectionModeGroups
‰‰ %
=>
‰‰& (
SelectedCategory
‰‰) 9
!=
‰‰: <
null
‰‰= A
&&
‰‰B D
SelectedGroup
‰‰E R
==
‰‰S U
null
‰‰V Z
;
‰‰Z [
public
ŠŠ 

bool
ŠŠ "
IsSelectionModeItems
ŠŠ $
=>
ŠŠ% '
SelectedGroup
ŠŠ( 5
!=
ŠŠ6 8
null
ŠŠ9 =
;
ŠŠ= >
public
ŒŒ 

MenuCategory
ŒŒ 
?
ŒŒ 
SelectedCategory
ŒŒ )
{
 
get
ŽŽ 
=>
ŽŽ 
_selectedCategory
ŽŽ  
;
ŽŽ  !
set
 
{
 	
if
‘‘ 
(
‘‘ 
SetProperty
‘‘ 
(
‘‘ 
ref
‘‘ 
_selectedCategory
‘‘  1
,
‘‘1 2
value
‘‘3 8
)
‘‘8 9
)
‘‘9 :
{
’’ 
OnPropertyChanged
““ !
(
““! "
nameof
““" (
(
““( )'
IsSelectionModeCategories
““) B
)
““B C
)
““C D
;
““D E
OnPropertyChanged
”” !
(
””! "
nameof
””" (
(
””( )#
IsSelectionModeGroups
””) >
)
””> ?
)
””? @
;
””@ A
OnPropertyChanged
•• !
(
••! "
nameof
••" (
(
••( )"
IsSelectionModeItems
••) =
)
••= >
)
••> ?
;
••? @
_
–– 
=
–– 
LoadGroupsAsync
–– #
(
––# $
value
––$ )
)
––) *
;
––* +
SelectedGroup
—— 
=
—— 
null
——  $
;
——$ %
}
˜˜ 
}
™™ 	
}
šš 
public
œœ 

	MenuGroup
œœ 
?
œœ 
SelectedGroup
œœ #
{
 
get
žž 
=>
žž 
_selectedGroup
žž 
;
žž 
set
ŸŸ 
{
   	
if
¡¡ 
(
¡¡ 
SetProperty
¡¡ 
(
¡¡ 
ref
¡¡ 
_selectedGroup
¡¡  .
,
¡¡. /
value
¡¡0 5
)
¡¡5 6
)
¡¡6 7
{
¢¢ 
OnPropertyChanged
££ !
(
££! "
nameof
££" (
(
££( )#
IsSelectionModeGroups
££) >
)
££> ?
)
££? @
;
££@ A
OnPropertyChanged
¤¤ !
(
¤¤! "
nameof
¤¤" (
(
¤¤( )"
IsSelectionModeItems
¤¤) =
)
¤¤= >
)
¤¤> ?
;
¤¤? @
_
¥¥ 
=
¥¥ 
LoadItemsAsync
¥¥ "
(
¥¥" #
value
¥¥# (
)
¥¥( )
;
¥¥) *
}
¦¦ 
}
§§ 	
}
¨¨ 
public
ªª 

ICommand
ªª #
SelectCategoryCommand
ªª )
{
ªª* +
get
ªª, /
;
ªª/ 0
}
ªª1 2
public
«« 

ICommand
««  
SelectGroupCommand
«« &
{
««' (
get
««) ,
;
««, -
}
««. /
public
¬¬ 

ICommand
¬¬ 
AddItemCommand
¬¬ "
{
¬¬# $
get
¬¬% (
;
¬¬( )
}
¬¬* +
public
­­ 

ICommand
­­ %
BackToCategoriesCommand
­­ +
{
­­, -
get
­­. 1
;
­­1 2
}
­­3 4
public
®® 

ICommand
®® 
SearchItemCommand
®® %
{
®®& '
get
®®( +
;
®®+ ,
}
®®- .
public
¯¯ 

ICommand
¯¯ &
IncrementQuantityCommand
¯¯ ,
{
¯¯- .
get
¯¯/ 2
;
¯¯2 3
}
¯¯4 5
public
°° 

ICommand
°° &
DecrementQuantityCommand
°° ,
{
°°- .
get
°°/ 2
;
°°2 3
}
°°4 5
public
±± 

ICommand
±± 
RemoveItemCommand
±± %
{
±±& '
get
±±( +
;
±±+ ,
}
±±- .
private
³³ 
readonly
³³ 
IPrintingService
³³ %
_printingService
³³& 6
;
³³6 7
private
´´ 
readonly
´´ 
Services
´´ 
.
´´ &
IOrderEntryDialogService
´´ 6&
_orderEntryDialogService
´´7 O
;
´´O P
public
¸¸ 

ICommand
¸¸  
PrintTicketCommand
¸¸ &
{
¸¸' (
get
¸¸) ,
;
¸¸, -
}
¸¸. /
public
ºº 
!
OrderEntryViewModel
ºº 
(
ºº %
IMenuCategoryRepository
»»  
categoryRepository
»»  2
,
»»2 3"
IMenuGroupRepository
¼¼ 
groupRepository
¼¼ ,
,
¼¼, -
IMenuRepository
½½ 
menuRepository
½½ &
,
½½& '
IQueryHandler
¾¾ 
<
¾¾ 
GetTicketQuery
¾¾ $
,
¾¾$ %
	TicketDto
¾¾& /
?
¾¾/ 0
>
¾¾0 1
getTicketHandler
¾¾2 B
,
¾¾B C
ICommandHandler
¿¿ 
<
¿¿ !
CreateTicketCommand
¿¿ +
,
¿¿+ , 
CreateTicketResult
¿¿- ?
>
¿¿? @!
createTicketHandler
¿¿A T
,
¿¿T U
ICommandHandler
ÀÀ 
<
ÀÀ !
AddOrderLineCommand
ÀÀ +
,
ÀÀ+ , 
AddOrderLineResult
ÀÀ- ?
>
ÀÀ? @!
addOrderLineHandler
ÀÀA T
,
ÀÀT U
ICommandHandler
ÁÁ 
<
ÁÁ #
PrintToKitchenCommand
ÁÁ -
,
ÁÁ- ."
PrintToKitchenResult
ÁÁ/ C
>
ÁÁC D#
printToKitchenHandler
ÁÁE Z
,
ÁÁZ [
ICommandHandler
ÂÂ 
<
ÂÂ $
ModifyOrderLineCommand
ÂÂ .
>
ÂÂ. /$
modifyOrderLineHandler
ÂÂ0 F
,
ÂÂF G
ICommandHandler
ÃÃ 
<
ÃÃ $
RemoveOrderLineCommand
ÃÃ .
>
ÃÃ. /$
removeOrderLineHandler
ÃÃ0 F
,
ÃÃF G
ICommandHandler
ÄÄ 
<
ÄÄ 
PayNowCommand
ÄÄ %
,
ÄÄ% &
PayNowResult
ÄÄ' 3
>
ÄÄ3 4
payNowHandler
ÄÄ5 B
,
ÄÄB C
ICommandHandler
ÅÅ 
<
ÅÅ %
SetServiceChargeCommand
ÅÅ /
,
ÅÅ/ 0$
SetServiceChargeResult
ÅÅ1 G
>
ÅÅG H%
setServiceChargeHandler
ÅÅI `
,
ÅÅ` a
ICommandHandler
ÆÆ 
<
ÆÆ &
SetDeliveryChargeCommand
ÆÆ 0
,
ÆÆ0 1%
SetDeliveryChargeResult
ÆÆ2 I
>
ÆÆI J&
setDeliveryChargeHandler
ÆÆK c
,
ÆÆc d
ICommandHandler
ÇÇ 
<
ÇÇ "
SetAdjustmentCommand
ÇÇ ,
,
ÇÇ, -!
SetAdjustmentResult
ÇÇ. A
>
ÇÇA B"
setAdjustmentHandler
ÇÇC W
,
ÇÇW X
NavigationService
ÈÈ 
navigationService
ÈÈ +
,
ÈÈ+ ,
IPrintingService
ÉÉ 
printingService
ÉÉ (
,
ÉÉ( )
IUserService
ÊÊ 
userService
ÊÊ  
,
ÊÊ  !
ITerminalContext
ËË 
terminalContext
ËË (
,
ËË( )
ICommandHandler
ÌÌ 
<
ÌÌ 
ChangeSeatCommand
ÌÌ )
>
ÌÌ) *
changeSeatHandler
ÌÌ+ <
,
ÌÌ< =
ICommandHandler
ÍÍ 
<
ÍÍ !
MergeTicketsCommand
ÍÍ +
>
ÍÍ+ ,!
mergeTicketsHandler
ÍÍ- @
,
ÍÍ@ A
ICommandHandler
ÎÎ 
<
ÎÎ  
ChangeTableCommand
ÎÎ *
,
ÎÎ* +
ChangeTableResult
ÎÎ, =
>
ÎÎ= > 
changeTableHandler
ÎÎ? Q
,
ÎÎQ R
ICommandHandler
ÏÏ 
<
ÏÏ  
SetCustomerCommand
ÏÏ *
,
ÏÏ* +
SetCustomerResult
ÏÏ, =
>
ÏÏ= > 
setCustomerHandler
ÏÏ? Q
,
ÏÏQ R
IServiceProvider
ÐÐ 
serviceProvider
ÐÐ (
,
ÐÐ( )$
IKitchenRoutingService
ÑÑ #
kitchenRoutingService
ÑÑ 4
,
ÑÑ4 5
Services
ÒÒ 
.
ÒÒ &
IOrderEntryDialogService
ÒÒ )%
orderEntryDialogService
ÒÒ* A
)
ÒÒA B
{
ÓÓ !
_categoryRepository
ÔÔ 
=
ÔÔ  
categoryRepository
ÔÔ 0
;
ÔÔ0 1
_groupRepository
ÕÕ 
=
ÕÕ 
groupRepository
ÕÕ *
;
ÕÕ* +
_menuRepository
ÖÖ 
=
ÖÖ 
menuRepository
ÖÖ (
;
ÖÖ( )
_getTicketHandler
×× 
=
×× 
getTicketHandler
×× ,
;
××, -"
_createTicketHandler
ØØ 
=
ØØ !
createTicketHandler
ØØ 2
;
ØØ2 3"
_addOrderLineHandler
ÙÙ 
=
ÙÙ !
addOrderLineHandler
ÙÙ 2
;
ÙÙ2 3$
_printToKitchenHandler
ÚÚ 
=
ÚÚ  #
printToKitchenHandler
ÚÚ! 6
;
ÚÚ6 7%
_modifyOrderLineHandler
ÛÛ 
=
ÛÛ  !$
modifyOrderLineHandler
ÛÛ" 8
;
ÛÛ8 9%
_removeOrderLineHandler
ÜÜ 
=
ÜÜ  !$
removeOrderLineHandler
ÜÜ" 8
;
ÜÜ8 9
_payNowHandler
ÝÝ 
=
ÝÝ 
payNowHandler
ÝÝ &
;
ÝÝ& '&
_setServiceChargeHandler
ÞÞ  
=
ÞÞ! "%
setServiceChargeHandler
ÞÞ# :
;
ÞÞ: ;'
_setDeliveryChargeHandler
ßß !
=
ßß" #&
setDeliveryChargeHandler
ßß$ <
;
ßß< =#
_setAdjustmentHandler
àà 
=
àà "
setAdjustmentHandler
àà  4
;
àà4 5 
_navigationService
áá 
=
áá 
navigationService
áá .
;
áá. /
_printingService
ââ 
=
ââ 
printingService
ââ *
;
ââ* +
_userService
ãã 
=
ãã 
userService
ãã "
;
ãã" #
_terminalContext
ää 
=
ää 
terminalContext
ää *
;
ää* + 
_changeSeatHandler
åå 
=
åå 
changeSeatHandler
åå .
;
åå. /"
_mergeTicketsHandler
ææ 
=
ææ !
mergeTicketsHandler
ææ 2
;
ææ2 3!
_changeTableHandler
çç 
=
çç  
changeTableHandler
çç 0
;
çç0 1!
_setCustomerHandler
èè 
=
èè  
setCustomerHandler
èè 0
;
èè0 1
_serviceProvider
éé 
=
éé 
serviceProvider
éé *
;
éé* +$
_kitchenRoutingService
êê 
=
êê  #
kitchenRoutingService
êê! 6
;
êê6 7&
_orderEntryDialogService
ëë  
=
ëë! "%
orderEntryDialogService
ëë# :
;
ëë: ;
Title
íí 
=
íí 
$str
íí 
;
íí #
SelectCategoryCommand
ïï 
=
ïï 
new
ïï  #
RelayCommand
ïï$ 0
<
ïï0 1
MenuCategory
ïï1 =
>
ïï= >
(
ïï> ?
c
ïï? @
=>
ïïA C
SelectedCategory
ïïD T
=
ïïU V
c
ïïW X
)
ïïX Y
;
ïïY Z 
SelectGroupCommand
ðð 
=
ðð 
new
ðð  
RelayCommand
ðð! -
<
ðð- .
	MenuGroup
ðð. 7
>
ðð7 8
(
ðð8 9
g
ðð9 :
=>
ðð; =
SelectedGroup
ðð> K
=
ððL M
g
ððN O
)
ððO P
;
ððP Q
AddItemCommand
ññ 
=
ññ 
new
ññ 
AsyncRelayCommand
ññ .
<
ññ. /
MenuItem
ññ/ 7
>
ññ7 8
(
ññ8 9
AddItemAsync
ññ9 E
)
ññE F
;
ññF G%
BackToCategoriesCommand
òò 
=
òò  !
new
òò" %
RelayCommand
òò& 2
(
òò2 3
(
òò3 4
)
òò4 5
=>
òò6 8
SelectedCategory
òò9 I
=
òòJ K
null
òòL P
)
òòP Q
;
òòQ R
SearchItemCommand
óó 
=
óó 
new
óó 
AsyncRelayCommand
óó  1
(
óó1 2
SearchItemAsync
óó2 A
)
óóA B
;
óóB C&
IncrementQuantityCommand
õõ  
=
õõ! "
new
õõ# &
AsyncRelayCommand
õõ' 8
<
õõ8 9
OrderLineDto
õõ9 E
>
õõE F
(
õõF G$
IncrementQuantityAsync
õõG ]
)
õõ] ^
;
õõ^ _&
DecrementQuantityCommand
öö  
=
öö! "
new
öö# &
AsyncRelayCommand
öö' 8
<
öö8 9
OrderLineDto
öö9 E
>
ööE F
(
ööF G$
DecrementQuantityAsync
ööG ]
)
öö] ^
;
öö^ _
RemoveItemCommand
÷÷ 
=
÷÷ 
new
÷÷ 
AsyncRelayCommand
÷÷  1
<
÷÷1 2
OrderLineDto
÷÷2 >
>
÷÷> ?
(
÷÷? @
RemoveItemAsync
÷÷@ O
)
÷÷O P
;
÷÷P Q 
SetQuantityCommand
øø 
=
øø 
new
øø  
AsyncRelayCommand
øø! 2
(
øø2 3
SetQuantityAsync
øø3 C
)
øøC D
;
øøD E 
PrintTicketCommand
úú 
=
úú 
new
úú  
AsyncRelayCommand
úú! 2
(
úú2 3
PrintTicketAsync
úú3 C
)
úúC D
;
úúD E 
AddMiscItemCommand
ûû 
=
ûû 
new
ûû  
AsyncRelayCommand
ûû! 2
(
ûû2 3
AddMiscItemAsync
ûû3 C
)
ûûC D
;
ûûD E
AddFeeCommand
üü 
=
üü 
new
üü 
AsyncRelayCommand
üü -
(
üü- .
AddFeeAsync
üü. 9
)
üü9 :
;
üü: ;*
AddCookingInstructionCommand
ýý $
=
ýý% &
new
ýý' *
AsyncRelayCommand
ýý+ <
<
ýý< =
OrderLineDto
ýý= I
>
ýýI J
(
ýýJ K(
AddCookingInstructionAsync
ýýK e
)
ýýe f
;
ýýf g&
AddPizzaModifiersCommand
þþ  
=
þþ! "
new
þþ# &
AsyncRelayCommand
þþ' 8
<
þþ8 9
OrderLineDto
þþ9 E
>
þþE F
(
þþF G$
AddPizzaModifiersAsync
þþG ]
)
þþ] ^
;
þþ^ _
ChangeSeatCommand
ÿÿ 
=
ÿÿ 
new
ÿÿ 
AsyncRelayCommand
ÿÿ  1
<
ÿÿ1 2
OrderLineDto
ÿÿ2 >
>
ÿÿ> ?
(
ÿÿ? @
ChangeSeatAsync
ÿÿ@ O
)
ÿÿO P
;
ÿÿP Q!
MergeTicketsCommand
€€ 
=
€€ 
new
€€ !
AsyncRelayCommand
€€" 3
(
€€3 4
MergeTicketsAsync
€€4 E
)
€€E F
;
€€F G 
ChangeTableCommand
 
=
 
new
  
AsyncRelayCommand
! 2
(
2 3
ChangeTableAsync
3 C
)
C D
;
D E#
AssignCustomerCommand
‚‚ 
=
‚‚ 
new
‚‚  #
AsyncRelayCommand
‚‚$ 5
(
‚‚5 6!
AssignCustomerAsync
‚‚6 I
)
‚‚I J
;
‚‚J K
SettleCommand
ƒƒ 
=
ƒƒ 
new
ƒƒ 
AsyncRelayCommand
ƒƒ -
(
ƒƒ- .
SettleAsync
ƒƒ. 9
)
ƒƒ9 :
;
ƒƒ: ;
QuickPayCommand
„„ 
=
„„ 
new
„„ 
AsyncRelayCommand
„„ /
(
„„/ 0
QuickPayAsync
„„0 =
)
„„= >
;
„„> ?
EditNoteCommand
…… 
=
…… 
new
…… 
AsyncRelayCommand
…… /
<
……/ 0
OrderLineDto
……0 <
>
……< =
(
……= >
EditNoteAsync
……> K
)
……K L
;
……L M
}
†† 
public
ˆˆ 

ICommand
ˆˆ 
EditNoteCommand
ˆˆ #
{
ˆˆ$ %
get
ˆˆ& )
;
ˆˆ) *
}
ˆˆ+ ,
private
ŠŠ 
async
ŠŠ 
Task
ŠŠ 
EditNoteAsync
ŠŠ $
(
ŠŠ$ %
OrderLineDto
ŠŠ% 1
?
ŠŠ1 2
line
ŠŠ3 7
)
ŠŠ7 8
{
‹‹ 
if
ŒŒ 

(
ŒŒ 
Ticket
ŒŒ 
==
ŒŒ 
null
ŒŒ 
)
ŒŒ 
return
ŒŒ "
;
ŒŒ" #
var
ŽŽ 
vm
ŽŽ 
=
ŽŽ 
_serviceProvider
ŽŽ !
.
ŽŽ! " 
GetRequiredService
ŽŽ" 4
<
ŽŽ4 5
Magidesk
ŽŽ5 =
.
ŽŽ= >
Presentation
ŽŽ> J
.
ŽŽJ K

ViewModels
ŽŽK U
.
ŽŽU V
Dialogs
ŽŽV ]
.
ŽŽ] ^"
NotesDialogViewModel
ŽŽ^ r
>
ŽŽr s
(
ŽŽs t
)
ŽŽt u
;
ŽŽu v
if
 

(
 
line
 
!=
 
null
 
)
 
{
‘‘ 	
vm
’’ 
.
’’ $
InitializeForOrderLine
’’ %
(
’’% &
Ticket
’’& ,
.
’’, -
Id
’’- /
,
’’/ 0
line
’’1 5
.
’’5 6
Id
’’6 8
,
’’8 9
line
’’: >
.
’’> ?
Instructions
’’? K
)
’’K L
;
’’L M
}
““ 	
else
”” 
{
•• 	
vm
–– 
.
–– !
InitializeForTicket
–– "
(
––" #
Ticket
––# )
.
––) *
Id
––* ,
,
––, -
Ticket
––. 4
.
––4 5
Note
––5 9
)
––9 :
;
––: ;
}
—— 	
var
™™ 
dialog
™™ 
=
™™ 
new
™™ 
Magidesk
™™ !
.
™™! "
Presentation
™™" .
.
™™. /
Views
™™/ 4
.
™™4 5
Dialogs
™™5 <
.
™™< =
NotesDialog
™™= H
(
™™H I
vm
™™I K
)
™™K L
;
™™L M
dialog
šš 
.
šš 
XamlRoot
šš 
=
šš 
App
šš 
.
šš  
MainWindowInstance
šš 0
.
šš0 1
Content
šš1 8
.
šš8 9
XamlRoot
šš9 A
;
ššA B
await
œœ 
dialog
œœ 
.
œœ 
	ShowAsync
œœ 
(
œœ 
)
œœ  
;
œœ  !
await
ŸŸ 
LoadTicketAsync
ŸŸ 
(
ŸŸ 
Ticket
ŸŸ $
.
ŸŸ$ %
Id
ŸŸ% '
)
ŸŸ' (
;
ŸŸ( )
}
   
public
¤¤ 

ICommand
¤¤  
AddMiscItemCommand
¤¤ &
{
¤¤' (
get
¤¤) ,
;
¤¤, -
}
¤¤. /
public
¥¥ 

ICommand
¥¥ 
AddFeeCommand
¥¥ !
{
¥¥" #
get
¥¥$ '
;
¥¥' (
}
¥¥) *
public
¨¨ 

ICommand
¨¨ *
AddCookingInstructionCommand
¨¨ 0
{
¨¨1 2
get
¨¨3 6
;
¨¨6 7
}
¨¨8 9
public
©© 

ICommand
©© 
ChangeSeatCommand
©© %
{
©©& '
get
©©( +
;
©©+ ,
}
©©- .
public
ªª 

ICommand
ªª !
MergeTicketsCommand
ªª '
{
ªª( )
get
ªª* -
;
ªª- .
}
ªª/ 0
public
«« 

ICommand
««  
ChangeTableCommand
«« &
{
««' (
get
««) ,
;
««, -
}
««. /
public
¬¬ 

ICommand
¬¬ #
AssignCustomerCommand
¬¬ )
{
¬¬* +
get
¬¬, /
;
¬¬/ 0
}
¬¬1 2
private
°° 
async
°° 
Task
°° 
MergeTicketsAsync
°° (
(
°°( )
)
°°) *
{
±± 
if
²² 

(
²² 
Ticket
²² 
==
²² 
null
²² 
)
²² 
return
²² "
;
²²" #
try
¹¹ 
{
ºº 	
var
»» 
queryHandler
»» 
=
»» 
_serviceProvider
»»  0
.
»»0 1 
GetRequiredService
»»1 C
<
»»C D
IQueryHandler
»»D Q
<
»»Q R!
GetOpenTicketsQuery
»»R e
,
»»e f
IEnumerable
»»g r
<
»»r s
	TicketDto
»»s |
>
»»| }
>
»»} ~
>
»»~ 
(»» €
)»»€ 
;»» ‚
var
¼¼ 
vm
¼¼ 
=
¼¼ 
new
¼¼ 
Magidesk
¼¼ "
.
¼¼" #
Presentation
¼¼# /
.
¼¼/ 0

ViewModels
¼¼0 :
.
¼¼: ;
Dialogs
¼¼; B
.
¼¼B C#
MergeTicketsViewModel
¼¼C X
(
¼¼X Y
queryHandler
¼¼Y e
,
¼¼e f
Ticket
¼¼g m
.
¼¼m n
Id
¼¼n p
)
¼¼p q
;
¼¼q r
var
¾¾ 
dialog
¾¾ 
=
¾¾ 
new
¾¾ 
Magidesk
¾¾ &
.
¾¾& '
Views
¾¾' ,
.
¾¾, -
Dialogs
¾¾- 4
.
¾¾4 5 
MergeTicketsDialog
¾¾5 G
{
¾¾H I
	ViewModel
¾¾J S
=
¾¾T U
vm
¾¾V X
}
¾¾Y Z
;
¾¾Z [
dialog
¿¿ 
.
¿¿ 
XamlRoot
¿¿ 
=
¿¿ 
App
¿¿ "
.
¿¿" # 
MainWindowInstance
¿¿# 5
.
¿¿5 6
Content
¿¿6 =
.
¿¿= >
XamlRoot
¿¿> F
;
¿¿F G
vm
ÁÁ 
.
ÁÁ 
CloseAction
ÁÁ 
=
ÁÁ 
(
ÁÁ 
)
ÁÁ  
=>
ÁÁ! #
dialog
ÁÁ$ *
.
ÁÁ* +
Hide
ÁÁ+ /
(
ÁÁ/ 0
)
ÁÁ0 1
;
ÁÁ1 2
await
ÃÃ 
dialog
ÃÃ 
.
ÃÃ 
	ShowAsync
ÃÃ #
(
ÃÃ# $
)
ÃÃ$ %
;
ÃÃ% &
if
ÅÅ 
(
ÅÅ 
vm
ÅÅ 
.
ÅÅ 
IsConfirmed
ÅÅ 
&&
ÅÅ  "
vm
ÅÅ# %
.
ÅÅ% &"
SelectedTargetTicket
ÅÅ& :
!=
ÅÅ; =
null
ÅÅ> B
)
ÅÅB C
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
_userService
ÇÇ !
.
ÇÇ! "
CurrentUser
ÇÇ" -
?
ÇÇ- .
.
ÇÇ. /
Id
ÇÇ/ 1
==
ÇÇ2 4
null
ÇÇ5 9
)
ÇÇ9 :
return
ÇÇ; A
;
ÇÇA B
await
ÉÉ "
_mergeTicketsHandler
ÉÉ +
.
ÉÉ+ ,
HandleAsync
ÉÉ, 7
(
ÉÉ7 8
new
ÉÉ8 ;!
MergeTicketsCommand
ÉÉ< O
{
ÊÊ 
SourceTicketId
ËË #
=
ËË$ %
Ticket
ËË& ,
.
ËË, -
Id
ËË- /
,
ËË/ 0
TargetTicketId
ÌÌ #
=
ÌÌ$ %
vm
ÌÌ& (
.
ÌÌ( )"
SelectedTargetTicket
ÌÌ) =
.
ÌÌ= >
Id
ÌÌ> @
,
ÌÌ@ A
ProcessedBy
ÍÍ  
=
ÍÍ! "
_userService
ÍÍ# /
.
ÍÍ/ 0
CurrentUser
ÍÍ0 ;
.
ÍÍ; <
Id
ÍÍ< >
}
ÎÎ 
)
ÎÎ 
;
ÎÎ  
_navigationService
ÑÑ #
.
ÑÑ# $
GoBack
ÑÑ$ *
(
ÑÑ* +
)
ÑÑ+ ,
;
ÑÑ, -
}
ÒÒ 
}
ÓÓ 	
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ 
{
ÕÕ 	
var
ÖÖ 
errorDialog
ÖÖ 
=
ÖÖ 
new
ÖÖ "
	Microsoft
ÖÖ# ,
.
ÖÖ, -
UI
ÖÖ- /
.
ÖÖ/ 0
Xaml
ÖÖ0 4
.
ÖÖ4 5
Controls
ÖÖ5 =
.
ÖÖ= >
ContentDialog
ÖÖ> K
{
×× 
Title
ØØ 
=
ØØ 
$str
ØØ &
,
ØØ& '
Content
ÙÙ 
=
ÙÙ 
ex
ÙÙ 
.
ÙÙ 
Message
ÙÙ %
,
ÙÙ% &
CloseButtonText
ÚÚ  
=
ÚÚ! "
$str
ÚÚ# '
,
ÚÚ' (
XamlRoot
ÛÛ 
=
ÛÛ 
App
ÛÛ 
.
ÛÛ   
MainWindowInstance
ÛÛ  2
.
ÛÛ2 3
Content
ÛÛ3 :
.
ÛÛ: ;
XamlRoot
ÛÛ; C
}
ÜÜ 
;
ÜÜ 
await
ÝÝ  
_navigationService
ÝÝ %
.
ÝÝ% &
ShowDialogAsync
ÝÝ& 5
(
ÝÝ5 6
errorDialog
ÝÝ6 A
)
ÝÝA B
;
ÝÝB C
}
ÞÞ 	
}
ßß 	
private
ââ 
async
ââ 
Task
ââ !
AssignCustomerAsync
ââ *
(
ââ* +
)
ââ+ ,
{
ãã 
if
ää 

(
ää 
Ticket
ää 
==
ää 
null
ää 
)
ää 
return
ää "
;
ää" #
var
çç 
dialog
çç 
=
çç 
new
çç 
Magidesk
çç !
.
çç! "
Views
çç" '
.
çç' (
Dialogs
çç( /
.
çç/ 0%
CustomerSelectionDialog
çç0 G
(
ççG H
)
ççH I
;
ççI J
dialog
èè 
.
èè 
XamlRoot
èè 
=
èè 
App
èè 
.
èè  
MainWindowInstance
èè 0
.
èè0 1
Content
èè1 8
.
èè8 9
XamlRoot
èè9 A
;
èèA B
var
ëë 
result
ëë 
=
ëë 
await
ëë 
dialog
ëë !
.
ëë! "
	ShowAsync
ëë" +
(
ëë+ ,
)
ëë, -
;
ëë- .
if
íí 

(
íí 
result
íí 
==
íí !
ContentDialogResult
íí )
.
íí) *
Primary
íí* 1
&&
íí2 4
dialog
íí5 ;
.
íí; <
	ViewModel
íí< E
.
ííE F
IsConfirmed
ííF Q
)
ííQ R
{
îî 	
if
ïï 
(
ïï 
_userService
ïï 
.
ïï 
CurrentUser
ïï )
?
ïï) *
.
ïï* +
Id
ïï+ -
==
ïï. 0
null
ïï1 5
)
ïï5 6
return
ïï7 =
;
ïï= >
var
ññ 
cmd
ññ 
=
ññ 
new
ññ  
SetCustomerCommand
ññ -
{
òò 
TicketId
óó 
=
óó 
Ticket
óó "
.
óó" #
Id
óó# %
,
óó% &
	GuestName
ôô 
=
ôô 
dialog
ôô #
.
ôô# $
	ViewModel
ôô$ -
.
ôô- .
	GuestName
ôô. 7
,
ôô7 8
PhoneNumber
õõ 
=
õõ 
dialog
õõ %
.
õõ% &
	ViewModel
õõ& /
.
õõ/ 0
PhoneNumber
õõ0 ;
,
õõ; <

ModifiedBy
öö 
=
öö 
_userService
öö *
.
öö* +
CurrentUser
öö+ 6
.
öö6 7
Id
öö7 9
}
÷÷ 
;
÷÷ 
var
ùù 
outcome
ùù 
=
ùù 
await
ùù  !
_setCustomerHandler
ùù! 4
.
ùù4 5
HandleAsync
ùù5 @
(
ùù@ A
cmd
ùùA D
)
ùùD E
;
ùùE F
if
ûû 
(
ûû 
outcome
ûû 
.
ûû 
Success
ûû  
)
ûû  !
{
üü 
await
ýý 
LoadTicketAsync
ýý &
(
ýý& '
Ticket
ýý' -
.
ýý- .
Id
ýý. 0
)
ýý0 1
;
ýý1 2
}
þþ 
else
ÿÿ 
{
€€ 
System
‚‚ 
.
‚‚ 
Diagnostics
‚‚ #
.
‚‚# $
Debug
‚‚$ )
.
‚‚) *
	WriteLine
‚‚* 3
(
‚‚3 4
$"
‚‚4 6
$str
‚‚6 P
{
‚‚P Q
outcome
‚‚Q X
.
‚‚X Y
ErrorMessage
‚‚Y e
}
‚‚e f
"
‚‚f g
)
‚‚g h
;
‚‚h i
}
ƒƒ 
}
„„ 	
}
…… 
private
‡‡ 
async
‡‡ 
Task
‡‡ 
ChangeTableAsync
‡‡ '
(
‡‡' (
)
‡‡( )
{
ˆˆ 
if
‰‰ 

(
‰‰ 
Ticket
‰‰ 
==
‰‰ 
null
‰‰ 
)
‰‰ 
return
‰‰ "
;
‰‰" #
var
 
vm
 
=
 
_serviceProvider
 !
.
! " 
GetRequiredService
" 4
<
4 5
Magidesk
5 =
.
= >
Presentation
> J
.
J K

ViewModels
K U
.
U V
Dialogs
V ]
.
] ^%
TableSelectionViewModel
^ u
>
u v
(
v w
)
w x
;
x y
await
ŽŽ 
vm
ŽŽ 
.
ŽŽ 
InitializeAsync
ŽŽ  
(
ŽŽ  !
)
ŽŽ! "
;
ŽŽ" #
var
 
dialog
 
=
 
new
 
Magidesk
 !
.
! "
Views
" '
.
' (
Dialogs
( /
.
/ 0"
TableSelectionDialog
0 D
{
E F
	ViewModel
G P
=
Q R
vm
S U
}
V W
;
W X
dialog
‘‘ 
.
‘‘ 
XamlRoot
‘‘ 
=
‘‘ 
App
‘‘ 
.
‘‘  
MainWindowInstance
‘‘ 0
.
‘‘0 1
Content
‘‘1 8
.
‘‘8 9
XamlRoot
‘‘9 A
;
‘‘A B
vm
““ 

.
““
 
CloseAction
““ 
=
““ 
(
““ 
)
““ 
=>
““ 
dialog
““ %
.
““% &
Hide
““& *
(
““* +
)
““+ ,
;
““, -
await
•• 
dialog
•• 
.
•• 
	ShowAsync
•• 
(
•• 
)
••  
;
••  !
if
—— 

(
—— 
vm
—— 
.
—— 
IsConfirmed
—— 
&&
—— 
vm
——  
.
——  !
SelectedTable
——! .
!=
——/ 1
null
——2 6
)
——6 7
{
˜˜ 	
if
™™ 
(
™™ 
_userService
™™ 
.
™™ 
CurrentUser
™™ (
?
™™( )
.
™™) *
Id
™™* ,
==
™™- /
null
™™0 4
)
™™4 5
return
™™6 <
;
™™< =
var
›› 
result
›› 
=
›› 
await
›› !
_changeTableHandler
›› 2
.
››2 3
HandleAsync
››3 >
(
››> ?
new
››? B 
ChangeTableCommand
››C U
{
œœ 
TicketId
 
=
 
Ticket
 !
.
! "
Id
" $
,
$ %

NewTableId
žž 
=
žž 
vm
žž 
.
žž  
SelectedTable
žž  -
.
žž- .
Id
žž. 0
,
žž0 1
UserId
ŸŸ 
=
ŸŸ 
_userService
ŸŸ %
.
ŸŸ% &
CurrentUser
ŸŸ& 1
.
ŸŸ1 2
Id
ŸŸ2 4
}
   
)
   
;
   
if
¢¢ 
(
¢¢ 
result
¢¢ 
.
¢¢ 
Success
¢¢ 
)
¢¢ 
{
££ 
await
¤¤ 
LoadTicketAsync
¤¤ %
(
¤¤% &
Ticket
¤¤& ,
.
¤¤, -
Id
¤¤- /
)
¤¤/ 0
;
¤¤0 1
}
¥¥ 
else
¦¦ 
{
§§ 
var
¨¨ 
errorDialog
¨¨  
=
¨¨! "
new
¨¨# &
ContentDialog
¨¨' 4
{
©© 
Title
ªª 
=
ªª 
$str
ªª 1
,
ªª1 2
Content
«« 
=
«« 
result
«« %
.
««% &
ErrorMessage
««& 2
,
««2 3
CloseButtonText
¬¬ $
=
¬¬% &
$str
¬¬' +
,
¬¬+ ,
XamlRoot
­­ 
=
­­ 
App
­­  #
.
­­# $ 
MainWindowInstance
­­$ 6
.
­­6 7
Content
­­7 >
.
­­> ?
XamlRoot
­­? G
}
®® 
;
®® 
await
¯¯  
_navigationService
¯¯ )
.
¯¯) *
ShowDialogAsync
¯¯* 9
(
¯¯9 :
errorDialog
¯¯: E
)
¯¯E F
;
¯¯F G
}
°° 
}
±± 	
}
²² 
private
´´ 
async
´´ 
Task
´´ (
AddCookingInstructionAsync
´´ 1
(
´´1 2
OrderLineDto
´´2 >
?
´´> ?
line
´´@ D
)
´´D E
{
µµ 
if
¶¶ 

(
¶¶ 
line
¶¶ 
==
¶¶ 
null
¶¶ 
||
¶¶ 
Ticket
¶¶ "
==
¶¶# %
null
¶¶& *
)
¶¶* +
return
¶¶, 2
;
¶¶2 3
var
¹¹ 
vm
¹¹ 
=
¹¹ 
new
¹¹ 
Magidesk
¹¹ 
.
¹¹ 
Presentation
¹¹ *
.
¹¹* +

ViewModels
¹¹+ 5
.
¹¹5 6
Dialogs
¹¹6 =
.
¹¹= >)
CookingInstructionViewModel
¹¹> Y
(
¹¹Y Z
line
¹¹Z ^
.
¹¹^ _
Instructions
¹¹_ k
??
¹¹l n
$str
¹¹o q
)
¹¹q r
;
¹¹r s
await
»» &
_orderEntryDialogService
»» &
.
»»& ')
ShowCookingInstructionAsync
»»' B
(
»»B C
vm
»»C E
)
»»E F
;
»»F G
if
½½ 

(
½½ 
vm
½½ 
.
½½ 
IsConfirmed
½½ 
)
½½ 
{
¾¾ 	
await
¿¿ %
_modifyOrderLineHandler
¿¿ )
.
¿¿) *
HandleAsync
¿¿* 5
(
¿¿5 6
new
¿¿6 9$
ModifyOrderLineCommand
¿¿: P
{
ÀÀ 
TicketId
ÁÁ 
=
ÁÁ 
Ticket
ÁÁ !
.
ÁÁ! "
Id
ÁÁ" $
,
ÁÁ$ %
OrderLineId
ÂÂ 
=
ÂÂ 
line
ÂÂ "
.
ÂÂ" #
Id
ÂÂ# %
,
ÂÂ% &
Quantity
ÃÃ 
=
ÃÃ 
line
ÃÃ 
.
ÃÃ  
Quantity
ÃÃ  (
,
ÃÃ( )
Instructions
ÄÄ 
=
ÄÄ 
vm
ÄÄ !
.
ÄÄ! ""
SelectedInstructions
ÄÄ" 6
}
ÅÅ 
)
ÅÅ 
;
ÅÅ 
await
ÆÆ 
LoadTicketAsync
ÆÆ !
(
ÆÆ! "
Ticket
ÆÆ" (
.
ÆÆ( )
Id
ÆÆ) +
)
ÆÆ+ ,
;
ÆÆ, -
}
ÇÇ 	
}
ÈÈ 
[
ÊÊ 
RelayCommand
ÊÊ 
]
ÊÊ 
private
ËË 
async
ËË 
Task
ËË  
EditModifiersAsync
ËË )
(
ËË) *
OrderLineDto
ËË* 6
?
ËË6 7
line
ËË8 <
)
ËË< =
{
ÌÌ 
if
ÍÍ 

(
ÍÍ 
line
ÍÍ 
==
ÍÍ 
null
ÍÍ 
||
ÍÍ 
Ticket
ÍÍ "
==
ÍÍ# %
null
ÍÍ& *
)
ÍÍ* +
return
ÍÍ, 2
;
ÍÍ2 3
var
ÐÐ 
isPizza
ÐÐ 
=
ÐÐ 
await
ÐÐ 
IsPizza
ÐÐ #
(
ÐÐ# $
line
ÐÐ$ (
)
ÐÐ( )
;
ÐÐ) *
if
ÑÑ 

(
ÑÑ 
isPizza
ÑÑ 
)
ÑÑ 
{
ÒÒ 	
await
ÓÓ $
AddPizzaModifiersAsync
ÓÓ (
(
ÓÓ( )
line
ÓÓ) -
)
ÓÓ- .
;
ÓÓ. /
return
ÔÔ 
;
ÔÔ 
}
ÕÕ 	
var
ØØ 
vm
ØØ 
=
ØØ 
new
ØØ 
Magidesk
ØØ 
.
ØØ 

ViewModels
ØØ (
.
ØØ( )
Dialogs
ØØ) 0
.
ØØ0 1(
ModifierSelectionViewModel
ØØ1 K
(
ØØK L
_menuRepository
ØØL [
,
ØØ[ \
line
ØØ] a
)
ØØa b
;
ØØb c
await
ÚÚ &
_orderEntryDialogService
ÚÚ &
.
ÚÚ& '(
ShowModifierSelectionAsync
ÚÚ' A
(
ÚÚA B
vm
ÚÚB D
)
ÚÚD E
;
ÚÚE F
if
ÜÜ 

(
ÜÜ 
vm
ÜÜ 
.
ÜÜ 
IsConfirmed
ÜÜ 
)
ÜÜ 
{
ÝÝ 	
await
ÞÞ %
_modifyOrderLineHandler
ÞÞ )
.
ÞÞ) *
HandleAsync
ÞÞ* 5
(
ÞÞ5 6
new
ÞÞ6 9$
ModifyOrderLineCommand
ÞÞ: P
{
ßß 
OrderLineId
àà 
=
àà 
line
àà "
.
àà" #
Id
àà# %
,
àà% &
TicketId
áá 
=
áá 
Ticket
áá !
.
áá! "
Id
áá" $
,
áá$ %
	Modifiers
ââ 
=
ââ 
vm
ââ 
.
ââ 
ResultModifiers
ââ .
,
ââ. /
Quantity
ãã 
=
ãã 
line
ãã 
.
ãã  
Quantity
ãã  (
,
ãã( )
Instructions
ää 
=
ää 
line
ää #
.
ää# $
Instructions
ää$ 0
}
åå 
)
åå 
;
åå 
await
çç 
LoadTicketAsync
çç !
(
çç! "
Ticket
çç" (
.
çç( )
Id
çç) +
)
çç+ ,
;
çç, -
}
èè 	
}
éé 
[
ëë 
RelayCommand
ëë 
]
ëë 
private
ìì 
async
ìì 
Task
ìì !
AddOnSelectionAsync
ìì *
(
ìì* +
OrderLineDto
ìì+ 7
?
ìì7 8
line
ìì9 =
)
ìì= >
{
íí 
if
îî 

(
îî 
line
îî 
==
îî 
null
îî 
||
îî 
Ticket
îî "
==
îî# %
null
îî& *
)
îî* +
return
îî, 2
;
îî2 3
var
ññ 
vm
ññ 
=
ññ 
new
ññ 
Magidesk
ññ 
.
ññ 

ViewModels
ññ (
.
ññ( )
Dialogs
ññ) 0
.
ññ0 1%
AddOnSelectionViewModel
ññ1 H
(
ññH I
_menuRepository
ññI X
,
ññX Y
line
ññZ ^
)
ññ^ _
;
ññ_ `
await
óó &
_orderEntryDialogService
óó &
.
óó& '%
ShowAddOnSelectionAsync
óó' >
(
óó> ?
vm
óó? A
)
óóA B
;
óóB C
if
õõ 

(
õõ 
vm
õõ 
.
õõ 
IsConfirmed
õõ 
&&
õõ 
vm
õõ  
.
õõ  !
ResultAddOns
õõ! -
.
õõ- .
Any
õõ. 1
(
õõ1 2
)
õõ2 3
)
õõ3 4
{
öö 	
foreach
øø 
(
øø 
var
øø 
addOn
øø 
in
øø !
vm
øø" $
.
øø$ %
ResultAddOns
øø% 1
)
øø1 2
{
ùù 
if
úú 
(
úú 
addOn
úú 
.
úú 

ModifierId
úú $
.
úú$ %
HasValue
úú% -
)
úú- .
{
ûû 
await
üü "
_addOrderLineHandler
üü .
.
üü. /
HandleAsync
üü/ :
(
üü: ;
new
üü; >!
AddOrderLineCommand
üü? R
{
ýý 
TicketId
þþ  
=
þþ! "
Ticket
þþ# )
.
þþ) *
Id
þþ* ,
,
þþ, -

MenuItemId
ÿÿ "
=
ÿÿ# $
addOn
ÿÿ% *
.
ÿÿ* +

ModifierId
ÿÿ+ 5
.
ÿÿ5 6
Value
ÿÿ6 ;
,
ÿÿ; <
MenuItemName
€€ $
=
€€% &
addOn
€€' ,
.
€€, -
Name
€€- 1
,
€€1 2
Quantity
  
=
! "
$num
# $
,
$ %
	UnitPrice
‚‚ !
=
‚‚" #
new
‚‚$ '
Magidesk
‚‚( 0
.
‚‚0 1
Domain
‚‚1 7
.
‚‚7 8
ValueObjects
‚‚8 D
.
‚‚D E
Money
‚‚E J
(
‚‚J K
addOn
‚‚K P
.
‚‚P Q
	UnitPrice
‚‚Q Z
)
‚‚Z [
,
‚‚[ \
TaxRate
ƒƒ 
=
ƒƒ  !
addOn
ƒƒ" '
.
ƒƒ' (
TaxRate
ƒƒ( /
,
ƒƒ/ 0
	Modifiers
„„ !
=
„„" #
new
„„$ '
List
„„( ,
<
„„, -
Magidesk
„„- 5
.
„„5 6
Domain
„„6 <
.
„„< =
Entities
„„= E
.
„„E F
MenuModifier
„„F R
>
„„R S
(
„„S T
)
„„T U
,
„„U V
CategoryName
…… $
=
……% &
$str
……' /
,
……/ 0
	GroupName
†† !
=
††" #
$str
††$ ,
}
‡‡ 
)
‡‡ 
;
‡‡ 
}
ˆˆ 
}
‰‰ 
await
‹‹ 
LoadTicketAsync
‹‹ !
(
‹‹! "
Ticket
‹‹" (
.
‹‹( )
Id
‹‹) +
)
‹‹+ ,
;
‹‹, -
}
ŒŒ 	
}
 
[
 
RelayCommand
 
]
 
private
 
async
 
Task
 !
ComboSelectionAsync
 *
(
* +
OrderLineDto
+ 7
?
7 8
line
9 =
)
= >
{
‘‘ 
if
’’ 

(
’’ 
line
’’ 
==
’’ 
null
’’ 
||
’’ 
Ticket
’’ "
==
’’# %
null
’’& *
)
’’* +
return
’’, 2
;
’’2 3
var
•• 
vm
•• 
=
•• 
new
•• 
Magidesk
•• 
.
•• 

ViewModels
•• (
.
••( )
Dialogs
••) 0
.
••0 1%
ComboSelectionViewModel
••1 H
(
••H I
_menuRepository
••I X
,
••X Y
line
••Z ^
)
••^ _
;
••_ `
await
—— &
_orderEntryDialogService
—— &
.
——& '%
ShowComboSelectionAsync
——' >
(
——> ?
vm
——? A
)
——A B
;
——B C
if
™™ 

(
™™ 
vm
™™ 
.
™™ 
IsConfirmed
™™ 
&&
™™ 
vm
™™  
.
™™  !
ResultSelections
™™! 1
.
™™1 2
Any
™™2 5
(
™™5 6
)
™™6 7
)
™™7 8
{
šš 	
foreach
 
(
 
var
 
	selection
 "
in
# %
vm
& (
.
( )
ResultSelections
) 9
)
9 :
{
žž 
await
ŸŸ "
_addOrderLineHandler
ŸŸ *
.
ŸŸ* +
HandleAsync
ŸŸ+ 6
(
ŸŸ6 7
new
ŸŸ7 :!
AddOrderLineCommand
ŸŸ; N
{
   
TicketId
¡¡ 
=
¡¡ 
Ticket
¡¡ %
.
¡¡% &
Id
¡¡& (
,
¡¡( )

MenuItemId
¢¢ 
=
¢¢  
	selection
¢¢! *
.
¢¢* +

MenuItemId
¢¢+ 5
,
¢¢5 6
MenuItemName
££  
=
££! "
	selection
££# ,
.
££, -
ItemName
££- 5
,
££5 6
Quantity
¤¤ 
=
¤¤ 
$num
¤¤  
,
¤¤  !
	UnitPrice
¥¥ 
=
¥¥ 
new
¥¥  #
Magidesk
¥¥$ ,
.
¥¥, -
Domain
¥¥- 3
.
¥¥3 4
ValueObjects
¥¥4 @
.
¥¥@ A
Money
¥¥A F
(
¥¥F G
	selection
¥¥G P
.
¥¥P Q
	BasePrice
¥¥Q Z
+
¥¥[ \
	selection
¥¥] f
.
¥¥f g
Upcharge
¥¥g o
)
¥¥o p
,
¥¥p q
TaxRate
¦¦ 
=
¦¦ 
$num
¦¦ 
,
¦¦  
	Modifiers
§§ 
=
§§ 
new
§§  #
List
§§$ (
<
§§( )
Magidesk
§§) 1
.
§§1 2
Domain
§§2 8
.
§§8 9
Entities
§§9 A
.
§§A B
MenuModifier
§§B N
>
§§N O
(
§§O P
)
§§P Q
,
§§Q R
CategoryName
¨¨  
=
¨¨! "
$str
¨¨# *
,
¨¨* +
	GroupName
©© 
=
©© 
	selection
©©  )
.
©©) *
	GroupName
©©* 3
}
ªª 
)
ªª 
;
ªª 
}
«« 
await
®® %
_removeOrderLineHandler
®® )
.
®®) *
HandleAsync
®®* 5
(
®®5 6
new
®®6 9$
RemoveOrderLineCommand
®®: P
{
¯¯ 
TicketId
°° 
=
°° 
Ticket
°° !
.
°°! "
Id
°°" $
,
°°$ %
OrderLineId
±± 
=
±± 
line
±± "
.
±±" #
Id
±±# %
}
²² 
)
²² 
;
²² 
await
´´ 
LoadTicketAsync
´´ !
(
´´! "
Ticket
´´" (
.
´´( )
Id
´´) +
)
´´+ ,
;
´´, -
}
µµ 	
}
¶¶ 
private
¸¸ 
async
¸¸ 
Task
¸¸ 
<
¸¸ 
bool
¸¸ 
>
¸¸ 
IsPizza
¸¸ $
(
¸¸$ %
OrderLineDto
¸¸% 1
line
¸¸2 6
)
¸¸6 7
{
¹¹ 
var
ºº 
item
ºº 
=
ºº 
await
ºº 
_menuRepository
ºº (
.
ºº( )
GetByIdAsync
ºº) 5
(
ºº5 6
line
ºº6 :
.
ºº: ;

MenuItemId
ºº; E
)
ººE F
;
ººF G
if
»» 

(
»» 
item
»» 
==
»» 
null
»» 
)
»» 
return
»»  
false
»»! &
;
»»& '
var
½½ 
category
½½ 
=
½½ 

Categories
½½ !
.
½½! "
FirstOrDefault
½½" 0
(
½½0 1
c
½½1 2
=>
½½3 5
c
½½6 7
.
½½7 8
Id
½½8 :
==
½½; =
item
½½> B
.
½½B C

CategoryId
½½C M
)
½½M N
;
½½N O
if
¾¾ 

(
¾¾ 
category
¾¾ 
?
¾¾ 
.
¾¾ 
Name
¾¾ 
.
¾¾ 
Contains
¾¾ #
(
¾¾# $
$str
¾¾$ +
,
¾¾+ ,
StringComparison
¾¾- =
.
¾¾= >
OrdinalIgnoreCase
¾¾> O
)
¾¾O P
==
¾¾Q S
true
¾¾T X
)
¾¾X Y
return
¾¾Z `
true
¾¾a e
;
¾¾e f
var
ÀÀ 
group
ÀÀ 
=
ÀÀ 
Groups
ÀÀ 
.
ÀÀ 
FirstOrDefault
ÀÀ )
(
ÀÀ) *
g
ÀÀ* +
=>
ÀÀ, .
g
ÀÀ/ 0
.
ÀÀ0 1
Id
ÀÀ1 3
==
ÀÀ4 6
item
ÀÀ7 ;
.
ÀÀ; <
GroupId
ÀÀ< C
)
ÀÀC D
;
ÀÀD E
if
ÂÂ 

(
ÂÂ 
group
ÂÂ 
==
ÂÂ 
null
ÂÂ 
&&
ÂÂ 
item
ÂÂ !
.
ÂÂ! "
GroupId
ÂÂ" )
.
ÂÂ) *
HasValue
ÂÂ* 2
)
ÂÂ2 3
{
ÃÃ 	
group
ÄÄ 
=
ÄÄ 
await
ÄÄ 
_groupRepository
ÄÄ +
.
ÄÄ+ ,
GetByIdAsync
ÄÄ, 8
(
ÄÄ8 9
item
ÄÄ9 =
.
ÄÄ= >
GroupId
ÄÄ> E
.
ÄÄE F
Value
ÄÄF K
)
ÄÄK L
;
ÄÄL M
}
ÅÅ 	
return
ÇÇ 
group
ÇÇ 
?
ÇÇ 
.
ÇÇ 
Name
ÇÇ 
.
ÇÇ 
Contains
ÇÇ #
(
ÇÇ# $
$str
ÇÇ$ +
,
ÇÇ+ ,
StringComparison
ÇÇ- =
.
ÇÇ= >
OrdinalIgnoreCase
ÇÇ> O
)
ÇÇO P
??
ÇÇQ S
false
ÇÇT Y
;
ÇÇY Z
}
ÈÈ 
public
ËË 

ICommand
ËË &
AddPizzaModifiersCommand
ËË ,
{
ËË- .
get
ËË/ 2
;
ËË2 3
}
ËË4 5
private
ÍÍ 
async
ÍÍ 
Task
ÍÍ $
AddPizzaModifiersAsync
ÍÍ -
(
ÍÍ- .
OrderLineDto
ÍÍ. :
?
ÍÍ: ;
line
ÍÍ< @
)
ÍÍ@ A
{
ÎÎ 
if
ÏÏ 

(
ÏÏ 
line
ÏÏ 
==
ÏÏ 
null
ÏÏ 
||
ÏÏ 
Ticket
ÏÏ "
==
ÏÏ# %
null
ÏÏ& *
)
ÏÏ* +
return
ÏÏ, 2
;
ÏÏ2 3
var
ÑÑ 
vm
ÑÑ 
=
ÑÑ 
new
ÑÑ 
Magidesk
ÑÑ 
.
ÑÑ 
Presentation
ÑÑ *
.
ÑÑ* +

ViewModels
ÑÑ+ 5
.
ÑÑ5 6
Dialogs
ÑÑ6 =
.
ÑÑ= >$
PizzaModifierViewModel
ÑÑ> T
(
ÑÑT U
_menuRepository
ÑÑU d
,
ÑÑd e
line
ÑÑf j
)
ÑÑj k
;
ÑÑk l
await
ÓÓ &
_orderEntryDialogService
ÓÓ &
.
ÓÓ& '$
ShowPizzaModifierAsync
ÓÓ' =
(
ÓÓ= >
vm
ÓÓ> @
)
ÓÓ@ A
;
ÓÓA B
if
ÕÕ 

(
ÕÕ 
vm
ÕÕ 
.
ÕÕ 
IsConfirmed
ÕÕ 
)
ÕÕ 
{
ÖÖ 	
await
×× %
_modifyOrderLineHandler
×× *
.
××* +
HandleAsync
××+ 6
(
××6 7
new
××7 :$
ModifyOrderLineCommand
××; Q
{
ØØ 
TicketId
ÙÙ 
=
ÙÙ 
Ticket
ÙÙ !
.
ÙÙ! "
Id
ÙÙ" $
,
ÙÙ$ %
OrderLineId
ÚÚ 
=
ÚÚ 
line
ÚÚ "
.
ÚÚ" #
Id
ÚÚ# %
,
ÚÚ% &
Quantity
ÛÛ 
=
ÛÛ 
line
ÛÛ 
.
ÛÛ  
Quantity
ÛÛ  (
,
ÛÛ( )
Instructions
ÜÜ 
=
ÜÜ 
line
ÜÜ #
.
ÜÜ# $
Instructions
ÜÜ$ 0
,
ÜÜ0 1
	Modifiers
ÝÝ 
=
ÝÝ 
vm
ÝÝ 
.
ÝÝ 
ResultModifiers
ÝÝ .
}
ÞÞ 
)
ÞÞ 
;
ÞÞ 
await
ßß 
LoadTicketAsync
ßß !
(
ßß! "
Ticket
ßß" (
.
ßß( )
Id
ßß) +
)
ßß+ ,
;
ßß, -
}
àà 	
}
áá 
private
ãã 
async
ãã 
Task
ãã 
AddFeeAsync
ãã "
(
ãã" #
)
ãã# $
{
ää 
if
åå 

(
åå 
Ticket
åå 
==
åå 
null
åå 
)
åå 
return
åå "
;
åå" #
var
çç 
vm
çç 
=
çç 
new
çç  
TicketFeeViewModel
çç '
(
çç' (
)
çç( )
;
çç) *
await
èè &
_orderEntryDialogService
èè &
.
èè& ' 
ShowTicketFeeAsync
èè' 9
(
èè9 :
vm
èè: <
)
èè< =
;
èè= >
if
êê 

(
êê 
vm
êê 
.
êê 
IsConfirmed
êê 
)
êê 
{
ëë 	
if
ìì 
(
ìì 
vm
ìì 
.
ìì 
Amount
ìì 
<
ìì 
$num
ìì 
)
ìì 
return
ìì %
;
ìì% &
if
îî 
(
îî 
_userService
îî 
.
îî 
CurrentUser
îî (
?
îî( )
.
îî) *
Id
îî* ,
==
îî- /
null
îî0 4
)
îî4 5
{
ïï 
return
ðð 
;
ðð 
}
ññ 
var
óó 
processedBy
óó 
=
óó 
_userService
óó *
.
óó* +
CurrentUser
óó+ 6
.
óó6 7
Id
óó7 9
;
óó9 :
switch
õõ 
(
õõ 
vm
õõ 
.
õõ 
SelectedFeeType
õõ &
)
õõ& '
{
öö 
case
÷÷ 
TicketFeeType
÷÷ "
.
÷÷" #
ServiceCharge
÷÷# 0
:
÷÷0 1
await
øø &
_setServiceChargeHandler
øø 2
.
øø2 3
HandleAsync
øø3 >
(
øø> ?
new
øø? B%
SetServiceChargeCommand
øøC Z
{
ùù 
TicketId
úú  
=
úú! "
Ticket
úú# )
.
úú) *
Id
úú* ,
,
úú, -
Amount
ûû 
=
ûû  
new
ûû! $
Magidesk
ûû% -
.
ûû- .
Domain
ûû. 4
.
ûû4 5
ValueObjects
ûû5 A
.
ûûA B
Money
ûûB G
(
ûûG H
vm
ûûH J
.
ûûJ K
Amount
ûûK Q
)
ûûQ R
,
ûûR S
ProcessedBy
üü #
=
üü$ %
processedBy
üü& 1
}
ýý 
)
ýý 
;
ýý 
break
þþ 
;
þþ 
case
ÿÿ 
TicketFeeType
ÿÿ "
.
ÿÿ" #
DeliveryCharge
ÿÿ# 1
:
ÿÿ1 2
await
€€ '
_setDeliveryChargeHandler
€€ 3
.
€€3 4
HandleAsync
€€4 ?
(
€€? @
new
€€@ C&
SetDeliveryChargeCommand
€€D \
{
 
TicketId
‚‚  
=
‚‚! "
Ticket
‚‚# )
.
‚‚) *
Id
‚‚* ,
,
‚‚, -
Amount
ƒƒ 
=
ƒƒ  
new
ƒƒ! $
Magidesk
ƒƒ% -
.
ƒƒ- .
Domain
ƒƒ. 4
.
ƒƒ4 5
ValueObjects
ƒƒ5 A
.
ƒƒA B
Money
ƒƒB G
(
ƒƒG H
vm
ƒƒH J
.
ƒƒJ K
Amount
ƒƒK Q
)
ƒƒQ R
,
ƒƒR S
ProcessedBy
„„ #
=
„„$ %
processedBy
„„& 1
}
…… 
)
…… 
;
…… 
break
†† 
;
†† 
case
‡‡ 
TicketFeeType
‡‡ "
.
‡‡" #

Adjustment
‡‡# -
:
‡‡- .
await
ˆˆ #
_setAdjustmentHandler
ˆˆ /
.
ˆˆ/ 0
HandleAsync
ˆˆ0 ;
(
ˆˆ; <
new
ˆˆ< ?"
SetAdjustmentCommand
ˆˆ@ T
{
‰‰ 
TicketId
ŠŠ  
=
ŠŠ! "
Ticket
ŠŠ# )
.
ŠŠ) *
Id
ŠŠ* ,
,
ŠŠ, -
Amount
‹‹ 
=
‹‹  
new
‹‹! $
Magidesk
‹‹% -
.
‹‹- .
Domain
‹‹. 4
.
‹‹4 5
ValueObjects
‹‹5 A
.
‹‹A B
Money
‹‹B G
(
‹‹G H
vm
‹‹H J
.
‹‹J K
Amount
‹‹K Q
)
‹‹Q R
,
‹‹R S
ProcessedBy
ŒŒ #
=
ŒŒ$ %
processedBy
ŒŒ& 1
,
ŒŒ1 2
Reason
 
=
  
vm
! #
.
# $
Reason
$ *
}
ŽŽ 
)
ŽŽ 
;
ŽŽ 
break
 
;
 
}
 
await
’’ 
LoadTicketAsync
’’ !
(
’’! "
Ticket
’’" (
.
’’( )
Id
’’) +
)
’’+ ,
;
’’, -
}
““ 	
}
”” 
private
–– 
async
–– 
Task
–– 
ChangeSeatAsync
–– &
(
––& '
OrderLineDto
––' 3
?
––3 4
line
––5 9
)
––9 :
{
—— 
if
˜˜ 

(
˜˜ 
line
˜˜ 
==
˜˜ 
null
˜˜ 
||
˜˜ 
Ticket
˜˜ "
==
˜˜# %
null
˜˜& *
)
˜˜* +
return
˜˜, 2
;
˜˜2 3
var
›› 
vm
›› 
=
›› 
new
›› $
SeatSelectionViewModel
›› +
(
››+ ,
)
››, -
;
››- .
await
 &
_orderEntryDialogService
 &
.
& '$
ShowSeatSelectionAsync
' =
(
= >
vm
> @
)
@ A
;
A B
if
ŸŸ 

(
ŸŸ 
vm
ŸŸ 
.
ŸŸ 
IsConfirmed
ŸŸ 
&&
ŸŸ 
vm
ŸŸ  
.
ŸŸ  !
ResultSeatNumber
ŸŸ! 1
.
ŸŸ1 2
HasValue
ŸŸ2 :
)
ŸŸ: ;
{
   	
try
¡¡ 
{
¢¢ 
await
££  
_changeSeatHandler
££ )
.
££) *
HandleAsync
££* 5
(
££5 6
new
££6 9
ChangeSeatCommand
££: K
{
¤¤ 
TicketId
¥¥ 
=
¥¥ 
Ticket
¥¥  &
.
¥¥& '
Id
¥¥' )
,
¥¥) *
OrderLineId
¦¦  
=
¦¦! "
line
¦¦# '
.
¦¦' (
Id
¦¦( *
,
¦¦* +

SeatNumber
§§ 
=
§§  !
vm
§§" $
.
§§$ %
ResultSeatNumber
§§% 5
.
§§5 6
Value
§§6 ;
}
¨¨ 
)
¨¨ 
;
¨¨ 
await
ªª 
LoadTicketAsync
ªª &
(
ªª& '
Ticket
ªª' -
.
ªª- .
Id
ªª. 0
)
ªª0 1
;
ªª1 2
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
var
®® 
errorDialog
®® 
=
®®  !
new
®®" %
ContentDialog
®®& 3
{
¯¯ 
Title
°° 
=
°° 
$str
°° 3
,
°°3 4
Content
±± 
=
±± 
ex
±±  
.
±±  !
Message
±±! (
,
±±( )
CloseButtonText
²² #
=
²²$ %
$str
²²& *
,
²²* +
XamlRoot
³³ 
=
³³ 
App
³³ "
.
³³" # 
MainWindowInstance
³³# 5
.
³³5 6
Content
³³6 =
.
³³= >
XamlRoot
³³> F
}
´´ 
;
´´ 
await
µµ  
_navigationService
µµ (
.
µµ( )
ShowDialogAsync
µµ) 8
(
µµ8 9
errorDialog
µµ9 D
)
µµD E
;
µµE F
}
¶¶ 
}
·· 	
}
¸¸ 
private
ºº 
async
ºº 
Task
ºº 
AddMiscItemAsync
ºº '
(
ºº' (
)
ºº( )
{
»» 
if
¼¼ 

(
¼¼ 
Ticket
¼¼ 
==
¼¼ 
null
¼¼ 
)
¼¼ 
return
¼¼ "
;
¼¼" #
var
¾¾ 
vm
¾¾ 
=
¾¾ 
new
¾¾ 
MiscItemViewModel
¾¾ &
(
¾¾& '
)
¾¾' (
;
¾¾( )
await
¿¿ &
_orderEntryDialogService
¿¿ &
.
¿¿& '
ShowMiscItemAsync
¿¿' 8
(
¿¿8 9
vm
¿¿9 ;
)
¿¿; <
;
¿¿< =
if
ÁÁ 

(
ÁÁ 
vm
ÁÁ 
.
ÁÁ 
IsConfirmed
ÁÁ 
)
ÁÁ 
{
ÂÂ 	
if
ÃÃ 
(
ÃÃ 
string
ÃÃ 
.
ÃÃ  
IsNullOrWhiteSpace
ÃÃ )
(
ÃÃ) *
vm
ÃÃ* ,
.
ÃÃ, -
Description
ÃÃ- 8
)
ÃÃ8 9
||
ÃÃ: <
vm
ÃÃ= ?
.
ÃÃ? @
Price
ÃÃ@ E
<
ÃÃF G
$num
ÃÃH I
)
ÃÃI J
return
ÃÃK Q
;
ÃÃQ R
await
ÅÅ "
_addOrderLineHandler
ÅÅ &
.
ÅÅ& '
HandleAsync
ÅÅ' 2
(
ÅÅ2 3
new
ÅÅ3 6!
AddOrderLineCommand
ÅÅ7 J
{
ÆÆ 
TicketId
ÇÇ 
=
ÇÇ 
Ticket
ÇÇ !
.
ÇÇ! "
Id
ÇÇ" $
,
ÇÇ$ %

MenuItemId
ÈÈ 
=
ÈÈ 
Guid
ÈÈ !
.
ÈÈ! "
Empty
ÈÈ" '
,
ÈÈ' (
MenuItemName
ÉÉ 
=
ÉÉ 
vm
ÉÉ !
.
ÉÉ! "
Description
ÉÉ" -
,
ÉÉ- .
Quantity
ÊÊ 
=
ÊÊ 
PendingQuantity
ÊÊ *
,
ÊÊ* +
	UnitPrice
ËË 
=
ËË 
new
ËË 
Magidesk
ËË  (
.
ËË( )
Domain
ËË) /
.
ËË/ 0
ValueObjects
ËË0 <
.
ËË< =
Money
ËË= B
(
ËËB C
vm
ËËC E
.
ËËE F
Price
ËËF K
)
ËËK L
,
ËËL M
TaxRate
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
,
ÌÌ 
CategoryName
ÍÍ 
=
ÍÍ 
$str
ÍÍ %
,
ÍÍ% &
	GroupName
ÎÎ 
=
ÎÎ 
$str
ÎÎ %
}
ÏÏ 
)
ÏÏ 
;
ÏÏ 
PendingQuantity
ÒÒ 
=
ÒÒ 
$num
ÒÒ 
;
ÒÒ  
await
ÔÔ 
LoadTicketAsync
ÔÔ !
(
ÔÔ! "
Ticket
ÔÔ" (
.
ÔÔ( )
Id
ÔÔ) +
)
ÔÔ+ ,
;
ÔÔ, -
}
ÕÕ 	
}
ÖÖ 
private
ØØ 
async
ØØ 
Task
ØØ 
PrintTicketAsync
ØØ '
(
ØØ' (
)
ØØ( )
{
ÙÙ 
if
ÚÚ 

(
ÚÚ 
Ticket
ÚÚ 
==
ÚÚ 
null
ÚÚ 
)
ÚÚ 
return
ÚÚ "
;
ÚÚ" #
IsBusy
ÜÜ 
=
ÜÜ 
true
ÜÜ 
;
ÜÜ 
try
ÝÝ 
{
ÞÞ 	
await
àà 
_printingService
àà #
.
àà# $
PrintTicketAsync
àà$ 4
(
àà4 5
Ticket
àà5 ;
)
àà; <
;
àà< =
}
áá 	
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ 
{
ãã 	
System
ää 
.
ää 
Diagnostics
ää 
.
ää  
Debug
ää  %
.
ää% &
	WriteLine
ää& /
(
ää/ 0
$"
ää0 2
$str
ää2 ?
{
ää? @
ex
ää@ B
.
ääB C
Message
ääC J
}
ääJ K
"
ääK L
)
ääL M
;
ääM N
var
ææ 
dialog
ææ 
=
ææ 
new
ææ 
	Microsoft
ææ '
.
ææ' (
UI
ææ( *
.
ææ* +
Xaml
ææ+ /
.
ææ/ 0
Controls
ææ0 8
.
ææ8 9
ContentDialog
ææ9 F
{
çç 
Title
èè 
=
èè 
$str
èè '
,
èè' (
Content
éé 
=
éé 
$"
éé 
$str
éé ?
{
éé? @
ex
éé@ B
.
ééB C
Message
ééC J
}
ééJ K
"
ééK L
,
ééL M
CloseButtonText
êê  
=
êê! "
$str
êê# '
,
êê' (
XamlRoot
ëë 
=
ëë 
App
ëë 
.
ëë   
MainWindowInstance
ëë  2
.
ëë2 3
Content
ëë3 :
.
ëë: ;
XamlRoot
ëë; C
}
ìì 
;
ìì 
await
íí  
_navigationService
íí %
.
íí% &
ShowDialogAsync
íí& 5
(
íí5 6
dialog
íí6 <
)
íí< =
;
íí= >
}
îî 	
finally
ïï 
{
ïï 
IsBusy
ïï 
=
ïï 
false
ïï  
;
ïï  !
}
ïï" #
}
ðð 
public
ôô 

async
ôô 
Task
ôô 
InitializeAsync
ôô %
(
ôô% &
Guid
ôô& *
?
ôô* +
ticketId
ôô, 4
=
ôô5 6
null
ôô7 ;
)
ôô; <
{
õõ 
try
öö 
{
÷÷ 	
System
øø 
.
øø 
Diagnostics
øø 
.
øø 
Debug
øø $
.
øø$ %
	WriteLine
øø% .
(
øø. /
$"
øø/ 1
$str
øø1 k
{
øøk l
ticketId
øøl t
}
øøt u
"
øøu v
)
øøv w
;
øøw x
await
úú !
LoadCategoriesAsync
úú %
(
úú% &
)
úú& '
;
úú' (
System
ûû 
.
ûû 
Diagnostics
ûû 
.
ûû 
Debug
ûû $
.
ûû$ %
	WriteLine
ûû% .
(
ûû. /
$"
ûû/ 1
$str
ûû1 D
{
ûûD E

Categories
ûûE O
.
ûûO P
Count
ûûP U
}
ûûU V
"
ûûV W
)
ûûW X
;
ûûX Y
if
ýý 
(
ýý 
ticketId
ýý 
.
ýý 
HasValue
ýý !
)
ýý! "
{
þþ 
System
ÿÿ 
.
ÿÿ 
Diagnostics
ÿÿ "
.
ÿÿ" #
Debug
ÿÿ# (
.
ÿÿ( )
	WriteLine
ÿÿ) 2
(
ÿÿ2 3
$"
ÿÿ3 5
$str
ÿÿ5 N
{
ÿÿN O
ticketId
ÿÿO W
.
ÿÿW X
Value
ÿÿX ]
}
ÿÿ] ^
"
ÿÿ^ _
)
ÿÿ_ `
;
ÿÿ` a
await
€€ 
LoadTicketAsync
€€ %
(
€€% &
ticketId
€€& .
.
€€. /
Value
€€/ 4
)
€€4 5
;
€€5 6
System
 
.
 
Diagnostics
 "
.
" #
Debug
# (
.
( )
	WriteLine
) 2
(
2 3
$"
3 5
$str
5 _
{
_ `
Ticket
` f
==
g i
null
j n
}
n o
"
o p
)
p q
;
q r
}
‚‚ 
else
ƒƒ 
if
ƒƒ 
(
ƒƒ 
Ticket
ƒƒ 
!=
ƒƒ 
null
ƒƒ #
)
ƒƒ# $
{
„„ 
System
†† 
.
†† 
Diagnostics
†† "
.
††" #
Debug
††# (
.
††( )
	WriteLine
††) 2
(
††2 3
$"
††3 5
$str
††5 Q
{
††Q R
Ticket
††R X
.
††X Y
Id
††Y [
}
††[ \
"
††\ ]
)
††] ^
;
††^ _
await
‡‡ 
LoadTicketAsync
‡‡ %
(
‡‡% &
Ticket
‡‡& ,
.
‡‡, -
Id
‡‡- /
)
‡‡/ 0
;
‡‡0 1
if
‹‹ 
(
‹‹ 
Ticket
‹‹ 
!=
‹‹ 
null
‹‹ "
&&
‹‹# %
(
‹‹& '
Ticket
‹‹' -
.
‹‹- .
Status
‹‹. 4
==
‹‹5 7
Magidesk
‹‹8 @
.
‹‹@ A
Domain
‹‹A G
.
‹‹G H
Enumerations
‹‹H T
.
‹‹T U
TicketStatus
‹‹U a
.
‹‹a b
Paid
‹‹b f
||
‹‹g i
Ticket
ŒŒ' -
.
ŒŒ- .
Status
ŒŒ. 4
==
ŒŒ5 7
Magidesk
ŒŒ8 @
.
ŒŒ@ A
Domain
ŒŒA G
.
ŒŒG H
Enumerations
ŒŒH T
.
ŒŒT U
TicketStatus
ŒŒU a
.
ŒŒa b
Closed
ŒŒb h
)
ŒŒh i
)
ŒŒi j
{
 
System
ŽŽ 
.
ŽŽ 
Diagnostics
ŽŽ &
.
ŽŽ& '
Debug
ŽŽ' ,
.
ŽŽ, -
	WriteLine
ŽŽ- 6
(
ŽŽ6 7
$"
ŽŽ7 9
$str
ŽŽ9 @
{
ŽŽ@ A
Ticket
ŽŽA G
.
ŽŽG H
TicketNumber
ŽŽH T
}
ŽŽT U
$str
ŽŽU Y
{
ŽŽY Z
Ticket
ŽŽZ `
.
ŽŽ` a
Status
ŽŽa g
}
ŽŽg h
$strŽŽh ‚
"ŽŽ‚ ƒ
)ŽŽƒ „
;ŽŽ„ …
Ticket
 
=
 
null
 !
;
! "
await
 "
CreateNewTicketAsync
 .
(
. /
)
/ 0
;
0 1
}
‘‘ 
}
’’ 
else
““ 
{
”” 
System
•• 
.
•• 
Diagnostics
•• "
.
••" #
Debug
••# (
.
••( )
	WriteLine
••) 2
(
••2 3
$str
••3 v
)
••v w
;
••w x
await
—— "
CreateNewTicketAsync
—— +
(
——+ ,
)
——, -
;
——- .
}
˜˜ 
System
šš 
.
šš 
Diagnostics
šš 
.
šš 
Debug
šš $
.
šš$ %
	WriteLine
šš% .
(
šš. /
$"
šš/ 1
$str
šš1 i
{
šši j
	HasTicket
ššj s
}
ššs t
$strššt Š
{ššŠ ‹"
HasTicketWithItemsšš‹ 
}šš ž
"ššž Ÿ
)ššŸ  
;šš  ¡
}
›› 	
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ 
{
 	
System
žž 
.
žž 
Diagnostics
žž 
.
žž 
Debug
žž $
.
žž$ %
	WriteLine
žž% .
(
žž. /
$"
žž/ 1
$str
žž1 _
{
žž_ `
ex
žž` b
.
žžb c
Message
žžc j
}
žžj k
"
žžk l
)
žžl m
;
žžm n
System
ŸŸ 
.
ŸŸ 
Diagnostics
ŸŸ 
.
ŸŸ 
Debug
ŸŸ $
.
ŸŸ$ %
	WriteLine
ŸŸ% .
(
ŸŸ. /
$"
ŸŸ/ 1
$str
ŸŸ1 >
{
ŸŸ> ?
ex
ŸŸ? A
.
ŸŸA B

StackTrace
ŸŸB L
}
ŸŸL M
"
ŸŸM N
)
ŸŸN O
;
ŸŸO P
var
¢¢ 
dialog
¢¢ 
=
¢¢ 
new
¢¢ 
	Microsoft
¢¢ &
.
¢¢& '
UI
¢¢' )
.
¢¢) *
Xaml
¢¢* .
.
¢¢. /
Controls
¢¢/ 7
.
¢¢7 8
ContentDialog
¢¢8 E
{
££ 
Title
¤¤ 
=
¤¤ 
$str
¤¤ .
,
¤¤. /
Content
¥¥ 
=
¥¥ 
$"
¥¥ 
$str
¥¥ B
{
¥¥B C
ex
¥¥C E
.
¥¥E F
Message
¥¥F M
}
¥¥M N
$str
¥¥N q
"
¥¥q r
,
¥¥r s
CloseButtonText
¦¦ 
=
¦¦  !
$str
¦¦" +
,
¦¦+ ,
XamlRoot
§§ 
=
§§ 
App
§§ 
.
§§  
MainWindowInstance
§§ 1
.
§§1 2
Content
§§2 9
.
§§9 :
XamlRoot
§§: B
}
¨¨ 
;
¨¨ 
await
©©  
_navigationService
©© $
.
©©$ %
ShowDialogAsync
©©% 4
(
©©4 5
dialog
©©5 ;
)
©©; <
;
©©< =
if
¬¬ 
(
¬¬  
_navigationService
¬¬ "
.
¬¬" #
	CanGoBack
¬¬# ,
)
¬¬, -
{
­­  
_navigationService
®® "
.
®®" #
GoBack
®®# )
(
®®) *
)
®®* +
;
®®+ ,
}
¯¯ 
else
°° 
{
±±  
_navigationService
³³ #
.
³³# $
Navigate
³³$ ,
(
³³, -
typeof
³³- 3
(
³³3 4
Magidesk
³³4 <
.
³³< =
Presentation
³³= I
.
³³I J
Views
³³J O
.
³³O P
SwitchboardPage
³³P _
)
³³_ `
)
³³` a
;
³³a b
}
´´ 
}
µµ 	
}
¶¶ 
private
¸¸ 
async
¸¸ 
Task
¸¸ !
LoadCategoriesAsync
¸¸ *
(
¸¸* +
)
¸¸+ ,
{
¹¹ 
IsBusy
ºº 
=
ºº 
true
ºº 
;
ºº 
try
»» 
{
¼¼ 	
System
½½ 
.
½½ 
Diagnostics
½½ 
.
½½ 
Debug
½½ $
.
½½$ %
	WriteLine
½½% .
(
½½. /
$str
½½/ L
)
½½L M
;
½½M N

Categories
¾¾ 
.
¾¾ 
Clear
¾¾ 
(
¾¾ 
)
¾¾ 
;
¾¾ 
var
¿¿ 

categories
¿¿ 
=
¿¿ 
await
¿¿ "!
_categoryRepository
¿¿# 6
.
¿¿6 7
GetVisibleAsync
¿¿7 F
(
¿¿F G
)
¿¿G H
;
¿¿H I
System
ÁÁ 
.
ÁÁ 
Diagnostics
ÁÁ 
.
ÁÁ 
Debug
ÁÁ $
.
ÁÁ$ %
	WriteLine
ÁÁ% .
(
ÁÁ. /
$"
ÁÁ/ 1
$str
ÁÁ1 ;
{
ÁÁ; <

categories
ÁÁ< F
.
ÁÁF G
Count
ÁÁG L
(
ÁÁL M
)
ÁÁM N
}
ÁÁN O
$str
ÁÁO j
"
ÁÁj k
)
ÁÁk l
;
ÁÁl m
foreach
ÃÃ 
(
ÃÃ 
var
ÃÃ 
category
ÃÃ !
in
ÃÃ" $

categories
ÃÃ% /
)
ÃÃ/ 0
{
ÄÄ 

Categories
ÅÅ 
.
ÅÅ 
Add
ÅÅ 
(
ÅÅ 
category
ÅÅ '
)
ÅÅ' (
;
ÅÅ( )
}
ÆÆ 
System
ÈÈ 
.
ÈÈ 
Diagnostics
ÈÈ 
.
ÈÈ 
Debug
ÈÈ $
.
ÈÈ$ %
	WriteLine
ÈÈ% .
(
ÈÈ. /
$"
ÈÈ/ 1
$str
ÈÈ1 V
{
ÈÈV W

Categories
ÈÈW a
.
ÈÈa b
Count
ÈÈb g
}
ÈÈg h
$str
ÈÈh n
"
ÈÈn o
)
ÈÈo p
;
ÈÈp q
}
ÉÉ 	
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ 
{
ËË 	
System
ÌÌ 
.
ÌÌ 
Diagnostics
ÌÌ 
.
ÌÌ 
Debug
ÌÌ $
.
ÌÌ$ %
	WriteLine
ÌÌ% .
(
ÌÌ. /
$"
ÌÌ/ 1
$str
ÌÌ1 K
{
ÌÌK L
ex
ÌÌL N
.
ÌÌN O
Message
ÌÌO V
}
ÌÌV W
"
ÌÌW X
)
ÌÌX Y
;
ÌÌY Z
System
ÍÍ 
.
ÍÍ 
Diagnostics
ÍÍ 
.
ÍÍ 
Debug
ÍÍ $
.
ÍÍ$ %
	WriteLine
ÍÍ% .
(
ÍÍ. /
$"
ÍÍ/ 1
$str
ÍÍ1 >
{
ÍÍ> ?
ex
ÍÍ? A
.
ÍÍA B

StackTrace
ÍÍB L
}
ÍÍL M
"
ÍÍM N
)
ÍÍN O
;
ÍÍO P
}
ÎÎ 	
finally
ÏÏ 
{
ÏÏ 
IsBusy
ÏÏ 
=
ÏÏ 
false
ÏÏ  
;
ÏÏ  !
}
ÏÏ" #
}
ÐÐ 
private
ÒÒ 
async
ÒÒ 
Task
ÒÒ 
LoadGroupsAsync
ÒÒ &
(
ÒÒ& '
MenuCategory
ÒÒ' 3
?
ÒÒ3 4
category
ÒÒ5 =
)
ÒÒ= >
{
ÓÓ 
Groups
ÔÔ 
.
ÔÔ 
Clear
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
Items
ÕÕ 
.
ÕÕ 
Clear
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
if
ÖÖ 

(
ÖÖ 
category
ÖÖ 
==
ÖÖ 
null
ÖÖ 
)
ÖÖ 
return
ÖÖ $
;
ÖÖ$ %
IsBusy
ØØ 
=
ØØ 
true
ØØ 
;
ØØ 
try
ÙÙ 
{
ÚÚ 	
var
ÛÛ 
groups
ÛÛ 
=
ÛÛ 
await
ÛÛ 
_groupRepository
ÛÛ /
.
ÛÛ/ 0"
GetByCategoryIdAsync
ÛÛ0 D
(
ÛÛD E
category
ÛÛE M
.
ÛÛM N
Id
ÛÛN P
)
ÛÛP Q
;
ÛÛQ R
foreach
ÜÜ 
(
ÜÜ 
var
ÜÜ 
g
ÜÜ 
in
ÜÜ 
groups
ÜÜ %
)
ÜÜ% &
Groups
ÜÜ' -
.
ÜÜ- .
Add
ÜÜ. 1
(
ÜÜ1 2
g
ÜÜ2 3
)
ÜÜ3 4
;
ÜÜ4 5
}
ÝÝ 	
finally
ÞÞ 
{
ÞÞ 
IsBusy
ÞÞ 
=
ÞÞ 
false
ÞÞ  
;
ÞÞ  !
}
ÞÞ" #
}
ßß 
private
áá 
async
áá 
Task
áá 
LoadItemsAsync
áá %
(
áá% &
	MenuGroup
áá& /
?
áá/ 0
group
áá1 6
)
áá6 7
{
ââ 
Items
ãã 
.
ãã 
Clear
ãã 
(
ãã 
)
ãã 
;
ãã 
if
ää 

(
ää 
group
ää 
==
ää 
null
ää 
)
ää 
return
ää !
;
ää! "
IsBusy
ææ 
=
ææ 
true
ææ 
;
ææ 
try
çç 
{
èè 	
var
éé 
items
éé 
=
éé 
await
éé 
_menuRepository
éé .
.
éé. /
GetByGroupAsync
éé/ >
(
éé> ?
group
éé? D
.
ééD E
Id
ééE G
)
ééG H
;
ééH I
foreach
êê 
(
êê 
var
êê 
i
êê 
in
êê 
items
êê $
)
êê$ %
Items
êê& +
.
êê+ ,
Add
êê, /
(
êê/ 0
i
êê0 1
)
êê1 2
;
êê2 3
}
ëë 	
finally
ìì 
{
ìì 
IsBusy
ìì 
=
ìì 
false
ìì  
;
ìì  !
}
ìì" #
}
íí 
public
ïï 

ICommand
ïï "
SplitTicketUiCommand
ïï (
=>
ïï) +
new
ïï, /
AsyncRelayCommand
ïï0 A
(
ïïA B
SplitTicketAsync
ïïB R
)
ïïR S
;
ïïS T
public
ðð 

ICommand
ðð "
SendToKitchenCommand
ðð (
=>
ðð) +
new
ðð, /
AsyncRelayCommand
ðð0 A
(
ððA B 
SendToKitchenAsync
ððB T
)
ððT U
;
ððU V
public
ññ 

ICommand
ññ 
PayNowUiCommand
ññ #
=>
ññ$ &
new
ññ' *
AsyncRelayCommand
ññ+ <
(
ññ< =
PayNowAsync
ññ= H
)
ññH I
;
ññI J
private
õõ 
async
õõ 
Task
õõ 
PayNowAsync
õõ "
(
õõ" #
)
õõ# $
{
öö 
if
÷÷ 

(
÷÷ 
Ticket
÷÷ 
==
÷÷ 
null
÷÷ 
)
÷÷ 
return
÷÷ "
;
÷÷" #
if
ùù 

(
ùù 
_userService
ùù 
.
ùù 
CurrentUser
ùù $
?
ùù$ %
.
ùù% &
Id
ùù& (
==
ùù) +
null
ùù, 0
||
ùù1 3
_terminalContext
ùù4 D
.
ùùD E

TerminalId
ùùE O
==
ùùP R
null
ùùS W
)
ùùW X
{
úú 	
return
ûû 
;
ûû 
}
üü 	
if
ÿÿ 

(
ÿÿ 
!
ÿÿ 
Ticket
ÿÿ 
.
ÿÿ 

OrderLines
ÿÿ 
.
ÿÿ 
Any
ÿÿ "
(
ÿÿ" #
)
ÿÿ# $
)
ÿÿ$ %
{
€€ 	
return
 
;
 
}
‚‚ 	
if
„„ 

(
„„ 
Ticket
„„ 
.
„„ 
TotalAmount
„„ 
<=
„„ !
$num
„„" #
)
„„# $
{
…… 	
await
†† 
LoadTicketAsync
†† !
(
††! "
Ticket
††" (
.
††( )
Id
††) +
)
††+ ,
;
††, -
Ticket
‡‡ 
=
‡‡ 
null
‡‡ 
;
‡‡  
_navigationService
ˆˆ 
.
ˆˆ 
GoBack
ˆˆ %
(
ˆˆ% &
)
ˆˆ& '
;
ˆˆ' (
return
‰‰ 
;
‰‰ 
}
ŠŠ 	
IsBusy
ŒŒ 
=
ŒŒ 
true
ŒŒ 
;
ŒŒ 
try
 
{
ŽŽ 	
var
 
result
 
=
 
await
 
_payNowHandler
 -
.
- .
HandleAsync
. 9
(
9 :
new
: =
PayNowCommand
> K
{
 
TicketId
‘‘ 
=
‘‘ 
Ticket
‘‘ !
.
‘‘! "
Id
‘‘" $
,
‘‘$ %
Amount
’’ 
=
’’ 
$num
’’ 
,
’’ 

TenderType
““ 
=
““ 
$str
““ #
,
““# $
ProcessedBy
”” 
=
”” 
_userService
”” *
.
””* +
CurrentUser
””+ 6
.
””6 7
Id
””7 9
,
””9 :

TerminalId
•• 
=
•• 
_terminalContext
•• -
.
••- .

TerminalId
••. 8
.
••8 9
Value
••9 >
}
–– 
)
–– 
;
–– 
if
˜˜ 
(
˜˜ 
!
˜˜ 
result
˜˜ 
.
˜˜ 
Success
˜˜ 
)
˜˜  
{
™™ 
var
šš 
dialog
šš 
=
šš 
new
šš !
	Microsoft
šš" +
.
šš+ ,
UI
šš, .
.
šš. /
Xaml
šš/ 3
.
šš3 4
Controls
šš4 <
.
šš< =
ContentDialog
šš= J
{
›› 
Title
œœ 
=
œœ 
$str
œœ -
,
œœ- .
Content
 
=
 
$"
 !
$str
! J
{
J K
result
K Q
.
Q R
Message
R Y
}
Y Z
"
Z [
,
[ \
CloseButtonText
žž $
=
žž% &
$str
žž' +
,
žž+ ,
XamlRoot
ŸŸ 
=
ŸŸ 
App
ŸŸ  #
.
ŸŸ# $ 
MainWindowInstance
ŸŸ$ 6
.
ŸŸ6 7
Content
ŸŸ7 >
.
ŸŸ> ?
XamlRoot
ŸŸ? G
}
   
;
   
await
¡¡  
_navigationService
¡¡ )
.
¡¡) *
ShowDialogAsync
¡¡* 9
(
¡¡9 :
dialog
¡¡: @
)
¡¡@ A
;
¡¡A B
return
¢¢ 
;
¢¢ 
}
££ 
await
¦¦ 
LoadTicketAsync
¦¦ !
(
¦¦! "
Ticket
¦¦" (
.
¦¦( )
Id
¦¦) +
)
¦¦+ ,
;
¦¦, -
if
¨¨ 
(
¨¨ 
Ticket
¨¨ 
?
¨¨ 
.
¨¨ 
Status
¨¨ 
==
¨¨ !
Magidesk
¨¨" *
.
¨¨* +
Domain
¨¨+ 1
.
¨¨1 2
Enumerations
¨¨2 >
.
¨¨> ?
TicketStatus
¨¨? K
.
¨¨K L
Closed
¨¨L R
)
¨¨R S
{
©© 
Ticket
ªª 
=
ªª 
null
ªª 
;
ªª  
_navigationService
«« "
.
««" #
GoBack
««# )
(
««) *
)
««* +
;
««+ ,
}
¬¬ 
}
­­ 	
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®® 
{
¯¯ 	
System
°° 
.
°° 
Diagnostics
°° 
.
°° 
Debug
°° $
.
°°$ %
	WriteLine
°°% .
(
°°. /
$"
°°/ 1
$str
°°1 @
{
°°@ A
ex
°°A C
.
°°C D
Message
°°D K
}
°°K L
"
°°L M
)
°°M N
;
°°N O
var
±± 
dialog
±± 
=
±± 
new
±± 
	Microsoft
±± '
.
±±' (
UI
±±( *
.
±±* +
Xaml
±±+ /
.
±±/ 0
Controls
±±0 8
.
±±8 9
ContentDialog
±±9 F
{
²² 
Title
³³ 
=
³³ 
$str
³³ '
,
³³' (
Content
´´ 
=
´´ 
$"
´´ 
$str
´´ H
{
´´H I
ex
´´I K
.
´´K L
Message
´´L S
}
´´S T
"
´´T U
,
´´U V
CloseButtonText
µµ  
=
µµ! "
$str
µµ# '
,
µµ' (
XamlRoot
¶¶ 
=
¶¶ 
App
¶¶ 
.
¶¶   
MainWindowInstance
¶¶  2
.
¶¶2 3
Content
¶¶3 :
.
¶¶: ;
XamlRoot
¶¶; C
}
·· 
;
·· 
await
¸¸  
_navigationService
¸¸ %
.
¸¸% &
ShowDialogAsync
¸¸& 5
(
¸¸5 6
dialog
¸¸6 <
)
¸¸< =
;
¸¸= >
}
¹¹ 	
finally
ºº 
{
ºº 
IsBusy
ºº 
=
ºº 
false
ºº  
;
ºº  !
}
ºº" #
}
»» 
private
½½ 
async
½½ 
Task
½½ 
SplitTicketAsync
½½ '
(
½½' (
)
½½( )
{
¾¾ 
if
¿¿ 

(
¿¿ 
Ticket
¿¿ 
==
¿¿ 
null
¿¿ 
)
¿¿ 
return
¿¿ "
;
¿¿" #
IsBusy
ÁÁ 
=
ÁÁ 
true
ÁÁ 
;
ÁÁ 
try
ÂÂ 
{
ÃÃ 	
var
ÄÄ 
dialog
ÄÄ 
=
ÄÄ 
new
ÄÄ 
Magidesk
ÄÄ &
.
ÄÄ& '
Presentation
ÄÄ' 3
.
ÄÄ3 4
Views
ÄÄ4 9
.
ÄÄ9 :
SplitTicketDialog
ÄÄ: K
(
ÄÄK L
)
ÄÄL M
;
ÄÄM N
dialog
ÅÅ 
.
ÅÅ 
	ViewModel
ÅÅ 
.
ÅÅ 

Initialize
ÅÅ (
(
ÅÅ( )
Ticket
ÅÅ) /
)
ÅÅ/ 0
;
ÅÅ0 1
var
ÆÆ 
result
ÆÆ 
=
ÆÆ 
await
ÆÆ  
_navigationService
ÆÆ  2
.
ÆÆ2 3
ShowDialogAsync
ÆÆ3 B
(
ÆÆB C
dialog
ÆÆC I
)
ÆÆI J
;
ÆÆJ K
if
ÈÈ 
(
ÈÈ 
result
ÈÈ 
==
ÈÈ !
ContentDialogResult
ÈÈ .
.
ÈÈ. /
Primary
ÈÈ/ 6
)
ÈÈ6 7
{
ÉÉ 
await
ËË 
LoadTicketAsync
ËË &
(
ËË& '
Ticket
ËË' -
.
ËË- .
Id
ËË. 0
)
ËË0 1
;
ËË1 2
}
ÌÌ 
}
ÍÍ 	
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ 
{
ÏÏ 	
System
ÐÐ 
.
ÐÐ 
Diagnostics
ÐÐ 
.
ÐÐ 
Debug
ÐÐ $
.
ÐÐ$ %
	WriteLine
ÐÐ% .
(
ÐÐ. /
$"
ÐÐ/ 1
$str
ÐÐ1 >
{
ÐÐ> ?
ex
ÐÐ? A
.
ÐÐA B
Message
ÐÐB I
}
ÐÐI J
"
ÐÐJ K
)
ÐÐK L
;
ÐÐL M
}
ÑÑ 	
finally
ÒÒ 
{
ÒÒ 
IsBusy
ÒÒ 
=
ÒÒ 
false
ÒÒ  
;
ÒÒ  !
}
ÒÒ" #
}
ÓÓ 
private
ÕÕ 
async
ÕÕ 
Task
ÕÕ  
SendToKitchenAsync
ÕÕ )
(
ÕÕ) *
)
ÕÕ* +
{
ÖÖ 
if
×× 

(
×× 
Ticket
×× 
==
×× 
null
×× 
)
×× 
return
×× "
;
××" #
IsBusy
ÙÙ 
=
ÙÙ 
true
ÙÙ 
;
ÙÙ 
try
ÚÚ 
{
ÛÛ 	
var
ÞÞ 
command
ÞÞ 
=
ÞÞ 
new
ÞÞ #
PrintToKitchenCommand
ÞÞ 3
{
ÞÞ4 5
TicketId
ÞÞ6 >
=
ÞÞ? @
Ticket
ÞÞA G
.
ÞÞG H
Id
ÞÞH J
}
ÞÞK L
;
ÞÞL M
var
ßß 
result
ßß 
=
ßß 
await
ßß $
_printToKitchenHandler
ßß 5
.
ßß5 6
HandleAsync
ßß6 A
(
ßßA B
command
ßßB I
)
ßßI J
;
ßßJ K
if
áá 
(
áá 
!
áá 
result
áá 
.
áá 
Success
áá 
)
áá  
{
ââ 
var
ãã 
errors
ãã 
=
ãã 
result
ãã #
.
ãã# $
Errors
ãã$ *
!=
ãã+ -
null
ãã. 2
&&
ãã3 5
result
ãã6 <
.
ãã< =
Errors
ãã= C
.
ããC D
Any
ããD G
(
ããG H
)
ããH I
?
ää 
string
ää 
.
ää 
Join
ää !
(
ää! "
$str
ää" &
,
ää& '
result
ää( .
.
ää. /
Errors
ää/ 5
)
ää5 6
:
åå 
result
åå 
.
åå 
Message
åå $
;
åå$ %
var
çç 
dialog
çç 
=
çç 
new
çç  
	Microsoft
çç! *
.
çç* +
UI
çç+ -
.
çç- .
Xaml
çç. 2
.
çç2 3
Controls
çç3 ;
.
çç; <
ContentDialog
çç< I
{
èè 
Title
éé 
=
éé 
$str
éé 3
,
éé3 4
Content
êê 
=
êê 
$"
êê  
$str
êê  T
{
êêT U
result
êêU [
.
êê[ \
Message
êê\ c
}
êêc d
$str
êêd p
{
êêp q
errors
êêq w
}
êêw x
"
êêx y
,
êêy z
CloseButtonText
ëë #
=
ëë$ %
$str
ëë& *
,
ëë* +
XamlRoot
ìì 
=
ìì 
App
ìì "
.
ìì" # 
MainWindowInstance
ìì# 5
.
ìì5 6
Content
ìì6 =
.
ìì= >
XamlRoot
ìì> F
}
íí 
;
íí 
await
îî  
_navigationService
îî (
.
îî( )
ShowDialogAsync
îî) 8
(
îî8 9
dialog
îî9 ?
)
îî? @
;
îî@ A
}
ïï 
else
ðð 
{
ññ 
var
òò 
dialog
òò 
=
òò 
new
òò  
	Microsoft
òò! *
.
òò* +
UI
òò+ -
.
òò- .
Xaml
òò. 2
.
òò2 3
Controls
òò3 ;
.
òò; <
ContentDialog
òò< I
{
óó 
Title
ôô 
=
ôô 
$str
ôô %
,
ôô% &
Content
õõ 
=
õõ 
$str
õõ 6
,
õõ6 7
CloseButtonText
öö #
=
öö$ %
$str
öö& *
,
öö* +
XamlRoot
÷÷ 
=
÷÷ 
App
÷÷ "
.
÷÷" # 
MainWindowInstance
÷÷# 5
.
÷÷5 6
Content
÷÷6 =
.
÷÷= >
XamlRoot
÷÷> F
}
øø 
;
øø 
await
ùù  
_navigationService
ùù (
.
ùù( )
ShowDialogAsync
ùù) 8
(
ùù8 9
dialog
ùù9 ?
)
ùù? @
;
ùù@ A
await
üü 
LoadTicketAsync
üü %
(
üü% &
_ticket
üü& -
.
üü- .
Id
üü. 0
)
üü0 1
;
üü1 2
}
ýý 
}
ƒƒ 	
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„ 
{
…… 	
System
†† 
.
†† 
Diagnostics
†† 
.
†† 
Debug
†† $
.
††$ %
	WriteLine
††% .
(
††. /
$"
††/ 1
$str
††1 H
{
††H I
ex
††I K
.
††K L
Message
††L S
}
††S T
"
††T U
)
††U V
;
††V W
var
ˆˆ 
dialog
ˆˆ 
=
ˆˆ 
new
ˆˆ 
	Microsoft
ˆˆ '
.
ˆˆ' (
UI
ˆˆ( *
.
ˆˆ* +
Xaml
ˆˆ+ /
.
ˆˆ/ 0
Controls
ˆˆ0 8
.
ˆˆ8 9
ContentDialog
ˆˆ9 F
{
‰‰ 
Title
ŠŠ 
=
ŠŠ 
$str
ŠŠ '
,
ŠŠ' (
Content
‹‹ 
=
‹‹ 
$"
‹‹ 
$str
‹‹ K
{
‹‹K L
ex
‹‹L N
.
‹‹N O
Message
‹‹O V
}
‹‹V W
"
‹‹W X
,
‹‹X Y
CloseButtonText
ŒŒ  
=
ŒŒ! "
$str
ŒŒ# '
,
ŒŒ' (
XamlRoot
 
=
 
App
 
.
   
MainWindowInstance
  2
.
2 3
Content
3 :
.
: ;
XamlRoot
; C
}
ŽŽ 
;
ŽŽ 
await
  
_navigationService
 %
.
% &
ShowDialogAsync
& 5
(
5 6
dialog
6 <
)
< =
;
= >
}
 	
finally
‘‘ 
{
’’ 	
IsBusy
““ 
=
““ 
false
““ 
;
““ 
}
”” 	
}
•• 
public
—— 

ICommand
—— 
SettleUiCommand
—— #
=>
——$ &
new
——' *
RelayCommand
——+ 7
(
——7 8
Settle
——8 >
)
——> ?
;
——? @
private
™™ 
void
™™ 
Settle
™™ 
(
™™ 
)
™™ 
{
šš 
if
›› 

(
›› 
Ticket
›› 
==
›› 
null
›› 
)
›› 
return
›› "
;
››" # 
_navigationService
œœ 
.
œœ 
Navigate
œœ #
(
œœ# $
typeof
œœ$ *
(
œœ* +
Magidesk
œœ+ 3
.
œœ3 4
Presentation
œœ4 @
.
œœ@ A
Views
œœA F
.
œœF G

SettlePage
œœG Q
)
œœQ R
,
œœR S
Ticket
œœT Z
.
œœZ [
Id
œœ[ ]
)
œœ] ^
;
œœ^ _
}
 
private
ŸŸ 
async
ŸŸ 
Task
ŸŸ "
CreateNewTicketAsync
ŸŸ +
(
ŸŸ+ ,
)
ŸŸ, -
{
   
IsBusy
¡¡ 
=
¡¡ 
true
¡¡ 
;
¡¡ 
try
¢¢ 
{
££ 	
if
¤¤ 
(
¤¤ 
_userService
¤¤ 
.
¤¤ 
CurrentUser
¤¤ (
?
¤¤( )
.
¤¤) *
Id
¤¤* ,
==
¤¤- /
null
¤¤0 4
)
¤¤4 5
{
¥¥ 
return
§§ 
;
§§ 
}
¨¨ 
var
ªª 

terminalId
ªª 
=
ªª 
_terminalContext
ªª -
.
ªª- .

TerminalId
ªª. 8
;
ªª8 9
if
«« 
(
«« 

terminalId
«« 
==
«« 
null
«« "
)
««" #
{
¬¬ 
return
®® 
;
®® 
}
¯¯ 
var
±± 
command
±± 
=
±± 
new
±± !
CreateTicketCommand
±± 1
{
²² 
	CreatedBy
³³ 
=
³³ 
_userService
³³ (
.
³³( )
CurrentUser
³³) 4
.
³³4 5
Id
³³5 7
,
³³7 8

TerminalId
´´ 
=
´´ 

terminalId
´´ '
.
´´' (
Value
´´( -
,
´´- .
ShiftId
µµ 
=
µµ 
Guid
µµ 
.
µµ 
Empty
µµ $
,
µµ$ %
OrderTypeId
¶¶ 
=
¶¶ 
Guid
¶¶ "
.
¶¶" #
Empty
¶¶# (
,
¶¶( )
NumberOfGuests
·· 
=
··  
$num
··! "
}
¸¸ 
;
¸¸ 
var
ºº 
result
ºº 
=
ºº 
await
ºº "
_createTicketHandler
ºº 3
.
ºº3 4
HandleAsync
ºº4 ?
(
ºº? @
command
ºº@ G
)
ººG H
;
ººH I
await
¼¼ 
LoadTicketAsync
¼¼ !
(
¼¼! "
result
¼¼" (
.
¼¼( )
TicketId
¼¼) 1
)
¼¼1 2
;
¼¼2 3
}
½½ 	
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾ 
{
¿¿ 	
var
ÀÀ 
dialog
ÀÀ 
=
ÀÀ 
new
ÀÀ 
ContentDialog
ÀÀ +
{
ÁÁ 
Title
ÂÂ 
=
ÂÂ 
$str
ÂÂ )
,
ÂÂ) *
Content
ÃÃ 
=
ÃÃ 
ex
ÃÃ 
.
ÃÃ 
Message
ÃÃ %
,
ÃÃ% &
CloseButtonText
ÄÄ  
=
ÄÄ! "
$str
ÄÄ# '
,
ÄÄ' (
XamlRoot
ÅÅ 
=
ÅÅ 
App
ÅÅ 
.
ÅÅ   
MainWindowInstance
ÅÅ  2
.
ÅÅ2 3
Content
ÅÅ3 :
.
ÅÅ: ;
XamlRoot
ÅÅ; C
}
ÆÆ 
;
ÆÆ 
await
ÇÇ  
_navigationService
ÇÇ %
.
ÇÇ% &
ShowDialogAsync
ÇÇ& 5
(
ÇÇ5 6
dialog
ÇÇ6 <
)
ÇÇ< =
;
ÇÇ= >
}
ÈÈ 	
finally
ÉÉ 
{
ÉÉ 
IsBusy
ÉÉ 
=
ÉÉ 
false
ÉÉ  
;
ÉÉ  !
}
ÉÉ" #
}
ÊÊ 
private
ÌÌ 
async
ÌÌ 
Task
ÌÌ 
LoadTicketAsync
ÌÌ &
(
ÌÌ& '
Guid
ÌÌ' +
ticketId
ÌÌ, 4
)
ÌÌ4 5
{
ÍÍ 
System
ÏÏ 
.
ÏÏ 
Diagnostics
ÏÏ 
.
ÏÏ 
Debug
ÏÏ  
.
ÏÏ  !
	WriteLine
ÏÏ! *
(
ÏÏ* +
$"
ÏÏ+ -
$str
ÏÏ- =
{
ÏÏ= >
ticketId
ÏÏ> F
}
ÏÏF G
"
ÏÏG H
)
ÏÏH I
;
ÏÏI J
Ticket
ÐÐ 
=
ÐÐ 
await
ÐÐ 
_getTicketHandler
ÐÐ (
.
ÐÐ( )
HandleAsync
ÐÐ) 4
(
ÐÐ4 5
new
ÐÐ5 8
GetTicketQuery
ÐÐ9 G
{
ÐÐH I
TicketId
ÐÐJ R
=
ÐÐS T
ticketId
ÐÐU ]
}
ÐÐ^ _
)
ÐÐ_ `
;
ÐÐ` a
if
ÒÒ 

(
ÒÒ 
Ticket
ÒÒ 
==
ÒÒ 
null
ÒÒ 
)
ÒÒ 
{
ÓÓ 	
throw
ÔÔ 
new
ÔÔ 
	Exception
ÔÔ 
(
ÔÔ  
$"
ÔÔ  "
$str
ÔÔ" )
{
ÔÔ) *
ticketId
ÔÔ* 2
}
ÔÔ2 3
$str
ÔÔ3 J
"
ÔÔJ K
)
ÔÔK L
;
ÔÔL M
}
ÕÕ 	
else
ÖÖ 
{
×× 	
System
ØØ 
.
ØØ 
Diagnostics
ØØ 
.
ØØ 
Debug
ØØ $
.
ØØ$ %
	WriteLine
ØØ% .
(
ØØ. /
$"
ØØ/ 1
$str
ØØ1 M
{
ØØM N
Ticket
ØØN T
.
ØØT U
TicketNumber
ØØU a
}
ØØa b
$str
ØØb h
{
ØØh i
Ticket
ØØi o
.
ØØo p

OrderLines
ØØp z
.
ØØz {
CountØØ{ €
}ØØ€ 
$strØØ ‡
"ØØ‡ ˆ
)ØØˆ ‰
;ØØ‰ Š
}
ÙÙ 	
}
ÚÚ 
private
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
AddItemAsync
ÜÜ #
(
ÜÜ# $
MenuItem
ÜÜ$ ,
?
ÜÜ, -
item
ÜÜ. 2
)
ÜÜ2 3
{
ÝÝ 
if
ÞÞ 

(
ÞÞ 
item
ÞÞ 
==
ÞÞ 
null
ÞÞ 
||
ÞÞ 
Ticket
ÞÞ "
==
ÞÞ# %
null
ÞÞ& *
)
ÞÞ* +
return
ÞÞ, 2
;
ÞÞ2 3
var
áá 
fullItem
áá 
=
áá 
await
áá 
_menuRepository
áá ,
.
áá, -
GetByIdAsync
áá- 9
(
áá9 :
item
áá: >
.
áá> ?
Id
áá? A
)
ááA B
;
ááB C
if
ââ 

(
ââ 
fullItem
ââ 
==
ââ 
null
ââ 
)
ââ 
return
ââ $
;
ââ$ %
List
ää 
<
ää 
MenuModifier
ää 
>
ää 
selectedModifiers
ää ,
=
ää- .
new
ää/ 2
(
ää2 3
)
ää3 4
;
ää4 5
Money
ææ 
effectivePrice
ææ 
=
ææ 
new
ææ "
Money
ææ# (
(
ææ( )
fullItem
ææ) 1
.
ææ1 2
Price
ææ2 7
.
ææ7 8
Amount
ææ8 >
,
ææ> ?
fullItem
ææ@ H
.
ææH I
Price
ææI N
.
ææN O
Currency
ææO W
)
ææW X
;
ææX Y
if
éé 

(
éé 
fullItem
éé 
.
éé 
IsVariablePrice
éé $
)
éé$ %
{
êê 	
var
ëë 
vm
ëë 
=
ëë 
new
ëë 
Magidesk
ëë !
.
ëë! "
Presentation
ëë" .
.
ëë. /

ViewModels
ëë/ 9
.
ëë9 :
Dialogs
ëë: A
.
ëëA B!
PriceEntryViewModel
ëëB U
(
ëëU V
fullItem
ëëV ^
.
ëë^ _
Name
ëë_ c
,
ëëc d
fullItem
ëëe m
.
ëëm n
Price
ëën s
.
ëës t
Amount
ëët z
)
ëëz {
;
ëë{ |
await
íí &
_orderEntryDialogService
íí *
.
íí* +!
ShowPriceEntryAsync
íí+ >
(
íí> ?
vm
íí? A
)
ííA B
;
ííB C
if
ïï 
(
ïï 
!
ïï 
vm
ïï 
.
ïï 
IsConfirmed
ïï 
)
ïï  
{
ðð 
return
ññ 
;
ññ 
}
òò 
effectivePrice
ôô 
=
ôô 
new
ôô  
Money
ôô! &
(
ôô& '
vm
ôô' )
.
ôô) *
Price
ôô* /
,
ôô/ 0
fullItem
ôô1 9
.
ôô9 :
Price
ôô: ?
.
ôô? @
Currency
ôô@ H
)
ôôH I
;
ôôI J
}
õõ 	
var
úú 
	sizeGroup
úú 
=
úú 
fullItem
úú  
.
úú  !
ModifierGroups
úú! /
.
ûû 
Select
ûû 
(
ûû 
mg
ûû 
=>
ûû 
mg
ûû 
.
ûû 
ModifierGroup
ûû *
)
ûû* +
.
üü 
FirstOrDefault
üü 
(
üü 
g
üü 
=>
üü  
g
üü! "
.
üü" #
IsActive
üü# +
&&
üü, .
g
üü/ 0
.
üü0 1
Name
üü1 5
.
üü5 6
Contains
üü6 >
(
üü> ?
$str
üü? E
,
üüE F
StringComparison
üüG W
.
üüW X
OrdinalIgnoreCase
üüX i
)
üüi j
)
üüj k
;
üük l
if
þþ 

(
þþ 
	sizeGroup
þþ 
!=
þþ 
null
þþ 
)
þþ 
{
ÿÿ 	
var
€	€	 
vm
€	€	 
=
€	€	 
new
€	€	 
Magidesk
€	€	 !
.
€	€	! "
Presentation
€	€	" .
.
€	€	. /

ViewModels
€	€	/ 9
.
€	€	9 :
Dialogs
€	€	: A
.
€	€	A B$
SizeSelectionViewModel
€	€	B X
(
€	€	X Y
	sizeGroup
€	€	Y b
)
€	€	b c
;
€	€	c d
await
‚	‚	 &
_orderEntryDialogService
‚	‚	 *
.
‚	‚	* +$
ShowSizeSelectionAsync
‚	‚	+ A
(
‚	‚	A B
vm
‚	‚	B D
)
‚	‚	D E
;
‚	‚	E F
if
„	„	 
(
„	„	 
vm
„	„	 
.
„	„	 
SelectedSize
„	„	 
!=
„	„	  "
null
„	„	# '
)
„	„	' (
{
…	…	 
selectedModifiers
†	†	 !
.
†	†	! "
Add
†	†	" %
(
†	†	% &
vm
†	†	& (
.
†	†	( )
SelectedSize
†	†	) 5
)
†	†	5 6
;
†	†	6 7
}
‡	‡	 
else
ˆ	ˆ	 
if
ˆ	ˆ	 
(
ˆ	ˆ	 
	sizeGroup
ˆ	ˆ	 
.
ˆ	ˆ	 

IsRequired
ˆ	ˆ	 )
||
ˆ	ˆ	* ,
	sizeGroup
ˆ	ˆ	- 6
.
ˆ	ˆ	6 7
MinSelections
ˆ	ˆ	7 D
>
ˆ	ˆ	E F
$num
ˆ	ˆ	G H
)
ˆ	ˆ	H I
{
‰	‰	 
return
‹	‹	 
;
‹	‹	 
}
Œ	Œ	 
}
		 	
var
’	’	 
category
’	’	 
=
’	’	 

Categories
’	’	 !
.
’	’	! "
FirstOrDefault
’	’	" 0
(
’	’	0 1
c
’	’	1 2
=>
’	’	3 5
c
’	’	6 7
.
’	’	7 8
Id
’	’	8 :
==
’	’	; =
fullItem
’	’	> F
.
’	’	F G

CategoryId
’	’	G Q
)
’	’	Q R
;
’	’	R S
bool
“	“	 

isBeverage
“	“	 
=
“	“	 
category
“	“	 "
?
“	“	" #
.
“	“	# $

IsBeverage
“	“	$ .
??
“	“	/ 1
false
“	“	2 7
;
“	“	7 8
if
˜	˜	 

(
˜	˜	 
!
˜	˜	 

isBeverage
˜	˜	 
)
˜	˜	 
{
™	™	 	
var
›	›	 
remainingGroups
›	›	 
=
›	›	  !
fullItem
›	›	" *
.
›	›	* +
ModifierGroups
›	›	+ 9
.
œ	œ	 
Where
œ	œ	 
(
œ	œ	 
mg
œ	œ	 
=>
œ	œ	 
mg
œ	œ	 
.
œ	œ	  
ModifierGroup
œ	œ	  -
!=
œ	œ	. 0
null
œ	œ	1 5
&&
œ	œ	6 8
mg
		 
.
		 
ModifierGroup
		 ,
.
		, -
IsActive
		- 5
&&
		6 8
mg
ž	ž	 
.
ž	ž	 
ModifierGroup
ž	ž	 ,
.
ž	ž	, -
Id
ž	ž	- /
!=
ž	ž	0 2
	sizeGroup
ž	ž	3 <
?
ž	ž	< =
.
ž	ž	= >
Id
ž	ž	> @
)
ž	ž	@ A
.
Ÿ	Ÿ	 
ToList
Ÿ	Ÿ	 
(
Ÿ	Ÿ	 
)
Ÿ	Ÿ	 
;
Ÿ	Ÿ	 
if
¡	¡	 
(
¡	¡	 
remainingGroups
¡	¡	 
.
¡	¡	  
Any
¡	¡	  #
(
¡	¡	# $
)
¡	¡	$ %
)
¡	¡	% &
{
¢	¢	 
var
¤	¤	 
tempLine
¤	¤	 
=
¤	¤	 
new
¤	¤	 "
OrderLineDto
¤	¤	# /
{
¥	¥	 

MenuItemId
¦	¦	 
=
¦	¦	  
fullItem
¦	¦	! )
.
¦	¦	) *
Id
¦	¦	* ,
,
¦	¦	, -
MenuItemName
§	§	  
=
§	§	! "
fullItem
§	§	# +
.
§	§	+ ,
Name
§	§	, 0
,
§	§	0 1
	Modifiers
¨	¨	 
=
¨	¨	 
selectedModifiers
¨	¨	  1
.
¨	¨	1 2
Select
¨	¨	2 8
(
¨	¨	8 9
m
¨	¨	9 :
=>
¨	¨	; =
new
¨	¨	> A"
OrderLineModifierDto
¨	¨	B V
{
©	©	 

ModifierId
ª	ª	 "
=
ª	ª	# $
m
ª	ª	% &
.
ª	ª	& '
Id
ª	ª	' )
,
ª	ª	) *
Name
«	«	 
=
«	«	 
m
«	«	  
.
«	«	  !
Name
«	«	! %
,
«	«	% &
ModifierType
¬	¬	 $
=
¬	¬	% &
ModifierType
¬	¬	' 3
.
¬	¬	3 4
Normal
¬	¬	4 :
,
¬	¬	: ;
	ItemCount
­	­	 !
=
­	­	" #
$num
­	­	$ %
,
­	­	% &
	UnitPrice
®	®	 !
=
®	®	" #
m
®	®	$ %
.
®	®	% &
	BasePrice
®	®	& /
.
®	®	/ 0
Amount
®	®	0 6
,
®	®	6 7
TaxRate
¯	¯	 
=
¯	¯	  !
$num
¯	¯	" #
,
¯	¯	# $"
ShouldPrintToKitchen
°	°	 ,
=
°	°	- .
true
°	°	/ 3
}
±	±	 
)
±	±	 
.
±	±	 
ToList
±	±	 
(
±	±	 
)
±	±	 
}
²	²	 
;
²	²	 
var
µ	µ	 
vm
µ	µ	 
=
µ	µ	 
new
µ	µ	 
Magidesk
µ	µ	 %
.
µ	µ	% &

ViewModels
µ	µ	& 0
.
µ	µ	0 1
Dialogs
µ	µ	1 8
.
µ	µ	8 9(
ModifierSelectionViewModel
µ	µ	9 S
(
µ	µ	S T
_menuRepository
µ	µ	T c
,
µ	µ	c d
tempLine
µ	µ	e m
)
µ	µ	m n
;
µ	µ	n o
await
·	·	 &
_orderEntryDialogService
·	·	 .
.
·	·	. /(
ShowModifierSelectionAsync
·	·	/ I
(
·	·	I J
vm
·	·	J L
)
·	·	L M
;
·	·	M N
if
¹	¹	 
(
¹	¹	 
vm
¹	¹	 
.
¹	¹	 
IsConfirmed
¹	¹	 "
)
¹	¹	" #
{
º	º	 
foreach
¼	¼	 
(
¼	¼	 
var
¼	¼	  
modifierDto
¼	¼	! ,
in
¼	¼	- /
vm
¼	¼	0 2
.
¼	¼	2 3
ResultModifiers
¼	¼	3 B
)
¼	¼	B C
{
½	½	 
if
¾	¾	 
(
¾	¾	 
modifierDto
¾	¾	 '
.
¾	¾	' (

ModifierId
¾	¾	( 2
.
¾	¾	2 3
HasValue
¾	¾	3 ;
)
¾	¾	; <
{
¿	¿	 
var
À	À	 
modifier
À	À	  (
=
À	À	) *
await
À	À	+ 0
_menuRepository
À	À	1 @
.
À	À	@ A"
GetModifierByIdAsync
À	À	A U
(
À	À	U V
modifierDto
À	À	V a
.
À	À	a b

ModifierId
À	À	b l
.
À	À	l m
Value
À	À	m r
)
À	À	r s
;
À	À	s t
if
Á	Á	 
(
Á	Á	  
modifier
Á	Á	  (
!=
Á	Á	) +
null
Á	Á	, 0
)
Á	Á	0 1
{
Â	Â	 
selectedModifiers
Ã	Ã	  1
.
Ã	Ã	1 2
Add
Ã	Ã	2 5
(
Ã	Ã	5 6
modifier
Ã	Ã	6 >
)
Ã	Ã	> ?
;
Ã	Ã	? @
}
Ä	Ä	 
}
Å	Å	 
}
Æ	Æ	 
}
Ç	Ç	 
else
È	È	 
if
È	È	 
(
È	È	 
remainingGroups
È	È	 (
.
È	È	( )
Any
È	È	) ,
(
È	È	, -
mg
È	È	- /
=>
È	È	0 2
mg
È	È	3 5
.
È	È	5 6
ModifierGroup
È	È	6 C
.
È	È	C D

IsRequired
È	È	D N
||
È	È	O Q
mg
È	È	R T
.
È	È	T U
ModifierGroup
È	È	U b
.
È	È	b c
MinSelections
È	È	c p
>
È	È	q r
$num
È	È	s t
)
È	È	t u
)
È	È	u v
{
É	É	 
return
Ë	Ë	 
;
Ë	Ë	 
}
Ì	Ì	 
}
Í	Í	 
}
Î	Î	 	
await
Ð	Ð	 "
_addOrderLineHandler
Ð	Ð	 "
.
Ð	Ð	" #
HandleAsync
Ð	Ð	# .
(
Ð	Ð	. /
new
Ð	Ð	/ 2!
AddOrderLineCommand
Ð	Ð	3 F
{
Ñ	Ñ	 	
TicketId
Ò	Ò	 
=
Ò	Ò	 
Ticket
Ò	Ò	 
.
Ò	Ò	 
Id
Ò	Ò	  
,
Ò	Ò	  !

MenuItemId
Ó	Ó	 
=
Ó	Ó	 
fullItem
Ó	Ó	 !
.
Ó	Ó	! "
Id
Ó	Ó	" $
,
Ó	Ó	$ %
MenuItemName
Ô	Ô	 
=
Ô	Ô	 
fullItem
Ô	Ô	 #
.
Ô	Ô	# $
Name
Ô	Ô	$ (
,
Ô	Ô	( )
Quantity
Õ	Õ	 
=
Õ	Õ	 
PendingQuantity
Õ	Õ	 &
,
Õ	Õ	& '
	UnitPrice
Ö	Ö	 
=
Ö	Ö	 
effectivePrice
Ö	Ö	 &
,
Ö	Ö	& '
TaxRate
×	×	 
=
×	×	 
fullItem
×	×	 
.
×	×	 
TaxRate
×	×	 &
,
×	×	& '
	Modifiers
Ø	Ø	 
=
Ø	Ø	 
selectedModifiers
Ø	Ø	 )
}
Ù	Ù	 	
)
Ù	Ù		 

;
Ù	Ù	
 
PendingQuantity
Ü	Ü	 
=
Ü	Ü	 
$num
Ü	Ü	 
;
Ü	Ü	 
await
Þ	Þ	 
LoadTicketAsync
Þ	Þ	 
(
Þ	Þ	 
Ticket
Þ	Þ	 $
.
Þ	Þ	$ %
Id
Þ	Þ	% '
)
Þ	Þ	' (
;
Þ	Þ	( )
if
á	á	 

(
á	á	 
fullItem
á	á	 
.
á	á	 
ComboDefinitionId
á	á	 &
.
á	á	& '
HasValue
á	á	' /
)
á	á	/ 0
{
â	â	 	
var
ä	ä	 
newOrderLine
ä	ä	 
=
ä	ä	 
Ticket
ä	ä	 %
?
ä	ä	% &
.
ä	ä	& '

OrderLines
ä	ä	' 1
.
å	å	 
OrderByDescending
å	å	 "
(
å	å	" #
ol
å	å	# %
=>
å	å	& (
ol
å	å	) +
.
å	å	+ ,
	CreatedAt
å	å	, 5
)
å	å	5 6
.
æ	æ	 
FirstOrDefault
æ	æ	 
(
æ	æ	  
ol
æ	æ	  "
=>
æ	æ	# %
ol
æ	æ	& (
.
æ	æ	( )

MenuItemId
æ	æ	) 3
==
æ	æ	4 6
fullItem
æ	æ	7 ?
.
æ	æ	? @
Id
æ	æ	@ B
)
æ	æ	B C
;
æ	æ	C D
if
è	è	 
(
è	è	 
newOrderLine
è	è	 
!=
è	è	 
null
è	è	  $
)
è	è	$ %
{
é	é	 
await
ê	ê	 !
ComboSelectionAsync
ê	ê	 )
(
ê	ê	) *
newOrderLine
ê	ê	* 6
)
ê	ê	6 7
;
ê	ê	7 8
}
ë	ë	 
}
ì	ì	 	
var
ð	ð	 
addOnCategory
ð	ð	 
=
ð	ð	 

Categories
ð	ð	 &
.
ð	ð	& '
FirstOrDefault
ð	ð	' 5
(
ð	ð	5 6
c
ð	ð	6 7
=>
ð	ð	8 :
c
ð	ð	; <
.
ð	ð	< =
Id
ð	ð	= ?
==
ð	ð	@ B
fullItem
ð	ð	C K
.
ð	ð	K L

CategoryId
ð	ð	L V
)
ð	ð	V W
;
ð	ð	W X
bool
ñ	ñ	 
isAddOnBeverage
ñ	ñ	 
=
ñ	ñ	 
addOnCategory
ñ	ñ	 ,
?
ñ	ñ	, -
.
ñ	ñ	- .

IsBeverage
ñ	ñ	. 8
??
ñ	ñ	9 ;
false
ñ	ñ	< A
;
ñ	ñ	A B
if
ó	ó	 

(
ó	ó	 
!
ó	ó	 
isAddOnBeverage
ó	ó	 
)
ó	ó	 
{
ô	ô	 	
var
ö	ö	 
addOnOrderLine
ö	ö	 
=
ö	ö	  
Ticket
ö	ö	! '
?
ö	ö	' (
.
ö	ö	( )

OrderLines
ö	ö	) 3
.
÷	÷	 
OrderByDescending
÷	÷	 "
(
÷	÷	" #
ol
÷	÷	# %
=>
÷	÷	& (
ol
÷	÷	) +
.
÷	÷	+ ,
	CreatedAt
÷	÷	, 5
)
÷	÷	5 6
.
ø	ø	 
FirstOrDefault
ø	ø	 
(
ø	ø	  
ol
ø	ø	  "
=>
ø	ø	# %
ol
ø	ø	& (
.
ø	ø	( )

MenuItemId
ø	ø	) 3
==
ø	ø	4 6
fullItem
ø	ø	7 ?
.
ø	ø	? @
Id
ø	ø	@ B
)
ø	ø	B C
;
ø	ø	C D
if
ú	ú	 
(
ú	ú	 
addOnOrderLine
ú	ú	 
!=
ú	ú	 !
null
ú	ú	" &
)
ú	ú	& '
{
û	û	 
await
ü	ü	 !
AddOnSelectionAsync
ü	ü	 )
(
ü	ü	) *
addOnOrderLine
ü	ü	* 8
)
ü	ü	8 9
;
ü	ü	9 :
}
ý	ý	 
}
þ	þ	 	
}
ÿ	ÿ	 
private


 
async


 
Task


 
SearchItemAsync


 &
(


& '
)


' (
{
‚
‚
 
if
ƒ
ƒ
 

(
ƒ
ƒ
 
Ticket
ƒ
ƒ
 
==
ƒ
ƒ
 
null
ƒ
ƒ
 
)
ƒ
ƒ
 
return
ƒ
ƒ
 "
;
ƒ
ƒ
" #
IsBusy
…
…
 
=
…
…
 
true
…
…
 
;
…
…
 
try
†
†
 
{
‡
‡
 	
var
ˆ
ˆ
 
vm
ˆ
ˆ
 
=
ˆ
ˆ
 
new
ˆ
ˆ
 
Magidesk
ˆ
ˆ
 !
.
ˆ
ˆ
! "
Presentation
ˆ
ˆ
" .
.
ˆ
ˆ
. /

ViewModels
ˆ
ˆ
/ 9
.
ˆ
ˆ
9 :
Dialogs
ˆ
ˆ
: A
.
ˆ
ˆ
A B!
ItemSearchViewModel
ˆ
ˆ
B U
(
ˆ
ˆ
U V
_menuRepository
ˆ
ˆ
V e
)
ˆ
ˆ
e f
;
ˆ
ˆ
f g
if
Œ
Œ
 
(
Œ
Œ
 
!
Œ
Œ
 
string
Œ
Œ
 
.
Œ
Œ
  
IsNullOrWhiteSpace
Œ
Œ
 *
(
Œ
Œ
* +

SearchText
Œ
Œ
+ 5
)
Œ
Œ
5 6
)
Œ
Œ
6 7
{


 
vm
Ž
Ž
 
.
Ž
Ž
 

SearchText
Ž
Ž
 
=
Ž
Ž
 

SearchText
Ž
Ž
  *
;
Ž
Ž
* +
}


 
await
‘
‘
 &
_orderEntryDialogService
‘
‘
 *
.
‘
‘
* +!
ShowItemSearchAsync
‘
‘
+ >
(
‘
‘
> ?
vm
‘
‘
? A
)
‘
‘
A B
;
‘
‘
B C
if
“
“
 
(
“
“
 
vm
“
“
 
.
“
“
 
SelectedItem
“
“
 
!=
“
“
  "
null
“
“
# '
)
“
“
' (
{
”
”
 
await
•
•
 
AddItemAsync
•
•
 "
(
•
•
" #
vm
•
•
# %
.
•
•
% &
SelectedItem
•
•
& 2
)
•
•
2 3
;
•
•
3 4

SearchText
–
–
 
=
–
–
 
string
–
–
 #
.
–
–
# $
Empty
–
–
$ )
;
–
–
) *
}
—
—
 
}
˜
˜
 	
catch
™
™
 
(
™
™
 
	Exception
™
™
 
ex
™
™
 
)
™
™
 
{
š
š
 	
System
›
›
 
.
›
›
 
Diagnostics
›
›
 
.
›
›
  
Debug
›
›
  %
.
›
›
% &
	WriteLine
›
›
& /
(
›
›
/ 0
$"
›
›
0 2
$str
›
›
2 G
{
›
›
G H
ex
›
›
H J
.
›
›
J K
Message
›
›
K R
}
›
›
R S
"
›
›
S T
)
›
›
T U
;
›
›
U V
}
œ
œ
 	
finally


 
{


 
IsBusy


 
=


 
false


  
;


  !
}


" #
}
ž
ž
 
private
 
 
 
async
 
 
 
Task
 
 
 $
IncrementQuantityAsync
 
 
 -
(
 
 
- .
OrderLineDto
 
 
. :
?
 
 
: ;
line
 
 
< @
)
 
 
@ A
{
¡
¡
 
if
¢
¢
 

(
¢
¢
 
line
¢
¢
 
==
¢
¢
 
null
¢
¢
 
||
¢
¢
 
Ticket
¢
¢
 "
==
¢
¢
# %
null
¢
¢
& *
)
¢
¢
* +
return
¢
¢
, 2
;
¢
¢
2 3
if
¥
¥
 

(
¥
¥
 
line
¥
¥
 
.
¥
¥
 
PrintedToKitchen
¥
¥
 !
)
¥
¥
! "
{
¦
¦
 	
return
¨
¨
 
;
¨
¨
 
}
©
©
 	
await
«
«
 !
ModifyQuantityAsync
«
«
 !
(
«
«
! "
line
«
«
" &
,
«
«
& '
line
«
«
( ,
.
«
«
, -
Quantity
«
«
- 5
+
«
«
6 7
$num
«
«
8 9
)
«
«
9 :
;
«
«
: ;
}
¬
¬
 
private
®
®
 
async
®
®
 
Task
®
®
 $
DecrementQuantityAsync
®
®
 -
(
®
®
- .
OrderLineDto
®
®
. :
?
®
®
: ;
line
®
®
< @
)
®
®
@ A
{
¯
¯
 
if
°
°
 

(
°
°
 
line
°
°
 
==
°
°
 
null
°
°
 
||
°
°
 
Ticket
°
°
 "
==
°
°
# %
null
°
°
& *
)
°
°
* +
return
°
°
, 2
;
°
°
2 3
if
³
³
 

(
³
³
 
line
³
³
 
.
³
³
 
PrintedToKitchen
³
³
 !
)
³
³
! "
{
´
´
 	
return
µ
µ
 
;
µ
µ
 
}
¶
¶
 	
if
¸
¸
 

(
¸
¸
 
line
¸
¸
 
.
¸
¸
 
Quantity
¸
¸
 
>
¸
¸
 
$num
¸
¸
 
)
¸
¸
 
{
¹
¹
 	
await
º
º
 !
ModifyQuantityAsync
º
º
 %
(
º
º
% &
line
º
º
& *
,
º
º
* +
line
º
º
, 0
.
º
º
0 1
Quantity
º
º
1 9
-
º
º
: ;
$num
º
º
< =
)
º
º
= >
;
º
º
> ?
}
»
»
 	
else
¼
¼
 
{
½
½
 	
}
Á
Á
 	
}
Â
Â
 
private
Ä
Ä
 
async
Ä
Ä
 
Task
Ä
Ä
 !
ModifyQuantityAsync
Ä
Ä
 *
(
Ä
Ä
* +
OrderLineDto
Ä
Ä
+ 7
line
Ä
Ä
8 <
,
Ä
Ä
< =
decimal
Ä
Ä
> E
newQuantity
Ä
Ä
F Q
)
Ä
Ä
Q R
{
Å
Å
 
IsBusy
Æ
Æ
 
=
Æ
Æ
 
true
Æ
Æ
 
;
Æ
Æ
 
try
Ç
Ç
 
{
È
È
 	
await
É
É
 %
_modifyOrderLineHandler
É
É
 )
.
É
É
) *
HandleAsync
É
É
* 5
(
É
É
5 6
new
É
É
6 9$
ModifyOrderLineCommand
É
É
: P
{
Ê
Ê
 
TicketId
Ë
Ë
 
=
Ë
Ë
 
Ticket
Ë
Ë
 !
!
Ë
Ë
! "
.
Ë
Ë
" #
Id
Ë
Ë
# %
,
Ë
Ë
% &
OrderLineId
Ì
Ì
 
=
Ì
Ì
 
line
Ì
Ì
 "
.
Ì
Ì
" #
Id
Ì
Ì
# %
,
Ì
Ì
% &
Quantity
Í
Í
 
=
Í
Í
 
newQuantity
Í
Í
 &
}
Î
Î
 
)
Î
Î
 
;
Î
Î
 
await
Ï
Ï
 
LoadTicketAsync
Ï
Ï
 !
(
Ï
Ï
! "
Ticket
Ï
Ï
" (
.
Ï
Ï
( )
Id
Ï
Ï
) +
)
Ï
Ï
+ ,
;
Ï
Ï
, -
}
Ð
Ð
 	
catch
Ñ
Ñ
 
(
Ñ
Ñ
 
	Exception
Ñ
Ñ
 
ex
Ñ
Ñ
 
)
Ñ
Ñ
 
{
Ò
Ò
 	
System
Ó
Ó
 
.
Ó
Ó
 
Diagnostics
Ó
Ó
 
.
Ó
Ó
 
Debug
Ó
Ó
 $
.
Ó
Ó
$ %
	WriteLine
Ó
Ó
% .
(
Ó
Ó
. /
$"
Ó
Ó
/ 1
$str
Ó
Ó
1 C
{
Ó
Ó
C D
ex
Ó
Ó
D F
.
Ó
Ó
F G
Message
Ó
Ó
G N
}
Ó
Ó
N O
"
Ó
Ó
O P
)
Ó
Ó
P Q
;
Ó
Ó
Q R
}
Ô
Ô
 	
finally
Õ
Õ
 
{
Õ
Õ
 
IsBusy
Õ
Õ
 
=
Õ
Õ
 
false
Õ
Õ
  
;
Õ
Õ
  !
}
Õ
Õ
" #
}
Ö
Ö
 
private
Ø
Ø
 
async
Ø
Ø
 
Task
Ø
Ø
 
SetQuantityAsync
Ø
Ø
 '
(
Ø
Ø
' (
)
Ø
Ø
( )
{
Ù
Ù
 
var
Ú
Ú
 
dialog
Ú
Ú
 
=
Ú
Ú
 
new
Ú
Ú
 
Magidesk
Ú
Ú
 !
.
Ú
Ú
! "
Views
Ú
Ú
" '
.
Ú
Ú
' (
QuantityDialog
Ú
Ú
( 6
(
Ú
Ú
6 7
)
Ú
Ú
7 8
;
Ú
Ú
8 9
dialog
à
à
 
.
à
à
 
XamlRoot
à
à
 
=
à
à
 
App
à
à
 
.
à
à
  
MainWindowInstance
à
à
 0
.
à
à
0 1
Content
à
à
1 8
.
à
à
8 9
XamlRoot
à
à
9 A
;
à
à
A B
var
á
á
 
result
á
á
 
=
á
á
 
await
á
á
 
dialog
á
á
 !
.
á
á
! "
	ShowAsync
á
á
" +
(
á
á
+ ,
)
á
á
, -
;
á
á
- .
if
ã
ã
 

(
ã
ã
 
result
ã
ã
 
==
ã
ã
 !
ContentDialogResult
ã
ã
 )
.
ã
ã
) *
Primary
ã
ã
* 1
)
ã
ã
1 2
{
ä
ä
 	
PendingQuantity
å
å
 
=
å
å
 
dialog
å
å
 $
.
å
å
$ %
	ViewModel
å
å
% .
.
å
å
. /
ResultQuantity
å
å
/ =
;
å
å
= >
}
æ
æ
 	
}
ç
ç
 
private
é
é
 
async
é
é
 
Task
é
é
 
RemoveItemAsync
é
é
 &
(
é
é
& '
OrderLineDto
é
é
' 3
?
é
é
3 4
line
é
é
5 9
)
é
é
9 :
{
ê
ê
 
if
ë
ë
 

(
ë
ë
 
line
ë
ë
 
==
ë
ë
 
null
ë
ë
 
||
ë
ë
 
Ticket
ë
ë
 "
==
ë
ë
# %
null
ë
ë
& *
)
ë
ë
* +
return
ë
ë
, 2
;
ë
ë
2 3
if
î
î
 

(
î
î
 
line
î
î
 
.
î
î
 
PrintedToKitchen
î
î
 !
)
î
î
! "
{
ï
ï
 	
return
ñ
ñ
 
;
ñ
ñ
 
}
ò
ò
 	
IsBusy
ô
ô
 
=
ô
ô
 
true
ô
ô
 
;
ô
ô
 
try
õ
õ
 
{
ö
ö
 	
await
÷
÷
 %
_removeOrderLineHandler
÷
÷
 *
.
÷
÷
* +
HandleAsync
÷
÷
+ 6
(
÷
÷
6 7
new
÷
÷
7 :$
RemoveOrderLineCommand
÷
÷
; Q
{
ø
ø
 
TicketId
ù
ù
 
=
ù
ù
 
Ticket
ù
ù
 "
.
ù
ù
" #
Id
ù
ù
# %
,
ù
ù
% &
OrderLineId
ú
ú
 
=
ú
ú
 
line
ú
ú
 #
.
ú
ú
# $
Id
ú
ú
$ &
}
û
û
 
)
û
û
 
;
û
û
 
await
ü
ü
 
LoadTicketAsync
ü
ü
 "
(
ü
ü
" #
Ticket
ü
ü
# )
.
ü
ü
) *
Id
ü
ü
* ,
)
ü
ü
, -
;
ü
ü
- .
}
ý
ý
 	
catch
þ
þ
 
(
þ
þ
 
	Exception
þ
þ
 
ex
þ
þ
 
)
þ
þ
 
{
ÿ
ÿ
 	
System
€€ 
.
€€ 
Diagnostics
€€ 
.
€€  
Debug
€€  %
.
€€% &
	WriteLine
€€& /
(
€€/ 0
$"
€€0 2
$str
€€2 E
{
€€E F
ex
€€F H
.
€€H I
Message
€€I P
}
€€P Q
"
€€Q R
)
€€R S
;
€€S T
}
 	
finally
‚‚ 
{
‚‚ 
IsBusy
‚‚ 
=
‚‚ 
false
‚‚  
;
‚‚  !
}
‚‚" #
}
ƒƒ 
private
…… 
async
…… 
Task
…… 
SettleAsync
…… "
(
……" #
)
……# $
{
†† 
if
‡‡ 

(
‡‡ 
Ticket
‡‡ 
==
‡‡ 
null
‡‡ 
)
‡‡ 
return
‡‡ "
;
‡‡" # 
_navigationService
ŠŠ 
.
ŠŠ 
Navigate
ŠŠ #
(
ŠŠ# $
typeof
ŠŠ$ *
(
ŠŠ* +
Magidesk
ŠŠ+ 3
.
ŠŠ3 4
Presentation
ŠŠ4 @
.
ŠŠ@ A
Views
ŠŠA F
.
ŠŠF G

SettlePage
ŠŠG Q
)
ŠŠQ R
,
ŠŠR S
Ticket
ŠŠT Z
.
ŠŠZ [
Id
ŠŠ[ ]
)
ŠŠ] ^
;
ŠŠ^ _
}
‹‹ 
private
 
async
 
Task
 
QuickPayAsync
 $
(
$ %
)
% &
{
ŽŽ 
if
 

(
 
Ticket
 
==
 
null
 
)
 
return
 "
;
" #
if
 

(
 
Ticket
 
.
 
	DueAmount
 
<=
 
$num
  !
)
! "
return
# )
;
) *
IsBusy
’’ 
=
’’ 
true
’’ 
;
’’ 
try
““ 
{
”” 	
var
•• 
result
•• 
=
•• 
await
•• 
_payNowHandler
•• -
.
••- .
HandleAsync
••. 9
(
••9 :
new
••: =
PayNowCommand
••> K
{
–– 
TicketId
—— 
=
—— 
Ticket
—— !
.
——! "
Id
——" $
,
——$ %
ProcessedBy
˜˜ 
=
˜˜ 
_userService
˜˜ *
.
˜˜* +
CurrentUser
˜˜+ 6
!
˜˜6 7
.
˜˜7 8
Id
˜˜8 :
,
˜˜: ;

TerminalId
™™ 
=
™™ 
_terminalContext
™™ -
.
™™- .

TerminalId
™™. 8
!
™™8 9
.
™™9 :
Value
™™: ?
}
šš 
)
šš 
;
šš 
if
œœ 
(
œœ 
!
œœ 
result
œœ 
.
œœ 
Success
œœ 
)
œœ  
{
 
var
žž 
dialog
žž 
=
žž 
new
žž  
	Microsoft
žž! *
.
žž* +
UI
žž+ -
.
žž- .
Xaml
žž. 2
.
žž2 3
Controls
žž3 ;
.
žž; <
ContentDialog
žž< I
{
ŸŸ 
Title
   
=
   
$str
   .
,
  . /
Content
¡¡ 
=
¡¡ 
$"
¡¡  
$str
¡¡  I
{
¡¡I J
result
¡¡J P
.
¡¡P Q
Message
¡¡Q X
}
¡¡X Y
"
¡¡Y Z
,
¡¡Z [
CloseButtonText
¢¢ #
=
¢¢$ %
$str
¢¢& *
,
¢¢* +
XamlRoot
££ 
=
££ 
App
££ "
.
££" # 
MainWindowInstance
££# 5
.
££5 6
Content
££6 =
.
££= >
XamlRoot
££> F
}
¤¤ 
;
¤¤ 
await
¥¥  
_navigationService
¥¥ (
.
¥¥( )
ShowDialogAsync
¥¥) 8
(
¥¥8 9
dialog
¥¥9 ?
)
¥¥? @
;
¥¥@ A
return
¦¦ 
;
¦¦ 
}
§§  
_navigationService
«« 
.
«« 
Navigate
«« '
(
««' (
typeof
««( .
(
««. /
Magidesk
««/ 7
.
««7 8
Presentation
««8 D
.
««D E
Views
««E J
.
««J K
SwitchboardPage
««K Z
)
««Z [
)
««[ \
;
««\ ]
}
¬¬ 	
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­ 
{
®® 	
System
¯¯ 
.
¯¯ 
Diagnostics
¯¯ 
.
¯¯ 
Debug
¯¯ $
.
¯¯$ %
	WriteLine
¯¯% .
(
¯¯. /
$"
¯¯/ 1
$str
¯¯1 B
{
¯¯B C
ex
¯¯C E
.
¯¯E F
Message
¯¯F M
}
¯¯M N
"
¯¯N O
)
¯¯O P
;
¯¯P Q
var
±± 
dialog
±± 
=
±± 
new
±± 
	Microsoft
±± '
.
±±' (
UI
±±( *
.
±±* +
Xaml
±±+ /
.
±±/ 0
Controls
±±0 8
.
±±8 9
ContentDialog
±±9 F
{
²² 
Title
³³ 
=
³³ 
$str
³³ '
,
³³' (
Content
´´ 
=
´´ 
$"
´´ 
$str
´´ ?
{
´´? @
ex
´´@ B
.
´´B C
Message
´´C J
}
´´J K
"
´´K L
,
´´L M
CloseButtonText
µµ  
=
µµ! "
$str
µµ# '
,
µµ' (
XamlRoot
¶¶ 
=
¶¶ 
App
¶¶ 
.
¶¶   
MainWindowInstance
¶¶  2
.
¶¶2 3
Content
¶¶3 :
.
¶¶: ;
XamlRoot
¶¶; C
}
·· 
;
·· 
await
¸¸  
_navigationService
¸¸ %
.
¸¸% &
ShowDialogAsync
¸¸& 5
(
¸¸5 6
dialog
¸¸6 <
)
¸¸< =
;
¸¸= >
}
¹¹ 	
finally
ºº 
{
»» 	
IsBusy
¼¼ 
=
¼¼ 
false
¼¼ 
;
¼¼ 
}
½½ 	
}
¾¾ 
private
¿¿ 
bool
¿¿ 
_fromTableMap
¿¿ 
;
¿¿ 
public
ÁÁ 

void
ÁÁ "
SetNavigationContext
ÁÁ $
(
ÁÁ$ %)
OrderEntryNavigationContext
ÁÁ% @
context
ÁÁA H
)
ÁÁH I
{
ÂÂ 
_fromTableMap
ÃÃ 
=
ÃÃ 
context
ÃÃ 
.
ÃÃ  
FromTableMap
ÃÃ  ,
;
ÃÃ, -
}
ÄÄ 
[
ÆÆ 
RelayCommand
ÆÆ 
]
ÆÆ 
private
ÇÇ 
void
ÇÇ 
Close
ÇÇ 
(
ÇÇ 
)
ÇÇ 
{
ÈÈ 
if
ÉÉ 

(
ÉÉ 
_fromTableMap
ÉÉ 
)
ÉÉ 
{
ÊÊ 	 
_navigationService
ËË 
.
ËË 
Navigate
ËË '
(
ËË' (
typeof
ËË( .
(
ËË. /
Magidesk
ËË/ 7
.
ËË7 8
Presentation
ËË8 D
.
ËËD E
Views
ËËE J
.
ËËJ K
TableMapPage
ËËK W
)
ËËW X
)
ËËX Y
;
ËËY Z
}
ÌÌ 	
else
ÍÍ 
{
ÎÎ 	 
_navigationService
ÏÏ 
.
ÏÏ 
GoBack
ÏÏ %
(
ÏÏ% &
)
ÏÏ& '
;
ÏÏ' (
}
ÐÐ 	
}
ÑÑ 
}ÒÒ 
publicÔÔ 
record
ÔÔ )
OrderEntryNavigationContext
ÔÔ )
(
ÔÔ) *
Guid
ÔÔ* .
?
ÔÔ. /
TicketId
ÔÔ0 8
,
ÔÔ8 9
bool
ÔÔ: >
FromTableMap
ÔÔ? K
=
ÔÔL M
false
ÔÔN S
)
ÔÔS T
;
ÔÔT UÀ~
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\OpenTicketsListViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class $
OpenTicketsListViewModel %
:& '
ViewModelBase( 5
{ 
private 
readonly 
IQueryHandler "
<" #
GetOpenTicketsQuery# 6
,6 7
IEnumerable8 C
<C D
	TicketDtoD M
>M N
>N O"
_getOpenTicketsHandlerP f
;f g
private 
readonly 
IQueryHandler "
<" #
GetUsersQuery# 0
,0 1
IEnumerable2 =
<= >
UserDto> E
>E F
>F G
_getUsersHandlerH X
;X Y
private 
readonly 
ICommandHandler $
<$ %!
TransferTicketCommand% :
>: ;"
_transferTicketHandler< R
;R S
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly 
IUserService !
_userService" .
;. /
private  
ObservableCollection  
<  !
	TicketDto! *
>* +
_tickets, 4
=5 6
new7 :
(: ;
); <
;< =
public 
 
ObservableCollection 
<  
	TicketDto  )
>) *
Tickets+ 2
{ 
get 
=> 
_tickets 
; 
set 
=> 
SetProperty 
( 
ref 
_tickets '
,' (
value) .
). /
;/ 0
}   
private"" 
	TicketDto"" 
?"" 
_selectedTicket"" &
;""& '
public## 

	TicketDto## 
?## 
SelectedTicket## $
{$$ 
get%% 
=>%% 
_selectedTicket%% 
;%% 
set&& 
{'' 	
if(( 
((( 
SetProperty(( 
((( 
ref(( 
_selectedTicket((  /
,((/ 0
value((1 6
)((6 7
)((7 8
{)) 
(** 
(** 
AsyncRelayCommand** #
)**# $
ResumeCommand**$ 1
)**1 2
.**2 3#
NotifyCanExecuteChanged**3 J
(**J K
)**K L
;**L M
(++ 
(++ 
AsyncRelayCommand++ #
)++# $
TransferCommand++$ 3
)++3 4
.++4 5#
NotifyCanExecuteChanged++5 L
(++L M
)++M N
;++N O
(,, 
(,, 
AsyncRelayCommand,, #
),,# $
VoidCommand,,$ /
),,/ 0
.,,0 1#
NotifyCanExecuteChanged,,1 H
(,,H I
),,I J
;,,J K
}-- 
}.. 	
}// 
private11  
ObservableCollection11  
<11  !
UserDto11! (
>11( )
_users11* 0
=111 2
new113 6
(116 7
)117 8
;118 9
public22 
 
ObservableCollection22 
<22  
UserDto22  '
>22' (
Users22) .
{33 
get44 
=>44 
_users44 
;44 
set55 
=>55 
SetProperty55 
(55 
ref55 
_users55 %
,55% &
value55' ,
)55, -
;55- .
}66 
private88 
UserDto88 
?88 
_selectedUser88 "
;88" #
public99 

UserDto99 
?99 
SelectedUser99  
{:: 
get;; 
=>;; 
_selectedUser;; 
;;; 
set<< 
=><< 
SetProperty<< 
(<< 
ref<< 
_selectedUser<< ,
,<<, -
value<<. 3
)<<3 4
;<<4 5
}== 
public?? 

ICommand?? 
ResumeCommand?? !
{??" #
get??$ '
;??' (
}??) *
public@@ 

ICommand@@ 
TransferCommand@@ #
{@@$ %
get@@& )
;@@) *
}@@+ ,
publicAA 

ICommandAA 
VoidCommandAA 
{AA  !
getAA" %
;AA% &
}AA' (
publicBB 

ICommandBB 
SplitCommandBB  
{BB! "
getBB# &
;BB& '
}BB( )
publicCC 

ICommandCC 
CloseCommandCC  
{CC! "
getCC# &
;CC& '
}CC( )
publicEE 
$
OpenTicketsListViewModelEE #
(EE# $
IQueryHandlerFF 
<FF 
GetOpenTicketsQueryFF )
,FF) *
IEnumerableFF+ 6
<FF6 7
	TicketDtoFF7 @
>FF@ A
>FFA B!
getOpenTicketsHandlerFFC X
,FFX Y
IQueryHandlerGG 
<GG 
GetUsersQueryGG #
,GG# $
IEnumerableGG% 0
<GG0 1
UserDtoGG1 8
>GG8 9
>GG9 :
getUsersHandlerGG; J
,GGJ K
ICommandHandlerHH 
<HH !
TransferTicketCommandHH -
>HH- .!
transferTicketHandlerHH/ D
,HHD E
NavigationServiceII 
navigationServiceII +
,II+ ,
IUserServiceJJ 
userServiceJJ  
)JJ  !
{KK "
_getOpenTicketsHandlerLL 
=LL  !
getOpenTicketsHandlerLL! 6
;LL6 7
_getUsersHandlerMM 
=MM 
getUsersHandlerMM *
;MM* +"
_transferTicketHandlerNN 
=NN  !
transferTicketHandlerNN! 6
;NN6 7
_navigationServiceOO 
=OO 
navigationServiceOO .
;OO. /
_userServicePP 
=PP 
userServicePP "
;PP" #
ResumeCommandRR 
=RR 
newRR 
AsyncRelayCommandRR -
(RR- .
ResumeAsyncRR. 9
,RR9 :
(RR; <
)RR< =
=>RR> @
SelectedTicketRRA O
!=RRP R
nullRRS W
)RRW X
;RRX Y
TransferCommandSS 
=SS 
newSS 
AsyncRelayCommandSS /
(SS/ 0
TransferAsyncSS0 =
,SS= >
(SS? @
)SS@ A
=>SSB D
SelectedTicketSSE S
!=SST V
nullSSW [
)SS[ \
;SS\ ]
VoidCommandTT 
=TT 
newTT 
AsyncRelayCommandTT +
(TT+ ,
	VoidAsyncTT, 5
,TT5 6
(TT7 8
)TT8 9
=>TT: <
SelectedTicketTT= K
!=TTL N
nullTTO S
)TTS T
;TTT U
SplitCommandUU 
=UU 
newUU 
AsyncRelayCommandUU ,
(UU, -

SplitAsyncUU- 7
,UU7 8
(UU9 :
)UU: ;
=>UU< >
SelectedTicketUU? M
!=UUN P
nullUUQ U
)UUU V
;UUV W
CloseCommandVV 
=VV 
newVV 
RelayCommandVV '
(VV' (
CloseVV( -
)VV- .
;VV. /
_XX 	
=XX
 
LoadDataAsyncXX 
(XX 
)XX 
;XX 
}YY 
private[[ 
async[[ 
Task[[ 
LoadDataAsync[[ $
([[$ %
)[[% &
{\\ 
var]] 
tickets]] 
=]] 
await]] "
_getOpenTicketsHandler]] 2
.]]2 3
HandleAsync]]3 >
(]]> ?
new]]? B
GetOpenTicketsQuery]]C V
(]]V W
)]]W X
)]]X Y
;]]Y Z
Tickets^^ 
=^^ 
new^^  
ObservableCollection^^ *
<^^* +
	TicketDto^^+ 4
>^^4 5
(^^5 6
tickets^^6 =
)^^= >
;^^> ?
var`` 
users`` 
=`` 
await`` 
_getUsersHandler`` *
.``* +
HandleAsync``+ 6
(``6 7
new``7 :
GetUsersQuery``; H
(``H I
)``I J
)``J K
;``K L
Usersaa 
=aa 
newaa  
ObservableCollectionaa (
<aa( )
UserDtoaa) 0
>aa0 1
(aa1 2
usersaa2 7
)aa7 8
;aa8 9
}bb 
privatedd 
asyncdd 
Taskdd 
ResumeAsyncdd "
(dd" #
)dd# $
{ee 
ifff 

(ff 
SelectedTicketff 
!=ff 
nullff "
)ff" #
{gg 	
_navigationServicehh 
.hh 
Navigatehh '
(hh' (
typeofhh( .
(hh. /
Viewshh/ 4
.hh4 5
OrderEntryPagehh5 C
)hhC D
,hhD E
SelectedTickethhF T
.hhT U
IdhhU W
)hhW X
;hhX Y
}jj 	
}kk 
privatemm 
asyncmm 
Taskmm 
TransferAsyncmm $
(mm$ %
)mm% &
{nn 
ifoo 

(oo 
SelectedTicketoo 
==oo 
nulloo "
)oo" #
returnoo$ *
;oo* +
varss 

userDialogss 
=ss 
newss 
ContentDialogss *
{tt 	
Titleuu 
=uu 
$struu %
,uu% &
PrimaryButtonTextvv 
=vv 
$strvv  *
,vv* +
CloseButtonTextww 
=ww 
$strww &
,ww& '
DefaultButtonxx 
=xx 
ContentDialogButtonxx /
.xx/ 0
Primaryxx0 7
,xx7 8
XamlRootyy 
=yy 
Appyy 
.yy 
MainWindowInstanceyy -
.yy- .
Contentyy. 5
.yy5 6
XamlRootyy6 >
}zz 	
;zz	 

var|| 

stackPanel|| 
=|| 
new|| 

StackPanel|| '
{||( )
Spacing||* 1
=||2 3
$num||4 6
}||7 8
;||8 9
var}} 
	userCombo}} 
=}} 
new}} 
ComboBox}} $
{~~ 	
Header 
= 
$str '
,' (
ItemsSource
€€ 
=
€€ 
Users
€€ 
,
€€  
DisplayMemberPath
 
=
 
$str
  *
,
* +!
HorizontalAlignment
‚‚ 
=
‚‚  !
	Microsoft
‚‚" +
.
‚‚+ ,
UI
‚‚, .
.
‚‚. /
Xaml
‚‚/ 3
.
‚‚3 4!
HorizontalAlignment
‚‚4 G
.
‚‚G H
Stretch
‚‚H O
}
ƒƒ 	
;
ƒƒ	 


stackPanel
„„ 
.
„„ 
Children
„„ 
.
„„ 
Add
„„ 
(
„„  
	userCombo
„„  )
)
„„) *
;
„„* +

userDialog
…… 
.
…… 
Content
…… 
=
…… 

stackPanel
…… '
;
……' (
var
‡‡ 
result
‡‡ 
=
‡‡ 
await
‡‡  
_navigationService
‡‡ -
.
‡‡- .
ShowDialogAsync
‡‡. =
(
‡‡= >

userDialog
‡‡> H
)
‡‡H I
;
‡‡I J
if
‰‰ 

(
‰‰ 
result
‰‰ 
==
‰‰ !
ContentDialogResult
‰‰ )
.
‰‰) *
Primary
‰‰* 1
&&
‰‰2 4
	userCombo
‰‰5 >
.
‰‰> ?
SelectedItem
‰‰? K
is
‰‰L N
UserDto
‰‰O V
selectedUser
‰‰W c
)
‰‰c d
{
ŠŠ 	
try
‹‹ 
{
ŒŒ 
if
 
(
 
_userService
  
.
  !
CurrentUser
! ,
?
, -
.
- .
Id
. 0
==
1 3
null
4 8
)
8 9
{
ŽŽ 
return
 
;
 
}
 
var
’’ 
command
’’ 
=
’’ 
new
’’ !#
TransferTicketCommand
’’" 7
{
““ 
TicketId
”” 
=
”” 
SelectedTicket
”” -
.
””- .
Id
””. 0
,
””0 1

NewOwnerId
•• 
=
••  
new
••! $
UserId
••% +
(
••+ ,
selectedUser
••, 8
.
••8 9
Id
••9 ;
)
••; <
,
••< =
TransferredBy
–– !
=
––" #
_userService
––$ 0
.
––0 1
CurrentUser
––1 <
.
––< =
Id
––= ?
}
—— 
;
—— 
await
™™ $
_transferTicketHandler
™™ ,
.
™™, -
HandleAsync
™™- 8
(
™™8 9
command
™™9 @
)
™™@ A
;
™™A B
await
šš 
LoadDataAsync
šš #
(
šš# $
)
šš$ %
;
šš% &
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
System
ŸŸ 
.
ŸŸ 
Diagnostics
ŸŸ "
.
ŸŸ" #
Debug
ŸŸ# (
.
ŸŸ( )
	WriteLine
ŸŸ) 2
(
ŸŸ2 3
$"
ŸŸ3 5
$str
ŸŸ5 E
{
ŸŸE F
ex
ŸŸF H
.
ŸŸH I
Message
ŸŸI P
}
ŸŸP Q
"
ŸŸQ R
)
ŸŸR S
;
ŸŸS T
}
   
}
¡¡ 	
}
¢¢ 
private
¤¤ 
async
¤¤ 
Task
¤¤ 
	VoidAsync
¤¤  
(
¤¤  !
)
¤¤! "
{
¥¥ 
if
¦¦ 

(
¦¦ 
SelectedTicket
¦¦ 
==
¦¦ 
null
¦¦ "
)
¦¦" #
return
¦¦$ *
;
¦¦* +
var
¨¨ 
dialog
¨¨ 
=
¨¨ 
new
¨¨ 
Views
¨¨ 
.
¨¨ 
VoidTicketDialog
¨¨ /
(
¨¨/ 0
)
¨¨0 1
;
¨¨1 2
dialog
©© 
.
©© 
XamlRoot
©© 
=
©© 
App
©© 
.
©©  
MainWindowInstance
©© 0
.
©©0 1
Content
©©1 8
.
©©8 9
XamlRoot
©©9 A
;
©©A B
dialog
ªª 
.
ªª 
	ViewModel
ªª 
.
ªª 

Initialize
ªª #
(
ªª# $
SelectedTicket
ªª$ 2
)
ªª2 3
;
ªª3 4
await
««  
_navigationService
««  
.
««  !
ShowDialogAsync
««! 0
(
««0 1
dialog
««1 7
)
««7 8
;
««8 9
await
®® 
LoadDataAsync
®® 
(
®® 
)
®® 
;
®® 
}
¯¯ 
private
±± 
async
±± 
Task
±± 

SplitAsync
±± !
(
±±! "
)
±±" #
{
²² 
if
³³ 

(
³³ 
SelectedTicket
³³ 
==
³³ 
null
³³ "
)
³³" #
return
³³$ *
;
³³* +
var
µµ 
dialog
µµ 
=
µµ 
new
µµ 
SplitTicketDialog
µµ *
(
µµ* +
)
µµ+ ,
;
µµ, -
dialog
¶¶ 
.
¶¶ 
XamlRoot
¶¶ 
=
¶¶ 
App
¶¶ 
.
¶¶  
MainWindowInstance
¶¶ 0
.
¶¶0 1
Content
¶¶1 8
.
¶¶8 9
XamlRoot
¶¶9 A
;
¶¶A B
dialog
·· 
.
·· 
	ViewModel
·· 
.
·· 

Initialize
·· #
(
··# $
SelectedTicket
··$ 2
)
··2 3
;
··3 4
await
¸¸  
_navigationService
¸¸  
.
¸¸  !
ShowDialogAsync
¸¸! 0
(
¸¸0 1
dialog
¸¸1 7
)
¸¸7 8
;
¸¸8 9
await
»» 
LoadDataAsync
»» 
(
»» 
)
»» 
;
»» 
}
¼¼ 
private
¾¾ 
void
¾¾ 
Close
¾¾ 
(
¾¾ 
)
¾¾ 
{
¿¿ 
}
ÁÁ 
}ÂÂ øQ
nC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\ModifierSelectionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class &
ModifierSelectionViewModel '
:( )
ViewModelBase* 7
{ 
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
MenuItem 
? 
	_menuItem 
;  
private 
string 
? 
_validationError $
;$ %
public 
 
ObservableCollection 
<  "
ModifierGroupViewModel  6
>6 7
ModifierGroups8 F
{G H
getI L
;L M
}N O
=P Q
newR U
(U V
)V W
;W X
public 

string 
? 
ValidationError "
{ 
get 
=> 
_validationError 
;  
set 
{ 
SetProperty 
( 
ref 
_validationError .
,. /
value0 5
)5 6
;6 7
OnPropertyChanged8 I
(I J
nameofJ P
(P Q
HasValidationErrorQ c
)c d
)d e
;e f
}g h
} 
public 

bool 
HasValidationError "
=># %
!& '
string' -
.- .
IsNullOrEmpty. ;
(; <
ValidationError< K
)K L
;L M
public 
&
ModifierSelectionViewModel %
(% &
IMenuRepository& 5
menuRepository6 D
)D E
{ 
_menuRepository 
= 
menuRepository (
;( )
}   
public"" 

void"" 
LoadModifiers"" 
("" 
MenuItem"" &
menuItem""' /
)""/ 0
{## 
	_menuItem$$ 
=$$ 
menuItem$$ 
;$$ 
ModifierGroups%% 
.%% 
Clear%% 
(%% 
)%% 
;%% 
var(( 
groups(( 
=(( 
menuItem(( 
.(( 
ModifierGroups(( ,
.)) 
Select)) 
()) 
mg)) 
=>)) 
mg)) 
.)) 
ModifierGroup)) *
)))* +
.** 
OrderBy** 
(** 
g** 
=>** 
g** 
.** 
DisplayOrder** (
)**( )
;**) *
foreach,, 
(,, 
var,, 
group,, 
in,, 
groups,, $
),,$ %
{-- 	
if.. 
(.. 
group.. 
... 
IsActive.. 
).. 
{// 
ModifierGroups00 
.00 
Add00 "
(00" #
new00# &"
ModifierGroupViewModel00' =
(00= >
group00> C
)00C D
)00D E
;00E F
}11 
}22 	
}33 
public55 

bool55 
ValidateSelections55 "
(55" #
)55# $
{66 
ValidationError77 
=77 
null77 
;77 
foreach88 
(88 
var88 
groupVm88 
in88 
ModifierGroups88  .
)88. /
{99 	
var:: 
selectedCount:: 
=:: 
groupVm::  '
.::' (
	Modifiers::( 1
.::1 2
Count::2 7
(::7 8
m::8 9
=>::: <
m::= >
.::> ?

IsSelected::? I
)::I J
;::J K
if<< 
(<< 
groupVm<< 
.<< 
Group<< 
.<< 

IsRequired<< (
&&<<) +
selectedCount<<, 9
<<<: ;
groupVm<<< C
.<<C D
Group<<D I
.<<I J
MinSelections<<J W
)<<W X
{== 
ValidationError>> 
=>>  !
$">>" $
{>>$ %
groupVm>>% ,
.>>, -
Group>>- 2
.>>2 3
Name>>3 7
}>>7 8
$str>>8 K
{>>K L
groupVm>>L S
.>>S T
Group>>T Y
.>>Y Z
MinSelections>>Z g
}>>g h
$str>>h v
">>v w
;>>w x
return?? 
false?? 
;?? 
}@@ 
ifBB 
(BB 
selectedCountBB 
>BB 
groupVmBB  '
.BB' (
GroupBB( -
.BB- .
MaxSelectionsBB. ;
)BB; <
{CC 
ValidationErrorEE  
=EE! "
$"EE# %
{EE% &
groupVmEE& -
.EE- .
GroupEE. 3
.EE3 4
NameEE4 8
}EE8 9
$strEE9 E
{EEE F
groupVmEEF M
.EEM N
GroupEEN S
.EES T
MaxSelectionsEET a
}EEa b
$strEEb p
"EEp q
;EEq r
returnFF 
falseFF 
;FF 
}GG 
}HH 	
returnII 
trueII 
;II 
}JJ 
publicLL 

ListLL 
<LL 
MenuModifierLL 
>LL  
GetSelectedModifiersLL 2
(LL2 3
)LL3 4
{MM 
returnNN 
ModifierGroupsNN 
.OO 

SelectManyOO 
(OO 
gOO 
=>OO 
gOO 
.OO 
	ModifiersOO (
)OO( )
.PP 
WherePP 
(PP 
mPP 
=>PP 
mPP 
.PP 

IsSelectedPP $
)PP$ %
.QQ 
SelectQQ 
(QQ 
mQQ 
=>QQ 
mQQ 
.QQ 
ModifierQQ #
)QQ# $
.RR 
ToListRR 
(RR 
)RR 
;RR 
}SS 
}TT 
publicVV 
classVV "
ModifierGroupViewModelVV #
:VV$ %
ViewModelBaseVV& 3
{WW 
publicXX 

ModifierGroupXX 
GroupXX 
{XX  
getXX! $
;XX$ %
}XX& '
publicYY 
 
ObservableCollectionYY 
<YY  
ModifierViewModelYY  1
>YY1 2
	ModifiersYY3 <
{YY= >
getYY? B
;YYB C
}YYD E
=YYF G
newYYH K
(YYK L
)YYL M
;YYM N
public[[ 
"
ModifierGroupViewModel[[ !
([[! "
ModifierGroup[[" /
group[[0 5
)[[5 6
{\\ 
Group]] 
=]] 
group]] 
;]] 
foreach^^ 
(^^ 
var^^ 
modifier^^ 
in^^  
group^^! &
.^^& '
	Modifiers^^' 0
.^^0 1
Where^^1 6
(^^6 7
m^^7 8
=>^^9 ;
m^^< =
.^^= >
IsActive^^> F
)^^F G
.^^G H
OrderBy^^H O
(^^O P
m^^P Q
=>^^R T
m^^U V
.^^V W
DisplayOrder^^W c
)^^c d
)^^d e
{__ 	
	Modifiers`` 
.`` 
Add`` 
(`` 
new`` 
ModifierViewModel`` /
(``/ 0
modifier``0 8
,``8 9
this``: >
)``> ?
)``? @
;``@ A
}aa 	
}bb 
publicdd 

voiddd &
OnModifierSelectionChangeddd *
(dd* +
ModifierViewModeldd+ <
changedModifierdd= L
)ddL M
{ee 
ifgg 

(gg 
Groupgg 
.gg 
MaxSelectionsgg 
==gg  "
$numgg# $
&&gg% '
changedModifiergg( 7
.gg7 8

IsSelectedgg8 B
)ggB C
{hh 	
foreachii 
(ii 
varii 
modii 
inii 
	Modifiersii  )
)ii) *
{jj 
ifkk 
(kk 
modkk 
!=kk 
changedModifierkk *
&&kk+ -
modkk. 1
.kk1 2

IsSelectedkk2 <
)kk< =
{ll 
modmm 
.mm 

IsSelectedmm "
=mm# $
falsemm% *
;mm* +
}nn 
}oo 
}pp 	
}qq 
}rr 
publictt 
classtt 
ModifierViewModeltt 
:tt  
ViewModelBasett! .
{uu 
privatevv 
boolvv 
_isSelectedvv 
;vv 
privateww 
readonlyww "
ModifierGroupViewModelww +
_parentGroupww, 8
;ww8 9
publicyy 

MenuModifieryy 
Modifieryy  
{yy! "
getyy# &
;yy& '
}yy( )
public{{ 

bool{{ 

IsSelected{{ 
{|| 
get}} 
=>}} 
_isSelected}} 
;}} 
set~~ 
{ 	
if
€€ 
(
€€ 
SetProperty
€€ 
(
€€ 
ref
€€ 
_isSelected
€€  +
,
€€+ ,
value
€€- 2
)
€€2 3
)
€€3 4
{
 
_parentGroup
‚‚ 
.
‚‚ (
OnModifierSelectionChanged
‚‚ 7
(
‚‚7 8
this
‚‚8 <
)
‚‚< =
;
‚‚= >
}
ƒƒ 
}
„„ 	
}
…… 
public
‡‡ 

string
‡‡ 
DisplayName
‡‡ 
=>
‡‡  
$"
‡‡! #
{
‡‡# $
Modifier
‡‡$ ,
.
‡‡, -
Name
‡‡- 1
}
‡‡1 2
$str
‡‡2 5
{
‡‡5 6
Modifier
‡‡6 >
.
‡‡> ?
	BasePrice
‡‡? H
}
‡‡H I
$str
‡‡I J
"
‡‡J K
;
‡‡K L
public
‰‰ 

ModifierViewModel
‰‰ 
(
‰‰ 
MenuModifier
‰‰ )
modifier
‰‰* 2
,
‰‰2 3$
ModifierGroupViewModel
‰‰4 J
parentGroup
‰‰K V
)
‰‰V W
{
ŠŠ 
Modifier
‹‹ 
=
‹‹ 
modifier
‹‹ 
;
‹‹ 
_parentGroup
ŒŒ 
=
ŒŒ 
parentGroup
ŒŒ "
;
ŒŒ" #
}
 
}ŽŽ ã¬
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\ModifierEditorViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
;		* +
public 
class #
ModifierEditorViewModel $
:% &
ViewModelBase' 4
{ 
private 
readonly $
IModifierGroupRepository -
_groupRepository. >
;> ?
private 
readonly #
IMenuModifierRepository ,
_modifierRepository- @
;@ A
private 
ModifierGroup 
? 
_selectedGroup )
;) *
private 
MenuModifier 
? 
_selectedModifier +
;+ ,
private 
string 
_editingName 
=  !
string" (
.( )
Empty) .
;. /
private 
string 
_editingPrice  
=! "
$str# )
;) *
private 
bool 
_isGroupRequired !
;! "
private 
int 
	_groupMin 
= 
$num 
; 
private 
int 
	_groupMax 
= 
$num 
; 
private 
bool 
_groupMultiSelect "
;" #
public 

string 
EditingName 
{ 
get 
=> 
_editingName 
; 
set   
=>   
SetProperty   
(   
ref   
_editingName   +
,  + ,
value  - 2
)  2 3
;  3 4
}!! 
public## 

string## 
EditingPrice## 
{$$ 
get%% 
=>%% 
_editingPrice%% 
;%% 
set&& 
=>&& 
SetProperty&& 
(&& 
ref&& 
_editingPrice&& ,
,&&, -
value&&. 3
)&&3 4
;&&4 5
}'' 
public** 

bool** 
IsGroupRequired** 
{++ 
get,, 
=>,, 
_isGroupRequired,, 
;,,  
set-- 
=>-- 
SetProperty-- 
(-- 
ref-- 
_isGroupRequired-- /
,--/ 0
value--1 6
)--6 7
;--7 8
}.. 
public00 

int00 
GroupMin00 
{11 
get22 
=>22 
	_groupMin22 
;22 
set33 
=>33 
SetProperty33 
(33 
ref33 
	_groupMin33 (
,33( )
value33* /
)33/ 0
;330 1
}44 
public66 

int66 
GroupMax66 
{77 
get88 
=>88 
	_groupMax88 
;88 
set99 
=>99 
SetProperty99 
(99 
ref99 
	_groupMax99 (
,99( )
value99* /
)99/ 0
;990 1
}:: 
public<< 

bool<< 
GroupMultiSelect<<  
{== 
get>> 
=>>> 
_groupMultiSelect>>  
;>>  !
set?? 
=>?? 
SetProperty?? 
(?? 
ref?? 
_groupMultiSelect?? 0
,??0 1
value??2 7
)??7 8
;??8 9
}@@ 
privateBB 
stringBB 
_statusMessageBB !
=BB" #
$strBB$ +
;BB+ ,
publicCC 

stringCC 
StatusMessageCC 
{DD 
getEE 
=>EE 
_statusMessageEE 
;EE 
setFF 
=>FF 
SetPropertyFF 
(FF 
refFF 
_statusMessageFF -
,FF- .
valueFF/ 4
)FF4 5
;FF5 6
}GG 
privateII 
boolII 

_isEditingII 
;II 
publicJJ 

boolJJ 
	IsEditingJJ 
{KK 
getLL 
=>LL 

_isEditingLL 
;LL 
setMM 
=>MM 
SetPropertyMM 
(MM 
refMM 

_isEditingMM )
,MM) *
valueMM+ 0
)MM0 1
;MM1 2
}NN 
publicPP 
 
ObservableCollectionPP 
<PP  
ModifierGroupPP  -
>PP- .
GroupsPP/ 5
{PP6 7
getPP8 ;
;PP; <
}PP= >
=PP? @
newPPA D
(PPD E
)PPE F
;PPF G
publicQQ 
 
ObservableCollectionQQ 
<QQ  
MenuModifierQQ  ,
>QQ, -
	ModifiersQQ. 7
{QQ8 9
getQQ: =
;QQ= >
}QQ? @
=QQA B
newQQC F
(QQF G
)QQG H
;QQH I
publicSS 

ModifierGroupSS 
?SS 
SelectedGroupSS '
{TT 
getUU 
=>UU 
_selectedGroupUU 
;UU 
setVV 
{WW 	
ifXX 
(XX 
SetPropertyXX 
(XX 
refXX 
_selectedGroupXX  .
,XX. /
valueXX0 5
)XX5 6
)XX6 7
{YY 
SelectedModifierZZ  
=ZZ! "
nullZZ# '
;ZZ' (
	Modifiers[[ 
.[[ 
Clear[[ 
([[  
)[[  !
;[[! "
if]] 
(]] 
value]] 
!=]] 
null]] !
)]]! "
{^^ 
	IsEditing__ 
=__ 
true__  $
;__$ %
EditingName`` 
=``  !
value``" '
.``' (
Name``( ,
;``, -
IsGroupRequiredaa #
=aa$ %
valueaa& +
.aa+ ,

IsRequiredaa, 6
;aa6 7
GroupMinbb 
=bb 
valuebb $
.bb$ %
MinSelectionsbb% 2
;bb2 3
GroupMaxcc 
=cc 
valuecc $
.cc$ %
MaxSelectionscc% 2
;cc2 3
GroupMultiSelectdd $
=dd% &
valuedd' ,
.dd, -#
AllowMultipleSelectionsdd- D
;ddD E
StatusMessageff !
=ff" #
$"ff$ &
$strff& 5
{ff5 6
valueff6 ;
.ff; <
Nameff< @
}ff@ A
"ffA B
;ffB C
_gg 
=gg 
LoadModifiersAsyncgg *
(gg* +
valuegg+ 0
.gg0 1
Idgg1 3
)gg3 4
;gg4 5
}hh 
elseii 
{jj 
	IsEditingkk 
=kk 
falsekk  %
;kk% &
StatusMessagell !
=ll" #
$strll$ +
;ll+ ,
}mm 
}nn 
}oo 	
}pp 
publicrr 

MenuModifierrr 
?rr 
SelectedModifierrr )
{ss 
gettt 
=>tt 
_selectedModifiertt  
;tt  !
setuu 
{vv 	
ifww 
(ww 
SetPropertyww 
(ww 
refww 
_selectedModifierww  1
,ww1 2
valueww3 8
)ww8 9
)ww9 :
{xx 
ifyy 
(yy 
valueyy 
!=yy 
nullyy !
)yy! "
{zz 
	IsEditing{{ 
={{ 
true{{  $
;{{$ %
EditingName|| 
=||  !
value||" '
.||' (
Name||( ,
;||, -
EditingPrice}}  
=}}! "
value}}# (
.}}( )
	BasePrice}}) 2
.}}2 3
Amount}}3 9
.}}9 :
ToString}}: B
(}}B C
$str}}C G
)}}G H
;}}H I
StatusMessage~~ !
=~~" #
$"~~$ &
$str~~& 8
{~~8 9
value~~9 >
.~~> ?
Name~~? C
}~~C D
"~~D E
;~~E F
} 
else
€€ 
if
€€ 
(
€€ 
SelectedGroup
€€ &
!=
€€' )
null
€€* .
)
€€. /
{
 
EditingName
ƒƒ 
=
ƒƒ  !
SelectedGroup
ƒƒ" /
.
ƒƒ/ 0
Name
ƒƒ0 4
;
ƒƒ4 5
StatusMessage
„„ !
=
„„" #
$"
„„$ &
$str
„„& 5
{
„„5 6
SelectedGroup
„„6 C
.
„„C D
Name
„„D H
}
„„H I
"
„„I J
;
„„J K
}
…… 
}
†† 
}
‡‡ 	
}
ˆˆ 
public
ŠŠ 

ICommand
ŠŠ 
LoadDataCommand
ŠŠ #
{
ŠŠ$ %
get
ŠŠ& )
;
ŠŠ) *
}
ŠŠ+ ,
public
‹‹ 

ICommand
‹‹ 
AddGroupCommand
‹‹ #
{
‹‹$ %
get
‹‹& )
;
‹‹) *
}
‹‹+ ,
public
ŒŒ 

ICommand
ŒŒ  
AddModifierCommand
ŒŒ &
{
ŒŒ' (
get
ŒŒ) ,
;
ŒŒ, -
}
ŒŒ. /
public
 

ICommand
 
SaveCommand
 
{
  !
get
" %
;
% &
}
' (
public
ŽŽ 

ICommand
ŽŽ 
DeleteCommand
ŽŽ !
{
ŽŽ" #
get
ŽŽ$ '
;
ŽŽ' (
}
ŽŽ) *
public
 
%
ModifierEditorViewModel
 "
(
" #&
IModifierGroupRepository
‘‘  
groupRepository
‘‘! 0
,
‘‘0 1%
IMenuModifierRepository
’’  
modifierRepository
’’  2
)
’’2 3
{
““ 
_groupRepository
”” 
=
”” 
groupRepository
”” *
;
””* +!
_modifierRepository
•• 
=
••  
modifierRepository
•• 0
;
••0 1
Title
–– 
=
–– 
$str
–– !
;
––! "
LoadDataCommand
˜˜ 
=
˜˜ 
new
˜˜ 
AsyncRelayCommand
˜˜ /
(
˜˜/ 0
LoadDataAsync
˜˜0 =
)
˜˜= >
;
˜˜> ?
AddGroupCommand
™™ 
=
™™ 
new
™™ 
AsyncRelayCommand
™™ /
(
™™/ 0
AddGroupAsync
™™0 =
)
™™= >
;
™™> ? 
AddModifierCommand
šš 
=
šš 
new
šš  
AsyncRelayCommand
šš! 2
(
šš2 3
AddModifierAsync
šš3 C
)
ššC D
;
ššD E
SaveCommand
›› 
=
›› 
new
›› 
AsyncRelayCommand
›› +
(
››+ ,
	SaveAsync
››, 5
)
››5 6
;
››6 7
DeleteCommand
œœ 
=
œœ 
new
œœ 
AsyncRelayCommand
œœ -
(
œœ- .
DeleteAsync
œœ. 9
)
œœ9 :
;
œœ: ;
}
 
private
ŸŸ 
async
ŸŸ 
Task
ŸŸ 
LoadDataAsync
ŸŸ $
(
ŸŸ$ %
)
ŸŸ% &
{
   
IsBusy
¡¡ 
=
¡¡ 
true
¡¡ 
;
¡¡ 
try
¢¢ 
{
££ 	
Groups
¤¤ 
.
¤¤ 
Clear
¤¤ 
(
¤¤ 
)
¤¤ 
;
¤¤ 
var
¥¥ 
groups
¥¥ 
=
¥¥ 
await
¥¥ 
_groupRepository
¥¥ /
.
¥¥/ 0
GetAllAsync
¥¥0 ;
(
¥¥; <
)
¥¥< =
;
¥¥= >
foreach
¦¦ 
(
¦¦ 
var
¦¦ 
g
¦¦ 
in
¦¦ 
groups
¦¦ $
)
¦¦$ %
Groups
¦¦& ,
.
¦¦, -
Add
¦¦- 0
(
¦¦0 1
g
¦¦1 2
)
¦¦2 3
;
¦¦3 4
}
§§ 	
finally
¨¨ 
{
¨¨ 
IsBusy
¨¨ 
=
¨¨ 
false
¨¨  
;
¨¨  !
}
¨¨" #
}
©© 
private
«« 
async
«« 
Task
««  
LoadModifiersAsync
«« )
(
««) *
Guid
««* .
groupId
««/ 6
)
««6 7
{
¬¬ 
IsBusy
­­ 
=
­­ 
true
­­ 
;
­­ 
try
®® 
{
¯¯ 	
var
°° 
mods
°° 
=
°° 
await
°° !
_modifierRepository
°° 0
.
°°0 1
GetByGroupIdAsync
°°1 B
(
°°B C
groupId
°°C J
)
°°J K
;
°°K L
	Modifiers
±± 
.
±± 
Clear
±± 
(
±± 
)
±± 
;
±± 
foreach
²² 
(
²² 
var
²² 
m
²² 
in
²² 
mods
²² "
)
²²" #
	Modifiers
²²$ -
.
²²- .
Add
²². 1
(
²²1 2
m
²²2 3
)
²²3 4
;
²²4 5
}
³³ 	
finally
´´ 
{
´´ 
IsBusy
´´ 
=
´´ 
false
´´  
;
´´  !
}
´´" #
}
µµ 
private
·· 
async
·· 
Task
·· 
AddGroupAsync
·· $
(
··$ %
)
··% &
{
¸¸ 
IsBusy
¹¹ 
=
¹¹ 
true
¹¹ 
;
¹¹ 
try
ºº 
{
»» 	
var
¼¼ 
newGroup
¼¼ 
=
¼¼ 
ModifierGroup
¼¼ (
.
¼¼( )
Create
¼¼) /
(
¼¼/ 0
$str
¼¼0 ;
)
¼¼; <
;
¼¼< =
await
½½ 
_groupRepository
½½ "
.
½½" #
AddAsync
½½# +
(
½½+ ,
newGroup
½½, 4
)
½½4 5
;
½½5 6
Groups
¾¾ 
.
¾¾ 
Add
¾¾ 
(
¾¾ 
newGroup
¾¾ 
)
¾¾  
;
¾¾  !
SelectedGroup
¿¿ 
=
¿¿ 
newGroup
¿¿ $
;
¿¿$ %
StatusMessage
ÀÀ 
=
ÀÀ 
$str
ÀÀ )
;
ÀÀ) *
}
ÁÁ 	
finally
ÂÂ 
{
ÂÂ 
IsBusy
ÂÂ 
=
ÂÂ 
false
ÂÂ  
;
ÂÂ  !
}
ÂÂ" #
}
ÃÃ 
private
ÅÅ 
async
ÅÅ 
Task
ÅÅ 
AddModifierAsync
ÅÅ '
(
ÅÅ' (
)
ÅÅ( )
{
ÆÆ 
if
ÇÇ 

(
ÇÇ 
SelectedGroup
ÇÇ 
==
ÇÇ 
null
ÇÇ !
)
ÇÇ! "
return
ÇÇ# )
;
ÇÇ) *
IsBusy
ÉÉ 
=
ÉÉ 
true
ÉÉ 
;
ÉÉ 
try
ÊÊ 
{
ËË 	
var
ÌÌ 
newMod
ÌÌ 
=
ÌÌ 
MenuModifier
ÌÌ %
.
ÌÌ% &
Create
ÌÌ& ,
(
ÌÌ, -
$str
ÌÌ- ;
,
ÌÌ; <
ModifierType
ÌÌ= I
.
ÌÌI J
Normal
ÌÌJ P
,
ÌÌP Q
Money
ÌÌR W
.
ÌÌW X
Zero
ÌÌX \
(
ÌÌ\ ]
)
ÌÌ] ^
,
ÌÌ^ _
SelectedGroup
ÌÌ` m
.
ÌÌm n
Id
ÌÌn p
)
ÌÌp q
;
ÌÌq r
await
ÍÍ !
_modifierRepository
ÍÍ %
.
ÍÍ% &
AddAsync
ÍÍ& .
(
ÍÍ. /
newMod
ÍÍ/ 5
)
ÍÍ5 6
;
ÍÍ6 7
	Modifiers
ÎÎ 
.
ÎÎ 
Add
ÎÎ 
(
ÎÎ 
newMod
ÎÎ  
)
ÎÎ  !
;
ÎÎ! "
SelectedModifier
ÏÏ 
=
ÏÏ 
newMod
ÏÏ %
;
ÏÏ% &
StatusMessage
ÐÐ 
=
ÐÐ 
$str
ÐÐ ,
;
ÐÐ, -
}
ÑÑ 	
finally
ÒÒ 
{
ÒÒ 
IsBusy
ÒÒ 
=
ÒÒ 
false
ÒÒ  
;
ÒÒ  !
}
ÒÒ" #
}
ÓÓ 
private
ÕÕ 
async
ÕÕ 
Task
ÕÕ 
	SaveAsync
ÕÕ  
(
ÕÕ  !
)
ÕÕ! "
{
ÖÖ 
IsBusy
×× 
=
×× 
true
×× 
;
×× 
try
ØØ 
{
ÙÙ 	
if
ÚÚ 
(
ÚÚ 
SelectedModifier
ÚÚ  
!=
ÚÚ! #
null
ÚÚ$ (
)
ÚÚ( )
{
ÛÛ 
SelectedModifier
ÜÜ  
.
ÜÜ  !

UpdateName
ÜÜ! +
(
ÜÜ+ ,
EditingName
ÜÜ, 7
)
ÜÜ7 8
;
ÜÜ8 9
if
ÝÝ 
(
ÝÝ 
decimal
ÝÝ 
.
ÝÝ 
TryParse
ÝÝ $
(
ÝÝ$ %
EditingPrice
ÝÝ% 1
,
ÝÝ1 2
out
ÝÝ3 6
var
ÝÝ7 :
price
ÝÝ; @
)
ÝÝ@ A
)
ÝÝA B
{
ÞÞ 
SelectedModifier
ßß $
.
ßß$ %
UpdateBasePrice
ßß% 4
(
ßß4 5
new
ßß5 8
Money
ßß9 >
(
ßß> ?
price
ßß? D
)
ßßD E
)
ßßE F
;
ßßF G
}
àà 
await
áá !
_modifierRepository
áá )
.
áá) *
UpdateAsync
áá* 5
(
áá5 6
SelectedModifier
áá6 F
)
ááF G
;
ááG H
StatusMessage
ââ 
=
ââ 
$str
ââ  0
;
ââ0 1
}
ãã 
else
ää 
if
ää 
(
ää 
SelectedGroup
ää "
!=
ää# %
null
ää& *
)
ää* +
{
åå 
SelectedGroup
ææ 
.
ææ 

UpdateName
ææ (
(
ææ( )
EditingName
ææ) 4
)
ææ4 5
;
ææ5 6
SelectedGroup
çç 
.
çç 
SetIsRequired
çç +
(
çç+ ,
IsGroupRequired
çç, ;
)
çç; <
;
çç< =
try
èè 
{
èè 
SelectedGroup
éé !
.
éé! "(
UpdateSelectionConstraints
éé" <
(
éé< =
GroupMin
éé= E
,
ééE F
GroupMax
ééG O
,
ééO P
GroupMultiSelect
ééQ a
)
ééa b
;
ééb c
}
êê 
catch
êê 
(
êê 
	Exception
êê "
ex
êê# %
)
êê% &
{
êê' (
StatusMessage
ëë !
=
ëë" #
$"
ëë$ &
$str
ëë& 8
{
ëë8 9
ex
ëë9 ;
.
ëë; <
Message
ëë< C
}
ëëC D
"
ëëD E
;
ëëE F
return
ìì 
;
ìì 
}
íí 
await
ïï 
_groupRepository
ïï &
.
ïï& '
UpdateAsync
ïï' 2
(
ïï2 3
SelectedGroup
ïï3 @
)
ïï@ A
;
ïïA B
StatusMessage
ðð 
=
ðð 
$str
ðð  -
;
ðð- .
}
ññ 
}
òò 	
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó 
{
ôô 	
StatusMessage
õõ 
=
õõ 
$"
õõ 
$str
õõ %
{
õõ% &
ex
õõ& (
.
õõ( )
Message
õõ) 0
}
õõ0 1
"
õõ1 2
;
õõ2 3
}
öö 	
finally
÷÷ 
{
÷÷ 
IsBusy
÷÷ 
=
÷÷ 
false
÷÷  
;
÷÷  !
}
÷÷" #
}
øø 
private
úú 
async
úú 
Task
úú 
DeleteAsync
úú "
(
úú" #
)
úú# $
{
ûû 
IsBusy
üü 
=
üü 
true
üü 
;
üü 
try
ýý 
{
þþ 	
if
ÿÿ 
(
ÿÿ 
SelectedModifier
ÿÿ  
!=
ÿÿ! #
null
ÿÿ$ (
)
ÿÿ( )
{
€€ 
var
 
mod
 
=
 
SelectedModifier
 *
;
* +
await
‚‚ !
_modifierRepository
‚‚ )
.
‚‚) *
DeleteAsync
‚‚* 5
(
‚‚5 6
mod
‚‚6 9
.
‚‚9 :
Id
‚‚: <
)
‚‚< =
;
‚‚= >
	Modifiers
ƒƒ 
.
ƒƒ 
Remove
ƒƒ  
(
ƒƒ  !
mod
ƒƒ! $
)
ƒƒ$ %
;
ƒƒ% &
SelectedModifier
„„  
=
„„! "
null
„„# '
;
„„' (
StatusMessage
…… 
=
…… 
$str
……  3
;
……3 4
return
†† 
;
†† 
}
‡‡ 
if
‰‰ 
(
‰‰ 
SelectedGroup
‰‰ 
!=
‰‰  
null
‰‰! %
)
‰‰% &
{
ŠŠ 
var
‹‹ 
grp
‹‹ 
=
‹‹ 
SelectedGroup
‹‹ '
;
‹‹' (
var
 
mods
 
=
 
await
  !
_modifierRepository
! 4
.
4 5
GetByGroupIdAsync
5 F
(
F G
grp
G J
.
J K
Id
K M
)
M N
;
N O
foreach
ŽŽ 
(
ŽŽ 
var
ŽŽ 
m
ŽŽ 
in
ŽŽ !
mods
ŽŽ" &
.
ŽŽ& '
ToList
ŽŽ' -
(
ŽŽ- .
)
ŽŽ. /
)
ŽŽ/ 0
{
 
await
 !
_modifierRepository
 -
.
- .
DeleteAsync
. 9
(
9 :
m
: ;
.
; <
Id
< >
)
> ?
;
? @
}
‘‘ 
await
““ 
_groupRepository
““ &
.
““& '
DeleteAsync
““' 2
(
““2 3
grp
““3 6
.
““6 7
Id
““7 9
)
““9 :
;
““: ;
Groups
•• 
.
•• 
Remove
•• 
(
•• 
grp
•• !
)
••! "
;
••" #
	Modifiers
–– 
.
–– 
Clear
–– 
(
––  
)
––  !
;
––! "
SelectedModifier
——  
=
——! "
null
——# '
;
——' (
SelectedGroup
˜˜ 
=
˜˜ 
null
˜˜  $
;
˜˜$ %
StatusMessage
™™ 
=
™™ 
$str
™™  0
;
™™0 1
}
šš 
}
›› 	
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ 
{
 	
StatusMessage
žž 
=
žž 
$"
žž 
$str
žž -
{
žž- .
ex
žž. 0
.
žž0 1
Message
žž1 8
}
žž8 9
"
žž9 :
;
žž: ;
}
ŸŸ 	
finally
   
{
¡¡ 	
IsBusy
¢¢ 
=
¢¢ 
false
¢¢ 
;
¢¢ 
}
££ 	
}
¤¤ 
}¥¥ ­
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\MiscItemViewModel.cs
	namespace 	
Magidesk
 
. 

ViewModels 
; 
public 
partial 
class 
MiscItemViewModel &
:' (
ObservableObject) 9
{		 
[

 
ObservableProperty

 
]

 
private 
string 
_description 
=  !
string" (
.( )
Empty) .
;. /
[ 
ObservableProperty 
] 
private 
decimal 
_price 
; 
[ 
ObservableProperty 
] 
private 
string 
_priceString 
=  !
string" (
.( )
Empty) .
;. /
[ 
ObservableProperty 
] 
private 
bool 
_isConfirmed 
; 
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

Action 
? 
CancelAction 
{  !
get" %
;% &
set' *
;* +
}, -
public 

MiscItemViewModel 
( 
) 
{ 
} 
[   
RelayCommand   
]   
private!! 
void!! 
AppendNumber!! 
(!! 
string!! $
number!!% +
)!!+ ,
{"" 
if## 

(## 
PriceString## 
.## 
Contains##  
(##  !
$str##! $
)##$ %
&&##& (
number##) /
==##0 2
$str##3 6
)##6 7
return##8 >
;##> ?
PriceString%% 
+=%% 
number%% 
;%% 
if&& 

(&& 
decimal&& 
.&& 
TryParse&& 
(&& 
PriceString&& (
,&&( )
out&&* -
var&&. 1
result&&2 8
)&&8 9
)&&9 :
{'' 	
Price(( 
=(( 
result(( 
;(( 
})) 	
}** 
[,, 
RelayCommand,, 
],, 
private-- 
void-- 
Clear-- 
(-- 
)-- 
{.. 
PriceString// 
=// 
string// 
.// 
Empty// "
;//" #
Price00 
=00 
$num00 
;00 
}11 
[33 
RelayCommand33 
]33 
private44 
void44 
Confirm44 
(44 
)44 
{55 
IsConfirmed66 
=66 
true66 
;66 
CloseAction77 
?77 
.77 
Invoke77 
(77 
)77 
;77 
}88 
[:: 
RelayCommand:: 
]:: 
private;; 
void;; 
Cancel;; 
(;; 
);; 
{<< 
IsConfirmed== 
=== 
false== 
;== 
CancelAction>> 
?>> 
.>> 
Invoke>> 
(>> 
)>> 
;>> 
}?? 
}@@ „Ö
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\MenuEditorViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public		 
class		 
MenuEditorViewModel		  
:		! "
ViewModelBase		# 0
{

 
private 
readonly #
IMenuCategoryRepository ,
_categoryRepository- @
;@ A
private 
readonly  
IMenuGroupRepository )
_groupRepository* :
;: ;
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly $
IInventoryItemRepository - 
_inventoryRepository. B
;B C
private 
readonly #
IPrinterGroupRepository ,#
_printerGroupRepository- D
;D E
private 
MenuCategory 
? 
_selectedCategory +
;+ ,
private 
bool 

_isEditing 
; 
private 
string 
_editingName 
=  !
string" (
.( )
Empty) .
;. /
private 
int 
_editingSortOrder !
;! "
public 

string 
EditingName 
{ 
get 
=> 
_editingName 
; 
set 
=> 
SetProperty 
( 
ref 
_editingName +
,+ ,
value- 2
)2 3
;3 4
} 
public   

int   
EditingSortOrder   
{!! 
get"" 
=>"" 
_editingSortOrder""  
;""  !
set## 
=>## 
SetProperty## 
(## 
ref## 
_editingSortOrder## 0
,##0 1
value##2 7
)##7 8
;##8 9
}$$ 
private&& 
string&& 
_editingPrice&&  
=&&! "
$str&&# )
;&&) *
public'' 

string'' 
EditingPrice'' 
{(( 
get)) 
=>)) 
_editingPrice)) 
;)) 
set** 
=>** 
SetProperty** 
(** 
ref** 
_editingPrice** ,
,**, -
value**. 3
)**3 4
;**4 5
}++ 
private-- 
string-- 
_statusMessage-- !
=--" #
$str--$ +
;--+ ,
public.. 

string.. 
StatusMessage.. 
{// 
get00 
=>00 
_statusMessage00 
;00 
set11 
=>11 
SetProperty11 
(11 
ref11 
_statusMessage11 -
,11- .
value11/ 4
)114 5
;115 6
}22 
public44 
 
ObservableCollection44 
<44  
MenuCategory44  ,
>44, -

Categories44. 8
{449 :
get44; >
;44> ?
}44@ A
=44B C
new44D G
(44G H
)44H I
;44I J
public55 
 
ObservableCollection55 
<55  
	MenuGroup55  )
>55) *
Groups55+ 1
{552 3
get554 7
;557 8
}559 :
=55; <
new55= @
(55@ A
)55A B
;55B C
public66 
 
ObservableCollection66 
<66  
MenuItem66  (
>66( )
Items66* /
{660 1
get662 5
;665 6
}667 8
=669 :
new66; >
(66> ?
)66? @
;66@ A
public77 
 
ObservableCollection77 
<77  
PrinterGroup77  ,
>77, -
PrinterGroups77. ;
{77< =
get77> A
;77A B
}77C D
=77E F
new77G J
(77J K
)77K L
;77L M
private99 
PrinterGroup99 
?99 !
_selectedPrinterGroup99 /
;99/ 0
public:: 

PrinterGroup:: 
?::  
SelectedPrinterGroup:: -
{;; 
get<< 
=><< !
_selectedPrinterGroup<< $
;<<$ %
set== 
=>== 
SetProperty== 
(== 
ref== !
_selectedPrinterGroup== 4
,==4 5
value==6 ;
)==; <
;==< =
}>> 
publicAA 
 
ObservableCollectionAA 
<AA  
InventoryItemAA  -
>AA- .
InventoryOptionsAA/ ?
{AA@ A
getAAB E
;AAE F
}AAG H
=AAI J
newAAK N
(AAN O
)AAO P
;AAP Q
publicBB 
 
ObservableCollectionBB 
<BB  
RecipeLineViewModelBB  3
>BB3 4
RecipeLinesBB5 @
{BBA B
getBBC F
;BBF G
}BBH I
=BBJ K
newBBL O
(BBO P
)BBP Q
;BBQ R
privateDD 
InventoryItemDD 
?DD $
_selectedInventoryOptionDD 3
;DD3 4
publicEE 

InventoryItemEE 
?EE #
SelectedInventoryOptionEE 1
{FF 
getGG 
=>GG $
_selectedInventoryOptionGG '
;GG' (
setHH 
=>HH 
SetPropertyHH 
(HH 
refHH $
_selectedInventoryOptionHH 7
,HH7 8
valueHH9 >
)HH> ?
;HH? @
}II 
privateKK 
stringKK 
_newRecipeQuantityKK %
=KK& '
$strKK( +
;KK+ ,
publicLL 

stringLL 
NewRecipeQuantityLL #
{MM 
getNN 
=>NN 
_newRecipeQuantityNN !
;NN! "
setOO 
=>OO 
SetPropertyOO 
(OO 
refOO 
_newRecipeQuantityOO 1
,OO1 2
valueOO3 8
)OO8 9
;OO9 :
}PP 
privateRR 
RecipeLineViewModelRR 
?RR  
_selectedRecipeLineRR! 4
;RR4 5
publicSS 

RecipeLineViewModelSS 
?SS 
SelectedRecipeLineSS  2
{TT 
getUU 
=>UU 
_selectedRecipeLineUU "
;UU" #
setVV 
=>VV 
SetPropertyVV 
(VV 
refVV 
_selectedRecipeLineVV 2
,VV2 3
valueVV4 9
)VV9 :
;VV: ;
}WW 
publicYY 

ICommandYY 
LoadDataCommandYY #
{YY$ %
getYY& )
;YY) *
}YY+ ,
publicZZ 

ICommandZZ 
AddCategoryCommandZZ &
{ZZ' (
getZZ) ,
;ZZ, -
}ZZ. /
public[[ 

ICommand[[ 
AddGroupCommand[[ #
{[[$ %
get[[& )
;[[) *
}[[+ ,
public\\ 

ICommand\\ 
AddItemCommand\\ "
{\\# $
get\\% (
;\\( )
}\\* +
public]] 

ICommand]]  
AddRecipeLineCommand]] (
{]]) *
get]]+ .
;]]. /
}]]0 1
public^^ 

ICommand^^ #
RemoveRecipeLineCommand^^ +
{^^, -
get^^. 1
;^^1 2
}^^3 4
public__ 

ICommand__ 
SaveCommand__ 
{__  !
get__" %
;__% &
}__' (
public`` 

ICommand`` 
DeleteCommand`` !
{``" #
get``$ '
;``' (
}``) *
publiccc 

MenuCategorycc 
?cc 
SelectedCategorycc )
{dd 
getee 
=>ee 
_selectedCategoryee  
;ee  !
setff 
{gg 	
ifhh 
(hh 
SetPropertyhh 
(hh 
refhh 
_selectedCategoryhh  1
,hh1 2
valuehh3 8
)hh8 9
)hh9 :
{ii 
SelectedGroupkk 
=kk 
nullkk  $
;kk$ %
Groupsll 
.ll 
Clearll 
(ll 
)ll 
;ll 
SelectedItemoo 
=oo 
nulloo #
;oo# $
Itemspp 
.pp 
Clearpp 
(pp 
)pp 
;pp 
ifrr 
(rr 
valuerr 
!=rr 
nullrr !
)rr! "
{ss 
	IsEditingtt 
=tt 
truett  $
;tt$ %
EditingNameuu 
=uu  !
valueuu" '
.uu' (
Nameuu( ,
;uu, -
EditingSortOrdervv $
=vv% &
valuevv' ,
.vv, -
	SortOrdervv- 6
;vv6 7
StatusMessageww !
=ww" #
$"ww$ &
$strww& 8
{ww8 9
valueww9 >
.ww> ?
Nameww? C
}wwC D
"wwD E
;wwE F
ifyy 
(yy 
valueyy 
.yy 
PrinterGroupIdyy ,
.yy, -
HasValueyy- 5
)yy5 6 
SelectedPrinterGroupzz ,
=zz- .
PrinterGroupszz/ <
.zz< =
FirstOrDefaultzz= K
(zzK L
pgzzL N
=>zzO Q
pgzzR T
.zzT U
IdzzU W
==zzX Z
valuezz[ `
.zz` a
PrinterGroupIdzza o
)zzo p
;zzp q
else{{  
SelectedPrinterGroup|| ,
=||- .
null||/ 3
;||3 4
_~~ 
=~~ 
LoadGroupsAsync~~ '
(~~' (
value~~( -
.~~- .
Id~~. 0
)~~0 1
;~~1 2
} 
else
€€ 
{
 
	IsEditing
‚‚ 
=
‚‚ 
false
‚‚  %
;
‚‚% &
StatusMessage
ƒƒ !
=
ƒƒ" #
$str
ƒƒ$ +
;
ƒƒ+ ,
}
„„ 
}
…… 
}
†† 	
}
‡‡ 
private
‰‰ 
	MenuGroup
‰‰ 
?
‰‰ 
_selectedGroup
‰‰ %
;
‰‰% &
public
ŠŠ 

	MenuGroup
ŠŠ 
?
ŠŠ 
SelectedGroup
ŠŠ #
{
‹‹ 
get
ŒŒ 
=>
ŒŒ 
_selectedGroup
ŒŒ 
;
ŒŒ 
set
 
{
ŽŽ 	
if
 
(
 
SetProperty
 
(
 
ref
 
_selectedGroup
  .
,
. /
value
0 5
)
5 6
)
6 7
{
 
SelectedItem
’’ 
=
’’ 
null
’’ #
;
’’# $
Items
““ 
.
““ 
Clear
““ 
(
““ 
)
““ 
;
““ 
if
•• 
(
•• 
value
•• 
!=
•• 
null
•• !
)
••! "
{
–– 
	IsEditing
—— 
=
—— 
true
——  $
;
——$ %
EditingName
˜˜ 
=
˜˜  !
value
˜˜" '
.
˜˜' (
Name
˜˜( ,
;
˜˜, -
EditingSortOrder
™™ $
=
™™% &
value
™™' ,
.
™™, -
	SortOrder
™™- 6
;
™™6 7
StatusMessage
šš !
=
šš" #
$"
šš$ &
$str
šš& 5
{
šš5 6
value
šš6 ;
.
šš; <
Name
šš< @
}
šš@ A
"
ššA B
;
ššB C
if
œœ 
(
œœ 
value
œœ 
.
œœ 
PrinterGroupId
œœ ,
.
œœ, -
HasValue
œœ- 5
)
œœ5 6"
SelectedPrinterGroup
 ,
=
- .
PrinterGroups
/ <
.
< =
FirstOrDefault
= K
(
K L
pg
L N
=>
O Q
pg
R T
.
T U
Id
U W
==
X Z
value
[ `
.
` a
PrinterGroupId
a o
)
o p
;
p q
else
žž "
SelectedPrinterGroup
ŸŸ ,
=
ŸŸ- .
null
ŸŸ/ 3
;
ŸŸ3 4
_
¡¡ 
=
¡¡ 
LoadItemsAsync
¡¡ &
(
¡¡& '
value
¡¡' ,
.
¡¡, -

CategoryId
¡¡- 7
,
¡¡7 8
value
¡¡9 >
.
¡¡> ?
Id
¡¡? A
)
¡¡A B
;
¡¡B C
}
¢¢ 
else
££ 
if
££ 
(
££ 
SelectedCategory
££ )
!=
££* ,
null
££- 1
)
££1 2
{
¤¤ 
EditingName
¦¦ 
=
¦¦  !
SelectedCategory
¦¦" 2
.
¦¦2 3
Name
¦¦3 7
;
¦¦7 8
EditingSortOrder
§§ $
=
§§% &
SelectedCategory
§§' 7
.
§§7 8
	SortOrder
§§8 A
;
§§A B
StatusMessage
¨¨ !
=
¨¨" #
$"
¨¨$ &
$str
¨¨& 8
{
¨¨8 9
SelectedCategory
¨¨9 I
.
¨¨I J
Name
¨¨J N
}
¨¨N O
"
¨¨O P
;
¨¨P Q
}
©© 
}
ªª 
}
«« 	
}
¬¬ 
private
®® 
MenuItem
®® 
?
®® 
_selectedItem
®® #
;
®®# $
public
¯¯ 

MenuItem
¯¯ 
?
¯¯ 
SelectedItem
¯¯ !
{
°° 
get
±± 
=>
±± 
_selectedItem
±± 
;
±± 
set
²² 
{
³³ 	
if
´´ 
(
´´ 
SetProperty
´´ 
(
´´ 
ref
´´ 
_selectedItem
´´  -
,
´´- .
value
´´/ 4
)
´´4 5
)
´´5 6
{
µµ 
if
¶¶ 
(
¶¶ 
value
¶¶ 
!=
¶¶ 
null
¶¶ !
)
¶¶! "
{
·· 
	IsEditing
¸¸ 
=
¸¸ 
true
¸¸  $
;
¸¸$ %
EditingName
¹¹ 
=
¹¹  !
value
¹¹" '
.
¹¹' (
Name
¹¹( ,
;
¹¹, -
EditingPrice
ºº  
=
ºº! "
value
ºº# (
.
ºº( )
Price
ºº) .
.
ºº. /
Amount
ºº/ 5
.
ºº5 6
ToString
ºº6 >
(
ºº> ?
$str
ºº? C
)
ººC D
;
ººD E
StatusMessage
»» !
=
»»" #
$"
»»$ &
$str
»»& 4
{
»»4 5
value
»»5 :
.
»»: ;
Name
»»; ?
}
»»? @
"
»»@ A
;
»»A B
if
½½ 
(
½½ 
value
½½ 
.
½½ 
PrinterGroupId
½½ ,
.
½½, -
HasValue
½½- 5
)
½½5 6
{
¾¾ "
SelectedPrinterGroup
¿¿ ,
=
¿¿- .
PrinterGroups
¿¿/ <
.
¿¿< =
FirstOrDefault
¿¿= K
(
¿¿K L
pg
¿¿L N
=>
¿¿O Q
pg
¿¿R T
.
¿¿T U
Id
¿¿U W
==
¿¿X Z
value
¿¿[ `
.
¿¿` a
PrinterGroupId
¿¿a o
)
¿¿o p
;
¿¿p q
}
ÀÀ 
else
ÁÁ 
{
ÂÂ "
SelectedPrinterGroup
ÃÃ ,
=
ÃÃ- .
null
ÃÃ/ 3
;
ÃÃ3 4
}
ÄÄ 
_
ÆÆ 
=
ÆÆ "
LoadRecipeLinesAsync
ÆÆ ,
(
ÆÆ, -
value
ÆÆ- 2
)
ÆÆ2 3
;
ÆÆ3 4
}
ÇÇ 
else
ÈÈ 
if
ÈÈ 
(
ÈÈ 
SelectedGroup
ÈÈ &
!=
ÈÈ' )
null
ÈÈ* .
)
ÈÈ. /
{
ÉÉ 
EditingName
ÊÊ 
=
ÊÊ  !
SelectedGroup
ÊÊ" /
.
ÊÊ/ 0
Name
ÊÊ0 4
;
ÊÊ4 5
EditingSortOrder
ËË $
=
ËË% &
SelectedGroup
ËË' 4
.
ËË4 5
	SortOrder
ËË5 >
;
ËË> ?
StatusMessage
ÌÌ !
=
ÌÌ" #
$"
ÌÌ$ &
$str
ÌÌ& 5
{
ÌÌ5 6
SelectedGroup
ÌÌ6 C
.
ÌÌC D
Name
ÌÌD H
}
ÌÌH I
"
ÌÌI J
;
ÌÌJ K
}
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
}
ÐÐ 
public
ÒÒ 

bool
ÒÒ 
	IsEditing
ÒÒ 
{
ÓÓ 
get
ÔÔ 
=>
ÔÔ 

_isEditing
ÔÔ 
;
ÔÔ 
set
ÕÕ 
=>
ÕÕ 
SetProperty
ÕÕ 
(
ÕÕ 
ref
ÕÕ 

_isEditing
ÕÕ )
,
ÕÕ) *
value
ÕÕ+ 0
)
ÕÕ0 1
;
ÕÕ1 2
}
ÖÖ 
public
ØØ 
!
MenuEditorViewModel
ØØ 
(
ØØ %
IMenuCategoryRepository
ÙÙ  
categoryRepository
ÙÙ  2
,
ÙÙ2 3"
IMenuGroupRepository
ÚÚ 
groupRepository
ÚÚ ,
,
ÚÚ, -
IMenuRepository
ÛÛ 
menuRepository
ÛÛ &
,
ÛÛ& '&
IInventoryItemRepository
ÜÜ  !
inventoryRepository
ÜÜ! 4
,
ÜÜ4 5%
IPrinterGroupRepository
ÝÝ $
printerGroupRepository
ÝÝ  6
)
ÝÝ6 7
{
ÞÞ !
_categoryRepository
ßß 
=
ßß  
categoryRepository
ßß 0
;
ßß0 1
_groupRepository
àà 
=
àà 
groupRepository
àà *
;
àà* +
_menuRepository
áá 
=
áá 
menuRepository
áá (
;
áá( )"
_inventoryRepository
ââ 
=
ââ !
inventoryRepository
ââ 2
;
ââ2 3%
_printerGroupRepository
ãã 
=
ãã  !$
printerGroupRepository
ãã" 8
;
ãã8 9
Title
ää 
=
ää 
$str
ää 
;
ää 
LoadDataCommand
ææ 
=
ææ 
new
ææ 
AsyncRelayCommand
ææ /
(
ææ/ 0
LoadDataAsync
ææ0 =
)
ææ= >
;
ææ> ? 
AddCategoryCommand
çç 
=
çç 
new
çç  
AsyncRelayCommand
çç! 2
(
çç2 3
AddCategoryAsync
çç3 C
)
ççC D
;
ççD E
AddGroupCommand
èè 
=
èè 
new
èè 
AsyncRelayCommand
èè /
(
èè/ 0
AddGroupAsync
èè0 =
)
èè= >
;
èè> ?
AddItemCommand
éé 
=
éé 
new
éé 
AsyncRelayCommand
éé .
(
éé. /
AddItemAsync
éé/ ;
)
éé; <
;
éé< ="
AddRecipeLineCommand
ëë 
=
ëë 
new
ëë "
AsyncRelayCommand
ëë# 4
(
ëë4 5 
AddRecipeLineAsync
ëë5 G
)
ëëG H
;
ëëH I%
RemoveRecipeLineCommand
ìì 
=
ìì  !
new
ìì" %
AsyncRelayCommand
ìì& 7
(
ìì7 8#
RemoveRecipeLineAsync
ìì8 M
)
ììM N
;
ììN O
SaveCommand
îî 
=
îî 
new
îî 
AsyncRelayCommand
îî +
(
îî+ ,
	SaveAsync
îî, 5
)
îî5 6
;
îî6 7
DeleteCommand
ïï 
=
ïï 
new
ïï 
AsyncRelayCommand
ïï -
(
ïï- .
DeleteAsync
ïï. 9
)
ïï9 :
;
ïï: ;
}
ðð 
private
òò 
async
òò 
Task
òò 
	SaveAsync
òò  
(
òò  !
)
òò! "
{
óó 
IsBusy
ôô 
=
ôô 
true
ôô 
;
ôô 
try
õõ 
{
öö 	
if
÷÷ 
(
÷÷ 
SelectedItem
÷÷ 
!=
÷÷ 
null
÷÷  $
)
÷÷$ %
{
øø 
SelectedItem
ùù 
.
ùù 

UpdateName
ùù (
(
ùù( )
EditingName
ùù) 4
)
ùù4 5
;
ùù5 6
if
úú 
(
úú 
decimal
úú 
.
úú 
TryParse
úú %
(
úú% &
EditingPrice
úú& 2
,
úú2 3
out
úú4 7
var
úú8 ;
priceVal
úú< D
)
úúD E
)
úúE F
{
ûû 
SelectedItem
üü !
.
üü! "
UpdatePrice
üü" -
(
üü- .
new
üü. 1
Magidesk
üü2 :
.
üü: ;
Domain
üü; A
.
üüA B
ValueObjects
üüB N
.
üüN O
Money
üüO T
(
üüT U
priceVal
üüU ]
)
üü] ^
)
üü^ _
;
üü_ `
}
ýý 
SelectedItem
€€ 
.
€€ 
SetPrinterGroup
€€ -
(
€€- ."
SelectedPrinterGroup
€€. B
?
€€B C
.
€€C D
Id
€€D F
)
€€F G
;
€€G H
await
‚‚ 
_menuRepository
‚‚ &
.
‚‚& '
UpdateAsync
‚‚' 2
(
‚‚2 3
SelectedItem
‚‚3 ?
)
‚‚? @
;
‚‚@ A
StatusMessage
ƒƒ 
=
ƒƒ  
$str
ƒƒ! D
;
ƒƒD E
}
„„ 
else
…… 
if
…… 
(
…… 
SelectedGroup
…… "
!=
……# %
null
……& *
)
……* +
{
†† 
SelectedGroup
‡‡ 
.
‡‡ 

UpdateName
‡‡ )
(
‡‡) *
EditingName
‡‡* 5
)
‡‡5 6
;
‡‡6 7
SelectedGroup
ˆˆ 
.
ˆˆ 
UpdateSortOrder
ˆˆ .
(
ˆˆ. /
EditingSortOrder
ˆˆ/ ?
)
ˆˆ? @
;
ˆˆ@ A
SelectedGroup
‹‹ 
.
‹‹ 
SetPrinterGroup
‹‹ .
(
‹‹. /"
SelectedPrinterGroup
‹‹/ C
?
‹‹C D
.
‹‹D E
Id
‹‹E G
)
‹‹G H
;
‹‹H I
await
 
_groupRepository
 '
.
' (
UpdateAsync
( 3
(
3 4
SelectedGroup
4 A
)
A B
;
B C
StatusMessage
ŽŽ 
=
ŽŽ  
$str
ŽŽ! <
;
ŽŽ< =
}
 
else
 
if
 
(
 
SelectedCategory
 %
!=
& (
null
) -
)
- .
{
‘‘ 
SelectedCategory
’’  
.
’’  !

UpdateName
’’! +
(
’’+ ,
EditingName
’’, 7
)
’’7 8
;
’’8 9
SelectedCategory
““  
.
““  !
UpdateSortOrder
““! 0
(
““0 1
EditingSortOrder
““1 A
)
““A B
;
““B C
SelectedCategory
––  
.
––  !
SetPrinterGroup
––! 0
(
––0 1"
SelectedPrinterGroup
––1 E
?
––E F
.
––F G
Id
––G I
)
––I J
;
––J K
await
˜˜ !
_categoryRepository
˜˜ )
.
˜˜) *
UpdateAsync
˜˜* 5
(
˜˜5 6
SelectedCategory
˜˜6 F
)
˜˜F G
;
˜˜G H
StatusMessage
™™ 
=
™™ 
$str
™™  >
;
™™> ?
}
šš 
}
›› 	
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ 
{
 	
StatusMessage
žž 
=
žž 
$"
žž 
$str
žž +
{
žž+ ,
ex
žž, .
.
žž. /
Message
žž/ 6
}
žž6 7
"
žž7 8
;
žž8 9
}
ŸŸ 	
finally
   
{
   
IsBusy
   
=
   
false
    
;
    !
}
  " #
}
¡¡ 
private
££ 
async
££ 
Task
££ 
DeleteAsync
££ "
(
££" #
)
££# $
{
¤¤ 
IsBusy
¥¥ 
=
¥¥ 
true
¥¥ 
;
¥¥ 
try
¦¦ 
{
§§ 	
if
¨¨ 
(
¨¨ 
SelectedItem
¨¨ 
!=
¨¨ 
null
¨¨  $
)
¨¨$ %
{
©© 
var
ªª 
item
ªª 
=
ªª 
SelectedItem
ªª '
;
ªª' (
await
«« 
_menuRepository
«« %
.
««% &
DeleteAsync
««& 1
(
««1 2
item
««2 6
)
««6 7
;
««7 8
Items
¬¬ 
.
¬¬ 
Remove
¬¬ 
(
¬¬ 
item
¬¬ !
)
¬¬! "
;
¬¬" #
SelectedItem
­­ 
=
­­ 
null
­­ #
;
­­# $
StatusMessage
®® 
=
®® 
$str
®®  /
;
®®/ 0
return
¯¯ 
;
¯¯ 
}
°° 
if
²² 
(
²² 
SelectedGroup
²² 
!=
²²  
null
²²! %
)
²²% &
{
³³ 
var
´´ 
group
´´ 
=
´´ 
SelectedGroup
´´ )
;
´´) *
var
¶¶ 
items
¶¶ 
=
¶¶ 
(
¶¶ 
await
¶¶ "
_menuRepository
¶¶# 2
.
¶¶2 3
GetAllAsync
¶¶3 >
(
¶¶> ?
)
¶¶? @
)
¶¶@ A
.
¶¶A B
Where
¶¶B G
(
¶¶G H
i
¶¶H I
=>
¶¶J L
i
¶¶M N
.
¶¶N O
GroupId
¶¶O V
==
¶¶W Y
group
¶¶Z _
.
¶¶_ `
Id
¶¶` b
)
¶¶b c
.
¶¶c d
ToList
¶¶d j
(
¶¶j k
)
¶¶k l
;
¶¶l m
foreach
·· 
(
·· 
var
·· 
item
·· !
in
··" $
items
··% *
)
··* +
{
¸¸ 
await
¹¹ 
_menuRepository
¹¹ )
.
¹¹) *
DeleteAsync
¹¹* 5
(
¹¹5 6
item
¹¹6 :
)
¹¹: ;
;
¹¹; <
}
ºº 
await
¼¼ 
_groupRepository
¼¼ &
.
¼¼& '
DeleteAsync
¼¼' 2
(
¼¼2 3
group
¼¼3 8
)
¼¼8 9
;
¼¼9 :
Groups
¾¾ 
.
¾¾ 
Remove
¾¾ 
(
¾¾ 
group
¾¾ #
)
¾¾# $
;
¾¾$ %
Items
¿¿ 
.
¿¿ 
Clear
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿ 
SelectedItem
ÀÀ 
=
ÀÀ 
null
ÀÀ #
;
ÀÀ# $
SelectedGroup
ÁÁ 
=
ÁÁ 
null
ÁÁ  $
;
ÁÁ$ %
StatusMessage
ÂÂ 
=
ÂÂ 
$str
ÂÂ  0
;
ÂÂ0 1
return
ÃÃ 
;
ÃÃ 
}
ÄÄ 
if
ÆÆ 
(
ÆÆ 
SelectedCategory
ÆÆ  
!=
ÆÆ! #
null
ÆÆ$ (
)
ÆÆ( )
{
ÇÇ 
var
ÈÈ 
category
ÈÈ 
=
ÈÈ 
SelectedCategory
ÈÈ /
;
ÈÈ/ 0
var
ÊÊ 
groups
ÊÊ 
=
ÊÊ 
(
ÊÊ 
await
ÊÊ #
_groupRepository
ÊÊ$ 4
.
ÊÊ4 5
GetAllAsync
ÊÊ5 @
(
ÊÊ@ A
)
ÊÊA B
)
ÊÊB C
.
ÊÊC D
Where
ÊÊD I
(
ÊÊI J
g
ÊÊJ K
=>
ÊÊL N
g
ÊÊO P
.
ÊÊP Q

CategoryId
ÊÊQ [
==
ÊÊ\ ^
category
ÊÊ_ g
.
ÊÊg h
Id
ÊÊh j
)
ÊÊj k
.
ÊÊk l
ToList
ÊÊl r
(
ÊÊr s
)
ÊÊs t
;
ÊÊt u
foreach
ËË 
(
ËË 
var
ËË 
group
ËË "
in
ËË# %
groups
ËË& ,
)
ËË, -
{
ÌÌ 
var
ÍÍ 
items
ÍÍ 
=
ÍÍ 
(
ÍÍ  !
await
ÍÍ! &
_menuRepository
ÍÍ' 6
.
ÍÍ6 7
GetAllAsync
ÍÍ7 B
(
ÍÍB C
)
ÍÍC D
)
ÍÍD E
.
ÍÍE F
Where
ÍÍF K
(
ÍÍK L
i
ÍÍL M
=>
ÍÍN P
i
ÍÍQ R
.
ÍÍR S
GroupId
ÍÍS Z
==
ÍÍ[ ]
group
ÍÍ^ c
.
ÍÍc d
Id
ÍÍd f
)
ÍÍf g
.
ÍÍg h
ToList
ÍÍh n
(
ÍÍn o
)
ÍÍo p
;
ÍÍp q
foreach
ÎÎ 
(
ÎÎ 
var
ÎÎ  
item
ÎÎ! %
in
ÎÎ& (
items
ÎÎ) .
)
ÎÎ. /
{
ÏÏ 
await
ÐÐ 
_menuRepository
ÐÐ -
.
ÐÐ- .
DeleteAsync
ÐÐ. 9
(
ÐÐ9 :
item
ÐÐ: >
)
ÐÐ> ?
;
ÐÐ? @
}
ÑÑ 
await
ÓÓ 
_groupRepository
ÓÓ *
.
ÓÓ* +
DeleteAsync
ÓÓ+ 6
(
ÓÓ6 7
group
ÓÓ7 <
)
ÓÓ< =
;
ÓÓ= >
}
ÔÔ 
await
ÖÖ !
_categoryRepository
ÖÖ )
.
ÖÖ) *
DeleteAsync
ÖÖ* 5
(
ÖÖ5 6
category
ÖÖ6 >
)
ÖÖ> ?
;
ÖÖ? @

Categories
ØØ 
.
ØØ 
Remove
ØØ !
(
ØØ! "
category
ØØ" *
)
ØØ* +
;
ØØ+ ,
Groups
ÙÙ 
.
ÙÙ 
Clear
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Items
ÚÚ 
.
ÚÚ 
Clear
ÚÚ 
(
ÚÚ 
)
ÚÚ 
;
ÚÚ 
SelectedItem
ÛÛ 
=
ÛÛ 
null
ÛÛ #
;
ÛÛ# $
SelectedGroup
ÜÜ 
=
ÜÜ 
null
ÜÜ  $
;
ÜÜ$ %
SelectedCategory
ÝÝ  
=
ÝÝ! "
null
ÝÝ# '
;
ÝÝ' (
StatusMessage
ÞÞ 
=
ÞÞ 
$str
ÞÞ  3
;
ÞÞ3 4
}
ßß 
}
àà 	
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá 
{
ââ 	
StatusMessage
ãã 
=
ãã 
$"
ãã 
$str
ãã -
{
ãã- .
ex
ãã. 0
.
ãã0 1
Message
ãã1 8
}
ãã8 9
"
ãã9 :
;
ãã: ;
}
ää 	
finally
åå 
{
ææ 	
IsBusy
çç 
=
çç 
false
çç 
;
çç 
}
èè 	
}
éé 
private
ëë 
async
ëë 
Task
ëë 
AddCategoryAsync
ëë '
(
ëë' (
)
ëë( )
{
ìì 
var
íí 
newCat
íí 
=
íí 
MenuCategory
íí !
.
íí! "
Create
íí" (
(
íí( )
$str
íí) 7
,
íí7 8
$num
íí9 :
,
íí: ;
false
íí< A
)
ííA B
;
ííB C
IsBusy
ïï 
=
ïï 
true
ïï 
;
ïï 
try
ðð 
{
ññ 	
await
òò !
_categoryRepository
òò %
.
òò% &
AddAsync
òò& .
(
òò. /
newCat
òò/ 5
)
òò5 6
;
òò6 7

Categories
óó 
.
óó 
Add
óó 
(
óó 
newCat
óó !
)
óó! "
;
óó" #
SelectedCategory
ôô 
=
ôô 
newCat
ôô %
;
ôô% &
StatusMessage
õõ 
=
õõ 
$str
õõ ,
;
õõ, -
}
öö 	
finally
÷÷ 
{
÷÷ 
IsBusy
÷÷ 
=
÷÷ 
false
÷÷  
;
÷÷  !
}
÷÷" #
}
øø 
private
úú 
async
úú 
Task
úú 
AddItemAsync
úú #
(
úú# $
)
úú$ %
{
ûû 
if
üü 

(
üü 
SelectedGroup
üü 
==
üü 
null
üü !
||
üü" $
SelectedCategory
üü% 5
==
üü6 8
null
üü9 =
)
üü= >
{
ýý 	
StatusMessage
þþ 
=
þþ 
$str
þþ 3
;
þþ3 4
return
ÿÿ 
;
ÿÿ 
}
€€ 	
IsBusy
‚‚ 
=
‚‚ 
true
‚‚ 
;
‚‚ 
try
ƒƒ 
{
„„ 	
var
…… 
newItem
…… 
=
…… 
MenuItem
…… "
.
……" #
Create
……# )
(
……) *
$str
……* 4
,
……4 5
Magidesk
……6 >
.
……> ?
Domain
……? E
.
……E F
ValueObjects
……F R
.
……R S
Money
……S X
.
……X Y
Zero
……Y ]
(
……] ^
)
……^ _
)
……_ `
;
……` a
newItem
†† 
.
†† 
SetCategory
†† 
(
††  
SelectedCategory
††  0
.
††0 1
Id
††1 3
)
††3 4
;
††4 5
newItem
‡‡ 
.
‡‡ 
SetGroup
‡‡ 
(
‡‡ 
SelectedGroup
‡‡ *
.
‡‡* +
Id
‡‡+ -
)
‡‡- .
;
‡‡. /
await
‰‰ 
_menuRepository
‰‰ !
.
‰‰! "
AddAsync
‰‰" *
(
‰‰* +
newItem
‰‰+ 2
)
‰‰2 3
;
‰‰3 4
Items
ŠŠ 
.
ŠŠ 
Add
ŠŠ 
(
ŠŠ 
newItem
ŠŠ 
)
ŠŠ 
;
ŠŠ 
SelectedItem
‹‹ 
=
‹‹ 
newItem
‹‹ "
;
‹‹" #
StatusMessage
ŒŒ 
=
ŒŒ 
$str
ŒŒ (
;
ŒŒ( )
}
 	
finally
ŽŽ 
{
ŽŽ 
IsBusy
ŽŽ 
=
ŽŽ 
false
ŽŽ  
;
ŽŽ  !
}
ŽŽ" #
}
 
private
‘‘ 
async
‘‘ 
Task
‘‘ 
AddGroupAsync
‘‘ $
(
‘‘$ %
)
‘‘% &
{
’’ 
if
““ 

(
““ 
SelectedCategory
““ 
==
““ 
null
““  $
)
““$ %
{
”” 	
StatusMessage
•• 
=
•• 
$str
•• 6
;
••6 7
return
–– 
;
–– 
}
—— 	
IsBusy
™™ 
=
™™ 
true
™™ 
;
™™ 
try
šš 
{
›› 	
var
œœ 
newGroup
œœ 
=
œœ 
	MenuGroup
œœ $
.
œœ$ %
Create
œœ% +
(
œœ+ ,
$str
œœ, 7
,
œœ7 8
SelectedCategory
œœ9 I
.
œœI J
Id
œœJ L
)
œœL M
;
œœM N
await
 
_groupRepository
 "
.
" #
AddAsync
# +
(
+ ,
newGroup
, 4
)
4 5
;
5 6
Groups
žž 
.
žž 
Add
žž 
(
žž 
newGroup
žž 
)
žž  
;
žž  !
SelectedGroup
ŸŸ 
=
ŸŸ 
newGroup
ŸŸ $
;
ŸŸ$ %
StatusMessage
   
=
   
$str
   )
;
  ) *
}
¡¡ 	
finally
¢¢ 
{
¢¢ 
IsBusy
¢¢ 
=
¢¢ 
false
¢¢  
;
¢¢  !
}
¢¢" #
}
££ 
private
¥¥ 
async
¥¥ 
Task
¥¥ 
LoadDataAsync
¥¥ $
(
¥¥$ %
)
¥¥% &
{
¦¦ 
IsBusy
§§	 
=
§§ 
true
§§ 
;
§§ 
try
¨¨ 
{
©© 	

Categories
ªª 
.
ªª 
Clear
ªª 
(
ªª 
)
ªª 
;
ªª 
var
«« 
cats
«« 
=
«« 
await
«« !
_categoryRepository
«« 0
.
««0 1
GetAllAsync
««1 <
(
««< =
)
««= >
;
««> ?
foreach
¬¬ 
(
¬¬ 
var
¬¬ 
cat
¬¬ 
in
¬¬ 
cats
¬¬  $
)
¬¬$ %

Categories
¬¬& 0
.
¬¬0 1
Add
¬¬1 4
(
¬¬4 5
cat
¬¬5 8
)
¬¬8 9
;
¬¬9 :
InventoryOptions
¯¯ 
.
¯¯ 
Clear
¯¯ "
(
¯¯" #
)
¯¯# $
;
¯¯$ %
var
°° 
invItems
°° 
=
°° 
await
°°  "
_inventoryRepository
°°! 5
.
°°5 6
GetAllAsync
°°6 A
(
°°A B
)
°°B C
;
°°C D
foreach
±± 
(
±± 
var
±± 
inv
±± 
in
±± 
invItems
±±  (
)
±±( )
InventoryOptions
±±* :
.
±±: ;
Add
±±; >
(
±±> ?
inv
±±? B
)
±±B C
;
±±C D
PrinterGroups
´´ 
.
´´ 
Clear
´´ 
(
´´  
)
´´  !
;
´´! "
var
µµ 
printerGroups
µµ 
=
µµ 
await
µµ  %%
_printerGroupRepository
µµ& =
.
µµ= >
GetAllAsync
µµ> I
(
µµI J
)
µµJ K
;
µµK L
foreach
¶¶ 
(
¶¶ 
var
¶¶ 
pg
¶¶ 
in
¶¶ 
printerGroups
¶¶ ,
)
¶¶, -
PrinterGroups
¶¶. ;
.
¶¶; <
Add
¶¶< ?
(
¶¶? @
pg
¶¶@ B
)
¶¶B C
;
¶¶C D
StatusMessage
¸¸ 
=
¸¸ 
$str
¸¸ 2
;
¸¸2 3
}
¹¹ 	
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº 
{
»» 	
StatusMessage
¼¼ 
=
¼¼ 
$"
¼¼ 
$str
¼¼ %
{
¼¼% &
ex
¼¼& (
.
¼¼( )
Message
¼¼) 0
}
¼¼0 1
"
¼¼1 2
;
¼¼2 3
}
½½ 	
finally
¾¾ 
{
¾¾ 
IsBusy
¾¾ 
=
¾¾ 
false
¾¾  
;
¾¾  !
}
¾¾" #
}
¿¿ 
private
ÁÁ 
async
ÁÁ 
Task
ÁÁ 
LoadGroupsAsync
ÁÁ &
(
ÁÁ& '
Guid
ÁÁ' +

categoryId
ÁÁ, 6
)
ÁÁ6 7
{
ÂÂ 
IsBusy
ÃÃ 
=
ÃÃ 
true
ÃÃ 
;
ÃÃ 
try
ÄÄ 
{
ÅÅ 	
var
ÆÆ 
groups
ÆÆ 
=
ÆÆ 
await
ÆÆ 
_groupRepository
ÆÆ /
.
ÆÆ/ 0"
GetByCategoryIdAsync
ÆÆ0 D
(
ÆÆD E

categoryId
ÆÆE O
)
ÆÆO P
;
ÆÆP Q
Groups
ÇÇ 
.
ÇÇ 
Clear
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
foreach
ÈÈ 
(
ÈÈ 
var
ÈÈ 
g
ÈÈ 
in
ÈÈ 
groups
ÈÈ $
)
ÈÈ$ %
Groups
ÈÈ& ,
.
ÈÈ, -
Add
ÈÈ- 0
(
ÈÈ0 1
g
ÈÈ1 2
)
ÈÈ2 3
;
ÈÈ3 4
}
ÉÉ 	
finally
ÊÊ 
{
ÊÊ 
IsBusy
ÊÊ 
=
ÊÊ 
false
ÊÊ  
;
ÊÊ  !
}
ÊÊ" #
}
ËË 
private
ÍÍ 
async
ÍÍ 
Task
ÍÍ 
LoadItemsAsync
ÍÍ %
(
ÍÍ% &
Guid
ÍÍ& *

categoryId
ÍÍ+ 5
,
ÍÍ5 6
Guid
ÍÍ7 ;
groupId
ÍÍ< C
)
ÍÍC D
{
ÎÎ 
IsBusy
ÏÏ 
=
ÏÏ 
true
ÏÏ 
;
ÏÏ 
try
ÐÐ 
{
ÑÑ 	
var
ÒÒ 
items
ÒÒ 
=
ÒÒ 
await
ÒÒ 
_menuRepository
ÒÒ -
.
ÒÒ- .
GetByGroupAsync
ÒÒ. =
(
ÒÒ= >
groupId
ÒÒ> E
)
ÒÒE F
;
ÒÒF G
Items
ÓÓ 
.
ÓÓ 
Clear
ÓÓ 
(
ÓÓ 
)
ÓÓ 
;
ÓÓ 
foreach
ÔÔ 
(
ÔÔ 
var
ÔÔ 
i
ÔÔ 
in
ÔÔ 
items
ÔÔ #
)
ÔÔ# $
Items
ÔÔ% *
.
ÔÔ* +
Add
ÔÔ+ .
(
ÔÔ. /
i
ÔÔ/ 0
)
ÔÔ0 1
;
ÔÔ1 2
}
ÕÕ 	
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ 
{
×× 	
StatusMessage
ØØ 
=
ØØ 
$"
ØØ 
$str
ØØ 2
{
ØØ2 3
ex
ØØ3 5
.
ØØ5 6
Message
ØØ6 =
}
ØØ= >
"
ØØ> ?
;
ØØ? @
}
ÙÙ 	
finally
ÚÚ 
{
ÚÚ 
IsBusy
ÚÚ 
=
ÚÚ 
false
ÚÚ  
;
ÚÚ  !
}
ÚÚ" #
}
ÛÛ 
private
ÝÝ 
async
ÝÝ 
Task
ÝÝ "
LoadRecipeLinesAsync
ÝÝ +
(
ÝÝ+ ,
MenuItem
ÝÝ, 4
item
ÝÝ5 9
)
ÝÝ9 :
{
ÞÞ 
RecipeLines
ßß 
.
ßß 
Clear
ßß 
(
ßß 
)
ßß 
;
ßß 
if
ââ 

(
ââ 
InventoryOptions
ââ 
.
ââ 
Count
ââ "
==
ââ# %
$num
ââ& '
)
ââ' (
{
ãã 	
var
ää 
invItems
ää 
=
ää 
await
ää !"
_inventoryRepository
ää" 6
.
ää6 7
GetAllAsync
ää7 B
(
ääB C
)
ääC D
;
ääD E
foreach
åå 
(
åå 
var
åå 
inv
åå 
in
åå  
invItems
åå! )
)
åå) *
InventoryOptions
åå+ ;
.
åå; <
Add
åå< ?
(
åå? @
inv
åå@ C
)
ååC D
;
ååD E
}
ææ 	
foreach
èè 
(
èè 
var
èè 
line
èè 
in
èè 
item
èè !
.
èè! "
RecipeLines
èè" -
)
èè- .
{
éé 	
var
êê 
invItem
êê 
=
êê 
InventoryOptions
êê *
.
êê* +
FirstOrDefault
êê+ 9
(
êê9 :
x
êê: ;
=>
êê< >
x
êê? @
.
êê@ A
Id
êêA C
==
êêD F
line
êêG K
.
êêK L
InventoryItemId
êêL [
)
êê[ \
;
êê\ ]
if
ëë 
(
ëë 
invItem
ëë 
!=
ëë 
null
ëë 
)
ëë  
{
ìì 
RecipeLines
íí 
.
íí 
Add
íí 
(
íí  
new
íí  #!
RecipeLineViewModel
íí$ 7
(
íí7 8
invItem
íí8 ?
,
íí? @
line
ííA E
.
ííE F
Quantity
ííF N
)
ííN O
)
ííO P
;
ííP Q
}
îî 
}
ïï 	
}
ðð 
private
òò 
async
òò 
Task
òò  
AddRecipeLineAsync
òò )
(
òò) *
)
òò* +
{
óó 
if
ôô 

(
ôô 
SelectedItem
ôô 
==
ôô 
null
ôô  
||
ôô! #%
SelectedInventoryOption
ôô$ ;
==
ôô< >
null
ôô? C
)
ôôC D
return
ôôE K
;
ôôK L
if
öö 

(
öö 
decimal
öö 
.
öö 
TryParse
öö 
(
öö 
NewRecipeQuantity
öö .
,
öö. /
out
öö0 3
var
öö4 7
qty
öö8 ;
)
öö; <
)
öö< =
{
÷÷ 	
SelectedItem
ùù 
.
ùù 
AddRecipeLine
ùù &
(
ùù& '%
SelectedInventoryOption
ùù' >
.
ùù> ?
Id
ùù? A
,
ùùA B
qty
ùùC F
)
ùùF G
;
ùùG H
RecipeLines
üü 
.
üü 
Add
üü 
(
üü 
new
üü !
RecipeLineViewModel
üü  3
(
üü3 4%
SelectedInventoryOption
üü4 K
,
üüK L
qty
üüM P
)
üüP Q
)
üüQ R
;
üüR S
StatusMessage
ÿÿ 
=
ÿÿ 
$str
ÿÿ 0
;
ÿÿ0 1
}
€€ 	
else
 
{
‚‚ 	
StatusMessage
ƒƒ 
=
ƒƒ 
$str
ƒƒ .
;
ƒƒ. /
}
„„ 	
}
…… 
private
‡‡ 
async
‡‡ 
Task
‡‡ #
RemoveRecipeLineAsync
‡‡ ,
(
‡‡, -
)
‡‡- .
{
ˆˆ 
if
‰‰ 

(
‰‰ 
SelectedItem
‰‰ 
==
‰‰ 
null
‰‰  
||
‰‰! # 
SelectedRecipeLine
‰‰$ 6
==
‰‰7 9
null
‰‰: >
)
‰‰> ?
return
‰‰@ F
;
‰‰F G
SelectedItem
ŒŒ 
.
ŒŒ 
RemoveRecipeLine
ŒŒ %
(
ŒŒ% & 
SelectedRecipeLine
ŒŒ& 8
.
ŒŒ8 9
InventoryItemId
ŒŒ9 H
)
ŒŒH I
;
ŒŒI J
RecipeLines
 
.
 
Remove
 
(
  
SelectedRecipeLine
 -
)
- .
;
. / 
SelectedRecipeLine
 
=
 
null
 !
;
! "
StatusMessage
‘‘ 
=
‘‘ 
$str
‘‘ .
;
‘‘. /
}
’’ 
}““ ó¬
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\ManagerFunctionsViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
{ 
public 

partial 
class %
ManagerFunctionsViewModel 2
:3 4
ViewModelBase5 B
{ 
private 
readonly 
NavigationService *
_navigationService+ =
;= >
private 
readonly "
ICashSessionRepository /"
_cashSessionRepository0 F
;F G
private 
readonly 
IUserService %
_userService& 2
;2 3
private 
readonly 
ITerminalContext )
_terminalContext* :
;: ;
private 
readonly 
ICommandHandler (
<( )
ClockInCommand) 7
>7 8
_clockInHandler9 H
;H I
private 
readonly 
ICommandHandler (
<( )
ClockOutCommand) 8
>8 9
_clockOutHandler: J
;J K
private 
readonly 
ICommandHandler (
<( )#
CloseCashSessionCommand) @
,@ A"
CloseCashSessionResultB X
>X Y 
_closeSessionHandlerZ n
;n o
public %
ManagerFunctionsViewModel (
(( )
NavigationService 
navigationService /
,/ 0"
ICashSessionRepository "!
cashSessionRepository# 8
,8 9
IUserService 
userService $
,$ %
ITerminalContext 
terminalContext ,
,, -
ICommandHandler 
< #
CloseCashSessionCommand 3
,3 4"
CloseCashSessionResult5 K
>K L
closeSessionHandlerM `
,` a
ICommandHandler 
< 
ClockInCommand *
>* +
clockInHandler, :
,: ;
ICommandHandler 
< 
ClockOutCommand +
>+ ,
clockOutHandler- <
)< =
{ 	
_navigationService   
=    
navigationService  ! 2
;  2 3"
_cashSessionRepository!! "
=!!# $!
cashSessionRepository!!% :
;!!: ;
_userService"" 
="" 
userService"" &
;""& '
_terminalContext## 
=## 
terminalContext## .
;##. / 
_closeSessionHandler$$  
=$$! "
closeSessionHandler$$# 6
;$$6 7
_clockInHandler%% 
=%% 
clockInHandler%% ,
;%%, -
_clockOutHandler&& 
=&& 
clockOutHandler&& .
;&&. /
Title(( 
=(( 
$str(( '
;((' (
})) 	
public++ 
Action++ 
?++ 
CloseAction++ "
{++# $
get++% (
;++( )
set++* -
;++- .
}++/ 0
[-- 	
RelayCommand--	 
]-- 
private.. 
async.. 
Task.. 
DrawerPullAsync.. *
(..* +
)..+ ,
{// 	
CloseAction00 
?00 
.00 
Invoke00 
(00  
)00  !
;00! "
await11 
Task11 
.11 
Delay11 
(11 
$num11  
)11  !
;11! "
var44 
dialog44 
=44 
new44 
Views44 "
.44" #"
DrawerPullReportDialog44# 9
(449 :
)44: ;
;44; <
dialog55 
.55 
XamlRoot55 
=55 
App55 !
.55! "
MainWindowInstance55" 4
.554 5
Content555 <
.55< =
XamlRoot55= E
;55E F
await66 
_navigationService66 $
.66$ %
ShowDialogAsync66% 4
(664 5
dialog665 ;
)66; <
;66< =
}77 	
[99 	
RelayCommand99	 
]99 
private:: 
async:: 
Task:: 
CashDropAsync:: (
(::( )
)::) *
{;; 	
CloseAction<< 
?<< 
.<< 
Invoke<< 
(<<  
)<<  !
;<<! "
await== 
Task== 
.== 
Delay== 
(== 
$num==  
)==  !
;==! "
var@@ 
dialog@@ 
=@@ 
new@@ 
Views@@ "
.@@" #$
CashDropManagementDialog@@# ;
(@@; <
)@@< =
;@@= >
dialogAA 
.AA 
XamlRootAA 
=AA 
AppAA !
.AA! "
MainWindowInstanceAA" 4
.AA4 5
ContentAA5 <
.AA< =
XamlRootAA= E
;AAE F
awaitBB 
_navigationServiceBB $
.BB$ %
ShowDialogAsyncBB% 4
(BB4 5
dialogBB5 ;
)BB; <
;BB< =
}CC 	
[EE 	
RelayCommandEE	 
]EE 
privateFF 
asyncFF 
TaskFF 
OpenTicketsAsyncFF +
(FF+ ,
)FF, -
{GG 	
CloseActionHH 
?HH 
.HH 
InvokeHH 
(HH  
)HH  !
;HH! "
awaitII 
TaskII 
.II 
DelayII 
(II 
$numII  
)II  !
;II! "
varLL 
dialogLL 
=LL 
newLL 
ViewsLL "
.LL" #!
OpenTicketsListDialogLL# 8
(LL8 9
)LL9 :
;LL: ;
dialogMM 
.MM 
XamlRootMM 
=MM 
AppMM !
.MM! "
MainWindowInstanceMM" 4
.MM4 5
ContentMM5 <
.MM< =
XamlRootMM= E
;MME F
awaitNN 
_navigationServiceNN $
.NN$ %
ShowDialogAsyncNN% 4
(NN4 5
dialogNN5 ;
)NN; <
;NN< =
}OO 	
[QQ 	
RelayCommandQQ	 
]QQ 
privateRR 
asyncRR 
TaskRR 
ReportsAsyncRR '
(RR' (
)RR( )
{SS 	
CloseActionTT 
?TT 
.TT 
InvokeTT 
(TT  
)TT  !
;TT! "
awaitUU 
TaskUU 
.UU 
DelayUU 
(UU 
$numUU  
)UU  !
;UU! "
_navigationServiceXX 
.XX 
NavigateXX '
(XX' (
typeofXX( .
(XX. /
ViewsXX/ 4
.XX4 5
BackOfficePageXX5 C
)XXC D
,XXD E
typeofXXF L
(XXL M
ViewsXXM R
.XXR S
SalesReportsPageXXS c
)XXc d
)XXd e
;XXe f
}YY 	
[[[ 	
RelayCommand[[	 
][[ 
private\\ 
async\\ 
Task\\ 
ClockInOutAsync\\ *
(\\* +
)\\+ ,
{]] 	
CloseAction^^ 
?^^ 
.^^ 
Invoke^^ 
(^^  
)^^  !
;^^! "
await__ 
Task__ 
.__ 
Delay__ 
(__ 
$num__  
)__  !
;__! "
ifaa 
(aa 
_userServiceaa 
.aa 
CurrentUseraa (
?aa( )
.aa) *
Idaa* ,
==aa- /
nullaa0 4
)aa4 5
returnaa6 <
;aa< =
vardd 
dialogdd 
=dd 
newdd 
	Microsoftdd &
.dd& '
UIdd' )
.dd) *
Xamldd* .
.dd. /
Controlsdd/ 7
.dd7 8
ContentDialogdd8 E
{ee 
Titleff 
=ff 
$strff $
,ff$ %
Contentgg 
=gg 
$strgg *
,gg* +
PrimaryButtonTexthh !
=hh" #
$strhh$ .
,hh. /
SecondaryButtonTextii #
=ii$ %
$strii& 1
,ii1 2
CloseButtonTextjj 
=jj  !
$strjj" *
,jj* +
XamlRootkk 
=kk 
Appkk 
.kk 
MainWindowInstancekk 1
.kk1 2
Contentkk2 9
.kk9 :
XamlRootkk: B
}ll 
;ll 
varnn 
resultnn 
=nn 
awaitnn 
_navigationServicenn 1
.nn1 2
ShowDialogAsyncnn2 A
(nnA B
dialognnB H
)nnH I
;nnI J
trypp 
{qq 
ifrr 
(rr 
resultrr 
==rr 
	Microsoftrr '
.rr' (
UIrr( *
.rr* +
Xamlrr+ /
.rr/ 0
Controlsrr0 8
.rr8 9
ContentDialogResultrr9 L
.rrL M
PrimaryrrM T
)rrT U
{ss 
awaituu 
_clockInHandleruu )
.uu) *
HandleAsyncuu* 5
(uu5 6
newuu6 9
ClockInCommanduu: H
{uuI J
UserIduuK Q
=uuR S
_userServiceuuT `
.uu` a
CurrentUseruua l
.uul m
Iduum o
}uup q
)uuq r
;uur s
varww 
successww 
=ww  !
newww" %
	Microsoftww& /
.ww/ 0
UIww0 2
.ww2 3
Xamlww3 7
.ww7 8
Controlsww8 @
.ww@ A
ContentDialogwwA N
{xx 
Titleyy 
=yy  
$stryy! *
,yy* +
Contentzz  
=zz! "
$strzz# <
,zz< =
CloseButtonText{{ (
={{) *
$str{{+ /
,{{/ 0
XamlRoot|| !
=||" #
App||$ '
.||' (
MainWindowInstance||( :
.||: ;
Content||; B
.||B C
XamlRoot||C K
}}} 
;}} 
await~~ 
_navigationService~~ ,
.~~, -
ShowDialogAsync~~- <
(~~< =
success~~= D
)~~D E
;~~E F
} 
else
€€ 
if
€€ 
(
€€ 
result
€€ 
==
€€  "
	Microsoft
€€# ,
.
€€, -
UI
€€- /
.
€€/ 0
Xaml
€€0 4
.
€€4 5
Controls
€€5 =
.
€€= >!
ContentDialogResult
€€> Q
.
€€Q R
	Secondary
€€R [
)
€€[ \
{
 
await
ƒƒ 
_clockOutHandler
ƒƒ *
.
ƒƒ* +
HandleAsync
ƒƒ+ 6
(
ƒƒ6 7
new
ƒƒ7 :
ClockOutCommand
ƒƒ; J
{
ƒƒK L
UserId
ƒƒM S
=
ƒƒT U
_userService
ƒƒV b
.
ƒƒb c
CurrentUser
ƒƒc n
.
ƒƒn o
Id
ƒƒo q
}
ƒƒr s
)
ƒƒs t
;
ƒƒt u
var
…… 
success
…… 
=
……  !
new
……" %
	Microsoft
……& /
.
……/ 0
UI
……0 2
.
……2 3
Xaml
……3 7
.
……7 8
Controls
……8 @
.
……@ A
ContentDialog
……A N
{
†† 
Title
‡‡ 
=
‡‡  
$str
‡‡! *
,
‡‡* +
Content
ˆˆ  
=
ˆˆ! "
$str
ˆˆ# =
,
ˆˆ= >
CloseButtonText
‰‰ (
=
‰‰) *
$str
‰‰+ /
,
‰‰/ 0
XamlRoot
ŠŠ !
=
ŠŠ" #
App
ŠŠ$ '
.
ŠŠ' ( 
MainWindowInstance
ŠŠ( :
.
ŠŠ: ;
Content
ŠŠ; B
.
ŠŠB C
XamlRoot
ŠŠC K
}
‹‹ 
;
‹‹ 
await
ŒŒ  
_navigationService
ŒŒ ,
.
ŒŒ, -
ShowDialogAsync
ŒŒ- <
(
ŒŒ< =
success
ŒŒ= D
)
ŒŒD E
;
ŒŒE F
}
 
}
ŽŽ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
var
‘‘ 
error
‘‘ 
=
‘‘ 
new
‘‘ 
	Microsoft
‘‘  )
.
‘‘) *
UI
‘‘* ,
.
‘‘, -
Xaml
‘‘- 1
.
‘‘1 2
Controls
‘‘2 :
.
‘‘: ;
ContentDialog
‘‘; H
{
’’ 
Title
““ 
=
““ 
$str
““  '
,
““' (
Content
”” 
=
””  !
$"
””" $
$str
””$ 9
{
””9 :
ex
””: <
.
””< =
Message
””= D
}
””D E
"
””E F
,
””F G
CloseButtonText
•• '
=
••( )
$str
••* .
,
••. /
XamlRoot
––  
=
––! "
App
––# &
.
––& ' 
MainWindowInstance
––' 9
.
––9 :
Content
––: A
.
––A B
XamlRoot
––B J
}
—— 
;
—— 
await
˜˜  
_navigationService
˜˜ (
.
˜˜( )
ShowDialogAsync
˜˜) 8
(
˜˜8 9
error
˜˜9 >
)
˜˜> ?
;
˜˜? @
}
™™ 
}
šš 	
[
œœ 	
RelayCommand
œœ	 
]
œœ 
private
 
async
 
Task
 
SettingsAsync
 (
(
( )
)
) *
{
žž 	
CloseAction
ŸŸ 
?
ŸŸ 
.
ŸŸ 
Invoke
ŸŸ 
(
ŸŸ  
)
ŸŸ  !
;
ŸŸ! "
await
   
Task
   
.
   
Delay
   
(
   
$num
    
)
    !
;
  ! " 
_navigationService
¤¤ 
.
¤¤ 
Navigate
¤¤ '
(
¤¤' (
typeof
¤¤( .
(
¤¤. /
Views
¤¤/ 4
.
¤¤4 5
BackOfficePage
¤¤5 C
)
¤¤C D
,
¤¤D E
typeof
¤¤F L
(
¤¤L M
Views
¤¤M R
.
¤¤R S
SystemConfigPage
¤¤S c
)
¤¤c d
)
¤¤d e
;
¤¤e f
await
¥¥ 
Task
¥¥ 
.
¥¥ 
CompletedTask
¥¥ $
;
¥¥$ %
}
¦¦ 	
[
¨¨ 	
RelayCommand
¨¨	 
]
¨¨ 
private
©© 
async
©© 
Task
©© 
EndShiftAsync
©© (
(
©©( )
)
©©) *
{
ªª 	
CloseAction
«« 
?
«« 
.
«« 
Invoke
«« 
(
««  
)
««  !
;
««! "
await
¬¬ 
Task
¬¬ 
.
¬¬ 
Delay
¬¬ 
(
¬¬ 
$num
¬¬  
)
¬¬  !
;
¬¬! "
if
¯¯ 
(
¯¯ 
_userService
¯¯ 
.
¯¯ 
CurrentUser
¯¯ (
?
¯¯( )
.
¯¯) *
Id
¯¯* ,
==
¯¯- /
null
¯¯0 4
||
¯¯5 7
_terminalContext
¯¯8 H
.
¯¯H I

TerminalId
¯¯I S
==
¯¯T V
null
¯¯W [
)
¯¯[ \
{
°° 
return
±± 
;
±± 
}
²² 
var
´´ 

terminalId
´´ 
=
´´ 
_terminalContext
´´ -
.
´´- .

TerminalId
´´. 8
.
´´8 9
Value
´´9 >
;
´´> ?
var
µµ 
session
µµ 
=
µµ 
await
µµ $
_cashSessionRepository
µµ  6
.
µµ6 7-
GetOpenSessionByTerminalIdAsync
µµ7 V
(
µµV W

terminalId
µµW a
)
µµa b
;
µµb c
if
·· 
(
·· 
session
·· 
==
·· 
null
·· 
)
··  
{
¸¸ 
var
¹¹ 
noSessionDialog
¹¹ #
=
¹¹$ %
new
¹¹& )
	Microsoft
¹¹* 3
.
¹¹3 4
UI
¹¹4 6
.
¹¹6 7
Xaml
¹¹7 ;
.
¹¹; <
Controls
¹¹< D
.
¹¹D E
ContentDialog
¹¹E R
{
ºº 
Title
»» 
=
»» 
$str
»» /
,
»»/ 0
Content
¼¼ 
=
¼¼ 
$str
¼¼ I
,
¼¼I J
CloseButtonText
½½ #
=
½½$ %
$str
½½& *
,
½½* +
XamlRoot
¾¾ 
=
¾¾ 
App
¾¾ "
.
¾¾" # 
MainWindowInstance
¾¾# 5
.
¾¾5 6
Content
¾¾6 =
.
¾¾= >
XamlRoot
¾¾> F
}
¿¿ 
;
¿¿ 
await
ÀÀ  
_navigationService
ÀÀ (
.
ÀÀ( )
ShowDialogAsync
ÀÀ) 8
(
ÀÀ8 9
noSessionDialog
ÀÀ9 H
)
ÀÀH I
;
ÀÀI J
return
ÁÁ 
;
ÁÁ 
}
ÂÂ 
var
ÅÅ 
vm
ÅÅ 
=
ÅÅ 
new
ÅÅ 
Dialogs
ÅÅ  
.
ÅÅ  !
ShiftEndViewModel
ÅÅ! 2
(
ÅÅ2 3
session
ÅÅ3 :
,
ÅÅ: ;
_userService
ÅÅ< H
.
ÅÅH I
CurrentUser
ÅÅI T
.
ÅÅT U
Id
ÅÅU W
,
ÅÅW X"
_closeSessionHandler
ÅÅY m
)
ÅÅm n
;
ÅÅn o
var
ÆÆ 
dialog
ÆÆ 
=
ÆÆ 
new
ÆÆ 
Views
ÆÆ "
.
ÆÆ" #
Dialogs
ÆÆ# *
.
ÆÆ* +
ShiftEndDialog
ÆÆ+ 9
(
ÆÆ9 :
vm
ÆÆ: <
)
ÆÆ< =
;
ÆÆ= >
dialog
ÇÇ 
.
ÇÇ 
XamlRoot
ÇÇ 
=
ÇÇ 
App
ÇÇ !
.
ÇÇ! " 
MainWindowInstance
ÇÇ" 4
.
ÇÇ4 5
Content
ÇÇ5 <
.
ÇÇ< =
XamlRoot
ÇÇ= E
;
ÇÇE F
await
ÉÉ  
_navigationService
ÉÉ $
.
ÉÉ$ %
ShowDialogAsync
ÉÉ% 4
(
ÉÉ4 5
dialog
ÉÉ5 ;
)
ÉÉ; <
;
ÉÉ< =
}
ÊÊ 	
[
ÌÌ 	
RelayCommand
ÌÌ	 
]
ÌÌ 
private
ÍÍ 
async
ÍÍ 
Task
ÍÍ 
RefundTicketAsync
ÍÍ ,
(
ÍÍ, -
)
ÍÍ- .
{
ÎÎ 	
CloseAction
ÏÏ 
?
ÏÏ 
.
ÏÏ 
Invoke
ÏÏ 
(
ÏÏ  
)
ÏÏ  !
;
ÏÏ! "
await
ÐÐ 
Task
ÐÐ 
.
ÐÐ 
Delay
ÐÐ 
(
ÐÐ 
$num
ÐÐ  
)
ÐÐ  !
;
ÐÐ! " 
_navigationService
ÔÔ 
.
ÔÔ 
Navigate
ÔÔ '
(
ÔÔ' (
typeof
ÔÔ( .
(
ÔÔ. /
Views
ÔÔ/ 4
.
ÔÔ4 5"
TicketManagementPage
ÔÔ5 I
)
ÔÔI J
)
ÔÔJ K
;
ÔÔK L
}
ÕÕ 	
[
×× 	
RelayCommand
××	 
]
×× 
private
ØØ 
async
ØØ 
Task
ØØ 
GroupSettleAsync
ØØ +
(
ØØ+ ,
)
ØØ, -
{
ÙÙ 	
CloseAction
ÚÚ 
?
ÚÚ 
.
ÚÚ 
Invoke
ÚÚ 
(
ÚÚ  
)
ÚÚ  !
;
ÚÚ! "
await
ÛÛ 
Task
ÛÛ 
.
ÛÛ 
Delay
ÛÛ 
(
ÛÛ 
$num
ÛÛ  
)
ÛÛ  !
;
ÛÛ! "
var
ÞÞ 
selectionWindow
ÞÞ 
=
ÞÞ  !
new
ÞÞ" %
Views
ÞÞ& +
.
ÞÞ+ ,.
 GroupSettleTicketSelectionWindow
ÞÞ, L
(
ÞÞL M
)
ÞÞM N
;
ÞÞN O
selectionWindow
ßß 
.
ßß 
XamlRoot
ßß $
=
ßß% &
App
ßß' *
.
ßß* + 
MainWindowInstance
ßß+ =
.
ßß= >
Content
ßß> E
.
ßßE F
XamlRoot
ßßF N
;
ßßN O
var
àà 
selectionResult
àà 
=
àà  !
await
àà" ' 
_navigationService
àà( :
.
àà: ;
ShowDialogAsync
àà; J
(
ààJ K
selectionWindow
ààK Z
)
ààZ [
;
àà[ \
if
ââ 
(
ââ 
selectionResult
ââ 
==
ââ  "
	Microsoft
ââ# ,
.
ââ, -
UI
ââ- /
.
ââ/ 0
Xaml
ââ0 4
.
ââ4 5
Controls
ââ5 =
.
ââ= >!
ContentDialogResult
ââ> Q
.
ââQ R
Primary
ââR Y
)
ââY Z
{
ãã 
var
ää 
selectedTickets
ää #
=
ää$ %
selectionWindow
ää& 5
.
ää5 6
	ViewModel
ää6 ?
.
ää? @
AvailableTickets
ää@ P
.
åå 
Where
åå 
(
åå 
t
åå 
=>
åå 
t
åå  !
.
åå! "

IsSelected
åå" ,
)
åå, -
.
ææ 
ToList
ææ 
(
ææ 
)
ææ 
;
ææ 
if
èè 
(
èè 
selectedTickets
èè #
.
èè# $
Count
èè$ )
>
èè* +
$num
èè, -
)
èè- .
{
éé 
var
êê 
groupSettleDialog
êê )
=
êê* +
new
êê, /
Views
êê0 5
.
êê5 6%
GroupSettleTicketDialog
êê6 M
(
êêM N
)
êêN O
;
êêO P
groupSettleDialog
ëë %
.
ëë% &
XamlRoot
ëë& .
=
ëë/ 0
App
ëë1 4
.
ëë4 5 
MainWindowInstance
ëë5 G
.
ëëG H
Content
ëëH O
.
ëëO P
XamlRoot
ëëP X
;
ëëX Y
var
ìì '
selectedTicketsCollection
ìì 1
=
ìì2 3
new
ìì4 7
System
ìì8 >
.
ìì> ?
Collections
ìì? J
.
ììJ K
ObjectModel
ììK V
.
ììV W"
ObservableCollection
ììW k
<
ììk l#
GroupSettleTicketDtoììl €
>ìì€ 
(ìì ‚
selectedTicketsìì‚ ‘
)ìì‘ ’
;ìì’ “
groupSettleDialog
íí %
.
íí% &
	ViewModel
íí& /
.
íí/ 0 
SetSelectedTickets
íí0 B
(
ííB C'
selectedTicketsCollection
ííC \
)
íí\ ]
;
íí] ^
await
ïï  
_navigationService
ïï ,
.
ïï, -
ShowDialogAsync
ïï- <
(
ïï< =
groupSettleDialog
ïï= N
)
ïïN O
;
ïïO P
}
ðð 
}
ññ 
}
òò 	
}
óó 
}ôô ™—
bC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\LoginViewModel.cs
	namespace

 	
Magidesk


 
.

 
Presentation

 
.

  

ViewModels

  *
;

* +
public 
class 
LoginViewModel 
: 
ViewModelBase +
{ 
private 
readonly 
ISecurityService %
_securityService& 6
;6 7
private 
readonly !
IAesEncryptionService *
_encryptionService+ =
;= >
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ICommandHandler $
<$ %
ClockInCommand% 3
>3 4
_clockInHandler5 D
;D E
private 
readonly 
ICommandHandler $
<$ %
ClockOutCommand% 4
>4 5
_clockOutHandler6 F
;F G
private 
readonly !
IAttendanceRepository *!
_attendanceRepository+ @
;@ A
private 
readonly &
IDefaultViewRoutingService /&
_defaultViewRoutingService0 J
;J K
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private 
string 
_pin 
= 
string  
.  !
Empty! &
;& '
private 
string 
_errorMessage  
=! "
string# )
.) *
Empty* /
;/ 0
public 

LoginViewModel 
( 
ISecurityService 
securityService (
,( )!
IAesEncryptionService 
encryptionService /
,/ 0
NavigationService 
navigationService +
,+ ,
IUserService 
userService  
,  !
ICommandHandler   
<   
ClockInCommand   &
>  & '
clockInHandler  ( 6
,  6 7
ICommandHandler!! 
<!! 
ClockOutCommand!! '
>!!' (
clockOutHandler!!) 8
,!!8 9!
IAttendanceRepository""  
attendanceRepository"" 2
,""2 3&
IDefaultViewRoutingService## "%
defaultViewRoutingService### <
,##< =
ITerminalContext$$ 
terminalContext$$ (
)$$( )
{%% 
_securityService&& 
=&& 
securityService&& *
;&&* +
_encryptionService'' 
='' 
encryptionService'' .
;''. /
_navigationService(( 
=(( 
navigationService(( .
;((. /
_userService)) 
=)) 
userService)) "
;))" #
_clockInHandler** 
=** 
clockInHandler** (
;**( )
_clockOutHandler++ 
=++ 
clockOutHandler++ *
;++* +!
_attendanceRepository,, 
=,,  
attendanceRepository,,  4
;,,4 5&
_defaultViewRoutingService-- "
=--# $%
defaultViewRoutingService--% >
;--> ?
_terminalContext.. 
=.. 
terminalContext.. *
;..* +
AppendDigitCommand00 
=00 
new00  
RelayCommand00! -
<00- .
string00. 4
>004 5
(005 6
AppendDigit006 A
)00A B
;00B C
ClearCommand11 
=11 
new11 
RelayCommand11 '
(11' (
Clear11( -
)11- .
;11. /"
RemoveLastDigitCommand22 
=22  
new22! $
RelayCommand22% 1
(221 2
RemoveLastDigit222 A
)22A B
;22B C
LoginCommand33 
=33 
new33 
AsyncRelayCommand33 ,
(33, -

LoginAsync33- 7
)337 8
;338 9
ShutdownCommand44 
=44 
new44 
RelayCommand44 *
(44* +
Shutdown44+ 3
)443 4
;444 5
ClockInOutCommand55 
=55 
new55 
AsyncRelayCommand55  1
(551 2
ClockInOutAsync552 A
)55A B
;55B C
}66 
public88 

string88 
Pin88 
{99 
get:: 
=>:: 
_pin:: 
;:: 
set;; 
{<< 	
if== 
(== 
SetProperty== 
(== 
ref== 
_pin==  $
,==$ %
value==& +
)==+ ,
)==, -
{>> 
OnPropertyChanged?? !
(??! "
nameof??" (
(??( )
	MaskedPin??) 2
)??2 3
)??3 4
;??4 5
}@@ 
}AA 	
}BB 
publicDD 

stringDD 
	MaskedPinDD 
=>DD 
newDD "
stringDD# )
(DD) *
$charDD* -
,DD- .
PinDD/ 2
.DD2 3
LengthDD3 9
)DD9 :
;DD: ;
publicFF 

stringFF 
ErrorMessageFF 
{GG 
getHH 
=>HH 
_errorMessageHH 
;HH 
setII 
=>II 
SetPropertyII 
(II 
refII 
_errorMessageII ,
,II, -
valueII. 3
)II3 4
;II4 5
}JJ 
publicMM 

ICommandMM 
AppendDigitCommandMM &
{MM' (
getMM) ,
;MM, -
}MM. /
publicNN 

ICommandNN 
ClearCommandNN  
{NN! "
getNN# &
;NN& '
}NN( )
publicOO 

ICommandOO "
RemoveLastDigitCommandOO *
{OO+ ,
getOO- 0
;OO0 1
}OO2 3
publicPP 

ICommandPP 
LoginCommandPP  
{PP! "
getPP# &
;PP& '
}PP( )
publicQQ 

ICommandQQ 
ShutdownCommandQQ #
{QQ$ %
getQQ& )
;QQ) *
}QQ+ ,
publicRR 

ICommandRR 
ClockInOutCommandRR %
{RR& '
getRR( +
;RR+ ,
}RR- .
privateTT 
voidTT 
AppendDigitTT 
(TT 
stringTT #
?TT# $
digitTT% *
)TT* +
{UU 
ifVV 

(VV 
digitVV 
!=VV 
nullVV 
&&VV 
PinVV  
.VV  !
LengthVV! '
<VV( )
$numVV* ,
)VV, -
{WW 	
PinXX 
+=XX 
digitXX 
;XX 
ErrorMessageYY 
=YY 
stringYY !
.YY! "
EmptyYY" '
;YY' (
}ZZ 	
}[[ 
private]] 
void]] 
Clear]] 
(]] 
)]] 
{^^ 
Pin__ 
=__ 
string__ 
.__ 
Empty__ 
;__ 
ErrorMessage`` 
=`` 
string`` 
.`` 
Empty`` #
;``# $
}aa 
privatecc 
voidcc 
RemoveLastDigitcc  
(cc  !
)cc! "
{dd 
ifee 

(ee 
!ee 
stringee 
.ee 
IsNullOrEmptyee !
(ee! "
Pinee" %
)ee% &
)ee& '
{ff 	
Pingg 
=gg 
Pingg 
.gg 
	Substringgg 
(gg  
$numgg  !
,gg! "
Pingg# &
.gg& '
Lengthgg' -
-gg. /
$numgg0 1
)gg1 2
;gg2 3
ErrorMessagehh 
=hh 
stringhh !
.hh! "
Emptyhh" '
;hh' (
}ii 	
}jj 
privatell 
asyncll 
Taskll 
ClockInOutAsyncll &
(ll& '
)ll' (
{mm 
ifnn 

(nn 
stringnn 
.nn 
IsNullOrEmptynn  
(nn  !
Pinnn! $
)nn$ %
)nn% &
{oo 	
ErrorMessagepp 
=pp 
$strpp 7
;pp7 8
returnqq 
;qq 
}rr 	
IsBusytt 
=tt 
truett 
;tt 
ErrorMessageuu 
=uu 
stringuu 
.uu 
Emptyuu #
;uu# $
tryww 
{xx 	
varyy 
encryptedPinyy 
=yy 
_encryptionServiceyy 1
.yy1 2
Encryptyy2 9
(yy9 :
Pinyy: =
)yy= >
;yy> ?
varzz 
userzz 
=zz 
awaitzz 
_securityServicezz -
.zz- .
GetUserByPinAsynczz. ?
(zz? @
encryptedPinzz@ L
)zzL M
;zzM N
if|| 
(|| 
user|| 
!=|| 
null|| 
)|| 
{}} 
var~~ 
openAttendance~~ "
=~~# $
await~~% *!
_attendanceRepository~~+ @
.~~@ A 
GetOpenByUserIdAsync~~A U
(~~U V
user~~V Z
.~~Z [
Id~~[ ]
)~~] ^
;~~^ _
string 
message 
; 
if
 
(
 
openAttendance
 "
!=
# %
null
& *
)
* +
{
‚‚ 
await
ƒƒ 
_clockOutHandler
ƒƒ *
.
ƒƒ* +
HandleAsync
ƒƒ+ 6
(
ƒƒ6 7
new
ƒƒ7 :
ClockOutCommand
ƒƒ; J
{
ƒƒK L
UserId
ƒƒM S
=
ƒƒT U
user
ƒƒV Z
.
ƒƒZ [
Id
ƒƒ[ ]
}
ƒƒ^ _
)
ƒƒ_ `
;
ƒƒ` a
message
„„ 
=
„„ 
$"
„„  
$str
„„  )
{
„„) *
user
„„* .
.
„„. /
	FirstName
„„/ 8
}
„„8 9
$str
„„9 G
"
„„G H
;
„„H I
}
…… 
else
†† 
{
‡‡ 
await
ˆˆ 
_clockInHandler
ˆˆ )
.
ˆˆ) *
HandleAsync
ˆˆ* 5
(
ˆˆ5 6
new
ˆˆ6 9
ClockInCommand
ˆˆ: H
{
ˆˆI J
UserId
ˆˆK Q
=
ˆˆR S
user
ˆˆT X
.
ˆˆX Y
Id
ˆˆY [
}
ˆˆ\ ]
)
ˆˆ] ^
;
ˆˆ^ _
message
‰‰ 
=
‰‰ 
$"
‰‰  
$str
‰‰  )
{
‰‰) *
user
‰‰* .
.
‰‰. /
	FirstName
‰‰/ 8
}
‰‰8 9
$str
‰‰9 F
"
‰‰F G
;
‰‰G H
}
ŠŠ 
var
ŒŒ 
dialog
ŒŒ 
=
ŒŒ 
new
ŒŒ  
ContentDialog
ŒŒ! .
{
 
Title
ŽŽ 
=
ŽŽ 
$str
ŽŽ (
,
ŽŽ( )
Content
 
=
 
message
 %
,
% &
CloseButtonText
 #
=
$ %
$str
& *
,
* +
XamlRoot
‘‘ 
=
‘‘ 
App
‘‘ "
.
‘‘" # 
MainWindowInstance
‘‘# 5
.
‘‘5 6
Content
‘‘6 =
.
‘‘= >
XamlRoot
‘‘> F
}
’’ 
;
’’ 
await
““  
_navigationService
““ (
.
““( )
ShowDialogAsync
““) 8
(
““8 9
dialog
““9 ?
)
““? @
;
““@ A
Pin
•• 
=
•• 
string
•• 
.
•• 
Empty
•• "
;
••" #
}
–– 
else
—— 
{
˜˜ 
ErrorMessage
™™ 
=
™™ 
$str
™™ -
;
™™- .
Pin
šš 
=
šš 
string
šš 
.
šš 
Empty
šš "
;
šš" #
}
›› 
}
œœ 	
catch
 
(
 
	Exception
 
ex
 
)
 
{
žž 	
var
   
errorDialog
   
=
   
new
   "
ContentDialog
  # 0
{
¡¡ 
Title
¢¢ 
=
¢¢ 
$str
¢¢ -
,
¢¢- .
Content
££ 
=
££ 
$"
££ 
$str
££ ,
{
££, -
ex
££- /
.
££/ 0
Message
££0 7
}
££7 8
"
££8 9
,
££9 :
CloseButtonText
¤¤  
=
¤¤! "
$str
¤¤# '
,
¤¤' (
XamlRoot
¥¥ 
=
¥¥ 
App
¥¥ 
.
¥¥   
MainWindowInstance
¥¥  2
.
¥¥2 3
Content
¥¥3 :
.
¥¥: ;
XamlRoot
¥¥; C
}
¦¦ 
;
¦¦ 
await
§§  
_navigationService
§§ %
.
§§% &
ShowDialogAsync
§§& 5
(
§§5 6
errorDialog
§§6 A
)
§§A B
;
§§B C
}
¨¨ 	
finally
©© 
{
ªª 	
IsBusy
«« 
=
«« 
false
«« 
;
«« 
}
¬¬ 	
}
­­ 
private
¯¯ 
async
¯¯ 
Task
¯¯ 

LoginAsync
¯¯ !
(
¯¯! "
)
¯¯" #
{
°° 
if
±± 

(
±± 
string
±± 
.
±± 
IsNullOrEmpty
±±  
(
±±  !
Pin
±±! $
)
±±$ %
)
±±% &
{
²² 	
ErrorMessage
³³ 
=
³³ 
$str
³³ .
;
³³. /
return
´´ 
;
´´ 
}
µµ 	
IsBusy
·· 
=
·· 
true
·· 
;
·· 
ErrorMessage
¸¸ 
=
¸¸ 
string
¸¸ 
.
¸¸ 
Empty
¸¸ #
;
¸¸# $
try
ºº 
{
»» 	
var
¼¼ 
encryptedPin
¼¼ 
=
¼¼  
_encryptionService
¼¼ 1
.
¼¼1 2
Encrypt
¼¼2 9
(
¼¼9 :
Pin
¼¼: =
)
¼¼= >
;
¼¼> ?
var
½½ 
user
½½ 
=
½½ 
await
½½ 
_securityService
½½ -
.
½½- .
GetUserByPinAsync
½½. ?
(
½½? @
encryptedPin
½½@ L
)
½½L M
;
½½M N
if
¿¿ 
(
¿¿ 
user
¿¿ 
!=
¿¿ 
null
¿¿ 
)
¿¿ 
{
ÀÀ 
_userService
ÂÂ 
.
ÂÂ 
CurrentUser
ÂÂ (
=
ÂÂ) *
new
ÂÂ+ .
Magidesk
ÂÂ/ 7
.
ÂÂ7 8
Application
ÂÂ8 C
.
ÂÂC D
DTOs
ÂÂD H
.
ÂÂH I
UserDto
ÂÂI P
{
ÃÃ 
Id
ÄÄ 
=
ÄÄ 
user
ÄÄ 
.
ÄÄ 
Id
ÄÄ  
,
ÄÄ  !
	FirstName
ÅÅ 
=
ÅÅ 
user
ÅÅ  $
.
ÅÅ$ %
	FirstName
ÅÅ% .
,
ÅÅ. /
LastName
ÆÆ 
=
ÆÆ 
user
ÆÆ #
.
ÆÆ# $
LastName
ÆÆ$ ,
,
ÆÆ, -
Username
ÇÇ 
=
ÇÇ 
user
ÇÇ #
.
ÇÇ# $
Username
ÇÇ$ ,
,
ÇÇ, -

TerminalId
ÈÈ 
=
ÈÈ  
_terminalContext
ÈÈ! 1
.
ÈÈ1 2

TerminalId
ÈÈ2 <
??
ÈÈ= ?
Guid
ÈÈ@ D
.
ÈÈD E
Empty
ÈÈE J
}
ÉÉ 
;
ÉÉ 
if
ÍÍ 
(
ÍÍ 
App
ÍÍ 
.
ÍÍ  
MainWindowInstance
ÍÍ *
is
ÍÍ+ -

MainWindow
ÍÍ. 8

mainWindow
ÍÍ9 C
)
ÍÍC D
{
ÎÎ 

mainWindow
ÏÏ 
.
ÏÏ 
SetUser
ÏÏ &
(
ÏÏ& '
$"
ÏÏ' )
{
ÏÏ) *
user
ÏÏ* .
.
ÏÏ. /
	FirstName
ÏÏ/ 8
}
ÏÏ8 9
$str
ÏÏ9 :
{
ÏÏ: ;
user
ÏÏ; ?
.
ÏÏ? @
LastName
ÏÏ@ H
}
ÏÏH I
"
ÏÏI J
)
ÏÏJ K
;
ÏÏK L
}
ÐÐ 
try
ÓÓ 
{
ÔÔ 
var
ÕÕ 
defaultViewType
ÕÕ '
=
ÕÕ( )
await
ÕÕ* /(
_defaultViewRoutingService
ÕÕ0 J
.
ÕÕJ K%
GetDefaultViewTypeAsync
ÕÕK b
(
ÕÕb c
_userService
ÕÕc o
.
ÕÕo p
CurrentUser
ÕÕp {
?
ÕÕ{ |
.
ÕÕ| }

TerminalIdÕÕ} ‡
)ÕÕ‡ ˆ
;ÕÕˆ ‰ 
_navigationService
ÖÖ &
.
ÖÖ& '
Navigate
ÖÖ' /
(
ÖÖ/ 0
defaultViewType
ÖÖ0 ?
)
ÖÖ? @
;
ÖÖ@ A
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ  
	routingEx
ØØ! *
)
ØØ* +
{
ÙÙ  
_navigationService
ÜÜ &
.
ÜÜ& '
Navigate
ÜÜ' /
(
ÜÜ/ 0
typeof
ÜÜ0 6
(
ÜÜ6 7
Views
ÜÜ7 <
.
ÜÜ< =
SwitchboardPage
ÜÜ= L
)
ÜÜL M
)
ÜÜM N
;
ÜÜN O
await
ÞÞ  
_navigationService
ÞÞ ,
.
ÞÞ, -
ShowMessageAsync
ÞÞ- =
(
ÞÞ= >
$str
ÞÞ> P
,
ÞÞP Q
$"
ÞÞR T
$str
ÞÞT q
{
ÞÞq r
	routingEx
ÞÞr {
.
ÞÞ{ |
MessageÞÞ| ƒ
}ÞÞƒ „
$strÞÞ„ ž
"ÞÞž Ÿ
)ÞÞŸ  
;ÞÞ  ¡
}
ßß 
Pin
àà 
=
àà 
string
àà 
.
àà 
Empty
àà "
;
àà" #
}
áá 
else
ââ 
{
ãã 
ErrorMessage
ää 
=
ää 
$str
ää -
;
ää- .
Pin
åå 
=
åå 
string
åå 
.
åå 
Empty
åå "
;
åå" #
}
ææ 
}
çç 	
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè 
{
éé 	
var
ëë 
errorDialog
ëë 
=
ëë 
new
ëë "
ContentDialog
ëë# 0
{
ìì 
Title
íí 
=
íí 
$str
íí '
,
íí' (
Content
îî 
=
îî 
$"
îî 
$str
îî 5
{
îî5 6
ex
îî6 8
.
îî8 9
Message
îî9 @
}
îî@ A
$str
îîA w
"
îîw x
,
îîx y
CloseButtonText
ïï  
=
ïï! "
$str
ïï# '
,
ïï' (
XamlRoot
ðð 
=
ðð 
App
ðð 
.
ðð   
MainWindowInstance
ðð  2
.
ðð2 3
Content
ðð3 :
.
ðð: ;
XamlRoot
ðð; C
}
ññ 
;
ññ 
await
òò  
_navigationService
òò %
.
òò% &
ShowDialogAsync
òò& 5
(
òò5 6
errorDialog
òò6 A
)
òòA B
;
òòB C
}
óó 	
finally
ôô 
{
õõ 	
IsBusy
öö 
=
öö 
false
öö 
;
öö 
}
÷÷ 	
}
øø 
private
úú 
void
úú 
Shutdown
úú 
(
úú 
)
úú 
{
ûû 
App
üü 
.
üü 
Current
üü 
.
üü 
Exit
üü 
(
üü 
)
üü 
;
üü 
}
ýý 
}þþ '
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\KitchenOrderViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
class

 !
KitchenOrderViewModel

 "
:

# $
ViewModelBase

% 2
{ 
private 
readonly 
KitchenOrder !
_order" (
;( )
public 

Guid 
Id 
=> 
_order 
. 
Id 
;  
public 

string 
TableNumber 
=>  
_order! '
.' (
TableNumber( 3
;3 4
public 

string 

ServerName 
=> 
_order  &
.& '

ServerName' 1
;1 2
public 

KitchenStatus 
Status 
=>  "
_order# )
.) *
Status* 0
;0 1
public 

DateTime 
	Timestamp 
=>  
_order! '
.' (
	Timestamp( 1
;1 2
public 

string 
TimeAgo 
{ 
get 
{ 	
var 
span 
= 
DateTime 
.  
UtcNow  &
-' (
_order) /
./ 0
	Timestamp0 9
;9 :
if 
( 
span 
. 
TotalMinutes !
<" #
$num$ %
)% &
return' -
$str. 8
;8 9
if 
( 
span 
. 

TotalHours 
<  !
$num" #
)# $
return% +
$", .
{. /
span/ 3
.3 4
Minutes4 ;
}; <
$str< A
"A B
;B C
return 
$" 
{ 
span 
. 
Hours  
}  !
$str! #
{# $
span$ (
.( )
Minutes) 0
}0 1
$str1 6
"6 7
;7 8
} 	
} 
public   

bool   
IsLate   
=>   
(   
DateTime   #
.  # $
UtcNow  $ *
-  + ,
_order  - 3
.  3 4
	Timestamp  4 =
)  = >
.  > ?
TotalMinutes  ? K
>  L M
$num  N P
;  P Q
public"" 
 
ObservableCollection"" 
<""  %
KitchenOrderItemViewModel""  9
>""9 :
Items""; @
{""A B
get""C F
;""F G
}""H I
=""J K
new""L O
(""O P
)""P Q
;""Q R
public$$ 
!
KitchenOrderViewModel$$  
($$  !
KitchenOrder$$! -
order$$. 3
)$$3 4
{%% 
_order&& 
=&& 
order&& 
;&& 
foreach'' 
('' 
var'' 
item'' 
in'' 
order'' !
.''! "
Items''" '
)''' (
{(( 	
Items)) 
.)) 
Add)) 
()) 
new)) %
KitchenOrderItemViewModel)) 3
())3 4
item))4 8
)))8 9
)))9 :
;)): ;
}** 	
}++ 
},, 
public.. 
class.. %
KitchenOrderItemViewModel.. &
{// 
private00 
readonly00 
KitchenOrderItem00 %
_item00& +
;00+ ,
public22 

string22 
Quantity22 
=>22 
_item22 #
.22# $
Quantity22$ ,
.22, -
ToString22- 5
(225 6
)226 7
;227 8
public33 

string33 
Name33 
=>33 
_item33 
.33  
ItemName33  (
;33( )
public44 

string44 
	Modifiers44 
{44 
get44 !
;44! "
}44# $
public66 
%
KitchenOrderItemViewModel66 $
(66$ %
KitchenOrderItem66% 5
item666 :
)66: ;
{77 
_item88 
=88 
item88 
;88 
	Modifiers:: 
=:: 
_item:: 
.:: 
	Modifiers:: #
!=::$ &
null::' +
&&::, .
_item::/ 4
.::4 5
	Modifiers::5 >
.::> ?
Any::? B
(::B C
)::C D
?;; 
string;; 
.;; 
Join;; 
(;; 
$str;; 
,;; 
_item;;  %
.;;% &
	Modifiers;;& /
);;/ 0
:<< 
string<< 
.<< 
Empty<< 
;<< 
}== 
}>> ÃI
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\KitchenDisplayViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
;		* +
public 

class #
KitchenDisplayViewModel (
:) *
ViewModelBase+ 8
{ 
private 
readonly #
IKitchenOrderRepository 0
_repository1 <
;< =
private 
readonly 
DispatcherQueue (
_dispatcherQueue) 9
;9 :
private 
readonly  
DispatcherQueueTimer -
_timer. 4
;4 5
public  
ObservableCollection #
<# $!
KitchenOrderViewModel$ 9
>9 :
Orders; A
{B C
getD G
;G H
}I J
=K L
newM P
(P Q
)Q R
;R S
private 
string 
_lastUpdated #
=$ %
$str& -
;- .
public 
string 
LastUpdated !
{ 	
get 
=> 
_lastUpdated 
;  
set 
=> 
SetProperty 
( 
ref "
_lastUpdated# /
,/ 0
value1 6
)6 7
;7 8
} 	
public 

ICommand 
BumpCommand 
{  !
get" %
;% &
}' (
public 

ICommand 
RefreshCommand "
{# $
get% (
;( )
}* +
public 

ICommand  
ToggleHistoryCommand (
{) *
get+ .
;. /
}0 1
private 
bool 
_isHistoryMode 
;  
public   

bool   
IsHistoryMode   
{!! 
get"" 
=>"" 
_isHistoryMode"" 
;"" 
set## 
{$$ 	
if%% 
(%% 
SetProperty%% 
(%% 
ref%% 
_isHistoryMode%%  .
,%%. /
value%%0 5
)%%5 6
)%%6 7
{&& 
OnPropertyChanged'' !
(''! "
nameof''" (
(''( )
	ViewTitle'') 2
)''2 3
)''3 4
;''4 5
_(( 
=(( 
LoadOrdersAsync(( #
(((# $
)(($ %
;((% &
})) 
}** 	
}++ 
public-- 

string-- 
	ViewTitle-- 
=>-- 
IsHistoryMode-- ,
?--- .
$str--/ @
:--A B
$str--C [
;--[ \
public// 
#
KitchenDisplayViewModel// "
(//" ##
IKitchenOrderRepository//# :

repository//; E
)//E F
{00 
_repository11 
=11 

repository11  
;11  !
BumpCommand33 
=33 
new33 
AsyncRelayCommand33 +
<33+ ,!
KitchenOrderViewModel33, A
>33A B
(33B C
BumpOrderAsync33C Q
)33Q R
;33R S
RefreshCommand44 
=44 
new44 
AsyncRelayCommand44 .
(44. /
LoadOrdersAsync44/ >
)44> ?
;44? @ 
ToggleHistoryCommand55 
=55 
new55 "
RelayCommand55# /
(55/ 0
(550 1
)551 2
=>553 5
IsHistoryMode556 C
=55D E
!55F G
IsHistoryMode55G T
)55T U
;55U V
_dispatcherQueue88 
=88 
DispatcherQueue88 *
.88* +
GetForCurrentThread88+ >
(88> ?
)88? @
;88@ A
if99 

(99 
_dispatcherQueue99 
!=99 
null99  $
)99$ %
{:: 	
_timer;; 
=;; 
_dispatcherQueue;; %
.;;% &
CreateTimer;;& 1
(;;1 2
);;2 3
;;;3 4
_timer<< 
.<< 
Interval<< 
=<< 
TimeSpan<< &
.<<& '
FromSeconds<<' 2
(<<2 3
$num<<3 5
)<<5 6
;<<6 7
_timer== 
.== 
Tick== 
+=== 
(== 
s== 
,== 
e==  
)==  !
=>==" $
_==% &
===' (
LoadOrdersAsync==) 8
(==8 9
)==9 :
;==: ;
_timer>> 
.>> 
Start>> 
(>> 
)>> 
;>> 
}?? 	
}@@ 
publicBB 

asyncBB 
TaskBB 
LoadOrdersAsyncBB %
(BB% &
)BB& '
{CC 
tryDD 
{EE 	
SystemFF 
.FF 
CollectionsFF 
.FF 
GenericFF &
.FF& '
IEnumerableFF' 2
<FF2 3
MagideskFF3 ;
.FF; <
DomainFF< B
.FFB C
EntitiesFFC K
.FFK L
KitchenOrderFFL X
>FFX Y
fetchedOrdersFFZ g
;FFg h
ifHH 
(HH 
IsHistoryModeHH 
)HH 
{II 
fetchedOrdersJJ 
=JJ 
awaitJJ  %
_repositoryJJ& 1
.JJ1 2#
GetCompletedOrdersAsyncJJ2 I
(JJI J
$numJJJ L
)JJL M
;JJM N
}KK 
elseLL 
{MM 
fetchedOrdersNN 
=NN 
awaitNN  %
_repositoryNN& 1
.NN1 2 
GetActiveOrdersAsyncNN2 F
(NNF G
)NNG H
;NNH I
}OO 
OrdersSS 
.SS 
ClearSS 
(SS 
)SS 
;SS 
foreachTT 
(TT 
varTT 
orderTT 
inTT !
fetchedOrdersTT" /
)TT/ 0
{UU 
OrdersVV 
.VV 
AddVV 
(VV 
newVV !
KitchenOrderViewModelVV 4
(VV4 5
orderVV5 :
)VV: ;
)VV; <
;VV< =
}WW 
LastUpdatedYY 
=YY 
DateTimeYY "
.YY" #
NowYY# &
.YY& '
ToStringYY' /
(YY/ 0
$strYY0 :
)YY: ;
;YY; <
}ZZ 	
catch[[ 
([[ 
	Exception[[ 
)[[ 
{\\ 	
LastUpdated^^ 
=^^ 
$str^^ ,
;^^, -
}__ 	
}`` 
publiccc 

voidcc 
StartPollingcc 
(cc 
)cc 
{dd 
ifee 

(ee 
_timeree 
!=ee 
nullee 
&&ee 
!ee 
_timeree %
.ee% &
	IsRunningee& /
)ee/ 0
_timeree1 7
.ee7 8
Startee8 =
(ee= >
)ee> ?
;ee? @
_ff 	
=ff
 
LoadOrdersAsyncff 
(ff 
)ff 
;ff 
}gg 
publicii 

voidii 
StopPollingii 
(ii 
)ii 
{jj 
ifkk 

(kk 
_timerkk 
!=kk 
nullkk 
&&kk 
_timerkk $
.kk$ %
	IsRunningkk% .
)kk. /
_timerkk0 6
.kk6 7
Stopkk7 ;
(kk; <
)kk< =
;kk= >
}ll 
privatenn 
asyncnn 
Tasknn 
BumpOrderAsyncnn %
(nn% &!
KitchenOrderViewModelnn& ;
?nn; <
vmnn= ?
)nn? @
{oo 
ifpp 

(pp 
vmpp 
==pp 
nullpp 
)pp 
returnpp 
;pp 
iftt 

(tt 
IsHistoryModett 
)tt 
returntt !
;tt! "
tryvv 
{ww 	
varxx 
orderxx 
=xx 
awaitxx 
_repositoryxx )
.xx) *
GetByIdAsyncxx* 6
(xx6 7
vmxx7 9
.xx9 :
Idxx: <
)xx< =
;xx= >
ifyy 
(yy 
orderyy 
!=yy 
nullyy 
)yy 
{zz 
order}} 
.}} 
Bump}} 
(}} 
)}} 
;}} 
await 
_repository !
.! "
UpdateAsync" -
(- .
order. 3
)3 4
;4 5
if
‚‚ 
(
‚‚ 
order
‚‚ 
.
‚‚ 
Status
‚‚  
==
‚‚! #
Domain
‚‚$ *
.
‚‚* +
Enumerations
‚‚+ 7
.
‚‚7 8
KitchenStatus
‚‚8 E
.
‚‚E F
Done
‚‚F J
)
‚‚J K
{
ƒƒ 
Orders
„„ 
.
„„ 
Remove
„„ !
(
„„! "
vm
„„" $
)
„„$ %
;
„„% &
}
…… 
else
†† 
{
‡‡ 
await
ŠŠ 
LoadOrdersAsync
ŠŠ (
(
ŠŠ( )
)
ŠŠ) *
;
ŠŠ* +
}
‹‹ 
}
ŒŒ 
}
 	
catch
ŽŽ 
(
ŽŽ 
	Exception
ŽŽ 
ex
ŽŽ 
)
ŽŽ 
{
 	
}
‘‘ 	
}
’’ 
}““ ©r
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\InventoryViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public		 
class		 
InventoryViewModel		 
:		  !
ViewModelBase		" /
{

 
private 
readonly $
IInventoryItemRepository - 
_inventoryRepository. B
;B C
private 
readonly *
IInventoryAdjustmentRepository 3!
_adjustmentRepository4 I
;I J
private 
InventoryItem 
? 
_selectedItem (
;( )
private 
string 
_editingName 
=  !
string" (
.( )
Empty) .
;. /
private 
string 
_editingUnit 
=  !
$str" (
;( )
private 
string 
_editingStock  
=! "
$str# &
;& '
private 
string 
_editingReorder "
=# $
$str% (
;( )
private 
string 
_adjustmentReason $
=% &
$str' 7
;7 8
private 
bool 

_isEditing 
; 
public 
 
ObservableCollection 
<  
InventoryItem  -
>- .
InventoryItems/ =
{> ?
get@ C
;C D
}E F
=G H
newI L
(L M
)M N
;N O
public 

InventoryItem 
? 
SelectedItem &
{ 
get 
=> 
_selectedItem 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_selectedItem  -
,- .
value/ 4
)4 5
)5 6
{ 
if 
( 
value 
!= 
null !
)! "
{   
	IsEditing!! 
=!! 
true!!  $
;!!$ %
EditingName"" 
=""  !
value""" '
.""' (
Name""( ,
;"", -
EditingUnit## 
=##  !
value##" '
.##' (
Unit##( ,
;##, -
EditingStock$$  
=$$! "
value$$# (
.$$( )
StockQuantity$$) 6
.$$6 7
ToString$$7 ?
($$? @
)$$@ A
;$$A B
EditingReorder%% "
=%%# $
value%%% *
.%%* +
ReorderPoint%%+ 7
.%%7 8
ToString%%8 @
(%%@ A
)%%A B
;%%B C
StatusMessage&& !
=&&" #
$"&&$ &
$str&&& /
{&&/ 0
value&&0 5
.&&5 6
Name&&6 :
}&&: ;
"&&; <
;&&< =
}'' 
else(( 
{)) 
	IsEditing** 
=** 
false**  %
;**% &
StatusMessage++ !
=++" #
$str++$ +
;+++ ,
},, 
}-- 
}.. 	
}// 
public11 

string11 
EditingName11 
{11 
get11  #
=>11$ &
_editingName11' 3
;113 4
set115 8
=>119 ;
SetProperty11< G
(11G H
ref11H K
_editingName11L X
,11X Y
value11Z _
)11_ `
;11` a
}11b c
public22 

string22 
EditingUnit22 
{22 
get22  #
=>22$ &
_editingUnit22' 3
;223 4
set225 8
=>229 ;
SetProperty22< G
(22G H
ref22H K
_editingUnit22L X
,22X Y
value22Z _
)22_ `
;22` a
}22b c
public33 

string33 
EditingStock33 
{33  
get33! $
=>33% '
_editingStock33( 5
;335 6
set337 :
=>33; =
SetProperty33> I
(33I J
ref33J M
_editingStock33N [
,33[ \
value33] b
)33b c
;33c d
}33e f
public44 

string44 
EditingReorder44  
{44! "
get44# &
=>44' )
_editingReorder44* 9
;449 :
set44; >
=>44? A
SetProperty44B M
(44M N
ref44N Q
_editingReorder44R a
,44a b
value44c h
)44h i
;44i j
}44k l
public55 

string55 
AdjustmentReason55 "
{55# $
get55% (
=>55) +
_adjustmentReason55, =
;55= >
set55? B
=>55C E
SetProperty55F Q
(55Q R
ref55R U
_adjustmentReason55V g
,55g h
value55i n
)55n o
;55o p
}55q r
public77 

bool77 
	IsEditing77 
{77 
get77 
=>77  "

_isEditing77# -
;77- .
set77/ 2
=>773 5
SetProperty776 A
(77A B
ref77B E

_isEditing77F P
,77P Q
value77R W
)77W X
;77X Y
}77Z [
private99 
string99 
_statusMessage99 !
=99" #
$str99$ +
;99+ ,
public:: 

string:: 
StatusMessage:: 
{::  !
get::" %
=>::& (
_statusMessage::) 7
;::7 8
set::9 <
=>::= ?
SetProperty::@ K
(::K L
ref::L O
_statusMessage::P ^
,::^ _
value::` e
)::e f
;::f g
}::h i
public<< 

ICommand<< 
LoadDataCommand<< #
{<<$ %
get<<& )
;<<) *
}<<+ ,
public== 

ICommand== 
AddItemCommand== "
{==# $
get==% (
;==( )
}==* +
public>> 

ICommand>> 
SaveCommand>> 
{>>  !
get>>" %
;>>% &
}>>' (
public?? 

ICommand?? 
DeleteCommand?? !
{??" #
get??$ '
;??' (
}??) *
publicAA 

InventoryViewModelAA 
(AA $
IInventoryItemRepositoryAA 6
inventoryRepositoryAA7 J
,AAJ K*
IInventoryAdjustmentRepositoryAAL j 
adjustmentRepositoryAAk 
)	AA €
{BB  
_inventoryRepositoryCC 
=CC 
inventoryRepositoryCC 2
;CC2 3!
_adjustmentRepositoryDD 
=DD  
adjustmentRepositoryDD  4
;DD4 5
TitleEE 
=EE 
$strEE &
;EE& '
LoadDataCommandGG 
=GG 
newGG 
AsyncRelayCommandGG /
(GG/ 0
LoadDataAsyncGG0 =
)GG= >
;GG> ?
AddItemCommandHH 
=HH 
newHH 
AsyncRelayCommandHH .
(HH. /
AddItemAsyncHH/ ;
)HH; <
;HH< =
SaveCommandII 
=II 
newII 
AsyncRelayCommandII +
(II+ ,
	SaveAsyncII, 5
)II5 6
;II6 7
DeleteCommandJJ 
=JJ 
newJJ 
AsyncRelayCommandJJ -
(JJ- .
DeleteAsyncJJ. 9
)JJ9 :
;JJ: ;
}KK 
privateMM 
asyncMM 
TaskMM 
LoadDataAsyncMM $
(MM$ %
)MM% &
{NN 
IsBusyOO 
=OO 
trueOO 
;OO 
tryPP 
{QQ 	
InventoryItemsRR 
.RR 
ClearRR  
(RR  !
)RR! "
;RR" #
varSS 
itemsSS 
=SS 
awaitSS  
_inventoryRepositorySS 2
.SS2 3
GetAllAsyncSS3 >
(SS> ?
)SS? @
;SS@ A
foreachTT 
(TT 
varTT 
itemTT 
inTT  
itemsTT! &
)TT& '
InventoryItemsTT( 6
.TT6 7
AddTT7 :
(TT: ;
itemTT; ?
)TT? @
;TT@ A
StatusMessageUU 
=UU 
$"UU 
$strUU %
{UU% &
InventoryItemsUU& 4
.UU4 5
CountUU5 :
}UU: ;
$strUU; A
"UUA B
;UUB C
}VV 	
finallyWW 
{WW 
IsBusyWW 
=WW 
falseWW  
;WW  !
}WW" #
}XX 
privateZZ 
asyncZZ 
TaskZZ 
AddItemAsyncZZ #
(ZZ# $
)ZZ$ %
{[[ 
IsBusy\\ 
=\\ 
true\\ 
;\\ 
try]] 
{^^ 	
var__ 
newItem__ 
=__ 
InventoryItem__ '
.__' (
Create__( .
(__. /
$str__/ 9
,__9 :
$str__; A
,__A B
$num__C D
,__D E
$num__F G
)__G H
;__H I
await``  
_inventoryRepository`` &
.``& '
AddAsync``' /
(``/ 0
newItem``0 7
)``7 8
;``8 9
InventoryItemsaa 
.aa 
Addaa 
(aa 
newItemaa &
)aa& '
;aa' (
SelectedItembb 
=bb 
newItembb "
;bb" #
StatusMessagecc 
=cc 
$strcc ,
;cc, -
}dd 	
finallyee 
{ee 
IsBusyee 
=ee 
falseee  
;ee  !
}ee" #
}ff 
privatehh 
asynchh 
Taskhh 
	SaveAsynchh  
(hh  !
)hh! "
{ii 
ifjj 

(jj 
SelectedItemjj 
==jj 
nulljj  
)jj  !
returnjj" (
;jj( )
IsBusyll 
=ll 
truell 
;ll 
trymm 
{nn 	
ifoo 
(oo 
decimaloo 
.oo 
TryParseoo  
(oo  !
EditingStockoo! -
,oo- .
outoo/ 2
varoo3 6
stockoo7 <
)oo< =
&&oo> @
decimalooA H
.ooH I
TryParseooI Q
(ooQ R
EditingReorderooR `
,oo` a
outoob e
varoof i
reorderooj q
)ooq r
)oor s
{pp 
SelectedItemxx 
.xx 

UpdateNamexx &
(xx& '
EditingNamexx' 2
)xx2 3
;xx3 4
SelectedItemyy 
.yy 

UpdateUnityy &
(yy& '
EditingUnityy' 2
)yy2 3
;yy3 4
var{{ 
currentStock{{ 
={{  !
SelectedItem{{" .
.{{. /
StockQuantity{{/ <
;{{< =
var|| 
delta|| 
=|| 
stock||  
-||! "
currentStock||# /
;||/ 0
if}} 
(}} 
delta}} 
!=}} 
$num}} 
)}} 
{~~ 
SelectedItem 
.  
AdjustStock  +
(+ ,
delta, 1
)1 2
;2 3
var
€€ 

adjustment
€€ !
=
€€" #!
InventoryAdjustment
€€$ 7
.
€€7 8
Create
€€8 >
(
€€> ?
SelectedItem
€€? K
.
€€K L
Id
€€L N
,
€€N O
delta
€€P U
,
€€U V
AdjustmentReason
€€W g
)
€€g h
;
€€h i
await
 #
_adjustmentRepository
 .
.
. /
AddAsync
/ 7
(
7 8

adjustment
8 B
)
B C
;
C D
}
‚‚ 
SelectedItem
„„ 
.
„„ 
SetReorderPoint
„„ +
(
„„+ ,
reorder
„„, 3
)
„„3 4
;
„„4 5
await
†† "
_inventoryRepository
†† )
.
††) *
UpdateAsync
††* 5
(
††5 6
SelectedItem
††6 B
)
††B C
;
††C D
StatusMessage
‡‡ 
=
‡‡ 
$str
‡‡ +
;
‡‡+ ,
var
ŒŒ 
index
ŒŒ 
=
ŒŒ 
InventoryItems
ŒŒ )
.
ŒŒ) *
IndexOf
ŒŒ* 1
(
ŒŒ1 2
SelectedItem
ŒŒ2 >
)
ŒŒ> ?
;
ŒŒ? @
if
 
(
 
index
 
>=
 
$num
 
)
 
InventoryItems
 -
[
- .
index
. 3
]
3 4
=
5 6
SelectedItem
7 C
;
C D
}
ŽŽ 
else
 
{
 
StatusMessage
‘‘ 
=
‘‘ 
$str
‘‘  7
;
‘‘7 8
}
’’ 
}
““ 	
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
”” 
{
•• 	
StatusMessage
–– 
=
–– 
$"
–– 
$str
–– %
{
––% &
ex
––& (
.
––( )
Message
––) 0
}
––0 1
"
––1 2
;
––2 3
}
—— 	
finally
˜˜ 
{
˜˜ 
IsBusy
˜˜ 
=
˜˜ 
false
˜˜  
;
˜˜  !
}
˜˜" #
}
™™ 
private
›› 
async
›› 
Task
›› 
DeleteAsync
›› "
(
››" #
)
››# $
{
œœ 
if
 

(
 
SelectedItem
 
==
 
null
  
)
  !
return
" (
;
( )
IsBusy
ŸŸ 
=
ŸŸ 
true
ŸŸ 
;
ŸŸ 
try
   
{
¡¡ 	
await
¢¢ "
_inventoryRepository
¢¢ &
.
¢¢& '
DeleteAsync
¢¢' 2
(
¢¢2 3
SelectedItem
¢¢3 ?
.
¢¢? @
Id
¢¢@ B
)
¢¢B C
;
¢¢C D
InventoryItems
££ 
.
££ 
Remove
££ !
(
££! "
SelectedItem
££" .
)
££. /
;
££/ 0
SelectedItem
¤¤ 
=
¤¤ 
null
¤¤ 
;
¤¤  
StatusMessage
¥¥ 
=
¥¥ 
$str
¥¥ *
;
¥¥* +
}
¦¦ 	
finally
§§ 
{
§§ 
IsBusy
§§ 
=
§§ 
false
§§  
;
§§  !
}
§§" #
}
¨¨ 
}©© ©
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\GuestCountViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class 
GuestCountViewModel (
:) *
ObservableObject+ ;
{ 
private 
int 
_guestCount 
= 
$num 
;  
public

 

int

 

GuestCount

 
{ 
get 
=> 
_guestCount 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_guestCount  +
,+ ,
value- 2
)2 3
)3 4
{ 
OnPropertyChanged !
(! "
nameof" (
(( )
GuestCountText) 7
)7 8
)8 9
;9 :
} 
} 	
} 
public 

string 
GuestCountText  
=>! #

GuestCount$ .
==/ 1
$num2 3
?4 5
$str6 8
:9 :

GuestCount; E
.E F
ToStringF N
(N O
)O P
;P Q
public 

GuestCountViewModel 
( 
)  
{ 
} 
[ 
RelayCommand 
] 
private 
void 
AppendNumber 
( 
string $
number% +
)+ ,
{ 
if 

( 
int 
. 
TryParse 
( 
number 
,  
out! $
int% (
digit) .
). /
)/ 0
{   	
if"" 
("" 

GuestCount"" 
<"" 
$num""  
)""  !
{## 

GuestCount$$ 
=$$ 
($$ 

GuestCount$$ (
*$$) *
$num$$+ -
)$$- .
+$$/ 0
digit$$1 6
;$$6 7
}%% 
}&& 	
}'' 
[)) 
RelayCommand)) 
])) 
private** 
void** 
Clear** 
(** 
)** 
{++ 

GuestCount,, 
=,, 
$num,, 
;,, 
}-- 
[// 
RelayCommand// 
]// 
private00 
void00 
	Backspace00 
(00 
)00 
{11 

GuestCount22 
=22 

GuestCount22 
/22  !
$num22" $
;22$ %
}33 
[55 
RelayCommand55 
]55 
private66 
void66 
Confirm66 
(66 
)66 
{77 
};; 
}<< ðb
nC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\GroupSettleTicketViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
{ 
public 

partial 
class &
GroupSettleTicketViewModel 3
:4 5
ViewModelBase6 C
{ 
private 
readonly 
ICommandHandler (
<( )
GroupSettleCommand) ;
,; <
GroupSettleResult= N
>N O
_groupSettleHandlerP c
;c d
private 
readonly 
IUserService %
_userService& 2
;2 3
private 
readonly 
ITerminalContext )
_terminalContext* :
;: ;
private  
ObservableCollection $
<$ % 
GroupSettleTicketDto% 9
>9 :
_selectedTickets; K
=L M
newN Q
(Q R
)R S
;S T
private 
decimal 
_combinedTotal &
=' (
$num) *
;* +
private 
string "
_selectedPaymentMethod -
=. /
$str0 6
;6 7
private 
string 
_tenderAmount $
=% &
$str' )
;) *
private 
bool 
_isProcessing "
=# $
false% *
;* +
private 
string 
_processingMessage )
=* +
$str, C
;C D
private 
string 
? 
_error 
; 
public  
ObservableCollection #
<# $ 
GroupSettleTicketDto$ 8
>8 9
SelectedTickets: I
{ 	
get   
=>   
_selectedTickets   #
;  # $
set!! 
=>!! 
SetProperty!! 
(!! 
ref!! "
_selectedTickets!!# 3
,!!3 4
value!!5 :
)!!: ;
;!!; <
}"" 	
public$$ 
decimal$$ 
CombinedTotal$$ $
{%% 	
get&& 
=>&& 
_combinedTotal&& !
;&&! "
set'' 
=>'' 
SetProperty'' 
('' 
ref'' "
_combinedTotal''# 1
,''1 2
value''3 8
)''8 9
;''9 :
}(( 	
public** 
string** !
SelectedPaymentMethod** +
{++ 	
get,, 
=>,, "
_selectedPaymentMethod,, )
;,,) *
set-- 
=>-- 
SetProperty-- 
(-- 
ref-- ""
_selectedPaymentMethod--# 9
,--9 :
value--; @
)--@ A
;--A B
}.. 	
public00 
string00 
TenderAmount00 "
{11 	
get22 
=>22 
_tenderAmount22  
;22  !
set33 
=>33 
SetProperty33 
(33 
ref33 "
_tenderAmount33# 0
,330 1
value332 7
)337 8
;338 9
}44 	
public66 
bool66 
IsProcessing66  
{77 	
get88 
=>88 
_isProcessing88  
;88  !
set99 
=>99 
SetProperty99 
(99 
ref99 "
_isProcessing99# 0
,990 1
value992 7
)997 8
;998 9
}:: 	
public<< 
string<< 
ProcessingMessage<< '
{== 	
get>> 
=>>> 
_processingMessage>> %
;>>% &
set?? 
=>?? 
SetProperty?? 
(?? 
ref?? "
_processingMessage??# 5
,??5 6
value??7 <
)??< =
;??= >
}@@ 	
publicBB 
stringBB 
?BB 
ErrorBB 
{CC 	
getDD 
=>DD 
_errorDD 
;DD 
setEE 
=>EE 
SetPropertyEE 
(EE 
refEE "
_errorEE# )
,EE) *
valueEE+ 0
)EE0 1
;EE1 2
}FF 	
publicHH &
GroupSettleTicketViewModelHH )
(HH) *
ICommandHandlerII 
<II 
GroupSettleCommandII .
,II. /
GroupSettleResultII0 A
>IIA B
groupSettleHandlerIIC U
,IIU V
IUserServiceJJ 
userServiceJJ $
,JJ$ %
ITerminalContextKK 
terminalContextKK ,
)KK, -
{LL 	
TitleMM 
=MM 
$strMM &
;MM& '
_groupSettleHandlerNN 
=NN  !
groupSettleHandlerNN" 4
;NN4 5
_userServiceOO 
=OO 
userServiceOO &
;OO& '
_terminalContextPP 
=PP 
terminalContextPP .
;PP. /
}QQ 	
publicSS 
ActionSS 
?SS 
CloseDialogSS "
{SS# $
getSS% (
;SS( )
setSS* -
;SS- .
}SS/ 0
publicUU 
voidUU 
SetSelectedTicketsUU &
(UU& ' 
ObservableCollectionUU' ;
<UU; < 
GroupSettleTicketDtoUU< P
>UUP Q
ticketsUUR Y
)UUY Z
{VV 	
SelectedTicketsWW 
.WW 
ClearWW !
(WW! "
)WW" #
;WW# $
foreachXX 
(XX 
varXX 
ticketXX 
inXX  "
ticketsXX# *
)XX* +
{YY 
SelectedTicketsZZ 
.ZZ  
AddZZ  #
(ZZ# $
ticketZZ$ *
)ZZ* +
;ZZ+ ,
}[[ 
UpdateCombinedTotal\\ 
(\\  
)\\  !
;\\! "
}]] 	
private__ 
void__ 
UpdateCombinedTotal__ (
(__( )
)__) *
{`` 	
CombinedTotalaa 
=aa 
SelectedTicketsaa +
.aa+ ,
Sumaa, /
(aa/ 0
taa0 1
=>aa2 4
taa5 6
.aa6 7
TotalAmountaa7 B
)aaB C
;aaC D
}bb 	
[dd 	
RelayCommanddd	 
]dd 
privateee 
asyncee 
Taskee 
ProcessPaymentAsyncee .
(ee. /
)ee/ 0
{ff 	
ifgg 
(gg 
SelectedTicketsgg 
.gg  
Countgg  %
==gg& (
$numgg) *
)gg* +
{hh 
Errorii 
=ii 
$strii -
;ii- .
returnjj 
;jj 
}kk 
ifmm 
(mm 
stringmm 
.mm 
IsNullOrEmptymm $
(mm$ %
TenderAmountmm% 1
)mm1 2
||mm3 5
!mm6 7
decimalmm7 >
.mm> ?
TryParsemm? G
(mmG H
TenderAmountmmH T
,mmT U
outmmV Y
varmmZ ]
tenderAmountmm^ j
)mmj k
)mmk l
{nn 
Erroroo 
=oo 
$stroo <
;oo< =
returnpp 
;pp 
}qq 
ifss 
(ss 
tenderAmountss 
<ss 
CombinedTotalss ,
)ss, -
{tt 
Erroruu 
=uu 
$struu C
;uuC D
returnvv 
;vv 
}ww 
IsProcessingyy 
=yy 
trueyy 
;yy  
Errorzz 
=zz 
nullzz 
;zz 
ProcessingMessage{{ 
={{ 
$"{{  "
$str{{" -
{{{- .!
SelectedPaymentMethod{{. C
}{{C D
$str{{D P
{{{P Q
CombinedTotal{{Q ^
:{{^ _
$str{{_ `
}{{` a
$str{{a d
"{{d e
;{{e f
try}} 
{~~ 
if
€€ 
(
€€ 
!
€€ 
Enum
€€ 
.
€€ 
TryParse
€€ "
<
€€" #
PaymentType
€€# .
>
€€. /
(
€€/ 0#
SelectedPaymentMethod
€€0 E
,
€€E F
out
€€G J
var
€€K N
paymentType
€€O Z
)
€€Z [
)
€€[ \
{
 
Error
‚‚ 
=
‚‚ 
$str
‚‚ 2
;
‚‚2 3
return
ƒƒ 
;
ƒƒ 
}
„„ 
if
‡‡ 
(
‡‡ 
_userService
‡‡  
.
‡‡  !
CurrentUser
‡‡! ,
?
‡‡, -
.
‡‡- .
Id
‡‡. 0
==
‡‡1 3
null
‡‡4 8
)
‡‡8 9
{
ˆˆ 
Error
‰‰ 
=
‰‰ 
$str
‰‰ I
;
‰‰I J
return
ŠŠ 
;
ŠŠ 
}
‹‹ 
if
 
(
 
_terminalContext
 $
.
$ %

TerminalId
% /
==
0 2
null
3 7
)
7 8
{
ŽŽ 
Error
 
=
 
$str
 C
;
C D
return
 
;
 
}
‘‘ 
var
““ 
command
““ 
=
““ 
new
““ ! 
GroupSettleCommand
““" 4
{
”” 
	TicketIds
•• 
=
•• 
SelectedTickets
••  /
.
••/ 0
Select
••0 6
(
••6 7
t
••7 8
=>
••9 ;
t
••< =
.
••= >
Id
••> @
)
••@ A
.
••A B
ToList
••B H
(
••H I
)
••I J
,
••J K
Amount
–– 
=
–– 
new
––  
Money
––! &
(
––& '
CombinedTotal
––' 4
,
––4 5
$str
––6 ;
)
––; <
,
––< =
TenderAmount
——  
=
——! "
new
——# &
Money
——' ,
(
——, -
tenderAmount
——- 9
,
——9 :
$str
——; @
)
——@ A
,
——A B
PaymentType
˜˜ 
=
˜˜  !
paymentType
˜˜" -
,
˜˜- .
ProcessedBy
™™ 
=
™™  !
_userService
™™" .
.
™™. /
CurrentUser
™™/ :
.
™™: ;
Id
™™; =
,
™™= >

TerminalId
šš 
=
šš  
_terminalContext
šš! 1
.
šš1 2

TerminalId
šš2 <
.
šš< =
Value
šš= B
,
ššB C
GlobalId
›› 
=
›› 
Guid
›› #
.
››# $
NewGuid
››$ +
(
››+ ,
)
››, -
.
››- .
ToString
››. 6
(
››6 7
)
››7 8
}
œœ 
;
œœ 
var
ŸŸ 
result
ŸŸ 
=
ŸŸ 
await
ŸŸ "!
_groupSettleHandler
ŸŸ# 6
.
ŸŸ6 7
HandleAsync
ŸŸ7 B
(
ŸŸB C
command
ŸŸC J
)
ŸŸJ K
;
ŸŸK L
if
¡¡ 
(
¡¡ 
result
¡¡ 
.
¡¡ 
Success
¡¡ "
)
¡¡" #
{
¢¢ 
ProcessingMessage
££ %
=
££& '
$str
££( O
;
££O P
await
¤¤ 
Task
¤¤ 
.
¤¤ 
Delay
¤¤ $
(
¤¤$ %
$num
¤¤% )
)
¤¤) *
;
¤¤* +
CloseDialog
¥¥ 
?
¥¥  
.
¥¥  !
Invoke
¥¥! '
(
¥¥' (
)
¥¥( )
;
¥¥) *
}
¦¦ 
else
§§ 
{
¨¨ 
Error
©© 
=
©© 
$"
©© 
$str
©© .
{
©©. /
result
©©/ 5
.
©©5 6
ErrorMessage
©©6 B
}
©©B C
"
©©C D
;
©©D E
}
ªª 
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
Error
®® 
=
®® 
$"
®® 
$str
®® )
{
®®) *
ex
®®* ,
.
®®, -
Message
®®- 4
}
®®4 5
"
®®5 6
;
®®6 7
}
¯¯ 
finally
°° 
{
±± 
IsProcessing
²² 
=
²² 
false
²² $
;
²²$ %
}
³³ 
}
´´ 	
[
¶¶ 	
RelayCommand
¶¶	 
]
¶¶ 
private
·· 
void
·· 
Cancel
·· 
(
·· 
)
·· 
{
¸¸ 	
CloseDialog
¹¹ 
?
¹¹ 
.
¹¹ 
Invoke
¹¹ 
(
¹¹  
)
¹¹  !
;
¹¹! "
}
ºº 	
}
»» 
}¼¼ ØC
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\GroupSettleTicketSelectionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
{ 
public		 

partial		 
class		 /
#GroupSettleTicketSelectionViewModel		 <
:		= >
ViewModelBase		? L
{

 
private  
ObservableCollection $
<$ % 
GroupSettleTicketDto% 9
>9 :
_availableTickets; L
=M N
newO R
(R S
)S T
;T U
private 
decimal 
_combinedTotal &
=' (
$num) *
;* +
private 
int 
_selectedCount "
=# $
$num% &
;& '
public  
ObservableCollection #
<# $ 
GroupSettleTicketDto$ 8
>8 9
AvailableTickets: J
{ 	
get 
=> 
_availableTickets $
;$ %
set 
=> 
SetProperty 
( 
ref "
_availableTickets# 4
,4 5
value6 ;
); <
;< =
} 	
public 
decimal 
CombinedTotal $
{ 	
get 
=> 
_combinedTotal !
;! "
set 
=> 
SetProperty 
( 
ref "
_combinedTotal# 1
,1 2
value3 8
)8 9
;9 :
} 	
public 
int 
SelectedCount  
{ 	
get 
=> 
_selectedCount !
;! "
set 
=> 
SetProperty 
( 
ref "
_selectedCount# 1
,1 2
value3 8
)8 9
;9 :
} 	
public!! /
#GroupSettleTicketSelectionViewModel!! 2
(!!2 3
)!!3 4
{"" 	
Title## 
=## 
$str## 9
;##9 : 
LoadAvailableTickets$$  
($$  !
)$$! "
;$$" #
}%% 	
private'' 
void''  
LoadAvailableTickets'' )
('') *
)''* +
{(( 	
var++ 
mockTickets++ 
=++ 
new++ !
[++! "
]++" #
{,, 
new--  
GroupSettleTicketDto-- (
{.. 
Id// 
=// 
Guid// 
.// 
NewGuid// %
(//% &
)//& '
,//' (
TicketNumber00  
=00! "
$str00# *
,00* +

GuestCount11 
=11  
$num11! "
,11" #
TableNumber22 
=22  !
$str22" &
,22& '
TotalAmount33 
=33  !
$num33" (
,33( )

IsSelected44 
=44  
false44! &
}55 
,55 
new66  
GroupSettleTicketDto66 (
{77 
Id88 
=88 
Guid88 
.88 
NewGuid88 %
(88% &
)88& '
,88' (
TicketNumber99  
=99! "
$str99# *
,99* +

GuestCount:: 
=::  
$num::! "
,::" #
TableNumber;; 
=;;  !
$str;;" &
,;;& '
TotalAmount<< 
=<<  !
$num<<" (
,<<( )

IsSelected== 
===  
false==! &
}>> 
,>> 
new??  
GroupSettleTicketDto?? (
{@@ 
IdAA 
=AA 
GuidAA 
.AA 
NewGuidAA %
(AA% &
)AA& '
,AA' (
TicketNumberBB  
=BB! "
$strBB# *
,BB* +

GuestCountCC 
=CC  
$numCC! "
,CC" #
TableNumberDD 
=DD  !
$strDD" &
,DD& '
TotalAmountEE 
=EE  !
$numEE" (
,EE( )

IsSelectedFF 
=FF  
falseFF! &
}GG 
}HH 
;HH 
foreachJJ 
(JJ 
varJJ 
ticketJJ 
inJJ  "
mockTicketsJJ# .
)JJ. /
{KK 
ticketLL 
.LL 
SelectionChangedLL '
+=LL( * 
RefreshCombinedTotalLL+ ?
;LL? @
AvailableTicketsMM  
.MM  !
AddMM! $
(MM$ %
ticketMM% +
)MM+ ,
;MM, -
}NN 
UpdateCombinedTotalPP 
(PP  
)PP  !
;PP! "
}QQ 	
privateSS 
voidSS 
UpdateCombinedTotalSS (
(SS( )
)SS) *
{TT 	
CombinedTotalUU 
=UU 
AvailableTicketsUU ,
.VV 
WhereVV 
(VV 
tVV 
=>VV 
tVV 
.VV 

IsSelectedVV (
)VV( )
.WW 
SumWW 
(WW 
tWW 
=>WW 
tWW 
.WW 
TotalAmountWW '
)WW' (
;WW( )
SelectedCountYY 
=YY 
AvailableTicketsYY ,
.YY, -
CountYY- 2
(YY2 3
tYY3 4
=>YY5 7
tYY8 9
.YY9 :

IsSelectedYY: D
)YYD E
;YYE F
}ZZ 	
public\\ 
void\\  
RefreshCombinedTotal\\ (
(\\( )
)\\) *
{]] 	
UpdateCombinedTotal^^ 
(^^  
)^^  !
;^^! "
}__ 	
}`` 
publicbb 

classbb  
GroupSettleTicketDtobb %
:bb& '
ObservableObjectbb( 8
{cc 
privatedd 
booldd 
_isSelecteddd  
;dd  !
privateee 
stringee 
_ticketNumberee $
;ee$ %
privateff 
intff 
_guestCountff 
;ff  
privategg 
stringgg 
_tableNumbergg #
;gg# $
privatehh 
decimalhh 
_totalAmounthh $
;hh$ %
publicjj 
Guidjj 
Idjj 
{jj 
getjj 
;jj 
setjj !
;jj! "
}jj# $
publicll 
boolll 

IsSelectedll 
{mm 	
getnn 
=>nn 
_isSelectednn 
;nn 
setoo 
{pp 
ifqq 
(qq 
SetPropertyqq 
(qq  
refqq  #
_isSelectedqq$ /
,qq/ 0
valueqq1 6
)qq6 7
)qq7 8
{rr 
SelectionChangeduu $
?uu$ %
.uu% &
Invokeuu& ,
(uu, -
)uu- .
;uu. /
}vv 
}ww 
}xx 	
publiczz 
eventzz 
Actionzz 
?zz 
SelectionChangedzz -
;zz- .
public|| 
string|| 
TicketNumber|| "
{}} 	
get~~ 
=>~~ 
_ticketNumber~~  
;~~  !
set 
=> 
SetProperty 
( 
ref "
_ticketNumber# 0
,0 1
value2 7
)7 8
;8 9
}
€€ 	
public
‚‚ 
int
‚‚ 

GuestCount
‚‚ 
{
ƒƒ 	
get
„„ 
=>
„„ 
_guestCount
„„ 
;
„„ 
set
…… 
=>
…… 
SetProperty
…… 
(
…… 
ref
…… "
_guestCount
……# .
,
……. /
value
……0 5
)
……5 6
;
……6 7
}
†† 	
public
ˆˆ 
string
ˆˆ 
TableNumber
ˆˆ !
{
‰‰ 	
get
ŠŠ 
=>
ŠŠ 
_tableNumber
ŠŠ 
;
ŠŠ  
set
‹‹ 
=>
‹‹ 
SetProperty
‹‹ 
(
‹‹ 
ref
‹‹ "
_tableNumber
‹‹# /
,
‹‹/ 0
value
‹‹1 6
)
‹‹6 7
;
‹‹7 8
}
ŒŒ 	
public
ŽŽ 
decimal
ŽŽ 
TotalAmount
ŽŽ "
{
 	
get
 
=>
 
_totalAmount
 
;
  
set
‘‘ 
=>
‘‘ 
SetProperty
‘‘ 
(
‘‘ 
ref
‘‘ "
_totalAmount
‘‘# /
,
‘‘/ 0
value
‘‘1 6
)
‘‘6 7
;
‘‘7 8
}
’’ 	
}
““ 
}”” Ûª
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\FloorManagementViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class $
FloorManagementViewModel -
:. /
ViewModelBase0 =
{ 
private 
readonly 
IFloorRepository %
_floorRepository& 6
;6 7
private 
readonly "
ITableLayoutRepository +"
_tableLayoutRepository, B
;B C
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ISecurityService %
_securityService& 6
;6 7
[ 
ObservableProperty 
] 
private  
ObservableCollection  
<  !
FloorDto! )
>) *
_floors+ 2
=3 4
new5 8
(8 9
)9 :
;: ;
[ 
ObservableProperty 
] 
private 
FloorDto 
? 
_selectedFloor $
;$ %
[ 
ObservableProperty 
] 
private 
string 

_floorName 
= 
string  &
.& '
Empty' ,
;, -
[!! 
ObservableProperty!! 
]!! 
private"" 
string"" 
_floorDescription"" $
=""% &
string""' -
.""- .
Empty"". 3
;""3 4
[$$ 
ObservableProperty$$ 
]$$ 
private%% 
int%% 
_floorWidth%% 
=%% 
$num%% "
;%%" #
['' 
ObservableProperty'' 
]'' 
private(( 
int(( 
_floorHeight(( 
=(( 
$num(( #
;((# $
[** 
ObservableProperty** 
]** 
private++ 
string++ 
_backgroundColor++ #
=++$ %
$str++& /
;++/ 0
[-- 
ObservableProperty-- 
]-- 
private.. 
bool.. 
_isBusy.. 
;.. 
[00 
ObservableProperty00 
]00 
private11 
bool11 
_isEditMode11 
;11 
public33 

IRelayCommand33 
CreateFloorCommand33 +
{33, -
get33. 1
;331 2
}333 4
public44 

IRelayCommand44 
UpdateFloorCommand44 +
{44, -
get44. 1
;441 2
}443 4
public55 

IRelayCommand55 
DeleteFloorCommand55 +
{55, -
get55. 1
;551 2
}553 4
public66 

IRelayCommand66 
ClearFormCommand66 )
{66* +
get66, /
;66/ 0
}661 2
public77 

IRelayCommand77 %
NavigateToDesignerCommand77 2
{773 4
get775 8
;778 9
}77: ;
public88 

IRelayCommand88 
GoBackCommand88 &
{88' (
get88) ,
;88, -
}88. /
public:: 
$
FloorManagementViewModel:: #
(::# $
IFloorRepository;; 
floorRepository;; (
,;;( )"
ITableLayoutRepository<< !
tableLayoutRepository<< 4
,<<4 5
NavigationService== 
navigationService== +
,==+ ,
IUserService>> 
userService>>  
,>>  !
ISecurityService?? 
securityService?? (
)??( )
{@@ 
_floorRepositoryAA 
=AA 
floorRepositoryAA *
;AA* +"
_tableLayoutRepositoryBB 
=BB  !
tableLayoutRepositoryBB! 6
;BB6 7
_navigationServiceCC 
=CC 
navigationServiceCC .
;CC. /
_userServiceDD 
=DD 
userServiceDD "
;DD" #
_securityServiceEE 
=EE 
securityServiceEE *
;EE* +
CreateFloorCommandGG 
=GG 
newGG  
AsyncRelayCommandGG! 2
(GG2 3
CreateFloorAsyncGG3 C
)GGC D
;GGD E
UpdateFloorCommandHH 
=HH 
newHH  
AsyncRelayCommandHH! 2
(HH2 3
UpdateFloorAsyncHH3 C
)HHC D
;HHD E
DeleteFloorCommandII 
=II 
newII  
AsyncRelayCommandII! 2
<II2 3
FloorDtoII3 ;
>II; <
(II< =
DeleteFloorAsyncII= M
)IIM N
;IIN O
ClearFormCommandJJ 
=JJ 
newJJ 
RelayCommandJJ +
(JJ+ ,
	ClearFormJJ, 5
)JJ5 6
;JJ6 7%
NavigateToDesignerCommandKK !
=KK" #
newKK$ '
AsyncRelayCommandKK( 9
(KK9 :#
NavigateToDesignerAsyncKK: Q
)KKQ R
;KKR S
GoBackCommandLL 
=LL 
newLL 
RelayCommandLL (
(LL( )
GoBackLL) /
)LL/ 0
;LL0 1
TitleNN 
=NN 
$strNN "
;NN" #
LoadDataAsyncOO 
(OO 
)OO 
;OO 
}PP 
privateRR 
asyncRR 
TaskRR 
LoadDataAsyncRR $
(RR$ %
)RR% &
{SS 
IsBusyTT 
=TT 
trueTT 
;TT 
tryUU 
{VV 	
awaitWW 
LoadFloorsAsyncWW !
(WW! "
)WW" #
;WW# $
}XX 	
finallyYY 
{ZZ 	
IsBusy[[ 
=[[ 
false[[ 
;[[ 
}\\ 	
}]] 
private__ 
async__ 
Task__ 
LoadFloorsAsync__ &
(__& '
)__' (
{`` 
Floorsbb 
.bb 
Clearbb 
(bb 
)bb 
;bb 
Floorscc 
.cc 
Addcc 
(cc 
newcc 
FloorDtocc 
{dd 	
Idee 
=ee 
Guidee 
.ee 
NewGuidee 
(ee 
)ee 
,ee  
Nameff 
=ff 
$strff 
,ff  
Descriptiongg 
=gg 
$strgg /
,gg/ 0
Widthhh 
=hh 
$numhh 
,hh 
Heightii 
=ii 
$numii 
,ii 
BackgroundColorjj 
=jj 
$strjj '
,jj' (
IsActivekk 
=kk 
truekk 
,kk 
	CreatedAtll 
=ll 
DateTimell  
.ll  !
UtcNowll! '
,ll' (
	UpdatedAtmm 
=mm 
DateTimemm  
.mm  !
UtcNowmm! '
}nn 	
)nn	 

;nn
 
Floorspp 
.pp 
Addpp 
(pp 
newpp 
FloorDtopp 
{qq 	
Idrr 
=rr 
Guidrr 
.rr 
NewGuidrr 
(rr 
)rr 
,rr  
Namess 
=ss 
$strss "
,ss" #
Descriptiontt 
=tt 
$strtt 0
,tt0 1
Widthuu 
=uu 
$numuu 
,uu 
Heightvv 
=vv 
$numvv 
,vv 
BackgroundColorww 
=ww 
$strww '
,ww' (
IsActivexx 
=xx 
truexx 
,xx 
	CreatedAtyy 
=yy 
DateTimeyy  
.yy  !
UtcNowyy! '
,yy' (
	UpdatedAtzz 
=zz 
DateTimezz  
.zz  !
UtcNowzz! '
}{{ 	
){{	 

;{{
 
SelectedFloor}} 
=}} 
Floors}} 
.}} 
FirstOrDefault}} -
(}}- .
)}}. /
;}}/ 0
}~~ 
private
€€ 
async
€€ 
Task
€€ 
CreateFloorAsync
€€ '
(
€€' (
)
€€( )
{
 
if
‚‚ 

(
‚‚ 
string
‚‚ 
.
‚‚  
IsNullOrWhiteSpace
‚‚ %
(
‚‚% &
	FloorName
‚‚& /
)
‚‚/ 0
)
‚‚0 1
{
ƒƒ 	
await
„„ 
ShowErrorAsync
„„  
(
„„  !
$str
„„! =
)
„„= >
;
„„> ?
return
…… 
;
…… 
}
†† 	
IsBusy
ˆˆ 
=
ˆˆ 
true
ˆˆ 
;
ˆˆ 
try
‰‰ 
{
ŠŠ 	
var
‹‹ 
newFloor
‹‹ 
=
‹‹ 
new
‹‹ 
FloorDto
‹‹ '
{
ŒŒ 
Id
 
=
 
Guid
 
.
 
NewGuid
 !
(
! "
)
" #
,
# $
Name
ŽŽ 
=
ŽŽ 
	FloorName
ŽŽ  
,
ŽŽ  !
Description
 
=
 
FloorDescription
 .
,
. /
Width
 
=
 

FloorWidth
 "
,
" #
Height
‘‘ 
=
‘‘ 
FloorHeight
‘‘ $
,
‘‘$ %
BackgroundColor
’’ 
=
’’  !
BackgroundColor
’’" 1
,
’’1 2
IsActive
““ 
=
““ 
true
““ 
,
““  
	CreatedAt
”” 
=
”” 
DateTime
”” $
.
””$ %
UtcNow
””% +
,
””+ ,
	UpdatedAt
•• 
=
•• 
DateTime
•• $
.
••$ %
UtcNow
••% +
}
–– 
;
–– 
Floors
˜˜ 
.
˜˜ 
Add
˜˜ 
(
˜˜ 
newFloor
˜˜ 
)
˜˜  
;
˜˜  !
SelectedFloor
™™ 
=
™™ 
newFloor
™™ $
;
™™$ %
	ClearForm
šš 
(
šš 
)
šš 
;
šš 
await
œœ 
ShowSuccessAsync
œœ "
(
œœ" #
$"
œœ# %
$str
œœ% ,
{
œœ, -
	FloorName
œœ- 6
}
œœ6 7
$str
œœ7 N
"
œœN O
)
œœO P
;
œœP Q
}
 	
catch
žž 
(
žž 
	Exception
žž 
ex
žž 
)
žž 
{
ŸŸ 	
await
   
ShowErrorAsync
    
(
    !
$"
  ! #
$str
  # 9
{
  9 :
ex
  : <
.
  < =
Message
  = D
}
  D E
"
  E F
)
  F G
;
  G H
}
¡¡ 	
finally
¢¢ 
{
££ 	
IsBusy
¤¤ 
=
¤¤ 
false
¤¤ 
;
¤¤ 
}
¥¥ 	
}
¦¦ 
private
¨¨ 
async
¨¨ 
Task
¨¨ 
UpdateFloorAsync
¨¨ '
(
¨¨' (
)
¨¨( )
{
©© 
if
ªª 

(
ªª 
SelectedFloor
ªª 
==
ªª 
null
ªª !
||
ªª" $
string
ªª% +
.
ªª+ , 
IsNullOrWhiteSpace
ªª, >
(
ªª> ?
	FloorName
ªª? H
)
ªªH I
)
ªªI J
{
«« 	
await
¬¬ 
ShowErrorAsync
¬¬  
(
¬¬  !
$str
¬¬! J
)
¬¬J K
;
¬¬K L
return
­­ 
;
­­ 
}
®® 	
IsBusy
°° 
=
°° 
true
°° 
;
°° 
try
±± 
{
²² 	
SelectedFloor
³³ 
.
³³ 
Name
³³ 
=
³³  
	FloorName
³³! *
;
³³* +
SelectedFloor
´´ 
.
´´ 
Description
´´ %
=
´´& '
FloorDescription
´´( 8
;
´´8 9
SelectedFloor
µµ 
.
µµ 
Width
µµ 
=
µµ  !

FloorWidth
µµ" ,
;
µµ, -
SelectedFloor
¶¶ 
.
¶¶ 
Height
¶¶  
=
¶¶! "
FloorHeight
¶¶# .
;
¶¶. /
SelectedFloor
·· 
.
·· 
BackgroundColor
·· )
=
··* +
BackgroundColor
··, ;
;
··; <
SelectedFloor
¸¸ 
.
¸¸ 
	UpdatedAt
¸¸ #
=
¸¸$ %
DateTime
¸¸& .
.
¸¸. /
UtcNow
¸¸/ 5
;
¸¸5 6
await
ºº 
ShowSuccessAsync
ºº "
(
ºº" #
$"
ºº# %
$str
ºº% ,
{
ºº, -
	FloorName
ºº- 6
}
ºº6 7
$str
ºº7 N
"
ººN O
)
ººO P
;
ººP Q

IsEditMode
»» 
=
»» 
false
»» 
;
»» 
}
¼¼ 	
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½ 
{
¾¾ 	
await
¿¿ 
ShowErrorAsync
¿¿  
(
¿¿  !
$"
¿¿! #
$str
¿¿# 9
{
¿¿9 :
ex
¿¿: <
.
¿¿< =
Message
¿¿= D
}
¿¿D E
"
¿¿E F
)
¿¿F G
;
¿¿G H
}
ÀÀ 	
finally
ÁÁ 
{
ÂÂ 	
IsBusy
ÃÃ 
=
ÃÃ 
false
ÃÃ 
;
ÃÃ 
}
ÄÄ 	
}
ÅÅ 
private
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
DeleteFloorAsync
ÇÇ '
(
ÇÇ' (
FloorDto
ÇÇ( 0
?
ÇÇ0 1
floor
ÇÇ2 7
)
ÇÇ7 8
{
ÈÈ 
if
ÉÉ 

(
ÉÉ 
floor
ÉÉ 
==
ÉÉ 
null
ÉÉ 
)
ÉÉ 
{
ÊÊ 	
await
ËË 
ShowErrorAsync
ËË  
(
ËË  !
$str
ËË! C
)
ËËC D
;
ËËD E
return
ÌÌ 
;
ÌÌ 
}
ÍÍ 	
var
ÐÐ 
layouts
ÐÐ 
=
ÐÐ 
await
ÐÐ $
_tableLayoutRepository
ÐÐ 2
.
ÐÐ2 3$
GetLayoutsByFloorAsync
ÐÐ3 I
(
ÐÐI J
floor
ÐÐJ O
.
ÐÐO P
Id
ÐÐP R
)
ÐÐR S
;
ÐÐS T
if
ÑÑ 

(
ÑÑ 
layouts
ÑÑ 
.
ÑÑ 
Any
ÑÑ 
(
ÑÑ 
)
ÑÑ 
)
ÑÑ 
{
ÒÒ 	
await
ÓÓ 
ShowErrorAsync
ÓÓ  
(
ÓÓ  !
$"
ÓÓ! #
$str
ÓÓ# 8
{
ÓÓ8 9
floor
ÓÓ9 >
.
ÓÓ> ?
Name
ÓÓ? C
}
ÓÓC D
$str
ÓÓD U
{
ÓÓU V
layouts
ÓÓV ]
.
ÓÓ] ^
Count
ÓÓ^ c
}
ÓÓc d
$strÓÓd Œ
"ÓÓŒ 
)ÓÓ Ž
;ÓÓŽ 
return
ÔÔ 
;
ÔÔ 
}
ÕÕ 	
var
×× 
	confirmed
×× 
=
×× 
await
×× #
ShowConfirmationAsync
×× 3
(
××3 4
$"
××4 6
$str
××6 D
{
××D E
floor
××E J
.
××J K
Name
××K O
}
××O P
$str
××P R
"
××R S
,
××S T
$str
ØØ W
)
ØØW X
;
ØØX Y
if
ÚÚ 

(
ÚÚ 
!
ÚÚ 
	confirmed
ÚÚ 
)
ÚÚ 
return
ÚÚ 
;
ÚÚ 
IsBusy
ÜÜ 
=
ÜÜ 
true
ÜÜ 
;
ÜÜ 
try
ÝÝ 
{
ÞÞ 	
Floors
ßß 
.
ßß 
Remove
ßß 
(
ßß 
floor
ßß 
)
ßß  
;
ßß  !
if
áá 
(
áá 
SelectedFloor
áá 
==
áá  
floor
áá! &
)
áá& '
{
ââ 
SelectedFloor
ãã 
=
ãã 
Floors
ãã  &
.
ãã& '
FirstOrDefault
ãã' 5
(
ãã5 6
)
ãã6 7
;
ãã7 8
}
ää 
await
ææ 
ShowSuccessAsync
ææ "
(
ææ" #
$"
ææ# %
$str
ææ% ,
{
ææ, -
floor
ææ- 2
.
ææ2 3
Name
ææ3 7
}
ææ7 8
$str
ææ8 O
"
ææO P
)
ææP Q
;
ææQ R
}
çç 	
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè 
{
éé 	
await
êê 
ShowErrorAsync
êê  
(
êê  !
$"
êê! #
$str
êê# 9
{
êê9 :
ex
êê: <
.
êê< =
Message
êê= D
}
êêD E
"
êêE F
)
êêF G
;
êêG H
}
ëë 	
finally
ìì 
{
íí 	
IsBusy
îî 
=
îî 
false
îî 
;
îî 
}
ïï 	
}
ðð 
private
òò 
void
òò 
	ClearForm
òò 
(
òò 
)
òò 
{
óó 
	FloorName
ôô 
=
ôô 
string
ôô 
.
ôô 
Empty
ôô  
;
ôô  !
FloorDescription
õõ 
=
õõ 
string
õõ !
.
õõ! "
Empty
õõ" '
;
õõ' (

FloorWidth
öö 
=
öö 
$num
öö 
;
öö 
FloorHeight
÷÷ 
=
÷÷ 
$num
÷÷ 
;
÷÷ 
BackgroundColor
øø 
=
øø 
$str
øø #
;
øø# $

IsEditMode
ùù 
=
ùù 
false
ùù 
;
ùù 
}
úú 
private
üü 
async
üü 
Task
üü %
NavigateToDesignerAsync
üü .
(
üü. /
)
üü/ 0
{
ýý 
if
þþ 

(
þþ 
SelectedFloor
þþ 
==
þþ 
null
þþ !
)
þþ! "
return
þþ# )
;
þþ) *
if
€€ 

(
€€ 
_userService
€€ 
.
€€ 
CurrentUser
€€ $
==
€€% '
null
€€( ,
)
€€, -
return
€€. 4
;
€€4 5
var
‚‚ 
hasPermission
‚‚ 
=
‚‚ 
await
‚‚ !
_securityService
‚‚" 2
.
‚‚2 3 
HasPermissionAsync
‚‚3 E
(
‚‚E F
new
ƒƒ 
UserId
ƒƒ 
(
ƒƒ 
_userService
ƒƒ #
.
ƒƒ# $
CurrentUser
ƒƒ$ /
.
ƒƒ/ 0
Id
ƒƒ0 2
)
ƒƒ2 3
,
ƒƒ3 4
UserPermission
„„ 
.
„„ 
ManageTableLayout
„„ ,
)
„„, -
;
„„- .
if
†† 

(
†† 
hasPermission
†† 
)
†† 
{
‡‡ 	 
_navigationService
ˆˆ 
.
ˆˆ 
Navigate
ˆˆ '
(
ˆˆ' (
typeof
ˆˆ( .
(
ˆˆ. /
Views
ˆˆ/ 4
.
ˆˆ4 5
TableDesignerPage
ˆˆ5 F
)
ˆˆF G
)
ˆˆG H
;
ˆˆH I
}
‰‰ 	
else
ŠŠ 
{
‹‹ 	
await
ŒŒ 
ShowErrorAsync
ŒŒ  
(
ŒŒ  !
$str
ŒŒ! [
)
ŒŒ[ \
;
ŒŒ\ ]
}
 	
}
ŽŽ 
private
 
void
 
GoBack
 
(
 
)
 
{
‘‘  
_navigationService
’’ 
.
’’ 
GoBack
’’ !
(
’’! "
)
’’" #
;
’’# $
}
““ 
partial
•• 
void
•• $
OnSelectedFloorChanged
•• '
(
••' (
FloorDto
••( 0
?
••0 1
value
••2 7
)
••7 8
{
–– 
if
—— 

(
—— 
value
—— 
!=
—— 
null
—— 
)
—— 
{
˜˜ 	
	FloorName
™™ 
=
™™ 
value
™™ 
.
™™ 
Name
™™ "
;
™™" #
FloorDescription
šš 
=
šš 
value
šš $
.
šš$ %
Description
šš% 0
;
šš0 1

FloorWidth
›› 
=
›› 
value
›› 
.
›› 
Width
›› $
;
››$ %
FloorHeight
œœ 
=
œœ 
value
œœ 
.
œœ  
Height
œœ  &
;
œœ& '
BackgroundColor
 
=
 
value
 #
.
# $
BackgroundColor
$ 3
;
3 4

IsEditMode
žž 
=
žž 
true
žž 
;
žž 
}
ŸŸ 	
}
   
private
¢¢ 
async
¢¢ 
Task
¢¢ 
<
¢¢ 
bool
¢¢ 
>
¢¢ #
ShowConfirmationAsync
¢¢ 2
(
¢¢2 3
string
¢¢3 9
title
¢¢: ?
,
¢¢? @
string
¢¢A G
message
¢¢H O
)
¢¢O P
{
££ 
return
¥¥ 
true
¥¥ 
;
¥¥ 
}
¦¦ 
private
¨¨ 
async
¨¨ 
Task
¨¨ 
ShowErrorAsync
¨¨ %
(
¨¨% &
string
¨¨& ,
message
¨¨- 4
)
¨¨4 5
{
©© 
System
«« 
.
«« 
Diagnostics
«« 
.
«« 
Debug
««  
.
««  !
	WriteLine
««! *
(
««* +
$"
««+ -
$str
««- 4
{
««4 5
message
««5 <
}
««< =
"
««= >
)
««> ?
;
««? @
}
¬¬ 
private
®® 
async
®® 
Task
®® 
ShowSuccessAsync
®® '
(
®®' (
string
®®( .
message
®®/ 6
)
®®6 7
{
¯¯ 
System
±± 
.
±± 
Diagnostics
±± 
.
±± 
Debug
±±  
.
±±  !
	WriteLine
±±! *
(
±±* +
$"
±±+ -
$str
±±- 6
{
±±6 7
message
±±7 >
}
±±> ?
"
±±? @
)
±±@ A
;
±±A B
}
²² 
}³³ Ïó
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\ExportImportManagementViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class +
ExportImportManagementViewModel 4
:5 6
ViewModelBase7 D
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
private 
readonly "
ITableLayoutRepository +"
_tableLayoutRepository, B
;B C
private 
readonly 
TableLayoutExporter (
	_exporter) 2
;2 3
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
[ 
ObservableProperty 
] 
private  
ObservableCollection  
<  !
TableLayoutDto! /
>/ 0
_layouts1 9
=: ;
new< ?
(? @
)@ A
;A B
[ 
ObservableProperty 
] 
private 
TableLayoutDto 
? 
_selectedLayout +
;+ ,
[!! 
ObservableProperty!! 
]!! 
private"" 
string"" 
_exportPath"" 
=""  
string""! '
.""' (
Empty""( -
;""- .
[$$ 
ObservableProperty$$ 
]$$ 
private%% 
string%% 
_importPath%% 
=%%  
string%%! '
.%%' (
Empty%%( -
;%%- .
['' 
ObservableProperty'' 
]'' 
private(( 
bool(( 
_isBusy(( 
;(( 
[** 
ObservableProperty** 
]** 
private++ 
string++ 
_statusMessage++ !
=++" #
string++$ *
.++* +
Empty+++ 0
;++0 1
[-- 
ObservableProperty-- 
]-- 
private.. "
LayoutValidationResult.. "
?.." #
_validationResult..$ 5
;..5 6
[00 
ObservableProperty00 
]00 
private11 
bool11 $
_replaceExistingOnImport11 )
=11* +
false11, 1
;111 2
public33 

IRelayCommand33 %
ExportSingleLayoutCommand33 2
{333 4
get335 8
;338 9
}33: ;
public44 

IRelayCommand44 #
ExportAllLayoutsCommand44 0
{441 2
get443 6
;446 7
}448 9
public55 

IRelayCommand55 
ImportLayoutCommand55 ,
{55- .
get55/ 2
;552 3
}554 5
public66 

IRelayCommand66  
ImportLayoutsCommand66 -
{66. /
get660 3
;663 4
}665 6
public77 

IRelayCommand77 
CreateBackupCommand77 ,
{77- .
get77/ 2
;772 3
}774 5
public88 

IRelayCommand88  
RestoreBackupCommand88 -
{88. /
get880 3
;883 4
}885 6
public99 

IRelayCommand99 
ValidateFileCommand99 ,
{99- .
get99/ 2
;992 3
}994 5
public:: 

IRelayCommand:: #
BrowseExportPathCommand:: 0
{::1 2
get::3 6
;::6 7
}::8 9
public;; 

IRelayCommand;; #
BrowseImportPathCommand;; 0
{;;1 2
get;;3 6
;;;6 7
};;8 9
public== 
+
ExportImportManagementViewModel== *
(==* +
	IMediator>> 
mediator>> 
,>> "
ITableLayoutRepository?? !
tableLayoutRepository?? 4
,??4 5
TableLayoutExporter@@ 
exporter@@ $
,@@$ %
NavigationServiceAA 
navigationServiceAA +
)AA+ ,
{BB 
	_mediatorCC 
=CC 
mediatorCC 
;CC "
_tableLayoutRepositoryDD 
=DD  !
tableLayoutRepositoryDD! 6
;DD6 7
	_exporterEE 
=EE 
exporterEE 
;EE 
_navigationServiceFF 
=FF 
navigationServiceFF .
;FF. /%
ExportSingleLayoutCommandHH !
=HH" #
newHH$ '
AsyncRelayCommandHH( 9
(HH9 :#
ExportSingleLayoutAsyncHH: Q
)HHQ R
;HHR S#
ExportAllLayoutsCommandII 
=II  !
newII" %
AsyncRelayCommandII& 7
(II7 8!
ExportAllLayoutsAsyncII8 M
)IIM N
;IIN O
ImportLayoutCommandJJ 
=JJ 
newJJ !
AsyncRelayCommandJJ" 3
(JJ3 4
ImportLayoutAsyncJJ4 E
)JJE F
;JJF G 
ImportLayoutsCommandKK 
=KK 
newKK "
AsyncRelayCommandKK# 4
(KK4 5
ImportLayoutsAsyncKK5 G
)KKG H
;KKH I
CreateBackupCommandLL 
=LL 
newLL !
AsyncRelayCommandLL" 3
(LL3 4
CreateBackupAsyncLL4 E
)LLE F
;LLF G 
RestoreBackupCommandMM 
=MM 
newMM "
AsyncRelayCommandMM# 4
(MM4 5
RestoreBackupAsyncMM5 G
)MMG H
;MMH I
ValidateFileCommandNN 
=NN 
newNN !
AsyncRelayCommandNN" 3
(NN3 4
ValidateFileAsyncNN4 E
)NNE F
;NNF G#
BrowseExportPathCommandOO 
=OO  !
newOO" %
AsyncRelayCommandOO& 7
(OO7 8!
BrowseExportPathAsyncOO8 M
)OOM N
;OON O#
BrowseImportPathCommandPP 
=PP  !
newPP" %
AsyncRelayCommandPP& 7
(PP7 8!
BrowseImportPathAsyncPP8 M
)PPM N
;PPN O
TitleRR 
=RR 
$strRR *
;RR* +
LoadDataAsyncSS 
(SS 
)SS 
;SS 
}TT 
privateVV 
asyncVV 
TaskVV 
LoadDataAsyncVV $
(VV$ %
)VV% &
{WW 
IsBusyXX 
=XX 
trueXX 
;XX 
tryYY 
{ZZ 	
await[[ 
LoadLayoutsAsync[[ "
([[" #
)[[# $
;[[$ %
}\\ 	
finally]] 
{^^ 	
IsBusy__ 
=__ 
false__ 
;__ 
}`` 	
}aa 
privatecc 
asynccc 
Taskcc 
LoadLayoutsAsynccc '
(cc' (
)cc( )
{dd 
varee 
layoutsee 
=ee 
awaitee "
_tableLayoutRepositoryee 2
.ee2 3
GetAllAsyncee3 >
(ee> ?
)ee? @
;ee@ A
Layoutsff 
.ff 
Clearff 
(ff 
)ff 
;ff 
foreachhh 
(hh 
varhh 
layouthh 
inhh 
layoutshh &
)hh& '
{ii 	
Layoutsjj 
.jj 
Addjj 
(jj 
newjj 
TableLayoutDtojj *
{kk 
Idll 
=ll 
layoutll 
.ll 
Idll 
,ll 
Namemm 
=mm 
layoutmm 
.mm 
Namemm "
,mm" #
FloorIdnn 
=nn 
layoutnn  
.nn  !
FloorIdnn! (
,nn( )
Tablesoo 
=oo 
layoutoo 
.oo  
Tablesoo  &
.oo& '
Selectoo' -
(oo- .
too. /
=>oo0 2
newoo3 6
TableDtooo7 ?
{pp 
Idqq 
=qq 
tqq 
.qq 
Idqq 
,qq 
TableNumberrr 
=rr  !
trr" #
.rr# $
TableNumberrr$ /
,rr/ 0
Capacityss 
=ss 
tss  
.ss  !
Capacityss! )
,ss) *
Xtt 
=tt 
ttt 
.tt 
Xtt 
,tt 
Yuu 
=uu 
tuu 
.uu 
Yuu 
,uu 
Statusvv 
=vv 
tvv 
.vv 
Statusvv %
,vv% &
IsActiveww 
=ww 
tww  
.ww  !
IsActiveww! )
}xx 
)xx 
.xx 
ToListxx 
(xx 
)xx 
,xx 
	CreatedAtyy 
=yy 
layoutyy "
.yy" #
	CreatedAtyy# ,
,yy, -
	UpdatedAtzz 
=zz 
layoutzz "
.zz" #
	UpdatedAtzz# ,
,zz, -
IsActive{{ 
={{ 
layout{{ !
.{{! "
IsActive{{" *
,{{* +
Version|| 
=|| 
layout||  
.||  !
Version||! (
}}} 
)}} 
;}} 
}~~ 	
} 
private
 
async
 
Task
 %
ExportSingleLayoutAsync
 .
(
. /
)
/ 0
{
‚‚ 
if
ƒƒ 

(
ƒƒ 
SelectedLayout
ƒƒ 
==
ƒƒ 
null
ƒƒ "
)
ƒƒ" #
{
„„ 	
await
…… 
ShowErrorAsync
……  
(
……  !
$str
……! D
)
……D E
;
……E F
return
†† 
;
†† 
}
‡‡ 	
if
‰‰ 

(
‰‰ 
string
‰‰ 
.
‰‰  
IsNullOrWhiteSpace
‰‰ %
(
‰‰% &

ExportPath
‰‰& 0
)
‰‰0 1
)
‰‰1 2
{
ŠŠ 	
await
‹‹ 
ShowErrorAsync
‹‹  
(
‹‹  !
$str
‹‹! A
)
‹‹A B
;
‹‹B C
return
ŒŒ 
;
ŒŒ 
}
 	
IsBusy
 
=
 
true
 
;
 
try
 
{
‘‘ 	
var
’’ 
command
’’ 
=
’’ 
new
’’ !
ExportLayoutCommand
’’ 1
(
’’1 2
SelectedLayout
’’2 @
.
’’@ A
Id
’’A C
,
’’C D

ExportPath
’’E O
)
’’O P
;
’’P Q
var
““ 
result
““ 
=
““ 
await
““ 
	_mediator
““ (
.
““( )
Send
““) -
(
““- .
command
““. 5
)
““5 6
;
““6 7
await
•• 
ShowSuccessAsync
•• "
(
••" #
$"
••# %
$str
••% -
{
••- .
SelectedLayout
••. <
.
••< =
Name
••= A
}
••A B
$str
••B ]
{
••] ^
result
••^ d
}
••d e
"
••e f
)
••f g
;
••g h
}
–– 	
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
—— 
{
˜˜ 	
await
™™ 
ShowErrorAsync
™™  
(
™™  !
$"
™™! #
$str
™™# ;
{
™™; <
ex
™™< >
.
™™> ?
Message
™™? F
}
™™F G
"
™™G H
)
™™H I
;
™™I J
}
šš 	
finally
›› 
{
œœ 	
IsBusy
 
=
 
false
 
;
 
}
žž 	
}
ŸŸ 
private
¡¡ 
async
¡¡ 
Task
¡¡ #
ExportAllLayoutsAsync
¡¡ ,
(
¡¡, -
)
¡¡- .
{
¢¢ 
if
££ 

(
££ 
!
££ 
Layouts
££ 
.
££ 
Any
££ 
(
££ 
)
££ 
)
££ 
{
¤¤ 	
await
¥¥ 
ShowErrorAsync
¥¥  
(
¥¥  !
$str
¥¥! B
)
¥¥B C
;
¥¥C D
return
¦¦ 
;
¦¦ 
}
§§ 	
if
©© 

(
©© 
string
©© 
.
©©  
IsNullOrWhiteSpace
©© %
(
©©% &

ExportPath
©©& 0
)
©©0 1
)
©©1 2
{
ªª 	
await
«« 
ShowErrorAsync
««  
(
««  !
$str
««! A
)
««A B
;
««B C
return
¬¬ 
;
¬¬ 
}
­­ 	
IsBusy
¯¯ 
=
¯¯ 
true
¯¯ 
;
¯¯ 
try
°° 
{
±± 	
var
²² 
command
²² 
=
²² 
new
²² %
ExportAllLayoutsCommand
²² 5
(
²²5 6

ExportPath
²²6 @
)
²²@ A
;
²²A B
var
³³ 
result
³³ 
=
³³ 
await
³³ 
	_mediator
³³ (
.
³³( )
Send
³³) -
(
³³- .
command
³³. 5
)
³³5 6
;
³³6 7
await
µµ 
ShowSuccessAsync
µµ "
(
µµ" #
$"
µµ# %
$str
µµ% )
{
µµ) *
Layouts
µµ* 1
.
µµ1 2
Count
µµ2 7
}
µµ7 8
$str
µµ8 Z
{
µµZ [
result
µµ[ a
}
µµa b
"
µµb c
)
µµc d
;
µµd e
}
¶¶ 	
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
·· 
{
¸¸ 	
await
¹¹ 
ShowErrorAsync
¹¹  
(
¹¹  !
$"
¹¹! #
$str
¹¹# <
{
¹¹< =
ex
¹¹= ?
.
¹¹? @
Message
¹¹@ G
}
¹¹G H
"
¹¹H I
)
¹¹I J
;
¹¹J K
}
ºº 	
finally
»» 
{
¼¼ 	
IsBusy
½½ 
=
½½ 
false
½½ 
;
½½ 
}
¾¾ 	
}
¿¿ 
private
ÁÁ 
async
ÁÁ 
Task
ÁÁ 
ImportLayoutAsync
ÁÁ (
(
ÁÁ( )
)
ÁÁ) *
{
ÂÂ 
if
ÃÃ 

(
ÃÃ 
string
ÃÃ 
.
ÃÃ  
IsNullOrWhiteSpace
ÃÃ %
(
ÃÃ% &

ImportPath
ÃÃ& 0
)
ÃÃ0 1
)
ÃÃ1 2
{
ÄÄ 	
await
ÅÅ 
ShowErrorAsync
ÅÅ  
(
ÅÅ  !
$str
ÅÅ! A
)
ÅÅA B
;
ÅÅB C
return
ÆÆ 
;
ÆÆ 
}
ÇÇ 	
await
ÊÊ 
ValidateFileAsync
ÊÊ 
(
ÊÊ  
)
ÊÊ  !
;
ÊÊ! "
if
ÌÌ 

(
ÌÌ 
ValidationResult
ÌÌ 
==
ÌÌ 
null
ÌÌ  $
||
ÌÌ% '
!
ÌÌ( )
ValidationResult
ÌÌ) 9
.
ÌÌ9 :
IsValid
ÌÌ: A
)
ÌÌA B
{
ÍÍ 	
await
ÎÎ 
ShowErrorAsync
ÎÎ  
(
ÎÎ  !
$str
ÎÎ! X
)
ÎÎX Y
;
ÎÎY Z
return
ÏÏ 
;
ÏÏ 
}
ÐÐ 	
IsBusy
ÒÒ 
=
ÒÒ 
true
ÒÒ 
;
ÒÒ 
try
ÓÓ 
{
ÔÔ 	
var
ÕÕ 
command
ÕÕ 
=
ÕÕ 
new
ÕÕ !
ImportLayoutCommand
ÕÕ 1
(
ÕÕ1 2

ImportPath
ÕÕ2 <
)
ÕÕ< =
;
ÕÕ= >
var
ÖÖ 
importedLayout
ÖÖ 
=
ÖÖ  
await
ÖÖ! &
	_mediator
ÖÖ' 0
.
ÖÖ0 1
Send
ÖÖ1 5
(
ÖÖ5 6
command
ÖÖ6 =
)
ÖÖ= >
;
ÖÖ> ?
Layouts
ÙÙ 
.
ÙÙ 
Add
ÙÙ 
(
ÙÙ 
importedLayout
ÙÙ &
)
ÙÙ& '
;
ÙÙ' (
await
ÛÛ 
ShowSuccessAsync
ÛÛ "
(
ÛÛ" #
$"
ÛÛ# %
$str
ÛÛ% -
{
ÛÛ- .
importedLayout
ÛÛ. <
.
ÛÛ< =
Name
ÛÛ= A
}
ÛÛA B
$str
ÛÛB Z
"
ÛÛZ [
)
ÛÛ[ \
;
ÛÛ\ ]
}
ÜÜ 	
catch
ÝÝ 
(
ÝÝ 
	Exception
ÝÝ 
ex
ÝÝ 
)
ÝÝ 
{
ÞÞ 	
await
ßß 
ShowErrorAsync
ßß  
(
ßß  !
$"
ßß! #
$str
ßß# ;
{
ßß; <
ex
ßß< >
.
ßß> ?
Message
ßß? F
}
ßßF G
"
ßßG H
)
ßßH I
;
ßßI J
}
àà 	
finally
áá 
{
ââ 	
IsBusy
ãã 
=
ãã 
false
ãã 
;
ãã 
}
ää 	
}
åå 
private
çç 
async
çç 
Task
çç  
ImportLayoutsAsync
çç )
(
çç) *
)
çç* +
{
èè 
if
éé 

(
éé 
string
éé 
.
éé  
IsNullOrWhiteSpace
éé %
(
éé% &

ImportPath
éé& 0
)
éé0 1
)
éé1 2
{
êê 	
await
ëë 
ShowErrorAsync
ëë  
(
ëë  !
$str
ëë! A
)
ëëA B
;
ëëB C
return
ìì 
;
ìì 
}
íí 	
await
ðð 
ValidateFileAsync
ðð 
(
ðð  
)
ðð  !
;
ðð! "
if
òò 

(
òò 
ValidationResult
òò 
==
òò 
null
òò  $
||
òò% '
!
òò( )
ValidationResult
òò) 9
.
òò9 :
IsValid
òò: A
)
òòA B
{
óó 	
await
ôô 
ShowErrorAsync
ôô  
(
ôô  !
$str
ôô! X
)
ôôX Y
;
ôôY Z
return
õõ 
;
õõ 
}
öö 	
IsBusy
øø 
=
øø 
true
øø 
;
øø 
try
ùù 
{
úú 	
var
ûû 
command
ûû 
=
ûû 
new
ûû "
ImportLayoutsCommand
ûû 2
(
ûû2 3

ImportPath
ûû3 =
,
ûû= >%
ReplaceExistingOnImport
ûû? V
)
ûûV W
;
ûûW X
var
üü 
importedLayouts
üü 
=
üü  !
await
üü" '
	_mediator
üü( 1
.
üü1 2
Send
üü2 6
(
üü6 7
command
üü7 >
)
üü> ?
;
üü? @
if
þþ 
(
þþ %
ReplaceExistingOnImport
þþ '
)
þþ' (
{
ÿÿ 
Layouts
€€ 
.
€€ 
Clear
€€ 
(
€€ 
)
€€ 
;
€€  
}
 
foreach
ƒƒ 
(
ƒƒ 
var
ƒƒ 
layout
ƒƒ 
in
ƒƒ  "
importedLayouts
ƒƒ# 2
)
ƒƒ2 3
{
„„ 
Layouts
…… 
.
…… 
Add
…… 
(
…… 
layout
…… "
)
……" #
;
……# $
}
†† 
await
ˆˆ 
ShowSuccessAsync
ˆˆ "
(
ˆˆ" #
$"
ˆˆ# %
$str
ˆˆ% ;
{
ˆˆ; <
importedLayouts
ˆˆ< K
.
ˆˆK L
Count
ˆˆL Q
}
ˆˆQ R
$str
ˆˆR [
"
ˆˆ[ \
)
ˆˆ\ ]
;
ˆˆ] ^
}
‰‰ 	
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ 
{
‹‹ 	
await
ŒŒ 
ShowErrorAsync
ŒŒ  
(
ŒŒ  !
$"
ŒŒ! #
$str
ŒŒ# <
{
ŒŒ< =
ex
ŒŒ= ?
.
ŒŒ? @
Message
ŒŒ@ G
}
ŒŒG H
"
ŒŒH I
)
ŒŒI J
;
ŒŒJ K
}
 	
finally
ŽŽ 
{
 	
IsBusy
 
=
 
false
 
;
 
}
‘‘ 	
}
’’ 
private
”” 
async
”” 
Task
”” 
CreateBackupAsync
”” (
(
””( )
)
””) *
{
•• 
if
–– 

(
–– 
!
–– 
Layouts
–– 
.
–– 
Any
–– 
(
–– 
)
–– 
)
–– 
{
—— 	
await
˜˜ 
ShowErrorAsync
˜˜  
(
˜˜  !
$str
˜˜! B
)
˜˜B C
;
˜˜C D
return
™™ 
;
™™ 
}
šš 	
if
œœ 

(
œœ 
string
œœ 
.
œœ  
IsNullOrWhiteSpace
œœ %
(
œœ% &

ExportPath
œœ& 0
)
œœ0 1
)
œœ1 2
{
 	
await
žž 
ShowErrorAsync
žž  
(
žž  !
$str
žž! @
)
žž@ A
;
žžA B
return
ŸŸ 
;
ŸŸ 
}
   	
IsBusy
¢¢ 
=
¢¢ 
true
¢¢ 
;
¢¢ 
try
££ 
{
¤¤ 	
var
¥¥ 

backupData
¥¥ 
=
¥¥ 
	_exporter
¥¥ &
.
¥¥& '
CreateBackup
¥¥' 3
(
¥¥3 4
Layouts
¥¥4 ;
)
¥¥; <
;
¥¥< =
await
¦¦ 
File
¦¦ 
.
¦¦ 
WriteAllTextAsync
¦¦ (
(
¦¦( )

ExportPath
¦¦) 3
,
¦¦3 4

backupData
¦¦5 ?
)
¦¦? @
;
¦¦@ A
await
¨¨ 
ShowSuccessAsync
¨¨ "
(
¨¨" #
$"
¨¨# %
$str
¨¨% F
{
¨¨F G
Layouts
¨¨G N
.
¨¨N O
Count
¨¨O T
}
¨¨T U
$str
¨¨U ^
"
¨¨^ _
)
¨¨_ `
;
¨¨` a
}
©© 	
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª 
{
«« 	
await
¬¬ 
ShowErrorAsync
¬¬  
(
¬¬  !
$"
¬¬! #
$str
¬¬# :
{
¬¬: ;
ex
¬¬; =
.
¬¬= >
Message
¬¬> E
}
¬¬E F
"
¬¬F G
)
¬¬G H
;
¬¬H I
}
­­ 	
finally
®® 
{
¯¯ 	
IsBusy
°° 
=
°° 
false
°° 
;
°° 
}
±± 	
}
²² 
private
´´ 
async
´´ 
Task
´´  
RestoreBackupAsync
´´ )
(
´´) *
)
´´* +
{
µµ 
if
¶¶ 

(
¶¶ 
string
¶¶ 
.
¶¶  
IsNullOrWhiteSpace
¶¶ %
(
¶¶% &

ImportPath
¶¶& 0
)
¶¶0 1
)
¶¶1 2
{
·· 	
await
¸¸ 
ShowErrorAsync
¸¸  
(
¸¸  !
$str
¸¸! @
)
¸¸@ A
;
¸¸A B
return
¹¹ 
;
¹¹ 
}
ºº 	
IsBusy
¼¼ 
=
¼¼ 
true
¼¼ 
;
¼¼ 
try
½½ 
{
¾¾ 	
var
¿¿ 

backupData
¿¿ 
=
¿¿ 
await
¿¿ "
File
¿¿# '
.
¿¿' (
ReadAllTextAsync
¿¿( 8
(
¿¿8 9

ImportPath
¿¿9 C
)
¿¿C D
;
¿¿D E
var
ÀÀ 
restoredLayouts
ÀÀ 
=
ÀÀ  !
	_exporter
ÀÀ" +
.
ÀÀ+ ,
RestoreFromBackup
ÀÀ, =
(
ÀÀ= >

backupData
ÀÀ> H
)
ÀÀH I
;
ÀÀI J
if
ÂÂ 
(
ÂÂ %
ReplaceExistingOnImport
ÂÂ '
)
ÂÂ' (
{
ÃÃ 
Layouts
ÄÄ 
.
ÄÄ 
Clear
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ  
}
ÅÅ 
foreach
ÇÇ 
(
ÇÇ 
var
ÇÇ 
layout
ÇÇ 
in
ÇÇ  "
restoredLayouts
ÇÇ# 2
)
ÇÇ2 3
{
ÈÈ 
Layouts
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ 
layout
ÉÉ "
)
ÉÉ" #
;
ÉÉ# $
}
ÊÊ 
await
ÌÌ 
ShowSuccessAsync
ÌÌ "
(
ÌÌ" #
$"
ÌÌ# %
$str
ÌÌ% ;
{
ÌÌ; <
restoredLayouts
ÌÌ< K
.
ÌÌK L
Count
ÌÌL Q
}
ÌÌQ R
$str
ÌÌR g
"
ÌÌg h
)
ÌÌh i
;
ÌÌi j
}
ÍÍ 	
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ 
{
ÏÏ 	
await
ÐÐ 
ShowErrorAsync
ÐÐ  
(
ÐÐ  !
$"
ÐÐ! #
$str
ÐÐ# ;
{
ÐÐ; <
ex
ÐÐ< >
.
ÐÐ> ?
Message
ÐÐ? F
}
ÐÐF G
"
ÐÐG H
)
ÐÐH I
;
ÐÐI J
}
ÑÑ 	
finally
ÒÒ 
{
ÓÓ 	
IsBusy
ÔÔ 
=
ÔÔ 
false
ÔÔ 
;
ÔÔ 
}
ÕÕ 	
}
ÖÖ 
private
ØØ 
async
ØØ 
Task
ØØ 
ValidateFileAsync
ØØ (
(
ØØ( )
)
ØØ) *
{
ÙÙ 
if
ÚÚ 

(
ÚÚ 
string
ÚÚ 
.
ÚÚ  
IsNullOrWhiteSpace
ÚÚ %
(
ÚÚ% &

ImportPath
ÚÚ& 0
)
ÚÚ0 1
)
ÚÚ1 2
{
ÛÛ 	
ValidationResult
ÜÜ 
=
ÜÜ 
new
ÜÜ "$
LayoutValidationResult
ÜÜ# 9
{
ÝÝ 
IsValid
ÞÞ 
=
ÞÞ 
false
ÞÞ 
,
ÞÞ  
ErrorMessage
ßß 
=
ßß 
$str
ßß 8
}
àà 
;
àà 
return
áá 
;
áá 
}
ââ 	
IsBusy
ää 
=
ää 
true
ää 
;
ää 
try
åå 
{
ææ 	
var
çç 
command
çç 
=
çç 
new
çç '
ValidateLayoutFileCommand
çç 7
(
çç7 8

ImportPath
çç8 B
)
ççB C
;
ççC D
ValidationResult
èè 
=
èè 
await
èè $
	_mediator
èè% .
.
èè. /
Send
èè/ 3
(
èè3 4
command
èè4 ;
)
èè; <
;
èè< =
StatusMessage
êê 
=
êê 
ValidationResult
êê ,
.
êê, -
IsValid
êê- 4
?
ëë 
$str
ëë -
:
ìì 
$"
ìì 
$str
ìì ,
{
ìì, -
ValidationResult
ìì- =
.
ìì= >
ErrorMessage
ìì> J
}
ììJ K
"
ììK L
;
ììL M
}
íí 	
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî 
{
ïï 	
ValidationResult
ðð 
=
ðð 
new
ðð "$
LayoutValidationResult
ðð# 9
{
ññ 
IsValid
òò 
=
òò 
false
òò 
,
òò  
ErrorMessage
óó 
=
óó 
ex
óó !
.
óó! "
Message
óó" )
}
ôô 
;
ôô 
StatusMessage
õõ 
=
õõ 
$"
õõ 
$str
õõ 0
{
õõ0 1
ex
õõ1 3
.
õõ3 4
Message
õõ4 ;
}
õõ; <
"
õõ< =
;
õõ= >
}
öö 	
finally
÷÷ 
{
øø 	
IsBusy
ùù 
=
ùù 
false
ùù 
;
ùù 
}
úú 	
}
ûû 
private
ýý 
async
ýý 
Task
ýý #
BrowseExportPathAsync
ýý ,
(
ýý, -
)
ýý- .
{
þþ 
var
ÿÿ 

filePicker
ÿÿ 
=
ÿÿ 
new
ÿÿ 
FileSavePicker
ÿÿ +
(
ÿÿ+ ,
)
ÿÿ, -
;
ÿÿ- .

filePicker
€€ 
.
€€ 
FileTypeChoices
€€ "
.
€€" #
Add
€€# &
(
€€& '
$str
€€' -
,
€€- .
new
€€/ 2
List
€€3 7
<
€€7 8
string
€€8 >
>
€€> ?
{
€€@ A
$str
€€B I
}
€€J K
)
€€K L
;
€€L M

filePicker
 
.
 
SuggestedFileName
 $
=
% &
$"
' )
$str
) 7
{
7 8
DateTime
8 @
.
@ A
Now
A D
:
D E
$str
E T
}
T U
$str
U Z
"
Z [
;
[ \
var
ƒƒ 
file
ƒƒ 
=
ƒƒ 
await
ƒƒ 

filePicker
ƒƒ #
.
ƒƒ# $
PickSaveFileAsync
ƒƒ$ 5
(
ƒƒ5 6
)
ƒƒ6 7
;
ƒƒ7 8
if
„„ 

(
„„ 
file
„„ 
!=
„„ 
null
„„ 
)
„„ 
{
…… 	

ExportPath
†† 
=
†† 
file
†† 
.
†† 
Path
†† "
;
††" #
}
‡‡ 	
}
ˆˆ 
private
ŠŠ 
async
ŠŠ 
Task
ŠŠ #
BrowseImportPathAsync
ŠŠ ,
(
ŠŠ, -
)
ŠŠ- .
{
‹‹ 
var
ŒŒ 

filePicker
ŒŒ 
=
ŒŒ 
new
ŒŒ 
FileOpenPicker
ŒŒ +
(
ŒŒ+ ,
)
ŒŒ, -
;
ŒŒ- .

filePicker
 
.
 
FileTypeFilter
 !
.
! "
Add
" %
(
% &
$str
& -
)
- .
;
. /
var
 
file
 
=
 
await
 

filePicker
 #
.
# $!
PickSingleFileAsync
$ 7
(
7 8
)
8 9
;
9 :
if
 

(
 
file
 
!=
 
null
 
)
 
{
‘‘ 	

ImportPath
’’ 
=
’’ 
file
’’ 
.
’’ 
Path
’’ "
;
’’" #
await
““ 
ValidateFileAsync
““ #
(
““# $
)
““$ %
;
““% &
}
”” 	
}
•• 
partial
—— 
void
—— %
OnSelectedLayoutChanged
—— (
(
——( )
TableLayoutDto
——) 7
?
——7 8
value
——9 >
)
——> ?
{
˜˜ 
if
šš 

(
šš 
value
šš 
!=
šš 
null
šš 
&&
šš 
string
šš #
.
šš# $ 
IsNullOrWhiteSpace
šš$ 6
(
šš6 7

ExportPath
šš7 A
)
ššA B
)
ššB C
{
›› 	

ExportPath
œœ 
=
œœ 
$"
œœ 
{
œœ 
value
œœ !
.
œœ! "
Name
œœ" &
}
œœ& '
$str
œœ' /
{
œœ/ 0
DateTime
œœ0 8
.
œœ8 9
Now
œœ9 <
:
œœ< =
$str
œœ= L
}
œœL M
$str
œœM R
"
œœR S
;
œœS T
}
 	
}
žž 
private
   
async
   
Task
   
ShowErrorAsync
   %
(
  % &
string
  & ,
message
  - 4
)
  4 5
{
¡¡ 
StatusMessage
¢¢ 
=
¢¢ 
message
¢¢ 
;
¢¢  
System
¤¤ 
.
¤¤ 
Diagnostics
¤¤ 
.
¤¤ 
Debug
¤¤  
.
¤¤  !
	WriteLine
¤¤! *
(
¤¤* +
$"
¤¤+ -
$str
¤¤- 4
{
¤¤4 5
message
¤¤5 <
}
¤¤< =
"
¤¤= >
)
¤¤> ?
;
¤¤? @
}
¥¥ 
private
§§ 
async
§§ 
Task
§§ 
ShowSuccessAsync
§§ '
(
§§' (
string
§§( .
message
§§/ 6
)
§§6 7
{
¨¨ 
StatusMessage
©© 
=
©© 
message
©© 
;
©©  
System
«« 
.
«« 
Diagnostics
«« 
.
«« 
Debug
««  
.
««  !
	WriteLine
««! *
(
««* +
$"
««+ -
$str
««- 6
{
««6 7
message
««7 >
}
««> ?
"
««? @
)
««@ A
;
««A B
}
¬¬ 
}­­ £+
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\DrawerPullReportViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
class

 %
DrawerPullReportViewModel

 &
:

' (
ViewModelBase

) 6
{ 
private 
readonly 
IQueryHandler "
<" #$
GetDrawerPullReportQuery# ;
,; <%
GetDrawerPullReportResult= V
>V W
_reportQueryHandlerX k
;k l
private 
readonly 
IQueryHandler "
<" #&
GetCurrentCashSessionQuery# =
,= >'
GetCurrentCashSessionResult? Z
>Z ["
_currentSessionHandler\ r
;r s
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
DrawerPullReportDto 
?  
_report! (
;( )
private 
bool 

_isLoading 
; 
public 

DrawerPullReportDto 
? 
Report  &
{ 
get 
=> 
_report 
; 
set 
=> 
SetProperty 
( 
ref 
_report &
,& '
value( -
)- .
;. /
} 
public 

bool 
	IsLoading 
{ 
get 
=> 

_isLoading 
; 
set 
=> 
SetProperty 
( 
ref 

_isLoading )
,) *
value+ 0
)0 1
;1 2
} 
public 

ICommand 
PrintCommand  
{! "
get# &
;& '
}( )
public   

ICommand   
CloseCommand    
{  ! "
get  # &
;  & '
}  ( )
public"" 
%
DrawerPullReportViewModel"" $
(""$ %
IQueryHandler## 
<## $
GetDrawerPullReportQuery## .
,##. /%
GetDrawerPullReportResult##0 I
>##I J
reportQueryHandler##K ]
,##] ^
IQueryHandler$$ 
<$$ &
GetCurrentCashSessionQuery$$ 0
,$$0 1'
GetCurrentCashSessionResult$$2 M
>$$M N!
currentSessionHandler$$O d
,$$d e
NavigationService%% 
navigationService%% +
)%%+ ,
{&& 
_reportQueryHandler'' 
='' 
reportQueryHandler'' 0
;''0 1"
_currentSessionHandler(( 
=((  !
currentSessionHandler((! 6
;((6 7
_navigationService)) 
=)) 
navigationService)) .
;)). /
PrintCommand++ 
=++ 
new++ 
AsyncRelayCommand++ ,
(++, -

PrintAsync++- 7
)++7 8
;++8 9
CloseCommand,, 
=,, 
new,, 
RelayCommand,, '
(,,' (
Close,,( -
),,- .
;,,. /
}-- 
public// 

async// 
Task// 
InitializeAsync// %
(//% &
)//& '
{00 
	IsLoading11 
=11 
true11 
;11 
try22 
{33 	
var44 
sessionResult44 
=44 
await44  %"
_currentSessionHandler44& <
.44< =
HandleAsync44= H
(44H I
new44I L&
GetCurrentCashSessionQuery44M g
(44g h
)44h i
)44i j
;44j k
if55 
(55 
sessionResult55 
.55 
CashSession55 )
==55* ,
null55- 1
)551 2
{66 
return:: 
;:: 
};; 
var== 
result== 
=== 
await== 
_reportQueryHandler== 2
.==2 3
HandleAsync==3 >
(==> ?
new==? B$
GetDrawerPullReportQuery==C [
{==\ ]
CashSessionId==^ k
===l m
sessionResult==n {
.=={ |
CashSession	==| ‡
.
==‡ ˆ
Id
==ˆ Š
}
==‹ Œ
)
==Œ 
;
== Ž
Report>> 
=>> 
result>> 
.>> 
Report>> "
;>>" #
}?? 	
catch@@ 
(@@ 
	Exception@@ 
ex@@ 
)@@ 
{AA 	
SystemCC 
.CC 
DiagnosticsCC 
.CC  
DebugCC  %
.CC% &
	WriteLineCC& /
(CC/ 0
$"CC0 2
$strCC2 T
{CCT U
exCCU W
.CCW X
MessageCCX _
}CC_ `
"CC` a
)CCa b
;CCb c
}DD 	
finallyEE 
{FF 	
	IsLoadingGG 
=GG 
falseGG 
;GG 
}HH 	
}II 
privateKK 
asyncKK 
TaskKK 

PrintAsyncKK !
(KK! "
)KK" #
{LL 
awaitOO 
TaskOO 
.OO 
YieldOO 
(OO 
)OO 
;OO 
}PP 
privateRR 
voidRR 
CloseRR 
(RR 
)RR 
{SS 
}[[ 
}\\ °°
hC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\DiscountTaxViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public

 
sealed

 
class

  
DiscountTaxViewModel

 (
:

) *
ViewModelBase

+ 8
{ 
private 
readonly 
IQueryHandler "
<" #
GetTicketQuery# 1
,1 2
	TicketDto3 <
?< =
>= >

_getTicket? I
;I J
private 
readonly 
ICommandHandler $
<$ %#
SetServiceChargeCommand% <
,< ="
SetServiceChargeResult> T
>T U
_setServiceChargeV g
;g h
private 
readonly 
ICommandHandler $
<$ %$
SetDeliveryChargeCommand% =
,= >#
SetDeliveryChargeResult? V
>V W
_setDeliveryChargeX j
;j k
private 
readonly 
ICommandHandler $
<$ % 
SetAdjustmentCommand% 9
,9 :
SetAdjustmentResult; N
>N O
_setAdjustmentP ^
;^ _
private 
readonly 
ICommandHandler $
<$ %$
SetAdvancePaymentCommand% =
,= >#
SetAdvancePaymentResult? V
>V W
_setAdvanceX c
;c d
private 
	TicketDto 
? 
_ticket 
; 
private 
string 
_ticketIdText  
=! "
string# )
.) *
Empty* /
;/ 0
private 
string 
_processedByText #
=$ %
Guid& *
.* +
Empty+ 0
.0 1
ToString1 9
(9 :
): ;
;; <
private 
string 
_serviceChargeText %
=& '
$str( +
;+ ,
private 
string 
_deliveryChargeText &
=' (
$str) ,
;, -
private 
string 
_adjustmentText "
=# $
$str% (
;( )
private 
string 
_advanceText 
=  !
$str" %
;% &
private 
string 
? 
_adjustmentReason %
;% &
private 
string 
? 
_error 
; 
public 
 
DiscountTaxViewModel 
(  
IQueryHandler 
< 
GetTicketQuery $
,$ %
	TicketDto& /
?/ 0
>0 1
	getTicket2 ;
,; <
ICommandHandler   
<   #
SetServiceChargeCommand   /
,  / 0"
SetServiceChargeResult  1 G
>  G H
setServiceCharge  I Y
,  Y Z
ICommandHandler!! 
<!! $
SetDeliveryChargeCommand!! 0
,!!0 1#
SetDeliveryChargeResult!!2 I
>!!I J
setDeliveryCharge!!K \
,!!\ ]
ICommandHandler"" 
<""  
SetAdjustmentCommand"" ,
,"", -
SetAdjustmentResult"". A
>""A B
setAdjustment""C P
,""P Q
ICommandHandler## 
<## $
SetAdvancePaymentCommand## 0
,##0 1#
SetAdvancePaymentResult##2 I
>##I J

setAdvance##K U
)##U V
{$$ 

_getTicket%% 
=%% 
	getTicket%% 
;%% 
_setServiceCharge&& 
=&& 
setServiceCharge&& ,
;&&, -
_setDeliveryCharge'' 
='' 
setDeliveryCharge'' .
;''. /
_setAdjustment(( 
=(( 
setAdjustment(( &
;((& '
_setAdvance)) 
=)) 

setAdvance))  
;))  !
Title++ 
=++ 
$str++  
;++  !
LoadTicketCommand-- 
=-- 
new-- 
AsyncRelayCommand--  1
(--1 2
LoadTicketAsync--2 A
)--A B
;--B C%
SetServiceChargeUiCommand.. !
=.." #
new..$ '
AsyncRelayCommand..( 9
(..9 :!
SetServiceChargeAsync..: O
)..O P
;..P Q&
SetDeliveryChargeUiCommand// "
=//# $
new//% (
AsyncRelayCommand//) :
(//: ;"
SetDeliveryChargeAsync//; Q
)//Q R
;//R S"
SetAdjustmentUiCommand00 
=00  
new00! $
AsyncRelayCommand00% 6
(006 7
SetAdjustmentAsync007 I
)00I J
;00J K
SetAdvanceUiCommand11 
=11 
new11 !
AsyncRelayCommand11" 3
(113 4
SetAdvanceAsync114 C
)11C D
;11D E
}22 
public44 

	TicketDto44 
?44 
Ticket44 
{55 
get66 
=>66 
_ticket66 
;66 
private77 
set77 
{88 	
if99 
(99 
SetProperty99 
(99 
ref99 
_ticket99  '
,99' (
value99) .
)99. /
)99/ 0
{:: 
OnPropertyChanged;; !
(;;! "
nameof;;" (
(;;( )
	HasTicket;;) 2
);;2 3
);;3 4
;;;4 5
OnPropertyChanged<< !
(<<! "
nameof<<" (
(<<( )

HeaderText<<) 3
)<<3 4
)<<4 5
;<<5 6
OnPropertyChanged== !
(==! "
nameof==" (
(==( )

TotalsText==) 3
)==3 4
)==4 5
;==5 6
}>> 
}?? 	
}@@ 
publicBB 

boolBB 
	HasTicketBB 
=>BB 
TicketBB #
!=BB$ &
nullBB' +
;BB+ ,
publicDD 

stringDD 
TicketIdTextDD 
{EE 
getFF 
=>FF 
_ticketIdTextFF 
;FF 
setGG 
=>GG 
SetPropertyGG 
(GG 
refGG 
_ticketIdTextGG ,
,GG, -
valueGG. 3
)GG3 4
;GG4 5
}HH 
publicJJ 

stringJJ 
ProcessedByTextJJ !
{KK 
getLL 
=>LL 
_processedByTextLL 
;LL  
setMM 
=>MM 
SetPropertyMM 
(MM 
refMM 
_processedByTextMM /
,MM/ 0
valueMM1 6
)MM6 7
;MM7 8
}NN 
publicPP 

stringPP 

HeaderTextPP 
=>PP 
TicketPP  &
==PP' )
nullPP* .
?QQ 	
$strQQ
 
:RR 	
$"RR
 
$strRR 
{RR 
TicketRR 
.RR 
TicketNumberRR (
}RR( )
$strRR) +
{RR+ ,
TicketRR, 2
.RR2 3
StatusRR3 9
}RR9 :
$strRR: A
{RRA B
TicketRRB H
.RRH I
IdRRI K
}RRK L
"RRL M
;RRM N
publicTT 

stringTT 

TotalsTextTT 
=>TT 
TicketTT  &
==TT' )
nullTT* .
?UU 	
stringUU
 
.UU 
EmptyUU 
:VV 	
$"VV
 
$strVV 
{VV 
TicketVV 
.VV 
SubtotalAmountVV ,
}VV, -
$strVV- 9
{VV9 :
TicketVV: @
.VV@ A
DiscountAmountVVA O
}VVO P
$strVVP W
{VVW X
TicketVVX ^
.VV^ _
	TaxAmountVV_ h
}VVh i
$strVVi k
"VVk l
+VVm n
$"WW
 
$strWW 
{WW 
TicketWW 
.WW 
ServiceChargeAmountWW ,
}WW, -
$strWW- 9
{WW9 :
TicketWW: @
.WW@ A 
DeliveryChargeAmountWWA U
}WWU V
$strWWV ]
{WW] ^
TicketWW^ d
.WWd e
AdjustmentAmountWWe u
}WWu v
$str	WWv 
{
WW ‚
Ticket
WW‚ ˆ
.
WWˆ ‰
AdvanceAmount
WW‰ –
}
WW– —
$str
WW— ™
"
WW™ š
+
WW› œ
$"XX
 
$strXX 
{XX 
TicketXX 
.XX 
TotalAmountXX &
}XX& '
$strXX' /
{XX/ 0
TicketXX0 6
.XX6 7

PaidAmountXX7 A
}XXA B
$strXXB I
{XXI J
TicketXXJ P
.XXP Q
	DueAmountXXQ Z
}XXZ [
"XX[ \
;XX\ ]
publicZZ 

stringZZ 
ServiceChargeTextZZ #
{[[ 
get\\ 
=>\\ 
_serviceChargeText\\ !
;\\! "
set]] 
=>]] 
SetProperty]] 
(]] 
ref]] 
_serviceChargeText]] 1
,]]1 2
value]]3 8
)]]8 9
;]]9 :
}^^ 
public`` 

string`` 
DeliveryChargeText`` $
{aa 
getbb 
=>bb 
_deliveryChargeTextbb "
;bb" #
setcc 
=>cc 
SetPropertycc 
(cc 
refcc 
_deliveryChargeTextcc 2
,cc2 3
valuecc4 9
)cc9 :
;cc: ;
}dd 
publicff 

stringff 
AdjustmentTextff  
{gg 
gethh 
=>hh 
_adjustmentTexthh 
;hh 
setii 
=>ii 
SetPropertyii 
(ii 
refii 
_adjustmentTextii .
,ii. /
valueii0 5
)ii5 6
;ii6 7
}jj 
publicll 

stringll 
AdvanceTextll 
{mm 
getnn 
=>nn 
_advanceTextnn 
;nn 
setoo 
=>oo 
SetPropertyoo 
(oo 
refoo 
_advanceTextoo +
,oo+ ,
valueoo- 2
)oo2 3
;oo3 4
}pp 
publicrr 

stringrr 
?rr 
AdjustmentReasonrr #
{ss 
gettt 
=>tt 
_adjustmentReasontt  
;tt  !
setuu 
=>uu 
SetPropertyuu 
(uu 
refuu 
_adjustmentReasonuu 0
,uu0 1
valueuu2 7
)uu7 8
;uu8 9
}vv 
publicxx 

stringxx 
?xx 
Errorxx 
{yy 
getzz 
=>zz 
_errorzz 
;zz 
private{{ 
set{{ 
{|| 	
if}} 
(}} 
SetProperty}} 
(}} 
ref}} 
_error}}  &
,}}& '
value}}( -
)}}- .
)}}. /
{~~ 
OnPropertyChanged !
(! "
nameof" (
(( )
HasError) 1
)1 2
)2 3
;3 4
}
€€ 
}
 	
}
‚‚ 
public
„„ 

bool
„„ 
HasError
„„ 
=>
„„ 
!
„„ 
string
„„ #
.
„„# $ 
IsNullOrWhiteSpace
„„$ 6
(
„„6 7
Error
„„7 <
)
„„< =
;
„„= >
public
†† 

AsyncRelayCommand
†† 
LoadTicketCommand
†† .
{
††/ 0
get
††1 4
;
††4 5
}
††6 7
public
‡‡ 

AsyncRelayCommand
‡‡ '
SetServiceChargeUiCommand
‡‡ 6
{
‡‡7 8
get
‡‡9 <
;
‡‡< =
}
‡‡> ?
public
ˆˆ 

AsyncRelayCommand
ˆˆ (
SetDeliveryChargeUiCommand
ˆˆ 7
{
ˆˆ8 9
get
ˆˆ: =
;
ˆˆ= >
}
ˆˆ? @
public
‰‰ 

AsyncRelayCommand
‰‰ $
SetAdjustmentUiCommand
‰‰ 3
{
‰‰4 5
get
‰‰6 9
;
‰‰9 :
}
‰‰; <
public
ŠŠ 

AsyncRelayCommand
ŠŠ !
SetAdvanceUiCommand
ŠŠ 0
{
ŠŠ1 2
get
ŠŠ3 6
;
ŠŠ6 7
}
ŠŠ8 9
private
ŒŒ 
async
ŒŒ 
Task
ŒŒ 
LoadTicketAsync
ŒŒ &
(
ŒŒ& '
)
ŒŒ' (
{
 
Error
ŽŽ 
=
ŽŽ 
null
ŽŽ 
;
ŽŽ 
IsBusy
 
=
 
true
 
;
 
try
 
{
‘‘ 	
if
’’ 
(
’’ 
!
’’ 
Guid
’’ 
.
’’ 
TryParse
’’ 
(
’’ 
TicketIdText
’’ +
,
’’+ ,
out
’’- 0
var
’’1 4
ticketId
’’5 =
)
’’= >
)
’’> ?
{
’’@ A
Error
’’B G
=
’’H I
$str
’’J ]
;
’’] ^
return
’’_ e
;
’’e f
}
’’g h
Ticket
”” 
=
”” 
await
”” 

_getTicket
”” %
.
””% &
HandleAsync
””& 1
(
””1 2
new
””2 5
GetTicketQuery
””6 D
{
””E F
TicketId
””G O
=
””P Q
ticketId
””R Z
}
””[ \
)
””\ ]
;
””] ^
if
•• 
(
•• 
Ticket
•• 
==
•• 
null
•• 
)
•• 
{
–– 
Error
—— 
=
—— 
$str
—— +
;
——+ ,
}
˜˜ 
}
™™ 	
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš 
{
›› 	
Error
œœ 
=
œœ 
ex
œœ 
.
œœ 
Message
œœ 
;
œœ 
}
 	
finally
žž 
{
ŸŸ 	
IsBusy
   
=
   
false
   
;
   
}
¡¡ 	
}
¢¢ 
private
¤¤ 
async
¤¤ 
Task
¤¤ #
SetServiceChargeAsync
¤¤ ,
(
¤¤, -
)
¤¤- .
{
¥¥ 
await
¦¦ 
SetMoneyAsync
¦¦ 
(
¦¦ 
ServiceChargeText
¦¦ -
,
¦¦- .
async
¦¦/ 4
money
¦¦5 :
=>
¦¦; =
{
§§ 	
var
¨¨ 
result
¨¨ 
=
¨¨ 
await
¨¨ 
_setServiceCharge
¨¨ 0
.
¨¨0 1
HandleAsync
¨¨1 <
(
¨¨< =
new
¨¨= @%
SetServiceChargeCommand
¨¨A X
{
©© 
TicketId
ªª 
=
ªª 
RequireTicketId
ªª *
(
ªª* +
)
ªª+ ,
,
ªª, -
Amount
«« 
=
«« 
money
«« 
,
«« 
ProcessedBy
¬¬ 
=
¬¬ 
new
¬¬ !
UserId
¬¬" (
(
¬¬( ) 
RequireProcessedBy
¬¬) ;
(
¬¬; <
)
¬¬< =
)
¬¬= >
}
­­ 
)
­­ 
;
­­ 
if
®® 
(
®® 
!
®® 
result
®® 
.
®® 
Success
®® 
)
®®  
throw
®®! &
new
®®' *
	Exception
®®+ 4
(
®®4 5
result
®®5 ;
.
®®; <
ErrorMessage
®®< H
)
®®H I
;
®®I J
}
¯¯ 	
)
¯¯	 

;
¯¯
 
}
°° 
private
²² 
async
²² 
Task
²² $
SetDeliveryChargeAsync
²² -
(
²²- .
)
²². /
{
³³ 
await
´´ 
SetMoneyAsync
´´ 
(
´´  
DeliveryChargeText
´´ .
,
´´. /
async
´´0 5
money
´´6 ;
=>
´´< >
{
µµ 	
var
¶¶ 
result
¶¶ 
=
¶¶ 
await
¶¶  
_setDeliveryCharge
¶¶ 1
.
¶¶1 2
HandleAsync
¶¶2 =
(
¶¶= >
new
¶¶> A&
SetDeliveryChargeCommand
¶¶B Z
{
·· 
TicketId
¸¸ 
=
¸¸ 
RequireTicketId
¸¸ *
(
¸¸* +
)
¸¸+ ,
,
¸¸, -
Amount
¹¹ 
=
¹¹ 
money
¹¹ 
,
¹¹ 
ProcessedBy
ºº 
=
ºº 
new
ºº !
UserId
ºº" (
(
ºº( ) 
RequireProcessedBy
ºº) ;
(
ºº; <
)
ºº< =
)
ºº= >
}
»» 
)
»» 
;
»» 
if
¼¼ 
(
¼¼ 
!
¼¼ 
result
¼¼ 
.
¼¼ 
Success
¼¼ 
)
¼¼  
throw
¼¼! &
new
¼¼' *
	Exception
¼¼+ 4
(
¼¼4 5
result
¼¼5 ;
.
¼¼; <
ErrorMessage
¼¼< H
)
¼¼H I
;
¼¼I J
}
½½ 	
)
½½	 

;
½½
 
}
¾¾ 
private
ÀÀ 
async
ÀÀ 
Task
ÀÀ  
SetAdjustmentAsync
ÀÀ )
(
ÀÀ) *
)
ÀÀ* +
{
ÁÁ 
await
ÂÂ 
SetMoneyAsync
ÂÂ 
(
ÂÂ 
AdjustmentText
ÂÂ *
,
ÂÂ* +
async
ÂÂ, 1
money
ÂÂ2 7
=>
ÂÂ8 :
{
ÃÃ 	
var
ÄÄ 
result
ÄÄ 
=
ÄÄ 
await
ÄÄ 
_setAdjustment
ÄÄ -
.
ÄÄ- .
HandleAsync
ÄÄ. 9
(
ÄÄ9 :
new
ÄÄ: ="
SetAdjustmentCommand
ÄÄ> R
{
ÅÅ 
TicketId
ÆÆ 
=
ÆÆ 
RequireTicketId
ÆÆ *
(
ÆÆ* +
)
ÆÆ+ ,
,
ÆÆ, -
Amount
ÇÇ 
=
ÇÇ 
money
ÇÇ 
,
ÇÇ 
ProcessedBy
ÈÈ 
=
ÈÈ 
new
ÈÈ !
UserId
ÈÈ" (
(
ÈÈ( ) 
RequireProcessedBy
ÈÈ) ;
(
ÈÈ; <
)
ÈÈ< =
)
ÈÈ= >
,
ÈÈ> ?
Reason
ÉÉ 
=
ÉÉ 
AdjustmentReason
ÉÉ )
}
ÊÊ 
)
ÊÊ 
;
ÊÊ 
if
ËË 
(
ËË 
!
ËË 
result
ËË 
.
ËË 
Success
ËË 
)
ËË  
throw
ËË! &
new
ËË' *
	Exception
ËË+ 4
(
ËË4 5
result
ËË5 ;
.
ËË; <
ErrorMessage
ËË< H
)
ËËH I
;
ËËI J
}
ÌÌ 	
)
ÌÌ	 

;
ÌÌ
 
}
ÍÍ 
private
ÏÏ 
async
ÏÏ 
Task
ÏÏ 
SetAdvanceAsync
ÏÏ &
(
ÏÏ& '
)
ÏÏ' (
{
ÐÐ 
await
ÑÑ 
SetMoneyAsync
ÑÑ 
(
ÑÑ 
AdvanceText
ÑÑ '
,
ÑÑ' (
async
ÑÑ) .
money
ÑÑ/ 4
=>
ÑÑ5 7
{
ÒÒ 	
var
ÓÓ 
result
ÓÓ 
=
ÓÓ 
await
ÓÓ 
_setAdvance
ÓÓ *
.
ÓÓ* +
HandleAsync
ÓÓ+ 6
(
ÓÓ6 7
new
ÓÓ7 :&
SetAdvancePaymentCommand
ÓÓ; S
{
ÔÔ 
TicketId
ÕÕ 
=
ÕÕ 
RequireTicketId
ÕÕ *
(
ÕÕ* +
)
ÕÕ+ ,
,
ÕÕ, -
Amount
ÖÖ 
=
ÖÖ 
money
ÖÖ 
,
ÖÖ 
ProcessedBy
×× 
=
×× 
new
×× !
UserId
××" (
(
××( ) 
RequireProcessedBy
××) ;
(
××; <
)
××< =
)
××= >
}
ØØ 
)
ØØ 
;
ØØ 
if
ÙÙ 
(
ÙÙ 
!
ÙÙ 
result
ÙÙ 
.
ÙÙ 
Success
ÙÙ 
)
ÙÙ  
throw
ÙÙ! &
new
ÙÙ' *
	Exception
ÙÙ+ 4
(
ÙÙ4 5
result
ÙÙ5 ;
.
ÙÙ; <
ErrorMessage
ÙÙ< H
)
ÙÙH I
;
ÙÙI J
}
ÚÚ 	
)
ÚÚ	 

;
ÚÚ
 
}
ÛÛ 
private
ÝÝ 
async
ÝÝ 
Task
ÝÝ 
SetMoneyAsync
ÝÝ $
(
ÝÝ$ %
string
ÝÝ% +

amountText
ÝÝ, 6
,
ÝÝ6 7
Func
ÝÝ8 <
<
ÝÝ< =
Money
ÝÝ= B
,
ÝÝB C
Task
ÝÝD H
>
ÝÝH I
action
ÝÝJ P
)
ÝÝP Q
{
ÞÞ 
Error
ßß 
=
ßß 
null
ßß 
;
ßß 
IsBusy
àà 
=
àà 
true
àà 
;
àà 
try
áá 
{
ââ 	
if
ãã 
(
ãã 
!
ãã 
decimal
ãã 
.
ãã 
TryParse
ãã !
(
ãã! "

amountText
ãã" ,
,
ãã, -
out
ãã. 1
var
ãã2 5
amount
ãã6 <
)
ãã< =
)
ãã= >
{
ãã? @
Error
ããA F
=
ããG H
$str
ããI Z
;
ããZ [
return
ãã\ b
;
ããb c
}
ããd e
await
ää 
action
ää 
(
ää 
new
ää 
Money
ää "
(
ää" #
amount
ää# )
)
ää) *
)
ää* +
;
ää+ ,
await
åå 
LoadTicketAsync
åå !
(
åå! "
)
åå" #
;
åå# $
}
ææ 	
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç 
{
èè 	
Error
éé 
=
éé 
ex
éé 
.
éé 
Message
éé 
;
éé 
}
êê 	
finally
ëë 
{
ìì 	
IsBusy
íí 
=
íí 
false
íí 
;
íí 
}
îî 	
}
ïï 
private
ññ 
Guid
ññ 
RequireTicketId
ññ  
(
ññ  !
)
ññ! "
{
òò 
if
óó 

(
óó 
Ticket
óó 
==
óó 
null
óó 
)
óó 
throw
óó !
new
óó" %
	Exception
óó& /
(
óó/ 0
$str
óó0 F
)
óóF G
;
óóG H
return
ôô 
Ticket
ôô 
.
ôô 
Id
ôô 
;
ôô 
}
õõ 
private
÷÷ 
Guid
÷÷  
RequireProcessedBy
÷÷ #
(
÷÷# $
)
÷÷$ %
{
øø 
if
ùù 

(
ùù 
!
ùù 
Guid
ùù 
.
ùù 
TryParse
ùù 
(
ùù 
ProcessedByText
ùù *
,
ùù* +
out
ùù, /
var
ùù0 3
userId
ùù4 :
)
ùù: ;
)
ùù; <
throw
ùù= B
new
ùùC F
	Exception
ùùG P
(
ùùP Q
$str
ùùQ g
)
ùùg h
;
ùùh i
return
úú 
userId
úú 
;
úú 
}
ûû 
}üü ½!
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\TableSelectionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
.* +
Dialogs+ 2
;2 3
public

 
partial

 
class

 #
TableSelectionViewModel

 ,
:

- .
ObservableObject

/ ?
{ 
private 
readonly 
ITableRepository %
_tableRepository& 6
;6 7
private  
ObservableCollection  
<  !
Table! &
>& '
_tables( /
=0 1
new2 5
(5 6
)6 7
;7 8
public 
 
ObservableCollection 
<  
Table  %
>% &
Tables' -
{ 
get 
=> 
_tables 
; 
set 
=> 
SetProperty 
( 
ref 
_tables &
,& '
value( -
)- .
;. /
} 
private 
Table 
? 
_selectedTable !
;! "
public 

Table 
? 
SelectedTable 
{ 
get 
=> 
_selectedTable 
; 
set 
=> 
SetProperty 
( 
ref 
_selectedTable -
,- .
value/ 4
)4 5
;5 6
} 
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

bool 
IsConfirmed 
{ 
get !
;! "
private# *
set+ .
;. /
}0 1
public 

ICommand 
ConfirmCommand "
{# $
get% (
;( )
}* +
public   

ICommand   
CancelCommand   !
{  " #
get  $ '
;  ' (
}  ) *
public"" 
#
TableSelectionViewModel"" "
(""" #
ITableRepository""# 3
tableRepository""4 C
)""C D
{## 
_tableRepository$$ 
=$$ 
tableRepository$$ *
;$$* +
ConfirmCommand%% 
=%% 
new%% 
RelayCommand%% )
(%%) *
Confirm%%* 1
)%%1 2
;%%2 3
CancelCommand&& 
=&& 
new&& 
RelayCommand&& (
(&&( )
Cancel&&) /
)&&/ 0
;&&0 1
}'' 
public)) 

async)) 
Task)) 
InitializeAsync)) %
())% &
)))& '
{** 
var++ 
activeTables++ 
=++ 
await++  
_tableRepository++! 1
.++1 2
GetActiveAsync++2 @
(++@ A
)++A B
;++B C
Tables,, 
=,, 
new,,  
ObservableCollection,, )
<,,) *
Table,,* /
>,,/ 0
(,,0 1
activeTables,,1 =
.,,= >
OrderBy,,> E
(,,E F
t,,F G
=>,,H J
t,,K L
.,,L M
TableNumber,,M X
),,X Y
),,Y Z
;,,Z [
}-- 
private// 
void// 
Confirm// 
(// 
)// 
{00 
if11 

(11 
SelectedTable11 
!=11 
null11 !
)11! "
{22 	
IsConfirmed33 
=33 
true33 
;33 
CloseAction44 
?44 
.44 
Invoke44 
(44  
)44  !
;44! "
}55 	
}66 
private88 
void88 
Cancel88 
(88 
)88 
{99 
IsConfirmed:: 
=:: 
false:: 
;:: 
CloseAction;; 
?;; 
.;; 
Invoke;; 
(;; 
);; 
;;; 
}<< 
}== ¨
rC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\SizeSelectionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
.* +
Dialogs+ 2
;2 3
public

 
class

 "
SizeSelectionViewModel

 #
:

$ %
ViewModelBase

& 3
{ 
private 
readonly 
ModifierGroup "

_sizeGroup# -
;- .
public 
 
ObservableCollection 
<  
MenuModifier  ,
>, -
Sizes. 3
{4 5
get6 9
;9 :
}; <
== >
new? B
(B C
)C D
;D E
private 
MenuModifier 
? 
_selectedSize '
;' (
public 

MenuModifier 
? 
SelectedSize %
{ 
get 
=> 
_selectedSize 
; 
set 
=> 
SetProperty 
( 
ref 
_selectedSize ,
,, -
value. 3
)3 4
;4 5
} 
public 

ICommand 
SelectSizeCommand %
{& '
get( +
;+ ,
}- .
public 

ICommand 
CancelCommand !
{" #
get$ '
;' (
}) *
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
"
SizeSelectionViewModel !
(! "
ModifierGroup" /
	sizeGroup0 9
)9 :
{ 

_sizeGroup 
= 
	sizeGroup 
; 
Title   
=   
$"   
$str   
{   
	sizeGroup   #
.  # $
Name  $ (
}  ( )
"  ) *
;  * +
foreach"" 
("" 
var"" 
modifier"" 
in""  
	sizeGroup""! *
.""* +
	Modifiers""+ 4
.""4 5
OrderBy""5 <
(""< =
m""= >
=>""? A
m""B C
.""C D
DisplayOrder""D P
)""P Q
)""Q R
{## 	
Sizes$$ 
.$$ 
Add$$ 
($$ 
modifier$$ 
)$$ 
;$$  
}%% 	
SelectSizeCommand'' 
='' 
new'' 
RelayCommand''  ,
<'', -
MenuModifier''- 9
>''9 :
('': ;

SelectSize''; E
)''E F
;''F G
CancelCommand(( 
=(( 
new(( 
RelayCommand(( (
(((( )
((() *
)((* +
=>((, .
CloseAction((/ :
?((: ;
.((; <
Invoke((< B
(((B C
)((C D
)((D E
;((E F
})) 
private++ 
void++ 

SelectSize++ 
(++ 
MenuModifier++ (
?++( )
size++* .
)++. /
{,, 
if-- 

(-- 
size-- 
==-- 
null-- 
)-- 
return--  
;--  !
SelectedSize.. 
=.. 
size.. 
;.. 
CloseAction// 
?// 
.// 
Invoke// 
(// 
)// 
;// 
}00 
}11 ŽU
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\ShiftStartViewModel.cs
	namespace

 	
Magidesk


 
.

 
Presentation

 
.

  

ViewModels

  *
;

* +
public 
sealed 
partial 
class 
ShiftStartViewModel /
:0 1
ViewModelBase2 ?
{ 
private 
readonly 
IShiftRepository %
_shiftRepository& 6
;6 7
private 
readonly 
ICommandHandler $
<$ %"
OpenCashSessionCommand% ;
,; <!
OpenCashSessionResult= R
>R S
_openSessionHandlerT g
;g h
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private  
ObservableCollection  
<  !
Shift! &
>& '
_availableShifts( 8
=9 :
new; >
(> ?
)? @
;@ A
public 
 
ObservableCollection 
<  
Shift  %
>% &
AvailableShifts' 6
{ 
get 
=> 
_availableShifts 
;  
set 
=> 
SetProperty 
( 
ref 
_availableShifts /
,/ 0
value1 6
)6 7
;7 8
} 
private 
Shift 
? 
_selectedShift !
;! "
public 

Shift 
? 
SelectedShift 
{ 
get 
=> 
_selectedShift 
; 
set 
{ 	
if   
(   
SetProperty   
(   
ref   
_selectedShift    .
,  . /
value  0 5
)  5 6
)  6 7
{!! 
ConfirmCommand"" 
."" #
NotifyCanExecuteChanged"" 6
(""6 7
)""7 8
;""8 9
}## 
}$$ 	
}%% 
private'' 
double'' 
_openingBalance'' "
;''" #
public(( 

double(( 
OpeningBalance((  
{)) 
get** 
=>** 
_openingBalance** 
;** 
set++ 
{,, 	
if-- 
(-- 
SetProperty-- 
(-- 
ref-- 
_openingBalance--  /
,--/ 0
value--1 6
)--6 7
)--7 8
{.. 
ConfirmCommand// 
.// #
NotifyCanExecuteChanged// 6
(//6 7
)//7 8
;//8 9
}00 
}11 	
}22 
private44 
bool44 
_isBusy44 
;44 
public55 

new55 
bool55 
IsBusy55 
{66 
get77 
=>77 
_isBusy77 
;77 
set88 
=>88 
SetProperty88 
(88 
ref88 
_isBusy88 &
,88& '
value88( -
)88- .
;88. /
}99 
public;; 

CommunityToolkit;; 
.;; 
Mvvm;;  
.;;  !
Input;;! &
.;;& '
IAsyncRelayCommand;;' 9
ConfirmCommand;;: H
{;;I J
get;;K N
;;;N O
};;P Q
public<< 

ICommand<< 
CancelCommand<< !
{<<" #
get<<$ '
;<<' (
}<<) *
public>> 

Action>> 
<>> 
ContentDialogResult>> %
>>>% &
?>>& '
CloseAction>>( 3
{>>4 5
get>>6 9
;>>9 :
set>>; >
;>>> ?
}>>@ A
public@@ 

ShiftStartViewModel@@ 
(@@ 
IShiftRepositoryAA 
shiftRepositoryAA (
,AA( )
ICommandHandlerBB 
<BB "
OpenCashSessionCommandBB .
,BB. /!
OpenCashSessionResultBB0 E
>BBE F
openSessionHandlerBBG Y
,BBY Z
IUserServiceCC 
userServiceCC  
,CC  !
ITerminalContextDD 
terminalContextDD (
)DD( )
{EE 
_shiftRepositoryFF 
=FF 
shiftRepositoryFF *
;FF* +
_openSessionHandlerGG 
=GG 
openSessionHandlerGG 0
;GG0 1
_userServiceHH 
=HH 
userServiceHH "
;HH" #
_terminalContextII 
=II 
terminalContextII *
;II* +
ConfirmCommandKK 
=KK 
newKK 
CommunityToolkitKK -
.KK- .
MvvmKK. 2
.KK2 3
InputKK3 8
.KK8 9
AsyncRelayCommandKK9 J
(KKJ K
ConfirmAsyncKKK W
,KKW X

CanConfirmKKY c
)KKc d
;KKd e
CancelCommandLL 
=LL 
newLL 
CommunityToolkitLL ,
.LL, -
MvvmLL- 1
.LL1 2
InputLL2 7
.LL7 8
RelayCommandLL8 D
(LLD E
CancelLLE K
)LLK L
;LLL M
}MM 
publicOO 

asyncOO 
TaskOO 
InitializeAsyncOO %
(OO% &
)OO& '
{PP 
IsBusyQQ 
=QQ 
trueQQ 
;QQ 
tryRR 
{SS 	
varTT 
shiftsTT 
=TT 
awaitTT 
_shiftRepositoryTT /
.TT/ 0 
GetActiveShiftsAsyncTT0 D
(TTD E
)TTE F
;TTF G
AvailableShiftsUU 
=UU 
newUU ! 
ObservableCollectionUU" 6
<UU6 7
ShiftUU7 <
>UU< =
(UU= >
shiftsUU> D
)UUD E
;UUE F
varXX 
currentShiftXX 
=XX 
awaitXX $
_shiftRepositoryXX% 5
.XX5 6 
GetCurrentShiftAsyncXX6 J
(XXJ K
)XXK L
;XXL M
ifYY 
(YY 
currentShiftYY 
!=YY 
nullYY  $
)YY$ %
{ZZ 
SelectedShift[[ 
=[[ 
AvailableShifts[[  /
.[[/ 0
FirstOrDefault[[0 >
([[> ?
s[[? @
=>[[A C
s[[D E
.[[E F
Id[[F H
==[[I K
currentShift[[L X
.[[X Y
Id[[Y [
)[[[ \
;[[\ ]
}\\ 
if^^ 
(^^ 
SelectedShift^^ 
==^^  
null^^! %
&&^^& (
AvailableShifts^^) 8
.^^8 9
Any^^9 <
(^^< =
)^^= >
)^^> ?
{__ 
SelectedShift`` 
=`` 
AvailableShifts``  /
.``/ 0
First``0 5
(``5 6
)``6 7
;``7 8
}aa 
}bb 	
catchcc 
(cc 
	Exceptioncc 
excc 
)cc 
{dd 	
Systemff 
.ff 
Diagnosticsff 
.ff 
Debugff $
.ff$ %
	WriteLineff% .
(ff. /
$"ff/ 1
$strff1 I
{ffI J
exffJ L
.ffL M
MessageffM T
}ffT U
"ffU V
)ffV W
;ffW X
}gg 	
finallyhh 
{ii 	
IsBusyjj 
=jj 
falsejj 
;jj 
}kk 	
}ll 
privatenn 
boolnn 

CanConfirmnn 
(nn 
)nn 
{oo 
returnpp 
SelectedShiftpp 
!=pp 
nullpp  $
&&pp% '
OpeningBalancepp( 6
>=pp7 9
$numpp: ;
;pp; <
}qq 
privatess 
asyncss 
Taskss 
ConfirmAsyncss #
(ss# $
)ss$ %
{tt 
ifuu 

(uu 
!uu 

CanConfirmuu 
(uu 
)uu 
)uu 
returnuu !
;uu! "
ifvv 

(vv 
_userServicevv 
.vv 
CurrentUservv $
==vv% '
nullvv( ,
||vv- /
_terminalContextvv0 @
.vv@ A

TerminalIdvvA K
==vvL N
nullvvO S
)vvS T
returnvvU [
;vv[ \
IsBusyxx 
=xx 
truexx 
;xx 
tryyy 
{zz 	
var{{ 
command{{ 
={{ 
new{{ "
OpenCashSessionCommand{{ 4
{|| 
UserId}} 
=}} 
new}} 
UserId}} #
(}}# $
_userService}}$ 0
.}}0 1
CurrentUser}}1 <
.}}< =
Id}}= ?
)}}? @
,}}@ A

TerminalId~~ 
=~~ 
_terminalContext~~ -
.~~- .

TerminalId~~. 8
.~~8 9
Value~~9 >
,~~> ?
ShiftId 
= 
SelectedShift '
!' (
.( )
Id) +
,+ ,
OpeningBalance
€€ 
=
€€  
new
€€! $
Money
€€% *
(
€€* +
(
€€+ ,
decimal
€€, 3
)
€€3 4
OpeningBalance
€€4 B
)
€€B C
}
 
;
 
await
ƒƒ !
_openSessionHandler
ƒƒ %
.
ƒƒ% &
HandleAsync
ƒƒ& 1
(
ƒƒ1 2
command
ƒƒ2 9
)
ƒƒ9 :
;
ƒƒ: ;
CloseAction
…… 
?
…… 
.
…… 
Invoke
…… 
(
……  !
ContentDialogResult
……  3
.
……3 4
Primary
……4 ;
)
……; <
;
……< =
}
†† 	
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡ 
{
ˆˆ 	
System
ŠŠ 
.
ŠŠ 
Diagnostics
ŠŠ 
.
ŠŠ 
Debug
ŠŠ $
.
ŠŠ$ %
	WriteLine
ŠŠ% .
(
ŠŠ. /
$"
ŠŠ/ 1
$str
ŠŠ1 I
{
ŠŠI J
ex
ŠŠJ L
.
ŠŠL M
Message
ŠŠM T
}
ŠŠT U
"
ŠŠU V
)
ŠŠV W
;
ŠŠW X
}
‹‹ 	
finally
ŒŒ 
{
 	
IsBusy
ŽŽ 
=
ŽŽ 
false
ŽŽ 
;
ŽŽ 
}
 	
}
 
private
’’ 
void
’’ 
Cancel
’’ 
(
’’ 
)
’’ 
{
““ 
CloseAction
”” 
?
”” 
.
”” 
Invoke
”” 
(
”” !
ContentDialogResult
”” /
.
””/ 0
	Secondary
””0 9
)
””9 :
;
””: ;
}
•• 
}–– ¬*
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\ShiftEndViewModel.cs
	namespace

 	
Magidesk


 
.

 
Presentation

 
.

  

ViewModels

  *
.

* +
Dialogs

+ 2
;

2 3
public 
partial 
class 
ShiftEndViewModel &
:' (
ViewModelBase) 6
{ 
private 
readonly 
ICommandHandler $
<$ %#
CloseCashSessionCommand% <
,< ="
CloseCashSessionResult> T
>T U 
_closeSessionHandlerV j
;j k
private 
readonly 
CashSession  
_session! )
;) *
private 
readonly 
UserId 
	_closedBy %
;% &
public 

ShiftEndViewModel 
( 
CashSession 
session 
, 
UserId 
closedBy 
, 
ICommandHandler 
< #
CloseCashSessionCommand /
,/ 0"
CloseCashSessionResult1 G
>G H
closeSessionHandlerI \
)\ ]
{ 
_session 
= 
session 
; 
	_closedBy 
= 
closedBy 
;  
_closeSessionHandler 
= 
closeSessionHandler 2
;2 3
_expectedCash 
= 
session 
.  
ExpectedCash  ,
., -
Amount- 3
;3 4
} 
private 
decimal 
_expectedCash !
;! "
public 

decimal 
ExpectedCash 
{   
get!! 
=>!! 
_expectedCash!! 
;!! 
set"" 
=>"" 
SetProperty"" 
("" 
ref"" 
_expectedCash"" ,
,"", -
value"". 3
)""3 4
;""4 5
}## 
private%% 
decimal%% 
_closingCash%%  
;%%  !
public&& 

decimal&& 
ClosingCash&& 
{'' 
get(( 
=>(( 
_closingCash(( 
;(( 
set)) 
=>)) 
SetProperty)) 
()) 
ref)) 
_closingCash)) +
,))+ ,
value))- 2
)))2 3
;))3 4
}** 
private,, 
double,, !
_closingBalanceDouble,, (
;,,( )
public-- 

double--  
ClosingBalanceDouble-- &
{.. 
get// 
=>// !
_closingBalanceDouble// $
;//$ %
set00 
=>00 
SetProperty00 
(00 
ref00 !
_closingBalanceDouble00 4
,004 5
value006 ;
)00; <
;00< =
}11 
public33 

Action33 
?33 
CloseAction33 
{33  
get33! $
;33$ %
set33& )
;33) *
}33+ ,
public44 

bool44 
IsConfirmed44 
{44 
get44 !
;44! "
private44# *
set44+ .
;44. /
}440 1
[66 
RelayCommand66 
]66 
private77 
async77 
Task77 
ConfirmAsync77 #
(77# $
)77$ %
{88 
IsBusy99 
=99 
true99 
;99 
try:: 
{;; 	
var<< 
command<< 
=<< 
new<< #
CloseCashSessionCommand<< 5
{== 
CashSessionId>> 
=>> 
_session>>  (
.>>( )
Id>>) +
,>>+ ,
ClosedBy?? 
=?? 
	_closedBy?? $
,??$ %

ActualCash@@ 
=@@ 
new@@  
Money@@! &
(@@& '
(@@' (
decimal@@( /
)@@/ 0!
_closingBalanceDouble@@0 E
)@@E F
}AA 
;AA 
awaitCC  
_closeSessionHandlerCC &
.CC& '
HandleAsyncCC' 2
(CC2 3
commandCC3 :
)CC: ;
;CC; <
IsConfirmedDD 
=DD 
trueDD 
;DD 
CloseActionEE 
?EE 
.EE 
InvokeEE 
(EE  
)EE  !
;EE! "
}FF 	
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG 
{HH 	
SystemJJ 
.JJ 
DiagnosticsJJ 
.JJ 
DebugJJ $
.JJ$ %
	WriteLineJJ% .
(JJ. /
$"JJ/ 1
$strJJ1 H
{JJH I
exJJI K
.JJK L
MessageJJL S
}JJS T
"JJT U
)JJU V
;JJV W
}KK 	
finallyLL 
{MM 	
IsBusyNN 
=NN 
falseNN 
;NN 
}OO 	
}PP 
[RR 
RelayCommandRR 
]RR 
privateSS 
voidSS 
CancelSS 
(SS 
)SS 
{TT 
CloseActionUU 
?UU 
.UU 
InvokeUU 
(UU 
)UU 
;UU 
}VV 
}WW ’
rC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\SeatSelectionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
.* +
Dialogs+ 2
;2 3
public 
partial 
class "
SeatSelectionViewModel +
:, -
ViewModelBase. ;
{ 
private 
string 
_input 
= 
$str 
; 
public		 

string		 
Input		 
{

 
get 
=> 
_input 
; 
set 
=> 
SetProperty 
( 
ref 
_input %
,% &
value' ,
), -
;- .
} 
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

bool 
IsConfirmed 
{ 
get !
;! "
private# *
set+ .
;. /
}0 1
public 

int 
? 
ResultSeatNumber  
=>! #
int$ '
.' (
TryParse( 0
(0 1
Input1 6
,6 7
out8 ;
int< ?
val@ C
)C D
?E F
valG J
:K L
nullM Q
;Q R
[ 
RelayCommand 
] 
private 
void 
Append 
( 
string 
value $
)$ %
{ 
if 

( 
Input 
. 
Length 
< 
$num 
) 
{ 	
Input 
+= 
value 
; 
} 	
} 
[ 
RelayCommand 
] 
private 
void 
Clear 
( 
) 
{ 
Input   
=   
$str   
;   
}!! 
[## 
RelayCommand## 
]## 
private$$ 
void$$ 
Confirm$$ 
($$ 
)$$ 
{%% 
if&& 

(&& 
!&& 
string&& 
.&& 
IsNullOrEmpty&& !
(&&! "
Input&&" '
)&&' (
)&&( )
{'' 	
IsConfirmed(( 
=(( 
true(( 
;(( 
CloseAction)) 
?)) 
.)) 
Invoke)) 
())  
)))  !
;))! "
}** 	
}++ 
[-- 
RelayCommand-- 
]-- 
private.. 
void.. 
Cancel.. 
(.. 
).. 
{// 
IsConfirmed00 
=00 
false00 
;00 
CloseAction11 
?11 
.11 
Invoke11 
(11 
)11 
;11 
}22 
}33 Ù*
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\PriceEntryViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
.* +
Dialogs+ 2
;2 3
public 
class 
PriceEntryViewModel  
:! "
ViewModelBase# 0
{ 
private		 
decimal		 
_price		 
;		 
public

 

decimal

 
Price

 
{ 
get 
=> 
_price 
; 
set 
=> 
SetProperty 
( 
ref 
_price %
,% &
value' ,
), -
;- .
} 
public 

string 
ItemName 
{ 
get  
;  !
}" #
public 

ICommand 
ConfirmCommand "
{# $
get% (
;( )
}* +
public 

ICommand 
CancelCommand !
{" #
get$ '
;' (
}) *
public 

ICommand 
AppendDigitCommand &
{' (
get) ,
;, -
}. /
public 

ICommand 
ClearCommand  
{! "
get# &
;& '
}( )
public 

ICommand 
BackspaceCommand $
{% &
get' *
;* +
}, -
public 

System 
. 
Action 
? 
CloseAction %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

System 
. 
Action 
? 
CancelAction &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 

bool 
IsConfirmed 
{ 
get !
;! "
private# *
set+ .
;. /
}0 1
public 

PriceEntryViewModel 
( 
string %
itemName& .
,. /
decimal0 7
initialPrice8 D
=E F
$numG H
)H I
{   
Title!! 
=!! 
$str!! 
;!! 
ItemName"" 
="" 
itemName"" 
;"" 
Price## 
=## 
initialPrice## 
;## 
ConfirmCommand%% 
=%% 
new%% 
RelayCommand%% )
(%%) *
(%%* +
)%%+ ,
=>%%- /
{%%0 1
IsConfirmed%%2 =
=%%> ?
true%%@ D
;%%D E
CloseAction%%F Q
?%%Q R
.%%R S
Invoke%%S Y
(%%Y Z
)%%Z [
;%%[ \
}%%] ^
)%%^ _
;%%_ `
CancelCommand&& 
=&& 
new&& 
RelayCommand&& (
(&&( )
(&&) *
)&&* +
=>&&, .
{&&/ 0
IsConfirmed&&1 <
=&&= >
false&&? D
;&&D E
CancelAction&&F R
?&&R S
.&&S T
Invoke&&T Z
(&&Z [
)&&[ \
;&&\ ]
}&&^ _
)&&_ `
;&&` a
AppendDigitCommand(( 
=(( 
new((  
RelayCommand((! -
<((- .
string((. 4
>((4 5
(((5 6
AppendDigit((6 A
)((A B
;((B C
ClearCommand)) 
=)) 
new)) 
RelayCommand)) '
())' (
())( )
)))) *
=>))+ -
Price)). 3
=))4 5
$num))6 7
)))7 8
;))8 9
BackspaceCommand** 
=** 
new** 
RelayCommand** +
(**+ ,
	Backspace**, 5
)**5 6
;**6 7
}++ 
private-- 
void-- 
AppendDigit-- 
(-- 
string-- #
digit--$ )
)--) *
{.. 
longDD 
centsDD 
=DD 
(DD 
longDD 
)DD 
(DD 
PriceDD !
*DD" #
$numDD$ '
)DD' (
;DD( )
ifEE 

(EE 
longEE 
.EE 
TryParseEE 
(EE 
digitEE 
,EE  
outEE! $
varEE% (
dEE) *
)EE* +
)EE+ ,
{FF 	
centsGG 
=GG 
(GG 
centsGG 
*GG 
$numGG  
)GG  !
+GG" #
dGG$ %
;GG% &
PriceHH 
=HH 
centsHH 
/HH 
$numHH !
;HH! "
}II 	
}JJ 
privateLL 
voidLL 
	BackspaceLL 
(LL 
)LL 
{MM 
longNN 
centsNN 
=NN 
(NN 
longNN 
)NN 
(NN 
PriceNN !
*NN" #
$numNN$ '
)NN' (
;NN( )
centsOO 
=OO 
centsOO 
/OO 
$numOO 
;OO 
PricePP 
=PP 
centsPP 
/PP 
$numPP 
;PP 
}QQ 
}RR ‘u
rC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\PizzaModifierViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
.		* +
Dialogs		+ 2
;		2 3
public 
enum 
PizzaSection 
{ 
None 
, 	
Whole 	
,	 

Left 
, 	
Right 	
} 
public 
class &
PizzaModifierItemViewModel '
:( )
ObservableObject* :
{ 
private 
PizzaSection 
_section !
=" #
PizzaSection$ 0
.0 1
None1 5
;5 6
public 

Guid 

ModifierId 
{ 
get  
;  !
}" #
public 

string 
Name 
{ 
get 
; 
} 
public 

decimal 
Price 
{ 
get 
; 
}  !
public 

decimal 
TaxRate 
{ 
get  
;  !
}" #
public 

PizzaSection 
Section 
{ 
get 
=> 
_section 
; 
set 
{   	
if!! 
(!! 
SetProperty!! 
(!! 
ref!! 
_section!!  (
,!!( )
value!!* /
)!!/ 0
)!!0 1
{"" 
OnPropertyChanged## !
(##! "
nameof##" (
(##( )
IsWhole##) 0
)##0 1
)##1 2
;##2 3
OnPropertyChanged$$ !
($$! "
nameof$$" (
($$( )
IsLeft$$) /
)$$/ 0
)$$0 1
;$$1 2
OnPropertyChanged%% !
(%%! "
nameof%%" (
(%%( )
IsRight%%) 0
)%%0 1
)%%1 2
;%%2 3
}&& 
}'' 	
}(( 
public** 

bool** 
IsWhole** 
{++ 
get,, 
=>,, 
Section,, 
==,, 
PizzaSection,, &
.,,& '
Whole,,' ,
;,,, -
set-- 
{-- 
if-- 
(-- 
value-- 
)-- 
Section--  
=--! "
PizzaSection--# /
.--/ 0
Whole--0 5
;--5 6
else--7 ;
if--< >
(--? @
Section--@ G
==--H J
PizzaSection--K W
.--W X
Whole--X ]
)--] ^
Section--_ f
=--g h
PizzaSection--i u
.--u v
None--v z
;--z {
}--| }
}.. 
public00 

bool00 
IsLeft00 
{11 
get22 
=>22 
Section22 
==22 
PizzaSection22 &
.22& '
Left22' +
;22+ ,
set33 
{33 
if33 
(33 
value33 
)33 
Section33  
=33! "
PizzaSection33# /
.33/ 0
Left330 4
;334 5
else336 :
if33; =
(33> ?
Section33? F
==33G I
PizzaSection33J V
.33V W
Left33W [
)33[ \
Section33] d
=33e f
PizzaSection33g s
.33s t
None33t x
;33x y
}33z {
}44 
public66 

bool66 
IsRight66 
{77 
get88 
=>88 
Section88 
==88 
PizzaSection88 &
.88& '
Right88' ,
;88, -
set99 
{99 
if99 
(99 
value99 
)99 
Section99  
=99! "
PizzaSection99# /
.99/ 0
Right990 5
;995 6
else997 ;
if99< >
(99? @
Section99@ G
==99H J
PizzaSection99K W
.99W X
Right99X ]
)99] ^
Section99_ f
=99g h
PizzaSection99i u
.99u v
None99v z
;99z {
}99| }
}:: 
public<< 
&
PizzaModifierItemViewModel<< %
(<<% &
Guid<<& *

modifierId<<+ 5
,<<5 6
string<<7 =
name<<> B
,<<B C
decimal<<D K
price<<L Q
,<<Q R
decimal<<S Z
taxRate<<[ b
)<<b c
{== 

ModifierId>> 
=>> 

modifierId>> 
;>>  
Name?? 
=?? 
name?? 
;?? 
Price@@ 
=@@ 
price@@ 
;@@ 
TaxRateAA 
=AA 
taxRateAA 
;AA 
}BB 
}CC 
publicEE 
classEE '
PizzaModifierGroupViewModelEE (
:EE) *
ObservableObjectEE+ ;
{FF 
publicGG 

stringGG 
NameGG 
{GG 
getGG 
;GG 
}GG 
publicHH 
 
ObservableCollectionHH 
<HH  &
PizzaModifierItemViewModelHH  :
>HH: ;
	ModifiersHH< E
{HHF G
getHHH K
;HHK L
}HHM N
=HHO P
newHHQ T
(HHT U
)HHU V
;HHV W
publicJJ 
'
PizzaModifierGroupViewModelJJ &
(JJ& '
stringJJ' -
nameJJ. 2
)JJ2 3
{KK 
NameLL 
=LL 
nameLL 
;LL 
}MM 
}NN 
publicPP 
partialPP 
classPP "
PizzaModifierViewModelPP +
:PP, -
ObservableObjectPP. >
{QQ 
privateRR 
readonlyRR 
IMenuRepositoryRR $
_menuRepositoryRR% 4
;RR4 5
privateSS 
readonlySS 
OrderLineDtoSS !

_orderLineSS" ,
;SS, -
privateUU 
boolUU 
_isBusyUU 
;UU 
publicVV 

boolVV 
IsBusyVV 
{WW 
getXX 
=>XX 
_isBusyXX 
;XX 
setYY 
=>YY 
SetPropertyYY 
(YY 
refYY 
_isBusyYY &
,YY& '
valueYY( -
)YY- .
;YY. /
}ZZ 
public\\ 
 
ObservableCollection\\ 
<\\  '
PizzaModifierGroupViewModel\\  ;
>\\; <
Groups\\= C
{\\D E
get\\F I
;\\I J
}\\K L
=\\M N
new\\O R
(\\R S
)\\S T
;\\T U
public^^ 

bool^^ 
IsConfirmed^^ 
{^^ 
get^^ !
;^^! "
private^^# *
set^^+ .
;^^. /
}^^0 1
public__ 

List__ 
<__  
OrderLineModifierDto__ $
>__$ %
ResultModifiers__& 5
{__6 7
get__8 ;
;__; <
private__= D
set__E H
;__H I
}__J K
=__L M
new__N Q
(__Q R
)__R S
;__S T
publicaa 

ICommandaa 
ConfirmCommandaa "
{aa# $
getaa% (
;aa( )
}aa* +
publicbb 

ICommandbb 
CancelCommandbb !
{bb" #
getbb$ '
;bb' (
}bb) *
publiccc 

Actioncc 
?cc 
CloseActioncc 
{cc  
getcc! $
;cc$ %
setcc& )
;cc) *
}cc+ ,
publicee 
"
PizzaModifierViewModelee !
(ee! "
IMenuRepositoryee" 1
menuRepositoryee2 @
,ee@ A
OrderLineDtoeeB N
	orderLineeeO X
)eeX Y
{ff 
_menuRepositorygg 
=gg 
menuRepositorygg (
;gg( )

_orderLinehh 
=hh 
	orderLinehh 
;hh 
ConfirmCommandjj 
=jj 
newjj 
RelayCommandjj )
(jj) *
Confirmjj* 1
)jj1 2
;jj2 3
CancelCommandkk 
=kk 
newkk 
RelayCommandkk (
(kk( )
Cancelkk) /
)kk/ 0
;kk0 1
}ll 
publicnn 

asyncnn 
Tasknn 
InitializeAsyncnn %
(nn% &
)nn& '
{oo 
IsBusypp 
=pp 
truepp 
;pp 
tryqq 
{rr 	
varss 
menuItemss 
=ss 
awaitss  
_menuRepositoryss! 0
.ss0 1
GetByIdAsyncss1 =
(ss= >

_orderLiness> H
.ssH I

MenuItemIdssI S
)ssS T
;ssT U
iftt 
(tt 
menuItemtt 
!=tt 
nulltt  
)tt  !
{uu 
foreachvv 
(vv 
varvv !
menuItemModifierGroupvv 2
invv3 5
menuItemvv6 >
.vv> ?
ModifierGroupsvv? M
)vvM N
{ww 
varxx 
groupVmxx 
=xx  !
newxx" %'
PizzaModifierGroupViewModelxx& A
(xxA B!
menuItemModifierGroupxxB W
.xxW X
ModifierGroupxxX e
?xxe f
.xxf g
Namexxg k
??xxl n
$strxxo z
)xxz {
;xx{ |
ifzz 
(zz !
menuItemModifierGroupzz -
.zz- .
ModifierGroupzz. ;
!=zz< >
nullzz? C
)zzC D
{{{ 
foreach|| 
(||  !
var||! $
modifier||% -
in||. 0!
menuItemModifierGroup||1 F
.||F G
ModifierGroup||G T
.||T U
	Modifiers||U ^
)||^ _
{}} 
var~~ 
modVm~~  %
=~~& '
new~~( +&
PizzaModifierItemViewModel~~, F
(~~F G
modifier  (
.( )
Id) +
,+ ,
modifier
€€  (
.
€€( )
Name
€€) -
,
€€- .
modifier
  (
.
( )
	BasePrice
) 2
.
2 3
Amount
3 9
,
9 :
$num
‚‚  !
)
ƒƒ 
;
ƒƒ 
var
†† 
existing
††  (
=
††) *

_orderLine
††+ 5
.
††5 6
	Modifiers
††6 ?
.
††? @
FirstOrDefault
††@ N
(
††N O
m
††O P
=>
††Q S
m
††T U
.
††U V

ModifierId
††V `
==
††a c
modifier
††d l
.
††l m
Id
††m o
)
††o p
;
††p q
if
‡‡ 
(
‡‡  
existing
‡‡  (
!=
‡‡) +
null
‡‡, 0
)
‡‡0 1
{
ˆˆ 
if
‰‰  "
(
‰‰# $
existing
‰‰$ ,
.
‰‰, -
SectionName
‰‰- 8
==
‰‰9 ;
$str
‰‰< B
)
‰‰B C
modVm
‰‰D I
.
‰‰I J
IsLeft
‰‰J P
=
‰‰Q R
true
‰‰S W
;
‰‰W X
else
ŠŠ  $
if
ŠŠ% '
(
ŠŠ( )
existing
ŠŠ) 1
.
ŠŠ1 2
SectionName
ŠŠ2 =
==
ŠŠ> @
$str
ŠŠA H
)
ŠŠH I
modVm
ŠŠJ O
.
ŠŠO P
IsRight
ŠŠP W
=
ŠŠX Y
true
ŠŠZ ^
;
ŠŠ^ _
else
‹‹  $
modVm
‹‹% *
.
‹‹* +
IsWhole
‹‹+ 2
=
‹‹3 4
true
‹‹5 9
;
‹‹9 :
}
ŒŒ 
groupVm
ŽŽ #
.
ŽŽ# $
	Modifiers
ŽŽ$ -
.
ŽŽ- .
Add
ŽŽ. 1
(
ŽŽ1 2
modVm
ŽŽ2 7
)
ŽŽ7 8
;
ŽŽ8 9
}
 
}
 
if
’’ 
(
’’ 
groupVm
’’ 
.
’’  
	Modifiers
’’  )
.
’’) *
Any
’’* -
(
’’- .
)
’’. /
)
’’/ 0
{
““ 
Groups
”” 
.
”” 
Add
”” "
(
””" #
groupVm
””# *
)
””* +
;
””+ ,
}
•• 
}
–– 
}
—— 
}
˜˜ 	
finally
™™ 
{
šš 	
IsBusy
›› 
=
›› 
false
›› 
;
›› 
}
œœ 	
}
 
private
ŸŸ 
void
ŸŸ 
Confirm
ŸŸ 
(
ŸŸ 
)
ŸŸ 
{
   
ResultModifiers
¡¡ 
.
¡¡ 
Clear
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡  
foreach
££ 
(
££ 
var
££ 
group
££ 
in
££ 
Groups
££ $
)
££$ %
{
¤¤ 	
foreach
¥¥ 
(
¥¥ 
var
¥¥ 
mod
¥¥ 
in
¥¥ 
group
¥¥  %
.
¥¥% &
	Modifiers
¥¥& /
)
¥¥/ 0
{
¦¦ 
if
§§ 
(
§§ 
mod
§§ 
.
§§ 
Section
§§ 
!=
§§  "
PizzaSection
§§# /
.
§§/ 0
None
§§0 4
)
§§4 5
{
¨¨ 
ResultModifiers
©© #
.
©©# $
Add
©©$ '
(
©©' (
new
©©( +"
OrderLineModifierDto
©©, @
{
ªª 

ModifierId
«« "
=
««# $
mod
««% (
.
««( )

ModifierId
««) 3
,
««3 4
Name
¬¬ 
=
¬¬ 
mod
¬¬ "
.
¬¬" #
Name
¬¬# '
,
¬¬' (
ModifierType
­­ $
=
­­% &
ModifierType
­­' 3
.
­­3 4
Normal
­­4 :
,
­­: ;
	ItemCount
®® !
=
®®" #
$num
®®$ %
,
®®% &
	UnitPrice
¯¯ !
=
¯¯" #
mod
¯¯$ '
.
¯¯' (
Price
¯¯( -
,
¯¯- .
SectionName
°° #
=
°°$ %
mod
°°& )
.
°°) *
Section
°°* 1
.
°°1 2
ToString
°°2 :
(
°°: ;
)
°°; <
,
°°< =
TaxRate
±± 
=
±±  !
mod
±±" %
.
±±% &
TaxRate
±±& -
,
±±- ."
ShouldPrintToKitchen
²² ,
=
²²- .
true
²²/ 3
}
³³ 
)
³³ 
;
³³ 
}
´´ 
}
µµ 
}
¶¶ 	
IsConfirmed
¸¸ 
=
¸¸ 
true
¸¸ 
;
¸¸ 
CloseAction
¹¹ 
?
¹¹ 
.
¹¹ 
Invoke
¹¹ 
(
¹¹ 
)
¹¹ 
;
¹¹ 
}
ºº 
private
¼¼ 
void
¼¼ 
Cancel
¼¼ 
(
¼¼ 
)
¼¼ 
{
½½ 
IsConfirmed
¾¾ 
=
¾¾ 
false
¾¾ 
;
¾¾ 
CloseAction
¿¿ 
?
¿¿ 
.
¿¿ 
Invoke
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿ 
}
ÀÀ 
}ÁÁ ô/
pC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\NotesDialogViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
.* +
Dialogs+ 2
;2 3
public		 
class		  
NotesDialogViewModel		 !
:		" #
ViewModelBase		$ 1
{

 
private 
readonly 
ICommandHandler $
<$ %#
UpdateTicketNoteCommand% <
>< =$
_updateTicketNoteHandler> V
;V W
private 
readonly 
ICommandHandler $
<$ %-
!UpdateOrderLineInstructionCommand% F
>F G%
_updateInstructionHandlerH a
;a b
private 
string 
? 
_note 
; 
public 

string 
? 
Note 
{ 
get 
=> 
_note 
; 
set 
=> 
SetProperty 
( 
ref 
_note $
,$ %
value& +
)+ ,
;, -
} 
private 
Guid 
? 
	_ticketId 
; 
private 
Guid 
? 
_orderLineId 
; 
public 

RelayCommand 
SaveCommand #
{$ %
get& )
;) *
}+ ,
public 

RelayCommand 
CancelCommand %
{& '
get( +
;+ ,
}- .
public 

event 
EventHandler 
? 
RequestClose +
;+ ,
public 
 
NotesDialogViewModel 
(  
ICommandHandler 
< #
UpdateTicketNoteCommand /
>/ 0#
updateTicketNoteHandler1 H
,H I
ICommandHandler   
<   -
!UpdateOrderLineInstructionCommand   9
>  9 :$
updateInstructionHandler  ; S
)  S T
{!! $
_updateTicketNoteHandler""  
=""! "#
updateTicketNoteHandler""# :
;"": ;%
_updateInstructionHandler## !
=##" #$
updateInstructionHandler##$ <
;##< =
SaveCommand%% 
=%% 
new%% 
RelayCommand%% &
(%%& '
Save%%' +
)%%+ ,
;%%, -
CancelCommand&& 
=&& 
new&& 
RelayCommand&& (
(&&( )
Cancel&&) /
)&&/ 0
;&&0 1
}'' 
public)) 

void)) 
InitializeForTicket)) #
())# $
Guid))$ (
ticketId))) 1
,))1 2
string))3 9
?))9 :
currentNote)); F
)))F G
{** 
	_ticketId++ 
=++ 
ticketId++ 
;++ 
_orderLineId,, 
=,, 
null,, 
;,, 
Note-- 
=-- 
currentNote-- 
;-- 
Title.. 
=.. 
$str.. "
;.." #
}// 
public11 

void11 "
InitializeForOrderLine11 &
(11& '
Guid11' +
ticketId11, 4
,114 5
Guid116 :
orderLineId11; F
,11F G
string11H N
?11N O
currentInstruction11P b
)11b c
{22 
	_ticketId33 
=33 
ticketId33 
;33 
_orderLineId44 
=44 
orderLineId44 "
;44" #
Note55 
=55 
currentInstruction55 !
;55! "
Title66 
=66 
$str66 (
;66( )
}77 
private99 
async99 
void99 
Save99 
(99 
)99 
{:: 
if;; 

(;; 
	_ticketId;; 
==;; 
null;; 
);; 
return;; %
;;;% &
try== 
{>> 	
IsBusy?? 
=?? 
true?? 
;?? 
ifAA 
(AA 
_orderLineIdAA 
.AA 
HasValueAA %
)AA% &
{BB 
varCC 
commandCC 
=CC 
newCC !-
!UpdateOrderLineInstructionCommandCC" C
(CCC D
	_ticketIdCCD M
.CCM N
ValueCCN S
,CCS T
_orderLineIdCCU a
.CCa b
ValueCCb g
,CCg h
NoteCCi m
)CCm n
;CCn o
awaitDD %
_updateInstructionHandlerDD /
.DD/ 0
HandleAsyncDD0 ;
(DD; <
commandDD< C
)DDC D
;DDD E
}EE 
elseFF 
{GG 
varHH 
commandHH 
=HH 
newHH !#
UpdateTicketNoteCommandHH" 9
(HH9 :
	_ticketIdHH: C
.HHC D
ValueHHD I
,HHI J
NoteHHK O
)HHO P
;HHP Q
awaitII $
_updateTicketNoteHandlerII .
.II. /
HandleAsyncII/ :
(II: ;
commandII; B
)IIB C
;IIC D
}JJ 
RequestCloseLL 
?LL 
.LL 
InvokeLL  
(LL  !
thisLL! %
,LL% &
	EventArgsLL' 0
.LL0 1
EmptyLL1 6
)LL6 7
;LL7 8
}MM 	
catchNN 
(NN 
	ExceptionNN 
)NN 
{OO 	
}RR 	
finallySS 
{TT 	
IsBusyUU 
=UU 
falseUU 
;UU 
}VV 	
}WW 
privateYY 
voidYY 
CancelYY 
(YY 
)YY 
{ZZ 
RequestClose[[ 
?[[ 
.[[ 
Invoke[[ 
([[ 
this[[ !
,[[! "
	EventArgs[[# ,
.[[, -
Empty[[- 2
)[[2 3
;[[3 4
}\\ 
}]] “M
vC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\ModifierSelectionViewModel.cs
	namespace		 	
Magidesk		
 
.		 

ViewModels		 
.		 
Dialogs		 %
;		% &
public 
partial 
class &
ModifierSelectionViewModel /
:0 1
ObservableObject2 B
{ 
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly 
OrderLineDto !

_orderLine" ,
;, -
private 
bool 
_isBusy 
; 
public 

bool 
IsBusy 
{ 
get 
=> 
_isBusy 
; 
set 
=> 
SetProperty 
( 
ref 
_isBusy &
,& '
value( -
)- .
;. /
} 
[ 
ObservableProperty 
] 
private 
string 
_menuItemName  
=! "
string# )
.) *
Empty* /
;/ 0
public 
 
ObservableCollection 
<  "
ModifierGroupViewModel  6
>6 7
Groups8 >
{? @
getA D
;D E
}F G
=H I
newJ M
(M N
)N O
;O P
public 

ICommand 
ConfirmCommand "
{# $
get% (
;( )
}* +
public 

ICommand 
CancelCommand !
{" #
get$ '
;' (
}) *
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public   

bool   
IsConfirmed   
{   
get   !
;  ! "
private  # *
set  + .
;  . /
}  0 1
public!! 

List!! 
<!!  
OrderLineModifierDto!! $
>!!$ %
ResultModifiers!!& 5
{!!6 7
get!!8 ;
;!!; <
private!!= D
set!!E H
;!!H I
}!!J K
=!!L M
new!!N Q
(!!Q R
)!!R S
;!!S T
public## 
&
ModifierSelectionViewModel## %
(##% &
IMenuRepository##& 5
menuRepository##6 D
,##D E
OrderLineDto##F R
	orderLine##S \
)##\ ]
{$$ 
_menuRepository%% 
=%% 
menuRepository%% (
;%%( )

_orderLine&& 
=&& 
	orderLine&& 
;&& 
_menuItemName'' 
='' 
	orderLine'' !
.''! "
MenuItemName''" .
;''. /
ConfirmCommand)) 
=)) 
new)) 
RelayCommand)) )
())) *
Confirm))* 1
)))1 2
;))2 3
CancelCommand** 
=** 
new** 
RelayCommand** (
(**( )
Cancel**) /
)**/ 0
;**0 1
}++ 
public-- 

async-- 
Task-- 
InitializeAsync-- %
(--% &
)--& '
{.. 
IsBusy// 
=// 
true// 
;// 
try00 
{11 	
var22 
menuItem22 
=22 
await22  
_menuRepository22! 0
.220 1
GetByIdAsync221 =
(22= >

_orderLine22> H
.22H I

MenuItemId22I S
)22S T
;22T U
if33 
(33 
menuItem33 
!=33 
null33  
)33  !
{44 
foreach55 
(55 
var55 !
menuItemModifierGroup55 2
in553 5
menuItem556 >
.55> ?
ModifierGroups55? M
.55M N
OrderBy55N U
(55U V
mg55V X
=>55Y [
mg55\ ^
.55^ _
DisplayOrder55_ k
)55k l
)55l m
{66 
if77 
(77 !
menuItemModifierGroup77 -
.77- .
ModifierGroup77. ;
==77< >
null77? C
)77C D
continue77E M
;77M N
var99 
groupVm99 
=99  !
new99" %"
ModifierGroupViewModel99& <
(99< =!
menuItemModifierGroup99= R
.99R S
ModifierGroup99S `
)99` a
;99a b
foreach;; 
(;; 
var;;  
modifier;;! )
in;;* ,!
menuItemModifierGroup;;- B
.;;B C
ModifierGroup;;C P
.;;P Q
	Modifiers;;Q Z
);;Z [
{<< 
var== 
modVm== !
===" #
new==$ '!
ModifierItemViewModel==( =
(=== >
modifier>> $
.>>$ %
Id>>% '
,>>' (
modifier?? $
.??$ %
Name??% )
,??) *
modifier@@ $
.@@$ %
	BasePrice@@% .
.@@. /
Amount@@/ 5
)AA 
;AA 
ifDD 
(DD 

_orderLineDD &
.DD& '
	ModifiersDD' 0
.DD0 1
AnyDD1 4
(DD4 5
mDD5 6
=>DD7 9
mDD: ;
.DD; <

ModifierIdDD< F
==DDG I
modifierDDJ R
.DDR S
IdDDS U
)DDU V
)DDV W
{EE 
modVmFF !
.FF! "

IsSelectedFF" ,
=FF- .
trueFF/ 3
;FF3 4
}GG 
modVmJJ 
.JJ 
PropertyChangedJJ -
+=JJ. 0
(JJ1 2
sJJ2 3
,JJ3 4
eJJ5 6
)JJ6 7
=>JJ8 :
{KK 
ifLL 
(LL  
eLL  !
.LL! "
PropertyNameLL" .
==LL/ 1
nameofLL2 8
(LL8 9!
ModifierItemViewModelLL9 N
.LLN O

IsSelectedLLO Y
)LLY Z
)LLZ [
{MM 
groupVmNN  '
.NN' (!
EnforceSelectionLogicNN( =
(NN= >
modVmNN> C
)NNC D
;NND E
(OO  !
(OO! "
RelayCommandOO" .
)OO. /
ConfirmCommandOO/ =
)OO= >
.OO> ?#
NotifyCanExecuteChangedOO? V
(OOV W
)OOW X
;OOX Y
}PP 
}QQ 
;QQ 
groupVmSS 
.SS  
	ModifiersSS  )
.SS) *
AddSS* -
(SS- .
modVmSS. 3
)SS3 4
;SS4 5
}TT 
ifVV 
(VV 
groupVmVV 
.VV  
	ModifiersVV  )
.VV) *
AnyVV* -
(VV- .
)VV. /
)VV/ 0
{WW 
GroupsXX 
.XX 
AddXX "
(XX" #
groupVmXX# *
)XX* +
;XX+ ,
}YY 
}ZZ 
}[[ 
}\\ 	
finally]] 
{^^ 	
IsBusy__ 
=__ 
false__ 
;__ 
}`` 	
}aa 
privatecc 
voidcc 
Confirmcc 
(cc 
)cc 
{dd 
ifee 

(ee 
!ee 

CanConfirmee 
(ee 
)ee 
)ee 
returnee !
;ee! "
ResultModifiersgg 
.gg 
Cleargg 
(gg 
)gg 
;gg  
foreachii 
(ii 
varii 
groupii 
inii 
Groupsii $
)ii$ %
{jj 	
foreachkk 
(kk 
varkk 
modkk 
inkk 
groupkk  %
.kk% &
	Modifierskk& /
)kk/ 0
{ll 
ifmm 
(mm 
modmm 
.mm 

IsSelectedmm "
)mm" #
{nn 
ResultModifiersoo #
.oo# $
Addoo$ '
(oo' (
newoo( + 
OrderLineModifierDtooo, @
{pp 

ModifierIdqq "
=qq# $
modqq% (
.qq( )

ModifierIdqq) 3
,qq3 4
Namerr 
=rr 
modrr "
.rr" #
Namerr# '
,rr' (
ModifierTypess $
=ss% &
ModifierTypess' 3
.ss3 4
Normalss4 :
,ss: ;
	ItemCounttt !
=tt" #
$numtt$ %
,tt% &
	UnitPriceuu !
=uu" #
moduu$ '
.uu' (
Priceuu( -
,uu- .
TaxRatevv 
=vv  !
$numvv" #
,vv# $ 
ShouldPrintToKitchenww ,
=ww- .
trueww/ 3
}xx 
)xx 
;xx 
}yy 
}zz 
}{{ 	
IsConfirmed}} 
=}} 
true}} 
;}} 
CloseAction~~ 
?~~ 
.~~ 
Invoke~~ 
(~~ 
)~~ 
;~~ 
} 
private
 
bool
 

CanConfirm
 
(
 
)
 
{
‚‚ 
return
ƒƒ 
Groups
ƒƒ 
.
ƒƒ 
All
ƒƒ 
(
ƒƒ 
g
ƒƒ 
=>
ƒƒ 
g
ƒƒ  
.
ƒƒ  !
Validate
ƒƒ! )
(
ƒƒ) *
)
ƒƒ* +
)
ƒƒ+ ,
;
ƒƒ, -
}
„„ 
private
†† 
void
†† 
Cancel
†† 
(
†† 
)
†† 
{
‡‡ 
IsConfirmed
ˆˆ 
=
ˆˆ 
false
ˆˆ 
;
ˆˆ 
CloseAction
‰‰ 
?
‰‰ 
.
‰‰ 
Invoke
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
}
ŠŠ 
}‹‹ ô

qC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\ModifierItemViewModel.cs
	namespace 	
Magidesk
 
. 

ViewModels 
. 
Dialogs %
;% &
public 
partial 
class !
ModifierItemViewModel *
:+ ,
ObservableObject- =
{ 
public 

Guid 

ModifierId 
{ 
get  
;  !
}" #
public		 

string		 
Name		 
{		 
get		 
;		 
}		 
public

 

decimal

 
Price

 
{

 
get

 
;

 
}

  !
[ 
ObservableProperty 
] 
private 
bool 
_isSelected 
; 
public 
!
ModifierItemViewModel  
(  !
Guid! %

modifierId& 0
,0 1
string2 8
name9 =
,= >
decimal? F
priceG L
)L M
{ 

ModifierId 
= 

modifierId 
;  
Name 
= 
name 
; 
Price 
= 
price 
; 
} 
} à
rC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\ModifierGroupViewModel.cs
	namespace 	
Magidesk
 
. 

ViewModels 
. 
Dialogs %
;% &
public 
partial 
class "
ModifierGroupViewModel +
:, -
ObservableObject. >
{ 
public		 

string		 
Name		 
{		 
get		 
;		 
}		 
public

 

bool

 

IsRequired

 
{

 
get

  
;

  !
}

" #
public 

int 
MinSelections 
{ 
get "
;" #
}$ %
public 

int 
MaxSelections 
{ 
get "
;" #
}$ %
public 

bool #
AllowMultipleSelections '
{( )
get* -
;- .
}/ 0
public 
 
ObservableCollection 
<  !
ModifierItemViewModel  5
>5 6
	Modifiers7 @
{A B
getC F
;F G
}H I
=J K
newL O
(O P
)P Q
;Q R
public 
"
ModifierGroupViewModel !
(! "
ModifierGroup" /
group0 5
)5 6
{ 
Name 
= 
group 
. 
Name 
; 

IsRequired 
= 
group 
. 

IsRequired %
;% &
MinSelections 
= 
group 
. 
MinSelections +
;+ ,
MaxSelections 
= 
group 
. 
MaxSelections +
;+ ,#
AllowMultipleSelections 
=  !
group" '
.' (#
AllowMultipleSelections( ?
;? @
} 
public 

bool 
Validate 
( 
) 
{ 
var 
selectedCount 
= 
	Modifiers %
.% &
Count& +
(+ ,
m, -
=>. 0
m1 2
.2 3

IsSelected3 =
)= >
;> ?
if 

( 

IsRequired 
&& 
selectedCount '
<( )
MinSelections* 7
)7 8
return9 ?
false@ E
;E F
if 

( 
selectedCount 
> 
MaxSelections )
)) *
return+ 1
false2 7
;7 8
return 
true 
; 
}   
public"" 

void"" !
EnforceSelectionLogic"" %
(""% &!
ModifierItemViewModel""& ;
changedItem""< G
)""G H
{## 
if$$ 

($$ 
changedItem$$ 
.$$ 

IsSelected$$ "
)$$" #
{%% 	
if'' 
('' 
MaxSelections'' 
==''  
$num''! "
)''" #
{(( 
foreach)) 
()) 
var)) 
mod))  
in))! #
	Modifiers))$ -
)))- .
{** 
if++ 
(++ 
mod++ 
!=++ 
changedItem++ *
&&+++ -
mod++. 1
.++1 2

IsSelected++2 <
)++< =
{,, 
mod-- 
.-- 

IsSelected-- &
=--' (
false--) .
;--. /
}.. 
}// 
}00 
}11 	
}22 
}33 „(
qC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\MergeTicketsViewModel.cs
	namespace

 	
Magidesk


 
.

 
Presentation

 
.

  

ViewModels

  *
.

* +
Dialogs

+ 2
;

2 3
public 
partial 
class !
MergeTicketsViewModel *
:+ ,
ViewModelBase- :
{ 
private 
readonly 
IQueryHandler "
<" #
GetOpenTicketsQuery# 6
,6 7
IEnumerable8 C
<C D
	TicketDtoD M
>M N
>N O"
_getOpenTicketsHandlerP f
;f g
private 
readonly 
Guid 
_sourceTicketId )
;) *
private  
ObservableCollection  
<  !
	TicketDto! *
>* +
_availableTickets, =
=> ?
new@ C
(C D
)D E
;E F
public 
 
ObservableCollection 
<  
	TicketDto  )
>) *
AvailableTickets+ ;
{ 
get 
=> 
_availableTickets  
;  !
set 
=> 
SetProperty 
( 
ref 
_availableTickets 0
,0 1
value2 7
)7 8
;8 9
} 
private 
	TicketDto 
? !
_selectedTargetTicket ,
;, -
public 

	TicketDto 
?  
SelectedTargetTicket *
{ 
get 
=> !
_selectedTargetTicket $
;$ %
set 
=> 
SetProperty 
( 
ref !
_selectedTargetTicket 4
,4 5
value6 ;
); <
;< =
} 
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public   

bool   
IsConfirmed   
{   
get   !
;  ! "
private  # *
set  + .
;  . /
}  0 1
public"" 
!
MergeTicketsViewModel""  
(""  !
IQueryHandler## 
<## 
GetOpenTicketsQuery## )
,##) *
IEnumerable##+ 6
<##6 7
	TicketDto##7 @
>##@ A
>##A B!
getOpenTicketsHandler##C X
,##X Y
Guid$$ 
sourceTicketId$$ 
)$$ 
{%% "
_getOpenTicketsHandler&& 
=&&  !
getOpenTicketsHandler&&! 6
;&&6 7
_sourceTicketId'' 
='' 
sourceTicketId'' (
;''( )
_(( 	
=((
 
LoadTicketsAsync(( 
((( 
)(( 
;(( 
})) 
private++ 
async++ 
Task++ 
LoadTicketsAsync++ '
(++' (
)++( )
{,, 
IsBusy-- 
=-- 
true-- 
;-- 
try.. 
{// 	
var00 
tickets00 
=00 
await00 "
_getOpenTicketsHandler00  6
.006 7
HandleAsync007 B
(00B C
new00C F
GetOpenTicketsQuery00G Z
(00Z [
)00[ \
)00\ ]
;00] ^
var33 
validTargets33 
=33 
tickets33 &
.33& '
Where33' ,
(33, -
t33- .
=>33/ 1
t332 3
.333 4
Id334 6
!=337 9
_sourceTicketId33: I
)33I J
.33J K
ToList33K Q
(33Q R
)33R S
;33S T
AvailableTickets55 
=55 
new55 " 
ObservableCollection55# 7
<557 8
	TicketDto558 A
>55A B
(55B C
validTargets55C O
)55O P
;55P Q
}66 	
finally77 
{88 	
IsBusy99 
=99 
false99 
;99 
}:: 	
};; 
[== 
RelayCommand== 
]== 
private>> 
void>> 
Confirm>> 
(>> 
)>> 
{?? 
if@@ 

(@@  
SelectedTargetTicket@@  
!=@@! #
null@@$ (
)@@( )
{AA 	
IsConfirmedBB 
=BB 
trueBB 
;BB 
CloseActionCC 
?CC 
.CC 
InvokeCC 
(CC  
)CC  !
;CC! "
}DD 	
}EE 
[GG 
RelayCommandGG 
]GG 
privateHH 
voidHH 
CancelHH 
(HH 
)HH 
{II 
IsConfirmedJJ 
=JJ 
falseJJ 
;JJ 
CloseActionKK 
?KK 
.KK 
InvokeKK 
(KK 
)KK 
;KK 
}LL 
}MM ¡1
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\ItemSearchViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
.		* +
Dialogs		+ 2
;		2 3
public 
class 
ItemSearchViewModel  
:! "
ViewModelBase# 0
{ 
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
string 
_searchText 
=  
string! '
.' (
Empty( -
;- .
private  
ObservableCollection  
<  !
MenuItem! )
>) *
_results+ 3
=4 5
new6 9
(9 :
): ;
;; <
private 
MenuItem 
? 
_selectedItem #
;# $
public 

string 

SearchText 
{ 
get 
=> 
_searchText 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_searchText  +
,+ ,
value- 2
)2 3
)3 4
{ 
_ 
= 
PerformSearchAsync &
(& '
)' (
;( )
} 
} 	
} 
public 
 
ObservableCollection 
<  
MenuItem  (
>( )
Results* 1
{ 
get   
=>   
_results   
;   
private!! 
set!! 
=>!! 
SetProperty!! "
(!!" #
ref!!# &
_results!!' /
,!!/ 0
value!!1 6
)!!6 7
;!!7 8
}"" 
public$$ 

MenuItem$$ 
?$$ 
SelectedItem$$ !
{%% 
get&& 
=>&& 
_selectedItem&& 
;&& 
set'' 
{(( 	
if)) 
()) 
SetProperty)) 
()) 
ref)) 
_selectedItem))  -
,))- .
value))/ 4
)))4 5
&&))6 8
value))9 >
!=))? A
null))B F
)))F G
{** #
ConfirmSelectionCommand,, '
.,,' (
Execute,,( /
(,,/ 0
null,,0 4
),,4 5
;,,5 6
}-- 
}.. 	
}// 
public11 

ICommand11 #
ConfirmSelectionCommand11 +
{11, -
get11. 1
;111 2
}113 4
public22 

ICommand22 
CancelCommand22 !
{22" #
get22$ '
;22' (
}22) *
public55 

System55 
.55 
Action55 
?55 
CloseAction55 %
{55& '
get55( +
;55+ ,
set55- 0
;550 1
}552 3
public77 

ItemSearchViewModel77 
(77 
IMenuRepository77 .
menuRepository77/ =
)77= >
{88 
_menuRepository99 
=99 
menuRepository99 (
;99( )
Title:: 
=:: 
$str:: 
;:: #
ConfirmSelectionCommand<< 
=<<  !
new<<" %
RelayCommand<<& 2
(<<2 3
(<<3 4
)<<4 5
=><<6 8
CloseAction<<9 D
?<<D E
.<<E F
Invoke<<F L
(<<L M
)<<M N
)<<N O
;<<O P
CancelCommand== 
=== 
new== 
RelayCommand== (
(==( )
(==) *
)==* +
=>==, .
{==/ 0
SelectedItem==1 =
===> ?
null==@ D
;==D E
CloseAction==F Q
?==Q R
.==R S
Invoke==S Y
(==Y Z
)==Z [
;==[ \
}==] ^
)==^ _
;==_ `
}AA 
privateCC 
asyncCC 
TaskCC 
PerformSearchAsyncCC )
(CC) *
)CC* +
{DD 
ifEE 

(EE 
stringEE 
.EE 
IsNullOrWhiteSpaceEE %
(EE% &

SearchTextEE& 0
)EE0 1
)EE1 2
{FF 	
ResultsGG 
.GG 
ClearGG 
(GG 
)GG 
;GG 
returnHH 
;HH 
}II 	
IsBusyKK 
=KK 
trueKK 
;KK 
tryLL 
{MM 	
varRR 
allItemsRR 
=RR 
awaitRR  
_menuRepositoryRR! 0
.RR0 1
GetAllAsyncRR1 <
(RR< =
)RR= >
;RR> ?
varTT 
queryTT 
=TT 

SearchTextTT "
.TT" #
TrimTT# '
(TT' (
)TT( )
;TT) *
varUU 
matchesUU 
=UU 
allItemsUU "
.UU" #
WhereUU# (
(UU( )
iUU) *
=>UU+ -
(VV 
iVV 
.VV 
NameVV 
?VV 
.VV 
ContainsVV !
(VV! "
queryVV" '
,VV' (
SystemVV) /
.VV/ 0
StringComparisonVV0 @
.VV@ A
OrdinalIgnoreCaseVVA R
)VVR S
??VVT V
falseVVW \
)VV\ ]
||VV^ `
(WW 
iWW 
.WW 
BarcodeWW 
?WW 
.WW 
ContainsWW $
(WW$ %
queryWW% *
,WW* +
SystemWW, 2
.WW2 3
StringComparisonWW3 C
.WWC D
OrdinalIgnoreCaseWWD U
)WWU V
??WWW Y
falseWWZ _
)WW_ `
)XX 
.XX 
ToListXX 
(XX 
)XX 
;XX 
ResultsZZ 
=ZZ 
newZZ  
ObservableCollectionZZ .
<ZZ. /
MenuItemZZ/ 7
>ZZ7 8
(ZZ8 9
matchesZZ9 @
)ZZ@ A
;ZZA B
}[[ 	
finally\\ 
{]] 	
IsBusy^^ 
=^^ 
false^^ 
;^^ 
}__ 	
}`` 
}aa Þ
vC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\CustomerSelectionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
.* +
Dialogs+ 2
;2 3
public 
partial 
class &
CustomerSelectionViewModel /
:0 1
ObservableObject2 B
{ 
private		 
string		 

_guestName		 
=		 
string		  &
.		& '
Empty		' ,
;		, -
public

 

string

 
	GuestName

 
{ 
get 
=> 

_guestName 
; 
set 
{ 	
SetProperty 
( 
ref 

_guestName &
,& '
value( -
)- .
;. /
( 
( 
IRelayCommand 
) 
ConfirmCommand *
)* +
.+ ,#
NotifyCanExecuteChanged, C
(C D
)D E
;E F
} 	
} 
private 
string 
_phoneNumber 
=  !
string" (
.( )
Empty) .
;. /
public 

string 
PhoneNumber 
{ 
get 
=> 
_phoneNumber 
; 
set 
=> 
SetProperty 
( 
ref 
_phoneNumber +
,+ ,
value- 2
)2 3
;3 4
} 
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

bool 
IsConfirmed 
{ 
get !
;! "
private# *
set+ .
;. /
}0 1
public 

ICommand 
ConfirmCommand "
{# $
get% (
;( )
}* +
public   

ICommand   
CancelCommand   !
{  " #
get  $ '
;  ' (
}  ) *
public"" 
&
CustomerSelectionViewModel"" %
(""% &
)""& '
{## 
ConfirmCommand$$ 
=$$ 
new$$ 
RelayCommand$$ )
($$) *
Confirm$$* 1
,$$1 2

CanConfirm$$3 =
)$$= >
;$$> ?
CancelCommand%% 
=%% 
new%% 
RelayCommand%% (
(%%( )
Cancel%%) /
)%%/ 0
;%%0 1
}&& 
private(( 
bool(( 

CanConfirm(( 
((( 
)(( 
{)) 
return** 
!** 
string** 
.** 
IsNullOrWhiteSpace** )
(**) *
	GuestName*** 3
)**3 4
;**4 5
}++ 
private-- 
void-- 
Confirm-- 
(-- 
)-- 
{.. 
if// 

(// 

CanConfirm// 
(// 
)// 
)// 
{00 	
IsConfirmed11 
=11 
true11 
;11 
CloseAction22 
?22 
.22 
Invoke22 
(22  
)22  !
;22! "
}33 	
}44 
private66 
void66 
Cancel66 
(66 
)66 
{77 
IsConfirmed88 
=88 
false88 
;88 
CloseAction99 
?99 
.99 
Invoke99 
(99 
)99 
;99 
}:: 
};; å/
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\CookingInstructionViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
.* +
Dialogs+ 2
;2 3
public 
class '
CookingInstructionViewModel (
:) *
ViewModelBase+ 8
{ 
private		 
string		 !
_selectedInstructions		 (
=		) *
string		+ 1
.		1 2
Empty		2 7
;		7 8
public

 

string

  
SelectedInstructions

 &
{ 
get 
=> !
_selectedInstructions $
;$ %
set 
=> 
SetProperty 
( 
ref !
_selectedInstructions 4
,4 5
value6 ;
); <
;< =
} 
public 
 
ObservableCollection 
<  
string  &
>& '"
PredefinedInstructions( >
{? @
getA D
;D E
}F G
=H I
newJ M
(M N
)N O
;O P
public 

ICommand 
ConfirmCommand "
{# $
get% (
;( )
}* +
public 

ICommand 
CancelCommand !
{" #
get$ '
;' (
}) *
public 

ICommand !
AddInstructionCommand )
{* +
get, /
;/ 0
}1 2
public 

System 
. 
Action 
? 
CloseAction %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

System 
. 
Action 
? 
CancelAction &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 

bool 
IsConfirmed 
{ 
get !
;! "
private# *
set+ .
;. /
}0 1
public 
'
CookingInstructionViewModel &
(& '
string' -
currentInstructions. A
=B C
$strD F
)F G
{ 
Title 
= 
$str &
;& ' 
SelectedInstructions 
= 
currentInstructions 2
;2 3"
PredefinedInstructions!! 
.!! 
Add!! "
(!!" #
$str!!# )
)!!) *
;!!* +"
PredefinedInstructions"" 
."" 
Add"" "
(""" #
$str""# 0
)""0 1
;""1 2"
PredefinedInstructions## 
.## 
Add## "
(##" #
$str### +
)##+ ,
;##, -"
PredefinedInstructions$$ 
.$$ 
Add$$ "
($$" #
$str$$# 0
)$$0 1
;$$1 2"
PredefinedInstructions%% 
.%% 
Add%% "
(%%" #
$str%%# .
)%%. /
;%%/ 0"
PredefinedInstructions&& 
.&& 
Add&& "
(&&" #
$str&&# -
)&&- .
;&&. /"
PredefinedInstructions'' 
.'' 
Add'' "
(''" #
$str''# .
)''. /
;''/ 0"
PredefinedInstructions(( 
.(( 
Add(( "
(((" #
$str((# 0
)((0 1
;((1 2"
PredefinedInstructions)) 
.)) 
Add)) "
())" #
$str))# 2
)))2 3
;))3 4"
PredefinedInstructions** 
.** 
Add** "
(**" #
$str**# 4
)**4 5
;**5 6"
PredefinedInstructions++ 
.++ 
Add++ "
(++" #
$str++# 3
)++3 4
;++4 5"
PredefinedInstructions,, 
.,, 
Add,, "
(,," #
$str,,# )
),,) *
;,,* +
ConfirmCommand.. 
=.. 
new.. 
RelayCommand.. )
(..) *
(..* +
)..+ ,
=>..- /
{..0 1
IsConfirmed..2 =
=..> ?
true..@ D
;..D E
CloseAction..F Q
?..Q R
...R S
Invoke..S Y
(..Y Z
)..Z [
;..[ \
}..] ^
)..^ _
;.._ `
CancelCommand// 
=// 
new// 
RelayCommand// (
(//( )
(//) *
)//* +
=>//, .
{/// 0
IsConfirmed//1 <
=//= >
false//? D
;//D E
CancelAction//F R
?//R S
.//S T
Invoke//T Z
(//Z [
)//[ \
;//\ ]
}//^ _
)//_ `
;//` a!
AddInstructionCommand11 
=11 
new11  #
RelayCommand11$ 0
<110 1
string111 7
>117 8
(118 9
AddInstruction119 G
)11G H
;11H I
}22 
private44 
void44 
AddInstruction44 
(44  
string44  &
instruction44' 2
)442 3
{55 
if66 

(66 
string66 
.66 
IsNullOrWhiteSpace66 %
(66% & 
SelectedInstructions66& :
)66: ;
)66; <
{77 	 
SelectedInstructions88  
=88! "
instruction88# .
;88. /
}99 	
else:: 
{;; 	
if== 
(== 
!==  
SelectedInstructions== %
.==% &
Contains==& .
(==. /
instruction==/ :
)==: ;
)==; <
{>>  
SelectedInstructions?? %
+=??& (
$"??) +
$str??+ -
{??- .
instruction??. 9
}??9 :
"??: ;
;??; <
}@@ 
}AA 	
}BB 
}CC …Ž
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\ComboSelectionViewModel.cs
	namespace

 	
Magidesk


 
.

 

ViewModels

 
.

 
Dialogs

 %
;

% &
public 
partial 
class #
ComboSelectionViewModel ,
:- .
ObservableObject/ ?
{ 
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly 
OrderLineDto !
_parentOrderLine" 2
;2 3
private 
bool 
_isBusy 
; 
public 

bool 
IsBusy 
{ 
get 
=> 
_isBusy 
; 
set 
=> 
SetProperty 
( 
ref 
_isBusy &
,& '
value( -
)- .
;. /
} 
[ 
ObservableProperty 
] 
private 
string 

_titleText 
= 
string  &
.& '
Empty' ,
;, -
[ 
ObservableProperty 
] 
private 
string 

_comboName 
= 
string  &
.& '
Empty' ,
;, -
[ 
ObservableProperty 
] 
private 
string 
? 
_validationError $
;$ %
public!! 
 
ObservableCollection!! 
<!!  
ComboGroupViewModel!!  3
>!!3 4
SelectionGroups!!5 D
{!!E F
get!!G J
;!!J K
}!!L M
=!!N O
new!!P S
(!!S T
)!!T U
;!!U V
public## 

bool## 
HasValidationError## "
=>### %
!##& '
string##' -
.##- .
IsNullOrEmpty##. ;
(##; <
ValidationError##< K
)##K L
;##L M
public%% 

ICommand%% 
ConfirmCommand%% "
{%%# $
get%%% (
;%%( )
}%%* +
public&& 

ICommand&& 
CancelCommand&& !
{&&" #
get&&$ '
;&&' (
}&&) *
public'' 

Action'' 
?'' 
CloseAction'' 
{''  
get''! $
;''$ %
set''& )
;'') *
}''+ ,
public)) 

bool)) 
IsConfirmed)) 
{)) 
get)) !
;))! "
private))# *
set))+ .
;)). /
}))0 1
public** 

List** 
<** #
ComboSelectionResultDto** '
>**' (
ResultSelections**) 9
{**: ;
get**< ?
;**? @
private**A H
set**I L
;**L M
}**N O
=**P Q
new**R U
(**U V
)**V W
;**W X
public,, 
#
ComboSelectionViewModel,, "
(,," #
IMenuRepository,,# 2
menuRepository,,3 A
,,,A B
OrderLineDto,,C O
parentOrderLine,,P _
),,_ `
{-- 
_menuRepository.. 
=.. 
menuRepository.. (
;..( )
_parentOrderLine// 
=// 
parentOrderLine// *
;//* +

_titleText00 
=00 
$str00 +
;00+ ,
ConfirmCommand22 
=22 
new22 
RelayCommand22 )
(22) *
Confirm22* 1
)221 2
;222 3
CancelCommand33 
=33 
new33 
RelayCommand33 (
(33( )
Cancel33) /
)33/ 0
;330 1
}44 
public66 

async66 
Task66 
InitializeAsync66 %
(66% &
)66& '
{77 
IsBusy88 
=88 
true88 
;88 
try99 
{:: 	
var;; 
menuItem;; 
=;; 
await;;  
_menuRepository;;! 0
.;;0 1
GetByIdAsync;;1 =
(;;= >
_parentOrderLine;;> N
.;;N O

MenuItemId;;O Y
);;Y Z
;;;Z [
if<< 
(<< 
menuItem<< 
?<< 
.<< 
ComboDefinitionId<< +
==<<, .
null<</ 3
)<<3 4
return<<5 ;
;<<; <
var>> 
comboDefinition>> 
=>>  !
await>>" '
GetComboDefinition>>( :
(>>: ;
menuItem>>; C
.>>C D
ComboDefinitionId>>D U
.>>U V
Value>>V [
)>>[ \
;>>\ ]
if?? 
(?? 
comboDefinition?? 
==??  "
null??# '
)??' (
return??) /
;??/ 0

_comboNameAA 
=AA 
comboDefinitionAA (
.AA( )
NameAA) -
;AA- .
SelectionGroupsDD 
.DD 
ClearDD !
(DD! "
)DD" #
;DD# $
foreachEE 
(EE 
varEE 
groupEE 
inEE !
comboDefinitionEE" 1
.EE1 2
GroupsEE2 8
.EE8 9
OrderByEE9 @
(EE@ A
gEEA B
=>EEC E
gEEF G
.EEG H
	SortOrderEEH Q
)EEQ R
)EER S
{FF 
varGG 
groupVmGG 
=GG 
newGG !
ComboGroupViewModelGG" 5
(GG5 6
groupGG6 ;
)GG; <
;GG< =
foreachJJ 
(JJ 
varJJ 
itemJJ !
inJJ" $
groupJJ% *
.JJ* +
ItemsJJ+ 0
.JJ0 1
OrderByJJ1 8
(JJ8 9
iJJ9 :
=>JJ; =
iJJ> ?
.JJ? @

MenuItemIdJJ@ J
)JJJ K
)JJK L
{KK 
varLL 
itemMenuItemLL $
=LL% &
awaitLL' ,
_menuRepositoryLL- <
.LL< =
GetByIdAsyncLL= I
(LLI J
itemLLJ N
.LLN O

MenuItemIdLLO Y
)LLY Z
;LLZ [
ifMM 
(MM 
itemMenuItemMM $
!=MM% '
nullMM( ,
)MM, -
{NN 
varOO 
itemVmOO "
=OO# $
newOO% (
ComboItemViewModelOO) ;
(OO; <
itemPP  
.PP  !
IdPP! #
,PP# $
itemMenuItemQQ (
.QQ( )
NameQQ) -
,QQ- .
itemMenuItemRR (
.RR( )
PriceRR) .
.RR. /
AmountRR/ 5
,RR5 6
itemSS  
.SS  !
UpchargeSS! )
.SS) *
AmountSS* 0
,SS0 1
groupTT !
.TT! "
IdTT" $
)UU 
;UU 
itemVmXX 
.XX 
PropertyChangedXX .
+=XX/ 1
(XX2 3
sXX3 4
,XX4 5
eXX6 7
)XX7 8
=>XX9 ;
{YY 
ifZZ 
(ZZ  
eZZ  !
.ZZ! "
PropertyNameZZ" .
==ZZ/ 1
nameofZZ2 8
(ZZ8 9
ComboItemViewModelZZ9 K
.ZZK L

IsSelectedZZL V
)ZZV W
)ZZW X
{[[ 
if]]  "
(]]# $
itemVm]]$ *
.]]* +

IsSelected]]+ 5
)]]5 6
{^^  !
foreach__$ +
(__, -
var__- 0
	otherItem__1 :
in__; =
groupVm__> E
.__E F
Items__F K
.__K L
Where__L Q
(__Q R
i__R S
=>__T V
i__W X
!=__Y [
itemVm__\ b
)__b c
)__c d
{``$ %
	otherItemaa( 1
.aa1 2

IsSelectedaa2 <
=aa= >
falseaa? D
;aaD E
}bb$ %
}cc  !
ValidateSelectionsff  2
(ff2 3
)ff3 4
;ff4 5
}gg 
}hh 
;hh 
groupVmjj 
.jj  
Itemsjj  %
.jj% &
Addjj& )
(jj) *
itemVmjj* 0
)jj0 1
;jj1 2
}kk 
}ll 
SelectionGroupsnn 
.nn  
Addnn  #
(nn# $
groupVmnn$ +
)nn+ ,
;nn, -
}oo 
}pp 	
finallyqq 
{rr 	
IsBusyss 
=ss 
falsess 
;ss 
}tt 	
}uu 
privateww 
asyncww 
Taskww 
<ww 
ComboDefinitionww &
?ww& '
>ww' (
GetComboDefinitionww) ;
(ww; <
Guidww< @
comboDefinitionIdwwA R
)wwR S
{xx 
return|| 
null|| 
;|| 
}}} 
private 
bool 
ValidateSelections #
(# $
)$ %
{
€€ 
ValidationError
 
=
 
null
 
;
 
foreach
ƒƒ 
(
ƒƒ 
var
ƒƒ 
group
ƒƒ 
in
ƒƒ 
SelectionGroups
ƒƒ -
)
ƒƒ- .
{
„„ 	
var
…… 
hasSelection
…… 
=
…… 
group
…… $
.
……$ %
Items
……% *
.
……* +
Any
……+ .
(
……. /
i
……/ 0
=>
……1 3
i
……4 5
.
……5 6

IsSelected
……6 @
)
……@ A
;
……A B
if
‰‰ 
(
‰‰ 
!
‰‰ 
hasSelection
‰‰ 
)
‰‰ 
{
ŠŠ 
ValidationError
‹‹ 
=
‹‹  !
$"
‹‹" $
$str
‹‹$ ?
{
‹‹? @
group
‹‹@ E
.
‹‹E F
	GroupName
‹‹F O
}
‹‹O P
"
‹‹P Q
;
‹‹Q R
return
ŒŒ 
false
ŒŒ 
;
ŒŒ 
}
 
}
ŽŽ 	
return
 
true
 
;
 
}
‘‘ 
private
““ 
void
““ 
Confirm
““ 
(
““ 
)
““ 
{
”” 
if
•• 

(
•• 
!
••  
ValidateSelections
•• 
(
••  
)
••  !
)
••! "
return
••# )
;
••) *
ResultSelections
—— 
.
—— 
Clear
—— 
(
—— 
)
——  
;
——  !
foreach
™™ 
(
™™ 
var
™™ 
group
™™ 
in
™™ 
SelectionGroups
™™ -
)
™™- .
{
šš 	
var
›› 
selectedItem
›› 
=
›› 
group
›› $
.
››$ %
Items
››% *
.
››* +
FirstOrDefault
››+ 9
(
››9 :
i
››: ;
=>
››< >
i
››? @
.
››@ A

IsSelected
››A K
)
››K L
;
››L M
if
œœ 
(
œœ 
selectedItem
œœ 
!=
œœ 
null
œœ  $
)
œœ$ %
{
 
ResultSelections
žž  
.
žž  !
Add
žž! $
(
žž$ %
new
žž% (%
ComboSelectionResultDto
žž) @
{
ŸŸ 
ComboGroupId
    
=
  ! "
group
  # (
.
  ( )
GroupId
  ) 0
,
  0 1
	GroupName
¡¡ 
=
¡¡ 
group
¡¡  %
.
¡¡% &
	GroupName
¡¡& /
,
¡¡/ 0

MenuItemId
¢¢ 
=
¢¢  
selectedItem
¢¢! -
.
¢¢- .

MenuItemId
¢¢. 8
,
¢¢8 9
ItemName
££ 
=
££ 
selectedItem
££ +
.
££+ ,
ItemName
££, 4
,
££4 5
	BasePrice
¤¤ 
=
¤¤ 
selectedItem
¤¤  ,
.
¤¤, -
	BasePrice
¤¤- 6
,
¤¤6 7
Upcharge
¥¥ 
=
¥¥ 
selectedItem
¥¥ +
.
¥¥+ ,
Upcharge
¥¥, 4
}
¦¦ 
)
¦¦ 
;
¦¦ 
}
§§ 
}
¨¨ 	
IsConfirmed
ªª 
=
ªª 
true
ªª 
;
ªª 
CloseAction
«« 
?
«« 
.
«« 
Invoke
«« 
(
«« 
)
«« 
;
«« 
}
¬¬ 
private
®® 
void
®® 
Cancel
®® 
(
®® 
)
®® 
{
¯¯ 
IsConfirmed
°° 
=
°° 
false
°° 
;
°° 
CloseAction
±± 
?
±± 
.
±± 
Invoke
±± 
(
±± 
)
±± 
;
±± 
}
²² 
}³³ 
publicµµ 
partial
µµ 
class
µµ !
ComboGroupViewModel
µµ (
:
µµ) *
ObservableObject
µµ+ ;
{¶¶ 
public
·· 

Guid
·· 
GroupId
·· 
{
·· 
get
·· 
;
·· 
}
··  
public
¸¸ 

string
¸¸ 
	GroupName
¸¸ 
{
¸¸ 
get
¸¸ !
;
¸¸! "
}
¸¸# $
public
¹¹ 

string
¹¹ 
SelectionPrompt
¹¹ !
{
¹¹" #
get
¹¹$ '
;
¹¹' (
}
¹¹) *
public
»» 
"
ObservableCollection
»» 
<
»»   
ComboItemViewModel
»»  2
>
»»2 3
Items
»»4 9
{
»»: ;
get
»»< ?
;
»»? @
}
»»A B
=
»»C D
new
»»E H
(
»»H I
)
»»I J
;
»»J K
public
½½ 
!
ComboGroupViewModel
½½ 
(
½½ 

ComboGroup
½½ )
group
½½* /
)
½½/ 0
{
¾¾ 
GroupId
¿¿ 
=
¿¿ 
group
¿¿ 
.
¿¿ 
Id
¿¿ 
;
¿¿ 
	GroupName
ÀÀ 
=
ÀÀ 
group
ÀÀ 
.
ÀÀ 
Name
ÀÀ 
;
ÀÀ 
SelectionPrompt
ÁÁ 
=
ÁÁ 
$"
ÁÁ 
$str
ÁÁ (
{
ÁÁ( )
group
ÁÁ) .
.
ÁÁ. /
Name
ÁÁ/ 3
}
ÁÁ3 4
"
ÁÁ4 5
;
ÁÁ5 6
}
ÂÂ 
}ÃÃ 
publicÅÅ 
partial
ÅÅ 
class
ÅÅ  
ComboItemViewModel
ÅÅ '
:
ÅÅ( )
ObservableObject
ÅÅ* :
{ÆÆ 
public
ÇÇ 

Guid
ÇÇ 
Id
ÇÇ 
{
ÇÇ 
get
ÇÇ 
;
ÇÇ 
}
ÇÇ 
public
ÈÈ 

Guid
ÈÈ 

MenuItemId
ÈÈ 
{
ÈÈ 
get
ÈÈ  
;
ÈÈ  !
}
ÈÈ" #
public
ÉÉ 

string
ÉÉ 
ItemName
ÉÉ 
{
ÉÉ 
get
ÉÉ  
;
ÉÉ  !
}
ÉÉ" #
public
ÊÊ 

decimal
ÊÊ 
	BasePrice
ÊÊ 
{
ÊÊ 
get
ÊÊ "
;
ÊÊ" #
}
ÊÊ$ %
public
ËË 

decimal
ËË 
Upcharge
ËË 
{
ËË 
get
ËË !
;
ËË! "
}
ËË# $
public
ÌÌ 

Guid
ÌÌ 
GroupId
ÌÌ 
{
ÌÌ 
get
ÌÌ 
;
ÌÌ 
}
ÌÌ  
[
ÎÎ  
ObservableProperty
ÎÎ 
]
ÎÎ 
private
ÏÏ 
bool
ÏÏ 
_isSelected
ÏÏ 
;
ÏÏ 
public
ÑÑ 

string
ÑÑ 
PriceDisplay
ÑÑ 
{
ÒÒ 
get
ÓÓ 
{
ÔÔ 	
var
ÕÕ 

totalPrice
ÕÕ 
=
ÕÕ 
	BasePrice
ÕÕ &
+
ÕÕ' (
Upcharge
ÕÕ) 1
;
ÕÕ1 2
return
ÖÖ 

totalPrice
ÖÖ 
>
ÖÖ 
$num
ÖÖ  !
?
ÖÖ" #
$"
ÖÖ$ &
$str
ÖÖ& '
{
ÖÖ' (

totalPrice
ÖÖ( 2
:
ÖÖ2 3
$str
ÖÖ3 4
}
ÖÖ4 5
"
ÖÖ5 6
:
ÖÖ7 8
$str
ÖÖ9 C
;
ÖÖC D
}
×× 	
}
ØØ 
public
ÚÚ 
 
ComboItemViewModel
ÚÚ 
(
ÚÚ 
Guid
ÚÚ "
id
ÚÚ# %
,
ÚÚ% &
string
ÚÚ' -
itemName
ÚÚ. 6
,
ÚÚ6 7
decimal
ÚÚ8 ?
	basePrice
ÚÚ@ I
,
ÚÚI J
decimal
ÚÚK R
upcharge
ÚÚS [
,
ÚÚ[ \
Guid
ÚÚ] a
groupId
ÚÚb i
)
ÚÚi j
{
ÛÛ 
Id
ÜÜ 

=
ÜÜ 
id
ÜÜ 
;
ÜÜ 

MenuItemId
ÝÝ 
=
ÝÝ 
id
ÝÝ 
;
ÝÝ 
ItemName
ÞÞ 
=
ÞÞ 
itemName
ÞÞ 
;
ÞÞ 
	BasePrice
ßß 
=
ßß 
	basePrice
ßß 
;
ßß 
Upcharge
àà 
=
àà 
upcharge
àà 
;
àà 
GroupId
áá 
=
áá 
groupId
áá 
;
áá 
}
ââ 
}ãã 
publicåå 
class
åå %
ComboSelectionResultDto
åå $
{ææ 
public
çç 

Guid
çç 
ComboGroupId
çç 
{
çç 
get
çç "
;
çç" #
set
çç$ '
;
çç' (
}
çç) *
public
èè 

string
èè 
	GroupName
èè 
{
èè 
get
èè !
;
èè! "
set
èè# &
;
èè& '
}
èè( )
=
èè* +
string
èè, 2
.
èè2 3
Empty
èè3 8
;
èè8 9
public
éé 

Guid
éé 

MenuItemId
éé 
{
éé 
get
éé  
;
éé  !
set
éé" %
;
éé% &
}
éé' (
public
êê 

string
êê 
ItemName
êê 
{
êê 
get
êê  
;
êê  !
set
êê" %
;
êê% &
}
êê' (
=
êê) *
string
êê+ 1
.
êê1 2
Empty
êê2 7
;
êê7 8
public
ëë 

decimal
ëë 
	BasePrice
ëë 
{
ëë 
get
ëë "
;
ëë" #
set
ëë$ '
;
ëë' (
}
ëë) *
public
ìì 

decimal
ìì 
Upcharge
ìì 
{
ìì 
get
ìì !
;
ìì! "
set
ìì# &
;
ìì& '
}
ìì( )
}íí ·G
sC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\Dialogs\AddOnSelectionViewModel.cs
	namespace

 	
Magidesk


 
.

 

ViewModels

 
.

 
Dialogs

 %
;

% &
public 
partial 
class #
AddOnSelectionViewModel ,
:- .
ObservableObject/ ?
{ 
private 
readonly 
IMenuRepository $
_menuRepository% 4
;4 5
private 
readonly 
OrderLineDto !
_parentOrderLine" 2
;2 3
private 
bool 
_isBusy 
; 
public 

bool 
IsBusy 
{ 
get 
=> 
_isBusy 
; 
set 
=> 
SetProperty 
( 
ref 
_isBusy &
,& '
value( -
)- .
;. /
} 
[ 
ObservableProperty 
] 
private 
string 
_promptText 
=  
string! '
.' (
Empty( -
;- .
public 
 
ObservableCollection 
<  
AddOnItemViewModel  2
>2 3

AddOnItems4 >
{? @
getA D
;D E
}F G
=H I
newJ M
(M N
)N O
;O P
public 

ICommand 
ConfirmCommand "
{# $
get% (
;( )
}* +
public 

ICommand 
CancelCommand !
{" #
get$ '
;' (
}) *
public 

Action 
? 
CloseAction 
{  
get! $
;$ %
set& )
;) *
}+ ,
public!! 

bool!! 
IsConfirmed!! 
{!! 
get!! !
;!!! "
private!!# *
set!!+ .
;!!. /
}!!0 1
public"" 

List"" 
<""  
OrderLineModifierDto"" $
>""$ %
ResultAddOns""& 2
{""3 4
get""5 8
;""8 9
private"": A
set""B E
;""E F
}""G H
=""I J
new""K N
(""N O
)""O P
;""P Q
public$$ 
#
AddOnSelectionViewModel$$ "
($$" #
IMenuRepository$$# 2
menuRepository$$3 A
,$$A B
OrderLineDto$$C O
parentOrderLine$$P _
)$$_ `
{%% 
_menuRepository&& 
=&& 
menuRepository&& (
;&&( )
_parentOrderLine'' 
='' 
parentOrderLine'' *
;''* +
_promptText(( 
=(( 
$"(( 
$str(( ?
{((? @
parentOrderLine((@ O
.((O P
MenuItemName((P \
}((\ ]
$str((] ^
"((^ _
;((_ `
ConfirmCommand** 
=** 
new** 
RelayCommand** )
(**) *
Confirm*** 1
)**1 2
;**2 3
CancelCommand++ 
=++ 
new++ 
RelayCommand++ (
(++( )
Cancel++) /
)++/ 0
;++0 1
},, 
public.. 

async.. 
Task.. 
InitializeAsync.. %
(..% &
)..& '
{// 
IsBusy00 
=00 
true00 
;00 
try11 
{22 	
var33 
menuItem33 
=33 
await33  
_menuRepository33! 0
.330 1
GetByIdAsync331 =
(33= >
_parentOrderLine33> N
.33N O

MenuItemId33O Y
)33Y Z
;33Z [
if44 
(44 
menuItem44 
!=44 
null44  
)44  !
{55 
var88 
allMenuItems88  
=88! "
await88# (
_menuRepository88) 8
.888 9
GetAllAsync889 D
(88D E
)88E F
;88F G
var;; 
potentialAddOns;; #
=;;$ %
allMenuItems;;& 2
.<< 
Where<< 
(<< 
item<< 
=><<  "
item<<# '
.<<' (
IsAvailable<<( 3
&&<<4 6
item==# '
.==' (
	IsVisible==( 1
&&==2 4
(>># $
item>>$ (
.>>( )
Name>>) -
.>>- .
Contains>>. 6
(>>6 7
$str>>7 <
,>>< =
StringComparison>>> N
.>>N O
OrdinalIgnoreCase>>O `
)>>` a
||>>b d
item??$ (
.??( )
Price??) .
.??. /
Amount??/ 5
<=??6 8
$num??9 >
)??> ?
)??? @
.@@ 
OrderBy@@ 
(@@ 
item@@ !
=>@@" $
item@@% )
.@@) *
Price@@* /
.@@/ 0
Amount@@0 6
)@@6 7
.AA 
TakeAA 
(AA 
$numAA 
)AA 
.BB 
ToListBB 
(BB 
)BB 
;BB 
foreachDD 
(DD 
varDD 
	addOnItemDD &
inDD' )
potentialAddOnsDD* 9
)DD9 :
{EE 
varFF 
addOnVmFF 
=FF  !
newFF" %
AddOnItemViewModelFF& 8
(FF8 9
	addOnItemGG !
.GG! "
IdGG" $
,GG$ %
	addOnItemHH !
.HH! "
NameHH" &
,HH& '
	addOnItemII !
.II! "
PriceII" '
.II' (
AmountII( .
)JJ 
;JJ 

AddOnItemsLL 
.LL 
AddLL "
(LL" #
addOnVmLL# *
)LL* +
;LL+ ,
}MM 
}NN 
}OO 	
finallyPP 
{QQ 	
IsBusyRR 
=RR 
falseRR 
;RR 
}SS 	
}TT 
privateVV 
voidVV 
ConfirmVV 
(VV 
)VV 
{WW 
ResultAddOnsXX 
.XX 
ClearXX 
(XX 
)XX 
;XX 
foreachZZ 
(ZZ 
varZZ 
addOnZZ 
inZZ 

AddOnItemsZZ (
)ZZ( )
{[[ 	
if\\ 
(\\ 
addOn\\ 
.\\ 

IsSelected\\  
)\\  !
{]] 
ResultAddOns^^ 
.^^ 
Add^^  
(^^  !
new^^! $ 
OrderLineModifierDto^^% 9
{__ 

ModifierId`` 
=``  
addOn``! &
.``& '

MenuItemId``' 1
,``1 2
Nameaa 
=aa 
addOnaa  
.aa  !
Nameaa! %
,aa% &
ModifierTypebb  
=bb! "
ModifierTypebb# /
.bb/ 0
AddOnbb0 5
,bb5 6
	ItemCountcc 
=cc 
$numcc  !
,cc! "
	UnitPricedd 
=dd 
addOndd  %
.dd% &
Pricedd& +
,dd+ ,
TaxRateee 
=ee 
$numee 
,ee   
ShouldPrintToKitchenff (
=ff) *
trueff+ /
}gg 
)gg 
;gg 
}hh 
}ii 	
IsConfirmedkk 
=kk 
truekk 
;kk 
CloseActionll 
?ll 
.ll 
Invokell 
(ll 
)ll 
;ll 
}mm 
privateoo 
voidoo 
Canceloo 
(oo 
)oo 
{pp 
IsConfirmedqq 
=qq 
falseqq 
;qq 
CloseActionrr 
?rr 
.rr 
Invokerr 
(rr 
)rr 
;rr 
}ss 
}tt 
publicvv 
partialvv 
classvv 
AddOnItemViewModelvv '
:vv( )
ObservableObjectvv* :
{ww 
publicxx 

Guidxx 

MenuItemIdxx 
{xx 
getxx  
;xx  !
}xx" #
publicyy 

stringyy 
Nameyy 
{yy 
getyy 
;yy 
}yy 
publiczz 

decimalzz 
Pricezz 
{zz 
getzz 
;zz 
}zz  !
[|| 
ObservableProperty|| 
]|| 
private}} 
bool}} 
_isSelected}} 
;}} 
public 

AddOnItemViewModel 
( 
Guid "

menuItemId# -
,- .
string/ 5
name6 :
,: ;
decimal< C
priceD I
)I J
{
€€ 

MenuItemId
 
=
 

menuItemId
 
;
  
Name
‚‚ 
=
‚‚ 
name
‚‚ 
;
‚‚ 
Price
ƒƒ 
=
ƒƒ 
price
ƒƒ 
;
ƒƒ 
}
„„ 
}…… ”—
hC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\CashSessionViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
;		* +
public 
sealed 
class  
CashSessionViewModel (
:) *
ViewModelBase+ 8
{ 
private 
readonly 
IQueryHandler "
<" #&
GetCurrentCashSessionQuery# =
,= >'
GetCurrentCashSessionResult? Z
>Z [
_getCurrent\ g
;g h
private 
readonly 
ICommandHandler $
<$ %"
OpenCashSessionCommand% ;
,; <!
OpenCashSessionResult= R
>R S
_openT Y
;Y Z
private 
readonly 
ICommandHandler $
<$ %#
CloseCashSessionCommand% <
,< ="
CloseCashSessionResult> T
>T U
_closeV \
;\ ]
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
CashSessionDto 
? 
_current $
;$ %
private 
string 
_userIdText 
=  
Guid! %
.% &
Empty& +
.+ ,
ToString, 4
(4 5
)5 6
;6 7
private 
string 
_terminalIdText "
=# $
Guid% )
.) *
Empty* /
./ 0
ToString0 8
(8 9
)9 :
;: ;
private 
string 
_shiftIdText 
=  !
Guid" &
.& '
Empty' ,
., -
ToString- 5
(5 6
)6 7
;7 8
private 
string 
_openingBalanceText &
=' (
$str) ,
;, -
private 
string 
_actualCashText "
=# $
$str% (
;( )
private 
string 
? 
_error 
; 
public 
 
CashSessionViewModel 
(  
IQueryHandler 
< &
GetCurrentCashSessionQuery 0
,0 1'
GetCurrentCashSessionResult2 M
>M N

getCurrentO Y
,Y Z
ICommandHandler 
< "
OpenCashSessionCommand .
,. /!
OpenCashSessionResult0 E
>E F
openG K
,K L
ICommandHandler 
< #
CloseCashSessionCommand /
,/ 0"
CloseCashSessionResult1 G
>G H
closeI N
,N O
IUserService   
userService    
,    !
ITerminalContext!! 
terminalContext!! (
,!!( )
NavigationService"" 
navigationService"" +
)""+ ,
{## 
_getCurrent$$ 
=$$ 

getCurrent$$  
;$$  !
_open%% 
=%% 
open%% 
;%% 
_close&& 
=&& 
close&& 
;&& 
_userService'' 
='' 
userService'' "
;''" #
_terminalContext(( 
=(( 
terminalContext(( *
;((* +
_navigationService)) 
=)) 
navigationService)) .
;)). /
RefreshCommand++ 
=++ 
new++ 
AsyncRelayCommand++ .
(++. /
RefreshAsync++/ ;
)++; <
;++< =
OpenCommand,, 
=,, 
new,, 
AsyncRelayCommand,, +
(,,+ ,
	OpenAsync,,, 5
),,5 6
;,,6 7
CloseCommand-- 
=-- 
new-- 
AsyncRelayCommand-- ,
(--, -

CloseAsync--- 7
)--7 8
;--8 9
GoBackCommand.. 
=.. 
new.. 
RelayCommand.. (
(..( )
GoBack..) /
)../ 0
;..0 1
Title00 
=00 
$str00 
;00 
if22 

(22 
_userService22 
.22 
CurrentUser22 $
?22$ %
.22% &
Id22& (
!=22) +
null22, 0
)220 1
{33 	

UserIdText44 
=44 
_userService44 %
.44% &
CurrentUser44& 1
.441 2
Id442 4
.444 5
ToString445 =
(44= >
)44> ?
;44? @
}55 	
if77 

(77 
_terminalContext77 
.77 

TerminalId77 '
!=77( *
null77+ /
)77/ 0
{88 	
TerminalIdText99 
=99 
_terminalContext99 -
.99- .

TerminalId99. 8
.998 9
Value999 >
.99> ?
ToString99? G
(99G H
)99H I
;99I J
}:: 	
};; 
public== 

AsyncRelayCommand== 
RefreshCommand== +
{==, -
get==. 1
;==1 2
}==3 4
public>> 

AsyncRelayCommand>> 
OpenCommand>> (
{>>) *
get>>+ .
;>>. /
}>>0 1
public?? 

AsyncRelayCommand?? 
CloseCommand?? )
{??* +
get??, /
;??/ 0
}??1 2
public@@ 

RelayCommand@@ 
GoBackCommand@@ %
{@@& '
get@@( +
;@@+ ,
}@@- .
publicBB 

CashSessionDtoBB 
?BB 
CurrentBB "
{CC 
getDD 
=>DD 
_currentDD 
;DD 
privateEE 
setEE 
{FF 	
ifGG 
(GG 
SetPropertyGG 
(GG 
refGG 
_currentGG  (
,GG( )
valueGG* /
)GG/ 0
)GG0 1
{HH 
OnPropertyChangedII !
(II! "
nameofII" (
(II( )
HasOpenSessionII) 7
)II7 8
)II8 9
;II9 :
OnPropertyChangedJJ !
(JJ! "
nameofJJ" (
(JJ( )
CurrentStatusTextJJ) :
)JJ: ;
)JJ; <
;JJ< =
OnPropertyChangedKK !
(KK! "
nameofKK" (
(KK( ) 
CurrentSessionIdTextKK) =
)KK= >
)KK> ?
;KK? @
OnPropertyChangedLL !
(LL! "
nameofLL" (
(LL( )
CurrentOpenedAtTextLL) <
)LL< =
)LL= >
;LL> ?
OnPropertyChangedMM !
(MM! "
nameofMM" (
(MM( )#
CurrentExpectedCashTextMM) @
)MM@ A
)MMA B
;MMB C
}NN 
}OO 	
}PP 
publicRR 

boolRR 
HasOpenSessionRR 
=>RR !
CurrentRR" )
!=RR* ,
nullRR- 1
&&RR2 4
CurrentRR5 <
.RR< =
ClosedAtRR= E
==RRF H
nullRRI M
;RRM N
publicTT 

stringTT 
CurrentStatusTextTT #
=>TT$ &
CurrentTT' .
==TT/ 1
nullTT2 6
?TT7 8
$strTT9 ?
:TT@ A
$strTTB H
;TTH I
publicVV 

stringVV  
CurrentSessionIdTextVV &
=>VV' )
CurrentVV* 1
==VV2 4
nullVV5 9
?VV: ;
stringVV< B
.VVB C
EmptyVVC H
:VVI J
$"VVK M
$strVVM X
{VVX Y
CurrentVVY `
.VV` a
IdVVa c
}VVc d
"VVd e
;VVe f
publicXX 

stringXX 
CurrentOpenedAtTextXX %
=>XX& (
CurrentXX) 0
==XX1 3
nullXX4 8
?XX9 :
stringXX; A
.XXA B
EmptyXXB G
:XXH I
$"XXJ L
$strXXL V
{XXV W
CurrentXXW ^
.XX^ _
OpenedAtXX_ g
}XXg h
"XXh i
;XXi j
publicZZ 

stringZZ #
CurrentExpectedCashTextZZ )
=>ZZ* ,
CurrentZZ- 4
==ZZ5 7
nullZZ8 <
?ZZ= >
stringZZ? E
.ZZE F
EmptyZZF K
:ZZL M
$"ZZN P
$strZZP ^
{ZZ^ _
CurrentZZ_ f
.ZZf g
ExpectedCashZZg s
}ZZs t
"ZZt u
;ZZu v
public\\ 

string\\ 

UserIdText\\ 
{]] 
get^^ 
=>^^ 
_userIdText^^ 
;^^ 
set__ 
=>__ 
SetProperty__ 
(__ 
ref__ 
_userIdText__ *
,__* +
value__, 1
)__1 2
;__2 3
}`` 
publicbb 

stringbb 
TerminalIdTextbb  
{cc 
getdd 
=>dd 
_terminalIdTextdd 
;dd 
setee 
=>ee 
SetPropertyee 
(ee 
refee 
_terminalIdTextee .
,ee. /
valueee0 5
)ee5 6
;ee6 7
}ff 
publichh 

stringhh 
ShiftIdTexthh 
{ii 
getjj 
=>jj 
_shiftIdTextjj 
;jj 
setkk 
=>kk 
SetPropertykk 
(kk 
refkk 
_shiftIdTextkk +
,kk+ ,
valuekk- 2
)kk2 3
;kk3 4
}ll 
publicnn 

stringnn 
OpeningBalanceTextnn $
{oo 
getpp 
=>pp 
_openingBalanceTextpp "
;pp" #
setqq 
=>qq 
SetPropertyqq 
(qq 
refqq 
_openingBalanceTextqq 2
,qq2 3
valueqq4 9
)qq9 :
;qq: ;
}rr 
publictt 

stringtt 
ActualCashTexttt  
{uu 
getvv 
=>vv 
_actualCashTextvv 
;vv 
setww 
=>ww 
SetPropertyww 
(ww 
refww 
_actualCashTextww .
,ww. /
valueww0 5
)ww5 6
;ww6 7
}xx 
publiczz 

stringzz 
?zz 
Errorzz 
{{{ 
get|| 
=>|| 
_error|| 
;|| 
private}} 
set}} 
{~~ 	
if 
( 
SetProperty 
( 
ref 
_error  &
,& '
value( -
)- .
). /
{
€€ 
OnPropertyChanged
 !
(
! "
nameof
" (
(
( )
HasError
) 1
)
1 2
)
2 3
;
3 4
}
‚‚ 
}
ƒƒ 	
}
„„ 
public
†† 

bool
†† 
HasError
†† 
=>
†† 
!
†† 
string
†† #
.
††# $ 
IsNullOrWhiteSpace
††$ 6
(
††6 7
Error
††7 <
)
††< =
;
††= >
private
ˆˆ 
void
ˆˆ 
GoBack
ˆˆ 
(
ˆˆ 
)
ˆˆ 
{
‰‰ 
if
ŠŠ 

(
ŠŠ  
_navigationService
ŠŠ 
.
ŠŠ 
	CanGoBack
ŠŠ (
)
ŠŠ( )
{
‹‹ 	 
_navigationService
ŒŒ 
.
ŒŒ 
GoBack
ŒŒ %
(
ŒŒ% &
)
ŒŒ& '
;
ŒŒ' (
}
 	
}
ŽŽ 
public
 

async
 
Task
 
RefreshAsync
 "
(
" #
)
# $
{
‘‘ 
Error
’’ 
=
’’ 
null
’’ 
;
’’ 
IsBusy
““ 
=
““ 
true
““ 
;
““ 
try
”” 
{
•• 	
if
–– 
(
–– 
!
–– 
Guid
–– 
.
–– 
TryParse
–– 
(
–– 

UserIdText
–– )
,
––) *
out
––+ .
var
––/ 2
userId
––3 9
)
––9 :
)
––: ;
{
—— 
Error
˜˜ 
=
˜˜ 
$str
˜˜ )
;
˜˜) *
return
™™ 
;
™™ 
}
šš 
var
œœ 
result
œœ 
=
œœ 
await
œœ 
_getCurrent
œœ *
.
œœ* +
HandleAsync
œœ+ 6
(
œœ6 7
new
œœ7 :(
GetCurrentCashSessionQuery
œœ; U
{
œœV W
UserId
œœX ^
=
œœ_ `
userId
œœa g
}
œœh i
)
œœi j
;
œœj k
Current
 
=
 
result
 
.
 
CashSession
 (
;
( )
}
žž 	
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ 
{
   	
Error
¡¡ 
=
¡¡ 
ex
¡¡ 
.
¡¡ 
Message
¡¡ 
;
¡¡ 
}
¢¢ 	
finally
££ 
{
¤¤ 	
IsBusy
¥¥ 
=
¥¥ 
false
¥¥ 
;
¥¥ 
}
¦¦ 	
}
§§ 
private
©© 
async
©© 
Task
©© 
	OpenAsync
©©  
(
©©  !
)
©©! "
{
ªª 
Error
«« 
=
«« 
null
«« 
;
«« 
IsBusy
¬¬ 
=
¬¬ 
true
¬¬ 
;
¬¬ 
try
­­ 
{
®® 	
if
¯¯ 
(
¯¯ 
!
¯¯ 
Guid
¯¯ 
.
¯¯ 
TryParse
¯¯ 
(
¯¯ 

UserIdText
¯¯ )
,
¯¯) *
out
¯¯+ .
var
¯¯/ 2
userId
¯¯3 9
)
¯¯9 :
)
¯¯: ;
{
¯¯< =
Error
¯¯> C
=
¯¯D E
$str
¯¯F W
;
¯¯W X
return
¯¯Y _
;
¯¯_ `
}
¯¯a b
if
°° 
(
°° 
!
°° 
Guid
°° 
.
°° 
TryParse
°° 
(
°° 
TerminalIdText
°° -
,
°°- .
out
°°/ 2
var
°°3 6

terminalId
°°7 A
)
°°A B
)
°°B C
{
°°D E
Error
°°F K
=
°°L M
$str
°°N c
;
°°c d
return
°°e k
;
°°k l
}
°°m n
if
±± 
(
±± 
!
±± 
Guid
±± 
.
±± 
TryParse
±± 
(
±± 
ShiftIdText
±± *
,
±±* +
out
±±, /
var
±±0 3
shiftId
±±4 ;
)
±±; <
)
±±< =
{
±±> ?
Error
±±@ E
=
±±F G
$str
±±H Z
;
±±Z [
return
±±\ b
;
±±b c
}
±±d e
if
²² 
(
²² 
!
²² 
decimal
²² 
.
²² 
TryParse
²² !
(
²²! " 
OpeningBalanceText
²²" 4
,
²²4 5
out
²²6 9
var
²²: =
openingBalance
²²> L
)
²²L M
)
²²M N
{
²²O P
Error
²²Q V
=
²²W X
$str
²²Y s
;
²²s t
return
²²u {
;
²²{ |
}
²²} ~
await
´´ 
_open
´´ 
.
´´ 
HandleAsync
´´ #
(
´´# $
new
´´$ '$
OpenCashSessionCommand
´´( >
{
µµ 
UserId
¶¶ 
=
¶¶ 
new
¶¶ 
UserId
¶¶ #
(
¶¶# $
userId
¶¶$ *
)
¶¶* +
,
¶¶+ ,

TerminalId
·· 
=
·· 

terminalId
·· '
,
··' (
ShiftId
¸¸ 
=
¸¸ 
shiftId
¸¸ !
,
¸¸! "
OpeningBalance
¹¹ 
=
¹¹  
new
¹¹! $
Money
¹¹% *
(
¹¹* +
openingBalance
¹¹+ 9
)
¹¹9 :
}
ºº 
)
ºº 
;
ºº 
await
¼¼ 
RefreshAsync
¼¼ 
(
¼¼ 
)
¼¼  
;
¼¼  !
}
½½ 	
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾ 
{
¿¿ 	
Error
ÀÀ 
=
ÀÀ 
ex
ÀÀ 
.
ÀÀ 
Message
ÀÀ 
;
ÀÀ 
}
ÁÁ 	
finally
ÂÂ 
{
ÃÃ 	
IsBusy
ÄÄ 
=
ÄÄ 
false
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
}
ÆÆ 
private
ÈÈ 
async
ÈÈ 
Task
ÈÈ 

CloseAsync
ÈÈ !
(
ÈÈ! "
)
ÈÈ" #
{
ÉÉ 
Error
ÊÊ 
=
ÊÊ 
null
ÊÊ 
;
ÊÊ 
IsBusy
ËË 
=
ËË 
true
ËË 
;
ËË 
try
ÌÌ 
{
ÍÍ 	
if
ÎÎ 
(
ÎÎ 
Current
ÎÎ 
==
ÎÎ 
null
ÎÎ 
)
ÎÎ  
{
ÎÎ! "
Error
ÎÎ# (
=
ÎÎ) *
$str
ÎÎ+ B
;
ÎÎB C
return
ÎÎD J
;
ÎÎJ K
}
ÎÎL M
if
ÏÏ 
(
ÏÏ 
!
ÏÏ 
Guid
ÏÏ 
.
ÏÏ 
TryParse
ÏÏ 
(
ÏÏ 

UserIdText
ÏÏ )
,
ÏÏ) *
out
ÏÏ+ .
var
ÏÏ/ 2
userId
ÏÏ3 9
)
ÏÏ9 :
)
ÏÏ: ;
{
ÏÏ< =
Error
ÏÏ> C
=
ÏÏD E
$str
ÏÏF W
;
ÏÏW X
return
ÏÏY _
;
ÏÏ_ `
}
ÏÏa b
if
ÐÐ 
(
ÐÐ 
!
ÐÐ 
decimal
ÐÐ 
.
ÐÐ 
TryParse
ÐÐ !
(
ÐÐ! "
ActualCashText
ÐÐ" 0
,
ÐÐ0 1
out
ÐÐ2 5
var
ÐÐ6 9

actualCash
ÐÐ: D
)
ÐÐD E
)
ÐÐE F
{
ÐÐG H
Error
ÐÐI N
=
ÐÐO P
$str
ÐÐQ g
;
ÐÐg h
return
ÐÐi o
;
ÐÐo p
}
ÐÐq r
await
ÒÒ 
_close
ÒÒ 
.
ÒÒ 
HandleAsync
ÒÒ $
(
ÒÒ$ %
new
ÒÒ% (%
CloseCashSessionCommand
ÒÒ) @
{
ÓÓ 
CashSessionId
ÔÔ 
=
ÔÔ 
Current
ÔÔ  '
.
ÔÔ' (
Id
ÔÔ( *
,
ÔÔ* +
ClosedBy
ÕÕ 
=
ÕÕ 
new
ÕÕ 
UserId
ÕÕ %
(
ÕÕ% &
userId
ÕÕ& ,
)
ÕÕ, -
,
ÕÕ- .

ActualCash
ÖÖ 
=
ÖÖ 
new
ÖÖ  
Money
ÖÖ! &
(
ÖÖ& '

actualCash
ÖÖ' 1
)
ÖÖ1 2
}
×× 
)
×× 
;
×× 
await
ÙÙ 
RefreshAsync
ÙÙ 
(
ÙÙ 
)
ÙÙ  
;
ÙÙ  !
}
ÚÚ 	
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ 
{
ÜÜ 	
Error
ÝÝ 
=
ÝÝ 
ex
ÝÝ 
.
ÝÝ 
Message
ÝÝ 
;
ÝÝ 
}
ÞÞ 	
finally
ßß 
{
àà 	
IsBusy
áá 
=
áá 
false
áá 
;
áá 
}
ââ 	
}
ãã 
}ää Ùr
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\CashDropManagementViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
class '
CashDropManagementViewModel (
:) *
ViewModelBase+ 8
{ 
private 
readonly "
ICashSessionRepository +"
_cashSessionRepository, B
;B C
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly 
ISecurityService %
_securityService& 6
;6 7
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private  
ObservableCollection  
<  ! 
CashTransactionUiDto! 5
>5 6
_transactions7 D
=E F
newG J
(J K
)K L
;L M
public 
 
ObservableCollection 
<   
CashTransactionUiDto  4
>4 5
Transactions6 B
{ 
get 
=> 
_transactions 
; 
set 
=> 
SetProperty 
( 
ref 
_transactions ,
,, -
value. 3
)3 4
;4 5
} 
private  
CashTransactionUiDto  
?  ! 
_selectedTransaction" 6
;6 7
public   
 
CashTransactionUiDto   
?    
SelectedTransaction  ! 4
{!! 
get"" 
=>""  
_selectedTransaction"" #
;""# $
set## 
{$$ 	
if%% 
(%% 
SetProperty%% 
(%% 
ref%%  
_selectedTransaction%%  4
,%%4 5
value%%6 ;
)%%; <
)%%< =
{&& 
('' 
('' 
AsyncRelayCommand'' #
)''# $
DeleteCommand''$ 1
)''1 2
.''2 3#
NotifyCanExecuteChanged''3 J
(''J K
)''K L
;''L M
}(( 
})) 	
}** 
public,, 

ICommand,, 
AddCashDropCommand,, &
{,,' (
get,,) ,
;,,, -
},,. /
public-- 

ICommand-- !
AddDrawerBleedCommand-- )
{--* +
get--, /
;--/ 0
}--1 2
public.. 

ICommand.. 
DeleteCommand.. !
{.." #
get..$ '
;..' (
}..) *
public// 

ICommand// 
CloseCommand//  
{//! "
get//# &
;//& '
}//( )
public11 
'
CashDropManagementViewModel11 &
(11& '"
ICashSessionRepository22 !
cashSessionRepository22 4
,224 5
NavigationService33 
navigationService33 +
,33+ ,
ISecurityService44 
securityService44 (
,44( )
IUserService55 
userService55  
,55  !
ITerminalContext66 
terminalContext66 (
)66( )
{77 "
_cashSessionRepository88 
=88  !
cashSessionRepository88! 6
;886 7
_navigationService99 
=99 
navigationService99 .
;99. /
_securityService:: 
=:: 
securityService:: *
;::* +
_userService;; 
=;; 
userService;; "
;;;" #
_terminalContext<< 
=<< 
terminalContext<< *
;<<* +
AddCashDropCommand>> 
=>> 
new>>  
AsyncRelayCommand>>! 2
(>>2 3
AddCashDropAsync>>3 C
)>>C D
;>>D E!
AddDrawerBleedCommand?? 
=?? 
new??  #
AsyncRelayCommand??$ 5
(??5 6
AddDrawerBleedAsync??6 I
)??I J
;??J K
DeleteCommand@@ 
=@@ 
new@@ 
AsyncRelayCommand@@ -
(@@- ."
DeleteTransactionAsync@@. D
,@@D E
(@@F G
)@@G H
=>@@I K
SelectedTransaction@@L _
!=@@` b
null@@c g
)@@g h
;@@h i
CloseCommandAA 
=AA 
newAA 
RelayCommandAA '
(AA' (
CloseAA( -
)AA- .
;AA. /
_DD 	
=DD
 !
LoadTransactionsAsyncDD !
(DD! "
)DD" #
;DD# $
}EE 
privateGG 
asyncGG 
TaskGG !
LoadTransactionsAsyncGG ,
(GG, -
)GG- .
{HH 
ifII 

(II 
_terminalContextII 
.II 

TerminalIdII '
==II( *
nullII+ /
)II/ 0
{JJ 	
returnKK 
;KK 
}LL 	
varNN 

terminalIdNN 
=NN 
_terminalContextNN )
.NN) *

TerminalIdNN* 4
.NN4 5
ValueNN5 :
;NN: ;
varOO 
sessionOO 
=OO 
awaitOO "
_cashSessionRepositoryOO 2
.OO2 3+
GetOpenSessionByTerminalIdAsyncOO3 R
(OOR S

terminalIdOOS ]
)OO] ^
;OO^ _
ifQQ 

(QQ 
sessionQQ 
!=QQ 
nullQQ 
)QQ 
{RR 	
varSS 
dropsSS 
=SS 
sessionSS 
.SS  
	CashDropsSS  )
.SS) *
SelectSS* 0
(SS0 1
dSS1 2
=>SS3 5
newSS6 9 
CashTransactionUiDtoSS: N
{TT 
IdUU 
=UU 
dUU 
.UU 
IdUU 
,UU 
ProcessedAtVV 
=VV 
dVV 
.VV  
ProcessedAtVV  +
,VV+ ,
AmountWW 
=WW 
dWW 
.WW 
AmountWW !
.WW! "
AmountWW" (
,WW( )
ReasonXX 
=XX 
dXX 
.XX 
ReasonXX !
,XX! "
TypeYY 
=YY 
$strYY 
,YY 
ProcessedByZZ 
=ZZ 
dZZ 
.ZZ  
ProcessedByZZ  +
.ZZ+ ,
ValueZZ, 1
.ZZ1 2
ToStringZZ2 :
(ZZ: ;
)ZZ; <
}[[ 
)[[ 
;[[ 
var]] 
bleeds]] 
=]] 
session]]  
.]]  !
DrawerBleeds]]! -
.]]- .
Select]]. 4
(]]4 5
b]]5 6
=>]]7 9
new]]: = 
CashTransactionUiDto]]> R
{^^ 
Id__ 
=__ 
b__ 
.__ 
Id__ 
,__ 
ProcessedAt`` 
=`` 
b`` 
.``  
ProcessedAt``  +
,``+ ,
Amountaa 
=aa 
baa 
.aa 
Amountaa !
.aa! "
Amountaa" (
,aa( )
Reasonbb 
=bb 
bbb 
.bb 
Reasonbb !
,bb! "
Typecc 
=cc 
$strcc 
,cc 
ProcessedBydd 
=dd 
bdd 
.dd  
ProcessedBydd  +
.dd+ ,
Valuedd, 1
.dd1 2
ToStringdd2 :
(dd: ;
)dd; <
}ee 
)ee 
;ee 
vargg 
allgg 
=gg 
dropsgg 
.gg 
Concatgg "
(gg" #
bleedsgg# )
)gg) *
.gg* +
OrderByDescendinggg+ <
(gg< =
xgg= >
=>gg? A
xggB C
.ggC D
ProcessedAtggD O
)ggO P
;ggP Q
Transactionshh 
=hh 
newhh  
ObservableCollectionhh 3
<hh3 4 
CashTransactionUiDtohh4 H
>hhH I
(hhI J
allhhJ M
)hhM N
;hhN O
}ii 	
}jj 
privatell 
asyncll 
Taskll 
AddCashDropAsyncll '
(ll' (
)ll( )
{mm 
awaitnn '
PerformDrawerOperationAsyncnn )
(nn) *
isBleednn* 1
:nn1 2
falsenn3 8
)nn8 9
;nn9 :
}oo 
privateqq 
asyncqq 
Taskqq 
AddDrawerBleedAsyncqq *
(qq* +
)qq+ ,
{rr 
awaitss '
PerformDrawerOperationAsyncss )
(ss) *
isBleedss* 1
:ss1 2
truess3 7
)ss7 8
;ss8 9
}tt 
privatevv 
asyncvv 
Taskvv '
PerformDrawerOperationAsyncvv 2
(vv2 3
boolvv3 7
isBleedvv8 ?
)vv? @
{ww 
stringxx 
titlexx 
=xx 
isBleedxx 
?xx  
$strxx! 3
:xx4 5
$strxx6 E
;xxE F
stringyy 
messageyy 
=yy 
isBleedyy  
?yy! "
$stryy# ;
:yy< =
$stryy> U
;yyU V
var{{ 
dialog{{ 
={{ 
new{{ 
Magidesk{{ !
.{{! "
Presentation{{" .
.{{. /
Views{{/ 4
.{{4 5
CashEntryDialog{{5 D
({{D E
title{{E J
,{{J K
message{{L S
){{S T
;{{T U
dialog|| 
.|| 
XamlRoot|| 
=|| 
App|| 
.|| 
MainWindowInstance|| 0
.||0 1
Content||1 8
.||8 9
XamlRoot||9 A
;||A B
var}} 
result}} 
=}} 
await}} 
_navigationService}} -
.}}- .
ShowDialogAsync}}. =
(}}= >
dialog}}> D
)}}D E
;}}E F
if 

( 
result 
== 
ContentDialogResult )
.) *
Primary* 1
)1 2
{
€€ 	
if
 
(
 
_terminalContext
  
.
  !

TerminalId
! +
==
, .
null
/ 3
||
4 6
_userService
7 C
.
C D
CurrentUser
D O
?
O P
.
P Q
Id
Q S
==
T V
null
W [
)
[ \
{
‚‚ 
return
ƒƒ 
;
ƒƒ 
}
„„ 
var
†† 

terminalId
†† 
=
†† 
_terminalContext
†† -
.
††- .

TerminalId
††. 8
.
††8 9
Value
††9 >
;
††> ?
var
‡‡ 
userId
‡‡ 
=
‡‡ 
_userService
‡‡ %
.
‡‡% &
CurrentUser
‡‡& 1
.
‡‡1 2
Id
‡‡2 4
;
‡‡4 5
var
ˆˆ 
amount
ˆˆ 
=
ˆˆ 
new
ˆˆ 
Magidesk
ˆˆ %
.
ˆˆ% &
Domain
ˆˆ& ,
.
ˆˆ, -
ValueObjects
ˆˆ- 9
.
ˆˆ9 :
Money
ˆˆ: ?
(
ˆˆ? @
dialog
ˆˆ@ F
.
ˆˆF G
Amount
ˆˆG M
)
ˆˆM N
;
ˆˆN O
var
‰‰ 
reason
‰‰ 
=
‰‰ 
dialog
‰‰ 
.
‰‰  
Reason
‰‰  &
;
‰‰& '
var
‹‹ 
session
‹‹ 
=
‹‹ 
await
‹‹ $
_cashSessionRepository
‹‹  6
.
‹‹6 7-
GetOpenSessionByTerminalIdAsync
‹‹7 V
(
‹‹V W

terminalId
‹‹W a
)
‹‹a b
;
‹‹b c
if
ŒŒ 
(
ŒŒ 
session
ŒŒ 
!=
ŒŒ 
null
ŒŒ 
)
ŒŒ  
{
 
if
ŽŽ 
(
ŽŽ 
isBleed
ŽŽ 
)
ŽŽ 
{
 
var
 
bleed
 
=
 
DrawerBleed
  +
.
+ ,
Create
, 2
(
2 3
session
3 :
.
: ;
Id
; =
,
= >
amount
? E
,
E F
userId
G M
,
M N
reason
O U
)
U V
;
V W
session
‘‘ 
.
‘‘ 
AddDrawerBleed
‘‘ *
(
‘‘* +
bleed
‘‘+ 0
)
‘‘0 1
;
‘‘1 2
}
’’ 
else
““ 
{
”” 
var
•• 
drop
•• 
=
•• 
CashDrop
•• '
.
••' (
Create
••( .
(
••. /
session
••/ 6
.
••6 7
Id
••7 9
,
••9 :
amount
••; A
,
••A B
userId
••C I
,
••I J
reason
••K Q
)
••Q R
;
••R S
session
–– 
.
–– 
AddCashDrop
–– '
(
––' (
drop
––( ,
)
––, -
;
––- .
}
—— 
await
™™ $
_cashSessionRepository
™™ ,
.
™™, -
UpdateAsync
™™- 8
(
™™8 9
session
™™9 @
)
™™@ A
;
™™A B
await
šš #
LoadTransactionsAsync
šš +
(
šš+ ,
)
šš, -
;
šš- .
}
›› 
}
œœ 	
}
 
private
ŸŸ 
async
ŸŸ 
Task
ŸŸ $
DeleteTransactionAsync
ŸŸ -
(
ŸŸ- .
)
ŸŸ. /
{
   
if
§§ 

(
§§ !
SelectedTransaction
§§ 
==
§§  "
null
§§# '
)
§§' (
return
§§) /
;
§§/ 0
var
ªª 
dialog
ªª 
=
ªª 
new
ªª 
ContentDialog
ªª &
{
«« 	
Title
¬¬ 
=
¬¬ 
$str
¬¬ %
,
¬¬% &
Content
­­ 
=
­­ 
$str
­­ U
,
­­U V
CloseButtonText
®® 
=
®® 
$str
®® "
,
®®" #
XamlRoot
¯¯ 
=
¯¯ 
App
¯¯ 
.
¯¯  
MainWindowInstance
¯¯ -
.
¯¯- .
Content
¯¯. 5
.
¯¯5 6
XamlRoot
¯¯6 >
}
°° 	
;
°°	 

await
±±  
_navigationService
±±  
.
±±  !
ShowDialogAsync
±±! 0
(
±±0 1
dialog
±±1 7
)
±±7 8
;
±±8 9
}
²² 
private
´´ 
void
´´ 
Close
´´ 
(
´´ 
)
´´ 
{
µµ 
}
¹¹ 
}ºº ·n
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\BackOfficeViewModel.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  

ViewModels		  *
;		* +
public 
partial 
class 
BackOfficeViewModel (
:) *
ViewModelBase+ 8
{ 
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
ISecurityService %
_securityService& 6
;6 7
private 
string 
_headerText 
=  
$str! .
;. /
private 
Type 
_currentPageType !
;! "
public 

string 

HeaderText 
{ 
get 
=> 
_headerText 
; 
set 
=> 
SetProperty 
( 
ref 
_headerText *
,* +
value, 1
)1 2
;2 3
} 
public 

Type 
CurrentPageType 
{ 
get 
=> 
_currentPageType 
;  
set 
=> 
SetProperty 
( 
ref 
_currentPageType /
,/ 0
value1 6
)6 7
;7 8
} 
public 

ICommand 
NavigateCommand #
{$ %
get& )
;) *
}+ ,
public   

ICommand   
GoBackCommand   !
{  " #
get  $ '
;  ' (
}  ) *
public!! 

ICommand!! 
CaptureBatchCommand!! '
{!!( )
get!!* -
;!!- .
}!!/ 0
public## 

BackOfficeViewModel## 
(## 
NavigationService$$ 
navigationService$$ +
,$$+ ,
IUserService%% 
userService%%  
,%%  !
ISecurityService&& 
securityService&& (
)&&( )
{'' 
_navigationService(( 
=(( 
navigationService(( .
;((. /
_userService)) 
=)) 
userService)) "
;))" #
_securityService** 
=** 
securityService** *
;*** +
Title++ 
=++ 
$str++ 
;++ 
NavigateCommand-- 
=-- 
new-- 
RelayCommand-- *
<--* +
NavigationItem--+ 9
>--9 :
(--: ;
Navigate--; C
)--C D
;--D E
GoBackCommand.. 
=.. 
new.. 
RelayCommand.. (
(..( )
GoBack..) /
)../ 0
;..0 1
CaptureBatchCommand// 
=// 
new// !
AsyncRelayCommand//" 3
(//3 4
CaptureBatchAsync//4 E
)//E F
;//F G
_11 	
=11
 $
LoadNavigationItemsAsync11 $
(11$ %
)11% &
;11& '
}22 
private44 
async44 
Task44 $
LoadNavigationItemsAsync44 /
(44/ 0
)440 1
{55 
NavigationItems66 
.66 
Clear66 
(66 
)66 
;66  
NavigationItems77 
.77 
Add77 
(77 
new77 
NavigationItem77  .
(77. /
$str77/ <
,77< =
$str77> ^
,77^ _
$str77` h
,77h i
typeof77j p
(77p q
MenuEditorPage77q 
)	77 €
)
77€ 
)
77 ‚
;
77‚ ƒ
NavigationItems88 
.88 
Add88 
(88 
new88 
NavigationItem88  .
(88. /
$str88/ :
,88: ;
$str88< W
,88W X
$str88Y a
,88a b
typeof88c i
(88i j
ModifierEditorPage88j |
)88| }
)88} ~
)88~ 
;	88 €
NavigationItems99 
.99 
Add99 
(99 
new99 
NavigationItem99  .
(99. /
$str99/ :
,99: ;
$str99< X
,99X Y
$str99Z b
,99b c
typeof99d j
(99j k
InventoryPage99k x
)99x y
)99y z
)99z {
;99{ |
NavigationItems:: 
.:: 
Add:: 
(:: 
new:: 
NavigationItem::  .
(::. /
$str::/ 8
,::8 9
$str::: O
,::O P
$str::Q Y
,::Y Z
typeof::[ a
(::a b
VendorsPage::b m
)::m n
)::n o
)::o p
;::p q
NavigationItems;; 
.;; 
Add;; 
(;; 
new;; 
NavigationItem;;  .
(;;. /
$str;;/ @
,;;@ A
$str;;B U
,;;U V
$str;;W _
,;;_ `
typeof;;a g
(;;g h
PurchaseOrdersPage;;h z
);;z {
);;{ |
);;| }
;;;} ~
NavigationItems<< 
.<< 
Add<< 
(<< 
new<< 
NavigationItem<<  .
(<<. /
$str<</ :
,<<: ;
$str<<< P
,<<P Q
$str<<R Z
,<<Z [
typeof<<\ b
(<<b c
TableMapPage<<c o
)<<o p
)<<p q
)<<q r
;<<r s
NavigationItems== 
.== 
Add== 
(== 
new== 
NavigationItem==  .
(==. /
$str==/ ?
,==? @
$str==A R
,==R S
$str==T \
,==\ ]
typeof==^ d
(==d e
TableExplorerPage==e v
)==v w
)==w x
)==x y
;==y z
if?? 

(?? 
_userService?? 
.?? 
CurrentUser?? $
!=??% '
null??( ,
)??, -
{@@ 	
varAA !
hasDesignerPermissionAA %
=AA& '
awaitAA( -
_securityServiceAA. >
.AA> ?
HasPermissionAsyncAA? Q
(AAQ R
newBB 
UserIdBB 
(BB 
_userServiceBB '
.BB' (
CurrentUserBB( 3
.BB3 4
IdBB4 6
)BB6 7
,BB7 8
UserPermissionCC 
.CC 
ManageTableLayoutCC 0
)CC0 1
;CC1 2
ifEE 
(EE !
hasDesignerPermissionEE %
)EE% &
{FF 
NavigationItemsGG 
.GG  
AddGG  #
(GG# $
newGG$ '
NavigationItemGG( 6
(GG6 7
$strGG7 G
,GGG H
$strGGI _
,GG_ `
$strGGa i
,GGi j
typeofGGk q
(GGq r
MagideskGGr z
.GGz {
Presentation	GG{ ‡
.
GG‡ ˆ
Views
GGˆ 
.
GG Ž
TableDesignerPage
GGŽ Ÿ
)
GGŸ  
)
GG  ¡
)
GG¡ ¢
;
GG¢ £
}HH 
}II 	
NavigationItemsKK 
.KK 
AddKK 
(KK 
newKK 
NavigationItemKK  .
(KK. /
$strKK/ 6
,KK6 7
$strKK8 T
,KKT U
$strKKV ^
,KK^ _
typeofKK` f
(KKf g
MagideskKKg o
.KKo p
PresentationKKp |
.KK| }
Views	KK} ‚
.
KK‚ ƒ 
UserManagementPage
KKƒ •
)
KK• –
)
KK– —
)
KK— ˜
;
KK˜ ™
NavigationItemsLL 
.LL 
AddLL 
(LL 
newLL 
NavigationItemLL  .
(LL. /
$strLL/ 6
,LL6 7
$strLL8 K
,LLK L
$strLLM U
,LLU V
typeofLLW ]
(LL] ^
MagideskLL^ f
.LLf g
PresentationLLg s
.LLs t
ViewsLLt y
.LLy z
RoleManagementPage	LLz Œ
)
LLŒ 
)
LL Ž
)
LLŽ 
;
LL 
NavigationItemsMM 
.MM 
AddMM 
(MM 
newMM 
NavigationItemMM  .
(MM. /
$strMM/ ?
,MM? @
$strMMA W
,MMW X
$strMMY a
,MMa b
typeofMMc i
(MMi j
MagideskMMj r
.MMr s
PresentationMMs 
.	MM €
Views
MM€ …
.
MM… †
DiscountTaxPage
MM† •
)
MM• –
)
MM– —
)
MM— ˜
;
MM˜ ™
NavigationItemsNN 
.NN 
AddNN 
(NN 
newNN 
NavigationItemNN  .
(NN. /
$strNN/ <
,NN< =
$strNN> W
,NNW X
$strNNY a
,NNa b
typeofNNc i
(NNi j!
OrderTypeExplorerPageNNj 
)	NN €
)
NN€ 
)
NN ‚
;
NN‚ ƒ
NavigationItemsOO 
.OO 
AddOO 
(OO 
newOO 
NavigationItemOO  .
(OO. /
$strOO/ 7
,OO7 8
$strOO9 S
,OOS T
$strOOU ]
,OO] ^
typeofOO_ e
(OOe f
ShiftExplorerPageOOf w
)OOw x
)OOx y
)OOy z
;OOz {
NavigationItemsPP 
.PP 
AddPP 
(PP 
newPP 
NavigationItemPP  .
(PP. /
$strPP/ 8
,PP8 9
$strPP: K
,PPK L
$strPPM U
,PPU V
typeofPPW ]
(PP] ^
SalesReportsPagePP^ n
)PPn o
)PPo p
)PPp q
;PPq r
NavigationItemsQQ 
.QQ 
AddQQ 
(QQ 
newQQ 
NavigationItemQQ  .
(QQ. /
$strQQ/ A
,QQA B
$strQQC \
,QQ\ ]
$strQQ^ f
,QQf g
typeofQQh n
(QQn o
SettingsPageQQo {
)QQ{ |
)QQ| }
)QQ} ~
;QQ~ 
NavigationItemsRR 
.RR 
AddRR 
(RR 
newRR 
NavigationItemRR  .
(RR. /
$strRR/ B
,RRB C
$strRRD _
,RR_ `
$strRRa i
,RRi j
typeofRRk q
(RRq r
SystemConfigPage	RRr ‚
)
RR‚ ƒ
)
RRƒ „
)
RR„ …
;
RR… †
NavigationItemsSS 
.SS 
AddSS 
(SS 
newSS 
NavigationItemSS  .
(SS. /
$strSS/ @
,SS@ A
$strSSB \
,SS\ ]
$strSS^ f
,SSf g
typeofSSh n
(SSn o
MagideskSSo w
.SSw x
Presentation	SSx „
.
SS„ …
Views
SS… Š
.
SSŠ ‹ 
PrintTemplatesPage
SS‹ 
)
SS ž
)
SSž Ÿ
)
SSŸ  
;
SS  ¡
}TT 
privateVV 
asyncVV 
TaskVV 
CaptureBatchAsyncVV (
(VV( )
)VV) *
{WW 
varXX 
dialogXX 
=XX 
newXX 
MagideskXX !
.XX! "
ViewsXX" '
.XX' (+
AuthorizationCaptureBatchDialogXX( G
(XXG H
)XXH I
;XXI J
awaitYY 
_navigationServiceYY  
.YY  !
ShowDialogAsyncYY! 0
(YY0 1
dialogYY1 7
)YY7 8
;YY8 9
}ZZ 
public\\ 
 
ObservableCollection\\ 
<\\  
NavigationItem\\  .
>\\. /
NavigationItems\\0 ?
{\\@ A
get\\B E
;\\E F
}\\G H
=\\I J
new\\K N
(\\N O
)\\O P
;\\P Q
private^^ 
void^^ 
Navigate^^ 
(^^ 
NavigationItem^^ (
?^^( )
item^^* .
)^^. /
{__ 
if`` 

(`` 
item`` 
==`` 
null`` 
)`` 
return``  
;``  !

HeaderTextbb 
=bb 
itembb 
.bb 
Titlebb 
;bb  
ifcc 

(cc 
itemcc 
.cc 
PageTypecc 
!=cc 
typeofcc #
(cc# $
objectcc$ *
)cc* +
)cc+ ,
{dd 	
CurrentPageTypeee 
=ee 
itemee "
.ee" #
PageTypeee# +
;ee+ ,
}ff 	
}gg 
privateii 
voidii 
GoBackii 
(ii 
)ii 
{jj 
_navigationServicekk 
.kk 
GoBackkk !
(kk! "
)kk" #
;kk# $
}ll 
}mm 
publicoo 
classoo 
NavigationItemoo 
{pp 
publicqq 

stringqq 
Titleqq 
{qq 
getqq 
;qq 
}qq  
publicrr 

stringrr 
Descriptionrr 
{rr 
getrr  #
;rr# $
}rr% &
publicss 

stringss 
IconDatass 
{ss 
getss  
;ss  !
}ss" #
publictt 

Typett 
PageTypett 
{tt 
gettt 
;tt 
}tt  !
publicvv 

NavigationItemvv 
(vv 
stringvv  
titlevv! &
,vv& '
stringvv( .
descriptionvv/ :
,vv: ;
stringvv< B
iconDatavvC K
,vvK L
TypevvM Q
pageTypevvR Z
)vvZ [
{ww 
Titlexx 
=xx 
titlexx 
;xx 
Descriptionyy 
=yy 
descriptionyy !
;yy! "
IconDatazz 
=zz 
iconDatazz 
;zz 
PageType{{ 
={{ 
pageType{{ 
;{{ 
}|| 
}}} ¸
nC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\AuthorizationCodeViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
{ 
public 

partial 
class &
AuthorizationCodeViewModel 3
:4 5
ViewModelBase6 C
{ 
private		 
string		 
	_authCode		  
=		! "
string		# )
.		) *
Empty		* /
;		/ 0
public

 
string

 
AuthCode

 
{ 	
get 
=> 
	_authCode 
; 
set 
=> 
SetProperty 
( 
ref "
	_authCode# ,
,, -
value. 3
)3 4
;4 5
} 	
private 
string 
_selectedCardType (
=) *
$str+ 1
;1 2
public 
string 
SelectedCardType &
{ 	
get 
=> 
_selectedCardType $
;$ %
set 
=> 
SetProperty 
( 
ref "
_selectedCardType# 4
,4 5
value6 ;
); <
;< =
} 	
public &
AuthorizationCodeViewModel )
() *
)* +
{ 	
Title 
= 
$str .
;. /
} 	
} 
} Ì9
vC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\ViewModels\AuthorizationCaptureBatchViewModel.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

ViewModels  *
;* +
public 
partial 
class .
"AuthorizationCaptureBatchViewModel 7
:8 9
ViewModelBase: G
{		 
private

 
bool

 
_isProcessing

 
;

 
public 

bool 
IsProcessing 
{ 
get 
=> 
_isProcessing 
; 
set 
=> 
SetProperty 
( 
ref 
_isProcessing ,
,, -
value. 3
)3 4
;4 5
} 
private 
bool 
_isFinished 
; 
public 

bool 

IsFinished 
{ 
get 
=> 
_isFinished 
; 
set 
{ 	
if 
( 
SetProperty 
( 
ref 
_isFinished  +
,+ ,
value- 2
)2 3
)3 4
{ 
OnPropertyChanged !
(! "
nameof" (
(( )
CanClose) 1
)1 2
)2 3
;3 4
CloseCommand 
. #
NotifyCanExecuteChanged 4
(4 5
)5 6
;6 7
} 
} 	
} 
private 
string 
_statusMessage !
=" #
$str$ C
;C D
public   

string   
StatusMessage   
{!! 
get"" 
=>"" 
_statusMessage"" 
;"" 
set## 
=>## 
SetProperty## 
(## 
ref## 
_statusMessage## -
,##- .
value##/ 4
)##4 5
;##5 6
}$$ 
private&& 
double&& 
_progressValue&& !
;&&! "
public'' 

double'' 
ProgressValue'' 
{(( 
get)) 
=>)) 
_progressValue)) 
;)) 
set** 
=>** 
SetProperty** 
(** 
ref** 
_progressValue** -
,**- .
value**/ 4
)**4 5
;**5 6
}++ 
private-- 
bool-- 
_isIndeterminate-- !
=--" #
false--$ )
;--) *
public.. 

bool.. 
IsIndeterminate.. 
{// 
get00 
=>00 
_isIndeterminate00 
;00  
set11 
=>11 
SetProperty11 
(11 
ref11 
_isIndeterminate11 /
,11/ 0
value111 6
)116 7
;117 8
}22 
public44 
 
ObservableCollection44 
<44  
string44  &
>44& '

LogEntries44( 2
{443 4
get445 8
;448 9
}44: ;
=44< =
new44> A 
ObservableCollection44B V
<44V W
string44W ]
>44] ^
(44^ _
)44_ `
;44` a
public66 
.
"AuthorizationCaptureBatchViewModel66 -
(66- .
)66. /
{77 
Title88 
=88 
$str88 -
;88- .
}99 
[;; 
RelayCommand;; 
];; 
private<< 
async<< 
Task<< 
StartBatchAsync<< &
(<<& '
)<<' (
{== 
if>> 

(>> 
IsProcessing>> 
||>> 

IsFinished>> &
)>>& '
return>>( .
;>>. /
IsProcessing@@ 
=@@ 
true@@ 
;@@ 

IsFinishedAA 
=AA 
falseAA 
;AA 
ProgressValueBB 
=BB 
$numBB 
;BB 

LogEntriesCC 
.CC 
ClearCC 
(CC 
)CC 
;CC 
StatusMessageDD 
=DD 
$strDD /
;DD/ 0
AddLogFF 
(FF 
$strFF *
)FF* +
;FF+ ,
awaitII 
TaskII 
.II 
DelayII 
(II 
$numII 
)II 
;II 
varJJ !
transactionsToCaptureJJ !
=JJ" #
newJJ$ '
[JJ' (
]JJ( )
{JJ* +
$strJJ, 5
,JJ5 6
$strJJ7 @
,JJ@ A
$strJJB K
,JJK L
$strJJM V
,JJV W
$strJJX a
}JJb c
;JJc d
IsIndeterminateLL 
=LL 
falseLL 
;LL  
doubleMM 
stepMM 
=MM 
$numMM 
/MM !
transactionsToCaptureMM 3
.MM3 4
LengthMM4 :
;MM: ;
foreachOO 
(OO 
varOO 
txIdOO 
inOO !
transactionsToCaptureOO 2
)OO2 3
{PP 	
StatusMessageQQ 
=QQ 
$"QQ 
$strQQ )
{QQ) *
txIdQQ* .
}QQ. /
$strQQ/ 2
"QQ2 3
;QQ3 4
AddLogRR 
(RR 
$"RR 
$strRR (
{RR( )
txIdRR) -
}RR- .
$strRR. 1
"RR1 2
)RR2 3
;RR3 4
awaitUU 
TaskUU 
.UU 
DelayUU 
(UU 
$numUU !
)UU! "
;UU" #
AddLogWW 
(WW 
$"WW 
$strWW 
{WW 
txIdWW #
}WW# $
$strWW$ .
"WW. /
)WW/ 0
;WW0 1
ProgressValueXX 
+=XX 
stepXX !
;XX! "
}YY 	
StatusMessage[[ 
=[[ 
$str[[ )
;[[) *
AddLog\\ 
(\\ 
$str\\ (
)\\( )
;\\) *
IsProcessing]] 
=]] 
false]] 
;]] 

IsFinished^^ 
=^^ 
true^^ 
;^^ 
ProgressValue__ 
=__ 
$num__ 
;__ 
}`` 
[bb 
RelayCommandbb 
(bb 

CanExecutebb 
=bb 
nameofbb %
(bb% &
CanClosebb& .
)bb. /
)bb/ 0
]bb0 1
privatecc 
voidcc 
Closecc 
(cc 
)cc 
{dd 
}ii 
privatekk 
boolkk 
CanClosekk 
(kk 
)kk 
=>kk 

IsFinishedkk )
;kk) *
privatemm 
voidmm 
AddLogmm 
(mm 
stringmm 
messagemm &
)mm& '
{nn 

LogEntriesoo 
.oo 
Addoo 
(oo 
$"oo 
$stroo 
{oo 
Systemoo !
.oo! "
DateTimeoo" *
.oo* +
Nowoo+ .
:oo. /
$stroo/ 7
}oo7 8
$stroo8 :
{oo: ;
messageoo; B
}ooB C
"ooC D
)ooD E
;ooE F
}pp 
}qq ¸O
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\WindowsDialogService.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Services  (
;( )
public 
class  
WindowsDialogService !
:" #
IDialogService$ 2
{ 
private 
readonly 
NavigationService &
_navigationService' 9
;9 :
public 
 
WindowsDialogService 
(  
NavigationService  1
navigationService2 C
)C D
{ 
_navigationService 
= 
navigationService .
;. /
} 
public 

async 
Task 
ShowErrorAsync $
($ %
string% +
title, 1
,1 2
string3 9
message: A
,A B
stringC I
?I J
exceptionDetailsK [
=\ ]
null^ b
)b c
{ 
await #
ShowDialogInternalAsync %
(% &
title& +
,+ ,
message- 4
,4 5
$str6 :
,: ;
null< @
,@ A
ContentDialogButtonB U
.U V
PrimaryV ]
,] ^
exceptionDetails_ o
)o p
;p q
} 
public 

async 
Task 
ShowWarningAsync &
(& '
string' -
title. 3
,3 4
string5 ;
message< C
)C D
{ 
await #
ShowDialogInternalAsync %
(% &
title& +
,+ ,
message- 4
,4 5
$str6 :
,: ;
null< @
,@ A
ContentDialogButtonB U
.U V
PrimaryV ]
)] ^
;^ _
} 
public   

async   
Task   
ShowMessageAsync   &
(  & '
string  ' -
title  . 3
,  3 4
string  5 ;
message  < C
)  C D
{!! 
await"" #
ShowDialogInternalAsync"" %
(""% &
title""& +
,""+ ,
message""- 4
,""4 5
$str""6 :
,"": ;
null""< @
,""@ A
ContentDialogButton""B U
.""U V
Primary""V ]
)""] ^
;""^ _
}## 
public%% 

async%% 
Task%% 
<%% 
bool%% 
>%% !
ShowConfirmationAsync%% 1
(%%1 2
string%%2 8
title%%9 >
,%%> ?
string%%@ F
message%%G N
,%%N O
string%%P V
yesText%%W ^
=%%_ `
$str%%a f
,%%f g
string%%h n
noText%%o u
=%%v w
$str%%x |
)%%| }
{&& 
var'' 
result'' 
='' 
await'' #
ShowDialogInternalAsync'' 2
(''2 3
title''3 8
,''8 9
message'': A
,''A B
yesText''C J
,''J K
noText''L R
,''R S
ContentDialogButton''T g
.''g h
Primary''h o
)''o p
;''p q
return(( 
result(( 
==(( 
ContentDialogResult(( ,
.((, -
Primary((- 4
;((4 5
})) 
private++ 
async++ 
Task++ 
<++ 
ContentDialogResult++ *
>++* +#
ShowDialogInternalAsync++, C
(++C D
string,, 
title,, 
,,, 
string-- 
message-- 
,-- 
string.. 
primaryBtnText.. 
,.. 
string// 
?// 
secondaryBtnText//  
,//  !
ContentDialogButton00 

defaultBtn00 &
,00& '
string11 
?11 
expandableContent11 !
=11" #
null11$ (
)11( )
{22 
if44 

(44 
_navigationService44 
.44 
DispatcherQueue44 .
!=44/ 1
null442 6
&&447 9
!44: ;
_navigationService44; M
.44M N
DispatcherQueue44N ]
.44] ^
HasThreadAccess44^ m
)44m n
{55 	
var66 
tcs66 
=66 
new66  
TaskCompletionSource66 .
<66. /
ContentDialogResult66/ B
>66B C
(66C D
)66D E
;66E F
_navigationService77 
.77 
DispatcherQueue77 .
.77. /

TryEnqueue77/ 9
(779 :
async77: ?
(77@ A
)77A B
=>77C E
{88 
try99 
{:: 
var;; 
res;; 
=;; 
await;; ##
ShowDialogInternalAsync;;$ ;
(;;; <
title;;< A
,;;A B
message;;C J
,;;J K
primaryBtnText;;L Z
,;;Z [
secondaryBtnText;;\ l
,;;l m

defaultBtn;;n x
,;;x y
expandableContent	;;z ‹
)
;;‹ Œ
;
;;Œ 
tcs<< 
.<< 
	SetResult<< !
(<<! "
res<<" %
)<<% &
;<<& '
}== 
catch>> 
(>> 
	Exception>>  
ex>>! #
)>># $
{?? 
tcs@@ 
.@@ 
SetException@@ $
(@@$ %
ex@@% '
)@@' (
;@@( )
}AA 
}BB 
)BB 
;BB 
returnCC 
awaitCC 
tcsCC 
.CC 
TaskCC !
;CC! "
}DD 	
tryFF 
{GG 	
varHH 
dialogHH 
=HH 
newHH 
ContentDialogHH *
{II 
TitleJJ 
=JJ 
titleJJ 
,JJ 
ContentKK 
=KK 
CreateDialogContentKK -
(KK- .
messageKK. 5
,KK5 6
expandableContentKK7 H
)KKH I
,KKI J
PrimaryButtonTextLL !
=LL" #
primaryBtnTextLL$ 2
,LL2 3
SecondaryButtonTextMM #
=MM$ %
secondaryBtnTextMM& 6
??MM7 9
stringMM: @
.MM@ A
EmptyMMA F
,MMF G
DefaultButtonNN 
=NN 

defaultBtnNN  *
}OO 
;OO 
returnWW 
awaitWW 
_navigationServiceWW +
.WW+ ,
ShowDialogAsyncWW, ;
(WW; <
dialogWW< B
)WWB C
;WWC D
}XX 	
catchYY 
(YY 
	ExceptionYY 
exYY 
)YY 
{ZZ 	
System\\ 
.\\ 
Diagnostics\\ 
.\\ 
Debug\\ $
.\\$ %
	WriteLine\\% .
(\\. /
$"\\/ 1
$str\\1 X
{\\X Y
title\\Y ^
}\\^ _
$str\\_ b
{\\b c
ex\\c e
}\\e f
"\\f g
)\\g h
;\\h i
return]] 
ContentDialogResult]] &
.]]& '
None]]' +
;]]+ ,
}^^ 	
}__ 
privateaa 
objectaa 
CreateDialogContentaa &
(aa& '
stringaa' -
messageaa. 5
,aa5 6
stringaa7 =
?aa= >
extraDetailsaa? K
)aaK L
{bb 
ifcc 

(cc 
stringcc 
.cc 
IsNullOrEmptycc  
(cc  !
extraDetailscc! -
)cc- .
)cc. /
{dd 	
returnee 
newee 
	TextBlockee  
{ee! "
Textee# '
=ee( )
messageee* 1
,ee1 2
TextWrappingee3 ?
=ee@ A
TextWrappingeeB N
.eeN O
WrapeeO S
,eeS T
MaxWidtheeU ]
=ee^ _
$numee` c
}eed e
;eee f
}ff 	
varhh 
sphh 
=hh 
newhh 

StackPanelhh 
{hh  !
Spacinghh" )
=hh* +
$numhh, .
,hh. /
MaxWidthhh0 8
=hh9 :
$numhh; >
}hh? @
;hh@ A
spii 

.ii
 
Childrenii 
.ii 
Addii 
(ii 
newii 
	TextBlockii %
{ii& '
Textii( ,
=ii- .
messageii/ 6
,ii6 7
TextWrappingii8 D
=iiE F
TextWrappingiiG S
.iiS T
WrapiiT X
}iiY Z
)iiZ [
;ii[ \
varkk 
expanderkk 
=kk 
newkk 
Expanderkk #
{ll 	
Headermm 
=mm 
$strmm (
,mm( )
Contentnn 
=nn 
newnn 
ScrollViewernn &
{oo 
Contentpp 
=pp 
newpp 
	TextBlockpp '
{pp( )
Textpp* .
=pp/ 0
extraDetailspp1 =
,pp= >
TextWrappingpp? K
=ppL M
TextWrappingppN Z
.ppZ [
Wrappp[ _
,pp_ `
FontSizeppa i
=ppj k
$numppl n
,ppn o

FontFamilyppp z
=pp{ |
new	pp} €
	Microsoft
pp Š
.
ppŠ ‹
UI
pp‹ 
.
pp Ž
Xaml
ppŽ ’
.
pp’ “
Media
pp“ ˜
.
pp˜ ™

FontFamily
pp™ £
(
pp£ ¤
$str
pp¤ ®
)
pp® ¯
}
pp° ±
,
pp± ²
	MaxHeightqq 
=qq 
$numqq 
,qq  '
VerticalScrollBarVisibilityrr +
=rr, -
ScrollBarVisibilityrr. A
.rrA B
AutorrB F
}ss 
}tt 	
;tt	 

spuu 

.uu
 
Childrenuu 
.uu 
Adduu 
(uu 
expanderuu  
)uu  !
;uu! "
returnww 
spww 
;ww 
}xx 
}yy ó	
]C:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\UserService.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Services  (
;( )
public 
class 
UserService 
: 
IUserService '
{ 
private 
UserDto 
? 
_currentUser !
;! "
public

 

UserDto

 
?

 
CurrentUser

 
{ 
get 
=> 
_currentUser 
; 
set 
{ 	
if 
( 
_currentUser 
!= 
value  %
)% &
{ 
_currentUser 
= 
value $
;$ %
UserChanged 
? 
. 
Invoke #
(# $
this$ (
,( )
_currentUser* 6
)6 7
;7 8
} 
} 	
} 
public 

event 
EventHandler 
< 
UserDto %
?% &
>& '
?' (
UserChanged) 4
;4 5
} Ò
aC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\TerminalContext.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Services  (
;( )
public 
sealed 
class 
TerminalContext #
:$ %
ITerminalContext& 6
{		 
public

 

string

 
?

 
TerminalIdentity

 #
{

$ %
get

& )
;

) *
private

+ 2
set

3 6
;

6 7
}

8 9
public 

Guid 
? 

TerminalId 
{ 
get !
;! "
private# *
set+ .
;. /
}0 1
public 

void 
SetTerminalIdentity #
(# $
string$ *
terminalIdentity+ ;
,; <
Guid= A

terminalIdB L
)L M
{ 
if 

( 
string 
. 
IsNullOrWhiteSpace %
(% &
terminalIdentity& 6
)6 7
)7 8
{ 	
throw 
new 
ArgumentException '
(' (
$str( H
,H I
nameofJ P
(P Q
terminalIdentityQ a
)a b
)b c
;c d
} 	
TerminalIdentity 
= 
terminalIdentity +
;+ ,

TerminalId 
= 

terminalId 
;  
} 
} à
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\SwitchboardDialogService.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Services  (
{		 
public

 

class

 $
SwitchboardDialogService

 )
:

* +%
ISwitchboardDialogService

, E
{ 
private 
readonly 
NavigationService *
_navigationService+ =
;= >
public $
SwitchboardDialogService '
(' (
NavigationService( 9
navigationService: K
)K L
{ 	
_navigationService 
=  
navigationService! 2
;2 3
} 	
public 
async 
Task '
ShowOrderTypeSelectionAsync 5
(5 6'
OrderTypeSelectionViewModel6 Q
	viewModelR [
)[ \
{ 	
var 
dialog 
= 
new $
OrderTypeSelectionDialog 5
(5 6
	viewModel6 ?
)? @
;@ A
if 
( 
App 
. 
MainWindowInstance &
?& '
.' (
Content( /
?/ 0
.0 1
XamlRoot1 9
!=: <
null= A
)A B
{ 
dialog 
. 
XamlRoot 
=  !
App" %
.% &
MainWindowInstance& 8
.8 9
Content9 @
.@ A
XamlRootA I
;I J
await 
_navigationService (
.( )
ShowDialogAsync) 8
(8 9
dialog9 ?
)? @
;@ A
} 
} 	
public 
async 
Task 
ShowGuestCountAsync -
(- .
GuestCountViewModel. A
	viewModelB K
)K L
{ 	
var 
dialog 
= 
new 
GuestCountDialog -
(- .
	viewModel. 7
)7 8
;8 9
if   
(   
App   
.   
MainWindowInstance   &
?  & '
.  ' (
Content  ( /
?  / 0
.  0 1
XamlRoot  1 9
!=  : <
null  = A
)  A B
{!! 
dialog"" 
."" 
XamlRoot"" 
=""  !
App""" %
.""% &
MainWindowInstance""& 8
.""8 9
Content""9 @
.""@ A
XamlRoot""A I
;""I J
await## 
_navigationService## (
.##( )
ShowDialogAsync##) 8
(##8 9
dialog##9 ?
)##? @
;##@ A
}$$ 
}%% 	
public'' 
async'' 
Task'' 
ShowShiftStartAsync'' -
(''- .
ShiftStartViewModel''. A
	viewModel''B K
)''K L
{(( 	
var)) 
dialog)) 
=)) 
new)) 
ShiftStartDialog)) -
())- .
	viewModel)). 7
)))7 8
;))8 9
if** 
(** 
App** 
.** 
MainWindowInstance** &
?**& '
.**' (
Content**( /
?**/ 0
.**0 1
XamlRoot**1 9
!=**: <
null**= A
)**A B
{++ 
dialog,, 
.,, 
XamlRoot,, 
=,,  !
App,," %
.,,% &
MainWindowInstance,,& 8
.,,8 9
Content,,9 @
.,,@ A
XamlRoot,,A I
;,,I J
await-- 
_navigationService-- (
.--( )
ShowDialogAsync--) 8
(--8 9
dialog--9 ?
)--? @
;--@ A
}.. 
}// 	
}00 
}11 Ã€
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\OrderEntryDialogService.cs
	namespace		 	
Magidesk		
 
.		 
Presentation		 
.		  
Services		  (
{

 
public 

class #
OrderEntryDialogService (
:) *$
IOrderEntryDialogService+ C
{ 
public 
async 
Task &
ShowModifierSelectionAsync 4
(4 5&
ModifierSelectionViewModel5 O
	viewModelP Y
)Y Z
{ 	
var 
dialog 
= 
new 
Magidesk %
.% &
Views& +
.+ ,
Dialogs, 3
.3 4#
ModifierSelectionDialog4 K
(K L
	viewModelL U
)U V
;V W
if 
( 
App 
. 
MainWindowInstance &
?& '
.' (
Content( /
?/ 0
.0 1
XamlRoot1 9
!=: <
null= A
)A B
{ 
dialog 
. 
XamlRoot 
=  !
App" %
.% &
MainWindowInstance& 8
.8 9
Content9 @
.@ A
XamlRootA I
;I J
await 
dialog 
. 
	ShowAsync &
(& '
)' (
;( )
} 
} 	
public 
async 
Task '
ShowCookingInstructionAsync 5
(5 6'
CookingInstructionViewModel6 Q
	viewModelR [
)[ \
{ 	
var 
dialog 
= 
new 
Magidesk %
.% &
Views& +
.+ ,
Dialogs, 3
.3 4$
CookingInstructionDialog4 L
{M N
	ViewModelO X
=Y Z
	viewModel[ d
}e f
;f g
if 
( 
App 
. 
MainWindowInstance &
?& '
.' (
Content( /
?/ 0
.0 1
XamlRoot1 9
!=: <
null= A
)A B
{ 
dialog 
. 
XamlRoot 
=  !
App" %
.% &
MainWindowInstance& 8
.8 9
Content9 @
.@ A
XamlRootA I
;I J
	viewModel   
.   
CloseAction   %
=  & '
(  ( )
)  ) *
=>  + -
dialog  . 4
.  4 5
Hide  5 9
(  9 :
)  : ;
;  ; <
	viewModel!! 
.!! 
CancelAction!! &
=!!' (
(!!) *
)!!* +
=>!!, .
dialog!!/ 5
.!!5 6
Hide!!6 :
(!!: ;
)!!; <
;!!< =
await## 
dialog## 
.## 
	ShowAsync## &
(##& '
)##' (
;##( )
}$$ 
}%% 	
public'' 
async'' 
Task'' #
ShowAddOnSelectionAsync'' 1
(''1 2#
AddOnSelectionViewModel''2 I
	viewModel''J S
)''S T
{(( 	
var)) 
dialog)) 
=)) 
new)) 
Magidesk)) %
.))% &
Views))& +
.))+ ,
Dialogs)), 3
.))3 4 
AddOnSelectionDialog))4 H
())H I
	viewModel))I R
)))R S
;))S T
if** 
(** 
App** 
.** 
MainWindowInstance** &
?**& '
.**' (
Content**( /
?**/ 0
.**0 1
XamlRoot**1 9
!=**: <
null**= A
)**A B
{++ 
dialog,, 
.,, 
XamlRoot,, 
=,,  !
App,," %
.,,% &
MainWindowInstance,,& 8
.,,8 9
Content,,9 @
.,,@ A
XamlRoot,,A I
;,,I J
	viewModel-- 
.-- 
CloseAction-- %
=--& '
(--( )
)--) *
=>--+ -
dialog--. 4
.--4 5
Hide--5 9
(--9 :
)--: ;
;--; <
await.. 
dialog.. 
... 
	ShowAsync.. &
(..& '
)..' (
;..( )
}// 
}00 	
public22 
async22 
Task22 #
ShowComboSelectionAsync22 1
(221 2#
ComboSelectionViewModel222 I
	viewModel22J S
)22S T
{33 	
var44 
dialog44 
=44 
new44 
Magidesk44 %
.44% &
Views44& +
.44+ ,
Dialogs44, 3
.443 4 
ComboSelectionDialog444 H
(44H I
	viewModel44I R
)44R S
;44S T
if55 
(55 
App55 
.55 
MainWindowInstance55 &
?55& '
.55' (
Content55( /
?55/ 0
.550 1
XamlRoot551 9
!=55: <
null55= A
)55A B
{66 
dialog77 
.77 
XamlRoot77 
=77  !
App77" %
.77% &
MainWindowInstance77& 8
.778 9
Content779 @
.77@ A
XamlRoot77A I
;77I J
	viewModel88 
.88 
CloseAction88 %
=88& '
(88( )
)88) *
=>88+ -
dialog88. 4
.884 5
Hide885 9
(889 :
)88: ;
;88; <
await99 
dialog99 
.99 
	ShowAsync99 &
(99& '
)99' (
;99( )
}:: 
};; 	
public== 
async== 
Task== "
ShowPizzaModifierAsync== 0
(==0 1"
PizzaModifierViewModel==1 G
	viewModel==H Q
)==Q R
{>> 	
var?? 
dialog?? 
=?? 
new?? 
Magidesk?? %
.??% &
Views??& +
.??+ ,
Dialogs??, 3
.??3 4
PizzaModifierDialog??4 G
{??H I
	ViewModel??J S
=??T U
	viewModel??V _
}??` a
;??a b
if@@ 
(@@ 
App@@ 
.@@ 
MainWindowInstance@@ &
?@@& '
.@@' (
Content@@( /
?@@/ 0
.@@0 1
XamlRoot@@1 9
!=@@: <
null@@= A
)@@A B
{AA 
dialogBB 
.BB 
XamlRootBB 
=BB  !
AppBB" %
.BB% &
MainWindowInstanceBB& 8
.BB8 9
ContentBB9 @
.BB@ A
XamlRootBBA I
;BBI J
	viewModelCC 
.CC 
CloseActionCC %
=CC& '
(CC( )
)CC) *
=>CC+ -
dialogCC. 4
.CC4 5
HideCC5 9
(CC9 :
)CC: ;
;CC; <
awaitDD 
dialogDD 
.DD 
	ShowAsyncDD &
(DD& '
)DD' (
;DD( )
}EE 
}FF 	
publicHH 
asyncHH 
TaskHH 
ShowPriceEntryAsyncHH -
(HH- .
PriceEntryViewModelHH. A
	viewModelHHB K
)HHK L
{II 	
varJJ 
dialogJJ 
=JJ 
newJJ 
MagideskJJ %
.JJ% &
ViewsJJ& +
.JJ+ ,
DialogsJJ, 3
.JJ3 4
PriceEntryDialogJJ4 D
{JJE F
	ViewModelJJG P
=JJQ R
	viewModelJJS \
}JJ] ^
;JJ^ _
ifKK 
(KK 
AppKK 
.KK 
MainWindowInstanceKK &
?KK& '
.KK' (
ContentKK( /
?KK/ 0
.KK0 1
XamlRootKK1 9
!=KK: <
nullKK= A
)KKA B
{LL 
dialogMM 
.MM 
XamlRootMM 
=MM  !
AppMM" %
.MM% &
MainWindowInstanceMM& 8
.MM8 9
ContentMM9 @
.MM@ A
XamlRootMMA I
;MMI J
	viewModelNN 
.NN 
CloseActionNN %
=NN& '
(NN( )
)NN) *
=>NN+ -
dialogNN. 4
.NN4 5
HideNN5 9
(NN9 :
)NN: ;
;NN; <
	viewModelOO 
.OO 
CancelActionOO &
=OO' (
(OO) *
)OO* +
=>OO, .
dialogOO/ 5
.OO5 6
HideOO6 :
(OO: ;
)OO; <
;OO< =
awaitPP 
dialogPP 
.PP 
	ShowAsyncPP &
(PP& '
)PP' (
;PP( )
}QQ 
}RR 	
publicTT 
asyncTT 
TaskTT "
ShowSizeSelectionAsyncTT 0
(TT0 1"
SizeSelectionViewModelTT1 G
	viewModelTTH Q
)TTQ R
{UU 	
varVV 
dialogVV 
=VV 
newVV 
MagideskVV %
.VV% &
ViewsVV& +
.VV+ ,
DialogsVV, 3
.VV3 4
SizeSelectionDialogVV4 G
{VVH I
	ViewModelVVJ S
=VVT U
	viewModelVVV _
}VV` a
;VVa b
ifWW 
(WW 
AppWW 
.WW 
MainWindowInstanceWW &
?WW& '
.WW' (
ContentWW( /
?WW/ 0
.WW0 1
XamlRootWW1 9
!=WW: <
nullWW= A
)WWA B
{XX 
dialogYY 
.YY 
XamlRootYY 
=YY  !
AppYY" %
.YY% &
MainWindowInstanceYY& 8
.YY8 9
ContentYY9 @
.YY@ A
XamlRootYYA I
;YYI J
	viewModelZZ 
.ZZ 
CloseActionZZ %
=ZZ& '
(ZZ( )
)ZZ) *
=>ZZ+ -
dialogZZ. 4
.ZZ4 5
HideZZ5 9
(ZZ9 :
)ZZ: ;
;ZZ; <
await[[ 
dialog[[ 
.[[ 
	ShowAsync[[ &
([[& '
)[[' (
;[[( )
}\\ 
}]] 	
public__ 
async__ 
Task__ 
ShowItemSearchAsync__ -
(__- .
ItemSearchViewModel__. A
	viewModel__B K
)__K L
{`` 	
varaa 
dialogaa 
=aa 
newaa 
Magideskaa %
.aa% &
Viewsaa& +
.aa+ ,
Dialogsaa, 3
.aa3 4
ItemSearchDialogaa4 D
{aaE F
	ViewModelaaG P
=aaQ R
	viewModelaaS \
}aa] ^
;aa^ _
ifbb 
(bb 
Appbb 
.bb 
MainWindowInstancebb &
?bb& '
.bb' (
Contentbb( /
?bb/ 0
.bb0 1
XamlRootbb1 9
!=bb: <
nullbb= A
)bbA B
{cc 
dialogdd 
.dd 
XamlRootdd 
=dd  !
Appdd" %
.dd% &
MainWindowInstancedd& 8
.dd8 9
Contentdd9 @
.dd@ A
XamlRootddA I
;ddI J
	viewModelee 
.ee 
CloseActionee %
=ee& '
(ee( )
)ee) *
=>ee+ -
dialogee. 4
.ee4 5
Hideee5 9
(ee9 :
)ee: ;
;ee; <
awaitff 
dialogff 
.ff 
	ShowAsyncff &
(ff& '
)ff' (
;ff( )
}gg 
}hh 	
publicjj 
asyncjj 
Taskjj 
ShowTicketFeeAsyncjj ,
(jj, -
TicketFeeViewModeljj- ?
	viewModeljj@ I
)jjI J
{kk 	
varll 
dialogll 
=ll 
newll 
TicketFeeDialogll ,
(ll, -
	viewModelll- 6
)ll6 7
;ll7 8
ifmm 
(mm 
Appmm 
.mm 
MainWindowInstancemm &
?mm& '
.mm' (
Contentmm( /
?mm/ 0
.mm0 1
XamlRootmm1 9
!=mm: <
nullmm= A
)mmA B
{nn 
dialogoo 
.oo 
XamlRootoo 
=oo  !
Appoo" %
.oo% &
MainWindowInstanceoo& 8
.oo8 9
Contentoo9 @
.oo@ A
XamlRootooA I
;ooI J
	viewModelpp 
.pp 
CloseActionpp %
=pp& '
(pp( )
)pp) *
=>pp+ -
dialogpp. 4
.pp4 5
Hidepp5 9
(pp9 :
)pp: ;
;pp; <
	viewModelqq 
.qq 
CancelActionqq &
=qq' (
(qq) *
)qq* +
=>qq, .
dialogqq/ 5
.qq5 6
Hideqq6 :
(qq: ;
)qq; <
;qq< =
varrr 
resultrr 
=rr 
awaitrr "
dialogrr# )
.rr) *
	ShowAsyncrr* 3
(rr3 4
)rr4 5
;rr5 6
	viewModelss 
.ss 
IsConfirmedss %
=ss& '
resultss( .
==ss/ 1
ContentDialogResultss2 E
.ssE F
PrimaryssF M
;ssM N
}tt 
}uu 	
publicww 
asyncww 
Taskww "
ShowSeatSelectionAsyncww 0
(ww0 1"
SeatSelectionViewModelww1 G
	viewModelwwH Q
)wwQ R
{xx 	
varyy 
dialogyy 
=yy 
newyy 
Magideskyy %
.yy% &
Viewsyy& +
.yy+ ,
Dialogsyy, 3
.yy3 4
SeatSelectionDialogyy4 G
{yyH I
	ViewModelyyJ S
=yyT U
	viewModelyyV _
}yy` a
;yya b
ifzz 
(zz 
Appzz 
.zz 
MainWindowInstancezz &
?zz& '
.zz' (
Contentzz( /
?zz/ 0
.zz0 1
XamlRootzz1 9
!=zz: <
nullzz= A
)zzA B
{{{ 
dialog|| 
.|| 
XamlRoot|| 
=||  !
App||" %
.||% &
MainWindowInstance||& 8
.||8 9
Content||9 @
.||@ A
XamlRoot||A I
;||I J
	viewModel}} 
.}} 
CloseAction}} %
=}}& '
(}}( )
)}}) *
=>}}+ -
dialog}}. 4
.}}4 5
Hide}}5 9
(}}9 :
)}}: ;
;}}; <
await~~ 
dialog~~ 
.~~ 
	ShowAsync~~ &
(~~& '
)~~' (
;~~( )
} 
}
€€ 	
public
‚‚ 
async
‚‚ 
Task
‚‚ 
ShowMiscItemAsync
‚‚ +
(
‚‚+ ,
MiscItemViewModel
‚‚, =
	viewModel
‚‚> G
)
‚‚G H
{
ƒƒ 	
var
„„ 
dialog
„„ 
=
„„ 
new
„„ 
MiscItemDialog
„„ +
(
„„+ ,
	viewModel
„„, 5
)
„„5 6
;
„„6 7
if
…… 
(
…… 
App
…… 
.
……  
MainWindowInstance
…… &
?
……& '
.
……' (
Content
……( /
?
……/ 0
.
……0 1
XamlRoot
……1 9
!=
……: <
null
……= A
)
……A B
{
†† 
dialog
‡‡ 
.
‡‡ 
XamlRoot
‡‡ 
=
‡‡  !
App
‡‡" %
.
‡‡% & 
MainWindowInstance
‡‡& 8
.
‡‡8 9
Content
‡‡9 @
.
‡‡@ A
XamlRoot
‡‡A I
;
‡‡I J
	viewModel
ˆˆ 
.
ˆˆ 
CloseAction
ˆˆ %
=
ˆˆ& '
(
ˆˆ( )
)
ˆˆ) *
=>
ˆˆ+ -
dialog
ˆˆ. 4
.
ˆˆ4 5
Hide
ˆˆ5 9
(
ˆˆ9 :
)
ˆˆ: ;
;
ˆˆ; <
	viewModel
‰‰ 
.
‰‰ 
CancelAction
‰‰ &
=
‰‰' (
(
‰‰) *
)
‰‰* +
=>
‰‰, .
dialog
‰‰/ 5
.
‰‰5 6
Hide
‰‰6 :
(
‰‰: ;
)
‰‰; <
;
‰‰< =
var
ŠŠ 
result
ŠŠ 
=
ŠŠ 
await
ŠŠ "
dialog
ŠŠ# )
.
ŠŠ) *
	ShowAsync
ŠŠ* 3
(
ŠŠ3 4
)
ŠŠ4 5
;
ŠŠ5 6
	viewModel
‹‹ 
.
‹‹ 
IsConfirmed
‹‹ %
=
‹‹& '
result
‹‹( .
==
‹‹/ 1!
ContentDialogResult
‹‹2 E
.
‹‹E F
Primary
‹‹F M
;
‹‹M N
}
ŒŒ 
}
 	
}
ŽŽ 
} üQ
cC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\NavigationService.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Services  (
;( )
public		 
class		 
NavigationService		 
{

 
private 
Frame 
? 
_frame 
; 
private 
readonly 
Application  
.  !

Interfaces! +
.+ ,
IUserService, 8
_userService9 E
;E F
public 

NavigationService 
( 
Application (
.( )

Interfaces) 3
.3 4
IUserService4 @
userServiceA L
)L M
{ 
_userService 
= 
userService "
;" #
} 
private 
	Microsoft 
. 
UI 
. 
Dispatching $
.$ %
DispatcherQueue% 4
?4 5
_dispatcherQueue6 F
;F G
public 

void 

Initialize 
( 
Frame  
frame! &
)& '
{ 
_frame 
= 
frame 
; 
_dispatcherQueue 
= 
frame  
.  !
DispatcherQueue! 0
;0 1
} 
public 

bool 
	CanGoBack 
=> 
_frame #
?# $
.$ %
	CanGoBack% .
==/ 1
true2 6
;6 7
public 

virtual 
void 
GoBack 
( 
)  
{ 
if 

( 
_frame 
? 
. 
	CanGoBack 
==  
true! %
)% &
{   	
_frame!! 
.!! 
GoBack!! 
(!! 
)!! 
;!! 
}"" 	
}## 
public%% 

virtual%% 
bool%% 
Navigate%%  
(%%  !
Type%%! %
pageType%%& .
,%%. /
object%%0 6
?%%6 7
	parameter%%8 A
=%%B C
null%%D H
)%%H I
{&& 
if'' 

('' 
_frame'' 
=='' 
null'' 
)'' 
{(( 	
throw)) 
new)) %
InvalidOperationException)) /
())/ 0
$str))0 u
)))u v
;))v w
}** 	
if.. 

(.. 
pageType.. 
==.. 
typeof.. 
(.. 
Views.. $
...$ %
	LoginPage..% .
)... /
)../ 0
{// 	
return00 
_frame00 
.00 
Navigate00 #
(00# $
pageType00$ ,
,00, -
	parameter00. 7
)007 8
;008 9
}11 	
if44 

(44 
_userService44 
.44 
CurrentUser44 $
==44% '
null44( ,
)44, -
{55 	
if77 
(77 
_frame77 
.77 !
CurrentSourcePageType77 ,
!=77- /
typeof770 6
(776 7
Views777 <
.77< =
	LoginPage77= F
)77F G
)77G H
{88 
System99 
.99 
Diagnostics99 "
.99" #
Debug99# (
.99( )
	WriteLine99) 2
(992 3
$"993 5
$str995 _
{99_ `
pageType99` h
.99h i
Name99i m
}99m n
$str	99n …
"
99… †
)
99† ‡
;
99‡ ˆ
_frame:: 
.:: 
Navigate:: 
(::  
typeof::  &
(::& '
Views::' ,
.::, -
	LoginPage::- 6
)::6 7
)::7 8
;::8 9
return@@ 
false@@ 
;@@ 
}AA 
SystemDD 
.DD 
DiagnosticsDD 
.DD 
DebugDD $
.DD$ %
	WriteLineDD% .
(DD. /
$"DD/ 1
$strDD1 [
{DD[ \
pageTypeDD\ d
.DDd e
NameDDe i
}DDi j
$strDDj }
"DD} ~
)DD~ 
;	DD €
returnEE 
falseEE 
;EE 
}FF 	
returnHH 
_frameHH 
.HH 
NavigateHH 
(HH 
pageTypeHH '
,HH' (
	parameterHH) 2
)HH2 3
;HH3 4
}II 
publicKK 

virtualKK 
asyncKK 
TaskKK 
<KK 
ContentDialogResultKK 1
>KK1 2
ShowDialogAsyncKK3 B
(KKB C
ContentDialogKKC P
dialogKKQ W
)KKW X
{LL 
ifMM 

(MM 
_frameMM 
==MM 
nullMM 
)MM 
{NN 	
throwOO 
newOO %
InvalidOperationExceptionOO /
(OO/ 0
$strOO0 u
)OOu v
;OOv w
}PP 	
ifSS 

(SS 
_dispatcherQueueSS 
!=SS 
nullSS  $
&&SS% '
!SS( )
_dispatcherQueueSS) 9
.SS9 :
HasThreadAccessSS: I
)SSI J
{TT 	
varUU 
tcsUU 
=UU 
newUU  
TaskCompletionSourceUU .
<UU. /
ContentDialogResultUU/ B
>UUB C
(UUC D
)UUD E
;UUE F
_dispatcherQueueVV 
.VV 

TryEnqueueVV '
(VV' (
asyncVV( -
(VV. /
)VV/ 0
=>VV1 3
{WW 
tryXX 
{YY 
varZZ 
resultZZ 
=ZZ  
awaitZZ! &
ShowDialogAsyncZZ' 6
(ZZ6 7
dialogZZ7 =
)ZZ= >
;ZZ> ?
tcs[[ 
.[[ 
	SetResult[[ !
([[! "
result[[" (
)[[( )
;[[) *
}\\ 
catch]] 
(]] 
	Exception]]  
ex]]! #
)]]# $
{^^ 
tcs__ 
.__ 
SetException__ $
(__$ %
ex__% '
)__' (
;__( )
}`` 
}aa 
)aa 
;aa 
returnbb 
awaitbb 
tcsbb 
.bb 
Taskbb !
;bb! "
}cc 	
varee 
attemptsee 
=ee 
$numee 
;ee 
whileff 
(ff 
_frameff 
.ff 
XamlRootff 
==ff !
nullff" &
&&ff' )
attemptsff* 2
<ff3 4
$numff5 7
)ff7 8
{gg 	
awaithh 
Taskhh 
.hh 
Delayhh 
(hh 
$numhh 
)hh  
;hh  !
attemptsii 
++ii 
;ii 
}jj 	
ifll 

(ll 
_framell 
.ll 
XamlRootll 
==ll 
nullll #
)ll# $
{mm 	
Systemnn 
.nn 
Diagnosticsnn 
.nn 
Debugnn $
.nn$ %
	WriteLinenn% .
(nn. /
$"nn/ 1
$strnn1 \
{nn\ ]
dialognn] c
.nnc d
Titlennd i
}nni j
$str	nnj ™
"
nn™ š
)
nnš ›
;
nn› œ
returnpp 
ContentDialogResultpp &
.pp& '
Nonepp' +
;pp+ ,
}qq 	
dialogss 
.ss 
XamlRootss 
=ss 
_framess  
.ss  !
XamlRootss! )
;ss) *
trytt 
{uu 	
returnvv 
awaitvv 
dialogvv 
.vv  
	ShowAsyncvv  )
(vv) *
)vv* +
;vv+ ,
}ww 	
catchxx 
(xx 
	Exceptionxx 
exxx 
)xx 
{yy 	
Systemzz 
.zz 
Diagnosticszz 
.zz 
Debugzz $
.zz$ %
	WriteLinezz% .
(zz. /
$"zz/ 1
$strzz1 W
{zzW X
exzzX Z
.zzZ [
Messagezz[ b
}zzb c
$strzzc d
"zzd e
)zze f
;zzf g
return{{ 
ContentDialogResult{{ &
.{{& '
None{{' +
;{{+ ,
}|| 	
}}} 
public 

virtual 
async 
Task 
ShowErrorAsync ,
(, -
string- 3
title4 9
,9 :
string; A
messageB I
)I J
{
€€ 
var
 
errorDialog
 
=
 
new
 
ContentDialog
 +
{
‚‚ 	
Title
ƒƒ 
=
ƒƒ 
title
ƒƒ 
,
ƒƒ 
Content
„„ 
=
„„ 
message
„„ 
,
„„ 
CloseButtonText
…… 
=
…… 
$str
…… "
}
†† 	
;
††	 

await
‡‡ 
ShowDialogAsync
‡‡ 
(
‡‡ 
errorDialog
‡‡ )
)
‡‡) *
;
‡‡* +
}
ˆˆ 
public
ŠŠ 

virtual
ŠŠ 
async
ŠŠ 
Task
ŠŠ 
ShowMessageAsync
ŠŠ .
(
ŠŠ. /
string
ŠŠ/ 5
title
ŠŠ6 ;
,
ŠŠ; <
string
ŠŠ= C
message
ŠŠD K
)
ŠŠK L
{
‹‹ 
var
ŒŒ 
dialog
ŒŒ 
=
ŒŒ 
new
ŒŒ 
ContentDialog
ŒŒ &
{
 	
Title
ŽŽ 
=
ŽŽ 
title
ŽŽ 
,
ŽŽ 
Content
 
=
 
message
 
,
 
CloseButtonText
 
=
 
$str
 "
}
‘‘ 	
;
‘‘	 

await
’’ 
ShowDialogAsync
’’ 
(
’’ 
dialog
’’ $
)
’’$ %
;
’’% &
}
““ 
public
•• 

	Microsoft
•• 
.
•• 
UI
•• 
.
•• 
Dispatching
•• #
.
••# $
DispatcherQueue
••$ 3
?
••3 4
DispatcherQueue
••5 D
=>
••E G
_frame
••H N
?
••N O
.
••O P
DispatcherQueue
••P _
;
••_ `
}–– §	
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\ISwitchboardDialogService.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Services  (
{ 
public 

	interface %
ISwitchboardDialogService .
{ 
Task '
ShowOrderTypeSelectionAsync (
(( )
Magidesk) 1
.1 2
Presentation2 >
.> ?

ViewModels? I
.I J'
OrderTypeSelectionViewModelJ e
	viewModelf o
)o p
;p q
Task 
ShowGuestCountAsync  
(  !
Magidesk! )
.) *
Presentation* 6
.6 7

ViewModels7 A
.A B
GuestCountViewModelB U
	viewModelV _
)_ `
;` a
Task		 
ShowShiftStartAsync		  
(		  !
Magidesk		! )
.		) *
Presentation		* 6
.		6 7

ViewModels		7 A
.		A B
ShiftStartViewModel		B U
	viewModel		V _
)		_ `
;		` a
}

 
} °
jC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\IOrderEntryDialogService.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  
Services  (
{ 
public 

	interface $
IOrderEntryDialogService -
{ 
Task		 &
ShowModifierSelectionAsync		 '
(		' (&
ModifierSelectionViewModel		( B
	viewModel		C L
)		L M
;		M N
Task

 '
ShowCookingInstructionAsync

 (
(

( )'
CookingInstructionViewModel

) D
	viewModel

E N
)

N O
;

O P
Task #
ShowAddOnSelectionAsync $
($ %#
AddOnSelectionViewModel% <
	viewModel= F
)F G
;G H
Task #
ShowComboSelectionAsync $
($ %#
ComboSelectionViewModel% <
	viewModel= F
)F G
;G H
Task "
ShowPizzaModifierAsync #
(# $"
PizzaModifierViewModel$ :
	viewModel; D
)D E
;E F
Task 
ShowPriceEntryAsync  
(  !
PriceEntryViewModel! 4
	viewModel5 >
)> ?
;? @
Task "
ShowSizeSelectionAsync #
(# $"
SizeSelectionViewModel$ :
	viewModel; D
)D E
;E F
Task 
ShowItemSearchAsync  
(  !
ItemSearchViewModel! 4
	viewModel5 >
)> ?
;? @
Task 
ShowTicketFeeAsync 
(  
TicketFeeViewModel  2
	viewModel3 <
)< =
;= >
Task "
ShowSeatSelectionAsync #
(# $"
SeatSelectionViewModel$ :
	viewModel; D
)D E
;E F
Task 
ShowMiscItemAsync 
( 
MiscItemViewModel 0
	viewModel1 :
): ;
;; <
} 
} ¸4
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Services\DefaultViewRoutingService.cs
	namespace

 	
Magidesk


 
.

 
Presentation

 
.

  
Services

  (
;

( )
public 
	interface &
IDefaultViewRoutingService +
{ 
Task 
< 	
Type	 
> #
GetDefaultViewTypeAsync &
(& '
Guid' +
?+ ,

terminalId- 7
)7 8
;8 9
} 
public 
sealed 
class %
DefaultViewRoutingService -
:. /&
IDefaultViewRoutingService0 J
{ 
private 
readonly 
ITerminalContext %
_terminalContext& 6
;6 7
private 
readonly  
IServiceScopeFactory )
_scopeFactory* 7
;7 8
private$$ 
const$$ 
string$$ 
KdsTerminalKeyword$$ +
=$$, -
$str$$. 3
;$$3 4
private%% 
const%% 
string%% 
BarTerminalKeyword%% +
=%%, -
$str%%. 3
;%%3 4
public'' 
%
DefaultViewRoutingService'' $
(''$ %
ITerminalContext(( 
terminalContext(( (
,((( ) 
IServiceScopeFactory)) 
scopeFactory)) )
)))) *
{** 
_terminalContext++ 
=++ 
terminalContext++ *
;++* +
_scopeFactory,, 
=,, 
scopeFactory,, $
;,,$ %
}-- 
public// 

async// 
Task// 
<// 
Type// 
>// #
GetDefaultViewTypeAsync// 3
(//3 4
Guid//4 8
?//8 9

terminalId//: D
)//D E
{00 
try11 
{22 	
return55 
typeof55 
(55 
Magidesk55 "
.55" #
Presentation55# /
.55/ 0
Views550 5
.555 6
SwitchboardPage556 E
)55E F
;55F G
if88 
(88 
IsKdsTerminal88 
(88 
)88 
)88  
{99 
return:: 
typeof:: 
(:: 
Magidesk:: &
.::& '
Presentation::' 3
.::3 4
Views::4 9
.::9 :
KitchenDisplayPage::: L
)::L M
;::M N
};; 
using>> 
(>> 
var>> 
scope>> 
=>> 
_scopeFactory>> ,
.>>, -
CreateScope>>- 8
(>>8 9
)>>9 :
)>>: ;
{?? 
var@@ 
orderTypeRepository@@ '
=@@( )
scope@@* /
.@@/ 0
ServiceProvider@@0 ?
.@@? @
GetRequiredService@@@ R
<@@R S 
IOrderTypeRepository@@S g
>@@g h
(@@h i
)@@i j
;@@j k
varAA 
defaultOrderTypeAA $
=AA% &
awaitAA' ,$
GetDefaultOrderTypeAsyncAA- E
(AAE F
orderTypeRepositoryAAF Y
)AAY Z
;AAZ [
ifCC 
(CC 
defaultOrderTypeCC $
!=CC% '
nullCC( ,
)CC, -
{DD 
ifFF 
(FF 
defaultOrderTypeFF (
.FF( )
RequiresTableFF) 6
)FF6 7
{GG 
returnHH 
typeofHH %
(HH% &
MagideskHH& .
.HH. /
PresentationHH/ ;
.HH; <
ViewsHH< A
.HHA B
TableMapPageHHB N
)HHN O
;HHO P
}II 
ifMM 
(MM 
!MM 
defaultOrderTypeMM )
.MM) *
RequiresTableMM* 7
&&MM8 :
!MM; <
defaultOrderTypeMM< L
.MML M
RequiresCustomerMMM ]
)MM] ^
{NN 
returnOO 
typeofOO %
(OO% &
MagideskOO& .
.OO. /
PresentationOO/ ;
.OO; <
ViewsOO< A
.OOA B
OrderEntryPageOOB P
)OOP Q
;OOQ R
}PP 
}QQ 
}RR 
returnUU 
typeofUU 
(UU 
MagideskUU "
.UU" #
PresentationUU# /
.UU/ 0
ViewsUU0 5
.UU5 6
SwitchboardPageUU6 E
)UUE F
;UUF G
}VV 	
catchWW 
(WW 
	ExceptionWW 
)WW 
{XX 	
returnZZ 
typeofZZ 
(ZZ 
MagideskZZ "
.ZZ" #
PresentationZZ# /
.ZZ/ 0
ViewsZZ0 5
.ZZ5 6
SwitchboardPageZZ6 E
)ZZE F
;ZZF G
}[[ 	
}\\ 
private^^ 
bool^^ 
IsKdsTerminal^^ 
(^^ 
)^^  
{__ 
var`` 
terminalIdentity`` 
=`` 
_terminalContext`` /
.``/ 0
TerminalIdentity``0 @
;``@ A
returnaa 
!aa 
stringaa 
.aa 
IsNullOrEmptyaa $
(aa$ %
terminalIdentityaa% 5
)aa5 6
&&aa7 9
terminalIdentitybb 
.bb  
Containsbb  (
(bb( )
KdsTerminalKeywordbb) ;
,bb; <
StringComparisonbb= M
.bbM N
OrdinalIgnoreCasebbN _
)bb_ `
;bb` a
}cc 
privateee 
asyncee 
Taskee 
<ee 
	OrderTypeee  
?ee  !
>ee! "$
GetDefaultOrderTypeAsyncee# ;
(ee; < 
IOrderTypeRepositoryee< P

repositoryeeQ [
)ee[ \
{ff 
trygg 
{hh 	
varkk 

orderTypeskk 
=kk 
awaitkk "

repositorykk# -
.kk- .
GetAllAsynckk. 9
(kk9 :
)kk: ;
;kk; <
ifnn 
(nn 

orderTypesnn 
==nn 
nullnn "
||nn# %
!nn& '

orderTypesnn' 1
.nn1 2
Anynn2 5
(nn5 6
)nn6 7
)nn7 8
{oo 
returnpp 
nullpp 
;pp 
}qq 
returnss 

orderTypesss 
.ss 
FirstOrDefaultss ,
(ss, -
otss- /
=>ss0 2
otss3 5
.ss5 6
IsActivess6 >
)ss> ?
;ss? @
}tt 	
catchuu 
(uu 
	Exceptionuu 
)uu 
{vv 	
returnxx 
nullxx 
;xx 
}yy 	
}zz 
}{{ Ð
XC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\MainWindow.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
;  
public		 
sealed		 
partial		 
class		 

MainWindow		 &
:		' (
Window		) /
{

 
private 
readonly 
NavigationService &
_navigation' 2
;2 3
private 
readonly 
	Microsoft 
. 
UI !
.! "
Dispatching" -
.- . 
DispatcherQueueTimer. B
_clockTimerC N
;N O
public 


MainWindow 
( 
) 
{ 
StartupLogger 
. 
Log 
( 
$str :
): ;
;; <
try 
{ 
InitializeComponent 
(  
)  !
;! "
StartupLogger 
. 
Log 
( 
$str H
)H I
;I J
} 	
catch
 
( 
	Exception 
ex 
) 
{  
StartupLogger 
. 
Log 
( 
$"  
$str  H
{H I
exI K
}K L
"L M
)M N
;N O
throw 
; 
} 	
StartupLogger 
. 
Log 
( 
$str H
)H I
;I J
try 
{ 
_navigation 
= 
App 
. 
Services &
.& '
GetRequiredService' 9
<9 :
NavigationService: K
>K L
(L M
)M N
;N O
_navigation 
. 

Initialize "
(" #
ContentFrame# /
)/ 0
;0 1
StartupLogger 
. 
Log 
( 
$str N
)N O
;O P
} 	
catch
 
( 
	Exception 
ex 
) 
{  
StartupLogger 
. 
Log 
( 
$"  
$str  N
{N O
exO Q
}Q R
"R S
)S T
;T U
throw   
;   
}!! 	
StartupLogger$$ 
.$$ 
Log$$ 
($$ 
$str$$ 4
)$$4 5
;$$5 6
_clockTimer%% 
=%% 
	Microsoft%% 
.%%  
UI%%  "
.%%" #
Dispatching%%# .
.%%. /
DispatcherQueue%%/ >
.%%> ?
GetForCurrentThread%%? R
(%%R S
)%%S T
.%%T U
CreateTimer%%U `
(%%` a
)%%a b
;%%b c
_clockTimer&& 
.&& 
Interval&& 
=&& 
System&& %
.&&% &
TimeSpan&&& .
.&&. /
FromSeconds&&/ :
(&&: ;
$num&&; <
)&&< =
;&&= >
_clockTimer'' 
.'' 
Tick'' 
+='' 
('' 
s'' 
,'' 
e''  !
)''! "
=>''# %
{''& '
if''( *
(''+ ,
StatusClock'', 7
!=''8 :
null''; ?
)''? @
StatusClock''A L
.''L M
Text''M Q
=''R S
System''T Z
.''Z [
DateTime''[ c
.''c d
Now''d g
.''g h
ToString''h p
(''p q
$str''q {
)''{ |
;''| }
}''~ 
;	'' €
_clockTimer(( 
.(( 
Start(( 
((( 
)(( 
;(( 
if** 

(** 
StatusClock** 
!=** 
null** 
)**  
StatusClock**! ,
.**, -
Text**- 1
=**2 3
System**4 :
.**: ;
DateTime**; C
.**C D
Now**D G
.**G H
ToString**H P
(**P Q
$str**Q [
)**[ \
;**\ ]
try-- 
{.. 	
var// 
userService// 
=// 
App// !
.//! "
Services//" *
.//* +
GetRequiredService//+ =
<//= >
Magidesk//> F
.//F G
Application//G R
.//R S

Interfaces//S ]
.//] ^
IUserService//^ j
>//j k
(//k l
)//l m
;//m n
userService11 
.11 
UserChanged11 #
+=11$ &
(11' (
s11( )
,11) *
u11+ ,
)11, -
=>11. 0
{22 
DispatcherQueue33 
.33  

TryEnqueue33  *
(33* +
(33+ ,
)33, -
=>33. 0
{44 
try55 
{55 
UpdateUiAuthState55 +
(55+ ,
u55, -
)55- .
;55. /
}550 1
catch552 7
(558 9
	Exception559 B
ex55C E
)55E F
{55G H
StartupLogger55I V
.55V W
Log55W Z
(55Z [
$"55[ ]
$str55] t
{55t u
ex55u w
}55w x
"55x y
)55y z
;55z {
}55| }
}66 
)66 
;66 
}77 
;77 
UpdateUiAuthState88 
(88 
userService88 )
.88) *
CurrentUser88* 5
)885 6
;886 7
}99 	
catch:: 
(:: 
	Exception:: 
ex:: 
):: 
{;; 	
StartupLogger<< 
.<< 
Log<< 
(<< 
$"<< !
$str<<! A
{<<A B
ex<<B D
}<<D E
"<<E F
)<<F G
;<<G H
}== 	
StartupLogger?? 
.?? 
Log?? 
(?? 
$str?? 8
)??8 9
;??9 :
}@@ 
privateBB 
voidBB 
UpdateUiAuthStateBB "
(BB" #
MagideskBB# +
.BB+ ,
ApplicationBB, 7
.BB7 8
DTOsBB8 <
.BB< =
UserDtoBB= D
?BBD E
userBBF J
)BBJ K
{CC 
ifDD 

(DD 
RootNavigationViewDD 
!=DD !
nullDD" &
)DD& '
{EE 	
RootNavigationViewFF 
.FF 
IsPaneVisibleFF ,
=FF- .
userFF/ 3
!=FF4 6
nullFF7 ;
;FF; <
RootNavigationViewGG 
.GG 
IsSettingsVisibleGG 0
=GG1 2
userGG3 7
!=GG8 :
nullGG; ?
;GG? @
RootNavigationViewOO 
.OO 
PaneDisplayModeOO .
=OO/ 0
userOO1 5
!=OO6 8
nullOO9 =
?OO> ?)
NavigationViewPaneDisplayModeOO@ ]
.OO] ^
LeftOO^ b
:OOc d*
NavigationViewPaneDisplayMode	OOe ‚
.
OO‚ ƒ
LeftMinimal
OOƒ Ž
;
OOŽ 
RootNavigationViewPP 
.PP 

IsPaneOpenPP )
=PP* +
falsePP, 1
;PP1 2
RootNavigationViewQQ 
.QQ %
IsPaneToggleButtonVisibleQQ 8
=QQ9 :
userQQ; ?
!=QQ@ B
nullQQC G
;QQG H
}RR 	
ifTT 

(TT 

StatusUserTT 
!=TT 
nullTT 
)TT 
{UU 	

StatusUserVV 
.VV 
TextVV 
=VV 
userVV "
!=VV# %
nullVV& *
?VV+ ,
$"VV- /
{VV/ 0
userVV0 4
.VV4 5
	FirstNameVV5 >
}VV> ?
$strVV? @
{VV@ A
userVVA E
.VVE F
LastNameVVF N
}VVN O
"VVO P
:VVQ R
$strVVS b
;VVb c
}WW 	
}XX 
publicZZ 

voidZZ 
SetTerminalIdZZ 
(ZZ 
stringZZ $

terminalIdZZ% /
)ZZ/ 0
{[[ 
if\\ 

(\\ 
StatusTerminalId\\ 
!=\\ 
null\\  $
)\\$ %
StatusTerminalId\\& 6
.\\6 7
Text\\7 ;
=\\< =

terminalId\\> H
;\\H I
}]] 
public__ 

void__ 
SetUser__ 
(__ 
string__ 
userName__ '
)__' (
{`` 
ifaa 

(aa 

StatusUseraa 
!=aa 
nullaa 
)aa 

StatusUseraa  *
.aa* +
Textaa+ /
=aa0 1
userNameaa2 :
;aa: ;
}bb 
privatedd 
voiddd 
OnBackRequesteddd  
(dd  !
NavigationViewdd! /
senderdd0 6
,dd6 70
$NavigationViewBackRequestedEventArgsdd8 \
argsdd] a
)dda b
{ee 
ifff 

(ff 
_navigationff 
.ff 
	CanGoBackff !
)ff! "
{gg 	
_navigationhh 
.hh 
GoBackhh 
(hh 
)hh  
;hh  !
}ii 	
}jj 
privatell 
asyncll 
voidll 
OnItemInvokedll $
(ll$ %
NavigationViewll% 3
senderll4 :
,ll: ;.
"NavigationViewItemInvokedEventArgsll< ^
argsll_ c
)llc d
{mm 
tryoo 
{pp 	
ifqq 
(qq 
argsqq 
.qq  
InvokedItemContainerqq )
isqq* ,
notqq- 0
NavigationViewItemqq1 C
itemqqD H
)qqH I
{rr 
returnss 
;ss 
}tt 
varvv 
tagvv 
=vv 
itemvv 
.vv 
Tagvv 
?vv 
.vv  
ToStringvv  (
(vv( )
)vv) *
;vv* +
ifww 
(ww 
tagww 
==ww 
$strww 
)ww 
{xx 
_navigationyy 
.yy 
Navigateyy $
(yy$ %
typeofyy% +
(yy+ ,
Viewsyy, 1
.yy1 2
SwitchboardPageyy2 A
)yyA B
)yyB C
;yyC D
returnzz 
;zz 
}{{ 
if}} 
(}} 
tag}} 
==}} 
$str}} !
)}}! "
{~~ 
_navigation 
. 
Navigate $
($ %
typeof% +
(+ ,
Views, 1
.1 2
TableMapPage2 >
)> ?
)? @
;@ A
return
€€ 
;
€€ 
}
 
if
ƒƒ 
(
ƒƒ 
tag
ƒƒ 
==
ƒƒ 
$str
ƒƒ '
)
ƒƒ' (
{
„„ 
_navigation
…… 
.
…… 
Navigate
…… $
(
……$ %
typeof
……% +
(
……+ ,
Views
……, 1
.
……1 2 
KitchenDisplayPage
……2 D
)
……D E
)
……E F
;
……F G
return
†† 
;
†† 
}
‡‡ 
}
ˆˆ 	
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰ 
{
ŠŠ 	
StartupLogger
‹‹ 
.
‹‹ 
Log
‹‹ 
(
‹‹ 
$"
‹‹  
$str
‹‹  1
{
‹‹1 2
ex
‹‹2 4
}
‹‹4 5
"
‹‹5 6
)
‹‹6 7
;
‹‹7 8
try
ŒŒ 
{
 
var
 
dialogService
 !
=
" #
App
$ '
.
' (
Services
( 0
.
0 1 
GetRequiredService
1 C
<
C D
Magidesk
D L
.
L M
Application
M X
.
X Y

Interfaces
Y c
.
c d
IDialogService
d r
>
r s
(
s t
)
t u
;
u v
await
 
dialogService
 #
.
# $
ShowErrorAsync
$ 2
(
2 3
$str
3 F
,
F G
$"
H J
$str
J ~
{
~ 
ex 
. ‚
Message‚ ‰
}‰ Š
"Š ‹
,‹ Œ
ex 
. 
ToString ˜
(˜ ™
)™ š
)š ›
;› œ
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
dialogEx
’’ %
)
’’% &
{
““ 
System
•• 
.
•• 
Diagnostics
•• "
.
••" #
Debug
••# (
.
••( )
	WriteLine
••) 2
(
••2 3
$"
••3 5
$str
••5 Q
{
••Q R
dialogEx
••R Z
}
••Z [
"
••[ \
)
••\ ]
;
••] ^
}
–– 
}
—— 	
}
˜˜ 
public
šš 

void
šš 
ShowLoading
šš 
(
šš 
string
šš "
message
šš# *
)
šš* +
{
›› 
if
œœ 

(
œœ 
LoadingStatus
œœ 
!=
œœ 
null
œœ !
)
œœ! "
LoadingStatus
œœ# 0
.
œœ0 1
Text
œœ1 5
=
œœ6 7
message
œœ8 ?
;
œœ? @
if
 

(
 
LoadingOverlay
 
!=
 
null
 "
)
" #
LoadingOverlay
$ 2
.
2 3

Visibility
3 =
=
> ?

Visibility
@ J
.
J K
Visible
K R
;
R S
}
žž 
public
   

void
   
HideLoading
   
(
   
)
   
{
¡¡ 
if
¢¢ 

(
¢¢ 
LoadingOverlay
¢¢ 
!=
¢¢ 
null
¢¢ "
)
¢¢" #
LoadingOverlay
¢¢$ 2
.
¢¢2 3

Visibility
¢¢3 =
=
¢¢> ?

Visibility
¢¢@ J
.
¢¢J K
	Collapsed
¢¢K T
;
¢¢T U
}
££ 
private
¦¦ 
string
¦¦ 
?
¦¦ 
_lastErrorDetails
¦¦ %
;
¦¦% &
public
¨¨ 

void
¨¨ 
ShowErrorBanner
¨¨ 
(
¨¨  
string
¨¨  &
message
¨¨' .
,
¨¨. /
string
¨¨0 6
?
¨¨6 7
details
¨¨8 ?
=
¨¨@ A
null
¨¨B F
)
¨¨F G
{
©© 
DispatcherQueue
ªª 
.
ªª 

TryEnqueue
ªª "
(
ªª" #
(
ªª# $
)
ªª$ %
=>
ªª& (
{
«« 	
if
¬¬ 
(
¬¬ 
ErrorBanner
¬¬ 
!=
¬¬ 
null
¬¬ #
)
¬¬# $
{
­­ 
ErrorBanner
®® 
.
®® 
Title
®® !
=
®®" #
$str
®®$ 2
;
®®2 3
ErrorBanner
¯¯ 
.
¯¯ 
Message
¯¯ #
=
¯¯$ %
message
¯¯& -
;
¯¯- .
ErrorBanner
°° 
.
°° 
IsOpen
°° "
=
°°# $
true
°°% )
;
°°) *
_lastErrorDetails
±± !
=
±±" #
details
±±$ +
;
±±+ ,
}
²² 
}
³³ 	
)
³³	 

;
³³
 
}
´´ 
public
¶¶ 

void
¶¶ 
HideErrorBanner
¶¶ 
(
¶¶  
)
¶¶  !
{
·· 
DispatcherQueue
¸¸ 
.
¸¸ 

TryEnqueue
¸¸ "
(
¸¸" #
(
¸¸# $
)
¸¸$ %
=>
¸¸& (
{
¹¹ 	
if
ºº 
(
ºº 
ErrorBanner
ºº 
!=
ºº 
null
ºº #
)
ºº# $
{
»» 
ErrorBanner
¼¼ 
.
¼¼ 
IsOpen
¼¼ "
=
¼¼# $
false
¼¼% *
;
¼¼* +
_lastErrorDetails
½½ !
=
½½" #
null
½½$ (
;
½½( )
}
¾¾ 
}
¿¿ 	
)
¿¿	 

;
¿¿
 
}
ÀÀ 
private
ÂÂ 
async
ÂÂ 
void
ÂÂ &
ErrorBanner_DetailsClick
ÂÂ /
(
ÂÂ/ 0
object
ÂÂ0 6
sender
ÂÂ7 =
,
ÂÂ= >
RoutedEventArgs
ÂÂ? N
e
ÂÂO P
)
ÂÂP Q
{
ÃÃ 
if
ÄÄ 

(
ÄÄ 
!
ÄÄ 
string
ÄÄ 
.
ÄÄ 
IsNullOrEmpty
ÄÄ !
(
ÄÄ! "
_lastErrorDetails
ÄÄ" 3
)
ÄÄ3 4
)
ÄÄ4 5
{
ÅÅ 	
var
ÆÆ 
dialog
ÆÆ 
=
ÆÆ 
new
ÆÆ 
ContentDialog
ÆÆ *
{
ÇÇ 
Title
ÈÈ 
=
ÈÈ 
$str
ÈÈ '
,
ÈÈ' (
Content
ÉÉ 
=
ÉÉ 
new
ÉÉ 
ScrollViewer
ÉÉ *
{
ÊÊ 
Content
ËË 
=
ËË 
new
ËË !
	TextBlock
ËË" +
{
ÌÌ 
Text
ÍÍ 
=
ÍÍ 
_lastErrorDetails
ÍÍ 0
,
ÍÍ0 1
TextWrapping
ÎÎ $
=
ÎÎ% &
TextWrapping
ÎÎ' 3
.
ÎÎ3 4
Wrap
ÎÎ4 8
,
ÎÎ8 9

FontFamily
ÏÏ "
=
ÏÏ# $
new
ÏÏ% (
	Microsoft
ÏÏ) 2
.
ÏÏ2 3
UI
ÏÏ3 5
.
ÏÏ5 6
Xaml
ÏÏ6 :
.
ÏÏ: ;
Media
ÏÏ; @
.
ÏÏ@ A

FontFamily
ÏÏA K
(
ÏÏK L
$str
ÏÏL V
)
ÏÏV W
}
ÐÐ 
,
ÐÐ 
	MaxHeight
ÑÑ 
=
ÑÑ 
$num
ÑÑ  #
}
ÒÒ 
,
ÒÒ 
CloseButtonText
ÓÓ 
=
ÓÓ  !
$str
ÓÓ" )
,
ÓÓ) *
XamlRoot
ÔÔ 
=
ÔÔ 
this
ÔÔ 
.
ÔÔ  
Content
ÔÔ  '
.
ÔÔ' (
XamlRoot
ÔÔ( 0
}
ÕÕ 
;
ÕÕ 
await
ÖÖ 
dialog
ÖÖ 
.
ÖÖ 
	ShowAsync
ÖÖ "
(
ÖÖ" #
)
ÖÖ# $
;
ÖÖ$ %
}
×× 	
}
ØØ 
}ÙÙ R
PC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Imports.csö
wC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\TableToSelectionVisibilityConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class /
#TableToSelectionVisibilityConverter 0
:1 2
IValueConverter3 B
{ 
public		 

object		 
Convert		 
(		 
object		  
value		! &
,		& '
Type		( ,

targetType		- 7
,		7 8
object		9 ?
	parameter		@ I
,		I J
string		K Q
language		R Z
)		Z [
{

 
if 

( 
value 
!= 
null 
&& 
	parameter &
!=' )
null* .
). /
{ 	
return 
value 
. 
Equals 
(  
	parameter  )
)) *
?+ ,

Visibility- 7
.7 8
Visible8 ?
:@ A

VisibilityB L
.L M
	CollapsedM V
;V W
} 	
return 

Visibility 
. 
	Collapsed #
;# $
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} ©
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\TableStatusToBrushConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public		 
class		 '
TableStatusToBrushConverter		 (
:		) *
IValueConverter		+ :
{

 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{ 
if 

( 
value 
is 
TableStatus  
status! '
)' (
{ 	
return 
status 
switch  
{ 
TableStatus 
. 
	Available %
=>& (
new) ,
SolidColorBrush- <
(< =
	Microsoft= F
.F G
UIG I
.I J
ColorsJ P
.P Q

LightGreenQ [
)[ \
,\ ]
TableStatus 
. 
Seat  
=>! #
new$ '
SolidColorBrush( 7
(7 8
	Microsoft8 A
.A B
UIB D
.D E
ColorsE K
.K L
OrangeL R
)R S
,S T
TableStatus 
. 
Dirty !
=>" $
new% (
SolidColorBrush) 8
(8 9
	Microsoft9 B
.B C
UIC E
.E F
ColorsF L
.L M
	LightGrayM V
)V W
,W X
TableStatus 
. 
Booked "
=># %
new& )
SolidColorBrush* 9
(9 :
	Microsoft: C
.C D
UID F
.F G
ColorsG M
.M N
	LightBlueN W
)W X
,X Y
TableStatus 
. 
Disable #
=>$ &
new' *
SolidColorBrush+ :
(: ;
	Microsoft; D
.D E
UIE G
.G H
ColorsH N
.N O
RedO R
)R S
,S T
_ 
=> 
new 
SolidColorBrush (
(( )
	Microsoft) 2
.2 3
UI3 5
.5 6
Colors6 <
.< =
	LightGray= F
)F G
} 
; 
} 	
return 
new 
SolidColorBrush "
(" #
	Microsoft# ,
., -
UI- /
./ 0
Colors0 6
.6 7
	LightGray7 @
)@ A
;A B
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
}   
}!! â
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\StringVisibilityConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class %
StringVisibilityConverter &
:' (
IValueConverter) 8
{ 
public		 

object		 
Convert		 
(		 
object		  
value		! &
,		& '
Type		( ,

targetType		- 7
,		7 8
object		9 ?
	parameter		@ I
,		I J
string		K Q
language		R Z
)		Z [
{

 
var 
input 
= 
value 
as 
string #
;# $
bool 
	isVisible 
= 
! 
string  
.  !
IsNullOrEmpty! .
(. /
input/ 4
)4 5
;5 6
if 

( 
	parameter 
is 
string 
param  %
&&& (
() *
param* /
./ 0
Equals0 6
(6 7
$str7 @
,@ A
StringComparisonB R
.R S
OrdinalIgnoreCaseS d
)d e
||f h
parami n
.n o
Equalso u
(u v
$strv ~
,~ 
StringComparison
€ 
.
 ‘
OrdinalIgnoreCase
‘ ¢
)
¢ £
)
£ ¤
)
¤ ¥
{ 	
	isVisible 
= 
! 
	isVisible "
;" #
} 	
return 
	isVisible 
? 

Visibility %
.% &
Visible& -
:. /

Visibility0 :
.: ;
	Collapsed; D
;D E
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} ü

iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\StringToBoolConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class !
StringToBoolConverter "
:# $
IValueConverter% 4
{ 
public		 

object		 
Convert		 
(		 
object		  
value		! &
,		& '
Type		( ,

targetType		- 7
,		7 8
object		9 ?
	parameter		@ I
,		I J
string		K Q
language		R Z
)		Z [
{

 
return 
! 
string 
. 
IsNullOrEmpty $
($ %
value% *
?* +
.+ ,
ToString, 4
(4 5
)5 6
)6 7
;7 8
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} ²
iC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\StringFormatConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class !
StringFormatConverter "
:# $
IValueConverter% 4
{ 
public		 

object		 
Convert		 
(		 
object		  
value		! &
,		& '
Type		( ,

targetType		- 7
,		7 8
object		9 ?
	parameter		@ I
,		I J
string		K Q
language		R Z
)		Z [
{

 
if 

( 
	parameter 
== 
null 
) 
return 
value 
? 
. 
ToString "
(" #
)# $
??% '
string( .
.. /
Empty/ 4
;4 5
return 
string 
. 
Format 
( 
	parameter &
.& '
ToString' /
(/ 0
)0 1
,1 2
value3 8
)8 9
;9 :
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} å&
oC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\StringColorToBrushConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public		 
class		 '
StringColorToBrushConverter		 (
:		) *
IValueConverter		+ :
{

 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{ 
if 

( 
value 
is 
string 
colorString '
&&( *
!+ ,
string, 2
.2 3
IsNullOrEmpty3 @
(@ A
colorStringA L
)L M
)M N
{ 	
try 
{ 
if 
( 
colorString 
.  

StartsWith  *
(* +
$str+ .
). /
)/ 0
{ 
colorString 
=  !
colorString" -
.- .
	Substring. 7
(7 8
$num8 9
)9 :
;: ;
if 
( 
colorString #
.# $
Length$ *
==+ -
$num. /
)/ 0
colorString #
=$ %
$str& *
++ ,
colorString- 8
;8 9
byte 
a 
= 
System #
.# $
Convert$ +
.+ ,
ToByte, 2
(2 3
colorString3 >
.> ?
	Substring? H
(H I
$numI J
,J K
$numL M
)M N
,N O
$numP R
)R S
;S T
byte 
r 
= 
System #
.# $
Convert$ +
.+ ,
ToByte, 2
(2 3
colorString3 >
.> ?
	Substring? H
(H I
$numI J
,J K
$numL M
)M N
,N O
$numP R
)R S
;S T
byte 
g 
= 
System #
.# $
Convert$ +
.+ ,
ToByte, 2
(2 3
colorString3 >
.> ?
	Substring? H
(H I
$numI J
,J K
$numL M
)M N
,N O
$numP R
)R S
;S T
byte 
b 
= 
System #
.# $
Convert$ +
.+ ,
ToByte, 2
(2 3
colorString3 >
.> ?
	Substring? H
(H I
$numI J
,J K
$numL M
)M N
,N O
$numP R
)R S
;S T
return 
new 
SolidColorBrush .
(. /
Windows/ 6
.6 7
UI7 9
.9 :
Color: ?
.? @
FromArgb@ H
(H I
aI J
,J K
rL M
,M N
gO P
,P Q
bR S
)S T
)T U
;U V
} 
else 
{ 
System!! 
.!! 
Diagnostics!! &
.!!& '
Debug!!' ,
.!!, -
	WriteLine!!- 6
(!!6 7
$"!!7 9
$str!!9 z
{!!z {
value	!!{ €
}
!!€ 
$str
!! ‚
"
!!‚ ƒ
)
!!ƒ „
;
!!„ …
}"" 
}## 
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$  
{%% 
System'' 
.'' 
Diagnostics'' "
.''" #
Debug''# (
.''( )
	WriteLine'') 2
(''2 3
$"''3 5
$str''5 j
{''j k
value''k p
}''p q
$str''q t
{''t u
ex''u w
.''w x
Message''x 
}	'' €
"
''€ 
)
'' ‚
;
''‚ ƒ
}(( 
})) 	
return,, 
new,, 
SolidColorBrush,, "
(,," #
Colors,,# )
.,,) *
	LightGray,,* 3
),,3 4
;,,4 5
}-- 
public// 

object// 
ConvertBack// 
(// 
object// $
value//% *
,//* +
Type//, 0

targetType//1 ;
,//; <
object//= C
	parameter//D M
,//M N
string//O U
language//V ^
)//^ _
{00 
return11 
DependencyProperty11 !
.11! "

UnsetValue11" ,
;11, -
}22 
}33 ¦
pC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\ShapeToCornerRadiusConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class (
ShapeToCornerRadiusConverter )
:* +
IValueConverter, ;
{		 
public

 

object

 
Convert

 
(

 
object

  
value

! &
,

& '
Type

( ,

targetType

- 7
,

7 8
object

9 ?
	parameter

@ I
,

I J
string

K Q
language

R Z
)

Z [
{ 
if 

( 
value 
is 
TableShapeType #
shape$ )
)) *
{ 	
return 
ConvertShape 
(  
shape  %
)% &
;& '
} 	
if 

( 
value 
is 
int 
intValue !
)! "
{ 	
return 
ConvertShape 
(  
(  !
TableShapeType! /
)/ 0
intValue0 8
)8 9
;9 :
} 	
return 
new 
	Microsoft 
. 
UI 
.  
Xaml  $
.$ %
CornerRadius% 1
(1 2
$num2 3
)3 4
;4 5
} 
private 
	Microsoft 
. 
UI 
. 
Xaml 
. 
CornerRadius *
ConvertShape+ 7
(7 8
TableShapeType8 F
shapeG L
)L M
{ 
return 
shape 
switch 
{ 	
TableShapeType 
. 
	Rectangle $
=>% '
new( +
	Microsoft, 5
.5 6
UI6 8
.8 9
Xaml9 =
.= >
CornerRadius> J
(J K
$numK L
)L M
,M N
TableShapeType 
. 
Square !
=>" $
new% (
	Microsoft) 2
.2 3
UI3 5
.5 6
Xaml6 :
.: ;
CornerRadius; G
(G H
$numH I
)I J
,J K
TableShapeType 
. 
Round  
=>! #
new$ '
	Microsoft( 1
.1 2
UI2 4
.4 5
Xaml5 9
.9 :
CornerRadius: F
(F G
$numG I
)I J
,J K
TableShapeType   
.   
Oval   
=>    "
new  # &
	Microsoft  ' 0
.  0 1
UI  1 3
.  3 4
Xaml  4 8
.  8 9
CornerRadius  9 E
(  E F
$num  F H
)  H I
,  I J
_!! 
=>!! 
new!! 
	Microsoft!! 
.!! 
UI!! !
.!!! "
Xaml!!" &
.!!& '
CornerRadius!!' 3
(!!3 4
$num!!4 5
)!!5 6
}"" 	
;""	 

}## 
public%% 

object%% 
ConvertBack%% 
(%% 
object%% $
value%%% *
,%%* +
Type%%, 0

targetType%%1 ;
,%%; <
object%%= C
	parameter%%D M
,%%M N
string%%O U
language%%V ^
)%%^ _
{&& 
return'' 
DependencyProperty'' !
.''! "

UnsetValue''" ,
;'', -
}(( 
})) «
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\NullToVisibilityConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class %
NullToVisibilityConverter &
:' (
IValueConverter) 8
{ 
public		 

object		 
Convert		 
(		 
object		  
value		! &
,		& '
Type		( ,

targetType		- 7
,		7 8
object		9 ?
	parameter		@ I
,		I J
string		K Q
language		R Z
)		Z [
{

 
bool 
	isNotNull 
= 
value 
!= !
null" &
;& '
if 

( 
	parameter 
is 
string 
paramStr  (
&&) +
paramStr, 4
.4 5
Equals5 ;
(; <
$str< E
,E F
StringComparisonG W
.W X
OrdinalIgnoreCaseX i
)i j
)j k
{ 	
	isNotNull 
= 
! 
	isNotNull "
;" #
} 	
return 
	isNotNull 
? 

Visibility %
.% &
Visible& -
:. /

Visibility0 :
.: ;
	Collapsed; D
;D E
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} Ñ
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\InverseBooleanConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class #
InverseBooleanConverter $
:% &
IValueConverter' 6
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{		 
if

 

(

 
value

 
is

 
bool

 
	boolValue

 #
)

# $
{ 	
return 
! 
	boolValue 
; 
} 	
return 
false 
; 
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
if 

( 
value 
is 
bool 
	boolValue #
)# $
{ 	
return 
! 
	boolValue 
; 
} 	
return 
false 
; 
} 
} ô
fC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\IntToSizeConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class 
IntToSizeConverter 
:  !
IValueConverter" 1
{ 
public		 

object		 
Convert		 
(		 
object		  
value		! &
,		& '
Type		( ,

targetType		- 7
,		7 8
object		9 ?
	parameter		@ I
,		I J
string		K Q
language		R Z
)		Z [
{

 
if 

( 
value 
is 
int 
size 
) 
{ 	
return 
$" 
{ 
size 
} 
$str 
" 
;  
} 	
return 
$str 
; 
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} 
public 
class %
IntToPreviewSizeConverter &
:' (
IValueConverter) 8
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{ 
if 

( 
value 
is 
int 
size 
) 
{ 	
return   
Math   
.   
Min   
(   
$num   
,    
size  ! %
/  & '
$num  ( *
)  * +
;  + ,
}!! 	
return## 
$num## 
;## 
}$$ 
public&& 

object&& 
ConvertBack&& 
(&& 
object&& $
value&&% *
,&&* +
Type&&, 0

targetType&&1 ;
,&&; <
object&&= C
	parameter&&D M
,&&M N
string&&O U
language&&V ^
)&&^ _
{'' 
return(( 
DependencyProperty(( !
.((! "

UnsetValue((" ,
;((, -
})) 
}** 
hC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\IntToDoubleConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class  
IntToDoubleConverter !
:" #
IValueConverter$ 3
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{		 
if

 

(

 
value

 
is

 
int

 
intValue

 !
)

! "
{ 	
return 
( 
double 
) 
intValue #
;# $
} 	
return 
$num 
; 
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
if 

( 
value 
is 
double 
doubleValue '
)' (
{ 	
return 
( 
int 
) 
doubleValue #
;# $
} 	
return 
$num 
; 
} 
} ð
gC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\EnumToBoolConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class 
EnumToBoolConverter  
:! "
IValueConverter# 2
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{		 
if

 

(

 
value

 
==

 
null

 
||

 
	parameter

 &
==

' )
null

* .
)

. /
return 
false 
; 
var 
	enumValue 
= 
value 
. 
ToString &
(& '
)' (
;( )
var 
parameterValue 
= 
	parameter &
.& '
ToString' /
(/ 0
)0 1
;1 2
return 
	enumValue 
. 
Equals 
(  
parameterValue  .
,. /
StringComparison0 @
.@ A
OrdinalIgnoreCaseA R
)R S
;S T
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
if 

( 
value 
is 
bool 
	boolValue #
&&$ &
	boolValue' 0
&&1 3
	parameter4 =
!=> @
nullA E
)E F
{ 	
try 
{ 
return 
Enum 
. 
Parse !
(! "

targetType" ,
,, -
	parameter. 7
.7 8
ToString8 @
(@ A
)A B
)B C
;C D
} 
catch 
( 
	Exception 
ex 
)  
{ 
System 
. 
Diagnostics "
." #
Debug# (
.( )
	WriteLine) 2
(2 3
$"   
$str   H
"  H I
+  J K
$"!! 
$str!! "
{!!" #

targetType!!# -
?!!- .
.!!. /
Name!!/ 3
}!!3 4
$str!!4 B
{!!B C
	parameter!!C L
}!!L M
$str!!M W
{!!W X
ex!!X Z
.!!Z [
Message!![ b
}!!b c
"!!c d
)!!d e
;!!e f
}"" 
}## 	
return%% 
DependencyProperty%% !
.%%! "

UnsetValue%%" ,
;%%, -
}&& 
}'' §
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\DecimalToDoubleConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class $
DecimalToDoubleConverter %
:& '
IValueConverter( 7
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{		 
if

 

(

 
value

 
is

 
decimal

 
decimalValue

 )
)

) *
{ 	
return 
( 
double 
) 
decimalValue '
;' (
} 	
return 
$num 
; 
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
if 

( 
value 
is 
double 
doubleValue '
)' (
{ 	
return 
( 
decimal 
) 
doubleValue '
;' (
} 	
return 
$num 
; 
} 
} ï
kC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\DateTimeToTimeConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class #
DateTimeToTimeConverter $
:% &
IValueConverter' 6
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{		 
if

 

(

 
value

 
is

 
DateTime

 
dateTime

 &
)

& '
{ 	
if 
( 
dateTime 
== 
DateTime $
.$ %
MinValue% -
)- .
{ 
return 
$str 
; 
} 
var 
now 
= 
DateTime 
. 
Now "
;" #
var 
diff 
= 
now 
- 
dateTime %
;% &
if 
( 
diff 
. 
TotalSeconds !
<" #
$num$ &
)& '
{ 
return 
$str !
;! "
} 
else 
if 
( 
diff 
. 
TotalMinutes &
<' (
$num) +
)+ ,
{ 
return 
$" 
{ 
( 
int 
) 
diff #
.# $
TotalMinutes$ 0
}0 1
$str1 6
"6 7
;7 8
} 
else 
if 
( 
diff 
. 

TotalHours $
<% &
$num' )
)) *
{ 
return 
$" 
{ 
( 
int 
) 
diff #
.# $

TotalHours$ .
}. /
$str/ 4
"4 5
;5 6
} 
else   
{!! 
return"" 
dateTime"" 
.""  
ToString""  (
(""( )
$str"") 8
)""8 9
;""9 :
}## 
}$$ 	
return&& 
$str&& 
;&& 
}'' 
public)) 

object)) 
ConvertBack)) 
()) 
object)) $
value))% *
,))* +
Type)), 0

targetType))1 ;
,)); <
object))= C
	parameter))D M
,))M N
string))O U
language))V ^
)))^ _
{** 
return++ 
DependencyProperty++ !
.++! "

UnsetValue++" ,
;++, -
},, 
}-- Ò
eC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\CurrencyConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public		 
class		 
CurrencyConverter		 
:		  
IValueConverter		! 0
{

 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{ 
if 

( 
value 
is 
decimal 
decimalValue )
)) *
{ 	
return 
decimalValue 
.  
ToString  (
(( )
$str) ,
,, -
CultureInfo. 9
.9 :
CurrentCulture: H
)H I
;I J
} 	
if 

( 
value 
is 
double 
doubleValue '
)' (
{ 	
return 
doubleValue 
. 
ToString '
(' (
$str( +
,+ ,
CultureInfo- 8
.8 9
CurrentCulture9 G
)G H
;H I
} 	
return 
value 
? 
. 
ToString 
( 
)  
??! #
string$ *
.* +
Empty+ 0
;0 1
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} ¹
xC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\CollectionEmptyToVisibilityConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class 0
$CollectionEmptyToVisibilityConverter 1
:2 3
IValueConverter4 C
{		 
public

 

object

 
Convert

 
(

 
object

  
value

! &
,

& '
Type

( ,

targetType

- 7
,

7 8
object

9 ?
	parameter

@ I
,

I J
string

K Q
language

R Z
)

Z [
{ 
if 

( 
value 
is 
IEnumerable  

collection! +
)+ ,
{ 	
var 

enumerator 
= 

collection '
.' (
GetEnumerator( 5
(5 6
)6 7
;7 8
bool 
hasItems 
= 

enumerator &
.& '
MoveNext' /
(/ 0
)0 1
;1 2
bool 
	isInverse 
= 
	parameter &
?& '
.' (
ToString( 0
(0 1
)1 2
==3 5
$str6 ?
;? @
if 
( 
	isInverse 
) 
return 
hasItems 
?  !

Visibility" ,
., -
Visible- 4
:5 6

Visibility7 A
.A B
	CollapsedB K
;K L
else 
return 
hasItems 
?  !

Visibility" ,
., -
	Collapsed- 6
:7 8

Visibility9 C
.C D
VisibleD K
;K L
} 	
return 

Visibility 
. 
Visible !
;! "
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return   
DependencyProperty   !
.  ! "

UnsetValue  " ,
;  , -
}!! 
}"" 
mC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\BoolToVisibilityConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class %
BoolToVisibilityConverter &
:' (
IValueConverter) 8
{ 
public		 

object		 
Convert		 
(		 
object		  
value		! &
,		& '
Type		( ,

targetType		- 7
,		7 8
object		9 ?
	parameter		@ I
,		I J
string		K Q
language		R Z
)		Z [
{

 
bool 

isReversed 
= 
	parameter #
is$ &
string' -
s. /
&&0 2
(3 4
s4 5
.5 6
Equals6 <
(< =
$str= F
,F G
StringComparisonH X
.X Y
OrdinalIgnoreCaseY j
)j k
||l n
so p
.p q
Equalsq w
(w x
$str	x €
,
€ 
StringComparison
‚ ’
.
’ “
OrdinalIgnoreCase
“ ¤
)
¤ ¥
)
¥ ¦
;
¦ §
if 

( 
value 
is 
bool 
	boolValue #
)# $
{ 	
if 
( 

isReversed 
) 
{ 
return 
! 
	boolValue !
?" #

Visibility$ .
.. /
Visible/ 6
:7 8

Visibility9 C
.C D
	CollapsedD M
;M N
} 
return 
	boolValue 
? 

Visibility )
.) *
Visible* 1
:2 3

Visibility4 >
.> ?
	Collapsed? H
;H I
} 	
return 

Visibility 
. 
	Collapsed #
;# $
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
if 

( 
value 
is 

Visibility 

visibility  *
)* +
{ 	
return 

visibility 
==  

Visibility! +
.+ ,
Visible, 3
;3 4
} 	
return   
false   
;   
}!! 
}"" 
public'' 
class'' (
BooleanToVisibilityConverter'' )
:''* +%
BoolToVisibilityConverter'', E
{''F G
}''H Iè
qC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\BoolToDesignModeTextConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class )
BoolToDesignModeTextConverter *
:+ ,
IValueConverter- <
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{		 
if

 

(

 
value

 
is

 
bool

 
isDesignMode

 &
)

& '
{ 	
return 
isDesignMode 
?  !
$str" *
:+ ,
$str- 3
;3 4
} 	
return 
$str 
; 
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
return 
DependencyProperty !
.! "

UnsetValue" ,
;, -
} 
} Ã
lC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\Converters\BooleanToStringConverter.cs
	namespace 	
Magidesk
 
. 
Presentation 
.  

Converters  *
;* +
public 
class $
BooleanToStringConverter %
:& '
IValueConverter( 7
{ 
public 

object 
Convert 
( 
object  
value! &
,& '
Type( ,

targetType- 7
,7 8
object9 ?
	parameter@ I
,I J
stringK Q
languageR Z
)Z [
{		 
if

 

(

 
value

 
is

 
bool

 
	boolValue

 #
)

# $
{ 	
var 
options 
= 
	parameter #
?# $
.$ %
ToString% -
(- .
). /
?/ 0
.0 1
Split1 6
(6 7
$char7 :
): ;
;; <
if 
( 
options 
!= 
null 
&&  "
options# *
.* +
Length+ 1
==2 4
$num5 6
)6 7
{ 
return 
	boolValue  
?! "
options# *
[* +
$num+ ,
], -
:. /
options0 7
[7 8
$num8 9
]9 :
;: ;
} 
return 
	boolValue 
. 
ToString %
(% &
)& '
;' (
} 	
return 
$str 
; 
} 
public 

object 
ConvertBack 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 
throw 
new #
NotImplementedException )
() *
)* +
;+ ,
} 
} ¼©
QC:\Users\giris\Documents\Code\Redesign-POS\Windows Based POS\Magidesk\App.xaml.cs
	namespace 	
Magidesk
 
. 
Presentation 
;  
public 
partial 
class 
App 
: 
	Microsoft $
.$ %
UI% '
.' (
Xaml( ,
., -
Application- 8
{ 
private 
Window 
? 
_window 
; 
public 

static 
Window 
? 
MainWindowInstance ,
{- .
get/ 2
;2 3
private4 ;
set< ?
;? @
}A B
public 

static 
IHost 
Host 
{ 
get "
;" #
private$ +
set, /
;/ 0
}1 2
=3 4
null5 9
!9 :
;: ;
public!! 

static!! 
IServiceProvider!! "
Services!!# +
=>!!, .
Host!!/ 3
.!!3 4
Services!!4 <
;!!< =
[## 
System## 
.## 
Runtime## 
.## 
InteropServices## #
.### $
	DllImport##$ -
(##- .
$str##. :
,##: ;
CharSet##< C
=##D E
System##F L
.##L M
Runtime##M T
.##T U
InteropServices##U d
.##d e
CharSet##e l
.##l m
Unicode##m t
)##t u
]##u v
public$$ 

static$$ 
extern$$ 
int$$ 

MessageBox$$ '
($$' (
IntPtr$$( .
hWnd$$/ 3
,$$3 4
String$$5 ;
text$$< @
,$$@ A
String$$B H
caption$$I P
,$$P Q
uint$$R V
type$$W [
)$$[ \
;$$\ ]
public&& 

App&& 
(&& 
)&& 
{'' 
StartupLogger)) 
.)) 
Log)) 
()) 
$str)) 3
)))3 4
;))4 5
	AppDomain++ 
.++ 
CurrentDomain++ 
.++  
UnhandledException++  2
+=++3 5,
 CurrentDomain_UnhandledException++6 V
;++V W
TaskScheduler,, 
.,, #
UnobservedTaskException,, -
+=,,. 01
%TaskScheduler_UnobservedTaskException,,1 V
;,,V W
this-- 
.-- 
UnhandledException-- 
+=--  ""
App_UnhandledException--# 9
;--9 :
StartupLogger// 
.// 
Log// 
(// 
$str// ;
)//; <
;//< =
try00 
{00 
InitializeComponent11 
(11  
)11  !
;11! "
StartupLogger22 
.22 
Log22 
(22 
$str22 A
)22A B
;22B C
}33 	
catch33
 
(33 
	Exception33 
ex33 
)33 
{33  #
HandleFatalStartupError44 #
(44# $
$str44$ @
,44@ A
ex44B D
)44D E
;44E F
throw55 
;55 
}66 	
StartupLogger88 
.88 
Log88 
(88 
$str88 5
)885 6
;886 7
try99 
{99 
Host:: 
=:: 
	Microsoft:: 
.:: 

Extensions:: '
.::' (
Hosting::( /
.::/ 0
Host::0 4
.;;  
CreateDefaultBuilder;; %
(;;% &
);;& '
.<< 
ConfigureServices<< "
(<<" #
services<<# +
=><<, .
{== 
StartupLogger>> !
.>>! "
Log>>" %
(>>% &
$str>>& E
)>>E F
;>>F G
services@@ 
.@@ 
AddApplication@@ +
(@@+ ,
)@@, -
;@@- .
StartupLoggerAA !
.AA! "
LogAA" %
(AA% &
$strAA& D
)AAD E
;AAE F
servicesBB 
.BB 
AddInfrastructureBB .
(BB. /
)BB/ 0
;BB0 1
StartupLoggerCC !
.CC! "
LogCC" %
(CC% &
$strCC& G
)CCG H
;CCH I
servicesFF 
.FF 
AddSingletonFF )
<FF) *
NavigationServiceFF* ;
>FF; <
(FF< =
)FF= >
;FF> ?
servicesGG 
.GG 
AddSingletonGG )
<GG) *&
IDefaultViewRoutingServiceGG* D
,GGD E%
DefaultViewRoutingServiceGGF _
>GG_ `
(GG` a
)GGa b
;GGb c
servicesHH 
.HH 
AddSingletonHH )
<HH) *$
IOrderEntryDialogServiceHH* B
,HHB C#
OrderEntryDialogServiceHHD [
>HH[ \
(HH\ ]
)HH] ^
;HH^ _
servicesII 
.II 
AddSingletonII )
<II) *%
ISwitchboardDialogServiceII* C
,IIC D$
SwitchboardDialogServiceIIE ]
>II] ^
(II^ _
)II_ `
;II` a
servicesJJ 
.JJ 
AddSingletonJJ )
<JJ) *
IDialogServiceJJ* 8
,JJ8 9 
WindowsDialogServiceJJ: N
>JJN O
(JJO P
)JJP Q
;JJQ R
servicesKK 
.KK 
AddSingletonKK )
<KK) *
IUserServiceKK* 6
,KK6 7
UserServiceKK8 C
>KKC D
(KKD E
)KKE F
;KKF G
servicesLL 
.LL 
AddSingletonLL )
<LL) *
MagideskLL* 2
.LL2 3
ApplicationLL3 >
.LL> ?

InterfacesLL? I
.LLI J
ITerminalContextLLJ Z
,LLZ [
TerminalContextLL\ k
>LLk l
(LLl m
)LLm n
;LLn o
servicesNN 
.NN 
AddSingletonNN !
<NN! "
MagideskNN" *
.NN* +
ApplicationNN+ 6
.NN6 7

InterfacesNN7 A
.NNA B
IPrintingServiceNNB R
,NNR S
InfrastructureNNT b
.NNb c
ServicesNNc k
.NNk l
PrintingServiceNNl {
>NN{ |
(NN| }
)NN} ~
;NN~ 
servicesOO 
.OO 
AddSingletonOO !
<OO! "
MagideskOO" *
.OO* +
ApplicationOO+ 6
.OO6 7

InterfacesOO7 A
.OOA B
IRawPrintServiceOOB R
,OOR S
InfrastructureOOT b
.OOb c
PrintingOOc k
.OOk l#
WindowsPrintingService	OOl ‚
>
OO‚ ƒ
(
OOƒ „
)
OO„ …
;
OO… †
servicesPP 
.PP 
	AddScopedPP 
<PP 
MagideskPP '
.PP' (
ApplicationPP( 3
.PP3 4

InterfacesPP4 >
.PP> ? 
IKitchenPrintServicePP? S
,PPS T
InfrastructurePPU c
.PPc d
PrintingPPd l
.PPl m 
KitchenPrintService	PPm €
>
PP€ 
(
PP ‚
)
PP‚ ƒ
;
PPƒ „
servicesQQ 
.QQ 
AddSingletonQQ !
<QQ! "
MagideskQQ" *
.QQ* +
ApplicationQQ+ 6
.QQ6 7

InterfacesQQ7 A
.QQA B
ICashDrawerServiceQQB T
,QQT U
InfrastructureQQV d
.QQd e
ServicesQQe m
.QQm n
CashDrawerServiceQQn 
>	QQ €
(
QQ€ 
)
QQ ‚
;
QQ‚ ƒ
servicesRR 
.RR 
AddTransientRR !
<RR! "
MagideskRR" *
.RR* +
ApplicationRR+ 6
.RR6 7

InterfacesRR7 A
.RRA B
ICommandHandlerRRB Q
<RRQ R
MagideskRRR Z
.RRZ [
ApplicationRR[ f
.RRf g
CommandsRRg o
.RRo p"
OpenCashDrawerCommand	RRp …
>
RR… †
,
RR† ‡
Magidesk
RRˆ 
.
RR ‘
Application
RR‘ œ
.
RRœ 
Commands
RR ¥
.
RR¥ ¦*
OpenCashDrawerCommandHandler
RR¦ Â
>
RRÂ Ã
(
RRÃ Ä
)
RRÄ Å
;
RRÅ Æ
servicesSS 
.SS 
	AddScopedSS 
<SS 
MagideskSS '
.SS' (
ApplicationSS( 3
.SS3 4

InterfacesSS4 >
.SS> ? 
IReceiptPrintServiceSS? S
,SSS T
InfrastructureSSU c
.SSc d
PrintingSSd l
.SSl m 
ReceiptPrintService	SSm €
>
SS€ 
(
SS ‚
)
SS‚ ƒ
;
SSƒ „
StartupLoggerVV !
.VV! "
LogVV" %
(VV% &
$strVV& G
)VVG H
;VVH I
servicesWW 
.WW 
AddTransientWW )
<WW) *
MagideskWW* 2
.WW2 3
PresentationWW3 ?
.WW? @

ViewModelsWW@ J
.WWJ K
OrderEntryViewModelWWK ^
>WW^ _
(WW_ `
)WW` a
;WWa b
servicesXX 
.XX 
AddTransientXX )
<XX) *
MagideskXX* 2
.XX2 3
PresentationXX3 ?
.XX? @

ViewModelsXX@ J
.XXJ K
BackOfficeViewModelXXK ^
>XX^ _
(XX_ `
)XX` a
;XXa b
servicesYY 
.YY 
AddTransientYY )
<YY) *
MagideskYY* 2
.YY2 3
PresentationYY3 ?
.YY? @

ViewModelsYY@ J
.YYJ K
MenuEditorViewModelYYK ^
>YY^ _
(YY_ `
)YY` a
;YYa b
servicesZZ 
.ZZ 
AddTransientZZ )
<ZZ) *
MagideskZZ* 2
.ZZ2 3
PresentationZZ3 ?
.ZZ? @

ViewModelsZZ@ J
.ZZJ K#
ModifierEditorViewModelZZK b
>ZZb c
(ZZc d
)ZZd e
;ZZe f
services[[ 
.[[ 
AddTransient[[ )
<[[) *
Magidesk[[* 2
.[[2 3
Presentation[[3 ?
.[[? @

ViewModels[[@ J
.[[J K
InventoryViewModel[[K ]
>[[] ^
([[^ _
)[[_ `
;[[` a
services\\ 
.\\ 
AddTransient\\ )
<\\) *
Magidesk\\* 2
.\\2 3
Presentation\\3 ?
.\\? @

ViewModels\\@ J
.\\J K 
CashSessionViewModel\\K _
>\\_ `
(\\` a
)\\a b
;\\b c
services]] 
.]] 
AddTransient]] )
<]]) *
Magidesk]]* 2
.]]2 3
Presentation]]3 ?
.]]? @

ViewModels]]@ J
.]]J K
TicketViewModel]]K Z
>]]Z [
(]][ \
)]]\ ]
;]]] ^
services^^ 
.^^ 
AddTransient^^ )
<^^) *
Magidesk^^* 2
.^^2 3
Presentation^^3 ?
.^^? @

ViewModels^^@ J
.^^J K
PaymentViewModel^^K [
>^^[ \
(^^\ ]
)^^] ^
;^^^ _
services__ 
.__ 
AddTransient__ )
<__) *
Magidesk__* 2
.__2 3
Presentation__3 ?
.__? @

ViewModels__@ J
.__J K 
DiscountTaxViewModel__K _
>___ `
(__` a
)__a b
;__b c
services`` 
.`` 
AddTransient`` )
<``) *
Magidesk``* 2
.``2 3
Presentation``3 ?
.``? @

ViewModels``@ J
.``J K
PrintViewModel``K Y
>``Y Z
(``Z [
)``[ \
;``\ ]
servicesaa 
.aa 
AddTransientaa )
<aa) *
Magideskaa* 2
.aa2 3
Presentationaa3 ?
.aa? @

ViewModelsaa@ J
.aaJ K%
TicketManagementViewModelaaK d
>aad e
(aae f
)aaf g
;aag h
servicesbb 
.bb 
AddTransientbb )
<bb) *
Magideskbb* 2
.bb2 3
Presentationbb3 ?
.bb? @

ViewModelsbb@ J
.bbJ K%
DrawerPullReportViewModelbbK d
>bbd e
(bbe f
)bbf g
;bbg h
servicescc 
.cc 
AddTransientcc )
<cc) *
Magideskcc* 2
.cc2 3
Presentationcc3 ?
.cc? @

ViewModelscc@ J
.ccJ K!
SalesReportsViewModelccK `
>cc` a
(cca b
)ccb c
;ccc d
servicesdd 
.dd 
AddTransientdd )
<dd) *
Magideskdd* 2
.dd2 3
Presentationdd3 ?
.dd? @

ViewModelsdd@ J
.ddJ K#
UserManagementViewModelddK b
>ddb c
(ddc d
)ddd e
;dde f
servicesee 
.ee 
AddTransientee )
<ee) *
Magideskee* 2
.ee2 3
Presentationee3 ?
.ee? @

ViewModelsee@ J
.eeJ K#
RoleManagementViewModeleeK b
>eeb c
(eec d
)eed e
;eee f
servicesff 
.ff 
AddTransientff )
<ff) *
Magideskff* 2
.ff2 3
Presentationff3 ?
.ff? @

ViewModelsff@ J
.ffJ K
SettingsViewModelffK \
>ff\ ]
(ff] ^
)ff^ _
;ff_ `
servicesgg 
.gg 
AddTransientgg )
<gg) *
Magideskgg* 2
.gg2 3
Presentationgg3 ?
.gg? @

ViewModelsgg@ J
.ggJ K&
OrderTypeExplorerViewModelggK e
>gge f
(ggf g
)ggg h
;ggh i
serviceshh 
.hh 
AddTransienthh )
<hh) *
Magideskhh* 2
.hh2 3
Presentationhh3 ?
.hh? @

ViewModelshh@ J
.hhJ K"
ShiftExplorerViewModelhhK a
>hha b
(hhb c
)hhc d
;hhd e
servicesii 
.ii 
AddTransientii )
<ii) *
Magideskii* 2
.ii2 3
Presentationii3 ?
.ii? @

ViewModelsii@ J
.iiJ K 
SwitchboardViewModeliiK _
>ii_ `
(ii` a
)iia b
;iib c
servicesjj 
.jj 
AddTransientjj )
<jj) *
Magideskjj* 2
.jj2 3
Presentationjj3 ?
.jj? @

ViewModelsjj@ J
.jjJ K'
OrderTypeSelectionViewModeljjK f
>jjf g
(jjg h
)jjh i
;jji j
serviceskk 
.kk 
AddTransientkk )
<kk) *
Magideskkk* 2
.kk2 3
Presentationkk3 ?
.kk? @

ViewModelskk@ J
.kkJ K&
ModifierSelectionViewModelkkK e
>kke f
(kkf g
)kkg h
;kkh i
servicesll 
.ll 
AddTransientll )
<ll) *
Magideskll* 2
.ll2 3
Presentationll3 ?
.ll? @

ViewModelsll@ J
.llJ K 
SplitTicketViewModelllK _
>ll_ `
(ll` a
)lla b
;llb c
servicesmm 
.mm 
AddTransientmm )
<mm) *
Magideskmm* 2
.mm2 3
Presentationmm3 ?
.mm? @

ViewModelsmm@ J
.mmJ K
TableMapViewModelmmK \
>mm\ ]
(mm] ^
)mm^ _
;mm_ `
servicesnn 
.nn 
AddTransientnn )
<nn) *
Magidesknn* 2
.nn2 3
Presentationnn3 ?
.nn? @

ViewModelsnn@ J
.nnJ K"
TableExplorerViewModelnnK a
>nna b
(nnb c
)nnc d
;nnd e
servicesoo 
.oo 
AddTransientoo )
<oo) *
Magideskoo* 2
.oo2 3
Presentationoo3 ?
.oo? @

ViewModelsoo@ J
.ooJ K%
VendorManagementViewModelooK d
>ood e
(ooe f
)oof g
;oog h
servicespp 
.pp 
AddTransientpp )
<pp) *
Magideskpp* 2
.pp2 3
Presentationpp3 ?
.pp? @

ViewModelspp@ J
.ppJ K"
PurchaseOrderViewModelppK a
>ppa b
(ppb c
)ppc d
;ppd e
servicesqq 
.qq 
AddTransientqq )
<qq) *
Magideskqq* 2
.qq2 3
Presentationqq3 ?
.qq? @

ViewModelsqq@ J
.qqJ K
SettleViewModelqqK Z
>qqZ [
(qq[ \
)qq\ ]
;qq] ^
servicesrr 
.rr 
AddTransientrr )
<rr) *
Magideskrr* 2
.rr2 3
Presentationrr3 ?
.rr? @

ViewModelsrr@ J
.rrJ K!
SystemConfigViewModelrrK `
>rr` a
(rra b
)rrb c
;rrc d
servicesss 
.ss 
AddTransientss )
<ss) *
Magideskss* 2
.ss2 3
Presentationss3 ?
.ss? @

ViewModelsss@ J
.ssJ K#
KitchenDisplayViewModelssK b
>ssb c
(ssc d
)ssd e
;sse f
servicestt 
.tt 
AddTransienttt )
<tt) *
Magidesktt* 2
.tt2 3
Presentationtt3 ?
.tt? @

ViewModelstt@ J
.ttJ K
LoginViewModelttK Y
>ttY Z
(ttZ [
)tt[ \
;tt\ ]
servicesuu 
.uu 
AddTransientuu )
<uu) *
Magideskuu* 2
.uu2 3
Presentationuu3 ?
.uu? @

ViewModelsuu@ J
.uuJ K
ShiftStartViewModeluuK ^
>uu^ _
(uu_ `
)uu` a
;uua b
servicesvv 
.vv 
AddTransientvv )
<vv) *
Magideskvv* 2
.vv2 3
Presentationvv3 ?
.vv? @

ViewModelsvv@ J
.vvJ K'
CashDropManagementViewModelvvK f
>vvf g
(vvg h
)vvh i
;vvi j
servicesww 
.ww 
AddTransientww )
<ww) *
Magideskww* 2
.ww2 3
Presentationww3 ?
.ww? @

ViewModelsww@ J
.wwJ K
VoidTicketViewModelwwK ^
>ww^ _
(ww_ `
)ww` a
;wwa b
servicesxx 
.xx 
AddTransientxx )
<xx) *
Magideskxx* 2
.xx2 3
Presentationxx3 ?
.xx? @

ViewModelsxx@ J
.xxJ K$
OpenTicketsListViewModelxxK c
>xxc d
(xxd e
)xxe f
;xxf g
servicesyy 
.yy 
AddTransientyy )
<yy) *
Magideskyy* 2
.yy2 3
Presentationyy3 ?
.yy? @

ViewModelsyy@ J
.yyJ K'
PaymentProcessWaitViewModelyyK f
>yyf g
(yyg h
)yyh i
;yyi j
serviceszz 
.zz 
AddTransientzz )
<zz) *
Magideskzz* 2
.zz2 3
Presentationzz3 ?
.zz? @

ViewModelszz@ J
.zzJ K
SwipeCardViewModelzzK ]
>zz] ^
(zz^ _
)zz_ `
;zz` a
services{{ 
.{{ 
AddTransient{{ )
<{{) *
Magidesk{{* 2
.{{2 3
Presentation{{3 ?
.{{? @

ViewModels{{@ J
.{{J K&
AuthorizationCodeViewModel{{K e
>{{e f
({{f g
){{g h
;{{h i
services|| 
.|| 
AddTransient|| )
<||) *
Magidesk||* 2
.||2 3
Presentation||3 ?
.||? @

ViewModels||@ J
.||J K.
"AuthorizationCaptureBatchViewModel||K m
>||m n
(||n o
)||o p
;||p q
services}} 
.}} 
AddTransient}} )
<}}) *
Magidesk}}* 2
.}}2 3
Presentation}}3 ?
.}}? @

ViewModels}}@ J
.}}J K
GuestCountViewModel}}K ^
>}}^ _
(}}_ `
)}}` a
;}}a b
services~~ 
.~~ 
AddTransient~~ )
<~~) *
Magidesk~~* 2
.~~2 3
Presentation~~3 ?
.~~? @

ViewModels~~@ J
.~~J K%
ManagerFunctionsViewModel~~K d
>~~d e
(~~e f
)~~f g
;~~g h
services 
. 
AddTransient )
<) *
Magidesk* 2
.2 3
Presentation3 ?
.? @

ViewModels@ J
.J K/
#GroupSettleTicketSelectionViewModelK n
>n o
(o p
)p q
;q r
services
€€ 
.
€€ 
AddTransient
€€ )
<
€€) *
Magidesk
€€* 2
.
€€2 3
Presentation
€€3 ?
.
€€? @

ViewModels
€€@ J
.
€€J K(
GroupSettleTicketViewModel
€€K e
>
€€e f
(
€€f g
)
€€g h
;
€€h i
services
 
.
 
AddTransient
 )
<
) *
Magidesk
* 2
.
2 3
Presentation
3 ?
.
? @

ViewModels
@ J
.
J K
Dialogs
K R
.
R S%
TableSelectionViewModel
S j
>
j k
(
k l
)
l m
;
m n
services
‚‚ 
.
‚‚ 
AddTransient
‚‚ )
<
‚‚) *
Magidesk
‚‚* 2
.
‚‚2 3
Presentation
‚‚3 ?
.
‚‚? @

ViewModels
‚‚@ J
.
‚‚J K
Dialogs
‚‚K R
.
‚‚R S"
NotesDialogViewModel
‚‚S g
>
‚‚g h
(
‚‚h i
)
‚‚i j
;
‚‚j k
services
ƒƒ 
.
ƒƒ 
AddTransient
ƒƒ )
<
ƒƒ) *$
TableDesignerViewModel
ƒƒ* @
>
ƒƒ@ A
(
ƒƒA B
)
ƒƒB C
;
ƒƒC D
services
„„ 
.
„„ 
AddTransient
„„ )
<
„„) *&
FloorManagementViewModel
„„* B
>
„„B C
(
„„C D
)
„„D E
;
„„E F
services
…… 
.
…… 
AddTransient
…… )
<
……) *-
ExportImportManagementViewModel
……* I
>
……I J
(
……J K
)
……K L
;
……L M
services
†† 
.
†† 
AddTransient
†† )
<
††) *.
 ServerSectionManagementViewModel
††* J
>
††J K
(
††K L
)
††L M
;
††M N
services
‡‡ 
.
‡‡ 
AddTransient
‡‡ )
<
‡‡) *
Magidesk
‡‡* 2
.
‡‡2 3
Presentation
‡‡3 ?
.
‡‡? @

ViewModels
‡‡@ J
.
‡‡J K%
PrintTemplatesViewModel
‡‡K b
>
‡‡b c
(
‡‡c d
)
‡‡d e
;
‡‡e f
services
ˆˆ 
.
ˆˆ 
AddTransient
ˆˆ )
<
ˆˆ) *
Magidesk
ˆˆ* 2
.
ˆˆ2 3
Presentation
ˆˆ3 ?
.
ˆˆ? @

ViewModels
ˆˆ@ J
.
ˆˆJ K%
TemplateEditorViewModel
ˆˆK b
>
ˆˆb c
(
ˆˆc d
)
ˆˆd e
;
ˆˆe f
services
‹‹ 
.
‹‹ 
	AddScoped
‹‹ &
<
‹‹& '
IQueryHandler
‹‹' 4
<
‹‹4 5.
 GetServerProductivityReportQuery
‹‹5 U
,
‹‹U V)
ServerProductivityReportDto
‹‹W r
>
‹‹r s
,
‹‹s t6
'GetServerProductivityReportQueryHandler‹‹u œ
>‹‹œ 
(‹‹ ž
)‹‹ž Ÿ
;‹‹Ÿ  
services
ŒŒ 
.
ŒŒ 
	AddScoped
ŒŒ &
<
ŒŒ& '
IQueryHandler
ŒŒ' 4
<
ŒŒ4 5'
GetHourlyLaborReportQuery
ŒŒ5 N
,
ŒŒN O"
HourlyLaborReportDto
ŒŒP d
>
ŒŒd e
,
ŒŒe f/
 GetHourlyLaborReportQueryHandlerŒŒg ‡
>ŒŒ‡ ˆ
(ŒŒˆ ‰
)ŒŒ‰ Š
;ŒŒŠ ‹
services
 
.
 
	AddScoped
 &
<
& '
IQueryHandler
' 4
<
4 5
GetTipReportQuery
5 F
,
F G
TipReportDto
H T
>
T U
,
U V&
GetTipReportQueryHandler
W o
>
o p
(
p q
)
q r
;
r s
services
 
.
 
AddTransient
 )
<
) *
ICommandHandler
* 9
<
9 : 
GroupSettleCommand
: L
,
L M
GroupSettleResult
N _
>
_ `
,
` a'
GroupSettleCommandHandler
b {
>
{ |
(
| }
)
} ~
;
~ 
services
‘‘ 
.
‘‘ 
AddTransient
‘‘ )
<
‘‘) *
ICommandHandler
‘‘* 9
<
‘‘9 : 
SplitBySeatCommand
‘‘: L
,
‘‘L M
SplitBySeatResult
‘‘N _
>
‘‘_ `
,
‘‘` a'
SplitBySeatCommandHandler
‘‘b {
>
‘‘{ |
(
‘‘| }
)
‘‘} ~
;
‘‘~ 
services
’’ 
.
’’ 
AddTransient
’’ )
<
’’) *
ICommandHandler
’’* 9
<
’’9 :%
CloseCashSessionCommand
’’: Q
,
’’Q R$
CloseCashSessionResult
’’S i
>
’’i j
,
’’j k-
CloseCashSessionCommandHandler’’l Š
>’’Š ‹
(’’‹ Œ
)’’Œ 
;’’ Ž
services
““ 
.
““ 
AddTransient
““ )
<
““) *
ICommandHandler
““* 9
<
““9 :
ChangeSeatCommand
““: K
>
““K L
,
““L M&
ChangeSeatCommandHandler
““N f
>
““f g
(
““g h
)
““h i
;
““i j
services
”” 
.
”” 
AddTransient
”” )
<
””) *
ICommandHandler
””* 9
<
””9 :!
MergeTicketsCommand
””: M
>
””M N
,
””N O(
MergeTicketsCommandHandler
””P j
>
””j k
(
””k l
)
””l m
;
””m n
services
•• 
.
•• 
AddTransient
•• )
<
••) *
ICommandHandler
••* 9
<
••9 : 
ChangeTableCommand
••: L
,
••L M
ChangeTableResult
••N _
>
••_ `
,
••` a'
ChangeTableCommandHandler
••b {
>
••{ |
(
••| }
)
••} ~
;
••~ 
services
–– 
.
–– 
AddTransient
–– )
<
––) *
ICommandHandler
––* 9
<
––9 : 
SetCustomerCommand
––: L
,
––L M
SetCustomerResult
––N _
>
––_ `
,
––` a'
SetCustomerCommandHandler
––b {
>
––{ |
(
––| }
)
––} ~
;
––~ 
services
™™ 
.
™™ 
AddTransient
™™ )
<
™™) *
ICommandHandler
™™* 9
<
™™9 :
CreateUserCommand
™™: K
,
™™K L
CreateUserResult
™™M ]
>
™™] ^
,
™™^ _&
CreateUserCommandHandler
™™` x
>
™™x y
(
™™y z
)
™™z {
;
™™{ |
services
šš 
.
šš 
AddTransient
šš )
<
šš) *
ICommandHandler
šš* 9
<
šš9 :
UpdateUserCommand
šš: K
,
ššK L
UpdateUserResult
ššM ]
>
šš] ^
,
šš^ _&
UpdateUserCommandHandler
šš` x
>
ššx y
(
ššy z
)
ššz {
;
šš{ |
services
›› 
.
›› 
AddTransient
›› )
<
››) *
ICommandHandler
››* 9
<
››9 :
DeleteUserCommand
››: K
,
››K L
DeleteUserResult
››M ]
>
››] ^
,
››^ _&
DeleteUserCommandHandler
››` x
>
››x y
(
››y z
)
››z {
;
››{ |
services
 
.
 
AddTransient
 )
<
) *
ITableRepository
* :
,
: ;
TableRepository
< K
>
K L
(
L M
)
M N
;
N O
services
žž 
.
žž 
AddTransient
žž )
<
žž) *$
ITableLayoutRepository
žž* @
,
žž@ A#
TableLayoutRepository
žžB W
>
žžW X
(
žžX Y
)
žžY Z
;
žžZ [
services
ŸŸ 
.
ŸŸ 
AddTransient
ŸŸ )
<
ŸŸ) *
IFloorRepository
ŸŸ* :
,
ŸŸ: ;
FloorRepository
ŸŸ< K
>
ŸŸK L
(
ŸŸL M
)
ŸŸM N
;
ŸŸN O
services
¢¢ 
.
¢¢ 
AddTransient
¢¢ )
<
¢¢) *'
BatchPaymentDomainService
¢¢* C
>
¢¢C D
(
¢¢D E
)
¢¢E F
;
¢¢F G
services
££ 
.
££ 
AddSingleton
££ )
<
££) *
IEventPublisher
££* 9
,
££9 :
EventPublisher
££; I
>
££I J
(
££J K
)
££K L
;
££L M
StartupLogger
¥¥ !
.
¥¥! "
Log
¥¥" %
(
¥¥% &
$str
¥¥& C
)
¥¥C D
;
¥¥D E
}
¦¦ 
)
¦¦ 
.
§§ 
Build
§§ 
(
§§ 
)
§§ 
;
§§ 
StartupLogger
¨¨ 
.
¨¨ 
Log
¨¨ 
(
¨¨ 
$str
¨¨ ;
)
¨¨; <
;
¨¨< =
StartupLogger
«« 
.
«« 
Log
«« 
(
«« 
$str
«« E
)
««E F
;
««F G
try
¬¬ 
{
­­ 
using
®® 
var
®® 
scope
®® 
=
®®  !
Host
®®" &
.
®®& '
Services
®®' /
.
®®/ 0
CreateScope
®®0 ;
(
®®; <
)
®®< =
;
®®= >
var
¯¯ 
services
¯¯ 
=
¯¯ 
scope
¯¯ $
.
¯¯$ %
ServiceProvider
¯¯% 4
;
¯¯4 5
var
²² 
mediator
²² 
=
²² 
services
²² '
.
²²' ( 
GetRequiredService
²²( :
<
²²: ;
MediatR
²²; B
.
²²B C
	IMediator
²²C L
>
²²L M
(
²²M N
)
²²N O
;
²²O P
StartupLogger
³³ 
.
³³ 
Log
³³ !
(
³³! "
$str
³³" ?
)
³³? @
;
³³@ A
var
µµ 
dialogService
µµ !
=
µµ" #
services
µµ$ ,
.
µµ, - 
GetRequiredService
µµ- ?
<
µµ? @
IDialogService
µµ@ N
>
µµN O
(
µµO P
)
µµP Q
;
µµQ R
StartupLogger
¶¶ 
.
¶¶ 
Log
¶¶ !
(
¶¶! "
$str
¶¶" D
)
¶¶D E
;
¶¶E F
var
¸¸ 
navigationService
¸¸ %
=
¸¸& '
services
¸¸( 0
.
¸¸0 1 
GetRequiredService
¸¸1 C
<
¸¸C D
NavigationService
¸¸D U
>
¸¸U V
(
¸¸V W
)
¸¸W X
;
¸¸X Y
StartupLogger
¹¹ 
.
¹¹ 
Log
¹¹ !
(
¹¹! "
$str
¹¹" G
)
¹¹G H
;
¹¹H I
var
»» 
userService
»» 
=
»»  !
services
»»" *
.
»»* + 
GetRequiredService
»»+ =
<
»»= >
IUserService
»»> J
>
»»J K
(
»»K L
)
»»L M
;
»»M N
StartupLogger
¼¼ 
.
¼¼ 
Log
¼¼ !
(
¼¼! "
$str
¼¼" B
)
¼¼B C
;
¼¼C D
var
¾¾ 
terminalContext
¾¾ #
=
¾¾$ %
services
¾¾& .
.
¾¾. / 
GetRequiredService
¾¾/ A
<
¾¾A B
ITerminalContext
¾¾B R
>
¾¾R S
(
¾¾S T
)
¾¾T U
;
¾¾U V
StartupLogger
¿¿ 
.
¿¿ 
Log
¿¿ !
(
¿¿! "
$str
¿¿" F
)
¿¿F G
;
¿¿G H
StartupLogger
ÁÁ 
.
ÁÁ 
Log
ÁÁ !
(
ÁÁ! "
$str
ÁÁ" V
)
ÁÁV W
;
ÁÁW X
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
validationEx
ÃÃ )
)
ÃÃ) *
{
ÄÄ %
HandleFatalStartupError
ÅÅ '
(
ÅÅ' (
$str
ÅÅ( C
,
ÅÅC D
validationEx
ÅÅE Q
)
ÅÅQ R
;
ÅÅR S
throw
ÆÆ 
;
ÆÆ 
}
ÇÇ 
}
ÈÈ 	
catch
ÈÈ
 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ 
{
ÈÈ  %
HandleFatalStartupError
ÉÉ #
(
ÉÉ# $
$str
ÉÉ$ =
,
ÉÉ= >
ex
ÉÉ? A
)
ÉÉA B
;
ÉÉB C
throw
ÊÊ 
;
ÊÊ 
}
ËË 	
StartupLogger
ÌÌ 
.
ÌÌ 
Log
ÌÌ 
(
ÌÌ 
$str
ÌÌ 1
)
ÌÌ1 2
;
ÌÌ2 3
}
ÍÍ 
private
ÏÏ 
void
ÏÏ %
HandleFatalStartupError
ÏÏ (
(
ÏÏ( )
string
ÏÏ) /
stage
ÏÏ0 5
,
ÏÏ5 6
	Exception
ÏÏ7 @
ex
ÏÏA C
)
ÏÏC D
{
ÐÐ 
var
ÑÑ 
msg
ÑÑ 
=
ÑÑ 
$"
ÑÑ 
$str
ÑÑ 5
{
ÑÑ5 6
stage
ÑÑ6 ;
}
ÑÑ; <
$str
ÑÑ< E
{
ÑÑE F
ex
ÑÑF H
.
ÑÑH I
Message
ÑÑI P
}
ÑÑP Q
$str
ÑÑQ ]
{
ÑÑ] ^
ex
ÑÑ^ `
.
ÑÑ` a

StackTrace
ÑÑa k
}
ÑÑk l
"
ÑÑl m
;
ÑÑm n
StartupLogger
ÒÒ 
.
ÒÒ 
Log
ÒÒ 
(
ÒÒ 
msg
ÒÒ 
)
ÒÒ 
;
ÒÒ 
try
ÓÓ 
{
ÔÔ 	

MessageBox
ÕÕ 
(
ÕÕ 
IntPtr
ÕÕ 
.
ÕÕ 
Zero
ÕÕ "
,
ÕÕ" #
msg
ÕÕ$ '
,
ÕÕ' (
$str
ÕÕ) ?
,
ÕÕ? @
$num
ÕÕA E
)
ÕÕE F
;
ÕÕF G
}
ÖÖ 	
catch
×× 
{
ØØ 	
try
ÛÛ 
{
ÜÜ 
var
ÝÝ 
desktop
ÝÝ 
=
ÝÝ 
Environment
ÝÝ *
.
ÝÝ* +
GetFolderPath
ÝÝ+ 8
(
ÝÝ8 9
Environment
ÝÝ9 D
.
ÝÝD E
SpecialFolder
ÝÝE R
.
ÝÝR S
Desktop
ÝÝS Z
)
ÝÝZ [
;
ÝÝ[ \
var
ÞÞ 
path
ÞÞ 
=
ÞÞ 
System
ÞÞ "
.
ÞÞ" #
IO
ÞÞ# %
.
ÞÞ% &
Path
ÞÞ& *
.
ÞÞ* +
Combine
ÞÞ+ 2
(
ÞÞ2 3
desktop
ÞÞ3 :
,
ÞÞ: ;
$str
ÞÞ< V
)
ÞÞV W
;
ÞÞW X
System
ßß 
.
ßß 
IO
ßß 
.
ßß 
File
ßß 
.
ßß  
WriteAllText
ßß  ,
(
ßß, -
path
ßß- 1
,
ßß1 2
msg
ßß3 6
+
ßß7 8
$str
ßß9 Y
)
ßßY Z
;
ßßZ [
}
àà 
catch
áá 
{
áá 
}
áá- .
}
ââ 	
}
ãã 
	protected
åå 
override
åå 
async
åå 
void
åå !

OnLaunched
åå" ,
(
åå, -&
LaunchActivatedEventArgs
åå- E
args
ååF J
)
ååJ K
{
ææ 
StartupLogger
çç 
.
çç 
Log
çç 
(
çç 
$str
çç .
)
çç. /
;
çç/ 0
try
èè 
{
éé 	
StartupLogger
êê 
.
êê 
Log
êê 
(
êê 
$str
êê @
)
êê@ A
;
êêA B
_window
ëë 
=
ëë 
new
ëë 

MainWindow
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
StartupLogger
ìì 
.
ìì 
Log
ìì 
(
ìì 
$str
ìì ?
)
ìì? @
;
ìì@ A
var
íí 

mainWindow
íí 
=
íí 
(
íí 

MainWindow
íí (
)
íí( )
_window
íí) 0
;
íí0 1 
MainWindowInstance
îî 
=
îî  

mainWindow
îî! +
;
îî+ ,
_window
ïï 
.
ïï 
Activate
ïï 
(
ïï 
)
ïï 
;
ïï 
System
ññ 
.
ññ 
Diagnostics
ññ 
.
ññ 
Debug
ññ $
.
ññ$ %
	WriteLine
ññ% .
(
ññ. /
$str
ññ/ W
)
ññW X
;
ññX Y
StartupLogger
òò 
.
òò 
Log
òò 
(
òò 
$str
òò <
)
òò< =
;
òò= >

mainWindow
óó 
.
óó 
ShowLoading
óó "
(
óó" #
$str
óó# ;
)
óó; <
;
óó< =
StartupLogger
õõ 
.
õõ 
Log
õõ 
(
õõ 
$str
õõ S
)
õõS T
;
õõT U
var
öö 
initService
öö 
=
öö 
Host
öö "
.
öö" #
Services
öö# +
.
öö+ , 
GetRequiredService
öö, >
<
öö> ?
Magidesk
öö? G
.
ööG H
Application
ööH S
.
ööS T

Interfaces
ööT ^
.
öö^ _*
ISystemInitializationService
öö_ {
>
öö{ |
(
öö| }
)
öö} ~
;
öö~ 
StartupLogger
÷÷ 
.
÷÷ 
Log
÷÷ 
(
÷÷ 
$str
÷÷ J
)
÷÷J K
;
÷÷K L
var
øø 
result
øø 
=
øø 
await
øø 
initService
øø *
.
øø* +#
InitializeSystemAsync
øø+ @
(
øø@ A
)
øøA B
;
øøB C
if
úú 
(
úú 
result
úú 
.
úú 
	IsSuccess
úú  
)
úú  !
{
ûû 
StartupLogger
üü 
.
üü 
Log
üü !
(
üü! "
$str
üü" J
)
üüJ K
;
üüK L
if
ýý 
(
ýý 
!
ýý 
string
ýý 
.
ýý 
IsNullOrEmpty
ýý )
(
ýý) *
result
ýý* 0
.
ýý0 1

TerminalId
ýý1 ;
)
ýý; <
)
ýý< =
{
þþ 

mainWindow
ÿÿ 
.
ÿÿ 
SetTerminalId
ÿÿ ,
(
ÿÿ, -
result
ÿÿ- 3
.
ÿÿ3 4

TerminalId
ÿÿ4 >
)
ÿÿ> ?
;
ÿÿ? @
var
 
terminalContext
 '
=
( )
Host
* .
.
. /
Services
/ 7
.
7 8 
GetRequiredService
8 J
<
J K
ITerminalContext
K [
>
[ \
(
\ ]
)
] ^
;
^ _
terminalContext
‚‚ #
.
‚‚# $!
SetTerminalIdentity
‚‚$ 7
(
‚‚7 8
result
‚‚8 >
.
‚‚> ?

TerminalId
‚‚? I
,
‚‚I J
result
‚‚K Q
.
‚‚Q R
TerminalGuid
‚‚R ^
??
‚‚_ a
Guid
‚‚b f
.
‚‚f g
Empty
‚‚g l
)
‚‚l m
;
‚‚m n
}
ƒƒ 

mainWindow
…… 
.
…… 
HideLoading
…… &
(
……& '
)
……' (
;
……( )
var
†† 

navService
†† 
=
††  
Host
††! %
.
††% &
Services
††& .
.
††. / 
GetRequiredService
††/ A
<
††A B
NavigationService
††B S
>
††S T
(
††T U
)
††U V
;
††V W
StartupLogger
ˆˆ 
.
ˆˆ 
Log
ˆˆ !
(
ˆˆ! "
$str
ˆˆ" H
)
ˆˆH I
;
ˆˆI J

navService
‰‰ 
.
‰‰ 
Navigate
‰‰ #
(
‰‰# $
typeof
‰‰$ *
(
‰‰* +
Views
‰‰+ 0
.
‰‰0 1
	LoginPage
‰‰1 :
)
‰‰: ;
)
‰‰; <
;
‰‰< =
StartupLogger
ŠŠ 
.
ŠŠ 
Log
ŠŠ !
(
ŠŠ! "
$str
ŠŠ" C
)
ŠŠC D
;
ŠŠD E
}
‹‹ 
else
ŒŒ 
{
 
StartupLogger
 
.
 
Log
 !
(
! "
$"
" $
$str
$ H
{
H I
result
I O
.
O P
Message
P W
}
W X
"
X Y
)
Y Z
;
Z [
var
’’ 
errorMsg
’’ 
=
’’ 
$"
’’ !
$str
’’! c
"
’’c d
+
’’e f
$"
““  
$str
““  '
{
““' (
result
““( .
.
““. /
Message
““/ 6
}
““6 7
$str
““7 ;
"
““; <
+
““= >
$"
””  
$str
””  ?
"
””? @
;
””@ A
try
–– 
{
—— 

MessageBox
˜˜ 
(
˜˜ 
IntPtr
˜˜ %
.
˜˜% &
Zero
˜˜& *
,
˜˜* +
errorMsg
˜˜, 4
,
˜˜4 5
$str
˜˜6 V
,
˜˜V W
$num
˜˜X \
)
˜˜\ ]
;
˜˜] ^
}
™™ 
catch
šš 
{
›› 

mainWindow
 
.
 
ShowLoading
 *
(
* +
$"
+ -
$str
- 4
{
4 5
result
5 ;
.
; <
Message
< C
}
C D
"
D E
)
E F
;
F G
System
žž 
.
žž 
	Threading
žž $
.
žž$ %
Thread
žž% +
.
žž+ ,
Sleep
žž, 1
(
žž1 2
$num
žž2 6
)
žž6 7
;
žž7 8
}
ŸŸ 
Environment
¢¢ 
.
¢¢ 
Exit
¢¢  
(
¢¢  !
$num
¢¢! "
)
¢¢" #
;
¢¢# $
}
££ 
}
¤¤ 	
catch
¥¥ 
(
¥¥ 
System
¥¥ 
.
¥¥ 
	Exception
¥¥ 
ex
¥¥  "
)
¥¥" #
{
¦¦ 	
System
¨¨ 
.
¨¨ 
Diagnostics
¨¨ 
.
¨¨ 
Debug
¨¨ $
.
¨¨$ %
	WriteLine
¨¨% .
(
¨¨. /
$"
¨¨/ 1
$str
¨¨1 <
{
¨¨< =
ex
¨¨= ?
}
¨¨? @
"
¨¨@ A
)
¨¨A B
;
¨¨B C
StartupLogger
©© 
.
©© 
Log
©© 
(
©© 
$"
©©  
$str
©©  >
{
©©> ?
ex
©©? A
}
©©A B
"
©©B C
)
©©C D
;
©©D E
var
«« 
errorMsg
«« 
=
«« 
$"
«« 
$str
«« V
"
««V W
+
««X Y
$"
¬¬ 
$str
¬¬ #
{
¬¬# $
ex
¬¬$ &
.
¬¬& '
Message
¬¬' .
}
¬¬. /
$str
¬¬/ 3
"
¬¬3 4
+
¬¬5 6
$"
­­ 
$str
­­ ?
"
­­? @
+
­­A B
$"
®® 
$str
®® F
"
®®F G
;
®®G H
try
°° 
{
±± 

MessageBox
³³ 
(
³³ 
IntPtr
³³ !
.
³³! "
Zero
³³" &
,
³³& '
errorMsg
³³( 0
,
³³0 1
$str
³³2 P
,
³³P Q
$num
³³R V
)
³³V W
;
³³W X
}
´´ 
catch
µµ 
{
¶¶ 
try
¸¸ 
{
¹¹ 
if
ºº 
(
ºº 
_window
ºº 
==
ºº  "
null
ºº# '
)
ºº' (
{
»» 
_window
¼¼ 
=
¼¼  !
new
¼¼" %
Window
¼¼& ,
(
¼¼, -
)
¼¼- .
;
¼¼. /
_window
½½ 
.
½½  
Content
½½  '
=
½½( )
new
½½* -
	Microsoft
½½. 7
.
½½7 8
UI
½½8 :
.
½½: ;
Xaml
½½; ?
.
½½? @
Controls
½½@ H
.
½½H I
	TextBlock
½½I R
{
½½S T
Text
¾¾  
=
¾¾! "
$"
¾¾# %
$str
¾¾% ;
{
¾¾; <
ex
¾¾< >
.
¾¾> ?
Message
¾¾? F
}
¾¾F G
$str
¾¾G S
{
¾¾S T
ex
¾¾T V
.
¾¾V W

StackTrace
¾¾W a
}
¾¾a b
"
¾¾b c
,
¾¾c d
Margin
¿¿ "
=
¿¿# $
new
¿¿% (
	Thickness
¿¿) 2
(
¿¿2 3
$num
¿¿3 5
)
¿¿5 6
,
¿¿6 7
VerticalAlignment
ÀÀ -
=
ÀÀ. /
VerticalAlignment
ÀÀ0 A
.
ÀÀA B
Center
ÀÀB H
,
ÀÀH I!
HorizontalAlignment
ÁÁ /
=
ÁÁ0 1!
HorizontalAlignment
ÁÁ2 E
.
ÁÁE F
Center
ÁÁF L
,
ÁÁL M
TextWrapping
ÂÂ (
=
ÂÂ) *
TextWrapping
ÂÂ+ 7
.
ÂÂ7 8
Wrap
ÂÂ8 <
}
ÃÃ 
;
ÃÃ 
_window
ÄÄ 
.
ÄÄ  
Activate
ÄÄ  (
(
ÄÄ( )
)
ÄÄ) *
;
ÄÄ* +
System
ÅÅ 
.
ÅÅ 
	Threading
ÅÅ (
.
ÅÅ( )
Thread
ÅÅ) /
.
ÅÅ/ 0
Sleep
ÅÅ0 5
(
ÅÅ5 6
$num
ÅÅ6 :
)
ÅÅ: ;
;
ÅÅ; <
}
ÆÆ 
else
ÇÇ 
if
ÇÇ 
(
ÇÇ  
MainWindowInstance
ÇÇ /
is
ÇÇ0 2

MainWindow
ÇÇ3 =
mw
ÇÇ> @
)
ÇÇ@ A
{
ÈÈ 
mw
ÉÉ 
.
ÉÉ 
ShowLoading
ÉÉ &
(
ÉÉ& '
$"
ÉÉ' )
$str
ÉÉ) 0
{
ÉÉ0 1
ex
ÉÉ1 3
.
ÉÉ3 4
Message
ÉÉ4 ;
}
ÉÉ; <
"
ÉÉ< =
)
ÉÉ= >
;
ÉÉ> ?
System
ÊÊ 
.
ÊÊ 
	Threading
ÊÊ (
.
ÊÊ( )
Thread
ÊÊ) /
.
ÊÊ/ 0
Sleep
ÊÊ0 5
(
ÊÊ5 6
$num
ÊÊ6 :
)
ÊÊ: ;
;
ÊÊ; <
}
ËË 
}
ÌÌ 
catch
ÍÍ 
{
ÎÎ 
}
ÐÐ 
}
ÑÑ 
Environment
ÔÔ 
.
ÔÔ 
Exit
ÔÔ 
(
ÔÔ 
$num
ÔÔ 
)
ÔÔ 
;
ÔÔ  
}
ÕÕ 	
}
ÖÖ 
private
ØØ 
void
ØØ $
App_UnhandledException
ØØ '
(
ØØ' (
object
ØØ( .
sender
ØØ/ 5
,
ØØ5 6
	Microsoft
ØØ7 @
.
ØØ@ A
UI
ØØA C
.
ØØC D
Xaml
ØØD H
.
ØØH I)
UnhandledExceptionEventArgs
ØØI d
e
ØØe f
)
ØØf g
{
ÙÙ %
HandleCriticalException
ÛÛ 
(
ÛÛ  
e
ÛÛ  !
.
ÛÛ! "
	Exception
ÛÛ" +
,
ÛÛ+ ,
$str
ÛÛ- B
)
ÛÛB C
;
ÛÛC D
}
ÝÝ 
private
àà 
void
àà .
 CurrentDomain_UnhandledException
àà 1
(
àà1 2
object
àà2 8
sender
àà9 ?
,
àà? @
System
ààA G
.
ààG H)
UnhandledExceptionEventArgs
ààH c
e
ààd e
)
ààe f
{
áá 
var
ââ 
ex
ââ 
=
ââ 
e
ââ 
.
ââ 
ExceptionObject
ââ "
as
ââ# %
	Exception
ââ& /
;
ââ/ 0%
HandleCriticalException
ãã 
(
ãã  
ex
ãã  "
,
ãã" #
$str
ãã$ A
)
ããA B
;
ããB C
}
ää 
private
çç 
void
çç 3
%TaskScheduler_UnobservedTaskException
çç 6
(
çç6 7
object
çç7 =
sender
çç> D
,
ççD E.
 UnobservedTaskExceptionEventArgs
ççF f
e
ççg h
)
ççh i
{
èè %
HandleCriticalException
éé 
(
éé  
e
éé  !
.
éé! "
	Exception
éé" +
,
éé+ ,
$str
éé- H
)
ééH I
;
ééI J
e
êê 	
.
êê	 

SetObserved
êê
 
(
êê 
)
êê 
;
êê 
}
îî 
private
ðð 
void
ðð %
HandleCriticalException
ðð (
(
ðð( )
	Exception
ðð) 2
?
ðð2 3
ex
ðð4 6
,
ðð6 7
string
ðð8 >
source
ðð? E
)
ððE F
{
ññ 
if
òò 

(
òò 
ex
òò 
==
òò 
null
òò 
)
òò 
return
òò 
;
òò 
try
õõ 
{
öö 	
var
÷÷ 
appData
÷÷ 
=
÷÷ 
Environment
÷÷ %
.
÷÷% &
GetFolderPath
÷÷& 3
(
÷÷3 4
Environment
÷÷4 ?
.
÷÷? @
SpecialFolder
÷÷@ M
.
÷÷M N"
LocalApplicationData
÷÷N b
)
÷÷b c
;
÷÷c d
var
øø 
logDir
øø 
=
øø 
System
øø 
.
øø  
IO
øø  "
.
øø" #
Path
øø# '
.
øø' (
Combine
øø( /
(
øø/ 0
appData
øø0 7
,
øø7 8
$str
øø9 C
,
øøC D
$str
øøE K
)
øøK L
;
øøL M
System
ùù 
.
ùù 
IO
ùù 
.
ùù 
	Directory
ùù 
.
ùù  
CreateDirectory
ùù  /
(
ùù/ 0
logDir
ùù0 6
)
ùù6 7
;
ùù7 8
var
úú 
logPath
úú 
=
úú 
System
úú  
.
úú  !
IO
úú! #
.
úú# $
Path
úú$ (
.
úú( )
Combine
úú) 0
(
úú0 1
logDir
úú1 7
,
úú7 8
$str
úú9 H
)
úúH I
;
úúI J
var
üü 
message
üü 
=
üü 
$"
üü 
$str
üü 
{
üü 
DateTime
üü &
.
üü& '
Now
üü' *
:
üü* +
$str
üü+ >
}
üü> ?
$str
üü? S
{
üüS T
source
üüT Z
}
üüZ [
$str
üü[ ^
{
üü^ _
ex
üü_ a
.
üüa b
Message
üüb i
}
üüi j
$str
üüj s
{
üüs t
ex
üüt v
.
üüv w

StackTraceüüw 
}üü ‚
$strüü‚ ‹
{üü‹ Œ
exüüŒ Ž
.üüŽ 
InnerExceptionüü 
}üü ž
$strüüž Â
"üüÂ Ã
;üüÃ Ä
System
ýý 
.
ýý 
IO
ýý 
.
ýý 
File
ýý 
.
ýý 
AppendAllText
ýý (
(
ýý( )
logPath
ýý) 0
,
ýý0 1
message
ýý2 9
)
ýý9 :
;
ýý: ;
}
þþ 	
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
logEx
ÿÿ 
)
ÿÿ 
{
€€ 	
System
‚‚ 
.
‚‚ 
Diagnostics
‚‚ 
.
‚‚ 
Debug
‚‚ $
.
‚‚$ %
	WriteLine
‚‚% .
(
‚‚. /
$"
‚‚/ 1
$str
‚‚1 T
{
‚‚T U
logEx
‚‚U Z
.
‚‚Z [
Message
‚‚[ b
}
‚‚b c
"
‚‚c d
)
‚‚d e
;
‚‚e f
System
ƒƒ 
.
ƒƒ 
Diagnostics
ƒƒ 
.
ƒƒ 
Debug
ƒƒ $
.
ƒƒ$ %
	WriteLine
ƒƒ% .
(
ƒƒ. /
$"
ƒƒ/ 1
$str
ƒƒ1 J
{
ƒƒJ K
ex
ƒƒK M
}
ƒƒM N
"
ƒƒN O
)
ƒƒO P
;
ƒƒP Q
}
„„ 	
try
ˆˆ 
{
‰‰ 	
var
ŠŠ 
errorMsg
ŠŠ 
=
ŠŠ 
$"
ŠŠ 
$str
ŠŠ 8
{
ŠŠ8 9
source
ŠŠ9 ?
}
ŠŠ? @
$str
ŠŠ@ e
"
ŠŠe f
+
ŠŠg h
$"
‹‹ 
$str
‹‹ #
{
‹‹# $
ex
‹‹$ &
.
‹‹& '
Message
‹‹' .
}
‹‹. /
$str
‹‹/ 3
"
‹‹3 4
+
‹‹5 6
$"
ŒŒ 
$str
ŒŒ G
"
ŒŒG H
;
ŒŒH I

MessageBox
ŽŽ 
(
ŽŽ 
IntPtr
ŽŽ 
.
ŽŽ 
Zero
ŽŽ "
,
ŽŽ" #
errorMsg
ŽŽ$ ,
,
ŽŽ, -
$str
ŽŽ. D
,
ŽŽD E
$num
ŽŽF J
)
ŽŽJ K
;
ŽŽK L
}
 	
catch
 
(
 
	Exception
 
uiEx
 
)
 
{
‘‘ 	
System
’’ 
.
’’ 
Diagnostics
’’ 
.
’’ 
Debug
’’ $
.
’’$ %
	WriteLine
’’% .
(
’’. /
$"
’’/ 1
$str
’’1 Z
{
’’Z [
uiEx
’’[ _
.
’’_ `
Message
’’` g
}
’’g h
"
’’h i
)
’’i j
;
’’j k
}
““ 	
if
—— 

(
—— 
source
—— 
==
—— 
$str
—— 3
||
——4 6
source
——7 =
==
——> @
$str
——A \
)
——\ ]
{
˜˜ 	
try
™™ 
{
šš 
if
›› 
(
››  
MainWindowInstance
›› &
is
››' )

MainWindow
››* 4
mw
››5 7
)
››7 8
{
œœ 
var
 
	bannerMsg
 !
=
" #
$"
$ &
$str
& i
"
i j
;
j k
var
žž 
details
žž 
=
žž  !
$"
žž" $
$str
žž$ ,
{
žž, -
source
žž- 3
}
žž3 4
$str
žž4 6
"
žž6 7
+
žž8 9
$"
ŸŸ! #
$str
ŸŸ# *
{
ŸŸ* +
ex
ŸŸ+ -
.
ŸŸ- .
Message
ŸŸ. 5
}
ŸŸ5 6
$str
ŸŸ6 8
"
ŸŸ8 9
+
ŸŸ: ;
$"
  ! #
$str
  # 1
{
  1 2
ex
  2 4
.
  4 5

StackTrace
  5 ?
}
  ? @
$str
  @ B
"
  B C
+
  D E
$"
¡¡! #
$str
¡¡# 4
{
¡¡4 5
ex
¡¡5 7
.
¡¡7 8
InnerException
¡¡8 F
}
¡¡F G
"
¡¡G H
;
¡¡H I
mw
££ 
.
££ 
ShowErrorBanner
££ &
(
££& '
	bannerMsg
££' 0
,
££0 1
details
££2 9
)
££9 :
;
££: ;
}
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
bannerEx
¦¦ %
)
¦¦% &
{
§§ 
System
¨¨ 
.
¨¨ 
Diagnostics
¨¨ "
.
¨¨" #
Debug
¨¨# (
.
¨¨( )
	WriteLine
¨¨) 2
(
¨¨2 3
$"
¨¨3 5
$str
¨¨5 Z
{
¨¨Z [
bannerEx
¨¨[ c
.
¨¨c d
Message
¨¨d k
}
¨¨k l
"
¨¨l m
)
¨¨m n
;
¨¨n o
}
©© 
}
ªª 	
}
°° 
}±± 